function O8(t,s){for(var e=0;e<s.length;e++){const a=s[e];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in t)){const i=Object.getOwnPropertyDescriptor(a,n);i&&Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();var nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Eg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var tp={exports:{}},lu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gv;function R8(){if(gv)return lu;gv=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function e(a,n,i){var c=null;if(i!==void 0&&(c=""+i),n.key!==void 0&&(c=""+n.key),"key"in n){i={};for(var l in n)l!=="key"&&(i[l]=n[l])}else i=n;return n=i.ref,{$$typeof:t,type:a,key:c,ref:n!==void 0?n:null,props:i}}return lu.Fragment=s,lu.jsx=e,lu.jsxs=e,lu}var xv;function M8(){return xv||(xv=1,tp.exports=R8()),tp.exports}var r=M8(),rp={},cu={},bv;function F8(){if(bv)return cu;bv=1,cu.byteLength=l,cu.toByteArray=o,cu.fromByteArray=p;for(var t=[],s=[],e=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,i=a.length;n<i;++n)t[n]=a[n],s[a.charCodeAt(n)]=n;s[45]=62,s[95]=63;function c(h){var f=h.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=h.indexOf("=");x===-1&&(x=f);var b=x===f?0:4-x%4;return[x,b]}function l(h){var f=c(h),x=f[0],b=f[1];return(x+b)*3/4-b}function u(h,f,x){return(f+x)*3/4-x}function o(h){var f,x=c(h),b=x[0],v=x[1],_=new e(u(h,b,v)),N=0,E=v>0?b-4:b,O;for(O=0;O<E;O+=4)f=s[h.charCodeAt(O)]<<18|s[h.charCodeAt(O+1)]<<12|s[h.charCodeAt(O+2)]<<6|s[h.charCodeAt(O+3)],_[N++]=f>>16&255,_[N++]=f>>8&255,_[N++]=f&255;return v===2&&(f=s[h.charCodeAt(O)]<<2|s[h.charCodeAt(O+1)]>>4,_[N++]=f&255),v===1&&(f=s[h.charCodeAt(O)]<<10|s[h.charCodeAt(O+1)]<<4|s[h.charCodeAt(O+2)]>>2,_[N++]=f>>8&255,_[N++]=f&255),_}function d(h){return t[h>>18&63]+t[h>>12&63]+t[h>>6&63]+t[h&63]}function g(h,f,x){for(var b,v=[],_=f;_<x;_+=3)b=(h[_]<<16&16711680)+(h[_+1]<<8&65280)+(h[_+2]&255),v.push(d(b));return v.join("")}function p(h){for(var f,x=h.length,b=x%3,v=[],_=16383,N=0,E=x-b;N<E;N+=_)v.push(g(h,N,N+_>E?E:N+_));return b===1?(f=h[x-1],v.push(t[f>>2]+t[f<<4&63]+"==")):b===2&&(f=(h[x-2]<<8)+h[x-1],v.push(t[f>>10]+t[f>>4&63]+t[f<<2&63]+"=")),v.join("")}return cu}var bf={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var yv;function I8(){return yv||(yv=1,bf.read=function(t,s,e,a,n){var i,c,l=n*8-a-1,u=(1<<l)-1,o=u>>1,d=-7,g=e?n-1:0,p=e?-1:1,h=t[s+g];for(g+=p,i=h&(1<<-d)-1,h>>=-d,d+=l;d>0;i=i*256+t[s+g],g+=p,d-=8);for(c=i&(1<<-d)-1,i>>=-d,d+=a;d>0;c=c*256+t[s+g],g+=p,d-=8);if(i===0)i=1-o;else{if(i===u)return c?NaN:(h?-1:1)*(1/0);c=c+Math.pow(2,a),i=i-o}return(h?-1:1)*c*Math.pow(2,i-a)},bf.write=function(t,s,e,a,n,i){var c,l,u,o=i*8-n-1,d=(1<<o)-1,g=d>>1,p=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=a?0:i-1,f=a?1:-1,x=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(l=isNaN(s)?1:0,c=d):(c=Math.floor(Math.log(s)/Math.LN2),s*(u=Math.pow(2,-c))<1&&(c--,u*=2),c+g>=1?s+=p/u:s+=p*Math.pow(2,1-g),s*u>=2&&(c++,u/=2),c+g>=d?(l=0,c=d):c+g>=1?(l=(s*u-1)*Math.pow(2,n),c=c+g):(l=s*Math.pow(2,g-1)*Math.pow(2,n),c=0));n>=8;t[e+h]=l&255,h+=f,l/=256,n-=8);for(c=c<<n|l,o+=n;o>0;t[e+h]=c&255,h+=f,c/=256,o-=8);t[e+h-f]|=x*128}),bf}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var vv;function L8(){return vv||(vv=1,function(t){const s=F8(),e=I8(),a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=_,t.INSPECT_MAX_BYTES=50;const n=2147483647;t.kMaxLength=n,l.TYPED_ARRAY_SUPPORT=i(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const ie=new Uint8Array(1),ee={foo:function(){return 42}};return Object.setPrototypeOf(ee,Uint8Array.prototype),Object.setPrototypeOf(ie,ee),ie.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function c(ie){if(ie>n)throw new RangeError('The value "'+ie+'" is invalid for option "size"');const ee=new Uint8Array(ie);return Object.setPrototypeOf(ee,l.prototype),ee}function l(ie,ee,te){if(typeof ie=="number"){if(typeof ee=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(ie)}return u(ie,ee,te)}l.poolSize=8192;function u(ie,ee,te){if(typeof ie=="string")return p(ie,ee);if(ArrayBuffer.isView(ie))return f(ie);if(ie==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ie);if(je(ie,ArrayBuffer)||ie&&je(ie.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(je(ie,SharedArrayBuffer)||ie&&je(ie.buffer,SharedArrayBuffer)))return x(ie,ee,te);if(typeof ie=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const fe=ie.valueOf&&ie.valueOf();if(fe!=null&&fe!==ie)return l.from(fe,ee,te);const _e=b(ie);if(_e)return _e;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ie[Symbol.toPrimitive]=="function")return l.from(ie[Symbol.toPrimitive]("string"),ee,te);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ie)}l.from=function(ie,ee,te){return u(ie,ee,te)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function o(ie){if(typeof ie!="number")throw new TypeError('"size" argument must be of type number');if(ie<0)throw new RangeError('The value "'+ie+'" is invalid for option "size"')}function d(ie,ee,te){return o(ie),ie<=0?c(ie):ee!==void 0?typeof te=="string"?c(ie).fill(ee,te):c(ie).fill(ee):c(ie)}l.alloc=function(ie,ee,te){return d(ie,ee,te)};function g(ie){return o(ie),c(ie<0?0:v(ie)|0)}l.allocUnsafe=function(ie){return g(ie)},l.allocUnsafeSlow=function(ie){return g(ie)};function p(ie,ee){if((typeof ee!="string"||ee==="")&&(ee="utf8"),!l.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);const te=N(ie,ee)|0;let fe=c(te);const _e=fe.write(ie,ee);return _e!==te&&(fe=fe.slice(0,_e)),fe}function h(ie){const ee=ie.length<0?0:v(ie.length)|0,te=c(ee);for(let fe=0;fe<ee;fe+=1)te[fe]=ie[fe]&255;return te}function f(ie){if(je(ie,Uint8Array)){const ee=new Uint8Array(ie);return x(ee.buffer,ee.byteOffset,ee.byteLength)}return h(ie)}function x(ie,ee,te){if(ee<0||ie.byteLength<ee)throw new RangeError('"offset" is outside of buffer bounds');if(ie.byteLength<ee+(te||0))throw new RangeError('"length" is outside of buffer bounds');let fe;return ee===void 0&&te===void 0?fe=new Uint8Array(ie):te===void 0?fe=new Uint8Array(ie,ee):fe=new Uint8Array(ie,ee,te),Object.setPrototypeOf(fe,l.prototype),fe}function b(ie){if(l.isBuffer(ie)){const ee=v(ie.length)|0,te=c(ee);return te.length===0||ie.copy(te,0,0,ee),te}if(ie.length!==void 0)return typeof ie.length!="number"||Ie(ie.length)?c(0):h(ie);if(ie.type==="Buffer"&&Array.isArray(ie.data))return h(ie.data)}function v(ie){if(ie>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return ie|0}function _(ie){return+ie!=ie&&(ie=0),l.alloc(+ie)}l.isBuffer=function(ee){return ee!=null&&ee._isBuffer===!0&&ee!==l.prototype},l.compare=function(ee,te){if(je(ee,Uint8Array)&&(ee=l.from(ee,ee.offset,ee.byteLength)),je(te,Uint8Array)&&(te=l.from(te,te.offset,te.byteLength)),!l.isBuffer(ee)||!l.isBuffer(te))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ee===te)return 0;let fe=ee.length,_e=te.length;for(let Te=0,Ae=Math.min(fe,_e);Te<Ae;++Te)if(ee[Te]!==te[Te]){fe=ee[Te],_e=te[Te];break}return fe<_e?-1:_e<fe?1:0},l.isEncoding=function(ee){switch(String(ee).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(ee,te){if(!Array.isArray(ee))throw new TypeError('"list" argument must be an Array of Buffers');if(ee.length===0)return l.alloc(0);let fe;if(te===void 0)for(te=0,fe=0;fe<ee.length;++fe)te+=ee[fe].length;const _e=l.allocUnsafe(te);let Te=0;for(fe=0;fe<ee.length;++fe){let Ae=ee[fe];if(je(Ae,Uint8Array))Te+Ae.length>_e.length?(l.isBuffer(Ae)||(Ae=l.from(Ae)),Ae.copy(_e,Te)):Uint8Array.prototype.set.call(_e,Ae,Te);else if(l.isBuffer(Ae))Ae.copy(_e,Te);else throw new TypeError('"list" argument must be an Array of Buffers');Te+=Ae.length}return _e};function N(ie,ee){if(l.isBuffer(ie))return ie.length;if(ArrayBuffer.isView(ie)||je(ie,ArrayBuffer))return ie.byteLength;if(typeof ie!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ie);const te=ie.length,fe=arguments.length>2&&arguments[2]===!0;if(!fe&&te===0)return 0;let _e=!1;for(;;)switch(ee){case"ascii":case"latin1":case"binary":return te;case"utf8":case"utf-8":return ue(ie).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te*2;case"hex":return te>>>1;case"base64":return Me(ie).length;default:if(_e)return fe?-1:ue(ie).length;ee=(""+ee).toLowerCase(),_e=!0}}l.byteLength=N;function E(ie,ee,te){let fe=!1;if((ee===void 0||ee<0)&&(ee=0),ee>this.length||((te===void 0||te>this.length)&&(te=this.length),te<=0)||(te>>>=0,ee>>>=0,te<=ee))return"";for(ie||(ie="utf8");;)switch(ie){case"hex":return j(this,ee,te);case"utf8":case"utf-8":return D(this,ee,te);case"ascii":return S(this,ee,te);case"latin1":case"binary":return w(this,ee,te);case"base64":return M(this,ee,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,ee,te);default:if(fe)throw new TypeError("Unknown encoding: "+ie);ie=(ie+"").toLowerCase(),fe=!0}}l.prototype._isBuffer=!0;function O(ie,ee,te){const fe=ie[ee];ie[ee]=ie[te],ie[te]=fe}l.prototype.swap16=function(){const ee=this.length;if(ee%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let te=0;te<ee;te+=2)O(this,te,te+1);return this},l.prototype.swap32=function(){const ee=this.length;if(ee%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let te=0;te<ee;te+=4)O(this,te,te+3),O(this,te+1,te+2);return this},l.prototype.swap64=function(){const ee=this.length;if(ee%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let te=0;te<ee;te+=8)O(this,te,te+7),O(this,te+1,te+6),O(this,te+2,te+5),O(this,te+3,te+4);return this},l.prototype.toString=function(){const ee=this.length;return ee===0?"":arguments.length===0?D(this,0,ee):E.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(ee){if(!l.isBuffer(ee))throw new TypeError("Argument must be a Buffer");return this===ee?!0:l.compare(this,ee)===0},l.prototype.inspect=function(){let ee="";const te=t.INSPECT_MAX_BYTES;return ee=this.toString("hex",0,te).replace(/(.{2})/g,"$1 ").trim(),this.length>te&&(ee+=" ... "),"<Buffer "+ee+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(ee,te,fe,_e,Te){if(je(ee,Uint8Array)&&(ee=l.from(ee,ee.offset,ee.byteLength)),!l.isBuffer(ee))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ee);if(te===void 0&&(te=0),fe===void 0&&(fe=ee?ee.length:0),_e===void 0&&(_e=0),Te===void 0&&(Te=this.length),te<0||fe>ee.length||_e<0||Te>this.length)throw new RangeError("out of range index");if(_e>=Te&&te>=fe)return 0;if(_e>=Te)return-1;if(te>=fe)return 1;if(te>>>=0,fe>>>=0,_e>>>=0,Te>>>=0,this===ee)return 0;let Ae=Te-_e,Fe=fe-te;const st=Math.min(Ae,Fe),it=this.slice(_e,Te),lt=ee.slice(te,fe);for(let yt=0;yt<st;++yt)if(it[yt]!==lt[yt]){Ae=it[yt],Fe=lt[yt];break}return Ae<Fe?-1:Fe<Ae?1:0};function F(ie,ee,te,fe,_e){if(ie.length===0)return-1;if(typeof te=="string"?(fe=te,te=0):te>2147483647?te=2147483647:te<-2147483648&&(te=-2147483648),te=+te,Ie(te)&&(te=_e?0:ie.length-1),te<0&&(te=ie.length+te),te>=ie.length){if(_e)return-1;te=ie.length-1}else if(te<0)if(_e)te=0;else return-1;if(typeof ee=="string"&&(ee=l.from(ee,fe)),l.isBuffer(ee))return ee.length===0?-1:z(ie,ee,te,fe,_e);if(typeof ee=="number")return ee=ee&255,typeof Uint8Array.prototype.indexOf=="function"?_e?Uint8Array.prototype.indexOf.call(ie,ee,te):Uint8Array.prototype.lastIndexOf.call(ie,ee,te):z(ie,[ee],te,fe,_e);throw new TypeError("val must be string, number or Buffer")}function z(ie,ee,te,fe,_e){let Te=1,Ae=ie.length,Fe=ee.length;if(fe!==void 0&&(fe=String(fe).toLowerCase(),fe==="ucs2"||fe==="ucs-2"||fe==="utf16le"||fe==="utf-16le")){if(ie.length<2||ee.length<2)return-1;Te=2,Ae/=2,Fe/=2,te/=2}function st(lt,yt){return Te===1?lt[yt]:lt.readUInt16BE(yt*Te)}let it;if(_e){let lt=-1;for(it=te;it<Ae;it++)if(st(ie,it)===st(ee,lt===-1?0:it-lt)){if(lt===-1&&(lt=it),it-lt+1===Fe)return lt*Te}else lt!==-1&&(it-=it-lt),lt=-1}else for(te+Fe>Ae&&(te=Ae-Fe),it=te;it>=0;it--){let lt=!0;for(let yt=0;yt<Fe;yt++)if(st(ie,it+yt)!==st(ee,yt)){lt=!1;break}if(lt)return it}return-1}l.prototype.includes=function(ee,te,fe){return this.indexOf(ee,te,fe)!==-1},l.prototype.indexOf=function(ee,te,fe){return F(this,ee,te,fe,!0)},l.prototype.lastIndexOf=function(ee,te,fe){return F(this,ee,te,fe,!1)};function P(ie,ee,te,fe){te=Number(te)||0;const _e=ie.length-te;fe?(fe=Number(fe),fe>_e&&(fe=_e)):fe=_e;const Te=ee.length;fe>Te/2&&(fe=Te/2);let Ae;for(Ae=0;Ae<fe;++Ae){const Fe=parseInt(ee.substr(Ae*2,2),16);if(Ie(Fe))return Ae;ie[te+Ae]=Fe}return Ae}function U(ie,ee,te,fe){return Oe(ue(ee,ie.length-te),ie,te,fe)}function W(ie,ee,te,fe){return Oe(Se(ee),ie,te,fe)}function Y(ie,ee,te,fe){return Oe(Me(ee),ie,te,fe)}function q(ie,ee,te,fe){return Oe(ke(ee,ie.length-te),ie,te,fe)}l.prototype.write=function(ee,te,fe,_e){if(te===void 0)_e="utf8",fe=this.length,te=0;else if(fe===void 0&&typeof te=="string")_e=te,fe=this.length,te=0;else if(isFinite(te))te=te>>>0,isFinite(fe)?(fe=fe>>>0,_e===void 0&&(_e="utf8")):(_e=fe,fe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Te=this.length-te;if((fe===void 0||fe>Te)&&(fe=Te),ee.length>0&&(fe<0||te<0)||te>this.length)throw new RangeError("Attempt to write outside buffer bounds");_e||(_e="utf8");let Ae=!1;for(;;)switch(_e){case"hex":return P(this,ee,te,fe);case"utf8":case"utf-8":return U(this,ee,te,fe);case"ascii":case"latin1":case"binary":return W(this,ee,te,fe);case"base64":return Y(this,ee,te,fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,ee,te,fe);default:if(Ae)throw new TypeError("Unknown encoding: "+_e);_e=(""+_e).toLowerCase(),Ae=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(ie,ee,te){return ee===0&&te===ie.length?s.fromByteArray(ie):s.fromByteArray(ie.slice(ee,te))}function D(ie,ee,te){te=Math.min(ie.length,te);const fe=[];let _e=ee;for(;_e<te;){const Te=ie[_e];let Ae=null,Fe=Te>239?4:Te>223?3:Te>191?2:1;if(_e+Fe<=te){let st,it,lt,yt;switch(Fe){case 1:Te<128&&(Ae=Te);break;case 2:st=ie[_e+1],(st&192)===128&&(yt=(Te&31)<<6|st&63,yt>127&&(Ae=yt));break;case 3:st=ie[_e+1],it=ie[_e+2],(st&192)===128&&(it&192)===128&&(yt=(Te&15)<<12|(st&63)<<6|it&63,yt>2047&&(yt<55296||yt>57343)&&(Ae=yt));break;case 4:st=ie[_e+1],it=ie[_e+2],lt=ie[_e+3],(st&192)===128&&(it&192)===128&&(lt&192)===128&&(yt=(Te&15)<<18|(st&63)<<12|(it&63)<<6|lt&63,yt>65535&&yt<1114112&&(Ae=yt))}}Ae===null?(Ae=65533,Fe=1):Ae>65535&&(Ae-=65536,fe.push(Ae>>>10&1023|55296),Ae=56320|Ae&1023),fe.push(Ae),_e+=Fe}return C(fe)}const T=4096;function C(ie){const ee=ie.length;if(ee<=T)return String.fromCharCode.apply(String,ie);let te="",fe=0;for(;fe<ee;)te+=String.fromCharCode.apply(String,ie.slice(fe,fe+=T));return te}function S(ie,ee,te){let fe="";te=Math.min(ie.length,te);for(let _e=ee;_e<te;++_e)fe+=String.fromCharCode(ie[_e]&127);return fe}function w(ie,ee,te){let fe="";te=Math.min(ie.length,te);for(let _e=ee;_e<te;++_e)fe+=String.fromCharCode(ie[_e]);return fe}function j(ie,ee,te){const fe=ie.length;(!ee||ee<0)&&(ee=0),(!te||te<0||te>fe)&&(te=fe);let _e="";for(let Te=ee;Te<te;++Te)_e+=Pe[ie[Te]];return _e}function A(ie,ee,te){const fe=ie.slice(ee,te);let _e="";for(let Te=0;Te<fe.length-1;Te+=2)_e+=String.fromCharCode(fe[Te]+fe[Te+1]*256);return _e}l.prototype.slice=function(ee,te){const fe=this.length;ee=~~ee,te=te===void 0?fe:~~te,ee<0?(ee+=fe,ee<0&&(ee=0)):ee>fe&&(ee=fe),te<0?(te+=fe,te<0&&(te=0)):te>fe&&(te=fe),te<ee&&(te=ee);const _e=this.subarray(ee,te);return Object.setPrototypeOf(_e,l.prototype),_e};function L(ie,ee,te){if(ie%1!==0||ie<0)throw new RangeError("offset is not uint");if(ie+ee>te)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(ee,te,fe){ee=ee>>>0,te=te>>>0,fe||L(ee,te,this.length);let _e=this[ee],Te=1,Ae=0;for(;++Ae<te&&(Te*=256);)_e+=this[ee+Ae]*Te;return _e},l.prototype.readUintBE=l.prototype.readUIntBE=function(ee,te,fe){ee=ee>>>0,te=te>>>0,fe||L(ee,te,this.length);let _e=this[ee+--te],Te=1;for(;te>0&&(Te*=256);)_e+=this[ee+--te]*Te;return _e},l.prototype.readUint8=l.prototype.readUInt8=function(ee,te){return ee=ee>>>0,te||L(ee,1,this.length),this[ee]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(ee,te){return ee=ee>>>0,te||L(ee,2,this.length),this[ee]|this[ee+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(ee,te){return ee=ee>>>0,te||L(ee,2,this.length),this[ee]<<8|this[ee+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(ee,te){return ee=ee>>>0,te||L(ee,4,this.length),(this[ee]|this[ee+1]<<8|this[ee+2]<<16)+this[ee+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(ee,te){return ee=ee>>>0,te||L(ee,4,this.length),this[ee]*16777216+(this[ee+1]<<16|this[ee+2]<<8|this[ee+3])},l.prototype.readBigUInt64LE=He(function(ee){ee=ee>>>0,le(ee,"offset");const te=this[ee],fe=this[ee+7];(te===void 0||fe===void 0)&&he(ee,this.length-8);const _e=te+this[++ee]*2**8+this[++ee]*2**16+this[++ee]*2**24,Te=this[++ee]+this[++ee]*2**8+this[++ee]*2**16+fe*2**24;return BigInt(_e)+(BigInt(Te)<<BigInt(32))}),l.prototype.readBigUInt64BE=He(function(ee){ee=ee>>>0,le(ee,"offset");const te=this[ee],fe=this[ee+7];(te===void 0||fe===void 0)&&he(ee,this.length-8);const _e=te*2**24+this[++ee]*2**16+this[++ee]*2**8+this[++ee],Te=this[++ee]*2**24+this[++ee]*2**16+this[++ee]*2**8+fe;return(BigInt(_e)<<BigInt(32))+BigInt(Te)}),l.prototype.readIntLE=function(ee,te,fe){ee=ee>>>0,te=te>>>0,fe||L(ee,te,this.length);let _e=this[ee],Te=1,Ae=0;for(;++Ae<te&&(Te*=256);)_e+=this[ee+Ae]*Te;return Te*=128,_e>=Te&&(_e-=Math.pow(2,8*te)),_e},l.prototype.readIntBE=function(ee,te,fe){ee=ee>>>0,te=te>>>0,fe||L(ee,te,this.length);let _e=te,Te=1,Ae=this[ee+--_e];for(;_e>0&&(Te*=256);)Ae+=this[ee+--_e]*Te;return Te*=128,Ae>=Te&&(Ae-=Math.pow(2,8*te)),Ae},l.prototype.readInt8=function(ee,te){return ee=ee>>>0,te||L(ee,1,this.length),this[ee]&128?(255-this[ee]+1)*-1:this[ee]},l.prototype.readInt16LE=function(ee,te){ee=ee>>>0,te||L(ee,2,this.length);const fe=this[ee]|this[ee+1]<<8;return fe&32768?fe|4294901760:fe},l.prototype.readInt16BE=function(ee,te){ee=ee>>>0,te||L(ee,2,this.length);const fe=this[ee+1]|this[ee]<<8;return fe&32768?fe|4294901760:fe},l.prototype.readInt32LE=function(ee,te){return ee=ee>>>0,te||L(ee,4,this.length),this[ee]|this[ee+1]<<8|this[ee+2]<<16|this[ee+3]<<24},l.prototype.readInt32BE=function(ee,te){return ee=ee>>>0,te||L(ee,4,this.length),this[ee]<<24|this[ee+1]<<16|this[ee+2]<<8|this[ee+3]},l.prototype.readBigInt64LE=He(function(ee){ee=ee>>>0,le(ee,"offset");const te=this[ee],fe=this[ee+7];(te===void 0||fe===void 0)&&he(ee,this.length-8);const _e=this[ee+4]+this[ee+5]*2**8+this[ee+6]*2**16+(fe<<24);return(BigInt(_e)<<BigInt(32))+BigInt(te+this[++ee]*2**8+this[++ee]*2**16+this[++ee]*2**24)}),l.prototype.readBigInt64BE=He(function(ee){ee=ee>>>0,le(ee,"offset");const te=this[ee],fe=this[ee+7];(te===void 0||fe===void 0)&&he(ee,this.length-8);const _e=(te<<24)+this[++ee]*2**16+this[++ee]*2**8+this[++ee];return(BigInt(_e)<<BigInt(32))+BigInt(this[++ee]*2**24+this[++ee]*2**16+this[++ee]*2**8+fe)}),l.prototype.readFloatLE=function(ee,te){return ee=ee>>>0,te||L(ee,4,this.length),e.read(this,ee,!0,23,4)},l.prototype.readFloatBE=function(ee,te){return ee=ee>>>0,te||L(ee,4,this.length),e.read(this,ee,!1,23,4)},l.prototype.readDoubleLE=function(ee,te){return ee=ee>>>0,te||L(ee,8,this.length),e.read(this,ee,!0,52,8)},l.prototype.readDoubleBE=function(ee,te){return ee=ee>>>0,te||L(ee,8,this.length),e.read(this,ee,!1,52,8)};function I(ie,ee,te,fe,_e,Te){if(!l.isBuffer(ie))throw new TypeError('"buffer" argument must be a Buffer instance');if(ee>_e||ee<Te)throw new RangeError('"value" argument is out of bounds');if(te+fe>ie.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(ee,te,fe,_e){if(ee=+ee,te=te>>>0,fe=fe>>>0,!_e){const Fe=Math.pow(2,8*fe)-1;I(this,ee,te,fe,Fe,0)}let Te=1,Ae=0;for(this[te]=ee&255;++Ae<fe&&(Te*=256);)this[te+Ae]=ee/Te&255;return te+fe},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(ee,te,fe,_e){if(ee=+ee,te=te>>>0,fe=fe>>>0,!_e){const Fe=Math.pow(2,8*fe)-1;I(this,ee,te,fe,Fe,0)}let Te=fe-1,Ae=1;for(this[te+Te]=ee&255;--Te>=0&&(Ae*=256);)this[te+Te]=ee/Ae&255;return te+fe},l.prototype.writeUint8=l.prototype.writeUInt8=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,1,255,0),this[te]=ee&255,te+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,2,65535,0),this[te]=ee&255,this[te+1]=ee>>>8,te+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,2,65535,0),this[te]=ee>>>8,this[te+1]=ee&255,te+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,4,4294967295,0),this[te+3]=ee>>>24,this[te+2]=ee>>>16,this[te+1]=ee>>>8,this[te]=ee&255,te+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,4,4294967295,0),this[te]=ee>>>24,this[te+1]=ee>>>16,this[te+2]=ee>>>8,this[te+3]=ee&255,te+4};function Z(ie,ee,te,fe,_e){se(ee,fe,_e,ie,te,7);let Te=Number(ee&BigInt(4294967295));ie[te++]=Te,Te=Te>>8,ie[te++]=Te,Te=Te>>8,ie[te++]=Te,Te=Te>>8,ie[te++]=Te;let Ae=Number(ee>>BigInt(32)&BigInt(4294967295));return ie[te++]=Ae,Ae=Ae>>8,ie[te++]=Ae,Ae=Ae>>8,ie[te++]=Ae,Ae=Ae>>8,ie[te++]=Ae,te}function K(ie,ee,te,fe,_e){se(ee,fe,_e,ie,te,7);let Te=Number(ee&BigInt(4294967295));ie[te+7]=Te,Te=Te>>8,ie[te+6]=Te,Te=Te>>8,ie[te+5]=Te,Te=Te>>8,ie[te+4]=Te;let Ae=Number(ee>>BigInt(32)&BigInt(4294967295));return ie[te+3]=Ae,Ae=Ae>>8,ie[te+2]=Ae,Ae=Ae>>8,ie[te+1]=Ae,Ae=Ae>>8,ie[te]=Ae,te+8}l.prototype.writeBigUInt64LE=He(function(ee,te=0){return Z(this,ee,te,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=He(function(ee,te=0){return K(this,ee,te,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(ee,te,fe,_e){if(ee=+ee,te=te>>>0,!_e){const st=Math.pow(2,8*fe-1);I(this,ee,te,fe,st-1,-st)}let Te=0,Ae=1,Fe=0;for(this[te]=ee&255;++Te<fe&&(Ae*=256);)ee<0&&Fe===0&&this[te+Te-1]!==0&&(Fe=1),this[te+Te]=(ee/Ae>>0)-Fe&255;return te+fe},l.prototype.writeIntBE=function(ee,te,fe,_e){if(ee=+ee,te=te>>>0,!_e){const st=Math.pow(2,8*fe-1);I(this,ee,te,fe,st-1,-st)}let Te=fe-1,Ae=1,Fe=0;for(this[te+Te]=ee&255;--Te>=0&&(Ae*=256);)ee<0&&Fe===0&&this[te+Te+1]!==0&&(Fe=1),this[te+Te]=(ee/Ae>>0)-Fe&255;return te+fe},l.prototype.writeInt8=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,1,127,-128),ee<0&&(ee=255+ee+1),this[te]=ee&255,te+1},l.prototype.writeInt16LE=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,2,32767,-32768),this[te]=ee&255,this[te+1]=ee>>>8,te+2},l.prototype.writeInt16BE=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,2,32767,-32768),this[te]=ee>>>8,this[te+1]=ee&255,te+2},l.prototype.writeInt32LE=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,4,2147483647,-2147483648),this[te]=ee&255,this[te+1]=ee>>>8,this[te+2]=ee>>>16,this[te+3]=ee>>>24,te+4},l.prototype.writeInt32BE=function(ee,te,fe){return ee=+ee,te=te>>>0,fe||I(this,ee,te,4,2147483647,-2147483648),ee<0&&(ee=4294967295+ee+1),this[te]=ee>>>24,this[te+1]=ee>>>16,this[te+2]=ee>>>8,this[te+3]=ee&255,te+4},l.prototype.writeBigInt64LE=He(function(ee,te=0){return Z(this,ee,te,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=He(function(ee,te=0){return K(this,ee,te,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function re(ie,ee,te,fe,_e,Te){if(te+fe>ie.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("Index out of range")}function G(ie,ee,te,fe,_e){return ee=+ee,te=te>>>0,_e||re(ie,ee,te,4),e.write(ie,ee,te,fe,23,4),te+4}l.prototype.writeFloatLE=function(ee,te,fe){return G(this,ee,te,!0,fe)},l.prototype.writeFloatBE=function(ee,te,fe){return G(this,ee,te,!1,fe)};function ae(ie,ee,te,fe,_e){return ee=+ee,te=te>>>0,_e||re(ie,ee,te,8),e.write(ie,ee,te,fe,52,8),te+8}l.prototype.writeDoubleLE=function(ee,te,fe){return ae(this,ee,te,!0,fe)},l.prototype.writeDoubleBE=function(ee,te,fe){return ae(this,ee,te,!1,fe)},l.prototype.copy=function(ee,te,fe,_e){if(!l.isBuffer(ee))throw new TypeError("argument should be a Buffer");if(fe||(fe=0),!_e&&_e!==0&&(_e=this.length),te>=ee.length&&(te=ee.length),te||(te=0),_e>0&&_e<fe&&(_e=fe),_e===fe||ee.length===0||this.length===0)return 0;if(te<0)throw new RangeError("targetStart out of bounds");if(fe<0||fe>=this.length)throw new RangeError("Index out of range");if(_e<0)throw new RangeError("sourceEnd out of bounds");_e>this.length&&(_e=this.length),ee.length-te<_e-fe&&(_e=ee.length-te+fe);const Te=_e-fe;return this===ee&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(te,fe,_e):Uint8Array.prototype.set.call(ee,this.subarray(fe,_e),te),Te},l.prototype.fill=function(ee,te,fe,_e){if(typeof ee=="string"){if(typeof te=="string"?(_e=te,te=0,fe=this.length):typeof fe=="string"&&(_e=fe,fe=this.length),_e!==void 0&&typeof _e!="string")throw new TypeError("encoding must be a string");if(typeof _e=="string"&&!l.isEncoding(_e))throw new TypeError("Unknown encoding: "+_e);if(ee.length===1){const Ae=ee.charCodeAt(0);(_e==="utf8"&&Ae<128||_e==="latin1")&&(ee=Ae)}}else typeof ee=="number"?ee=ee&255:typeof ee=="boolean"&&(ee=Number(ee));if(te<0||this.length<te||this.length<fe)throw new RangeError("Out of range index");if(fe<=te)return this;te=te>>>0,fe=fe===void 0?this.length:fe>>>0,ee||(ee=0);let Te;if(typeof ee=="number")for(Te=te;Te<fe;++Te)this[Te]=ee;else{const Ae=l.isBuffer(ee)?ee:l.from(ee,_e),Fe=Ae.length;if(Fe===0)throw new TypeError('The value "'+ee+'" is invalid for argument "value"');for(Te=0;Te<fe-te;++Te)this[Te+te]=Ae[Te%Fe]}return this};const V={};function H(ie,ee,te){V[ie]=class extends te{constructor(){super(),Object.defineProperty(this,"message",{value:ee.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ie}]`,this.stack,delete this.name}get code(){return ie}set code(_e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:_e,writable:!0})}toString(){return`${this.name} [${ie}]: ${this.message}`}}}H("ERR_BUFFER_OUT_OF_BOUNDS",function(ie){return ie?`${ie} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),H("ERR_INVALID_ARG_TYPE",function(ie,ee){return`The "${ie}" argument must be of type number. Received type ${typeof ee}`},TypeError),H("ERR_OUT_OF_RANGE",function(ie,ee,te){let fe=`The value of "${ie}" is out of range.`,_e=te;return Number.isInteger(te)&&Math.abs(te)>2**32?_e=Q(String(te)):typeof te=="bigint"&&(_e=String(te),(te>BigInt(2)**BigInt(32)||te<-(BigInt(2)**BigInt(32)))&&(_e=Q(_e)),_e+="n"),fe+=` It must be ${ee}. Received ${_e}`,fe},RangeError);function Q(ie){let ee="",te=ie.length;const fe=ie[0]==="-"?1:0;for(;te>=fe+4;te-=3)ee=`_${ie.slice(te-3,te)}${ee}`;return`${ie.slice(0,te)}${ee}`}function oe(ie,ee,te){le(ee,"offset"),(ie[ee]===void 0||ie[ee+te]===void 0)&&he(ee,ie.length-(te+1))}function se(ie,ee,te,fe,_e,Te){if(ie>te||ie<ee){const Ae=typeof ee=="bigint"?"n":"";let Fe;throw ee===0||ee===BigInt(0)?Fe=`>= 0${Ae} and < 2${Ae} ** ${(Te+1)*8}${Ae}`:Fe=`>= -(2${Ae} ** ${(Te+1)*8-1}${Ae}) and < 2 ** ${(Te+1)*8-1}${Ae}`,new V.ERR_OUT_OF_RANGE("value",Fe,ie)}oe(fe,_e,Te)}function le(ie,ee){if(typeof ie!="number")throw new V.ERR_INVALID_ARG_TYPE(ee,"number",ie)}function he(ie,ee,te){throw Math.floor(ie)!==ie?(le(ie,te),new V.ERR_OUT_OF_RANGE("offset","an integer",ie)):ee<0?new V.ERR_BUFFER_OUT_OF_BOUNDS:new V.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${ee}`,ie)}const Ne=/[^+/0-9A-Za-z-_]/g;function we(ie){if(ie=ie.split("=")[0],ie=ie.trim().replace(Ne,""),ie.length<2)return"";for(;ie.length%4!==0;)ie=ie+"=";return ie}function ue(ie,ee){ee=ee||1/0;let te;const fe=ie.length;let _e=null;const Te=[];for(let Ae=0;Ae<fe;++Ae){if(te=ie.charCodeAt(Ae),te>55295&&te<57344){if(!_e){if(te>56319){(ee-=3)>-1&&Te.push(239,191,189);continue}else if(Ae+1===fe){(ee-=3)>-1&&Te.push(239,191,189);continue}_e=te;continue}if(te<56320){(ee-=3)>-1&&Te.push(239,191,189),_e=te;continue}te=(_e-55296<<10|te-56320)+65536}else _e&&(ee-=3)>-1&&Te.push(239,191,189);if(_e=null,te<128){if((ee-=1)<0)break;Te.push(te)}else if(te<2048){if((ee-=2)<0)break;Te.push(te>>6|192,te&63|128)}else if(te<65536){if((ee-=3)<0)break;Te.push(te>>12|224,te>>6&63|128,te&63|128)}else if(te<1114112){if((ee-=4)<0)break;Te.push(te>>18|240,te>>12&63|128,te>>6&63|128,te&63|128)}else throw new Error("Invalid code point")}return Te}function Se(ie){const ee=[];for(let te=0;te<ie.length;++te)ee.push(ie.charCodeAt(te)&255);return ee}function ke(ie,ee){let te,fe,_e;const Te=[];for(let Ae=0;Ae<ie.length&&!((ee-=2)<0);++Ae)te=ie.charCodeAt(Ae),fe=te>>8,_e=te%256,Te.push(_e),Te.push(fe);return Te}function Me(ie){return s.toByteArray(we(ie))}function Oe(ie,ee,te,fe){let _e;for(_e=0;_e<fe&&!(_e+te>=ee.length||_e>=ie.length);++_e)ee[_e+te]=ie[_e];return _e}function je(ie,ee){return ie instanceof ee||ie!=null&&ie.constructor!=null&&ie.constructor.name!=null&&ie.constructor.name===ee.name}function Ie(ie){return ie!==ie}const Pe=function(){const ie="0123456789abcdef",ee=new Array(256);for(let te=0;te<16;++te){const fe=te*16;for(let _e=0;_e<16;++_e)ee[fe+_e]=ie[te]+ie[_e]}return ee}();function He(ie){return typeof BigInt>"u"?ct:ie}function ct(){throw new Error("BigInt not supported")}}(rp)),rp}var P8=L8(),sp={exports:{}},Qt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _v;function B8(){if(_v)return Qt;_v=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),o=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function p(A){return A===null||typeof A!="object"?null:(A=g&&A[g]||A["@@iterator"],typeof A=="function"?A:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,x={};function b(A,L,I){this.props=A,this.context=L,this.refs=x,this.updater=I||h}b.prototype.isReactComponent={},b.prototype.setState=function(A,L){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,L,"setState")},b.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function v(){}v.prototype=b.prototype;function _(A,L,I){this.props=A,this.context=L,this.refs=x,this.updater=I||h}var N=_.prototype=new v;N.constructor=_,f(N,b.prototype),N.isPureReactComponent=!0;var E=Array.isArray,O={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function z(A,L,I,Z,K,re){return I=re.ref,{$$typeof:t,type:A,key:L,ref:I!==void 0?I:null,props:re}}function P(A,L){return z(A.type,L,void 0,void 0,void 0,A.props)}function U(A){return typeof A=="object"&&A!==null&&A.$$typeof===t}function W(A){var L={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(I){return L[I]})}var Y=/\/+/g;function q(A,L){return typeof A=="object"&&A!==null&&A.key!=null?W(""+A.key):L.toString(36)}function M(){}function D(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(M,M):(A.status="pending",A.then(function(L){A.status==="pending"&&(A.status="fulfilled",A.value=L)},function(L){A.status==="pending"&&(A.status="rejected",A.reason=L)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function T(A,L,I,Z,K){var re=typeof A;(re==="undefined"||re==="boolean")&&(A=null);var G=!1;if(A===null)G=!0;else switch(re){case"bigint":case"string":case"number":G=!0;break;case"object":switch(A.$$typeof){case t:case s:G=!0;break;case d:return G=A._init,T(G(A._payload),L,I,Z,K)}}if(G)return K=K(A),G=Z===""?"."+q(A,0):Z,E(K)?(I="",G!=null&&(I=G.replace(Y,"$&/")+"/"),T(K,L,I,"",function(H){return H})):K!=null&&(U(K)&&(K=P(K,I+(K.key==null||A&&A.key===K.key?"":(""+K.key).replace(Y,"$&/")+"/")+G)),L.push(K)),1;G=0;var ae=Z===""?".":Z+":";if(E(A))for(var V=0;V<A.length;V++)Z=A[V],re=ae+q(Z,V),G+=T(Z,L,I,re,K);else if(V=p(A),typeof V=="function")for(A=V.call(A),V=0;!(Z=A.next()).done;)Z=Z.value,re=ae+q(Z,V++),G+=T(Z,L,I,re,K);else if(re==="object"){if(typeof A.then=="function")return T(D(A),L,I,Z,K);throw L=String(A),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.")}return G}function C(A,L,I){if(A==null)return A;var Z=[],K=0;return T(A,Z,"","",function(re){return L.call(I,re,K++)}),Z}function S(A){if(A._status===-1){var L=A._result;L=L(),L.then(function(I){(A._status===0||A._status===-1)&&(A._status=1,A._result=I)},function(I){(A._status===0||A._status===-1)&&(A._status=2,A._result=I)}),A._status===-1&&(A._status=0,A._result=L)}if(A._status===1)return A._result.default;throw A._result}var w=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var L=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(L))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function j(){}return Qt.Children={map:C,forEach:function(A,L,I){C(A,function(){L.apply(this,arguments)},I)},count:function(A){var L=0;return C(A,function(){L++}),L},toArray:function(A){return C(A,function(L){return L})||[]},only:function(A){if(!U(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Qt.Component=b,Qt.Fragment=e,Qt.Profiler=n,Qt.PureComponent=_,Qt.StrictMode=a,Qt.Suspense=u,Qt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Qt.act=function(){throw Error("act(...) is not supported in production builds of React.")},Qt.cache=function(A){return function(){return A.apply(null,arguments)}},Qt.cloneElement=function(A,L,I){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var Z=f({},A.props),K=A.key,re=void 0;if(L!=null)for(G in L.ref!==void 0&&(re=void 0),L.key!==void 0&&(K=""+L.key),L)!F.call(L,G)||G==="key"||G==="__self"||G==="__source"||G==="ref"&&L.ref===void 0||(Z[G]=L[G]);var G=arguments.length-2;if(G===1)Z.children=I;else if(1<G){for(var ae=Array(G),V=0;V<G;V++)ae[V]=arguments[V+2];Z.children=ae}return z(A.type,K,void 0,void 0,re,Z)},Qt.createContext=function(A){return A={$$typeof:c,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:i,_context:A},A},Qt.createElement=function(A,L,I){var Z,K={},re=null;if(L!=null)for(Z in L.key!==void 0&&(re=""+L.key),L)F.call(L,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(K[Z]=L[Z]);var G=arguments.length-2;if(G===1)K.children=I;else if(1<G){for(var ae=Array(G),V=0;V<G;V++)ae[V]=arguments[V+2];K.children=ae}if(A&&A.defaultProps)for(Z in G=A.defaultProps,G)K[Z]===void 0&&(K[Z]=G[Z]);return z(A,re,void 0,void 0,null,K)},Qt.createRef=function(){return{current:null}},Qt.forwardRef=function(A){return{$$typeof:l,render:A}},Qt.isValidElement=U,Qt.lazy=function(A){return{$$typeof:d,_payload:{_status:-1,_result:A},_init:S}},Qt.memo=function(A,L){return{$$typeof:o,type:A,compare:L===void 0?null:L}},Qt.startTransition=function(A){var L=O.T,I={};O.T=I;try{var Z=A(),K=O.S;K!==null&&K(I,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(j,w)}catch(re){w(re)}finally{O.T=L}},Qt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Qt.use=function(A){return O.H.use(A)},Qt.useActionState=function(A,L,I){return O.H.useActionState(A,L,I)},Qt.useCallback=function(A,L){return O.H.useCallback(A,L)},Qt.useContext=function(A){return O.H.useContext(A)},Qt.useDebugValue=function(){},Qt.useDeferredValue=function(A,L){return O.H.useDeferredValue(A,L)},Qt.useEffect=function(A,L){return O.H.useEffect(A,L)},Qt.useId=function(){return O.H.useId()},Qt.useImperativeHandle=function(A,L,I){return O.H.useImperativeHandle(A,L,I)},Qt.useInsertionEffect=function(A,L){return O.H.useInsertionEffect(A,L)},Qt.useLayoutEffect=function(A,L){return O.H.useLayoutEffect(A,L)},Qt.useMemo=function(A,L){return O.H.useMemo(A,L)},Qt.useOptimistic=function(A,L){return O.H.useOptimistic(A,L)},Qt.useReducer=function(A,L,I){return O.H.useReducer(A,L,I)},Qt.useRef=function(A){return O.H.useRef(A)},Qt.useState=function(A){return O.H.useState(A)},Qt.useSyncExternalStore=function(A,L,I){return O.H.useSyncExternalStore(A,L,I)},Qt.useTransition=function(){return O.H.useTransition()},Qt.version="19.0.0",Qt}var wv;function Tg(){return wv||(wv=1,sp.exports=B8()),sp.exports}var ne=Tg();const D8=Eg(ne),Nv=O8({__proto__:null,default:D8},[ne]);var ap={exports:{}},uu={},np={exports:{}},ip={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv;function U8(){return jv||(jv=1,function(t){function s(C,S){var w=C.length;C.push(S);e:for(;0<w;){var j=w-1>>>1,A=C[j];if(0<n(A,S))C[j]=S,C[w]=A,w=j;else break e}}function e(C){return C.length===0?null:C[0]}function a(C){if(C.length===0)return null;var S=C[0],w=C.pop();if(w!==S){C[0]=w;e:for(var j=0,A=C.length,L=A>>>1;j<L;){var I=2*(j+1)-1,Z=C[I],K=I+1,re=C[K];if(0>n(Z,w))K<A&&0>n(re,Z)?(C[j]=re,C[K]=w,j=K):(C[j]=Z,C[I]=w,j=I);else if(K<A&&0>n(re,w))C[j]=re,C[K]=w,j=K;else break e}}return S}function n(C,S){var w=C.sortIndex-S.sortIndex;return w!==0?w:C.id-S.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var c=Date,l=c.now();t.unstable_now=function(){return c.now()-l}}var u=[],o=[],d=1,g=null,p=3,h=!1,f=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function N(C){for(var S=e(o);S!==null;){if(S.callback===null)a(o);else if(S.startTime<=C)a(o),S.sortIndex=S.expirationTime,s(u,S);else break;S=e(o)}}function E(C){if(x=!1,N(C),!f)if(e(u)!==null)f=!0,D();else{var S=e(o);S!==null&&T(E,S.startTime-C)}}var O=!1,F=-1,z=5,P=-1;function U(){return!(t.unstable_now()-P<z)}function W(){if(O){var C=t.unstable_now();P=C;var S=!0;try{e:{f=!1,x&&(x=!1,v(F),F=-1),h=!0;var w=p;try{t:{for(N(C),g=e(u);g!==null&&!(g.expirationTime>C&&U());){var j=g.callback;if(typeof j=="function"){g.callback=null,p=g.priorityLevel;var A=j(g.expirationTime<=C);if(C=t.unstable_now(),typeof A=="function"){g.callback=A,N(C),S=!0;break t}g===e(u)&&a(u),N(C)}else a(u);g=e(u)}if(g!==null)S=!0;else{var L=e(o);L!==null&&T(E,L.startTime-C),S=!1}}break e}finally{g=null,p=w,h=!1}S=void 0}}finally{S?Y():O=!1}}}var Y;if(typeof _=="function")Y=function(){_(W)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,M=q.port2;q.port1.onmessage=W,Y=function(){M.postMessage(null)}}else Y=function(){b(W,0)};function D(){O||(O=!0,Y())}function T(C,S){F=b(function(){C(t.unstable_now())},S)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(C){C.callback=null},t.unstable_continueExecution=function(){f||h||(f=!0,D())},t.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<C?Math.floor(1e3/C):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return e(u)},t.unstable_next=function(C){switch(p){case 1:case 2:case 3:var S=3;break;default:S=p}var w=p;p=S;try{return C()}finally{p=w}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(C,S){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var w=p;p=C;try{return S()}finally{p=w}},t.unstable_scheduleCallback=function(C,S,w){var j=t.unstable_now();switch(typeof w=="object"&&w!==null?(w=w.delay,w=typeof w=="number"&&0<w?j+w:j):w=j,C){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=w+A,C={id:d++,callback:S,priorityLevel:C,startTime:w,expirationTime:A,sortIndex:-1},w>j?(C.sortIndex=w,s(o,C),e(u)===null&&C===e(o)&&(x?(v(F),F=-1):x=!0,T(E,w-j))):(C.sortIndex=A,s(u,C),f||h||(f=!0,D())),C},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(C){var S=p;return function(){var w=p;p=S;try{return C.apply(this,arguments)}finally{p=w}}}}(ip)),ip}var Sv;function $8(){return Sv||(Sv=1,np.exports=U8()),np.exports}var op={exports:{}},Fs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv;function z8(){if(kv)return Fs;kv=1;var t=Tg();function s(u){var o="https://react.dev/errors/"+u;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var a={d:{f:e,r:function(){throw Error(s(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},n=Symbol.for("react.portal");function i(u,o,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:g==null?null:""+g,children:u,containerInfo:o,implementation:d}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,o){if(u==="font")return"";if(typeof o=="string")return o==="use-credentials"?o:""}return Fs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Fs.createPortal=function(u,o){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)throw Error(s(299));return i(u,o,null,d)},Fs.flushSync=function(u){var o=c.T,d=a.p;try{if(c.T=null,a.p=2,u)return u()}finally{c.T=o,a.p=d,a.d.f()}},Fs.preconnect=function(u,o){typeof u=="string"&&(o?(o=o.crossOrigin,o=typeof o=="string"?o==="use-credentials"?o:"":void 0):o=null,a.d.C(u,o))},Fs.prefetchDNS=function(u){typeof u=="string"&&a.d.D(u)},Fs.preinit=function(u,o){if(typeof u=="string"&&o&&typeof o.as=="string"){var d=o.as,g=l(d,o.crossOrigin),p=typeof o.integrity=="string"?o.integrity:void 0,h=typeof o.fetchPriority=="string"?o.fetchPriority:void 0;d==="style"?a.d.S(u,typeof o.precedence=="string"?o.precedence:void 0,{crossOrigin:g,integrity:p,fetchPriority:h}):d==="script"&&a.d.X(u,{crossOrigin:g,integrity:p,fetchPriority:h,nonce:typeof o.nonce=="string"?o.nonce:void 0})}},Fs.preinitModule=function(u,o){if(typeof u=="string")if(typeof o=="object"&&o!==null){if(o.as==null||o.as==="script"){var d=l(o.as,o.crossOrigin);a.d.M(u,{crossOrigin:d,integrity:typeof o.integrity=="string"?o.integrity:void 0,nonce:typeof o.nonce=="string"?o.nonce:void 0})}}else o==null&&a.d.M(u)},Fs.preload=function(u,o){if(typeof u=="string"&&typeof o=="object"&&o!==null&&typeof o.as=="string"){var d=o.as,g=l(d,o.crossOrigin);a.d.L(u,d,{crossOrigin:g,integrity:typeof o.integrity=="string"?o.integrity:void 0,nonce:typeof o.nonce=="string"?o.nonce:void 0,type:typeof o.type=="string"?o.type:void 0,fetchPriority:typeof o.fetchPriority=="string"?o.fetchPriority:void 0,referrerPolicy:typeof o.referrerPolicy=="string"?o.referrerPolicy:void 0,imageSrcSet:typeof o.imageSrcSet=="string"?o.imageSrcSet:void 0,imageSizes:typeof o.imageSizes=="string"?o.imageSizes:void 0,media:typeof o.media=="string"?o.media:void 0})}},Fs.preloadModule=function(u,o){if(typeof u=="string")if(o){var d=l(o.as,o.crossOrigin);a.d.m(u,{as:typeof o.as=="string"&&o.as!=="script"?o.as:void 0,crossOrigin:d,integrity:typeof o.integrity=="string"?o.integrity:void 0})}else a.d.m(u)},Fs.requestFormReset=function(u){a.d.r(u)},Fs.unstable_batchedUpdates=function(u,o){return u(o)},Fs.useFormState=function(u,o,d){return c.H.useFormState(u,o,d)},Fs.useFormStatus=function(){return c.H.useHostTransitionStatus()},Fs.version="19.0.0",Fs}var Cv;function dw(){if(Cv)return op.exports;Cv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),op.exports=z8(),op.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ev;function H8(){if(Ev)return uu;Ev=1;var t=$8(),s=Tg(),e=dw();function a(m){var y="https://react.dev/errors/"+m;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var k=2;k<arguments.length;k++)y+="&args[]="+encodeURIComponent(arguments[k])}return"Minified React error #"+m+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}var i=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),p=Symbol.for("react.consumer"),h=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),E=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function F(m){return m===null||typeof m!="object"?null:(m=O&&m[O]||m["@@iterator"],typeof m=="function"?m:null)}var z=Symbol.for("react.client.reference");function P(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===z?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case u:return"Fragment";case l:return"Portal";case d:return"Profiler";case o:return"StrictMode";case x:return"Suspense";case b:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case h:return(m.displayName||"Context")+".Provider";case p:return(m._context.displayName||"Context")+".Consumer";case f:var y=m.render;return m=m.displayName,m||(m=y.displayName||y.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case v:return y=m.displayName||null,y!==null?y:P(m.type)||"Memo";case _:y=m._payload,m=m._init;try{return P(m(y))}catch{}}return null}var U=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=Object.assign,Y,q;function M(m){if(Y===void 0)try{throw Error()}catch(k){var y=k.stack.trim().match(/\n( *(at )?)/);Y=y&&y[1]||"",q=-1<k.stack.indexOf(`
    at`)?" (<anonymous>)":-1<k.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Y+m+q}var D=!1;function T(m,y){if(!m||D)return"";D=!0;var k=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var R={DetermineComponentFrameRoot:function(){try{if(y){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch(rt){var Xe=rt}Reflect.construct(m,[],mt)}else{try{mt.call()}catch(rt){Xe=rt}m.call(mt.prototype)}}else{try{throw Error()}catch(rt){Xe=rt}(mt=m())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch(rt){if(rt&&Xe&&typeof rt.stack=="string")return[rt.stack,Xe.stack]}return[null,null]}};R.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var X=Object.getOwnPropertyDescriptor(R.DetermineComponentFrameRoot,"name");X&&X.configurable&&Object.defineProperty(R.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var J=R.DetermineComponentFrameRoot(),ce=J[0],xe=J[1];if(ce&&xe){var Ee=ce.split(`
`),Ue=xe.split(`
`);for(X=R=0;R<Ee.length&&!Ee[R].includes("DetermineComponentFrameRoot");)R++;for(;X<Ue.length&&!Ue[X].includes("DetermineComponentFrameRoot");)X++;if(R===Ee.length||X===Ue.length)for(R=Ee.length-1,X=Ue.length-1;1<=R&&0<=X&&Ee[R]!==Ue[X];)X--;for(;1<=R&&0<=X;R--,X--)if(Ee[R]!==Ue[X]){if(R!==1||X!==1)do if(R--,X--,0>X||Ee[R]!==Ue[X]){var at=`
`+Ee[R].replace(" at new "," at ");return m.displayName&&at.includes("<anonymous>")&&(at=at.replace("<anonymous>",m.displayName)),at}while(1<=R&&0<=X);break}}}finally{D=!1,Error.prepareStackTrace=k}return(k=m?m.displayName||m.name:"")?M(k):""}function C(m){switch(m.tag){case 26:case 27:case 5:return M(m.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 15:return m=T(m.type,!1),m;case 11:return m=T(m.type.render,!1),m;case 1:return m=T(m.type,!0),m;default:return""}}function S(m){try{var y="";do y+=C(m),m=m.return;while(m);return y}catch(k){return`
Error generating stack: `+k.message+`
`+k.stack}}function w(m){var y=m,k=m;if(m.alternate)for(;y.return;)y=y.return;else{m=y;do y=m,y.flags&4098&&(k=y.return),m=y.return;while(m)}return y.tag===3?k:null}function j(m){if(m.tag===13){var y=m.memoizedState;if(y===null&&(m=m.alternate,m!==null&&(y=m.memoizedState)),y!==null)return y.dehydrated}return null}function A(m){if(w(m)!==m)throw Error(a(188))}function L(m){var y=m.alternate;if(!y){if(y=w(m),y===null)throw Error(a(188));return y!==m?null:m}for(var k=m,R=y;;){var X=k.return;if(X===null)break;var J=X.alternate;if(J===null){if(R=X.return,R!==null){k=R;continue}break}if(X.child===J.child){for(J=X.child;J;){if(J===k)return A(X),m;if(J===R)return A(X),y;J=J.sibling}throw Error(a(188))}if(k.return!==R.return)k=X,R=J;else{for(var ce=!1,xe=X.child;xe;){if(xe===k){ce=!0,k=X,R=J;break}if(xe===R){ce=!0,R=X,k=J;break}xe=xe.sibling}if(!ce){for(xe=J.child;xe;){if(xe===k){ce=!0,k=J,R=X;break}if(xe===R){ce=!0,R=J,k=X;break}xe=xe.sibling}if(!ce)throw Error(a(189))}}if(k.alternate!==R)throw Error(a(190))}if(k.tag!==3)throw Error(a(188));return k.stateNode.current===k?m:y}function I(m){var y=m.tag;if(y===5||y===26||y===27||y===6)return m;for(m=m.child;m!==null;){if(y=I(m),y!==null)return y;m=m.sibling}return null}var Z=Array.isArray,K=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},G=[],ae=-1;function V(m){return{current:m}}function H(m){0>ae||(m.current=G[ae],G[ae]=null,ae--)}function Q(m,y){ae++,G[ae]=m.current,m.current=y}var oe=V(null),se=V(null),le=V(null),he=V(null);function Ne(m,y){switch(Q(le,y),Q(se,m),Q(oe,null),m=y.nodeType,m){case 9:case 11:y=(y=y.documentElement)&&(y=y.namespaceURI)?qy(y):0;break;default:if(m=m===8?y.parentNode:y,y=m.tagName,m=m.namespaceURI)m=qy(m),y=Gy(m,y);else switch(y){case"svg":y=1;break;case"math":y=2;break;default:y=0}}H(oe),Q(oe,y)}function we(){H(oe),H(se),H(le)}function ue(m){m.memoizedState!==null&&Q(he,m);var y=oe.current,k=Gy(y,m.type);y!==k&&(Q(se,m),Q(oe,k))}function Se(m){se.current===m&&(H(oe),H(se)),he.current===m&&(H(he),su._currentValue=re)}var ke=Object.prototype.hasOwnProperty,Me=t.unstable_scheduleCallback,Oe=t.unstable_cancelCallback,je=t.unstable_shouldYield,Ie=t.unstable_requestPaint,Pe=t.unstable_now,He=t.unstable_getCurrentPriorityLevel,ct=t.unstable_ImmediatePriority,ie=t.unstable_UserBlockingPriority,ee=t.unstable_NormalPriority,te=t.unstable_LowPriority,fe=t.unstable_IdlePriority,_e=t.log,Te=t.unstable_setDisableYieldValue,Ae=null,Fe=null;function st(m){if(Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot(Ae,m,void 0,(m.current.flags&128)===128)}catch{}}function it(m){if(typeof _e=="function"&&Te(m),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode(Ae,m)}catch{}}var lt=Math.clz32?Math.clz32:Nt,yt=Math.log,vt=Math.LN2;function Nt(m){return m>>>=0,m===0?32:31-(yt(m)/vt|0)|0}var Mt=128,Et=4194304;function _t(m){var y=m&42;if(y!==0)return y;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function Tt(m,y){var k=m.pendingLanes;if(k===0)return 0;var R=0,X=m.suspendedLanes,J=m.pingedLanes,ce=m.warmLanes;m=m.finishedLanes!==0;var xe=k&134217727;return xe!==0?(k=xe&~X,k!==0?R=_t(k):(J&=xe,J!==0?R=_t(J):m||(ce=xe&~ce,ce!==0&&(R=_t(ce))))):(xe=k&~X,xe!==0?R=_t(xe):J!==0?R=_t(J):m||(ce=k&~ce,ce!==0&&(R=_t(ce)))),R===0?0:y!==0&&y!==R&&!(y&X)&&(X=R&-R,ce=y&-y,X>=ce||X===32&&(ce&4194176)!==0)?y:R}function ut(m,y){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&y)===0}function jt(m,y){switch(m){case 1:case 2:case 4:case 8:return y+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ke(){var m=Mt;return Mt<<=1,!(Mt&4194176)&&(Mt=128),m}function Vt(){var m=Et;return Et<<=1,!(Et&62914560)&&(Et=4194304),m}function St(m){for(var y=[],k=0;31>k;k++)y.push(m);return y}function et(m,y){m.pendingLanes|=y,y!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function ot(m,y,k,R,X,J){var ce=m.pendingLanes;m.pendingLanes=k,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=k,m.entangledLanes&=k,m.errorRecoveryDisabledLanes&=k,m.shellSuspendCounter=0;var xe=m.entanglements,Ee=m.expirationTimes,Ue=m.hiddenUpdates;for(k=ce&~k;0<k;){var at=31-lt(k),mt=1<<at;xe[at]=0,Ee[at]=-1;var Xe=Ue[at];if(Xe!==null)for(Ue[at]=null,at=0;at<Xe.length;at++){var rt=Xe[at];rt!==null&&(rt.lane&=-536870913)}k&=~mt}R!==0&&At(m,R,0),J!==0&&X===0&&m.tag!==0&&(m.suspendedLanes|=J&~(ce&~y))}function At(m,y,k){m.pendingLanes|=y,m.suspendedLanes&=~y;var R=31-lt(y);m.entangledLanes|=y,m.entanglements[R]=m.entanglements[R]|1073741824|k&4194218}function Re(m,y){var k=m.entangledLanes|=y;for(m=m.entanglements;k;){var R=31-lt(k),X=1<<R;X&y|m[R]&y&&(m[R]|=y),k&=~X}}function Ve(m){return m&=-m,2<m?8<m?m&134217727?32:268435456:8:2}function Qe(){var m=K.p;return m!==0?m:(m=window.event,m===void 0?32:uv(m.type))}function de(m,y){var k=K.p;try{return K.p=m,y()}finally{K.p=k}}var be=Math.random().toString(36).slice(2),me="__reactFiber$"+be,ge="__reactProps$"+be,ye="__reactContainer$"+be,ve="__reactEvents$"+be,Le="__reactListeners$"+be,qe="__reactHandles$"+be,Be="__reactResources$"+be,$e="__reactMarker$"+be;function ze(m){delete m[me],delete m[ge],delete m[ve],delete m[Le],delete m[qe]}function nt(m){var y=m[me];if(y)return y;for(var k=m.parentNode;k;){if(y=k[ye]||k[me]){if(k=y.alternate,y.child!==null||k!==null&&k.child!==null)for(m=Xy(m);m!==null;){if(k=m[me])return k;m=Xy(m)}return y}m=k,k=m.parentNode}return null}function ht(m){if(m=m[me]||m[ye]){var y=m.tag;if(y===5||y===6||y===13||y===26||y===27||y===3)return m}return null}function xt(m){var y=m.tag;if(y===5||y===26||y===27||y===6)return m.stateNode;throw Error(a(33))}function pe(m){var y=m[Be];return y||(y=m[Be]={hoistableStyles:new Map,hoistableScripts:new Map}),y}function Ce(m){m[$e]=!0}var Ye=new Set,tt={};function gt(m,y){ft(m,y),ft(m+"Capture",y)}function ft(m,y){for(tt[m]=y,m=0;m<y.length;m++)Ye.add(y[m])}var pt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Dt={},Ut={};function Ot(m){return ke.call(Ut,m)?!0:ke.call(Dt,m)?!1:Yt.test(m)?Ut[m]=!0:(Dt[m]=!0,!1)}function Gt(m,y,k){if(Ot(y))if(k===null)m.removeAttribute(y);else{switch(typeof k){case"undefined":case"function":case"symbol":m.removeAttribute(y);return;case"boolean":var R=y.toLowerCase().slice(0,5);if(R!=="data-"&&R!=="aria-"){m.removeAttribute(y);return}}m.setAttribute(y,""+k)}}function or(m,y,k){if(k===null)m.removeAttribute(y);else{switch(typeof k){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(y);return}m.setAttribute(y,""+k)}}function Jt(m,y,k,R){if(R===null)m.removeAttribute(k);else{switch(typeof R){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(k);return}m.setAttributeNS(y,k,""+R)}}function ar(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function Yr(m){var y=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function ws(m){var y=Yr(m)?"checked":"value",k=Object.getOwnPropertyDescriptor(m.constructor.prototype,y),R=""+m[y];if(!m.hasOwnProperty(y)&&typeof k<"u"&&typeof k.get=="function"&&typeof k.set=="function"){var X=k.get,J=k.set;return Object.defineProperty(m,y,{configurable:!0,get:function(){return X.call(this)},set:function(ce){R=""+ce,J.call(this,ce)}}),Object.defineProperty(m,y,{enumerable:k.enumerable}),{getValue:function(){return R},setValue:function(ce){R=""+ce},stopTracking:function(){m._valueTracker=null,delete m[y]}}}}function As(m){m._valueTracker||(m._valueTracker=ws(m))}function wn(m){if(!m)return!1;var y=m._valueTracker;if(!y)return!0;var k=y.getValue(),R="";return m&&(R=Yr(m)?m.checked?"true":"false":m.value),m=R,m!==k?(y.setValue(m),!0):!1}function rn(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var _i=/[\n"\\]/g;function ls(m){return m.replace(_i,function(y){return"\\"+y.charCodeAt(0).toString(16)+" "})}function ur(m,y,k,R,X,J,ce,xe){m.name="",ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?m.type=ce:m.removeAttribute("type"),y!=null?ce==="number"?(y===0&&m.value===""||m.value!=y)&&(m.value=""+ar(y)):m.value!==""+ar(y)&&(m.value=""+ar(y)):ce!=="submit"&&ce!=="reset"||m.removeAttribute("value"),y!=null?Ma(m,ce,ar(y)):k!=null?Ma(m,ce,ar(k)):R!=null&&m.removeAttribute("value"),X==null&&J!=null&&(m.defaultChecked=!!J),X!=null&&(m.checked=X&&typeof X!="function"&&typeof X!="symbol"),xe!=null&&typeof xe!="function"&&typeof xe!="symbol"&&typeof xe!="boolean"?m.name=""+ar(xe):m.removeAttribute("name")}function rr(m,y,k,R,X,J,ce,xe){if(J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"&&(m.type=J),y!=null||k!=null){if(!(J!=="submit"&&J!=="reset"||y!=null))return;k=k!=null?""+ar(k):"",y=y!=null?""+ar(y):k,xe||y===m.value||(m.value=y),m.defaultValue=y}R=R??X,R=typeof R!="function"&&typeof R!="symbol"&&!!R,m.checked=xe?m.checked:!!R,m.defaultChecked=!!R,ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"&&(m.name=ce)}function Ma(m,y,k){y==="number"&&rn(m.ownerDocument)===m||m.defaultValue===""+k||(m.defaultValue=""+k)}function aa(m,y,k,R){if(m=m.options,y){y={};for(var X=0;X<k.length;X++)y["$"+k[X]]=!0;for(k=0;k<m.length;k++)X=y.hasOwnProperty("$"+m[k].value),m[k].selected!==X&&(m[k].selected=X),X&&R&&(m[k].defaultSelected=!0)}else{for(k=""+ar(k),y=null,X=0;X<m.length;X++){if(m[X].value===k){m[X].selected=!0,R&&(m[X].defaultSelected=!0);return}y!==null||m[X].disabled||(y=m[X])}y!==null&&(y.selected=!0)}}function oo(m,y,k){if(y!=null&&(y=""+ar(y),y!==m.value&&(m.value=y),k==null)){m.defaultValue!==y&&(m.defaultValue=y);return}m.defaultValue=k!=null?""+ar(k):""}function Os(m,y,k,R){if(y==null){if(R!=null){if(k!=null)throw Error(a(92));if(Z(R)){if(1<R.length)throw Error(a(93));R=R[0]}k=R}k==null&&(k=""),y=k}k=ar(y),m.defaultValue=k,R=m.textContent,R===k&&R!==""&&R!==null&&(m.value=R)}function Rs(m,y){if(y){var k=m.firstChild;if(k&&k===m.lastChild&&k.nodeType===3){k.nodeValue=y;return}}m.textContent=y}var Nn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wi(m,y,k){var R=y.indexOf("--")===0;k==null||typeof k=="boolean"||k===""?R?m.setProperty(y,""):y==="float"?m.cssFloat="":m[y]="":R?m.setProperty(y,k):typeof k!="number"||k===0||Nn.has(y)?y==="float"?m.cssFloat=k:m[y]=(""+k).trim():m[y]=k+"px"}function lo(m,y,k){if(y!=null&&typeof y!="object")throw Error(a(62));if(m=m.style,k!=null){for(var R in k)!k.hasOwnProperty(R)||y!=null&&y.hasOwnProperty(R)||(R.indexOf("--")===0?m.setProperty(R,""):R==="float"?m.cssFloat="":m[R]="");for(var X in y)R=y[X],y.hasOwnProperty(X)&&k[X]!==R&&wi(m,X,R)}else for(var J in y)y.hasOwnProperty(J)&&wi(m,J,y[J])}function jn(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),md=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qn(m){return md.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}var co=null;function Ni(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var sn=null,Gn=null;function uo(m){var y=ht(m);if(y&&(m=y.stateNode)){var k=m[ge]||null;e:switch(m=y.stateNode,y.type){case"input":if(ur(m,k.value,k.defaultValue,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name),y=k.name,k.type==="radio"&&y!=null){for(k=m;k.parentNode;)k=k.parentNode;for(k=k.querySelectorAll('input[name="'+ls(""+y)+'"][type="radio"]'),y=0;y<k.length;y++){var R=k[y];if(R!==m&&R.form===m.form){var X=R[ge]||null;if(!X)throw Error(a(90));ur(R,X.value,X.defaultValue,X.defaultValue,X.checked,X.defaultChecked,X.type,X.name)}}for(y=0;y<k.length;y++)R=k[y],R.form===m.form&&wn(R)}break e;case"textarea":oo(m,k.value,k.defaultValue);break e;case"select":y=k.value,y!=null&&aa(m,!!k.multiple,y,!1)}}}var ji=!1;function rb(m,y,k){if(ji)return m(y,k);ji=!0;try{var R=m(y);return R}finally{if(ji=!1,(sn!==null||Gn!==null)&&(Zd(),sn&&(y=sn,m=Gn,Gn=sn=null,uo(y),m)))for(y=0;y<m.length;y++)uo(m[y])}}function xc(m,y){var k=m.stateNode;if(k===null)return null;var R=k[ge]||null;if(R===null)return null;k=R[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(R=!R.disabled)||(m=m.type,R=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!R;break e;default:m=!1}if(m)return null;if(k&&typeof k!="function")throw Error(a(231,y,typeof k));return k}var nh=!1;if(pt)try{var bc={};Object.defineProperty(bc,"passive",{get:function(){nh=!0}}),window.addEventListener("test",bc,bc),window.removeEventListener("test",bc,bc)}catch{nh=!1}var Si=null,ih=null,pd=null;function sb(){if(pd)return pd;var m,y=ih,k=y.length,R,X="value"in Si?Si.value:Si.textContent,J=X.length;for(m=0;m<k&&y[m]===X[m];m++);var ce=k-m;for(R=1;R<=ce&&y[k-R]===X[J-R];R++);return pd=X.slice(m,1<R?1-R:void 0)}function gd(m){var y=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&y===13&&(m=13)):m=y,m===10&&(m=13),32<=m||m===13?m:0}function xd(){return!0}function ab(){return!1}function na(m){function y(k,R,X,J,ce){this._reactName=k,this._targetInst=X,this.type=R,this.nativeEvent=J,this.target=ce,this.currentTarget=null;for(var xe in m)m.hasOwnProperty(xe)&&(k=m[xe],this[xe]=k?k(J):J[xe]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?xd:ab,this.isPropagationStopped=ab,this}return W(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var k=this.nativeEvent;k&&(k.preventDefault?k.preventDefault():typeof k.returnValue!="unknown"&&(k.returnValue=!1),this.isDefaultPrevented=xd)},stopPropagation:function(){var k=this.nativeEvent;k&&(k.stopPropagation?k.stopPropagation():typeof k.cancelBubble!="unknown"&&(k.cancelBubble=!0),this.isPropagationStopped=xd)},persist:function(){},isPersistent:xd}),y}var fo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bd=na(fo),yc=W({},fo,{view:0,detail:0}),ON=na(yc),oh,lh,vc,yd=W({},yc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uh,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==vc&&(vc&&m.type==="mousemove"?(oh=m.screenX-vc.screenX,lh=m.screenY-vc.screenY):lh=oh=0,vc=m),oh)},movementY:function(m){return"movementY"in m?m.movementY:lh}}),nb=na(yd),RN=W({},yd,{dataTransfer:0}),MN=na(RN),FN=W({},yc,{relatedTarget:0}),ch=na(FN),IN=W({},fo,{animationName:0,elapsedTime:0,pseudoElement:0}),LN=na(IN),PN=W({},fo,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),BN=na(PN),DN=W({},fo,{data:0}),ib=na(DN),UN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$N={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HN(m){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(m):(m=zN[m])?!!y[m]:!1}function uh(){return HN}var VN=W({},yc,{key:function(m){if(m.key){var y=UN[m.key]||m.key;if(y!=="Unidentified")return y}return m.type==="keypress"?(m=gd(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?$N[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uh,charCode:function(m){return m.type==="keypress"?gd(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?gd(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),qN=na(VN),GN=W({},yd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ob=na(GN),YN=W({},yc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uh}),WN=na(YN),XN=W({},fo,{propertyName:0,elapsedTime:0,pseudoElement:0}),KN=na(XN),ZN=W({},yd,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),QN=na(ZN),JN=W({},fo,{newState:0,oldState:0}),ej=na(JN),tj=[9,13,27,32],dh=pt&&"CompositionEvent"in window,_c=null;pt&&"documentMode"in document&&(_c=document.documentMode);var rj=pt&&"TextEvent"in window&&!_c,lb=pt&&(!dh||_c&&8<_c&&11>=_c),cb=" ",ub=!1;function db(m,y){switch(m){case"keyup":return tj.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fb(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var ol=!1;function sj(m,y){switch(m){case"compositionend":return fb(y);case"keypress":return y.which!==32?null:(ub=!0,cb);case"textInput":return m=y.data,m===cb&&ub?null:m;default:return null}}function aj(m,y){if(ol)return m==="compositionend"||!dh&&db(m,y)?(m=sb(),pd=ih=Si=null,ol=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return lb&&y.locale!=="ko"?null:y.data;default:return null}}var nj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hb(m){var y=m&&m.nodeName&&m.nodeName.toLowerCase();return y==="input"?!!nj[m.type]:y==="textarea"}function mb(m,y,k,R){sn?Gn?Gn.push(R):Gn=[R]:sn=R,y=rf(y,"onChange"),0<y.length&&(k=new bd("onChange","change",null,k,R),m.push({event:k,listeners:y}))}var wc=null,Nc=null;function ij(m){Uy(m,0)}function vd(m){var y=xt(m);if(wn(y))return m}function pb(m,y){if(m==="change")return y}var gb=!1;if(pt){var fh;if(pt){var hh="oninput"in document;if(!hh){var xb=document.createElement("div");xb.setAttribute("oninput","return;"),hh=typeof xb.oninput=="function"}fh=hh}else fh=!1;gb=fh&&(!document.documentMode||9<document.documentMode)}function bb(){wc&&(wc.detachEvent("onpropertychange",yb),Nc=wc=null)}function yb(m){if(m.propertyName==="value"&&vd(Nc)){var y=[];mb(y,Nc,m,Ni(m)),rb(ij,y)}}function oj(m,y,k){m==="focusin"?(bb(),wc=y,Nc=k,wc.attachEvent("onpropertychange",yb)):m==="focusout"&&bb()}function lj(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return vd(Nc)}function cj(m,y){if(m==="click")return vd(y)}function uj(m,y){if(m==="input"||m==="change")return vd(y)}function dj(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var xa=typeof Object.is=="function"?Object.is:dj;function jc(m,y){if(xa(m,y))return!0;if(typeof m!="object"||m===null||typeof y!="object"||y===null)return!1;var k=Object.keys(m),R=Object.keys(y);if(k.length!==R.length)return!1;for(R=0;R<k.length;R++){var X=k[R];if(!ke.call(y,X)||!xa(m[X],y[X]))return!1}return!0}function vb(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function _b(m,y){var k=vb(m);m=0;for(var R;k;){if(k.nodeType===3){if(R=m+k.textContent.length,m<=y&&R>=y)return{node:k,offset:y-m};m=R}e:{for(;k;){if(k.nextSibling){k=k.nextSibling;break e}k=k.parentNode}k=void 0}k=vb(k)}}function wb(m,y){return m&&y?m===y?!0:m&&m.nodeType===3?!1:y&&y.nodeType===3?wb(m,y.parentNode):"contains"in m?m.contains(y):m.compareDocumentPosition?!!(m.compareDocumentPosition(y)&16):!1:!1}function Nb(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var y=rn(m.document);y instanceof m.HTMLIFrameElement;){try{var k=typeof y.contentWindow.location.href=="string"}catch{k=!1}if(k)m=y.contentWindow;else break;y=rn(m.document)}return y}function mh(m){var y=m&&m.nodeName&&m.nodeName.toLowerCase();return y&&(y==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||y==="textarea"||m.contentEditable==="true")}function fj(m,y){var k=Nb(y);y=m.focusedElem;var R=m.selectionRange;if(k!==y&&y&&y.ownerDocument&&wb(y.ownerDocument.documentElement,y)){if(R!==null&&mh(y)){if(m=R.start,k=R.end,k===void 0&&(k=m),"selectionStart"in y)y.selectionStart=m,y.selectionEnd=Math.min(k,y.value.length);else if(k=(m=y.ownerDocument||document)&&m.defaultView||window,k.getSelection){k=k.getSelection();var X=y.textContent.length,J=Math.min(R.start,X);R=R.end===void 0?J:Math.min(R.end,X),!k.extend&&J>R&&(X=R,R=J,J=X),X=_b(y,J);var ce=_b(y,R);X&&ce&&(k.rangeCount!==1||k.anchorNode!==X.node||k.anchorOffset!==X.offset||k.focusNode!==ce.node||k.focusOffset!==ce.offset)&&(m=m.createRange(),m.setStart(X.node,X.offset),k.removeAllRanges(),J>R?(k.addRange(m),k.extend(ce.node,ce.offset)):(m.setEnd(ce.node,ce.offset),k.addRange(m)))}}for(m=[],k=y;k=k.parentNode;)k.nodeType===1&&m.push({element:k,left:k.scrollLeft,top:k.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<m.length;y++)k=m[y],k.element.scrollLeft=k.left,k.element.scrollTop=k.top}}var hj=pt&&"documentMode"in document&&11>=document.documentMode,ll=null,ph=null,Sc=null,gh=!1;function jb(m,y,k){var R=k.window===k?k.document:k.nodeType===9?k:k.ownerDocument;gh||ll==null||ll!==rn(R)||(R=ll,"selectionStart"in R&&mh(R)?R={start:R.selectionStart,end:R.selectionEnd}:(R=(R.ownerDocument&&R.ownerDocument.defaultView||window).getSelection(),R={anchorNode:R.anchorNode,anchorOffset:R.anchorOffset,focusNode:R.focusNode,focusOffset:R.focusOffset}),Sc&&jc(Sc,R)||(Sc=R,R=rf(ph,"onSelect"),0<R.length&&(y=new bd("onSelect","select",null,y,k),m.push({event:y,listeners:R}),y.target=ll)))}function ho(m,y){var k={};return k[m.toLowerCase()]=y.toLowerCase(),k["Webkit"+m]="webkit"+y,k["Moz"+m]="moz"+y,k}var cl={animationend:ho("Animation","AnimationEnd"),animationiteration:ho("Animation","AnimationIteration"),animationstart:ho("Animation","AnimationStart"),transitionrun:ho("Transition","TransitionRun"),transitionstart:ho("Transition","TransitionStart"),transitioncancel:ho("Transition","TransitionCancel"),transitionend:ho("Transition","TransitionEnd")},xh={},Sb={};pt&&(Sb=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function mo(m){if(xh[m])return xh[m];if(!cl[m])return m;var y=cl[m],k;for(k in y)if(y.hasOwnProperty(k)&&k in Sb)return xh[m]=y[k];return m}var kb=mo("animationend"),Cb=mo("animationiteration"),Eb=mo("animationstart"),mj=mo("transitionrun"),pj=mo("transitionstart"),gj=mo("transitioncancel"),Tb=mo("transitionend"),Ab=new Map,Ob="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function an(m,y){Ab.set(m,y),gt(y,[m])}var Fa=[],ul=0,bh=0;function _d(){for(var m=ul,y=bh=ul=0;y<m;){var k=Fa[y];Fa[y++]=null;var R=Fa[y];Fa[y++]=null;var X=Fa[y];Fa[y++]=null;var J=Fa[y];if(Fa[y++]=null,R!==null&&X!==null){var ce=R.pending;ce===null?X.next=X:(X.next=ce.next,ce.next=X),R.pending=X}J!==0&&Rb(k,X,J)}}function wd(m,y,k,R){Fa[ul++]=m,Fa[ul++]=y,Fa[ul++]=k,Fa[ul++]=R,bh|=R,m.lanes|=R,m=m.alternate,m!==null&&(m.lanes|=R)}function yh(m,y,k,R){return wd(m,y,k,R),Nd(m)}function ki(m,y){return wd(m,null,null,y),Nd(m)}function Rb(m,y,k){m.lanes|=k;var R=m.alternate;R!==null&&(R.lanes|=k);for(var X=!1,J=m.return;J!==null;)J.childLanes|=k,R=J.alternate,R!==null&&(R.childLanes|=k),J.tag===22&&(m=J.stateNode,m===null||m._visibility&1||(X=!0)),m=J,J=J.return;X&&y!==null&&m.tag===3&&(J=m.stateNode,X=31-lt(k),J=J.hiddenUpdates,m=J[X],m===null?J[X]=[y]:m.push(y),y.lane=k|536870912)}function Nd(m){if(50<Kc)throw Kc=0,Sm=null,Error(a(185));for(var y=m.return;y!==null;)m=y,y=m.return;return m.tag===3?m.stateNode:null}var dl={},Mb=new WeakMap;function Ia(m,y){if(typeof m=="object"&&m!==null){var k=Mb.get(m);return k!==void 0?k:(y={value:m,source:y,stack:S(y)},Mb.set(m,y),y)}return{value:m,source:y,stack:S(y)}}var fl=[],hl=0,jd=null,Sd=0,La=[],Pa=0,po=null,Yn=1,Wn="";function go(m,y){fl[hl++]=Sd,fl[hl++]=jd,jd=m,Sd=y}function Fb(m,y,k){La[Pa++]=Yn,La[Pa++]=Wn,La[Pa++]=po,po=m;var R=Yn;m=Wn;var X=32-lt(R)-1;R&=~(1<<X),k+=1;var J=32-lt(y)+X;if(30<J){var ce=X-X%5;J=(R&(1<<ce)-1).toString(32),R>>=ce,X-=ce,Yn=1<<32-lt(y)+X|k<<X|R,Wn=J+m}else Yn=1<<J|k<<X|R,Wn=m}function vh(m){m.return!==null&&(go(m,1),Fb(m,1,0))}function _h(m){for(;m===jd;)jd=fl[--hl],fl[hl]=null,Sd=fl[--hl],fl[hl]=null;for(;m===po;)po=La[--Pa],La[Pa]=null,Wn=La[--Pa],La[Pa]=null,Yn=La[--Pa],La[Pa]=null}var Ws=null,Ns=null,xr=!1,nn=null,kn=!1,wh=Error(a(519));function xo(m){var y=Error(a(418,""));throw Ec(Ia(y,m)),wh}function Ib(m){var y=m.stateNode,k=m.type,R=m.memoizedProps;switch(y[me]=m,y[ge]=R,k){case"dialog":lr("cancel",y),lr("close",y);break;case"iframe":case"object":case"embed":lr("load",y);break;case"video":case"audio":for(k=0;k<Qc.length;k++)lr(Qc[k],y);break;case"source":lr("error",y);break;case"img":case"image":case"link":lr("error",y),lr("load",y);break;case"details":lr("toggle",y);break;case"input":lr("invalid",y),rr(y,R.value,R.defaultValue,R.checked,R.defaultChecked,R.type,R.name,!0),As(y);break;case"select":lr("invalid",y);break;case"textarea":lr("invalid",y),Os(y,R.value,R.defaultValue,R.children),As(y)}k=R.children,typeof k!="string"&&typeof k!="number"&&typeof k!="bigint"||y.textContent===""+k||R.suppressHydrationWarning===!0||Vy(y.textContent,k)?(R.popover!=null&&(lr("beforetoggle",y),lr("toggle",y)),R.onScroll!=null&&lr("scroll",y),R.onScrollEnd!=null&&lr("scrollend",y),R.onClick!=null&&(y.onclick=sf),y=!0):y=!1,y||xo(m)}function Lb(m){for(Ws=m.return;Ws;)switch(Ws.tag){case 3:case 27:kn=!0;return;case 5:case 13:kn=!1;return;default:Ws=Ws.return}}function kc(m){if(m!==Ws)return!1;if(!xr)return Lb(m),xr=!0,!1;var y=!1,k;if((k=m.tag!==3&&m.tag!==27)&&((k=m.tag===5)&&(k=m.type,k=!(k!=="form"&&k!=="button")||zm(m.type,m.memoizedProps)),k=!k),k&&(y=!0),y&&Ns&&xo(m),Lb(m),m.tag===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));e:{for(m=m.nextSibling,y=0;m;){if(m.nodeType===8)if(k=m.data,k==="/$"){if(y===0){Ns=ln(m.nextSibling);break e}y--}else k!=="$"&&k!=="$!"&&k!=="$?"||y++;m=m.nextSibling}Ns=null}}else Ns=Ws?ln(m.stateNode.nextSibling):null;return!0}function Cc(){Ns=Ws=null,xr=!1}function Ec(m){nn===null?nn=[m]:nn.push(m)}var Tc=Error(a(460)),Pb=Error(a(474)),Nh={then:function(){}};function Bb(m){return m=m.status,m==="fulfilled"||m==="rejected"}function kd(){}function Db(m,y,k){switch(k=m[k],k===void 0?m.push(y):k!==y&&(y.then(kd,kd),y=k),y.status){case"fulfilled":return y.value;case"rejected":throw m=y.reason,m===Tc?Error(a(483)):m;default:if(typeof y.status=="string")y.then(kd,kd);else{if(m=Tr,m!==null&&100<m.shellSuspendCounter)throw Error(a(482));m=y,m.status="pending",m.then(function(R){if(y.status==="pending"){var X=y;X.status="fulfilled",X.value=R}},function(R){if(y.status==="pending"){var X=y;X.status="rejected",X.reason=R}})}switch(y.status){case"fulfilled":return y.value;case"rejected":throw m=y.reason,m===Tc?Error(a(483)):m}throw Ac=y,Tc}}var Ac=null;function Ub(){if(Ac===null)throw Error(a(459));var m=Ac;return Ac=null,m}var ml=null,Oc=0;function Cd(m){var y=Oc;return Oc+=1,ml===null&&(ml=[]),Db(ml,m,y)}function Rc(m,y){y=y.props.ref,m.ref=y!==void 0?y:null}function Ed(m,y){throw y.$$typeof===i?Error(a(525)):(m=Object.prototype.toString.call(y),Error(a(31,m==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":m)))}function $b(m){var y=m._init;return y(m._payload)}function zb(m){function y(Ge,De){if(m){var We=Ge.deletions;We===null?(Ge.deletions=[De],Ge.flags|=16):We.push(De)}}function k(Ge,De){if(!m)return null;for(;De!==null;)y(Ge,De),De=De.sibling;return null}function R(Ge){for(var De=new Map;Ge!==null;)Ge.key!==null?De.set(Ge.key,Ge):De.set(Ge.index,Ge),Ge=Ge.sibling;return De}function X(Ge,De){return Ge=Bi(Ge,De),Ge.index=0,Ge.sibling=null,Ge}function J(Ge,De,We){return Ge.index=We,m?(We=Ge.alternate,We!==null?(We=We.index,We<De?(Ge.flags|=33554434,De):We):(Ge.flags|=33554434,De)):(Ge.flags|=1048576,De)}function ce(Ge){return m&&Ge.alternate===null&&(Ge.flags|=33554434),Ge}function xe(Ge,De,We,dt){return De===null||De.tag!==6?(De=xm(We,Ge.mode,dt),De.return=Ge,De):(De=X(De,We),De.return=Ge,De)}function Ee(Ge,De,We,dt){var kt=We.type;return kt===u?at(Ge,De,We.props.children,dt,We.key):De!==null&&(De.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===_&&$b(kt)===De.type)?(De=X(De,We.props),Rc(De,We),De.return=Ge,De):(De=Gd(We.type,We.key,We.props,null,Ge.mode,dt),Rc(De,We),De.return=Ge,De)}function Ue(Ge,De,We,dt){return De===null||De.tag!==4||De.stateNode.containerInfo!==We.containerInfo||De.stateNode.implementation!==We.implementation?(De=bm(We,Ge.mode,dt),De.return=Ge,De):(De=X(De,We.children||[]),De.return=Ge,De)}function at(Ge,De,We,dt,kt){return De===null||De.tag!==7?(De=Co(We,Ge.mode,dt,kt),De.return=Ge,De):(De=X(De,We),De.return=Ge,De)}function mt(Ge,De,We){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return De=xm(""+De,Ge.mode,We),De.return=Ge,De;if(typeof De=="object"&&De!==null){switch(De.$$typeof){case c:return We=Gd(De.type,De.key,De.props,null,Ge.mode,We),Rc(We,De),We.return=Ge,We;case l:return De=bm(De,Ge.mode,We),De.return=Ge,De;case _:var dt=De._init;return De=dt(De._payload),mt(Ge,De,We)}if(Z(De)||F(De))return De=Co(De,Ge.mode,We,null),De.return=Ge,De;if(typeof De.then=="function")return mt(Ge,Cd(De),We);if(De.$$typeof===h)return mt(Ge,Hd(Ge,De),We);Ed(Ge,De)}return null}function Xe(Ge,De,We,dt){var kt=De!==null?De.key:null;if(typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint")return kt!==null?null:xe(Ge,De,""+We,dt);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case c:return We.key===kt?Ee(Ge,De,We,dt):null;case l:return We.key===kt?Ue(Ge,De,We,dt):null;case _:return kt=We._init,We=kt(We._payload),Xe(Ge,De,We,dt)}if(Z(We)||F(We))return kt!==null?null:at(Ge,De,We,dt,null);if(typeof We.then=="function")return Xe(Ge,De,Cd(We),dt);if(We.$$typeof===h)return Xe(Ge,De,Hd(Ge,We),dt);Ed(Ge,We)}return null}function rt(Ge,De,We,dt,kt){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return Ge=Ge.get(We)||null,xe(De,Ge,""+dt,kt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case c:return Ge=Ge.get(dt.key===null?We:dt.key)||null,Ee(De,Ge,dt,kt);case l:return Ge=Ge.get(dt.key===null?We:dt.key)||null,Ue(De,Ge,dt,kt);case _:var tr=dt._init;return dt=tr(dt._payload),rt(Ge,De,We,dt,kt)}if(Z(dt)||F(dt))return Ge=Ge.get(We)||null,at(De,Ge,dt,kt,null);if(typeof dt.then=="function")return rt(Ge,De,We,Cd(dt),kt);if(dt.$$typeof===h)return rt(Ge,De,We,Hd(De,dt),kt);Ed(De,dt)}return null}function Rt(Ge,De,We,dt){for(var kt=null,tr=null,It=De,$t=De=0,gs=null;It!==null&&$t<We.length;$t++){It.index>$t?(gs=It,It=null):gs=It.sibling;var br=Xe(Ge,It,We[$t],dt);if(br===null){It===null&&(It=gs);break}m&&It&&br.alternate===null&&y(Ge,It),De=J(br,De,$t),tr===null?kt=br:tr.sibling=br,tr=br,It=gs}if($t===We.length)return k(Ge,It),xr&&go(Ge,$t),kt;if(It===null){for(;$t<We.length;$t++)It=mt(Ge,We[$t],dt),It!==null&&(De=J(It,De,$t),tr===null?kt=It:tr.sibling=It,tr=It);return xr&&go(Ge,$t),kt}for(It=R(It);$t<We.length;$t++)gs=rt(It,Ge,$t,We[$t],dt),gs!==null&&(m&&gs.alternate!==null&&It.delete(gs.key===null?$t:gs.key),De=J(gs,De,$t),tr===null?kt=gs:tr.sibling=gs,tr=gs);return m&&It.forEach(function(qi){return y(Ge,qi)}),xr&&go(Ge,$t),kt}function Wt(Ge,De,We,dt){if(We==null)throw Error(a(151));for(var kt=null,tr=null,It=De,$t=De=0,gs=null,br=We.next();It!==null&&!br.done;$t++,br=We.next()){It.index>$t?(gs=It,It=null):gs=It.sibling;var qi=Xe(Ge,It,br.value,dt);if(qi===null){It===null&&(It=gs);break}m&&It&&qi.alternate===null&&y(Ge,It),De=J(qi,De,$t),tr===null?kt=qi:tr.sibling=qi,tr=qi,It=gs}if(br.done)return k(Ge,It),xr&&go(Ge,$t),kt;if(It===null){for(;!br.done;$t++,br=We.next())br=mt(Ge,br.value,dt),br!==null&&(De=J(br,De,$t),tr===null?kt=br:tr.sibling=br,tr=br);return xr&&go(Ge,$t),kt}for(It=R(It);!br.done;$t++,br=We.next())br=rt(It,Ge,$t,br.value,dt),br!==null&&(m&&br.alternate!==null&&It.delete(br.key===null?$t:br.key),De=J(br,De,$t),tr===null?kt=br:tr.sibling=br,tr=br);return m&&It.forEach(function(A8){return y(Ge,A8)}),xr&&go(Ge,$t),kt}function zr(Ge,De,We,dt){if(typeof We=="object"&&We!==null&&We.type===u&&We.key===null&&(We=We.props.children),typeof We=="object"&&We!==null){switch(We.$$typeof){case c:e:{for(var kt=We.key;De!==null;){if(De.key===kt){if(kt=We.type,kt===u){if(De.tag===7){k(Ge,De.sibling),dt=X(De,We.props.children),dt.return=Ge,Ge=dt;break e}}else if(De.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===_&&$b(kt)===De.type){k(Ge,De.sibling),dt=X(De,We.props),Rc(dt,We),dt.return=Ge,Ge=dt;break e}k(Ge,De);break}else y(Ge,De);De=De.sibling}We.type===u?(dt=Co(We.props.children,Ge.mode,dt,We.key),dt.return=Ge,Ge=dt):(dt=Gd(We.type,We.key,We.props,null,Ge.mode,dt),Rc(dt,We),dt.return=Ge,Ge=dt)}return ce(Ge);case l:e:{for(kt=We.key;De!==null;){if(De.key===kt)if(De.tag===4&&De.stateNode.containerInfo===We.containerInfo&&De.stateNode.implementation===We.implementation){k(Ge,De.sibling),dt=X(De,We.children||[]),dt.return=Ge,Ge=dt;break e}else{k(Ge,De);break}else y(Ge,De);De=De.sibling}dt=bm(We,Ge.mode,dt),dt.return=Ge,Ge=dt}return ce(Ge);case _:return kt=We._init,We=kt(We._payload),zr(Ge,De,We,dt)}if(Z(We))return Rt(Ge,De,We,dt);if(F(We)){if(kt=F(We),typeof kt!="function")throw Error(a(150));return We=kt.call(We),Wt(Ge,De,We,dt)}if(typeof We.then=="function")return zr(Ge,De,Cd(We),dt);if(We.$$typeof===h)return zr(Ge,De,Hd(Ge,We),dt);Ed(Ge,We)}return typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint"?(We=""+We,De!==null&&De.tag===6?(k(Ge,De.sibling),dt=X(De,We),dt.return=Ge,Ge=dt):(k(Ge,De),dt=xm(We,Ge.mode,dt),dt.return=Ge,Ge=dt),ce(Ge)):k(Ge,De)}return function(Ge,De,We,dt){try{Oc=0;var kt=zr(Ge,De,We,dt);return ml=null,kt}catch(It){if(It===Tc)throw It;var tr=$a(29,It,null,Ge.mode);return tr.lanes=dt,tr.return=Ge,tr}finally{}}}var bo=zb(!0),Hb=zb(!1),pl=V(null),Td=V(0);function Vb(m,y){m=ni,Q(Td,m),Q(pl,y),ni=m|y.baseLanes}function jh(){Q(Td,ni),Q(pl,pl.current)}function Sh(){ni=Td.current,H(pl),H(Td)}var Ba=V(null),Cn=null;function Ci(m){var y=m.alternate;Q(cs,cs.current&1),Q(Ba,m),Cn===null&&(y===null||pl.current!==null||y.memoizedState!==null)&&(Cn=m)}function qb(m){if(m.tag===22){if(Q(cs,cs.current),Q(Ba,m),Cn===null){var y=m.alternate;y!==null&&y.memoizedState!==null&&(Cn=m)}}else Ei()}function Ei(){Q(cs,cs.current),Q(Ba,Ba.current)}function Xn(m){H(Ba),Cn===m&&(Cn=null),H(cs)}var cs=V(0);function Ad(m){for(var y=m;y!==null;){if(y.tag===13){var k=y.memoizedState;if(k!==null&&(k=k.dehydrated,k===null||k.data==="$?"||k.data==="$!"))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if(y.flags&128)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var xj=typeof AbortController<"u"?AbortController:function(){var m=[],y=this.signal={aborted:!1,addEventListener:function(k,R){m.push(R)}};this.abort=function(){y.aborted=!0,m.forEach(function(k){return k()})}},bj=t.unstable_scheduleCallback,yj=t.unstable_NormalPriority,us={$$typeof:h,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function kh(){return{controller:new xj,data:new Map,refCount:0}}function Mc(m){m.refCount--,m.refCount===0&&bj(yj,function(){m.controller.abort()})}var Fc=null,Ch=0,gl=0,xl=null;function vj(m,y){if(Fc===null){var k=Fc=[];Ch=0,gl=Mm(),xl={status:"pending",value:void 0,then:function(R){k.push(R)}}}return Ch++,y.then(Gb,Gb),y}function Gb(){if(--Ch===0&&Fc!==null){xl!==null&&(xl.status="fulfilled");var m=Fc;Fc=null,gl=0,xl=null;for(var y=0;y<m.length;y++)(0,m[y])()}}function _j(m,y){var k=[],R={status:"pending",value:null,reason:null,then:function(X){k.push(X)}};return m.then(function(){R.status="fulfilled",R.value=y;for(var X=0;X<k.length;X++)(0,k[X])(y)},function(X){for(R.status="rejected",R.reason=X,X=0;X<k.length;X++)(0,k[X])(void 0)}),R}var Yb=U.S;U.S=function(m,y){typeof y=="object"&&y!==null&&typeof y.then=="function"&&vj(m,y),Yb!==null&&Yb(m,y)};var yo=V(null);function Eh(){var m=yo.current;return m!==null?m:Tr.pooledCache}function Od(m,y){y===null?Q(yo,yo.current):Q(yo,y.pool)}function Wb(){var m=Eh();return m===null?null:{parent:us._currentValue,pool:m}}var Ti=0,er=null,Sr=null,ts=null,Rd=!1,bl=!1,vo=!1,Md=0,Ic=0,yl=null,wj=0;function Wr(){throw Error(a(321))}function Th(m,y){if(y===null)return!1;for(var k=0;k<y.length&&k<m.length;k++)if(!xa(m[k],y[k]))return!1;return!0}function Ah(m,y,k,R,X,J){return Ti=J,er=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,U.H=m===null||m.memoizedState===null?_o:Ai,vo=!1,J=k(R,X),vo=!1,bl&&(J=Kb(y,k,R,X)),Xb(m),J}function Xb(m){U.H=En;var y=Sr!==null&&Sr.next!==null;if(Ti=0,ts=Sr=er=null,Rd=!1,Ic=0,yl=null,y)throw Error(a(300));m===null||ms||(m=m.dependencies,m!==null&&zd(m)&&(ms=!0))}function Kb(m,y,k,R){er=m;var X=0;do{if(bl&&(yl=null),Ic=0,bl=!1,25<=X)throw Error(a(301));if(X+=1,ts=Sr=null,m.updateQueue!=null){var J=m.updateQueue;J.lastEffect=null,J.events=null,J.stores=null,J.memoCache!=null&&(J.memoCache.index=0)}U.H=wo,J=y(k,R)}while(bl);return J}function Nj(){var m=U.H,y=m.useState()[0];return y=typeof y.then=="function"?Lc(y):y,m=m.useState()[0],(Sr!==null?Sr.memoizedState:null)!==m&&(er.flags|=1024),y}function Oh(){var m=Md!==0;return Md=0,m}function Rh(m,y,k){y.updateQueue=m.updateQueue,y.flags&=-2053,m.lanes&=~k}function Mh(m){if(Rd){for(m=m.memoizedState;m!==null;){var y=m.queue;y!==null&&(y.pending=null),m=m.next}Rd=!1}Ti=0,ts=Sr=er=null,bl=!1,Ic=Md=0,yl=null}function ia(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ts===null?er.memoizedState=ts=m:ts=ts.next=m,ts}function rs(){if(Sr===null){var m=er.alternate;m=m!==null?m.memoizedState:null}else m=Sr.next;var y=ts===null?er.memoizedState:ts.next;if(y!==null)ts=y,Sr=m;else{if(m===null)throw er.alternate===null?Error(a(467)):Error(a(310));Sr=m,m={memoizedState:Sr.memoizedState,baseState:Sr.baseState,baseQueue:Sr.baseQueue,queue:Sr.queue,next:null},ts===null?er.memoizedState=ts=m:ts=ts.next=m}return ts}var Fd;Fd=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Lc(m){var y=Ic;return Ic+=1,yl===null&&(yl=[]),m=Db(yl,m,y),y=er,(ts===null?y.memoizedState:ts.next)===null&&(y=y.alternate,U.H=y===null||y.memoizedState===null?_o:Ai),m}function Id(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return Lc(m);if(m.$$typeof===h)return Ms(m)}throw Error(a(438,String(m)))}function Fh(m){var y=null,k=er.updateQueue;if(k!==null&&(y=k.memoCache),y==null){var R=er.alternate;R!==null&&(R=R.updateQueue,R!==null&&(R=R.memoCache,R!=null&&(y={data:R.data.map(function(X){return X.slice()}),index:0})))}if(y==null&&(y={data:[],index:0}),k===null&&(k=Fd(),er.updateQueue=k),k.memoCache=y,k=y.data[y.index],k===void 0)for(k=y.data[y.index]=Array(m),R=0;R<m;R++)k[R]=E;return y.index++,k}function Kn(m,y){return typeof y=="function"?y(m):y}function Ld(m){var y=rs();return Ih(y,Sr,m)}function Ih(m,y,k){var R=m.queue;if(R===null)throw Error(a(311));R.lastRenderedReducer=k;var X=m.baseQueue,J=R.pending;if(J!==null){if(X!==null){var ce=X.next;X.next=J.next,J.next=ce}y.baseQueue=X=J,R.pending=null}if(J=m.baseState,X===null)m.memoizedState=J;else{y=X.next;var xe=ce=null,Ee=null,Ue=y,at=!1;do{var mt=Ue.lane&-536870913;if(mt!==Ue.lane?(dr&mt)===mt:(Ti&mt)===mt){var Xe=Ue.revertLane;if(Xe===0)Ee!==null&&(Ee=Ee.next={lane:0,revertLane:0,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null}),mt===gl&&(at=!0);else if((Ti&Xe)===Xe){Ue=Ue.next,Xe===gl&&(at=!0);continue}else mt={lane:0,revertLane:Ue.revertLane,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null},Ee===null?(xe=Ee=mt,ce=J):Ee=Ee.next=mt,er.lanes|=Xe,Di|=Xe;mt=Ue.action,vo&&k(J,mt),J=Ue.hasEagerState?Ue.eagerState:k(J,mt)}else Xe={lane:mt,revertLane:Ue.revertLane,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null},Ee===null?(xe=Ee=Xe,ce=J):Ee=Ee.next=Xe,er.lanes|=mt,Di|=mt;Ue=Ue.next}while(Ue!==null&&Ue!==y);if(Ee===null?ce=J:Ee.next=xe,!xa(J,m.memoizedState)&&(ms=!0,at&&(k=xl,k!==null)))throw k;m.memoizedState=J,m.baseState=ce,m.baseQueue=Ee,R.lastRenderedState=J}return X===null&&(R.lanes=0),[m.memoizedState,R.dispatch]}function Lh(m){var y=rs(),k=y.queue;if(k===null)throw Error(a(311));k.lastRenderedReducer=m;var R=k.dispatch,X=k.pending,J=y.memoizedState;if(X!==null){k.pending=null;var ce=X=X.next;do J=m(J,ce.action),ce=ce.next;while(ce!==X);xa(J,y.memoizedState)||(ms=!0),y.memoizedState=J,y.baseQueue===null&&(y.baseState=J),k.lastRenderedState=J}return[J,R]}function Zb(m,y,k){var R=er,X=rs(),J=xr;if(J){if(k===void 0)throw Error(a(407));k=k()}else k=y();var ce=!xa((Sr||X).memoizedState,k);if(ce&&(X.memoizedState=k,ms=!0),X=X.queue,Dh(e1.bind(null,R,X,m),[m]),X.getSnapshot!==y||ce||ts!==null&&ts.memoizedState.tag&1){if(R.flags|=2048,vl(9,Jb.bind(null,R,X,k,y),{destroy:void 0},null),Tr===null)throw Error(a(349));J||Ti&60||Qb(R,y,k)}return k}function Qb(m,y,k){m.flags|=16384,m={getSnapshot:y,value:k},y=er.updateQueue,y===null?(y=Fd(),er.updateQueue=y,y.stores=[m]):(k=y.stores,k===null?y.stores=[m]:k.push(m))}function Jb(m,y,k,R){y.value=k,y.getSnapshot=R,t1(y)&&r1(m)}function e1(m,y,k){return k(function(){t1(y)&&r1(m)})}function t1(m){var y=m.getSnapshot;m=m.value;try{var k=y();return!xa(m,k)}catch{return!0}}function r1(m){var y=ki(m,2);y!==null&&Xs(y,m,2)}function Ph(m){var y=ia();if(typeof m=="function"){var k=m;if(m=k(),vo){it(!0);try{k()}finally{it(!1)}}}return y.memoizedState=y.baseState=m,y.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:m},y}function s1(m,y,k,R){return m.baseState=k,Ih(m,Sr,typeof R=="function"?R:Kn)}function jj(m,y,k,R,X){if(Dd(m))throw Error(a(485));if(m=y.action,m!==null){var J={payload:X,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ce){J.listeners.push(ce)}};U.T!==null?k(!0):J.isTransition=!1,R(J),k=y.pending,k===null?(J.next=y.pending=J,a1(y,J)):(J.next=k.next,y.pending=k.next=J)}}function a1(m,y){var k=y.action,R=y.payload,X=m.state;if(y.isTransition){var J=U.T,ce={};U.T=ce;try{var xe=k(X,R),Ee=U.S;Ee!==null&&Ee(ce,xe),n1(m,y,xe)}catch(Ue){Bh(m,y,Ue)}finally{U.T=J}}else try{J=k(X,R),n1(m,y,J)}catch(Ue){Bh(m,y,Ue)}}function n1(m,y,k){k!==null&&typeof k=="object"&&typeof k.then=="function"?k.then(function(R){i1(m,y,R)},function(R){return Bh(m,y,R)}):i1(m,y,k)}function i1(m,y,k){y.status="fulfilled",y.value=k,o1(y),m.state=k,y=m.pending,y!==null&&(k=y.next,k===y?m.pending=null:(k=k.next,y.next=k,a1(m,k)))}function Bh(m,y,k){var R=m.pending;if(m.pending=null,R!==null){R=R.next;do y.status="rejected",y.reason=k,o1(y),y=y.next;while(y!==R)}m.action=null}function o1(m){m=m.listeners;for(var y=0;y<m.length;y++)(0,m[y])()}function l1(m,y){return y}function c1(m,y){if(xr){var k=Tr.formState;if(k!==null){e:{var R=er;if(xr){if(Ns){t:{for(var X=Ns,J=kn;X.nodeType!==8;){if(!J){X=null;break t}if(X=ln(X.nextSibling),X===null){X=null;break t}}J=X.data,X=J==="F!"||J==="F"?X:null}if(X){Ns=ln(X.nextSibling),R=X.data==="F!";break e}}xo(R)}R=!1}R&&(y=k[0])}}return k=ia(),k.memoizedState=k.baseState=y,R={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l1,lastRenderedState:y},k.queue=R,k=C1.bind(null,er,R),R.dispatch=k,R=Ph(!1),J=Vh.bind(null,er,!1,R.queue),R=ia(),X={state:y,dispatch:null,action:m,pending:null},R.queue=X,k=jj.bind(null,er,X,J,k),X.dispatch=k,R.memoizedState=m,[y,k,!1]}function u1(m){var y=rs();return d1(y,Sr,m)}function d1(m,y,k){y=Ih(m,y,l1)[0],m=Ld(Kn)[0],y=typeof y=="object"&&y!==null&&typeof y.then=="function"?Lc(y):y;var R=rs(),X=R.queue,J=X.dispatch;return k!==R.memoizedState&&(er.flags|=2048,vl(9,Sj.bind(null,X,k),{destroy:void 0},null)),[y,J,m]}function Sj(m,y){m.action=y}function f1(m){var y=rs(),k=Sr;if(k!==null)return d1(y,k,m);rs(),y=y.memoizedState,k=rs();var R=k.queue.dispatch;return k.memoizedState=m,[y,R,!1]}function vl(m,y,k,R){return m={tag:m,create:y,inst:k,deps:R,next:null},y=er.updateQueue,y===null&&(y=Fd(),er.updateQueue=y),k=y.lastEffect,k===null?y.lastEffect=m.next=m:(R=k.next,k.next=m,m.next=R,y.lastEffect=m),m}function h1(){return rs().memoizedState}function Pd(m,y,k,R){var X=ia();er.flags|=m,X.memoizedState=vl(1|y,k,{destroy:void 0},R===void 0?null:R)}function Bd(m,y,k,R){var X=rs();R=R===void 0?null:R;var J=X.memoizedState.inst;Sr!==null&&R!==null&&Th(R,Sr.memoizedState.deps)?X.memoizedState=vl(y,k,J,R):(er.flags|=m,X.memoizedState=vl(1|y,k,J,R))}function m1(m,y){Pd(8390656,8,m,y)}function Dh(m,y){Bd(2048,8,m,y)}function p1(m,y){return Bd(4,2,m,y)}function g1(m,y){return Bd(4,4,m,y)}function x1(m,y){if(typeof y=="function"){m=m();var k=y(m);return function(){typeof k=="function"?k():y(null)}}if(y!=null)return m=m(),y.current=m,function(){y.current=null}}function b1(m,y,k){k=k!=null?k.concat([m]):null,Bd(4,4,x1.bind(null,y,m),k)}function Uh(){}function y1(m,y){var k=rs();y=y===void 0?null:y;var R=k.memoizedState;return y!==null&&Th(y,R[1])?R[0]:(k.memoizedState=[m,y],m)}function v1(m,y){var k=rs();y=y===void 0?null:y;var R=k.memoizedState;if(y!==null&&Th(y,R[1]))return R[0];if(R=m(),vo){it(!0);try{m()}finally{it(!1)}}return k.memoizedState=[R,y],R}function $h(m,y,k){return k===void 0||Ti&1073741824?m.memoizedState=y:(m.memoizedState=k,m=wy(),er.lanes|=m,Di|=m,k)}function _1(m,y,k,R){return xa(k,y)?k:pl.current!==null?(m=$h(m,k,R),xa(m,y)||(ms=!0),m):Ti&42?(m=wy(),er.lanes|=m,Di|=m,y):(ms=!0,m.memoizedState=k)}function w1(m,y,k,R,X){var J=K.p;K.p=J!==0&&8>J?J:8;var ce=U.T,xe={};U.T=xe,Vh(m,!1,y,k);try{var Ee=X(),Ue=U.S;if(Ue!==null&&Ue(xe,Ee),Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"){var at=_j(Ee,R);Pc(m,y,at,_a(m))}else Pc(m,y,R,_a(m))}catch(mt){Pc(m,y,{then:function(){},status:"rejected",reason:mt},_a())}finally{K.p=J,U.T=ce}}function kj(){}function zh(m,y,k,R){if(m.tag!==5)throw Error(a(476));var X=N1(m).queue;w1(m,X,y,re,k===null?kj:function(){return j1(m),k(R)})}function N1(m){var y=m.memoizedState;if(y!==null)return y;y={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:re},next:null};var k={};return y.next={memoizedState:k,baseState:k,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:k},next:null},m.memoizedState=y,m=m.alternate,m!==null&&(m.memoizedState=y),y}function j1(m){var y=N1(m).next.queue;Pc(m,y,{},_a())}function Hh(){return Ms(su)}function S1(){return rs().memoizedState}function k1(){return rs().memoizedState}function Cj(m){for(var y=m.return;y!==null;){switch(y.tag){case 24:case 3:var k=_a();m=Mi(k);var R=Fi(y,m,k);R!==null&&(Xs(R,y,k),Uc(R,y,k)),y={cache:kh()},m.payload=y;return}y=y.return}}function Ej(m,y,k){var R=_a();k={lane:R,revertLane:0,action:k,hasEagerState:!1,eagerState:null,next:null},Dd(m)?E1(y,k):(k=yh(m,y,k,R),k!==null&&(Xs(k,m,R),T1(k,y,R)))}function C1(m,y,k){var R=_a();Pc(m,y,k,R)}function Pc(m,y,k,R){var X={lane:R,revertLane:0,action:k,hasEagerState:!1,eagerState:null,next:null};if(Dd(m))E1(y,X);else{var J=m.alternate;if(m.lanes===0&&(J===null||J.lanes===0)&&(J=y.lastRenderedReducer,J!==null))try{var ce=y.lastRenderedState,xe=J(ce,k);if(X.hasEagerState=!0,X.eagerState=xe,xa(xe,ce))return wd(m,y,X,0),Tr===null&&_d(),!1}catch{}finally{}if(k=yh(m,y,X,R),k!==null)return Xs(k,m,R),T1(k,y,R),!0}return!1}function Vh(m,y,k,R){if(R={lane:2,revertLane:Mm(),action:R,hasEagerState:!1,eagerState:null,next:null},Dd(m)){if(y)throw Error(a(479))}else y=yh(m,k,R,2),y!==null&&Xs(y,m,2)}function Dd(m){var y=m.alternate;return m===er||y!==null&&y===er}function E1(m,y){bl=Rd=!0;var k=m.pending;k===null?y.next=y:(y.next=k.next,k.next=y),m.pending=y}function T1(m,y,k){if(k&4194176){var R=y.lanes;R&=m.pendingLanes,k|=R,y.lanes=k,Re(m,k)}}var En={readContext:Ms,use:Id,useCallback:Wr,useContext:Wr,useEffect:Wr,useImperativeHandle:Wr,useLayoutEffect:Wr,useInsertionEffect:Wr,useMemo:Wr,useReducer:Wr,useRef:Wr,useState:Wr,useDebugValue:Wr,useDeferredValue:Wr,useTransition:Wr,useSyncExternalStore:Wr,useId:Wr};En.useCacheRefresh=Wr,En.useMemoCache=Wr,En.useHostTransitionStatus=Wr,En.useFormState=Wr,En.useActionState=Wr,En.useOptimistic=Wr;var _o={readContext:Ms,use:Id,useCallback:function(m,y){return ia().memoizedState=[m,y===void 0?null:y],m},useContext:Ms,useEffect:m1,useImperativeHandle:function(m,y,k){k=k!=null?k.concat([m]):null,Pd(4194308,4,x1.bind(null,y,m),k)},useLayoutEffect:function(m,y){return Pd(4194308,4,m,y)},useInsertionEffect:function(m,y){Pd(4,2,m,y)},useMemo:function(m,y){var k=ia();y=y===void 0?null:y;var R=m();if(vo){it(!0);try{m()}finally{it(!1)}}return k.memoizedState=[R,y],R},useReducer:function(m,y,k){var R=ia();if(k!==void 0){var X=k(y);if(vo){it(!0);try{k(y)}finally{it(!1)}}}else X=y;return R.memoizedState=R.baseState=X,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:X},R.queue=m,m=m.dispatch=Ej.bind(null,er,m),[R.memoizedState,m]},useRef:function(m){var y=ia();return m={current:m},y.memoizedState=m},useState:function(m){m=Ph(m);var y=m.queue,k=C1.bind(null,er,y);return y.dispatch=k,[m.memoizedState,k]},useDebugValue:Uh,useDeferredValue:function(m,y){var k=ia();return $h(k,m,y)},useTransition:function(){var m=Ph(!1);return m=w1.bind(null,er,m.queue,!0,!1),ia().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,y,k){var R=er,X=ia();if(xr){if(k===void 0)throw Error(a(407));k=k()}else{if(k=y(),Tr===null)throw Error(a(349));dr&60||Qb(R,y,k)}X.memoizedState=k;var J={value:k,getSnapshot:y};return X.queue=J,m1(e1.bind(null,R,J,m),[m]),R.flags|=2048,vl(9,Jb.bind(null,R,J,k,y),{destroy:void 0},null),k},useId:function(){var m=ia(),y=Tr.identifierPrefix;if(xr){var k=Wn,R=Yn;k=(R&~(1<<32-lt(R)-1)).toString(32)+k,y=":"+y+"R"+k,k=Md++,0<k&&(y+="H"+k.toString(32)),y+=":"}else k=wj++,y=":"+y+"r"+k.toString(32)+":";return m.memoizedState=y},useCacheRefresh:function(){return ia().memoizedState=Cj.bind(null,er)}};_o.useMemoCache=Fh,_o.useHostTransitionStatus=Hh,_o.useFormState=c1,_o.useActionState=c1,_o.useOptimistic=function(m){var y=ia();y.memoizedState=y.baseState=m;var k={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return y.queue=k,y=Vh.bind(null,er,!0,k),k.dispatch=y,[m,y]};var Ai={readContext:Ms,use:Id,useCallback:y1,useContext:Ms,useEffect:Dh,useImperativeHandle:b1,useInsertionEffect:p1,useLayoutEffect:g1,useMemo:v1,useReducer:Ld,useRef:h1,useState:function(){return Ld(Kn)},useDebugValue:Uh,useDeferredValue:function(m,y){var k=rs();return _1(k,Sr.memoizedState,m,y)},useTransition:function(){var m=Ld(Kn)[0],y=rs().memoizedState;return[typeof m=="boolean"?m:Lc(m),y]},useSyncExternalStore:Zb,useId:S1};Ai.useCacheRefresh=k1,Ai.useMemoCache=Fh,Ai.useHostTransitionStatus=Hh,Ai.useFormState=u1,Ai.useActionState=u1,Ai.useOptimistic=function(m,y){var k=rs();return s1(k,Sr,m,y)};var wo={readContext:Ms,use:Id,useCallback:y1,useContext:Ms,useEffect:Dh,useImperativeHandle:b1,useInsertionEffect:p1,useLayoutEffect:g1,useMemo:v1,useReducer:Lh,useRef:h1,useState:function(){return Lh(Kn)},useDebugValue:Uh,useDeferredValue:function(m,y){var k=rs();return Sr===null?$h(k,m,y):_1(k,Sr.memoizedState,m,y)},useTransition:function(){var m=Lh(Kn)[0],y=rs().memoizedState;return[typeof m=="boolean"?m:Lc(m),y]},useSyncExternalStore:Zb,useId:S1};wo.useCacheRefresh=k1,wo.useMemoCache=Fh,wo.useHostTransitionStatus=Hh,wo.useFormState=f1,wo.useActionState=f1,wo.useOptimistic=function(m,y){var k=rs();return Sr!==null?s1(k,Sr,m,y):(k.baseState=m,[m,k.queue.dispatch])};function qh(m,y,k,R){y=m.memoizedState,k=k(R,y),k=k==null?y:W({},y,k),m.memoizedState=k,m.lanes===0&&(m.updateQueue.baseState=k)}var Gh={isMounted:function(m){return(m=m._reactInternals)?w(m)===m:!1},enqueueSetState:function(m,y,k){m=m._reactInternals;var R=_a(),X=Mi(R);X.payload=y,k!=null&&(X.callback=k),y=Fi(m,X,R),y!==null&&(Xs(y,m,R),Uc(y,m,R))},enqueueReplaceState:function(m,y,k){m=m._reactInternals;var R=_a(),X=Mi(R);X.tag=1,X.payload=y,k!=null&&(X.callback=k),y=Fi(m,X,R),y!==null&&(Xs(y,m,R),Uc(y,m,R))},enqueueForceUpdate:function(m,y){m=m._reactInternals;var k=_a(),R=Mi(k);R.tag=2,y!=null&&(R.callback=y),y=Fi(m,R,k),y!==null&&(Xs(y,m,k),Uc(y,m,k))}};function A1(m,y,k,R,X,J,ce){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(R,J,ce):y.prototype&&y.prototype.isPureReactComponent?!jc(k,R)||!jc(X,J):!0}function O1(m,y,k,R){m=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(k,R),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(k,R),y.state!==m&&Gh.enqueueReplaceState(y,y.state,null)}function No(m,y){var k=y;if("ref"in y){k={};for(var R in y)R!=="ref"&&(k[R]=y[R])}if(m=m.defaultProps){k===y&&(k=W({},k));for(var X in m)k[X]===void 0&&(k[X]=m[X])}return k}var Ud=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",m);return}console.error(m)};function R1(m){Ud(m)}function M1(m){console.error(m)}function F1(m){Ud(m)}function $d(m,y){try{var k=m.onUncaughtError;k(y.value,{componentStack:y.stack})}catch(R){setTimeout(function(){throw R})}}function I1(m,y,k){try{var R=m.onCaughtError;R(k.value,{componentStack:k.stack,errorBoundary:y.tag===1?y.stateNode:null})}catch(X){setTimeout(function(){throw X})}}function Yh(m,y,k){return k=Mi(k),k.tag=3,k.payload={element:null},k.callback=function(){$d(m,y)},k}function L1(m){return m=Mi(m),m.tag=3,m}function P1(m,y,k,R){var X=k.type.getDerivedStateFromError;if(typeof X=="function"){var J=R.value;m.payload=function(){return X(J)},m.callback=function(){I1(y,k,R)}}var ce=k.stateNode;ce!==null&&typeof ce.componentDidCatch=="function"&&(m.callback=function(){I1(y,k,R),typeof X!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var xe=R.stack;this.componentDidCatch(R.value,{componentStack:xe!==null?xe:""})})}function Tj(m,y,k,R,X){if(k.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){if(y=k.alternate,y!==null&&Dc(y,k,X,!0),k=Ba.current,k!==null){switch(k.tag){case 13:return Cn===null?Em():k.alternate===null&&$r===0&&($r=3),k.flags&=-257,k.flags|=65536,k.lanes=X,R===Nh?k.flags|=16384:(y=k.updateQueue,y===null?k.updateQueue=new Set([R]):y.add(R),Am(m,R,X)),!1;case 22:return k.flags|=65536,R===Nh?k.flags|=16384:(y=k.updateQueue,y===null?(y={transitions:null,markerInstances:null,retryQueue:new Set([R])},k.updateQueue=y):(k=y.retryQueue,k===null?y.retryQueue=new Set([R]):k.add(R)),Am(m,R,X)),!1}throw Error(a(435,k.tag))}return Am(m,R,X),Em(),!1}if(xr)return y=Ba.current,y!==null?(!(y.flags&65536)&&(y.flags|=256),y.flags|=65536,y.lanes=X,R!==wh&&(m=Error(a(422),{cause:R}),Ec(Ia(m,k)))):(R!==wh&&(y=Error(a(423),{cause:R}),Ec(Ia(y,k))),m=m.current.alternate,m.flags|=65536,X&=-X,m.lanes|=X,R=Ia(R,k),X=Yh(m.stateNode,R,X),lm(m,X),$r!==4&&($r=2)),!1;var J=Error(a(520),{cause:R});if(J=Ia(J,k),Wc===null?Wc=[J]:Wc.push(J),$r!==4&&($r=2),y===null)return!0;R=Ia(R,k),k=y;do{switch(k.tag){case 3:return k.flags|=65536,m=X&-X,k.lanes|=m,m=Yh(k.stateNode,R,m),lm(k,m),!1;case 1:if(y=k.type,J=k.stateNode,(k.flags&128)===0&&(typeof y.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Ui===null||!Ui.has(J))))return k.flags|=65536,X&=-X,k.lanes|=X,X=L1(X),P1(X,m,k,R),lm(k,X),!1}k=k.return}while(k!==null);return!1}var B1=Error(a(461)),ms=!1;function js(m,y,k,R){y.child=m===null?Hb(y,null,k,R):bo(y,m.child,k,R)}function D1(m,y,k,R,X){k=k.render;var J=y.ref;if("ref"in R){var ce={};for(var xe in R)xe!=="ref"&&(ce[xe]=R[xe])}else ce=R;return So(y),R=Ah(m,y,k,ce,J,X),xe=Oh(),m!==null&&!ms?(Rh(m,y,X),Zn(m,y,X)):(xr&&xe&&vh(y),y.flags|=1,js(m,y,R,X),y.child)}function U1(m,y,k,R,X){if(m===null){var J=k.type;return typeof J=="function"&&!gm(J)&&J.defaultProps===void 0&&k.compare===null?(y.tag=15,y.type=J,$1(m,y,J,R,X)):(m=Gd(k.type,null,R,y,y.mode,X),m.ref=y.ref,m.return=y,y.child=m)}if(J=m.child,!rm(m,X)){var ce=J.memoizedProps;if(k=k.compare,k=k!==null?k:jc,k(ce,R)&&m.ref===y.ref)return Zn(m,y,X)}return y.flags|=1,m=Bi(J,R),m.ref=y.ref,m.return=y,y.child=m}function $1(m,y,k,R,X){if(m!==null){var J=m.memoizedProps;if(jc(J,R)&&m.ref===y.ref)if(ms=!1,y.pendingProps=R=J,rm(m,X))m.flags&131072&&(ms=!0);else return y.lanes=m.lanes,Zn(m,y,X)}return Wh(m,y,k,R,X)}function z1(m,y,k){var R=y.pendingProps,X=R.children,J=(y.stateNode._pendingVisibility&2)!==0,ce=m!==null?m.memoizedState:null;if(Bc(m,y),R.mode==="hidden"||J){if(y.flags&128){if(R=ce!==null?ce.baseLanes|k:k,m!==null){for(X=y.child=m.child,J=0;X!==null;)J=J|X.lanes|X.childLanes,X=X.sibling;y.childLanes=J&~R}else y.childLanes=0,y.child=null;return H1(m,y,R,k)}if(k&536870912)y.memoizedState={baseLanes:0,cachePool:null},m!==null&&Od(y,ce!==null?ce.cachePool:null),ce!==null?Vb(y,ce):jh(),qb(y);else return y.lanes=y.childLanes=536870912,H1(m,y,ce!==null?ce.baseLanes|k:k,k)}else ce!==null?(Od(y,ce.cachePool),Vb(y,ce),Ei(),y.memoizedState=null):(m!==null&&Od(y,null),jh(),Ei());return js(m,y,X,k),y.child}function H1(m,y,k,R){var X=Eh();return X=X===null?null:{parent:us._currentValue,pool:X},y.memoizedState={baseLanes:k,cachePool:X},m!==null&&Od(y,null),jh(),qb(y),m!==null&&Dc(m,y,R,!0),null}function Bc(m,y){var k=y.ref;if(k===null)m!==null&&m.ref!==null&&(y.flags|=2097664);else{if(typeof k!="function"&&typeof k!="object")throw Error(a(284));(m===null||m.ref!==k)&&(y.flags|=2097664)}}function Wh(m,y,k,R,X){return So(y),k=Ah(m,y,k,R,void 0,X),R=Oh(),m!==null&&!ms?(Rh(m,y,X),Zn(m,y,X)):(xr&&R&&vh(y),y.flags|=1,js(m,y,k,X),y.child)}function V1(m,y,k,R,X,J){return So(y),y.updateQueue=null,k=Kb(y,R,k,X),Xb(m),R=Oh(),m!==null&&!ms?(Rh(m,y,J),Zn(m,y,J)):(xr&&R&&vh(y),y.flags|=1,js(m,y,k,J),y.child)}function q1(m,y,k,R,X){if(So(y),y.stateNode===null){var J=dl,ce=k.contextType;typeof ce=="object"&&ce!==null&&(J=Ms(ce)),J=new k(R,J),y.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,J.updater=Gh,y.stateNode=J,J._reactInternals=y,J=y.stateNode,J.props=R,J.state=y.memoizedState,J.refs={},im(y),ce=k.contextType,J.context=typeof ce=="object"&&ce!==null?Ms(ce):dl,J.state=y.memoizedState,ce=k.getDerivedStateFromProps,typeof ce=="function"&&(qh(y,k,ce,R),J.state=y.memoizedState),typeof k.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(ce=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),ce!==J.state&&Gh.enqueueReplaceState(J,J.state,null),zc(y,R,J,X),$c(),J.state=y.memoizedState),typeof J.componentDidMount=="function"&&(y.flags|=4194308),R=!0}else if(m===null){J=y.stateNode;var xe=y.memoizedProps,Ee=No(k,xe);J.props=Ee;var Ue=J.context,at=k.contextType;ce=dl,typeof at=="object"&&at!==null&&(ce=Ms(at));var mt=k.getDerivedStateFromProps;at=typeof mt=="function"||typeof J.getSnapshotBeforeUpdate=="function",xe=y.pendingProps!==xe,at||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(xe||Ue!==ce)&&O1(y,J,R,ce),Ri=!1;var Xe=y.memoizedState;J.state=Xe,zc(y,R,J,X),$c(),Ue=y.memoizedState,xe||Xe!==Ue||Ri?(typeof mt=="function"&&(qh(y,k,mt,R),Ue=y.memoizedState),(Ee=Ri||A1(y,k,Ee,R,Xe,Ue,ce))?(at||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(y.flags|=4194308)):(typeof J.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=R,y.memoizedState=Ue),J.props=R,J.state=Ue,J.context=ce,R=Ee):(typeof J.componentDidMount=="function"&&(y.flags|=4194308),R=!1)}else{J=y.stateNode,om(m,y),ce=y.memoizedProps,at=No(k,ce),J.props=at,mt=y.pendingProps,Xe=J.context,Ue=k.contextType,Ee=dl,typeof Ue=="object"&&Ue!==null&&(Ee=Ms(Ue)),xe=k.getDerivedStateFromProps,(Ue=typeof xe=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ce!==mt||Xe!==Ee)&&O1(y,J,R,Ee),Ri=!1,Xe=y.memoizedState,J.state=Xe,zc(y,R,J,X),$c();var rt=y.memoizedState;ce!==mt||Xe!==rt||Ri||m!==null&&m.dependencies!==null&&zd(m.dependencies)?(typeof xe=="function"&&(qh(y,k,xe,R),rt=y.memoizedState),(at=Ri||A1(y,k,at,R,Xe,rt,Ee)||m!==null&&m.dependencies!==null&&zd(m.dependencies))?(Ue||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(R,rt,Ee),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(R,rt,Ee)),typeof J.componentDidUpdate=="function"&&(y.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof J.componentDidUpdate!="function"||ce===m.memoizedProps&&Xe===m.memoizedState||(y.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ce===m.memoizedProps&&Xe===m.memoizedState||(y.flags|=1024),y.memoizedProps=R,y.memoizedState=rt),J.props=R,J.state=rt,J.context=Ee,R=at):(typeof J.componentDidUpdate!="function"||ce===m.memoizedProps&&Xe===m.memoizedState||(y.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ce===m.memoizedProps&&Xe===m.memoizedState||(y.flags|=1024),R=!1)}return J=R,Bc(m,y),R=(y.flags&128)!==0,J||R?(J=y.stateNode,k=R&&typeof k.getDerivedStateFromError!="function"?null:J.render(),y.flags|=1,m!==null&&R?(y.child=bo(y,m.child,null,X),y.child=bo(y,null,k,X)):js(m,y,k,X),y.memoizedState=J.state,m=y.child):m=Zn(m,y,X),m}function G1(m,y,k,R){return Cc(),y.flags|=256,js(m,y,k,R),y.child}var Xh={dehydrated:null,treeContext:null,retryLane:0};function Kh(m){return{baseLanes:m,cachePool:Wb()}}function Zh(m,y,k){return m=m!==null?m.childLanes&~k:0,y&&(m|=za),m}function Y1(m,y,k){var R=y.pendingProps,X=!1,J=(y.flags&128)!==0,ce;if((ce=J)||(ce=m!==null&&m.memoizedState===null?!1:(cs.current&2)!==0),ce&&(X=!0,y.flags&=-129),ce=(y.flags&32)!==0,y.flags&=-33,m===null){if(xr){if(X?Ci(y):Ei(),xr){var xe=Ns,Ee;if(Ee=xe){e:{for(Ee=xe,xe=kn;Ee.nodeType!==8;){if(!xe){xe=null;break e}if(Ee=ln(Ee.nextSibling),Ee===null){xe=null;break e}}xe=Ee}xe!==null?(y.memoizedState={dehydrated:xe,treeContext:po!==null?{id:Yn,overflow:Wn}:null,retryLane:536870912},Ee=$a(18,null,null,0),Ee.stateNode=xe,Ee.return=y,y.child=Ee,Ws=y,Ns=null,Ee=!0):Ee=!1}Ee||xo(y)}if(xe=y.memoizedState,xe!==null&&(xe=xe.dehydrated,xe!==null))return xe.data==="$!"?y.lanes=16:y.lanes=536870912,null;Xn(y)}return xe=R.children,R=R.fallback,X?(Ei(),X=y.mode,xe=Jh({mode:"hidden",children:xe},X),R=Co(R,X,k,null),xe.return=y,R.return=y,xe.sibling=R,y.child=xe,X=y.child,X.memoizedState=Kh(k),X.childLanes=Zh(m,ce,k),y.memoizedState=Xh,R):(Ci(y),Qh(y,xe))}if(Ee=m.memoizedState,Ee!==null&&(xe=Ee.dehydrated,xe!==null)){if(J)y.flags&256?(Ci(y),y.flags&=-257,y=em(m,y,k)):y.memoizedState!==null?(Ei(),y.child=m.child,y.flags|=128,y=null):(Ei(),X=R.fallback,xe=y.mode,R=Jh({mode:"visible",children:R.children},xe),X=Co(X,xe,k,null),X.flags|=2,R.return=y,X.return=y,R.sibling=X,y.child=R,bo(y,m.child,null,k),R=y.child,R.memoizedState=Kh(k),R.childLanes=Zh(m,ce,k),y.memoizedState=Xh,y=X);else if(Ci(y),xe.data==="$!"){if(ce=xe.nextSibling&&xe.nextSibling.dataset,ce)var Ue=ce.dgst;ce=Ue,R=Error(a(419)),R.stack="",R.digest=ce,Ec({value:R,source:null,stack:null}),y=em(m,y,k)}else if(ms||Dc(m,y,k,!1),ce=(k&m.childLanes)!==0,ms||ce){if(ce=Tr,ce!==null){if(R=k&-k,R&42)R=1;else switch(R){case 2:R=1;break;case 8:R=4;break;case 32:R=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:R=64;break;case 268435456:R=134217728;break;default:R=0}if(R=R&(ce.suspendedLanes|k)?0:R,R!==0&&R!==Ee.retryLane)throw Ee.retryLane=R,ki(m,R),Xs(ce,m,R),B1}xe.data==="$?"||Em(),y=em(m,y,k)}else xe.data==="$?"?(y.flags|=128,y.child=m.child,y=Vj.bind(null,m),xe._reactRetry=y,y=null):(m=Ee.treeContext,Ns=ln(xe.nextSibling),Ws=y,xr=!0,nn=null,kn=!1,m!==null&&(La[Pa++]=Yn,La[Pa++]=Wn,La[Pa++]=po,Yn=m.id,Wn=m.overflow,po=y),y=Qh(y,R.children),y.flags|=4096);return y}return X?(Ei(),X=R.fallback,xe=y.mode,Ee=m.child,Ue=Ee.sibling,R=Bi(Ee,{mode:"hidden",children:R.children}),R.subtreeFlags=Ee.subtreeFlags&31457280,Ue!==null?X=Bi(Ue,X):(X=Co(X,xe,k,null),X.flags|=2),X.return=y,R.return=y,R.sibling=X,y.child=R,R=X,X=y.child,xe=m.child.memoizedState,xe===null?xe=Kh(k):(Ee=xe.cachePool,Ee!==null?(Ue=us._currentValue,Ee=Ee.parent!==Ue?{parent:Ue,pool:Ue}:Ee):Ee=Wb(),xe={baseLanes:xe.baseLanes|k,cachePool:Ee}),X.memoizedState=xe,X.childLanes=Zh(m,ce,k),y.memoizedState=Xh,R):(Ci(y),k=m.child,m=k.sibling,k=Bi(k,{mode:"visible",children:R.children}),k.return=y,k.sibling=null,m!==null&&(ce=y.deletions,ce===null?(y.deletions=[m],y.flags|=16):ce.push(m)),y.child=k,y.memoizedState=null,k)}function Qh(m,y){return y=Jh({mode:"visible",children:y},m.mode),y.return=m,m.child=y}function Jh(m,y){return yy(m,y,0,null)}function em(m,y,k){return bo(y,m.child,null,k),m=Qh(y,y.pendingProps.children),m.flags|=2,y.memoizedState=null,m}function W1(m,y,k){m.lanes|=y;var R=m.alternate;R!==null&&(R.lanes|=y),am(m.return,y,k)}function tm(m,y,k,R,X){var J=m.memoizedState;J===null?m.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:R,tail:k,tailMode:X}:(J.isBackwards=y,J.rendering=null,J.renderingStartTime=0,J.last=R,J.tail=k,J.tailMode=X)}function X1(m,y,k){var R=y.pendingProps,X=R.revealOrder,J=R.tail;if(js(m,y,R.children,k),R=cs.current,R&2)R=R&1|2,y.flags|=128;else{if(m!==null&&m.flags&128)e:for(m=y.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&W1(m,k,y);else if(m.tag===19)W1(m,k,y);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===y)break e;for(;m.sibling===null;){if(m.return===null||m.return===y)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}R&=1}switch(Q(cs,R),X){case"forwards":for(k=y.child,X=null;k!==null;)m=k.alternate,m!==null&&Ad(m)===null&&(X=k),k=k.sibling;k=X,k===null?(X=y.child,y.child=null):(X=k.sibling,k.sibling=null),tm(y,!1,X,k,J);break;case"backwards":for(k=null,X=y.child,y.child=null;X!==null;){if(m=X.alternate,m!==null&&Ad(m)===null){y.child=X;break}m=X.sibling,X.sibling=k,k=X,X=m}tm(y,!0,k,null,J);break;case"together":tm(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function Zn(m,y,k){if(m!==null&&(y.dependencies=m.dependencies),Di|=y.lanes,!(k&y.childLanes))if(m!==null){if(Dc(m,y,k,!1),(k&y.childLanes)===0)return null}else return null;if(m!==null&&y.child!==m.child)throw Error(a(153));if(y.child!==null){for(m=y.child,k=Bi(m,m.pendingProps),y.child=k,k.return=y;m.sibling!==null;)m=m.sibling,k=k.sibling=Bi(m,m.pendingProps),k.return=y;k.sibling=null}return y.child}function rm(m,y){return m.lanes&y?!0:(m=m.dependencies,!!(m!==null&&zd(m)))}function Aj(m,y,k){switch(y.tag){case 3:Ne(y,y.stateNode.containerInfo),Oi(y,us,m.memoizedState.cache),Cc();break;case 27:case 5:ue(y);break;case 4:Ne(y,y.stateNode.containerInfo);break;case 10:Oi(y,y.type,y.memoizedProps.value);break;case 13:var R=y.memoizedState;if(R!==null)return R.dehydrated!==null?(Ci(y),y.flags|=128,null):k&y.child.childLanes?Y1(m,y,k):(Ci(y),m=Zn(m,y,k),m!==null?m.sibling:null);Ci(y);break;case 19:var X=(m.flags&128)!==0;if(R=(k&y.childLanes)!==0,R||(Dc(m,y,k,!1),R=(k&y.childLanes)!==0),X){if(R)return X1(m,y,k);y.flags|=128}if(X=y.memoizedState,X!==null&&(X.rendering=null,X.tail=null,X.lastEffect=null),Q(cs,cs.current),R)break;return null;case 22:case 23:return y.lanes=0,z1(m,y,k);case 24:Oi(y,us,m.memoizedState.cache)}return Zn(m,y,k)}function K1(m,y,k){if(m!==null)if(m.memoizedProps!==y.pendingProps)ms=!0;else{if(!rm(m,k)&&!(y.flags&128))return ms=!1,Aj(m,y,k);ms=!!(m.flags&131072)}else ms=!1,xr&&y.flags&1048576&&Fb(y,Sd,y.index);switch(y.lanes=0,y.tag){case 16:e:{m=y.pendingProps;var R=y.elementType,X=R._init;if(R=X(R._payload),y.type=R,typeof R=="function")gm(R)?(m=No(R,m),y.tag=1,y=q1(null,y,R,m,k)):(y.tag=0,y=Wh(null,y,R,m,k));else{if(R!=null){if(X=R.$$typeof,X===f){y.tag=11,y=D1(null,y,R,m,k);break e}else if(X===v){y.tag=14,y=U1(null,y,R,m,k);break e}}throw y=P(R)||R,Error(a(306,y,""))}}return y;case 0:return Wh(m,y,y.type,y.pendingProps,k);case 1:return R=y.type,X=No(R,y.pendingProps),q1(m,y,R,X,k);case 3:e:{if(Ne(y,y.stateNode.containerInfo),m===null)throw Error(a(387));var J=y.pendingProps;X=y.memoizedState,R=X.element,om(m,y),zc(y,J,null,k);var ce=y.memoizedState;if(J=ce.cache,Oi(y,us,J),J!==X.cache&&nm(y,[us],k,!0),$c(),J=ce.element,X.isDehydrated)if(X={element:J,isDehydrated:!1,cache:ce.cache},y.updateQueue.baseState=X,y.memoizedState=X,y.flags&256){y=G1(m,y,J,k);break e}else if(J!==R){R=Ia(Error(a(424)),y),Ec(R),y=G1(m,y,J,k);break e}else for(Ns=ln(y.stateNode.containerInfo.firstChild),Ws=y,xr=!0,nn=null,kn=!0,k=Hb(y,null,J,k),y.child=k;k;)k.flags=k.flags&-3|4096,k=k.sibling;else{if(Cc(),J===R){y=Zn(m,y,k);break e}js(m,y,J,k)}y=y.child}return y;case 26:return Bc(m,y),m===null?(k=Jy(y.type,null,y.pendingProps,null))?y.memoizedState=k:xr||(k=y.type,m=y.pendingProps,R=af(le.current).createElement(k),R[me]=y,R[ge]=m,Ss(R,k,m),Ce(R),y.stateNode=R):y.memoizedState=Jy(y.type,m.memoizedProps,y.pendingProps,m.memoizedState),null;case 27:return ue(y),m===null&&xr&&(R=y.stateNode=Ky(y.type,y.pendingProps,le.current),Ws=y,kn=!0,Ns=ln(R.firstChild)),R=y.pendingProps.children,m!==null||xr?js(m,y,R,k):y.child=bo(y,null,R,k),Bc(m,y),y.child;case 5:return m===null&&xr&&((X=R=Ns)&&(R=i8(R,y.type,y.pendingProps,kn),R!==null?(y.stateNode=R,Ws=y,Ns=ln(R.firstChild),kn=!1,X=!0):X=!1),X||xo(y)),ue(y),X=y.type,J=y.pendingProps,ce=m!==null?m.memoizedProps:null,R=J.children,zm(X,J)?R=null:ce!==null&&zm(X,ce)&&(y.flags|=32),y.memoizedState!==null&&(X=Ah(m,y,Nj,null,null,k),su._currentValue=X),Bc(m,y),js(m,y,R,k),y.child;case 6:return m===null&&xr&&((m=k=Ns)&&(k=o8(k,y.pendingProps,kn),k!==null?(y.stateNode=k,Ws=y,Ns=null,m=!0):m=!1),m||xo(y)),null;case 13:return Y1(m,y,k);case 4:return Ne(y,y.stateNode.containerInfo),R=y.pendingProps,m===null?y.child=bo(y,null,R,k):js(m,y,R,k),y.child;case 11:return D1(m,y,y.type,y.pendingProps,k);case 7:return js(m,y,y.pendingProps,k),y.child;case 8:return js(m,y,y.pendingProps.children,k),y.child;case 12:return js(m,y,y.pendingProps.children,k),y.child;case 10:return R=y.pendingProps,Oi(y,y.type,R.value),js(m,y,R.children,k),y.child;case 9:return X=y.type._context,R=y.pendingProps.children,So(y),X=Ms(X),R=R(X),y.flags|=1,js(m,y,R,k),y.child;case 14:return U1(m,y,y.type,y.pendingProps,k);case 15:return $1(m,y,y.type,y.pendingProps,k);case 19:return X1(m,y,k);case 22:return z1(m,y,k);case 24:return So(y),R=Ms(us),m===null?(X=Eh(),X===null&&(X=Tr,J=kh(),X.pooledCache=J,J.refCount++,J!==null&&(X.pooledCacheLanes|=k),X=J),y.memoizedState={parent:R,cache:X},im(y),Oi(y,us,X)):(m.lanes&k&&(om(m,y),zc(y,null,null,k),$c()),X=m.memoizedState,J=y.memoizedState,X.parent!==R?(X={parent:R,cache:R},y.memoizedState=X,y.lanes===0&&(y.memoizedState=y.updateQueue.baseState=X),Oi(y,us,R)):(R=J.cache,Oi(y,us,R),R!==X.cache&&nm(y,[us],k,!0))),js(m,y,y.pendingProps.children,k),y.child;case 29:throw y.pendingProps}throw Error(a(156,y.tag))}var sm=V(null),jo=null,Qn=null;function Oi(m,y,k){Q(sm,y._currentValue),y._currentValue=k}function Jn(m){m._currentValue=sm.current,H(sm)}function am(m,y,k){for(;m!==null;){var R=m.alternate;if((m.childLanes&y)!==y?(m.childLanes|=y,R!==null&&(R.childLanes|=y)):R!==null&&(R.childLanes&y)!==y&&(R.childLanes|=y),m===k)break;m=m.return}}function nm(m,y,k,R){var X=m.child;for(X!==null&&(X.return=m);X!==null;){var J=X.dependencies;if(J!==null){var ce=X.child;J=J.firstContext;e:for(;J!==null;){var xe=J;J=X;for(var Ee=0;Ee<y.length;Ee++)if(xe.context===y[Ee]){J.lanes|=k,xe=J.alternate,xe!==null&&(xe.lanes|=k),am(J.return,k,m),R||(ce=null);break e}J=xe.next}}else if(X.tag===18){if(ce=X.return,ce===null)throw Error(a(341));ce.lanes|=k,J=ce.alternate,J!==null&&(J.lanes|=k),am(ce,k,m),ce=null}else ce=X.child;if(ce!==null)ce.return=X;else for(ce=X;ce!==null;){if(ce===m){ce=null;break}if(X=ce.sibling,X!==null){X.return=ce.return,ce=X;break}ce=ce.return}X=ce}}function Dc(m,y,k,R){m=null;for(var X=y,J=!1;X!==null;){if(!J){if(X.flags&524288)J=!0;else if(X.flags&262144)break}if(X.tag===10){var ce=X.alternate;if(ce===null)throw Error(a(387));if(ce=ce.memoizedProps,ce!==null){var xe=X.type;xa(X.pendingProps.value,ce.value)||(m!==null?m.push(xe):m=[xe])}}else if(X===he.current){if(ce=X.alternate,ce===null)throw Error(a(387));ce.memoizedState.memoizedState!==X.memoizedState.memoizedState&&(m!==null?m.push(su):m=[su])}X=X.return}m!==null&&nm(y,m,k,R),y.flags|=262144}function zd(m){for(m=m.firstContext;m!==null;){if(!xa(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function So(m){jo=m,Qn=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Ms(m){return Z1(jo,m)}function Hd(m,y){return jo===null&&So(m),Z1(m,y)}function Z1(m,y){var k=y._currentValue;if(y={context:y,memoizedValue:k,next:null},Qn===null){if(m===null)throw Error(a(308));Qn=y,m.dependencies={lanes:0,firstContext:y},m.flags|=524288}else Qn=Qn.next=y;return k}var Ri=!1;function im(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function om(m,y){m=m.updateQueue,y.updateQueue===m&&(y.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function Mi(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function Fi(m,y,k){var R=m.updateQueue;if(R===null)return null;if(R=R.shared,Br&2){var X=R.pending;return X===null?y.next=y:(y.next=X.next,X.next=y),R.pending=y,y=Nd(m),Rb(m,null,k),y}return wd(m,R,y,k),Nd(m)}function Uc(m,y,k){if(y=y.updateQueue,y!==null&&(y=y.shared,(k&4194176)!==0)){var R=y.lanes;R&=m.pendingLanes,k|=R,y.lanes=k,Re(m,k)}}function lm(m,y){var k=m.updateQueue,R=m.alternate;if(R!==null&&(R=R.updateQueue,k===R)){var X=null,J=null;if(k=k.firstBaseUpdate,k!==null){do{var ce={lane:k.lane,tag:k.tag,payload:k.payload,callback:null,next:null};J===null?X=J=ce:J=J.next=ce,k=k.next}while(k!==null);J===null?X=J=y:J=J.next=y}else X=J=y;k={baseState:R.baseState,firstBaseUpdate:X,lastBaseUpdate:J,shared:R.shared,callbacks:R.callbacks},m.updateQueue=k;return}m=k.lastBaseUpdate,m===null?k.firstBaseUpdate=y:m.next=y,k.lastBaseUpdate=y}var cm=!1;function $c(){if(cm){var m=xl;if(m!==null)throw m}}function zc(m,y,k,R){cm=!1;var X=m.updateQueue;Ri=!1;var J=X.firstBaseUpdate,ce=X.lastBaseUpdate,xe=X.shared.pending;if(xe!==null){X.shared.pending=null;var Ee=xe,Ue=Ee.next;Ee.next=null,ce===null?J=Ue:ce.next=Ue,ce=Ee;var at=m.alternate;at!==null&&(at=at.updateQueue,xe=at.lastBaseUpdate,xe!==ce&&(xe===null?at.firstBaseUpdate=Ue:xe.next=Ue,at.lastBaseUpdate=Ee))}if(J!==null){var mt=X.baseState;ce=0,at=Ue=Ee=null,xe=J;do{var Xe=xe.lane&-536870913,rt=Xe!==xe.lane;if(rt?(dr&Xe)===Xe:(R&Xe)===Xe){Xe!==0&&Xe===gl&&(cm=!0),at!==null&&(at=at.next={lane:0,tag:xe.tag,payload:xe.payload,callback:null,next:null});e:{var Rt=m,Wt=xe;Xe=y;var zr=k;switch(Wt.tag){case 1:if(Rt=Wt.payload,typeof Rt=="function"){mt=Rt.call(zr,mt,Xe);break e}mt=Rt;break e;case 3:Rt.flags=Rt.flags&-65537|128;case 0:if(Rt=Wt.payload,Xe=typeof Rt=="function"?Rt.call(zr,mt,Xe):Rt,Xe==null)break e;mt=W({},mt,Xe);break e;case 2:Ri=!0}}Xe=xe.callback,Xe!==null&&(m.flags|=64,rt&&(m.flags|=8192),rt=X.callbacks,rt===null?X.callbacks=[Xe]:rt.push(Xe))}else rt={lane:Xe,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null},at===null?(Ue=at=rt,Ee=mt):at=at.next=rt,ce|=Xe;if(xe=xe.next,xe===null){if(xe=X.shared.pending,xe===null)break;rt=xe,xe=rt.next,rt.next=null,X.lastBaseUpdate=rt,X.shared.pending=null}}while(!0);at===null&&(Ee=mt),X.baseState=Ee,X.firstBaseUpdate=Ue,X.lastBaseUpdate=at,J===null&&(X.shared.lanes=0),Di|=ce,m.lanes=ce,m.memoizedState=mt}}function Q1(m,y){if(typeof m!="function")throw Error(a(191,m));m.call(y)}function J1(m,y){var k=m.callbacks;if(k!==null)for(m.callbacks=null,m=0;m<k.length;m++)Q1(k[m],y)}function Hc(m,y){try{var k=y.updateQueue,R=k!==null?k.lastEffect:null;if(R!==null){var X=R.next;k=X;do{if((k.tag&m)===m){R=void 0;var J=k.create,ce=k.inst;R=J(),ce.destroy=R}k=k.next}while(k!==X)}}catch(xe){Cr(y,y.return,xe)}}function Ii(m,y,k){try{var R=y.updateQueue,X=R!==null?R.lastEffect:null;if(X!==null){var J=X.next;R=J;do{if((R.tag&m)===m){var ce=R.inst,xe=ce.destroy;if(xe!==void 0){ce.destroy=void 0,X=y;var Ee=k;try{xe()}catch(Ue){Cr(X,Ee,Ue)}}}R=R.next}while(R!==J)}}catch(Ue){Cr(y,y.return,Ue)}}function ey(m){var y=m.updateQueue;if(y!==null){var k=m.stateNode;try{J1(y,k)}catch(R){Cr(m,m.return,R)}}}function ty(m,y,k){k.props=No(m.type,m.memoizedProps),k.state=m.memoizedState;try{k.componentWillUnmount()}catch(R){Cr(m,y,R)}}function ko(m,y){try{var k=m.ref;if(k!==null){var R=m.stateNode;switch(m.tag){case 26:case 27:case 5:var X=R;break;default:X=R}typeof k=="function"?m.refCleanup=k(X):k.current=X}}catch(J){Cr(m,y,J)}}function ba(m,y){var k=m.ref,R=m.refCleanup;if(k!==null)if(typeof R=="function")try{R()}catch(X){Cr(m,y,X)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof k=="function")try{k(null)}catch(X){Cr(m,y,X)}else k.current=null}function ry(m){var y=m.type,k=m.memoizedProps,R=m.stateNode;try{e:switch(y){case"button":case"input":case"select":case"textarea":k.autoFocus&&R.focus();break e;case"img":k.src?R.src=k.src:k.srcSet&&(R.srcset=k.srcSet)}}catch(X){Cr(m,m.return,X)}}function sy(m,y,k){try{var R=m.stateNode;t8(R,m.type,k,y),R[ge]=y}catch(X){Cr(m,m.return,X)}}function ay(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27||m.tag===4}function um(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||ay(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==27&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function dm(m,y,k){var R=m.tag;if(R===5||R===6)m=m.stateNode,y?k.nodeType===8?k.parentNode.insertBefore(m,y):k.insertBefore(m,y):(k.nodeType===8?(y=k.parentNode,y.insertBefore(m,k)):(y=k,y.appendChild(m)),k=k._reactRootContainer,k!=null||y.onclick!==null||(y.onclick=sf));else if(R!==4&&R!==27&&(m=m.child,m!==null))for(dm(m,y,k),m=m.sibling;m!==null;)dm(m,y,k),m=m.sibling}function Vd(m,y,k){var R=m.tag;if(R===5||R===6)m=m.stateNode,y?k.insertBefore(m,y):k.appendChild(m);else if(R!==4&&R!==27&&(m=m.child,m!==null))for(Vd(m,y,k),m=m.sibling;m!==null;)Vd(m,y,k),m=m.sibling}var ei=!1,Ur=!1,fm=!1,ny=typeof WeakSet=="function"?WeakSet:Set,ps=null,iy=!1;function Oj(m,y){if(m=m.containerInfo,Um=df,m=Nb(m),mh(m)){if("selectionStart"in m)var k={start:m.selectionStart,end:m.selectionEnd};else e:{k=(k=m.ownerDocument)&&k.defaultView||window;var R=k.getSelection&&k.getSelection();if(R&&R.rangeCount!==0){k=R.anchorNode;var X=R.anchorOffset,J=R.focusNode;R=R.focusOffset;try{k.nodeType,J.nodeType}catch{k=null;break e}var ce=0,xe=-1,Ee=-1,Ue=0,at=0,mt=m,Xe=null;t:for(;;){for(var rt;mt!==k||X!==0&&mt.nodeType!==3||(xe=ce+X),mt!==J||R!==0&&mt.nodeType!==3||(Ee=ce+R),mt.nodeType===3&&(ce+=mt.nodeValue.length),(rt=mt.firstChild)!==null;)Xe=mt,mt=rt;for(;;){if(mt===m)break t;if(Xe===k&&++Ue===X&&(xe=ce),Xe===J&&++at===R&&(Ee=ce),(rt=mt.nextSibling)!==null)break;mt=Xe,Xe=mt.parentNode}mt=rt}k=xe===-1||Ee===-1?null:{start:xe,end:Ee}}else k=null}k=k||{start:0,end:0}}else k=null;for($m={focusedElem:m,selectionRange:k},df=!1,ps=y;ps!==null;)if(y=ps,m=y.child,(y.subtreeFlags&1028)!==0&&m!==null)m.return=y,ps=m;else for(;ps!==null;){switch(y=ps,J=y.alternate,m=y.flags,y.tag){case 0:break;case 11:case 15:break;case 1:if(m&1024&&J!==null){m=void 0,k=y,X=J.memoizedProps,J=J.memoizedState,R=k.stateNode;try{var Rt=No(k.type,X,k.elementType===k.type);m=R.getSnapshotBeforeUpdate(Rt,J),R.__reactInternalSnapshotBeforeUpdate=m}catch(Wt){Cr(k,k.return,Wt)}}break;case 3:if(m&1024){if(m=y.stateNode.containerInfo,k=m.nodeType,k===9)qm(m);else if(k===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":qm(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(m&1024)throw Error(a(163))}if(m=y.sibling,m!==null){m.return=y.return,ps=m;break}ps=y.return}return Rt=iy,iy=!1,Rt}function oy(m,y,k){var R=k.flags;switch(k.tag){case 0:case 11:case 15:ri(m,k),R&4&&Hc(5,k);break;case 1:if(ri(m,k),R&4)if(m=k.stateNode,y===null)try{m.componentDidMount()}catch(xe){Cr(k,k.return,xe)}else{var X=No(k.type,y.memoizedProps);y=y.memoizedState;try{m.componentDidUpdate(X,y,m.__reactInternalSnapshotBeforeUpdate)}catch(xe){Cr(k,k.return,xe)}}R&64&&ey(k),R&512&&ko(k,k.return);break;case 3:if(ri(m,k),R&64&&(R=k.updateQueue,R!==null)){if(m=null,k.child!==null)switch(k.child.tag){case 27:case 5:m=k.child.stateNode;break;case 1:m=k.child.stateNode}try{J1(R,m)}catch(xe){Cr(k,k.return,xe)}}break;case 26:ri(m,k),R&512&&ko(k,k.return);break;case 27:case 5:ri(m,k),y===null&&R&4&&ry(k),R&512&&ko(k,k.return);break;case 12:ri(m,k);break;case 13:ri(m,k),R&4&&uy(m,k);break;case 22:if(X=k.memoizedState!==null||ei,!X){y=y!==null&&y.memoizedState!==null||Ur;var J=ei,ce=Ur;ei=X,(Ur=y)&&!ce?Li(m,k,(k.subtreeFlags&8772)!==0):ri(m,k),ei=J,Ur=ce}R&512&&(k.memoizedProps.mode==="manual"?ko(k,k.return):ba(k,k.return));break;default:ri(m,k)}}function ly(m){var y=m.alternate;y!==null&&(m.alternate=null,ly(y)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(y=m.stateNode,y!==null&&ze(y)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var ss=null,ya=!1;function ti(m,y,k){for(k=k.child;k!==null;)cy(m,y,k),k=k.sibling}function cy(m,y,k){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount(Ae,k)}catch{}switch(k.tag){case 26:Ur||ba(k,y),ti(m,y,k),k.memoizedState?k.memoizedState.count--:k.stateNode&&(k=k.stateNode,k.parentNode.removeChild(k));break;case 27:Ur||ba(k,y);var R=ss,X=ya;for(ss=k.stateNode,ti(m,y,k),k=k.stateNode,y=k.attributes;y.length;)k.removeAttributeNode(y[0]);ze(k),ss=R,ya=X;break;case 5:Ur||ba(k,y);case 6:X=ss;var J=ya;if(ss=null,ti(m,y,k),ss=X,ya=J,ss!==null)if(ya)try{m=ss,R=k.stateNode,m.nodeType===8?m.parentNode.removeChild(R):m.removeChild(R)}catch(ce){Cr(k,y,ce)}else try{ss.removeChild(k.stateNode)}catch(ce){Cr(k,y,ce)}break;case 18:ss!==null&&(ya?(y=ss,k=k.stateNode,y.nodeType===8?Vm(y.parentNode,k):y.nodeType===1&&Vm(y,k),ou(y)):Vm(ss,k.stateNode));break;case 4:R=ss,X=ya,ss=k.stateNode.containerInfo,ya=!0,ti(m,y,k),ss=R,ya=X;break;case 0:case 11:case 14:case 15:Ur||Ii(2,k,y),Ur||Ii(4,k,y),ti(m,y,k);break;case 1:Ur||(ba(k,y),R=k.stateNode,typeof R.componentWillUnmount=="function"&&ty(k,y,R)),ti(m,y,k);break;case 21:ti(m,y,k);break;case 22:Ur||ba(k,y),Ur=(R=Ur)||k.memoizedState!==null,ti(m,y,k),Ur=R;break;default:ti(m,y,k)}}function uy(m,y){if(y.memoizedState===null&&(m=y.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{ou(m)}catch(k){Cr(y,y.return,k)}}function Rj(m){switch(m.tag){case 13:case 19:var y=m.stateNode;return y===null&&(y=m.stateNode=new ny),y;case 22:return m=m.stateNode,y=m._retryCache,y===null&&(y=m._retryCache=new ny),y;default:throw Error(a(435,m.tag))}}function hm(m,y){var k=Rj(m);y.forEach(function(R){var X=qj.bind(null,m,R);k.has(R)||(k.add(R),R.then(X,X))})}function Da(m,y){var k=y.deletions;if(k!==null)for(var R=0;R<k.length;R++){var X=k[R],J=m,ce=y,xe=ce;e:for(;xe!==null;){switch(xe.tag){case 27:case 5:ss=xe.stateNode,ya=!1;break e;case 3:ss=xe.stateNode.containerInfo,ya=!0;break e;case 4:ss=xe.stateNode.containerInfo,ya=!0;break e}xe=xe.return}if(ss===null)throw Error(a(160));cy(J,ce,X),ss=null,ya=!1,J=X.alternate,J!==null&&(J.return=null),X.return=null}if(y.subtreeFlags&13878)for(y=y.child;y!==null;)dy(y,m),y=y.sibling}var on=null;function dy(m,y){var k=m.alternate,R=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:Da(y,m),Ua(m),R&4&&(Ii(3,m,m.return),Hc(3,m),Ii(5,m,m.return));break;case 1:Da(y,m),Ua(m),R&512&&(Ur||k===null||ba(k,k.return)),R&64&&ei&&(m=m.updateQueue,m!==null&&(R=m.callbacks,R!==null&&(k=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=k===null?R:k.concat(R))));break;case 26:var X=on;if(Da(y,m),Ua(m),R&512&&(Ur||k===null||ba(k,k.return)),R&4){var J=k!==null?k.memoizedState:null;if(R=m.memoizedState,k===null)if(R===null)if(m.stateNode===null){e:{R=m.type,k=m.memoizedProps,X=X.ownerDocument||X;t:switch(R){case"title":J=X.getElementsByTagName("title")[0],(!J||J[$e]||J[me]||J.namespaceURI==="http://www.w3.org/2000/svg"||J.hasAttribute("itemprop"))&&(J=X.createElement(R),X.head.insertBefore(J,X.querySelector("head > title"))),Ss(J,R,k),J[me]=m,Ce(J),R=J;break e;case"link":var ce=rv("link","href",X).get(R+(k.href||""));if(ce){for(var xe=0;xe<ce.length;xe++)if(J=ce[xe],J.getAttribute("href")===(k.href==null?null:k.href)&&J.getAttribute("rel")===(k.rel==null?null:k.rel)&&J.getAttribute("title")===(k.title==null?null:k.title)&&J.getAttribute("crossorigin")===(k.crossOrigin==null?null:k.crossOrigin)){ce.splice(xe,1);break t}}J=X.createElement(R),Ss(J,R,k),X.head.appendChild(J);break;case"meta":if(ce=rv("meta","content",X).get(R+(k.content||""))){for(xe=0;xe<ce.length;xe++)if(J=ce[xe],J.getAttribute("content")===(k.content==null?null:""+k.content)&&J.getAttribute("name")===(k.name==null?null:k.name)&&J.getAttribute("property")===(k.property==null?null:k.property)&&J.getAttribute("http-equiv")===(k.httpEquiv==null?null:k.httpEquiv)&&J.getAttribute("charset")===(k.charSet==null?null:k.charSet)){ce.splice(xe,1);break t}}J=X.createElement(R),Ss(J,R,k),X.head.appendChild(J);break;default:throw Error(a(468,R))}J[me]=m,Ce(J),R=J}m.stateNode=R}else sv(X,m.type,m.stateNode);else m.stateNode=tv(X,R,m.memoizedProps);else J!==R?(J===null?k.stateNode!==null&&(k=k.stateNode,k.parentNode.removeChild(k)):J.count--,R===null?sv(X,m.type,m.stateNode):tv(X,R,m.memoizedProps)):R===null&&m.stateNode!==null&&sy(m,m.memoizedProps,k.memoizedProps)}break;case 27:if(R&4&&m.alternate===null){X=m.stateNode,J=m.memoizedProps;try{for(var Ee=X.firstChild;Ee;){var Ue=Ee.nextSibling,at=Ee.nodeName;Ee[$e]||at==="HEAD"||at==="BODY"||at==="SCRIPT"||at==="STYLE"||at==="LINK"&&Ee.rel.toLowerCase()==="stylesheet"||X.removeChild(Ee),Ee=Ue}for(var mt=m.type,Xe=X.attributes;Xe.length;)X.removeAttributeNode(Xe[0]);Ss(X,mt,J),X[me]=m,X[ge]=J}catch(Rt){Cr(m,m.return,Rt)}}case 5:if(Da(y,m),Ua(m),R&512&&(Ur||k===null||ba(k,k.return)),m.flags&32){X=m.stateNode;try{Rs(X,"")}catch(Rt){Cr(m,m.return,Rt)}}R&4&&m.stateNode!=null&&(X=m.memoizedProps,sy(m,X,k!==null?k.memoizedProps:X)),R&1024&&(fm=!0);break;case 6:if(Da(y,m),Ua(m),R&4){if(m.stateNode===null)throw Error(a(162));R=m.memoizedProps,k=m.stateNode;try{k.nodeValue=R}catch(Rt){Cr(m,m.return,Rt)}}break;case 3:if(lf=null,X=on,on=nf(y.containerInfo),Da(y,m),on=X,Ua(m),R&4&&k!==null&&k.memoizedState.isDehydrated)try{ou(y.containerInfo)}catch(Rt){Cr(m,m.return,Rt)}fm&&(fm=!1,fy(m));break;case 4:R=on,on=nf(m.stateNode.containerInfo),Da(y,m),Ua(m),on=R;break;case 12:Da(y,m),Ua(m);break;case 13:Da(y,m),Ua(m),m.child.flags&8192&&m.memoizedState!==null!=(k!==null&&k.memoizedState!==null)&&(wm=Pe()),R&4&&(R=m.updateQueue,R!==null&&(m.updateQueue=null,hm(m,R)));break;case 22:if(R&512&&(Ur||k===null||ba(k,k.return)),Ee=m.memoizedState!==null,Ue=k!==null&&k.memoizedState!==null,at=ei,mt=Ur,ei=at||Ee,Ur=mt||Ue,Da(y,m),Ur=mt,ei=at,Ua(m),y=m.stateNode,y._current=m,y._visibility&=-3,y._visibility|=y._pendingVisibility&2,R&8192&&(y._visibility=Ee?y._visibility&-2:y._visibility|1,Ee&&(y=ei||Ur,k===null||Ue||y||_l(m)),m.memoizedProps===null||m.memoizedProps.mode!=="manual"))e:for(k=null,y=m;;){if(y.tag===5||y.tag===26||y.tag===27){if(k===null){Ue=k=y;try{if(X=Ue.stateNode,Ee)J=X.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none";else{ce=Ue.stateNode,xe=Ue.memoizedProps.style;var rt=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;ce.style.display=rt==null||typeof rt=="boolean"?"":(""+rt).trim()}}catch(Rt){Cr(Ue,Ue.return,Rt)}}}else if(y.tag===6){if(k===null){Ue=y;try{Ue.stateNode.nodeValue=Ee?"":Ue.memoizedProps}catch(Rt){Cr(Ue,Ue.return,Rt)}}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===m)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break e;for(;y.sibling===null;){if(y.return===null||y.return===m)break e;k===y&&(k=null),y=y.return}k===y&&(k=null),y.sibling.return=y.return,y=y.sibling}R&4&&(R=m.updateQueue,R!==null&&(k=R.retryQueue,k!==null&&(R.retryQueue=null,hm(m,k))));break;case 19:Da(y,m),Ua(m),R&4&&(R=m.updateQueue,R!==null&&(m.updateQueue=null,hm(m,R)));break;case 21:break;default:Da(y,m),Ua(m)}}function Ua(m){var y=m.flags;if(y&2){try{if(m.tag!==27){e:{for(var k=m.return;k!==null;){if(ay(k)){var R=k;break e}k=k.return}throw Error(a(160))}switch(R.tag){case 27:var X=R.stateNode,J=um(m);Vd(m,J,X);break;case 5:var ce=R.stateNode;R.flags&32&&(Rs(ce,""),R.flags&=-33);var xe=um(m);Vd(m,xe,ce);break;case 3:case 4:var Ee=R.stateNode.containerInfo,Ue=um(m);dm(m,Ue,Ee);break;default:throw Error(a(161))}}}catch(at){Cr(m,m.return,at)}m.flags&=-3}y&4096&&(m.flags&=-4097)}function fy(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var y=m;fy(y),y.tag===5&&y.flags&1024&&y.stateNode.reset(),m=m.sibling}}function ri(m,y){if(y.subtreeFlags&8772)for(y=y.child;y!==null;)oy(m,y.alternate,y),y=y.sibling}function _l(m){for(m=m.child;m!==null;){var y=m;switch(y.tag){case 0:case 11:case 14:case 15:Ii(4,y,y.return),_l(y);break;case 1:ba(y,y.return);var k=y.stateNode;typeof k.componentWillUnmount=="function"&&ty(y,y.return,k),_l(y);break;case 26:case 27:case 5:ba(y,y.return),_l(y);break;case 22:ba(y,y.return),y.memoizedState===null&&_l(y);break;default:_l(y)}m=m.sibling}}function Li(m,y,k){for(k=k&&(y.subtreeFlags&8772)!==0,y=y.child;y!==null;){var R=y.alternate,X=m,J=y,ce=J.flags;switch(J.tag){case 0:case 11:case 15:Li(X,J,k),Hc(4,J);break;case 1:if(Li(X,J,k),R=J,X=R.stateNode,typeof X.componentDidMount=="function")try{X.componentDidMount()}catch(Ue){Cr(R,R.return,Ue)}if(R=J,X=R.updateQueue,X!==null){var xe=R.stateNode;try{var Ee=X.shared.hiddenCallbacks;if(Ee!==null)for(X.shared.hiddenCallbacks=null,X=0;X<Ee.length;X++)Q1(Ee[X],xe)}catch(Ue){Cr(R,R.return,Ue)}}k&&ce&64&&ey(J),ko(J,J.return);break;case 26:case 27:case 5:Li(X,J,k),k&&R===null&&ce&4&&ry(J),ko(J,J.return);break;case 12:Li(X,J,k);break;case 13:Li(X,J,k),k&&ce&4&&uy(X,J);break;case 22:J.memoizedState===null&&Li(X,J,k),ko(J,J.return);break;default:Li(X,J,k)}y=y.sibling}}function mm(m,y){var k=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(k=m.memoizedState.cachePool.pool),m=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(m=y.memoizedState.cachePool.pool),m!==k&&(m!=null&&m.refCount++,k!=null&&Mc(k))}function pm(m,y){m=null,y.alternate!==null&&(m=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==m&&(y.refCount++,m!=null&&Mc(m))}function Pi(m,y,k,R){if(y.subtreeFlags&10256)for(y=y.child;y!==null;)hy(m,y,k,R),y=y.sibling}function hy(m,y,k,R){var X=y.flags;switch(y.tag){case 0:case 11:case 15:Pi(m,y,k,R),X&2048&&Hc(9,y);break;case 3:Pi(m,y,k,R),X&2048&&(m=null,y.alternate!==null&&(m=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==m&&(y.refCount++,m!=null&&Mc(m)));break;case 12:if(X&2048){Pi(m,y,k,R),m=y.stateNode;try{var J=y.memoizedProps,ce=J.id,xe=J.onPostCommit;typeof xe=="function"&&xe(ce,y.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(Ee){Cr(y,y.return,Ee)}}else Pi(m,y,k,R);break;case 23:break;case 22:J=y.stateNode,y.memoizedState!==null?J._visibility&4?Pi(m,y,k,R):Vc(m,y):J._visibility&4?Pi(m,y,k,R):(J._visibility|=4,wl(m,y,k,R,(y.subtreeFlags&10256)!==0)),X&2048&&mm(y.alternate,y);break;case 24:Pi(m,y,k,R),X&2048&&pm(y.alternate,y);break;default:Pi(m,y,k,R)}}function wl(m,y,k,R,X){for(X=X&&(y.subtreeFlags&10256)!==0,y=y.child;y!==null;){var J=m,ce=y,xe=k,Ee=R,Ue=ce.flags;switch(ce.tag){case 0:case 11:case 15:wl(J,ce,xe,Ee,X),Hc(8,ce);break;case 23:break;case 22:var at=ce.stateNode;ce.memoizedState!==null?at._visibility&4?wl(J,ce,xe,Ee,X):Vc(J,ce):(at._visibility|=4,wl(J,ce,xe,Ee,X)),X&&Ue&2048&&mm(ce.alternate,ce);break;case 24:wl(J,ce,xe,Ee,X),X&&Ue&2048&&pm(ce.alternate,ce);break;default:wl(J,ce,xe,Ee,X)}y=y.sibling}}function Vc(m,y){if(y.subtreeFlags&10256)for(y=y.child;y!==null;){var k=m,R=y,X=R.flags;switch(R.tag){case 22:Vc(k,R),X&2048&&mm(R.alternate,R);break;case 24:Vc(k,R),X&2048&&pm(R.alternate,R);break;default:Vc(k,R)}y=y.sibling}}var qc=8192;function Nl(m){if(m.subtreeFlags&qc)for(m=m.child;m!==null;)my(m),m=m.sibling}function my(m){switch(m.tag){case 26:Nl(m),m.flags&qc&&m.memoizedState!==null&&v8(on,m.memoizedState,m.memoizedProps);break;case 5:Nl(m);break;case 3:case 4:var y=on;on=nf(m.stateNode.containerInfo),Nl(m),on=y;break;case 22:m.memoizedState===null&&(y=m.alternate,y!==null&&y.memoizedState!==null?(y=qc,qc=16777216,Nl(m),qc=y):Nl(m));break;default:Nl(m)}}function py(m){var y=m.alternate;if(y!==null&&(m=y.child,m!==null)){y.child=null;do y=m.sibling,m.sibling=null,m=y;while(m!==null)}}function Gc(m){var y=m.deletions;if(m.flags&16){if(y!==null)for(var k=0;k<y.length;k++){var R=y[k];ps=R,xy(R,m)}py(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)gy(m),m=m.sibling}function gy(m){switch(m.tag){case 0:case 11:case 15:Gc(m),m.flags&2048&&Ii(9,m,m.return);break;case 3:Gc(m);break;case 12:Gc(m);break;case 22:var y=m.stateNode;m.memoizedState!==null&&y._visibility&4&&(m.return===null||m.return.tag!==13)?(y._visibility&=-5,qd(m)):Gc(m);break;default:Gc(m)}}function qd(m){var y=m.deletions;if(m.flags&16){if(y!==null)for(var k=0;k<y.length;k++){var R=y[k];ps=R,xy(R,m)}py(m)}for(m=m.child;m!==null;){switch(y=m,y.tag){case 0:case 11:case 15:Ii(8,y,y.return),qd(y);break;case 22:k=y.stateNode,k._visibility&4&&(k._visibility&=-5,qd(y));break;default:qd(y)}m=m.sibling}}function xy(m,y){for(;ps!==null;){var k=ps;switch(k.tag){case 0:case 11:case 15:Ii(8,k,y);break;case 23:case 22:if(k.memoizedState!==null&&k.memoizedState.cachePool!==null){var R=k.memoizedState.cachePool.pool;R!=null&&R.refCount++}break;case 24:Mc(k.memoizedState.cache)}if(R=k.child,R!==null)R.return=k,ps=R;else e:for(k=m;ps!==null;){R=ps;var X=R.sibling,J=R.return;if(ly(R),R===k){ps=null;break e}if(X!==null){X.return=J,ps=X;break e}ps=J}}}function Mj(m,y,k,R){this.tag=m,this.key=k,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $a(m,y,k,R){return new Mj(m,y,k,R)}function gm(m){return m=m.prototype,!(!m||!m.isReactComponent)}function Bi(m,y){var k=m.alternate;return k===null?(k=$a(m.tag,y,m.key,m.mode),k.elementType=m.elementType,k.type=m.type,k.stateNode=m.stateNode,k.alternate=m,m.alternate=k):(k.pendingProps=y,k.type=m.type,k.flags=0,k.subtreeFlags=0,k.deletions=null),k.flags=m.flags&31457280,k.childLanes=m.childLanes,k.lanes=m.lanes,k.child=m.child,k.memoizedProps=m.memoizedProps,k.memoizedState=m.memoizedState,k.updateQueue=m.updateQueue,y=m.dependencies,k.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},k.sibling=m.sibling,k.index=m.index,k.ref=m.ref,k.refCleanup=m.refCleanup,k}function by(m,y){m.flags&=31457282;var k=m.alternate;return k===null?(m.childLanes=0,m.lanes=y,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=k.childLanes,m.lanes=k.lanes,m.child=k.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=k.memoizedProps,m.memoizedState=k.memoizedState,m.updateQueue=k.updateQueue,m.type=k.type,y=k.dependencies,m.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),m}function Gd(m,y,k,R,X,J){var ce=0;if(R=m,typeof m=="function")gm(m)&&(ce=1);else if(typeof m=="string")ce=b8(m,k,oe.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case u:return Co(k.children,X,J,y);case o:ce=8,X|=24;break;case d:return m=$a(12,k,y,X|2),m.elementType=d,m.lanes=J,m;case x:return m=$a(13,k,y,X),m.elementType=x,m.lanes=J,m;case b:return m=$a(19,k,y,X),m.elementType=b,m.lanes=J,m;case N:return yy(k,X,J,y);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case g:case h:ce=10;break e;case p:ce=9;break e;case f:ce=11;break e;case v:ce=14;break e;case _:ce=16,R=null;break e}ce=29,k=Error(a(130,m===null?"null":typeof m,"")),R=null}return y=$a(ce,k,y,X),y.elementType=m,y.type=R,y.lanes=J,y}function Co(m,y,k,R){return m=$a(7,m,R,y),m.lanes=k,m}function yy(m,y,k,R){m=$a(22,m,R,y),m.elementType=N,m.lanes=k;var X={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var J=X._current;if(J===null)throw Error(a(456));if(!(X._pendingVisibility&2)){var ce=ki(J,2);ce!==null&&(X._pendingVisibility|=2,Xs(ce,J,2))}},attach:function(){var J=X._current;if(J===null)throw Error(a(456));if(X._pendingVisibility&2){var ce=ki(J,2);ce!==null&&(X._pendingVisibility&=-3,Xs(ce,J,2))}}};return m.stateNode=X,m}function xm(m,y,k){return m=$a(6,m,null,y),m.lanes=k,m}function bm(m,y,k){return y=$a(4,m.children!==null?m.children:[],m.key,y),y.lanes=k,y.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},y}function si(m){m.flags|=4}function vy(m,y){if(y.type!=="stylesheet"||y.state.loading&4)m.flags&=-16777217;else if(m.flags|=16777216,!av(y)){if(y=Ba.current,y!==null&&((dr&4194176)===dr?Cn!==null:(dr&62914560)!==dr&&!(dr&536870912)||y!==Cn))throw Ac=Nh,Pb;m.flags|=8192}}function Yd(m,y){y!==null&&(m.flags|=4),m.flags&16384&&(y=m.tag!==22?Vt():536870912,m.lanes|=y,Sl|=y)}function Yc(m,y){if(!xr)switch(m.tailMode){case"hidden":y=m.tail;for(var k=null;y!==null;)y.alternate!==null&&(k=y),y=y.sibling;k===null?m.tail=null:k.sibling=null;break;case"collapsed":k=m.tail;for(var R=null;k!==null;)k.alternate!==null&&(R=k),k=k.sibling;R===null?y||m.tail===null?m.tail=null:m.tail.sibling=null:R.sibling=null}}function Pr(m){var y=m.alternate!==null&&m.alternate.child===m.child,k=0,R=0;if(y)for(var X=m.child;X!==null;)k|=X.lanes|X.childLanes,R|=X.subtreeFlags&31457280,R|=X.flags&31457280,X.return=m,X=X.sibling;else for(X=m.child;X!==null;)k|=X.lanes|X.childLanes,R|=X.subtreeFlags,R|=X.flags,X.return=m,X=X.sibling;return m.subtreeFlags|=R,m.childLanes=k,y}function Fj(m,y,k){var R=y.pendingProps;switch(_h(y),y.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pr(y),null;case 1:return Pr(y),null;case 3:return k=y.stateNode,R=null,m!==null&&(R=m.memoizedState.cache),y.memoizedState.cache!==R&&(y.flags|=2048),Jn(us),we(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(m===null||m.child===null)&&(kc(y)?si(y):m===null||m.memoizedState.isDehydrated&&!(y.flags&256)||(y.flags|=1024,nn!==null&&(km(nn),nn=null))),Pr(y),null;case 26:return k=y.memoizedState,m===null?(si(y),k!==null?(Pr(y),vy(y,k)):(Pr(y),y.flags&=-16777217)):k?k!==m.memoizedState?(si(y),Pr(y),vy(y,k)):(Pr(y),y.flags&=-16777217):(m.memoizedProps!==R&&si(y),Pr(y),y.flags&=-16777217),null;case 27:Se(y),k=le.current;var X=y.type;if(m!==null&&y.stateNode!=null)m.memoizedProps!==R&&si(y);else{if(!R){if(y.stateNode===null)throw Error(a(166));return Pr(y),null}m=oe.current,kc(y)?Ib(y):(m=Ky(X,R,k),y.stateNode=m,si(y))}return Pr(y),null;case 5:if(Se(y),k=y.type,m!==null&&y.stateNode!=null)m.memoizedProps!==R&&si(y);else{if(!R){if(y.stateNode===null)throw Error(a(166));return Pr(y),null}if(m=oe.current,kc(y))Ib(y);else{switch(X=af(le.current),m){case 1:m=X.createElementNS("http://www.w3.org/2000/svg",k);break;case 2:m=X.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;default:switch(k){case"svg":m=X.createElementNS("http://www.w3.org/2000/svg",k);break;case"math":m=X.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;case"script":m=X.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof R.is=="string"?X.createElement("select",{is:R.is}):X.createElement("select"),R.multiple?m.multiple=!0:R.size&&(m.size=R.size);break;default:m=typeof R.is=="string"?X.createElement(k,{is:R.is}):X.createElement(k)}}m[me]=y,m[ge]=R;e:for(X=y.child;X!==null;){if(X.tag===5||X.tag===6)m.appendChild(X.stateNode);else if(X.tag!==4&&X.tag!==27&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===y)break e;for(;X.sibling===null;){if(X.return===null||X.return===y)break e;X=X.return}X.sibling.return=X.return,X=X.sibling}y.stateNode=m;e:switch(Ss(m,k,R),k){case"button":case"input":case"select":case"textarea":m=!!R.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&si(y)}}return Pr(y),y.flags&=-16777217,null;case 6:if(m&&y.stateNode!=null)m.memoizedProps!==R&&si(y);else{if(typeof R!="string"&&y.stateNode===null)throw Error(a(166));if(m=le.current,kc(y)){if(m=y.stateNode,k=y.memoizedProps,R=null,X=Ws,X!==null)switch(X.tag){case 27:case 5:R=X.memoizedProps}m[me]=y,m=!!(m.nodeValue===k||R!==null&&R.suppressHydrationWarning===!0||Vy(m.nodeValue,k)),m||xo(y)}else m=af(m).createTextNode(R),m[me]=y,y.stateNode=m}return Pr(y),null;case 13:if(R=y.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(X=kc(y),R!==null&&R.dehydrated!==null){if(m===null){if(!X)throw Error(a(318));if(X=y.memoizedState,X=X!==null?X.dehydrated:null,!X)throw Error(a(317));X[me]=y}else Cc(),!(y.flags&128)&&(y.memoizedState=null),y.flags|=4;Pr(y),X=!1}else nn!==null&&(km(nn),nn=null),X=!0;if(!X)return y.flags&256?(Xn(y),y):(Xn(y),null)}if(Xn(y),y.flags&128)return y.lanes=k,y;if(k=R!==null,m=m!==null&&m.memoizedState!==null,k){R=y.child,X=null,R.alternate!==null&&R.alternate.memoizedState!==null&&R.alternate.memoizedState.cachePool!==null&&(X=R.alternate.memoizedState.cachePool.pool);var J=null;R.memoizedState!==null&&R.memoizedState.cachePool!==null&&(J=R.memoizedState.cachePool.pool),J!==X&&(R.flags|=2048)}return k!==m&&k&&(y.child.flags|=8192),Yd(y,y.updateQueue),Pr(y),null;case 4:return we(),m===null&&Pm(y.stateNode.containerInfo),Pr(y),null;case 10:return Jn(y.type),Pr(y),null;case 19:if(H(cs),X=y.memoizedState,X===null)return Pr(y),null;if(R=(y.flags&128)!==0,J=X.rendering,J===null)if(R)Yc(X,!1);else{if($r!==0||m!==null&&m.flags&128)for(m=y.child;m!==null;){if(J=Ad(m),J!==null){for(y.flags|=128,Yc(X,!1),m=J.updateQueue,y.updateQueue=m,Yd(y,m),y.subtreeFlags=0,m=k,k=y.child;k!==null;)by(k,m),k=k.sibling;return Q(cs,cs.current&1|2),y.child}m=m.sibling}X.tail!==null&&Pe()>Wd&&(y.flags|=128,R=!0,Yc(X,!1),y.lanes=4194304)}else{if(!R)if(m=Ad(J),m!==null){if(y.flags|=128,R=!0,m=m.updateQueue,y.updateQueue=m,Yd(y,m),Yc(X,!0),X.tail===null&&X.tailMode==="hidden"&&!J.alternate&&!xr)return Pr(y),null}else 2*Pe()-X.renderingStartTime>Wd&&k!==536870912&&(y.flags|=128,R=!0,Yc(X,!1),y.lanes=4194304);X.isBackwards?(J.sibling=y.child,y.child=J):(m=X.last,m!==null?m.sibling=J:y.child=J,X.last=J)}return X.tail!==null?(y=X.tail,X.rendering=y,X.tail=y.sibling,X.renderingStartTime=Pe(),y.sibling=null,m=cs.current,Q(cs,R?m&1|2:m&1),y):(Pr(y),null);case 22:case 23:return Xn(y),Sh(),R=y.memoizedState!==null,m!==null?m.memoizedState!==null!==R&&(y.flags|=8192):R&&(y.flags|=8192),R?k&536870912&&!(y.flags&128)&&(Pr(y),y.subtreeFlags&6&&(y.flags|=8192)):Pr(y),k=y.updateQueue,k!==null&&Yd(y,k.retryQueue),k=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(k=m.memoizedState.cachePool.pool),R=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(R=y.memoizedState.cachePool.pool),R!==k&&(y.flags|=2048),m!==null&&H(yo),null;case 24:return k=null,m!==null&&(k=m.memoizedState.cache),y.memoizedState.cache!==k&&(y.flags|=2048),Jn(us),Pr(y),null;case 25:return null}throw Error(a(156,y.tag))}function Ij(m,y){switch(_h(y),y.tag){case 1:return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 3:return Jn(us),we(),m=y.flags,m&65536&&!(m&128)?(y.flags=m&-65537|128,y):null;case 26:case 27:case 5:return Se(y),null;case 13:if(Xn(y),m=y.memoizedState,m!==null&&m.dehydrated!==null){if(y.alternate===null)throw Error(a(340));Cc()}return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 19:return H(cs),null;case 4:return we(),null;case 10:return Jn(y.type),null;case 22:case 23:return Xn(y),Sh(),m!==null&&H(yo),m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 24:return Jn(us),null;case 25:return null;default:return null}}function _y(m,y){switch(_h(y),y.tag){case 3:Jn(us),we();break;case 26:case 27:case 5:Se(y);break;case 4:we();break;case 13:Xn(y);break;case 19:H(cs);break;case 10:Jn(y.type);break;case 22:case 23:Xn(y),Sh(),m!==null&&H(yo);break;case 24:Jn(us)}}var Lj={getCacheForType:function(m){var y=Ms(us),k=y.data.get(m);return k===void 0&&(k=m(),y.data.set(m,k)),k}},Pj=typeof WeakMap=="function"?WeakMap:Map,Br=0,Tr=null,sr=null,dr=0,Ar=0,va=null,ai=!1,jl=!1,ym=!1,ni=0,$r=0,Di=0,Eo=0,vm=0,za=0,Sl=0,Wc=null,Tn=null,_m=!1,wm=0,Wd=1/0,Xd=null,Ui=null,Kd=!1,To=null,Xc=0,Nm=0,jm=null,Kc=0,Sm=null;function _a(){if(Br&2&&dr!==0)return dr&-dr;if(U.T!==null){var m=gl;return m!==0?m:Mm()}return Qe()}function wy(){za===0&&(za=!(dr&536870912)||xr?Ke():536870912);var m=Ba.current;return m!==null&&(m.flags|=32),za}function Xs(m,y,k){(m===Tr&&Ar===2||m.cancelPendingCommit!==null)&&(kl(m,0),ii(m,dr,za,!1)),et(m,k),(!(Br&2)||m!==Tr)&&(m===Tr&&(!(Br&2)&&(Eo|=k),$r===4&&ii(m,dr,za,!1)),An(m))}function Ny(m,y,k){if(Br&6)throw Error(a(327));var R=!k&&(y&60)===0&&(y&m.expiredLanes)===0||ut(m,y),X=R?Uj(m,y):Tm(m,y,!0),J=R;do{if(X===0){jl&&!R&&ii(m,y,0,!1);break}else if(X===6)ii(m,y,0,!ai);else{if(k=m.current.alternate,J&&!Bj(k)){X=Tm(m,y,!1),J=!1;continue}if(X===2){if(J=y,m.errorRecoveryDisabledLanes&J)var ce=0;else ce=m.pendingLanes&-536870913,ce=ce!==0?ce:ce&536870912?536870912:0;if(ce!==0){y=ce;e:{var xe=m;X=Wc;var Ee=xe.current.memoizedState.isDehydrated;if(Ee&&(kl(xe,ce).flags|=256),ce=Tm(xe,ce,!1),ce!==2){if(ym&&!Ee){xe.errorRecoveryDisabledLanes|=J,Eo|=J,X=4;break e}J=Tn,Tn=X,J!==null&&km(J)}X=ce}if(J=!1,X!==2)continue}}if(X===1){kl(m,0),ii(m,y,0,!0);break}e:{switch(R=m,X){case 0:case 1:throw Error(a(345));case 4:if((y&4194176)===y){ii(R,y,za,!ai);break e}break;case 2:Tn=null;break;case 3:case 5:break;default:throw Error(a(329))}if(R.finishedWork=k,R.finishedLanes=y,(y&62914560)===y&&(J=wm+300-Pe(),10<J)){if(ii(R,y,za,!ai),Tt(R,0)!==0)break e;R.timeoutHandle=Yy(jy.bind(null,R,k,Tn,Xd,_m,y,za,Eo,Sl,ai,2,-0,0),J);break e}jy(R,k,Tn,Xd,_m,y,za,Eo,Sl,ai,0,-0,0)}}break}while(!0);An(m)}function km(m){Tn===null?Tn=m:Tn.push.apply(Tn,m)}function jy(m,y,k,R,X,J,ce,xe,Ee,Ue,at,mt,Xe){var rt=y.subtreeFlags;if((rt&8192||(rt&16785408)===16785408)&&(ru={stylesheets:null,count:0,unsuspend:y8},my(y),y=_8(),y!==null)){m.cancelPendingCommit=y(Oy.bind(null,m,k,R,X,ce,xe,Ee,1,mt,Xe)),ii(m,J,ce,!Ue);return}Oy(m,k,R,X,ce,xe,Ee,at,mt,Xe)}function Bj(m){for(var y=m;;){var k=y.tag;if((k===0||k===11||k===15)&&y.flags&16384&&(k=y.updateQueue,k!==null&&(k=k.stores,k!==null)))for(var R=0;R<k.length;R++){var X=k[R],J=X.getSnapshot;X=X.value;try{if(!xa(J(),X))return!1}catch{return!1}}if(k=y.child,y.subtreeFlags&16384&&k!==null)k.return=y,y=k;else{if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function ii(m,y,k,R){y&=~vm,y&=~Eo,m.suspendedLanes|=y,m.pingedLanes&=~y,R&&(m.warmLanes|=y),R=m.expirationTimes;for(var X=y;0<X;){var J=31-lt(X),ce=1<<J;R[J]=-1,X&=~ce}k!==0&&At(m,k,y)}function Zd(){return Br&6?!0:(Zc(0),!1)}function Cm(){if(sr!==null){if(Ar===0)var m=sr.return;else m=sr,Qn=jo=null,Mh(m),ml=null,Oc=0,m=sr;for(;m!==null;)_y(m.alternate,m),m=m.return;sr=null}}function kl(m,y){m.finishedWork=null,m.finishedLanes=0;var k=m.timeoutHandle;k!==-1&&(m.timeoutHandle=-1,s8(k)),k=m.cancelPendingCommit,k!==null&&(m.cancelPendingCommit=null,k()),Cm(),Tr=m,sr=k=Bi(m.current,null),dr=y,Ar=0,va=null,ai=!1,jl=ut(m,y),ym=!1,Sl=za=vm=Eo=Di=$r=0,Tn=Wc=null,_m=!1,y&8&&(y|=y&32);var R=m.entangledLanes;if(R!==0)for(m=m.entanglements,R&=y;0<R;){var X=31-lt(R),J=1<<X;y|=m[X],R&=~J}return ni=y,_d(),k}function Sy(m,y){er=null,U.H=En,y===Tc?(y=Ub(),Ar=3):y===Pb?(y=Ub(),Ar=4):Ar=y===B1?8:y!==null&&typeof y=="object"&&typeof y.then=="function"?6:1,va=y,sr===null&&($r=1,$d(m,Ia(y,m.current)))}function ky(){var m=U.H;return U.H=En,m===null?En:m}function Cy(){var m=U.A;return U.A=Lj,m}function Em(){$r=4,ai||(dr&4194176)!==dr&&Ba.current!==null||(jl=!0),!(Di&134217727)&&!(Eo&134217727)||Tr===null||ii(Tr,dr,za,!1)}function Tm(m,y,k){var R=Br;Br|=2;var X=ky(),J=Cy();(Tr!==m||dr!==y)&&(Xd=null,kl(m,y)),y=!1;var ce=$r;e:do try{if(Ar!==0&&sr!==null){var xe=sr,Ee=va;switch(Ar){case 8:Cm(),ce=6;break e;case 3:case 2:case 6:Ba.current===null&&(y=!0);var Ue=Ar;if(Ar=0,va=null,Cl(m,xe,Ee,Ue),k&&jl){ce=0;break e}break;default:Ue=Ar,Ar=0,va=null,Cl(m,xe,Ee,Ue)}}Dj(),ce=$r;break}catch(at){Sy(m,at)}while(!0);return y&&m.shellSuspendCounter++,Qn=jo=null,Br=R,U.H=X,U.A=J,sr===null&&(Tr=null,dr=0,_d()),ce}function Dj(){for(;sr!==null;)Ey(sr)}function Uj(m,y){var k=Br;Br|=2;var R=ky(),X=Cy();Tr!==m||dr!==y?(Xd=null,Wd=Pe()+500,kl(m,y)):jl=ut(m,y);e:do try{if(Ar!==0&&sr!==null){y=sr;var J=va;t:switch(Ar){case 1:Ar=0,va=null,Cl(m,y,J,1);break;case 2:if(Bb(J)){Ar=0,va=null,Ty(y);break}y=function(){Ar===2&&Tr===m&&(Ar=7),An(m)},J.then(y,y);break e;case 3:Ar=7;break e;case 4:Ar=5;break e;case 7:Bb(J)?(Ar=0,va=null,Ty(y)):(Ar=0,va=null,Cl(m,y,J,7));break;case 5:var ce=null;switch(sr.tag){case 26:ce=sr.memoizedState;case 5:case 27:var xe=sr;if(!ce||av(ce)){Ar=0,va=null;var Ee=xe.sibling;if(Ee!==null)sr=Ee;else{var Ue=xe.return;Ue!==null?(sr=Ue,Qd(Ue)):sr=null}break t}}Ar=0,va=null,Cl(m,y,J,5);break;case 6:Ar=0,va=null,Cl(m,y,J,6);break;case 8:Cm(),$r=6;break e;default:throw Error(a(462))}}$j();break}catch(at){Sy(m,at)}while(!0);return Qn=jo=null,U.H=R,U.A=X,Br=k,sr!==null?0:(Tr=null,dr=0,_d(),$r)}function $j(){for(;sr!==null&&!je();)Ey(sr)}function Ey(m){var y=K1(m.alternate,m,ni);m.memoizedProps=m.pendingProps,y===null?Qd(m):sr=y}function Ty(m){var y=m,k=y.alternate;switch(y.tag){case 15:case 0:y=V1(k,y,y.pendingProps,y.type,void 0,dr);break;case 11:y=V1(k,y,y.pendingProps,y.type.render,y.ref,dr);break;case 5:Mh(y);default:_y(k,y),y=sr=by(y,ni),y=K1(k,y,ni)}m.memoizedProps=m.pendingProps,y===null?Qd(m):sr=y}function Cl(m,y,k,R){Qn=jo=null,Mh(y),ml=null,Oc=0;var X=y.return;try{if(Tj(m,X,y,k,dr)){$r=1,$d(m,Ia(k,m.current)),sr=null;return}}catch(J){if(X!==null)throw sr=X,J;$r=1,$d(m,Ia(k,m.current)),sr=null;return}y.flags&32768?(xr||R===1?m=!0:jl||dr&536870912?m=!1:(ai=m=!0,(R===2||R===3||R===6)&&(R=Ba.current,R!==null&&R.tag===13&&(R.flags|=16384))),Ay(y,m)):Qd(y)}function Qd(m){var y=m;do{if(y.flags&32768){Ay(y,ai);return}m=y.return;var k=Fj(y.alternate,y,ni);if(k!==null){sr=k;return}if(y=y.sibling,y!==null){sr=y;return}sr=y=m}while(y!==null);$r===0&&($r=5)}function Ay(m,y){do{var k=Ij(m.alternate,m);if(k!==null){k.flags&=32767,sr=k;return}if(k=m.return,k!==null&&(k.flags|=32768,k.subtreeFlags=0,k.deletions=null),!y&&(m=m.sibling,m!==null)){sr=m;return}sr=m=k}while(m!==null);$r=6,sr=null}function Oy(m,y,k,R,X,J,ce,xe,Ee,Ue){var at=U.T,mt=K.p;try{K.p=2,U.T=null,zj(m,y,k,R,mt,X,J,ce,xe,Ee,Ue)}finally{U.T=at,K.p=mt}}function zj(m,y,k,R,X,J,ce,xe){do El();while(To!==null);if(Br&6)throw Error(a(327));var Ee=m.finishedWork;if(R=m.finishedLanes,Ee===null)return null;if(m.finishedWork=null,m.finishedLanes=0,Ee===m.current)throw Error(a(177));m.callbackNode=null,m.callbackPriority=0,m.cancelPendingCommit=null;var Ue=Ee.lanes|Ee.childLanes;if(Ue|=bh,ot(m,R,Ue,J,ce,xe),m===Tr&&(sr=Tr=null,dr=0),!(Ee.subtreeFlags&10256)&&!(Ee.flags&10256)||Kd||(Kd=!0,Nm=Ue,jm=k,Gj(ee,function(){return El(),null})),k=(Ee.flags&15990)!==0,Ee.subtreeFlags&15990||k?(k=U.T,U.T=null,J=K.p,K.p=2,ce=Br,Br|=4,Oj(m,Ee),dy(Ee,m),fj($m,m.containerInfo),df=!!Um,$m=Um=null,m.current=Ee,oy(m,Ee.alternate,Ee),Ie(),Br=ce,K.p=J,U.T=k):m.current=Ee,Kd?(Kd=!1,To=m,Xc=R):Ry(m,Ue),Ue=m.pendingLanes,Ue===0&&(Ui=null),st(Ee.stateNode),An(m),y!==null)for(X=m.onRecoverableError,Ee=0;Ee<y.length;Ee++)Ue=y[Ee],X(Ue.value,{componentStack:Ue.stack});return Xc&3&&El(),Ue=m.pendingLanes,R&4194218&&Ue&42?m===Sm?Kc++:(Kc=0,Sm=m):Kc=0,Zc(0),null}function Ry(m,y){(m.pooledCacheLanes&=y)===0&&(y=m.pooledCache,y!=null&&(m.pooledCache=null,Mc(y)))}function El(){if(To!==null){var m=To,y=Nm;Nm=0;var k=Ve(Xc),R=U.T,X=K.p;try{if(K.p=32>k?32:k,U.T=null,To===null)var J=!1;else{k=jm,jm=null;var ce=To,xe=Xc;if(To=null,Xc=0,Br&6)throw Error(a(331));var Ee=Br;if(Br|=4,gy(ce.current),hy(ce,ce.current,xe,k),Br=Ee,Zc(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot(Ae,ce)}catch{}J=!0}return J}finally{K.p=X,U.T=R,Ry(m,y)}}return!1}function My(m,y,k){y=Ia(k,y),y=Yh(m.stateNode,y,2),m=Fi(m,y,2),m!==null&&(et(m,2),An(m))}function Cr(m,y,k){if(m.tag===3)My(m,m,k);else for(;y!==null;){if(y.tag===3){My(y,m,k);break}else if(y.tag===1){var R=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&(Ui===null||!Ui.has(R))){m=Ia(k,m),k=L1(2),R=Fi(y,k,2),R!==null&&(P1(k,R,y,m),et(R,2),An(R));break}}y=y.return}}function Am(m,y,k){var R=m.pingCache;if(R===null){R=m.pingCache=new Pj;var X=new Set;R.set(y,X)}else X=R.get(y),X===void 0&&(X=new Set,R.set(y,X));X.has(k)||(ym=!0,X.add(k),m=Hj.bind(null,m,y,k),y.then(m,m))}function Hj(m,y,k){var R=m.pingCache;R!==null&&R.delete(y),m.pingedLanes|=m.suspendedLanes&k,m.warmLanes&=~k,Tr===m&&(dr&k)===k&&($r===4||$r===3&&(dr&62914560)===dr&&300>Pe()-wm?!(Br&2)&&kl(m,0):vm|=k,Sl===dr&&(Sl=0)),An(m)}function Fy(m,y){y===0&&(y=Vt()),m=ki(m,y),m!==null&&(et(m,y),An(m))}function Vj(m){var y=m.memoizedState,k=0;y!==null&&(k=y.retryLane),Fy(m,k)}function qj(m,y){var k=0;switch(m.tag){case 13:var R=m.stateNode,X=m.memoizedState;X!==null&&(k=X.retryLane);break;case 19:R=m.stateNode;break;case 22:R=m.stateNode._retryCache;break;default:throw Error(a(314))}R!==null&&R.delete(y),Fy(m,k)}function Gj(m,y){return Me(m,y)}var Jd=null,Tl=null,Om=!1,ef=!1,Rm=!1,Ao=0;function An(m){m!==Tl&&m.next===null&&(Tl===null?Jd=Tl=m:Tl=Tl.next=m),ef=!0,Om||(Om=!0,Wj(Yj))}function Zc(m,y){if(!Rm&&ef){Rm=!0;do for(var k=!1,R=Jd;R!==null;){if(m!==0){var X=R.pendingLanes;if(X===0)var J=0;else{var ce=R.suspendedLanes,xe=R.pingedLanes;J=(1<<31-lt(42|m)+1)-1,J&=X&~(ce&~xe),J=J&201326677?J&201326677|1:J?J|2:0}J!==0&&(k=!0,Py(R,J))}else J=dr,J=Tt(R,R===Tr?J:0),!(J&3)||ut(R,J)||(k=!0,Py(R,J));R=R.next}while(k);Rm=!1}}function Yj(){ef=Om=!1;var m=0;Ao!==0&&(r8()&&(m=Ao),Ao=0);for(var y=Pe(),k=null,R=Jd;R!==null;){var X=R.next,J=Iy(R,y);J===0?(R.next=null,k===null?Jd=X:k.next=X,X===null&&(Tl=k)):(k=R,(m!==0||J&3)&&(ef=!0)),R=X}Zc(m)}function Iy(m,y){for(var k=m.suspendedLanes,R=m.pingedLanes,X=m.expirationTimes,J=m.pendingLanes&-62914561;0<J;){var ce=31-lt(J),xe=1<<ce,Ee=X[ce];Ee===-1?(!(xe&k)||xe&R)&&(X[ce]=jt(xe,y)):Ee<=y&&(m.expiredLanes|=xe),J&=~xe}if(y=Tr,k=dr,k=Tt(m,m===y?k:0),R=m.callbackNode,k===0||m===y&&Ar===2||m.cancelPendingCommit!==null)return R!==null&&R!==null&&Oe(R),m.callbackNode=null,m.callbackPriority=0;if(!(k&3)||ut(m,k)){if(y=k&-k,y===m.callbackPriority)return y;switch(R!==null&&Oe(R),Ve(k)){case 2:case 8:k=ie;break;case 32:k=ee;break;case 268435456:k=fe;break;default:k=ee}return R=Ly.bind(null,m),k=Me(k,R),m.callbackPriority=y,m.callbackNode=k,y}return R!==null&&R!==null&&Oe(R),m.callbackPriority=2,m.callbackNode=null,2}function Ly(m,y){var k=m.callbackNode;if(El()&&m.callbackNode!==k)return null;var R=dr;return R=Tt(m,m===Tr?R:0),R===0?null:(Ny(m,R,y),Iy(m,Pe()),m.callbackNode!=null&&m.callbackNode===k?Ly.bind(null,m):null)}function Py(m,y){if(El())return null;Ny(m,y,!0)}function Wj(m){a8(function(){Br&6?Me(ct,m):m()})}function Mm(){return Ao===0&&(Ao=Ke()),Ao}function By(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:qn(""+m)}function Dy(m,y){var k=y.ownerDocument.createElement("input");return k.name=y.name,k.value=y.value,m.id&&k.setAttribute("form",m.id),y.parentNode.insertBefore(k,y),m=new FormData(m),k.parentNode.removeChild(k),m}function Xj(m,y,k,R,X){if(y==="submit"&&k&&k.stateNode===X){var J=By((X[ge]||null).action),ce=R.submitter;ce&&(y=(y=ce[ge]||null)?By(y.formAction):ce.getAttribute("formAction"),y!==null&&(J=y,ce=null));var xe=new bd("action","action",null,R,X);m.push({event:xe,listeners:[{instance:null,listener:function(){if(R.defaultPrevented){if(Ao!==0){var Ee=ce?Dy(X,ce):new FormData(X);zh(k,{pending:!0,data:Ee,method:X.method,action:J},null,Ee)}}else typeof J=="function"&&(xe.preventDefault(),Ee=ce?Dy(X,ce):new FormData(X),zh(k,{pending:!0,data:Ee,method:X.method,action:J},J,Ee))},currentTarget:X}]})}}for(var Fm=0;Fm<Ob.length;Fm++){var Im=Ob[Fm],Kj=Im.toLowerCase(),Zj=Im[0].toUpperCase()+Im.slice(1);an(Kj,"on"+Zj)}an(kb,"onAnimationEnd"),an(Cb,"onAnimationIteration"),an(Eb,"onAnimationStart"),an("dblclick","onDoubleClick"),an("focusin","onFocus"),an("focusout","onBlur"),an(mj,"onTransitionRun"),an(pj,"onTransitionStart"),an(gj,"onTransitionCancel"),an(Tb,"onTransitionEnd"),ft("onMouseEnter",["mouseout","mouseover"]),ft("onMouseLeave",["mouseout","mouseover"]),ft("onPointerEnter",["pointerout","pointerover"]),ft("onPointerLeave",["pointerout","pointerover"]),gt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gt("onBeforeInput",["compositionend","keypress","textInput","paste"]),gt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qc));function Uy(m,y){y=(y&4)!==0;for(var k=0;k<m.length;k++){var R=m[k],X=R.event;R=R.listeners;e:{var J=void 0;if(y)for(var ce=R.length-1;0<=ce;ce--){var xe=R[ce],Ee=xe.instance,Ue=xe.currentTarget;if(xe=xe.listener,Ee!==J&&X.isPropagationStopped())break e;J=xe,X.currentTarget=Ue;try{J(X)}catch(at){Ud(at)}X.currentTarget=null,J=Ee}else for(ce=0;ce<R.length;ce++){if(xe=R[ce],Ee=xe.instance,Ue=xe.currentTarget,xe=xe.listener,Ee!==J&&X.isPropagationStopped())break e;J=xe,X.currentTarget=Ue;try{J(X)}catch(at){Ud(at)}X.currentTarget=null,J=Ee}}}}function lr(m,y){var k=y[ve];k===void 0&&(k=y[ve]=new Set);var R=m+"__bubble";k.has(R)||($y(y,m,2,!1),k.add(R))}function Lm(m,y,k){var R=0;y&&(R|=4),$y(k,m,R,y)}var tf="_reactListening"+Math.random().toString(36).slice(2);function Pm(m){if(!m[tf]){m[tf]=!0,Ye.forEach(function(k){k!=="selectionchange"&&(Qj.has(k)||Lm(k,!1,m),Lm(k,!0,m))});var y=m.nodeType===9?m:m.ownerDocument;y===null||y[tf]||(y[tf]=!0,Lm("selectionchange",!1,y))}}function $y(m,y,k,R){switch(uv(y)){case 2:var X=j8;break;case 8:X=S8;break;default:X=Km}k=X.bind(null,y,k,m),X=void 0,!nh||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(X=!0),R?X!==void 0?m.addEventListener(y,k,{capture:!0,passive:X}):m.addEventListener(y,k,!0):X!==void 0?m.addEventListener(y,k,{passive:X}):m.addEventListener(y,k,!1)}function Bm(m,y,k,R,X){var J=R;if(!(y&1)&&!(y&2)&&R!==null)e:for(;;){if(R===null)return;var ce=R.tag;if(ce===3||ce===4){var xe=R.stateNode.containerInfo;if(xe===X||xe.nodeType===8&&xe.parentNode===X)break;if(ce===4)for(ce=R.return;ce!==null;){var Ee=ce.tag;if((Ee===3||Ee===4)&&(Ee=ce.stateNode.containerInfo,Ee===X||Ee.nodeType===8&&Ee.parentNode===X))return;ce=ce.return}for(;xe!==null;){if(ce=nt(xe),ce===null)return;if(Ee=ce.tag,Ee===5||Ee===6||Ee===26||Ee===27){R=J=ce;continue e}xe=xe.parentNode}}R=R.return}rb(function(){var Ue=J,at=Ni(k),mt=[];e:{var Xe=Ab.get(m);if(Xe!==void 0){var rt=bd,Rt=m;switch(m){case"keypress":if(gd(k)===0)break e;case"keydown":case"keyup":rt=qN;break;case"focusin":Rt="focus",rt=ch;break;case"focusout":Rt="blur",rt=ch;break;case"beforeblur":case"afterblur":rt=ch;break;case"click":if(k.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=nb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=MN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=WN;break;case kb:case Cb:case Eb:rt=LN;break;case Tb:rt=KN;break;case"scroll":case"scrollend":rt=ON;break;case"wheel":rt=QN;break;case"copy":case"cut":case"paste":rt=BN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=ob;break;case"toggle":case"beforetoggle":rt=ej}var Wt=(y&4)!==0,zr=!Wt&&(m==="scroll"||m==="scrollend"),Ge=Wt?Xe!==null?Xe+"Capture":null:Xe;Wt=[];for(var De=Ue,We;De!==null;){var dt=De;if(We=dt.stateNode,dt=dt.tag,dt!==5&&dt!==26&&dt!==27||We===null||Ge===null||(dt=xc(De,Ge),dt!=null&&Wt.push(Jc(De,dt,We))),zr)break;De=De.return}0<Wt.length&&(Xe=new rt(Xe,Rt,null,k,at),mt.push({event:Xe,listeners:Wt}))}}if(!(y&7)){e:{if(Xe=m==="mouseover"||m==="pointerover",rt=m==="mouseout"||m==="pointerout",Xe&&k!==co&&(Rt=k.relatedTarget||k.fromElement)&&(nt(Rt)||Rt[ye]))break e;if((rt||Xe)&&(Xe=at.window===at?at:(Xe=at.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,rt?(Rt=k.relatedTarget||k.toElement,rt=Ue,Rt=Rt?nt(Rt):null,Rt!==null&&(zr=w(Rt),Wt=Rt.tag,Rt!==zr||Wt!==5&&Wt!==27&&Wt!==6)&&(Rt=null)):(rt=null,Rt=Ue),rt!==Rt)){if(Wt=nb,dt="onMouseLeave",Ge="onMouseEnter",De="mouse",(m==="pointerout"||m==="pointerover")&&(Wt=ob,dt="onPointerLeave",Ge="onPointerEnter",De="pointer"),zr=rt==null?Xe:xt(rt),We=Rt==null?Xe:xt(Rt),Xe=new Wt(dt,De+"leave",rt,k,at),Xe.target=zr,Xe.relatedTarget=We,dt=null,nt(at)===Ue&&(Wt=new Wt(Ge,De+"enter",Rt,k,at),Wt.target=We,Wt.relatedTarget=zr,dt=Wt),zr=dt,rt&&Rt)t:{for(Wt=rt,Ge=Rt,De=0,We=Wt;We;We=Al(We))De++;for(We=0,dt=Ge;dt;dt=Al(dt))We++;for(;0<De-We;)Wt=Al(Wt),De--;for(;0<We-De;)Ge=Al(Ge),We--;for(;De--;){if(Wt===Ge||Ge!==null&&Wt===Ge.alternate)break t;Wt=Al(Wt),Ge=Al(Ge)}Wt=null}else Wt=null;rt!==null&&zy(mt,Xe,rt,Wt,!1),Rt!==null&&zr!==null&&zy(mt,zr,Rt,Wt,!0)}}e:{if(Xe=Ue?xt(Ue):window,rt=Xe.nodeName&&Xe.nodeName.toLowerCase(),rt==="select"||rt==="input"&&Xe.type==="file")var kt=pb;else if(hb(Xe))if(gb)kt=uj;else{kt=lj;var tr=oj}else rt=Xe.nodeName,!rt||rt.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?Ue&&jn(Ue.elementType)&&(kt=pb):kt=cj;if(kt&&(kt=kt(m,Ue))){mb(mt,kt,k,at);break e}tr&&tr(m,Xe,Ue),m==="focusout"&&Ue&&Xe.type==="number"&&Ue.memoizedProps.value!=null&&Ma(Xe,"number",Xe.value)}switch(tr=Ue?xt(Ue):window,m){case"focusin":(hb(tr)||tr.contentEditable==="true")&&(ll=tr,ph=Ue,Sc=null);break;case"focusout":Sc=ph=ll=null;break;case"mousedown":gh=!0;break;case"contextmenu":case"mouseup":case"dragend":gh=!1,jb(mt,k,at);break;case"selectionchange":if(hj)break;case"keydown":case"keyup":jb(mt,k,at)}var It;if(dh)e:{switch(m){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else ol?db(m,k)&&($t="onCompositionEnd"):m==="keydown"&&k.keyCode===229&&($t="onCompositionStart");$t&&(lb&&k.locale!=="ko"&&(ol||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&ol&&(It=sb()):(Si=at,ih="value"in Si?Si.value:Si.textContent,ol=!0)),tr=rf(Ue,$t),0<tr.length&&($t=new ib($t,m,null,k,at),mt.push({event:$t,listeners:tr}),It?$t.data=It:(It=fb(k),It!==null&&($t.data=It)))),(It=rj?sj(m,k):aj(m,k))&&($t=rf(Ue,"onBeforeInput"),0<$t.length&&(tr=new ib("onBeforeInput","beforeinput",null,k,at),mt.push({event:tr,listeners:$t}),tr.data=It)),Xj(mt,m,Ue,k,at)}Uy(mt,y)})}function Jc(m,y,k){return{instance:m,listener:y,currentTarget:k}}function rf(m,y){for(var k=y+"Capture",R=[];m!==null;){var X=m,J=X.stateNode;X=X.tag,X!==5&&X!==26&&X!==27||J===null||(X=xc(m,k),X!=null&&R.unshift(Jc(m,X,J)),X=xc(m,y),X!=null&&R.push(Jc(m,X,J))),m=m.return}return R}function Al(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function zy(m,y,k,R,X){for(var J=y._reactName,ce=[];k!==null&&k!==R;){var xe=k,Ee=xe.alternate,Ue=xe.stateNode;if(xe=xe.tag,Ee!==null&&Ee===R)break;xe!==5&&xe!==26&&xe!==27||Ue===null||(Ee=Ue,X?(Ue=xc(k,J),Ue!=null&&ce.unshift(Jc(k,Ue,Ee))):X||(Ue=xc(k,J),Ue!=null&&ce.push(Jc(k,Ue,Ee)))),k=k.return}ce.length!==0&&m.push({event:y,listeners:ce})}var Jj=/\r\n?/g,e8=/\u0000|\uFFFD/g;function Hy(m){return(typeof m=="string"?m:""+m).replace(Jj,`
`).replace(e8,"")}function Vy(m,y){return y=Hy(y),Hy(m)===y}function sf(){}function kr(m,y,k,R,X,J){switch(k){case"children":typeof R=="string"?y==="body"||y==="textarea"&&R===""||Rs(m,R):(typeof R=="number"||typeof R=="bigint")&&y!=="body"&&Rs(m,""+R);break;case"className":or(m,"class",R);break;case"tabIndex":or(m,"tabindex",R);break;case"dir":case"role":case"viewBox":case"width":case"height":or(m,k,R);break;case"style":lo(m,R,J);break;case"data":if(y!=="object"){or(m,"data",R);break}case"src":case"href":if(R===""&&(y!=="a"||k!=="href")){m.removeAttribute(k);break}if(R==null||typeof R=="function"||typeof R=="symbol"||typeof R=="boolean"){m.removeAttribute(k);break}R=qn(""+R),m.setAttribute(k,R);break;case"action":case"formAction":if(typeof R=="function"){m.setAttribute(k,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof J=="function"&&(k==="formAction"?(y!=="input"&&kr(m,y,"name",X.name,X,null),kr(m,y,"formEncType",X.formEncType,X,null),kr(m,y,"formMethod",X.formMethod,X,null),kr(m,y,"formTarget",X.formTarget,X,null)):(kr(m,y,"encType",X.encType,X,null),kr(m,y,"method",X.method,X,null),kr(m,y,"target",X.target,X,null)));if(R==null||typeof R=="symbol"||typeof R=="boolean"){m.removeAttribute(k);break}R=qn(""+R),m.setAttribute(k,R);break;case"onClick":R!=null&&(m.onclick=sf);break;case"onScroll":R!=null&&lr("scroll",m);break;case"onScrollEnd":R!=null&&lr("scrollend",m);break;case"dangerouslySetInnerHTML":if(R!=null){if(typeof R!="object"||!("__html"in R))throw Error(a(61));if(k=R.__html,k!=null){if(X.children!=null)throw Error(a(60));m.innerHTML=k}}break;case"multiple":m.multiple=R&&typeof R!="function"&&typeof R!="symbol";break;case"muted":m.muted=R&&typeof R!="function"&&typeof R!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(R==null||typeof R=="function"||typeof R=="boolean"||typeof R=="symbol"){m.removeAttribute("xlink:href");break}k=qn(""+R),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",k);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":R!=null&&typeof R!="function"&&typeof R!="symbol"?m.setAttribute(k,""+R):m.removeAttribute(k);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":R&&typeof R!="function"&&typeof R!="symbol"?m.setAttribute(k,""):m.removeAttribute(k);break;case"capture":case"download":R===!0?m.setAttribute(k,""):R!==!1&&R!=null&&typeof R!="function"&&typeof R!="symbol"?m.setAttribute(k,R):m.removeAttribute(k);break;case"cols":case"rows":case"size":case"span":R!=null&&typeof R!="function"&&typeof R!="symbol"&&!isNaN(R)&&1<=R?m.setAttribute(k,R):m.removeAttribute(k);break;case"rowSpan":case"start":R==null||typeof R=="function"||typeof R=="symbol"||isNaN(R)?m.removeAttribute(k):m.setAttribute(k,R);break;case"popover":lr("beforetoggle",m),lr("toggle",m),Gt(m,"popover",R);break;case"xlinkActuate":Jt(m,"http://www.w3.org/1999/xlink","xlink:actuate",R);break;case"xlinkArcrole":Jt(m,"http://www.w3.org/1999/xlink","xlink:arcrole",R);break;case"xlinkRole":Jt(m,"http://www.w3.org/1999/xlink","xlink:role",R);break;case"xlinkShow":Jt(m,"http://www.w3.org/1999/xlink","xlink:show",R);break;case"xlinkTitle":Jt(m,"http://www.w3.org/1999/xlink","xlink:title",R);break;case"xlinkType":Jt(m,"http://www.w3.org/1999/xlink","xlink:type",R);break;case"xmlBase":Jt(m,"http://www.w3.org/XML/1998/namespace","xml:base",R);break;case"xmlLang":Jt(m,"http://www.w3.org/XML/1998/namespace","xml:lang",R);break;case"xmlSpace":Jt(m,"http://www.w3.org/XML/1998/namespace","xml:space",R);break;case"is":Gt(m,"is",R);break;case"innerText":case"textContent":break;default:(!(2<k.length)||k[0]!=="o"&&k[0]!=="O"||k[1]!=="n"&&k[1]!=="N")&&(k=Sn.get(k)||k,Gt(m,k,R))}}function Dm(m,y,k,R,X,J){switch(k){case"style":lo(m,R,J);break;case"dangerouslySetInnerHTML":if(R!=null){if(typeof R!="object"||!("__html"in R))throw Error(a(61));if(k=R.__html,k!=null){if(X.children!=null)throw Error(a(60));m.innerHTML=k}}break;case"children":typeof R=="string"?Rs(m,R):(typeof R=="number"||typeof R=="bigint")&&Rs(m,""+R);break;case"onScroll":R!=null&&lr("scroll",m);break;case"onScrollEnd":R!=null&&lr("scrollend",m);break;case"onClick":R!=null&&(m.onclick=sf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tt.hasOwnProperty(k))e:{if(k[0]==="o"&&k[1]==="n"&&(X=k.endsWith("Capture"),y=k.slice(2,X?k.length-7:void 0),J=m[ge]||null,J=J!=null?J[k]:null,typeof J=="function"&&m.removeEventListener(y,J,X),typeof R=="function")){typeof J!="function"&&J!==null&&(k in m?m[k]=null:m.hasAttribute(k)&&m.removeAttribute(k)),m.addEventListener(y,R,X);break e}k in m?m[k]=R:R===!0?m.setAttribute(k,""):Gt(m,k,R)}}}function Ss(m,y,k){switch(y){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":lr("error",m),lr("load",m);var R=!1,X=!1,J;for(J in k)if(k.hasOwnProperty(J)){var ce=k[J];if(ce!=null)switch(J){case"src":R=!0;break;case"srcSet":X=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,y));default:kr(m,y,J,ce,k,null)}}X&&kr(m,y,"srcSet",k.srcSet,k,null),R&&kr(m,y,"src",k.src,k,null);return;case"input":lr("invalid",m);var xe=J=ce=X=null,Ee=null,Ue=null;for(R in k)if(k.hasOwnProperty(R)){var at=k[R];if(at!=null)switch(R){case"name":X=at;break;case"type":ce=at;break;case"checked":Ee=at;break;case"defaultChecked":Ue=at;break;case"value":J=at;break;case"defaultValue":xe=at;break;case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(a(137,y));break;default:kr(m,y,R,at,k,null)}}rr(m,J,xe,Ee,Ue,ce,X,!1),As(m);return;case"select":lr("invalid",m),R=ce=J=null;for(X in k)if(k.hasOwnProperty(X)&&(xe=k[X],xe!=null))switch(X){case"value":J=xe;break;case"defaultValue":ce=xe;break;case"multiple":R=xe;default:kr(m,y,X,xe,k,null)}y=J,k=ce,m.multiple=!!R,y!=null?aa(m,!!R,y,!1):k!=null&&aa(m,!!R,k,!0);return;case"textarea":lr("invalid",m),J=X=R=null;for(ce in k)if(k.hasOwnProperty(ce)&&(xe=k[ce],xe!=null))switch(ce){case"value":R=xe;break;case"defaultValue":X=xe;break;case"children":J=xe;break;case"dangerouslySetInnerHTML":if(xe!=null)throw Error(a(91));break;default:kr(m,y,ce,xe,k,null)}Os(m,R,X,J),As(m);return;case"option":for(Ee in k)if(k.hasOwnProperty(Ee)&&(R=k[Ee],R!=null))switch(Ee){case"selected":m.selected=R&&typeof R!="function"&&typeof R!="symbol";break;default:kr(m,y,Ee,R,k,null)}return;case"dialog":lr("cancel",m),lr("close",m);break;case"iframe":case"object":lr("load",m);break;case"video":case"audio":for(R=0;R<Qc.length;R++)lr(Qc[R],m);break;case"image":lr("error",m),lr("load",m);break;case"details":lr("toggle",m);break;case"embed":case"source":case"link":lr("error",m),lr("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ue in k)if(k.hasOwnProperty(Ue)&&(R=k[Ue],R!=null))switch(Ue){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,y));default:kr(m,y,Ue,R,k,null)}return;default:if(jn(y)){for(at in k)k.hasOwnProperty(at)&&(R=k[at],R!==void 0&&Dm(m,y,at,R,k,void 0));return}}for(xe in k)k.hasOwnProperty(xe)&&(R=k[xe],R!=null&&kr(m,y,xe,R,k,null))}function t8(m,y,k,R){switch(y){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var X=null,J=null,ce=null,xe=null,Ee=null,Ue=null,at=null;for(rt in k){var mt=k[rt];if(k.hasOwnProperty(rt)&&mt!=null)switch(rt){case"checked":break;case"value":break;case"defaultValue":Ee=mt;default:R.hasOwnProperty(rt)||kr(m,y,rt,null,R,mt)}}for(var Xe in R){var rt=R[Xe];if(mt=k[Xe],R.hasOwnProperty(Xe)&&(rt!=null||mt!=null))switch(Xe){case"type":J=rt;break;case"name":X=rt;break;case"checked":Ue=rt;break;case"defaultChecked":at=rt;break;case"value":ce=rt;break;case"defaultValue":xe=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(a(137,y));break;default:rt!==mt&&kr(m,y,Xe,rt,R,mt)}}ur(m,ce,xe,Ee,Ue,at,J,X);return;case"select":rt=ce=xe=Xe=null;for(J in k)if(Ee=k[J],k.hasOwnProperty(J)&&Ee!=null)switch(J){case"value":break;case"multiple":rt=Ee;default:R.hasOwnProperty(J)||kr(m,y,J,null,R,Ee)}for(X in R)if(J=R[X],Ee=k[X],R.hasOwnProperty(X)&&(J!=null||Ee!=null))switch(X){case"value":Xe=J;break;case"defaultValue":xe=J;break;case"multiple":ce=J;default:J!==Ee&&kr(m,y,X,J,R,Ee)}y=xe,k=ce,R=rt,Xe!=null?aa(m,!!k,Xe,!1):!!R!=!!k&&(y!=null?aa(m,!!k,y,!0):aa(m,!!k,k?[]:"",!1));return;case"textarea":rt=Xe=null;for(xe in k)if(X=k[xe],k.hasOwnProperty(xe)&&X!=null&&!R.hasOwnProperty(xe))switch(xe){case"value":break;case"children":break;default:kr(m,y,xe,null,R,X)}for(ce in R)if(X=R[ce],J=k[ce],R.hasOwnProperty(ce)&&(X!=null||J!=null))switch(ce){case"value":Xe=X;break;case"defaultValue":rt=X;break;case"children":break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(a(91));break;default:X!==J&&kr(m,y,ce,X,R,J)}oo(m,Xe,rt);return;case"option":for(var Rt in k)if(Xe=k[Rt],k.hasOwnProperty(Rt)&&Xe!=null&&!R.hasOwnProperty(Rt))switch(Rt){case"selected":m.selected=!1;break;default:kr(m,y,Rt,null,R,Xe)}for(Ee in R)if(Xe=R[Ee],rt=k[Ee],R.hasOwnProperty(Ee)&&Xe!==rt&&(Xe!=null||rt!=null))switch(Ee){case"selected":m.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:kr(m,y,Ee,Xe,R,rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Wt in k)Xe=k[Wt],k.hasOwnProperty(Wt)&&Xe!=null&&!R.hasOwnProperty(Wt)&&kr(m,y,Wt,null,R,Xe);for(Ue in R)if(Xe=R[Ue],rt=k[Ue],R.hasOwnProperty(Ue)&&Xe!==rt&&(Xe!=null||rt!=null))switch(Ue){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(a(137,y));break;default:kr(m,y,Ue,Xe,R,rt)}return;default:if(jn(y)){for(var zr in k)Xe=k[zr],k.hasOwnProperty(zr)&&Xe!==void 0&&!R.hasOwnProperty(zr)&&Dm(m,y,zr,void 0,R,Xe);for(at in R)Xe=R[at],rt=k[at],!R.hasOwnProperty(at)||Xe===rt||Xe===void 0&&rt===void 0||Dm(m,y,at,Xe,R,rt);return}}for(var Ge in k)Xe=k[Ge],k.hasOwnProperty(Ge)&&Xe!=null&&!R.hasOwnProperty(Ge)&&kr(m,y,Ge,null,R,Xe);for(mt in R)Xe=R[mt],rt=k[mt],!R.hasOwnProperty(mt)||Xe===rt||Xe==null&&rt==null||kr(m,y,mt,Xe,R,rt)}var Um=null,$m=null;function af(m){return m.nodeType===9?m:m.ownerDocument}function qy(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gy(m,y){if(m===0)switch(y){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&y==="foreignObject"?0:m}function zm(m,y){return m==="textarea"||m==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.children=="bigint"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var Hm=null;function r8(){var m=window.event;return m&&m.type==="popstate"?m===Hm?!1:(Hm=m,!0):(Hm=null,!1)}var Yy=typeof setTimeout=="function"?setTimeout:void 0,s8=typeof clearTimeout=="function"?clearTimeout:void 0,Wy=typeof Promise=="function"?Promise:void 0,a8=typeof queueMicrotask=="function"?queueMicrotask:typeof Wy<"u"?function(m){return Wy.resolve(null).then(m).catch(n8)}:Yy;function n8(m){setTimeout(function(){throw m})}function Vm(m,y){var k=y,R=0;do{var X=k.nextSibling;if(m.removeChild(k),X&&X.nodeType===8)if(k=X.data,k==="/$"){if(R===0){m.removeChild(X),ou(y);return}R--}else k!=="$"&&k!=="$?"&&k!=="$!"||R++;k=X}while(k);ou(y)}function qm(m){var y=m.firstChild;for(y&&y.nodeType===10&&(y=y.nextSibling);y;){var k=y;switch(y=y.nextSibling,k.nodeName){case"HTML":case"HEAD":case"BODY":qm(k),ze(k);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(k.rel.toLowerCase()==="stylesheet")continue}m.removeChild(k)}}function i8(m,y,k,R){for(;m.nodeType===1;){var X=k;if(m.nodeName.toLowerCase()!==y.toLowerCase()){if(!R&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(R){if(!m[$e])switch(y){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if(J=m.getAttribute("rel"),J==="stylesheet"&&m.hasAttribute("data-precedence"))break;if(J!==X.rel||m.getAttribute("href")!==(X.href==null?null:X.href)||m.getAttribute("crossorigin")!==(X.crossOrigin==null?null:X.crossOrigin)||m.getAttribute("title")!==(X.title==null?null:X.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if(J=m.getAttribute("src"),(J!==(X.src==null?null:X.src)||m.getAttribute("type")!==(X.type==null?null:X.type)||m.getAttribute("crossorigin")!==(X.crossOrigin==null?null:X.crossOrigin))&&J&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(y==="input"&&m.type==="hidden"){var J=X.name==null?null:""+X.name;if(X.type==="hidden"&&m.getAttribute("name")===J)return m}else return m;if(m=ln(m.nextSibling),m===null)break}return null}function o8(m,y,k){if(y==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!k||(m=ln(m.nextSibling),m===null))return null;return m}function ln(m){for(;m!=null;m=m.nextSibling){var y=m.nodeType;if(y===1||y===3)break;if(y===8){if(y=m.data,y==="$"||y==="$!"||y==="$?"||y==="F!"||y==="F")break;if(y==="/$")return null}}return m}function Xy(m){m=m.previousSibling;for(var y=0;m;){if(m.nodeType===8){var k=m.data;if(k==="$"||k==="$!"||k==="$?"){if(y===0)return m;y--}else k==="/$"&&y++}m=m.previousSibling}return null}function Ky(m,y,k){switch(y=af(k),m){case"html":if(m=y.documentElement,!m)throw Error(a(452));return m;case"head":if(m=y.head,!m)throw Error(a(453));return m;case"body":if(m=y.body,!m)throw Error(a(454));return m;default:throw Error(a(451))}}var Ha=new Map,Zy=new Set;function nf(m){return typeof m.getRootNode=="function"?m.getRootNode():m.ownerDocument}var oi=K.d;K.d={f:l8,r:c8,D:u8,C:d8,L:f8,m:h8,X:p8,S:m8,M:g8};function l8(){var m=oi.f(),y=Zd();return m||y}function c8(m){var y=ht(m);y!==null&&y.tag===5&&y.type==="form"?j1(y):oi.r(m)}var Ol=typeof document>"u"?null:document;function Qy(m,y,k){var R=Ol;if(R&&typeof y=="string"&&y){var X=ls(y);X='link[rel="'+m+'"][href="'+X+'"]',typeof k=="string"&&(X+='[crossorigin="'+k+'"]'),Zy.has(X)||(Zy.add(X),m={rel:m,crossOrigin:k,href:y},R.querySelector(X)===null&&(y=R.createElement("link"),Ss(y,"link",m),Ce(y),R.head.appendChild(y)))}}function u8(m){oi.D(m),Qy("dns-prefetch",m,null)}function d8(m,y){oi.C(m,y),Qy("preconnect",m,y)}function f8(m,y,k){oi.L(m,y,k);var R=Ol;if(R&&m&&y){var X='link[rel="preload"][as="'+ls(y)+'"]';y==="image"&&k&&k.imageSrcSet?(X+='[imagesrcset="'+ls(k.imageSrcSet)+'"]',typeof k.imageSizes=="string"&&(X+='[imagesizes="'+ls(k.imageSizes)+'"]')):X+='[href="'+ls(m)+'"]';var J=X;switch(y){case"style":J=Rl(m);break;case"script":J=Ml(m)}Ha.has(J)||(m=W({rel:"preload",href:y==="image"&&k&&k.imageSrcSet?void 0:m,as:y},k),Ha.set(J,m),R.querySelector(X)!==null||y==="style"&&R.querySelector(eu(J))||y==="script"&&R.querySelector(tu(J))||(y=R.createElement("link"),Ss(y,"link",m),Ce(y),R.head.appendChild(y)))}}function h8(m,y){oi.m(m,y);var k=Ol;if(k&&m){var R=y&&typeof y.as=="string"?y.as:"script",X='link[rel="modulepreload"][as="'+ls(R)+'"][href="'+ls(m)+'"]',J=X;switch(R){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":J=Ml(m)}if(!Ha.has(J)&&(m=W({rel:"modulepreload",href:m},y),Ha.set(J,m),k.querySelector(X)===null)){switch(R){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(k.querySelector(tu(J)))return}R=k.createElement("link"),Ss(R,"link",m),Ce(R),k.head.appendChild(R)}}}function m8(m,y,k){oi.S(m,y,k);var R=Ol;if(R&&m){var X=pe(R).hoistableStyles,J=Rl(m);y=y||"default";var ce=X.get(J);if(!ce){var xe={loading:0,preload:null};if(ce=R.querySelector(eu(J)))xe.loading=5;else{m=W({rel:"stylesheet",href:m,"data-precedence":y},k),(k=Ha.get(J))&&Gm(m,k);var Ee=ce=R.createElement("link");Ce(Ee),Ss(Ee,"link",m),Ee._p=new Promise(function(Ue,at){Ee.onload=Ue,Ee.onerror=at}),Ee.addEventListener("load",function(){xe.loading|=1}),Ee.addEventListener("error",function(){xe.loading|=2}),xe.loading|=4,of(ce,y,R)}ce={type:"stylesheet",instance:ce,count:1,state:xe},X.set(J,ce)}}}function p8(m,y){oi.X(m,y);var k=Ol;if(k&&m){var R=pe(k).hoistableScripts,X=Ml(m),J=R.get(X);J||(J=k.querySelector(tu(X)),J||(m=W({src:m,async:!0},y),(y=Ha.get(X))&&Ym(m,y),J=k.createElement("script"),Ce(J),Ss(J,"link",m),k.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},R.set(X,J))}}function g8(m,y){oi.M(m,y);var k=Ol;if(k&&m){var R=pe(k).hoistableScripts,X=Ml(m),J=R.get(X);J||(J=k.querySelector(tu(X)),J||(m=W({src:m,async:!0,type:"module"},y),(y=Ha.get(X))&&Ym(m,y),J=k.createElement("script"),Ce(J),Ss(J,"link",m),k.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},R.set(X,J))}}function Jy(m,y,k,R){var X=(X=le.current)?nf(X):null;if(!X)throw Error(a(446));switch(m){case"meta":case"title":return null;case"style":return typeof k.precedence=="string"&&typeof k.href=="string"?(y=Rl(k.href),k=pe(X).hoistableStyles,R=k.get(y),R||(R={type:"style",instance:null,count:0,state:null},k.set(y,R)),R):{type:"void",instance:null,count:0,state:null};case"link":if(k.rel==="stylesheet"&&typeof k.href=="string"&&typeof k.precedence=="string"){m=Rl(k.href);var J=pe(X).hoistableStyles,ce=J.get(m);if(ce||(X=X.ownerDocument||X,ce={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},J.set(m,ce),(J=X.querySelector(eu(m)))&&!J._p&&(ce.instance=J,ce.state.loading=5),Ha.has(m)||(k={rel:"preload",as:"style",href:k.href,crossOrigin:k.crossOrigin,integrity:k.integrity,media:k.media,hrefLang:k.hrefLang,referrerPolicy:k.referrerPolicy},Ha.set(m,k),J||x8(X,m,k,ce.state))),y&&R===null)throw Error(a(528,""));return ce}if(y&&R!==null)throw Error(a(529,""));return null;case"script":return y=k.async,k=k.src,typeof k=="string"&&y&&typeof y!="function"&&typeof y!="symbol"?(y=Ml(k),k=pe(X).hoistableScripts,R=k.get(y),R||(R={type:"script",instance:null,count:0,state:null},k.set(y,R)),R):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,m))}}function Rl(m){return'href="'+ls(m)+'"'}function eu(m){return'link[rel="stylesheet"]['+m+"]"}function ev(m){return W({},m,{"data-precedence":m.precedence,precedence:null})}function x8(m,y,k,R){m.querySelector('link[rel="preload"][as="style"]['+y+"]")?R.loading=1:(y=m.createElement("link"),R.preload=y,y.addEventListener("load",function(){return R.loading|=1}),y.addEventListener("error",function(){return R.loading|=2}),Ss(y,"link",k),Ce(y),m.head.appendChild(y))}function Ml(m){return'[src="'+ls(m)+'"]'}function tu(m){return"script[async]"+m}function tv(m,y,k){if(y.count++,y.instance===null)switch(y.type){case"style":var R=m.querySelector('style[data-href~="'+ls(k.href)+'"]');if(R)return y.instance=R,Ce(R),R;var X=W({},k,{"data-href":k.href,"data-precedence":k.precedence,href:null,precedence:null});return R=(m.ownerDocument||m).createElement("style"),Ce(R),Ss(R,"style",X),of(R,k.precedence,m),y.instance=R;case"stylesheet":X=Rl(k.href);var J=m.querySelector(eu(X));if(J)return y.state.loading|=4,y.instance=J,Ce(J),J;R=ev(k),(X=Ha.get(X))&&Gm(R,X),J=(m.ownerDocument||m).createElement("link"),Ce(J);var ce=J;return ce._p=new Promise(function(xe,Ee){ce.onload=xe,ce.onerror=Ee}),Ss(J,"link",R),y.state.loading|=4,of(J,k.precedence,m),y.instance=J;case"script":return J=Ml(k.src),(X=m.querySelector(tu(J)))?(y.instance=X,Ce(X),X):(R=k,(X=Ha.get(J))&&(R=W({},k),Ym(R,X)),m=m.ownerDocument||m,X=m.createElement("script"),Ce(X),Ss(X,"link",R),m.head.appendChild(X),y.instance=X);case"void":return null;default:throw Error(a(443,y.type))}else y.type==="stylesheet"&&!(y.state.loading&4)&&(R=y.instance,y.state.loading|=4,of(R,k.precedence,m));return y.instance}function of(m,y,k){for(var R=k.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),X=R.length?R[R.length-1]:null,J=X,ce=0;ce<R.length;ce++){var xe=R[ce];if(xe.dataset.precedence===y)J=xe;else if(J!==X)break}J?J.parentNode.insertBefore(m,J.nextSibling):(y=k.nodeType===9?k.head:k,y.insertBefore(m,y.firstChild))}function Gm(m,y){m.crossOrigin==null&&(m.crossOrigin=y.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=y.referrerPolicy),m.title==null&&(m.title=y.title)}function Ym(m,y){m.crossOrigin==null&&(m.crossOrigin=y.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=y.referrerPolicy),m.integrity==null&&(m.integrity=y.integrity)}var lf=null;function rv(m,y,k){if(lf===null){var R=new Map,X=lf=new Map;X.set(k,R)}else X=lf,R=X.get(k),R||(R=new Map,X.set(k,R));if(R.has(m))return R;for(R.set(m,null),k=k.getElementsByTagName(m),X=0;X<k.length;X++){var J=k[X];if(!(J[$e]||J[me]||m==="link"&&J.getAttribute("rel")==="stylesheet")&&J.namespaceURI!=="http://www.w3.org/2000/svg"){var ce=J.getAttribute(y)||"";ce=m+ce;var xe=R.get(ce);xe?xe.push(J):R.set(ce,[J])}}return R}function sv(m,y,k){m=m.ownerDocument||m,m.head.insertBefore(k,y==="title"?m.querySelector("head > title"):null)}function b8(m,y,k){if(k===1||y.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof y.precedence!="string"||typeof y.href!="string"||y.href==="")break;return!0;case"link":if(typeof y.rel!="string"||typeof y.href!="string"||y.href===""||y.onLoad||y.onError)break;switch(y.rel){case"stylesheet":return m=y.disabled,typeof y.precedence=="string"&&m==null;default:return!0}case"script":if(y.async&&typeof y.async!="function"&&typeof y.async!="symbol"&&!y.onLoad&&!y.onError&&y.src&&typeof y.src=="string")return!0}return!1}function av(m){return!(m.type==="stylesheet"&&!(m.state.loading&3))}var ru=null;function y8(){}function v8(m,y,k){if(ru===null)throw Error(a(475));var R=ru;if(y.type==="stylesheet"&&(typeof k.media!="string"||matchMedia(k.media).matches!==!1)&&!(y.state.loading&4)){if(y.instance===null){var X=Rl(k.href),J=m.querySelector(eu(X));if(J){m=J._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(R.count++,R=cf.bind(R),m.then(R,R)),y.state.loading|=4,y.instance=J,Ce(J);return}J=m.ownerDocument||m,k=ev(k),(X=Ha.get(X))&&Gm(k,X),J=J.createElement("link"),Ce(J);var ce=J;ce._p=new Promise(function(xe,Ee){ce.onload=xe,ce.onerror=Ee}),Ss(J,"link",k),y.instance=J}R.stylesheets===null&&(R.stylesheets=new Map),R.stylesheets.set(y,m),(m=y.state.preload)&&!(y.state.loading&3)&&(R.count++,y=cf.bind(R),m.addEventListener("load",y),m.addEventListener("error",y))}}function _8(){if(ru===null)throw Error(a(475));var m=ru;return m.stylesheets&&m.count===0&&Wm(m,m.stylesheets),0<m.count?function(y){var k=setTimeout(function(){if(m.stylesheets&&Wm(m,m.stylesheets),m.unsuspend){var R=m.unsuspend;m.unsuspend=null,R()}},6e4);return m.unsuspend=y,function(){m.unsuspend=null,clearTimeout(k)}}:null}function cf(){if(this.count--,this.count===0){if(this.stylesheets)Wm(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var uf=null;function Wm(m,y){m.stylesheets=null,m.unsuspend!==null&&(m.count++,uf=new Map,y.forEach(w8,m),uf=null,cf.call(m))}function w8(m,y){if(!(y.state.loading&4)){var k=uf.get(m);if(k)var R=k.get(null);else{k=new Map,uf.set(m,k);for(var X=m.querySelectorAll("link[data-precedence],style[data-precedence]"),J=0;J<X.length;J++){var ce=X[J];(ce.nodeName==="LINK"||ce.getAttribute("media")!=="not all")&&(k.set(ce.dataset.precedence,ce),R=ce)}R&&k.set(null,R)}X=y.instance,ce=X.getAttribute("data-precedence"),J=k.get(ce)||R,J===R&&k.set(null,X),k.set(ce,X),this.count++,R=cf.bind(this),X.addEventListener("load",R),X.addEventListener("error",R),J?J.parentNode.insertBefore(X,J.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(X,m.firstChild)),y.state.loading|=4}}var su={$$typeof:h,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function N8(m,y,k,R,X,J,ce,xe){this.tag=1,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=St(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=St(0),this.hiddenUpdates=St(null),this.identifierPrefix=R,this.onUncaughtError=X,this.onCaughtError=J,this.onRecoverableError=ce,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=xe,this.incompleteTransitions=new Map}function nv(m,y,k,R,X,J,ce,xe,Ee,Ue,at,mt){return m=new N8(m,y,k,ce,xe,Ee,Ue,mt),y=1,J===!0&&(y|=24),J=$a(3,null,null,y),m.current=J,J.stateNode=m,y=kh(),y.refCount++,m.pooledCache=y,y.refCount++,J.memoizedState={element:R,isDehydrated:k,cache:y},im(J),m}function iv(m){return m?(m=dl,m):dl}function ov(m,y,k,R,X,J){X=iv(X),R.context===null?R.context=X:R.pendingContext=X,R=Mi(y),R.payload={element:k},J=J===void 0?null:J,J!==null&&(R.callback=J),k=Fi(m,R,y),k!==null&&(Xs(k,m,y),Uc(k,m,y))}function lv(m,y){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var k=m.retryLane;m.retryLane=k!==0&&k<y?k:y}}function Xm(m,y){lv(m,y),(m=m.alternate)&&lv(m,y)}function cv(m){if(m.tag===13){var y=ki(m,67108864);y!==null&&Xs(y,m,67108864),Xm(m,67108864)}}var df=!0;function j8(m,y,k,R){var X=U.T;U.T=null;var J=K.p;try{K.p=2,Km(m,y,k,R)}finally{K.p=J,U.T=X}}function S8(m,y,k,R){var X=U.T;U.T=null;var J=K.p;try{K.p=8,Km(m,y,k,R)}finally{K.p=J,U.T=X}}function Km(m,y,k,R){if(df){var X=Zm(R);if(X===null)Bm(m,y,R,ff,k),dv(m,R);else if(C8(X,m,y,k,R))R.stopPropagation();else if(dv(m,R),y&4&&-1<k8.indexOf(m)){for(;X!==null;){var J=ht(X);if(J!==null)switch(J.tag){case 3:if(J=J.stateNode,J.current.memoizedState.isDehydrated){var ce=_t(J.pendingLanes);if(ce!==0){var xe=J;for(xe.pendingLanes|=2,xe.entangledLanes|=2;ce;){var Ee=1<<31-lt(ce);xe.entanglements[1]|=Ee,ce&=~Ee}An(J),!(Br&6)&&(Wd=Pe()+500,Zc(0))}}break;case 13:xe=ki(J,2),xe!==null&&Xs(xe,J,2),Zd(),Xm(J,2)}if(J=Zm(R),J===null&&Bm(m,y,R,ff,k),J===X)break;X=J}X!==null&&R.stopPropagation()}else Bm(m,y,R,null,k)}}function Zm(m){return m=Ni(m),Qm(m)}var ff=null;function Qm(m){if(ff=null,m=nt(m),m!==null){var y=w(m);if(y===null)m=null;else{var k=y.tag;if(k===13){if(m=j(y),m!==null)return m;m=null}else if(k===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;m=null}else y!==m&&(m=null)}}return ff=m,null}function uv(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(He()){case ct:return 2;case ie:return 8;case ee:case te:return 32;case fe:return 268435456;default:return 32}default:return 32}}var Jm=!1,$i=null,zi=null,Hi=null,au=new Map,nu=new Map,Vi=[],k8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dv(m,y){switch(m){case"focusin":case"focusout":$i=null;break;case"dragenter":case"dragleave":zi=null;break;case"mouseover":case"mouseout":Hi=null;break;case"pointerover":case"pointerout":au.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":nu.delete(y.pointerId)}}function iu(m,y,k,R,X,J){return m===null||m.nativeEvent!==J?(m={blockedOn:y,domEventName:k,eventSystemFlags:R,nativeEvent:J,targetContainers:[X]},y!==null&&(y=ht(y),y!==null&&cv(y)),m):(m.eventSystemFlags|=R,y=m.targetContainers,X!==null&&y.indexOf(X)===-1&&y.push(X),m)}function C8(m,y,k,R,X){switch(y){case"focusin":return $i=iu($i,m,y,k,R,X),!0;case"dragenter":return zi=iu(zi,m,y,k,R,X),!0;case"mouseover":return Hi=iu(Hi,m,y,k,R,X),!0;case"pointerover":var J=X.pointerId;return au.set(J,iu(au.get(J)||null,m,y,k,R,X)),!0;case"gotpointercapture":return J=X.pointerId,nu.set(J,iu(nu.get(J)||null,m,y,k,R,X)),!0}return!1}function fv(m){var y=nt(m.target);if(y!==null){var k=w(y);if(k!==null){if(y=k.tag,y===13){if(y=j(k),y!==null){m.blockedOn=y,de(m.priority,function(){if(k.tag===13){var R=_a(),X=ki(k,R);X!==null&&Xs(X,k,R),Xm(k,R)}});return}}else if(y===3&&k.stateNode.current.memoizedState.isDehydrated){m.blockedOn=k.tag===3?k.stateNode.containerInfo:null;return}}}m.blockedOn=null}function hf(m){if(m.blockedOn!==null)return!1;for(var y=m.targetContainers;0<y.length;){var k=Zm(m.nativeEvent);if(k===null){k=m.nativeEvent;var R=new k.constructor(k.type,k);co=R,k.target.dispatchEvent(R),co=null}else return y=ht(k),y!==null&&cv(y),m.blockedOn=k,!1;y.shift()}return!0}function hv(m,y,k){hf(m)&&k.delete(y)}function E8(){Jm=!1,$i!==null&&hf($i)&&($i=null),zi!==null&&hf(zi)&&(zi=null),Hi!==null&&hf(Hi)&&(Hi=null),au.forEach(hv),nu.forEach(hv)}function mf(m,y){m.blockedOn===y&&(m.blockedOn=null,Jm||(Jm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,E8)))}var pf=null;function mv(m){pf!==m&&(pf=m,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){pf===m&&(pf=null);for(var y=0;y<m.length;y+=3){var k=m[y],R=m[y+1],X=m[y+2];if(typeof R!="function"){if(Qm(R||k)===null)continue;break}var J=ht(k);J!==null&&(m.splice(y,3),y-=3,zh(J,{pending:!0,data:X,method:k.method,action:R},R,X))}}))}function ou(m){function y(Ee){return mf(Ee,m)}$i!==null&&mf($i,m),zi!==null&&mf(zi,m),Hi!==null&&mf(Hi,m),au.forEach(y),nu.forEach(y);for(var k=0;k<Vi.length;k++){var R=Vi[k];R.blockedOn===m&&(R.blockedOn=null)}for(;0<Vi.length&&(k=Vi[0],k.blockedOn===null);)fv(k),k.blockedOn===null&&Vi.shift();if(k=(m.ownerDocument||m).$$reactFormReplay,k!=null)for(R=0;R<k.length;R+=3){var X=k[R],J=k[R+1],ce=X[ge]||null;if(typeof J=="function")ce||mv(k);else if(ce){var xe=null;if(J&&J.hasAttribute("formAction")){if(X=J,ce=J[ge]||null)xe=ce.formAction;else if(Qm(X)!==null)continue}else xe=ce.action;typeof xe=="function"?k[R+1]=xe:(k.splice(R,3),R-=3),mv(k)}}}function ep(m){this._internalRoot=m}gf.prototype.render=ep.prototype.render=function(m){var y=this._internalRoot;if(y===null)throw Error(a(409));var k=y.current,R=_a();ov(k,R,m,y,null,null)},gf.prototype.unmount=ep.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var y=m.containerInfo;m.tag===0&&El(),ov(m.current,2,null,m,null,null),Zd(),y[ye]=null}};function gf(m){this._internalRoot=m}gf.prototype.unstable_scheduleHydration=function(m){if(m){var y=Qe();m={blockedOn:null,target:m,priority:y};for(var k=0;k<Vi.length&&y!==0&&y<Vi[k].priority;k++);Vi.splice(k,0,m),k===0&&fv(m)}};var pv=s.version;if(pv!=="19.0.0")throw Error(a(527,pv,"19.0.0"));K.findDOMNode=function(m){var y=m._reactInternals;if(y===void 0)throw typeof m.render=="function"?Error(a(188)):(m=Object.keys(m).join(","),Error(a(268,m)));return m=L(y),m=m!==null?I(m):null,m=m===null?null:m.stateNode,m};var T8={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:U,findFiberByHostInstance:nt,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xf.isDisabled&&xf.supportsFiber)try{Ae=xf.inject(T8),Fe=xf}catch{}}return uu.createRoot=function(m,y){if(!n(m))throw Error(a(299));var k=!1,R="",X=R1,J=M1,ce=F1,xe=null;return y!=null&&(y.unstable_strictMode===!0&&(k=!0),y.identifierPrefix!==void 0&&(R=y.identifierPrefix),y.onUncaughtError!==void 0&&(X=y.onUncaughtError),y.onCaughtError!==void 0&&(J=y.onCaughtError),y.onRecoverableError!==void 0&&(ce=y.onRecoverableError),y.unstable_transitionCallbacks!==void 0&&(xe=y.unstable_transitionCallbacks)),y=nv(m,1,!1,null,null,k,R,X,J,ce,xe,null),m[ye]=y.current,Pm(m.nodeType===8?m.parentNode:m),new ep(y)},uu.hydrateRoot=function(m,y,k){if(!n(m))throw Error(a(299));var R=!1,X="",J=R1,ce=M1,xe=F1,Ee=null,Ue=null;return k!=null&&(k.unstable_strictMode===!0&&(R=!0),k.identifierPrefix!==void 0&&(X=k.identifierPrefix),k.onUncaughtError!==void 0&&(J=k.onUncaughtError),k.onCaughtError!==void 0&&(ce=k.onCaughtError),k.onRecoverableError!==void 0&&(xe=k.onRecoverableError),k.unstable_transitionCallbacks!==void 0&&(Ee=k.unstable_transitionCallbacks),k.formState!==void 0&&(Ue=k.formState)),y=nv(m,1,!0,y,k??null,R,X,J,ce,xe,Ee,Ue),y.context=iv(null),k=y.current,R=_a(),X=Mi(R),X.callback=null,Fi(k,X,R),y.current.lanes=R,et(y,R),An(y),m[ye]=y.current,Pm(m),new gf(y)},uu.version="19.0.0",uu}var Tv;function V8(){if(Tv)return ap.exports;Tv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),ap.exports=H8(),ap.exports}var q8=V8(),du={},Av;function G8(){if(Av)return du;Av=1,Object.defineProperty(du,"__esModule",{value:!0}),du.parse=c,du.serialize=o;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,s=/^[\u0021-\u003A\u003C-\u007E]*$/,e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,i=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function c(p,h){const f=new i,x=p.length;if(x<2)return f;const b=(h==null?void 0:h.decode)||d;let v=0;do{const _=p.indexOf("=",v);if(_===-1)break;const N=p.indexOf(";",v),E=N===-1?x:N;if(_>E){v=p.lastIndexOf(";",_-1)+1;continue}const O=l(p,v,_),F=u(p,_,O),z=p.slice(O,F);if(f[z]===void 0){let P=l(p,_+1,E),U=u(p,E,P);const W=b(p.slice(P,U));f[z]=W}v=E+1}while(v<x);return f}function l(p,h,f){do{const x=p.charCodeAt(h);if(x!==32&&x!==9)return h}while(++h<f);return f}function u(p,h,f){for(;h>f;){const x=p.charCodeAt(--h);if(x!==32&&x!==9)return h+1}return f}function o(p,h,f){const x=(f==null?void 0:f.encode)||encodeURIComponent;if(!t.test(p))throw new TypeError(`argument name is invalid: ${p}`);const b=x(h);if(!s.test(b))throw new TypeError(`argument val is invalid: ${h}`);let v=p+"="+b;if(!f)return v;if(f.maxAge!==void 0){if(!Number.isInteger(f.maxAge))throw new TypeError(`option maxAge is invalid: ${f.maxAge}`);v+="; Max-Age="+f.maxAge}if(f.domain){if(!e.test(f.domain))throw new TypeError(`option domain is invalid: ${f.domain}`);v+="; Domain="+f.domain}if(f.path){if(!a.test(f.path))throw new TypeError(`option path is invalid: ${f.path}`);v+="; Path="+f.path}if(f.expires){if(!g(f.expires)||!Number.isFinite(f.expires.valueOf()))throw new TypeError(`option expires is invalid: ${f.expires}`);v+="; Expires="+f.expires.toUTCString()}if(f.httpOnly&&(v+="; HttpOnly"),f.secure&&(v+="; Secure"),f.partitioned&&(v+="; Partitioned"),f.priority)switch(typeof f.priority=="string"?f.priority.toLowerCase():void 0){case"low":v+="; Priority=Low";break;case"medium":v+="; Priority=Medium";break;case"high":v+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${f.priority}`)}if(f.sameSite)switch(typeof f.sameSite=="string"?f.sameSite.toLowerCase():f.sameSite){case!0:case"strict":v+="; SameSite=Strict";break;case"lax":v+="; SameSite=Lax";break;case"none":v+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${f.sameSite}`)}return v}function d(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function g(p){return n.call(p)==="[object Date]"}return du}G8();/**
 * react-router v7.2.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ov="popstate";function Y8(t={}){function s(a,n){let{pathname:i,search:c,hash:l}=a.location;return zp("",{pathname:i,search:c,hash:l},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function e(a,n){return typeof n=="string"?n:Mu(n)}return X8(s,e,null,t)}function Ir(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function pn(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function W8(){return Math.random().toString(36).substring(2,10)}function Rv(t,s){return{usr:t.state,key:t.key,idx:s}}function zp(t,s,e=null,a){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof s=="string"?rc(s):s,state:e,key:s&&s.key||a||W8()}}function Mu({pathname:t="/",search:s="",hash:e=""}){return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),e&&e!=="#"&&(t+=e.charAt(0)==="#"?e:"#"+e),t}function rc(t){let s={};if(t){let e=t.indexOf("#");e>=0&&(s.hash=t.substring(e),t=t.substring(0,e));let a=t.indexOf("?");a>=0&&(s.search=t.substring(a),t=t.substring(0,a)),t&&(s.pathname=t)}return s}function X8(t,s,e,a={}){let{window:n=document.defaultView,v5Compat:i=!1}=a,c=n.history,l="POP",u=null,o=d();o==null&&(o=0,c.replaceState({...c.state,idx:o},""));function d(){return(c.state||{idx:null}).idx}function g(){l="POP";let b=d(),v=b==null?null:b-o;o=b,u&&u({action:l,location:x.location,delta:v})}function p(b,v){l="PUSH";let _=zp(x.location,b,v);o=d()+1;let N=Rv(_,o),E=x.createHref(_);try{c.pushState(N,"",E)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;n.location.assign(E)}i&&u&&u({action:l,location:x.location,delta:1})}function h(b,v){l="REPLACE";let _=zp(x.location,b,v);o=d();let N=Rv(_,o),E=x.createHref(_);c.replaceState(N,"",E),i&&u&&u({action:l,location:x.location,delta:0})}function f(b){let v=n.location.origin!=="null"?n.location.origin:n.location.href,_=typeof b=="string"?b:Mu(b);return _=_.replace(/ $/,"%20"),Ir(v,`No window.location.(origin|href) available to create URL for href: ${_}`),new URL(_,v)}let x={get action(){return l},get location(){return t(n,c)},listen(b){if(u)throw new Error("A history only accepts one active listener");return n.addEventListener(Ov,g),u=b,()=>{n.removeEventListener(Ov,g),u=null}},createHref(b){return s(n,b)},createURL:f,encodeLocation(b){let v=f(b);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:h,go(b){return c.go(b)}};return x}function fw(t,s,e="/"){return K8(t,s,e,!1)}function K8(t,s,e,a){let n=typeof s=="string"?rc(s):s,i=Ji(n.pathname||"/",e);if(i==null)return null;let c=hw(t);Z8(c);let l=null;for(let u=0;l==null&&u<c.length;++u){let o=lS(i);l=iS(c[u],o,a)}return l}function hw(t,s=[],e=[],a=""){let n=(i,c,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:c,route:i};u.relativePath.startsWith("/")&&(Ir(u.relativePath.startsWith(a),`Absolute route path "${u.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(a.length));let o=ci([a,u.relativePath]),d=e.concat(u);i.children&&i.children.length>0&&(Ir(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${o}".`),hw(i.children,s,d,o)),!(i.path==null&&!i.index)&&s.push({path:o,score:aS(o,i.index),routesMeta:d})};return t.forEach((i,c)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))n(i,c);else for(let u of mw(i.path))n(i,c,u)}),s}function mw(t){let s=t.split("/");if(s.length===0)return[];let[e,...a]=s,n=e.endsWith("?"),i=e.replace(/\?$/,"");if(a.length===0)return n?[i,""]:[i];let c=mw(a.join("/")),l=[];return l.push(...c.map(u=>u===""?i:[i,u].join("/"))),n&&l.push(...c),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function Z8(t){t.sort((s,e)=>s.score!==e.score?e.score-s.score:nS(s.routesMeta.map(a=>a.childrenIndex),e.routesMeta.map(a=>a.childrenIndex)))}var Q8=/^:[\w-]+$/,J8=3,eS=2,tS=1,rS=10,sS=-2,Mv=t=>t==="*";function aS(t,s){let e=t.split("/"),a=e.length;return e.some(Mv)&&(a+=sS),s&&(a+=eS),e.filter(n=>!Mv(n)).reduce((n,i)=>n+(Q8.test(i)?J8:i===""?tS:rS),a)}function nS(t,s){return t.length===s.length&&t.slice(0,-1).every((a,n)=>a===s[n])?t[t.length-1]-s[s.length-1]:0}function iS(t,s,e=!1){let{routesMeta:a}=t,n={},i="/",c=[];for(let l=0;l<a.length;++l){let u=a[l],o=l===a.length-1,d=i==="/"?s:s.slice(i.length)||"/",g=Zf({path:u.relativePath,caseSensitive:u.caseSensitive,end:o},d),p=u.route;if(!g&&o&&e&&!a[a.length-1].route.index&&(g=Zf({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!g)return null;Object.assign(n,g.params),c.push({params:n,pathname:ci([i,g.pathname]),pathnameBase:fS(ci([i,g.pathnameBase])),route:p}),g.pathnameBase!=="/"&&(i=ci([i,g.pathnameBase]))}return c}function Zf(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[e,a]=oS(t.path,t.caseSensitive,t.end),n=s.match(e);if(!n)return null;let i=n[0],c=i.replace(/(.)\/+$/,"$1"),l=n.slice(1);return{params:a.reduce((o,{paramName:d,isOptional:g},p)=>{if(d==="*"){let f=l[p]||"";c=i.slice(0,i.length-f.length).replace(/(.)\/+$/,"$1")}const h=l[p];return g&&!h?o[d]=void 0:o[d]=(h||"").replace(/%2F/g,"/"),o},{}),pathname:i,pathnameBase:c,pattern:t}}function oS(t,s=!1,e=!0){pn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let a=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,l,u)=>(a.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(a.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,s?void 0:"i"),a]}function lS(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return pn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${s}).`),t}}function Ji(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let e=s.endsWith("/")?s.length-1:s.length,a=t.charAt(e);return a&&a!=="/"?null:t.slice(e)||"/"}function cS(t,s="/"){let{pathname:e,search:a="",hash:n=""}=typeof t=="string"?rc(t):t;return{pathname:e?e.startsWith("/")?e:uS(e,s):s,search:hS(a),hash:mS(n)}}function uS(t,s){let e=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?e.length>1&&e.pop():n!=="."&&e.push(n)}),e.length>1?e.join("/"):"/"}function lp(t,s,e,a){return`Cannot include a '${t}' character in a manually specified \`to.${s}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function dS(t){return t.filter((s,e)=>e===0||s.route.path&&s.route.path.length>0)}function Ag(t){let s=dS(t);return s.map((e,a)=>a===s.length-1?e.pathname:e.pathnameBase)}function Og(t,s,e,a=!1){let n;typeof t=="string"?n=rc(t):(n={...t},Ir(!n.pathname||!n.pathname.includes("?"),lp("?","pathname","search",n)),Ir(!n.pathname||!n.pathname.includes("#"),lp("#","pathname","hash",n)),Ir(!n.search||!n.search.includes("#"),lp("#","search","hash",n)));let i=t===""||n.pathname==="",c=i?"/":n.pathname,l;if(c==null)l=e;else{let g=s.length-1;if(!a&&c.startsWith("..")){let p=c.split("/");for(;p[0]==="..";)p.shift(),g-=1;n.pathname=p.join("/")}l=g>=0?s[g]:"/"}let u=cS(n,l),o=c&&c!=="/"&&c.endsWith("/"),d=(i||c===".")&&e.endsWith("/");return!u.pathname.endsWith("/")&&(o||d)&&(u.pathname+="/"),u}var ci=t=>t.join("/").replace(/\/\/+/g,"/"),fS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),hS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,mS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function pS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var pw=["POST","PUT","PATCH","DELETE"];new Set(pw);var gS=["GET",...pw];new Set(gS);var sc=ne.createContext(null);sc.displayName="DataRouter";var F0=ne.createContext(null);F0.displayName="DataRouterState";var gw=ne.createContext({isTransitioning:!1});gw.displayName="ViewTransition";var xS=ne.createContext(new Map);xS.displayName="Fetchers";var bS=ne.createContext(null);bS.displayName="Await";var gn=ne.createContext(null);gn.displayName="Navigation";var Wu=ne.createContext(null);Wu.displayName="Location";var en=ne.createContext({outlet:null,matches:[],isDataRoute:!1});en.displayName="Route";var Rg=ne.createContext(null);Rg.displayName="RouteError";function yS(t,{relative:s}={}){Ir(ac(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:a}=ne.useContext(gn),{hash:n,pathname:i,search:c}=Xu(t,{relative:s}),l=i;return e!=="/"&&(l=i==="/"?e:ci([e,i])),a.createHref({pathname:l,search:c,hash:n})}function ac(){return ne.useContext(Wu)!=null}function qs(){return Ir(ac(),"useLocation() may be used only in the context of a <Router> component."),ne.useContext(Wu).location}var xw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function bw(t){ne.useContext(gn).static||ne.useLayoutEffect(t)}function Aa(){let{isDataRoute:t}=ne.useContext(en);return t?FS():vS()}function vS(){Ir(ac(),"useNavigate() may be used only in the context of a <Router> component.");let t=ne.useContext(sc),{basename:s,navigator:e}=ne.useContext(gn),{matches:a}=ne.useContext(en),{pathname:n}=qs(),i=JSON.stringify(Ag(a)),c=ne.useRef(!1);return bw(()=>{c.current=!0}),ne.useCallback((u,o={})=>{if(pn(c.current,xw),!c.current)return;if(typeof u=="number"){e.go(u);return}let d=Og(u,JSON.parse(i),n,o.relative==="path");t==null&&s!=="/"&&(d.pathname=d.pathname==="/"?s:ci([s,d.pathname])),(o.replace?e.replace:e.push)(d,o.state,o)},[s,e,i,n,t])}var _S=ne.createContext(null);function wS(t){let s=ne.useContext(en).outlet;return s&&ne.createElement(_S.Provider,{value:t},s)}function Ko(){let{matches:t}=ne.useContext(en),s=t[t.length-1];return s?s.params:{}}function Xu(t,{relative:s}={}){let{matches:e}=ne.useContext(en),{pathname:a}=qs(),n=JSON.stringify(Ag(e));return ne.useMemo(()=>Og(t,JSON.parse(n),a,s==="path"),[t,n,a,s])}function NS(t,s){return yw(t,s)}function yw(t,s,e,a){var _;Ir(ac(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n,static:i}=ne.useContext(gn),{matches:c}=ne.useContext(en),l=c[c.length-1],u=l?l.params:{},o=l?l.pathname:"/",d=l?l.pathnameBase:"/",g=l&&l.route;{let N=g&&g.path||"";vw(o,!g||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${o}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let p=qs(),h;if(s){let N=typeof s=="string"?rc(s):s;Ir(d==="/"||((_=N.pathname)==null?void 0:_.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${N.pathname}" was given in the \`location\` prop.`),h=N}else h=p;let f=h.pathname||"/",x=f;if(d!=="/"){let N=d.replace(/^\//,"").split("/");x="/"+f.replace(/^\//,"").split("/").slice(N.length).join("/")}let b=!i&&e&&e.matches&&e.matches.length>0?e.matches:fw(t,{pathname:x});pn(g||b!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),pn(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=ES(b&&b.map(N=>Object.assign({},N,{params:Object.assign({},u,N.params),pathname:ci([d,n.encodeLocation?n.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?d:ci([d,n.encodeLocation?n.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),c,e,a);return s&&v?ne.createElement(Wu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},v):v}function jS(){let t=MS(),s=pS(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),e=t instanceof Error?t.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},i={padding:"2px 4px",backgroundColor:a},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=ne.createElement(ne.Fragment,null,ne.createElement("p",null," Hey developer "),ne.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ne.createElement("code",{style:i},"ErrorBoundary")," or"," ",ne.createElement("code",{style:i},"errorElement")," prop on your route.")),ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},s),e?ne.createElement("pre",{style:n},e):null,c)}var SS=ne.createElement(jS,null),kS=class extends ne.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){console.error("React Router caught the following error during render",t,s)}render(){return this.state.error!==void 0?ne.createElement(en.Provider,{value:this.props.routeContext},ne.createElement(Rg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function CS({routeContext:t,match:s,children:e}){let a=ne.useContext(sc);return a&&a.static&&a.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=s.route.id),ne.createElement(en.Provider,{value:t},e)}function ES(t,s=[],e=null,a=null){if(t==null){if(!e)return null;if(e.errors)t=e.matches;else if(s.length===0&&!e.initialized&&e.matches.length>0)t=e.matches;else return null}let n=t,i=e==null?void 0:e.errors;if(i!=null){let u=n.findIndex(o=>o.route.id&&(i==null?void 0:i[o.route.id])!==void 0);Ir(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),n=n.slice(0,Math.min(n.length,u+1))}let c=!1,l=-1;if(e)for(let u=0;u<n.length;u++){let o=n[u];if((o.route.HydrateFallback||o.route.hydrateFallbackElement)&&(l=u),o.route.id){let{loaderData:d,errors:g}=e,p=o.route.loader&&!d.hasOwnProperty(o.route.id)&&(!g||g[o.route.id]===void 0);if(o.route.lazy||p){c=!0,l>=0?n=n.slice(0,l+1):n=[n[0]];break}}}return n.reduceRight((u,o,d)=>{let g,p=!1,h=null,f=null;e&&(g=i&&o.route.id?i[o.route.id]:void 0,h=o.route.errorElement||SS,c&&(l<0&&d===0?(vw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,f=null):l===d&&(p=!0,f=o.route.hydrateFallbackElement||null)));let x=s.concat(n.slice(0,d+1)),b=()=>{let v;return g?v=h:p?v=f:o.route.Component?v=ne.createElement(o.route.Component,null):o.route.element?v=o.route.element:v=u,ne.createElement(CS,{match:o,routeContext:{outlet:u,matches:x,isDataRoute:e!=null},children:v})};return e&&(o.route.ErrorBoundary||o.route.errorElement||d===0)?ne.createElement(kS,{location:e.location,revalidation:e.revalidation,component:h,error:g,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}function Mg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function TS(t){let s=ne.useContext(sc);return Ir(s,Mg(t)),s}function AS(t){let s=ne.useContext(F0);return Ir(s,Mg(t)),s}function OS(t){let s=ne.useContext(en);return Ir(s,Mg(t)),s}function Fg(t){let s=OS(t),e=s.matches[s.matches.length-1];return Ir(e.route.id,`${t} can only be used on routes that contain a unique "id"`),e.route.id}function RS(){return Fg("useRouteId")}function MS(){var a;let t=ne.useContext(Rg),s=AS("useRouteError"),e=Fg("useRouteError");return t!==void 0?t:(a=s.errors)==null?void 0:a[e]}function FS(){let{router:t}=TS("useNavigate"),s=Fg("useNavigate"),e=ne.useRef(!1);return bw(()=>{e.current=!0}),ne.useCallback(async(n,i={})=>{pn(e.current,xw),e.current&&(typeof n=="number"?t.navigate(n):await t.navigate(n,{fromRouteId:s,...i}))},[t,s])}var Fv={};function vw(t,s,e){!s&&!Fv[t]&&(Fv[t]=!0,pn(!1,e))}ne.memo(IS);function IS({routes:t,future:s,state:e}){return yw(t,void 0,e,s)}function Hp({to:t,replace:s,state:e,relative:a}){Ir(ac(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=ne.useContext(gn);pn(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=ne.useContext(en),{pathname:c}=qs(),l=Aa(),u=Og(t,Ag(i),c,a==="path"),o=JSON.stringify(u);return ne.useEffect(()=>{l(JSON.parse(o),{replace:s,state:e,relative:a})},[l,o,a,s,e]),null}function _w(t){return wS(t.context)}function Mr(t){Ir(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function LS({basename:t="/",children:s=null,location:e,navigationType:a="POP",navigator:n,static:i=!1}){Ir(!ac(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),l=ne.useMemo(()=>({basename:c,navigator:n,static:i,future:{}}),[c,n,i]);typeof e=="string"&&(e=rc(e));let{pathname:u="/",search:o="",hash:d="",state:g=null,key:p="default"}=e,h=ne.useMemo(()=>{let f=Ji(u,c);return f==null?null:{location:{pathname:f,search:o,hash:d,state:g,key:p},navigationType:a}},[c,u,o,d,g,p,a]);return pn(h!=null,`<Router basename="${c}"> is not able to match the URL "${u}${o}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:ne.createElement(gn.Provider,{value:l},ne.createElement(Wu.Provider,{children:s,value:h}))}function PS({children:t,location:s}){return NS(Vp(t),s)}function Vp(t,s=[]){let e=[];return ne.Children.forEach(t,(a,n)=>{if(!ne.isValidElement(a))return;let i=[...s,n];if(a.type===ne.Fragment){e.push.apply(e,Vp(a.props.children,i));return}Ir(a.type===Mr,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ir(!a.props.index||!a.props.children,"An index route cannot have child routes.");let c={id:a.props.id||i.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(c.children=Vp(a.props.children,i)),e.push(c)}),e}var Bf="get",Df="application/x-www-form-urlencoded";function I0(t){return t!=null&&typeof t.tagName=="string"}function BS(t){return I0(t)&&t.tagName.toLowerCase()==="button"}function DS(t){return I0(t)&&t.tagName.toLowerCase()==="form"}function US(t){return I0(t)&&t.tagName.toLowerCase()==="input"}function $S(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function zS(t,s){return t.button===0&&(!s||s==="_self")&&!$S(t)}var yf=null;function HS(){if(yf===null)try{new FormData(document.createElement("form"),0),yf=!1}catch{yf=!0}return yf}var VS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function cp(t){return t!=null&&!VS.has(t)?(pn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Df}"`),null):t}function qS(t,s){let e,a,n,i,c;if(DS(t)){let l=t.getAttribute("action");a=l?Ji(l,s):null,e=t.getAttribute("method")||Bf,n=cp(t.getAttribute("enctype"))||Df,i=new FormData(t)}else if(BS(t)||US(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||l.getAttribute("action");if(a=u?Ji(u,s):null,e=t.getAttribute("formmethod")||l.getAttribute("method")||Bf,n=cp(t.getAttribute("formenctype"))||cp(l.getAttribute("enctype"))||Df,i=new FormData(l,t),!HS()){let{name:o,type:d,value:g}=t;if(d==="image"){let p=o?`${o}.`:"";i.append(`${p}x`,"0"),i.append(`${p}y`,"0")}else o&&i.append(o,g)}}else{if(I0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Bf,a=null,n=Df,c=t}return i&&n==="text/plain"&&(c=i,i=void 0),{action:a,method:e.toLowerCase(),encType:n,formData:i,body:c}}function Ig(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}async function GS(t,s){if(t.id in s)return s[t.id];try{let e=await import(t.module);return s[t.id]=e,e}catch(e){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YS(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function WS(t,s,e){let a=await Promise.all(t.map(async n=>{let i=s.routes[n.route.id];if(i){let c=await GS(i,e);return c.links?c.links():[]}return[]}));return QS(a.flat(1).filter(YS).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function Iv(t,s,e,a,n,i){let c=(u,o)=>e[o]?u.route.id!==e[o].route.id:!0,l=(u,o)=>{var d;return e[o].pathname!==u.pathname||((d=e[o].route.path)==null?void 0:d.endsWith("*"))&&e[o].params["*"]!==u.params["*"]};return i==="assets"?s.filter((u,o)=>c(u,o)||l(u,o)):i==="data"?s.filter((u,o)=>{var g;let d=a.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(c(u,o)||l(u,o))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((g=e[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function XS(t,s,{includeHydrateFallback:e}={}){return KS(t.map(a=>{let n=s.routes[a.route.id];if(!n)return[];let i=[n.module];return n.clientActionModule&&(i=i.concat(n.clientActionModule)),n.clientLoaderModule&&(i=i.concat(n.clientLoaderModule)),e&&n.hydrateFallbackModule&&(i=i.concat(n.hydrateFallbackModule)),n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function KS(t){return[...new Set(t)]}function ZS(t){let s={},e=Object.keys(t).sort();for(let a of e)s[a]=t[a];return s}function QS(t,s){let e=new Set;return new Set(s),t.reduce((a,n)=>{let i=JSON.stringify(ZS(n));return e.has(i)||(e.add(i),a.push({key:i,link:n})),a},[])}function JS(t){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s.pathname==="/"?s.pathname="_root.data":s.pathname=`${s.pathname.replace(/\/$/,"")}.data`,s}function ek(){let t=ne.useContext(sc);return Ig(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function tk(){let t=ne.useContext(F0);return Ig(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Lg=ne.createContext(void 0);Lg.displayName="FrameworkContext";function ww(){let t=ne.useContext(Lg);return Ig(t,"You must render this element inside a <HydratedRouter> element"),t}function rk(t,s){let e=ne.useContext(Lg),[a,n]=ne.useState(!1),[i,c]=ne.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:o,onMouseLeave:d,onTouchStart:g}=s,p=ne.useRef(null);ne.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let x=v=>{v.forEach(_=>{c(_.isIntersecting)})},b=new IntersectionObserver(x,{threshold:.5});return p.current&&b.observe(p.current),()=>{b.disconnect()}}},[t]),ne.useEffect(()=>{if(a){let x=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(x)}}},[a]);let h=()=>{n(!0)},f=()=>{n(!1),c(!1)};return e?t!=="intent"?[i,p,{}]:[i,p,{onFocus:fu(l,h),onBlur:fu(u,f),onMouseEnter:fu(o,h),onMouseLeave:fu(d,f),onTouchStart:fu(g,h)}]:[!1,p,{}]}function fu(t,s){return e=>{t&&t(e),e.defaultPrevented||s(e)}}function sk({page:t,...s}){let{router:e}=ek(),a=ne.useMemo(()=>fw(e.routes,t,e.basename),[e.routes,t,e.basename]);return a?ne.createElement(nk,{page:t,matches:a,...s}):null}function ak(t){let{manifest:s,routeModules:e}=ww(),[a,n]=ne.useState([]);return ne.useEffect(()=>{let i=!1;return WS(t,s,e).then(c=>{i||n(c)}),()=>{i=!0}},[t,s,e]),a}function nk({page:t,matches:s,...e}){let a=qs(),{manifest:n,routeModules:i}=ww(),{loaderData:c,matches:l}=tk(),u=ne.useMemo(()=>Iv(t,s,l,n,a,"data"),[t,s,l,n,a]),o=ne.useMemo(()=>Iv(t,s,l,n,a,"assets"),[t,s,l,n,a]),d=ne.useMemo(()=>{if(t===a.pathname+a.search+a.hash)return[];let h=new Set,f=!1;if(s.forEach(b=>{var _;let v=n.routes[b.route.id];!v||!v.hasLoader||(!u.some(N=>N.route.id===b.route.id)&&b.route.id in c&&((_=i[b.route.id])!=null&&_.shouldRevalidate)||v.hasClientLoader?f=!0:h.add(b.route.id))}),h.size===0)return[];let x=JS(t);return f&&h.size>0&&x.searchParams.set("_routes",s.filter(b=>h.has(b.route.id)).map(b=>b.route.id).join(",")),[x.pathname+x.search]},[c,a,n,u,s,t,i]),g=ne.useMemo(()=>XS(o,n),[o,n]),p=ak(o);return ne.createElement(ne.Fragment,null,d.map(h=>ne.createElement("link",{key:h,rel:"prefetch",as:"fetch",href:h,...e})),g.map(h=>ne.createElement("link",{key:h,rel:"modulepreload",href:h,...e})),p.map(({key:h,link:f})=>ne.createElement("link",{key:h,...f})))}function ik(...t){return s=>{t.forEach(e=>{typeof e=="function"?e(s):e!=null&&(e.current=s)})}}var Nw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Nw&&(window.__reactRouterVersion="7.2.0")}catch{}function ok({basename:t,children:s,window:e}){let a=ne.useRef();a.current==null&&(a.current=Y8({window:e,v5Compat:!0}));let n=a.current,[i,c]=ne.useState({action:n.action,location:n.location}),l=ne.useCallback(u=>{ne.startTransition(()=>c(u))},[c]);return ne.useLayoutEffect(()=>n.listen(l),[n,l]),ne.createElement(LS,{basename:t,children:s,location:i.location,navigationType:i.action,navigator:n})}var jw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Sw=ne.forwardRef(function({onClick:s,discover:e="render",prefetch:a="none",relative:n,reloadDocument:i,replace:c,state:l,target:u,to:o,preventScrollReset:d,viewTransition:g,...p},h){let{basename:f}=ne.useContext(gn),x=typeof o=="string"&&jw.test(o),b,v=!1;if(typeof o=="string"&&x&&(b=o,Nw))try{let U=new URL(window.location.href),W=o.startsWith("//")?new URL(U.protocol+o):new URL(o),Y=Ji(W.pathname,f);W.origin===U.origin&&Y!=null?o=Y+W.search+W.hash:v=!0}catch{pn(!1,`<Link to="${o}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=yS(o,{relative:n}),[N,E,O]=rk(a,p),F=dk(o,{replace:c,state:l,target:u,preventScrollReset:d,relative:n,viewTransition:g});function z(U){s&&s(U),U.defaultPrevented||F(U)}let P=ne.createElement("a",{...p,...O,href:b||_,onClick:v||i?s:z,ref:ik(h,E),target:u,"data-discover":!x&&e==="render"?"true":void 0});return N&&!x?ne.createElement(ne.Fragment,null,P,ne.createElement(sk,{page:_})):P});Sw.displayName="Link";var lk=ne.forwardRef(function({"aria-current":s="page",caseSensitive:e=!1,className:a="",end:n=!1,style:i,to:c,viewTransition:l,children:u,...o},d){let g=Xu(c,{relative:o.relative}),p=qs(),h=ne.useContext(F0),{navigator:f,basename:x}=ne.useContext(gn),b=h!=null&&gk(g)&&l===!0,v=f.encodeLocation?f.encodeLocation(g).pathname:g.pathname,_=p.pathname,N=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;e||(_=_.toLowerCase(),N=N?N.toLowerCase():null,v=v.toLowerCase()),N&&x&&(N=Ji(N,x)||N);const E=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let O=_===v||!n&&_.startsWith(v)&&_.charAt(E)==="/",F=N!=null&&(N===v||!n&&N.startsWith(v)&&N.charAt(v.length)==="/"),z={isActive:O,isPending:F,isTransitioning:b},P=O?s:void 0,U;typeof a=="function"?U=a(z):U=[a,O?"active":null,F?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let W=typeof i=="function"?i(z):i;return ne.createElement(Sw,{...o,"aria-current":P,className:U,ref:d,style:W,to:c,viewTransition:l},typeof u=="function"?u(z):u)});lk.displayName="NavLink";var ck=ne.forwardRef(({discover:t="render",fetcherKey:s,navigate:e,reloadDocument:a,replace:n,state:i,method:c=Bf,action:l,onSubmit:u,relative:o,preventScrollReset:d,viewTransition:g,...p},h)=>{let f=mk(),x=pk(l,{relative:o}),b=c.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&jw.test(l),_=N=>{if(u&&u(N),N.defaultPrevented)return;N.preventDefault();let E=N.nativeEvent.submitter,O=(E==null?void 0:E.getAttribute("formmethod"))||c;f(E||N.currentTarget,{fetcherKey:s,method:O,navigate:e,replace:n,state:i,relative:o,preventScrollReset:d,viewTransition:g})};return ne.createElement("form",{ref:h,method:b,action:x,onSubmit:a?u:_,...p,"data-discover":!v&&t==="render"?"true":void 0})});ck.displayName="Form";function uk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kw(t){let s=ne.useContext(sc);return Ir(s,uk(t)),s}function dk(t,{target:s,replace:e,state:a,preventScrollReset:n,relative:i,viewTransition:c}={}){let l=Aa(),u=qs(),o=Xu(t,{relative:i});return ne.useCallback(d=>{if(zS(d,s)){d.preventDefault();let g=e!==void 0?e:Mu(u)===Mu(o);l(t,{replace:g,state:a,preventScrollReset:n,relative:i,viewTransition:c})}},[u,l,o,e,a,s,t,n,i,c])}var fk=0,hk=()=>`__${String(++fk)}__`;function mk(){let{router:t}=kw("useSubmit"),{basename:s}=ne.useContext(gn),e=RS();return ne.useCallback(async(a,n={})=>{let{action:i,method:c,encType:l,formData:u,body:o}=qS(a,s);if(n.navigate===!1){let d=n.fetcherKey||hk();await t.fetch(d,e,n.action||i,{preventScrollReset:n.preventScrollReset,formData:u,body:o,formMethod:n.method||c,formEncType:n.encType||l,flushSync:n.flushSync})}else await t.navigate(n.action||i,{preventScrollReset:n.preventScrollReset,formData:u,body:o,formMethod:n.method||c,formEncType:n.encType||l,replace:n.replace,state:n.state,fromRouteId:e,flushSync:n.flushSync,viewTransition:n.viewTransition})},[t,s,e])}function pk(t,{relative:s}={}){let{basename:e}=ne.useContext(gn),a=ne.useContext(en);Ir(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),i={...Xu(t||".",{relative:s})},c=qs();if(t==null){i.search=c.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(d=>d==="")){l.delete("index"),u.filter(g=>g).forEach(g=>l.append("index",g));let d=l.toString();i.search=d?`?${d}`:""}}return(!t||t===".")&&n.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(i.pathname=i.pathname==="/"?e:ci([e,i.pathname])),Mu(i)}function gk(t,s={}){let e=ne.useContext(gw);Ir(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=kw("useViewTransitionState"),n=Xu(t,{relative:s.relative});if(!e.isTransitioning)return!1;let i=Ji(e.currentLocation.pathname,a)||e.currentLocation.pathname,c=Ji(e.nextLocation.pathname,a)||e.nextLocation.pathname;return Zf(n.pathname,c)!=null||Zf(n.pathname,i)!=null}new TextEncoder;var Cw=dw(),up={exports:{}},dp,Lv;function xk(){if(Lv)return dp;Lv=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return dp=t,dp}var fp,Pv;function bk(){if(Pv)return fp;Pv=1;var t=xk();function s(){}function e(){}return e.resetWarningCache=s,fp=function(){function a(c,l,u,o,d,g){if(g!==t){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}a.isRequired=a;function n(){return a}var i={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:n,element:a,elementType:a,instanceOf:n,node:a,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:e,resetWarningCache:s};return i.PropTypes=i,i},fp}var Bv;function yk(){return Bv||(Bv=1,up.exports=bk()()),up.exports}var vk=yk();const B=Eg(vk);function Ew(t,s){return function(){return t.apply(s,arguments)}}const{toString:_k}=Object.prototype,{getPrototypeOf:Pg}=Object,L0=(t=>s=>{const e=_k.call(s);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),xn=t=>(t=t.toLowerCase(),s=>L0(s)===t),P0=t=>s=>typeof s===t,{isArray:nc}=Array,Fu=P0("undefined");function wk(t){return t!==null&&!Fu(t)&&t.constructor!==null&&!Fu(t.constructor)&&Sa(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Tw=xn("ArrayBuffer");function Nk(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&Tw(t.buffer),s}const jk=P0("string"),Sa=P0("function"),Aw=P0("number"),B0=t=>t!==null&&typeof t=="object",Sk=t=>t===!0||t===!1,Uf=t=>{if(L0(t)!=="object")return!1;const s=Pg(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},kk=xn("Date"),Ck=xn("File"),Ek=xn("Blob"),Tk=xn("FileList"),Ak=t=>B0(t)&&Sa(t.pipe),Ok=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||Sa(t.append)&&((s=L0(t))==="formdata"||s==="object"&&Sa(t.toString)&&t.toString()==="[object FormData]"))},Rk=xn("URLSearchParams"),[Mk,Fk,Ik,Lk]=["ReadableStream","Request","Response","Headers"].map(xn),Pk=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ku(t,s,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let a,n;if(typeof t!="object"&&(t=[t]),nc(t))for(a=0,n=t.length;a<n;a++)s.call(null,t[a],a,t);else{const i=e?Object.getOwnPropertyNames(t):Object.keys(t),c=i.length;let l;for(a=0;a<c;a++)l=i[a],s.call(null,t[l],l,t)}}function Ow(t,s){s=s.toLowerCase();const e=Object.keys(t);let a=e.length,n;for(;a-- >0;)if(n=e[a],s===n.toLowerCase())return n;return null}const Mo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Rw=t=>!Fu(t)&&t!==Mo;function qp(){const{caseless:t}=Rw(this)&&this||{},s={},e=(a,n)=>{const i=t&&Ow(s,n)||n;Uf(s[i])&&Uf(a)?s[i]=qp(s[i],a):Uf(a)?s[i]=qp({},a):nc(a)?s[i]=a.slice():s[i]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&Ku(arguments[a],e);return s}const Bk=(t,s,e,{allOwnKeys:a}={})=>(Ku(s,(n,i)=>{e&&Sa(n)?t[i]=Ew(n,e):t[i]=n},{allOwnKeys:a}),t),Dk=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Uk=(t,s,e,a)=>{t.prototype=Object.create(s.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),e&&Object.assign(t.prototype,e)},$k=(t,s,e,a)=>{let n,i,c;const l={};if(s=s||{},t==null)return s;do{for(n=Object.getOwnPropertyNames(t),i=n.length;i-- >0;)c=n[i],(!a||a(c,t,s))&&!l[c]&&(s[c]=t[c],l[c]=!0);t=e!==!1&&Pg(t)}while(t&&(!e||e(t,s))&&t!==Object.prototype);return s},zk=(t,s,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=s.length;const a=t.indexOf(s,e);return a!==-1&&a===e},Hk=t=>{if(!t)return null;if(nc(t))return t;let s=t.length;if(!Aw(s))return null;const e=new Array(s);for(;s-- >0;)e[s]=t[s];return e},Vk=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&Pg(Uint8Array)),qk=(t,s)=>{const a=(t&&t[Symbol.iterator]).call(t);let n;for(;(n=a.next())&&!n.done;){const i=n.value;s.call(t,i[0],i[1])}},Gk=(t,s)=>{let e;const a=[];for(;(e=t.exec(s))!==null;)a.push(e);return a},Yk=xn("HTMLFormElement"),Wk=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,a,n){return a.toUpperCase()+n}),Dv=(({hasOwnProperty:t})=>(s,e)=>t.call(s,e))(Object.prototype),Xk=xn("RegExp"),Mw=(t,s)=>{const e=Object.getOwnPropertyDescriptors(t),a={};Ku(e,(n,i)=>{let c;(c=s(n,i,t))!==!1&&(a[i]=c||n)}),Object.defineProperties(t,a)},Kk=t=>{Mw(t,(s,e)=>{if(Sa(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const a=t[e];if(Sa(a)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},Zk=(t,s)=>{const e={},a=n=>{n.forEach(i=>{e[i]=!0})};return nc(t)?a(t):a(String(t).split(s)),e},Qk=()=>{},Jk=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s,hp="abcdefghijklmnopqrstuvwxyz",Uv="0123456789",Fw={DIGIT:Uv,ALPHA:hp,ALPHA_DIGIT:hp+hp.toUpperCase()+Uv},e7=(t=16,s=Fw.ALPHA_DIGIT)=>{let e="";const{length:a}=s;for(;t--;)e+=s[Math.random()*a|0];return e};function t7(t){return!!(t&&Sa(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const r7=t=>{const s=new Array(10),e=(a,n)=>{if(B0(a)){if(s.indexOf(a)>=0)return;if(!("toJSON"in a)){s[n]=a;const i=nc(a)?[]:{};return Ku(a,(c,l)=>{const u=e(c,n+1);!Fu(u)&&(i[l]=u)}),s[n]=void 0,i}}return a};return e(t,0)},s7=xn("AsyncFunction"),a7=t=>t&&(B0(t)||Sa(t))&&Sa(t.then)&&Sa(t.catch),Iw=((t,s)=>t?setImmediate:s?((e,a)=>(Mo.addEventListener("message",({source:n,data:i})=>{n===Mo&&i===e&&a.length&&a.shift()()},!1),n=>{a.push(n),Mo.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",Sa(Mo.postMessage)),n7=typeof queueMicrotask<"u"?queueMicrotask.bind(Mo):typeof process<"u"&&process.nextTick||Iw,Ze={isArray:nc,isArrayBuffer:Tw,isBuffer:wk,isFormData:Ok,isArrayBufferView:Nk,isString:jk,isNumber:Aw,isBoolean:Sk,isObject:B0,isPlainObject:Uf,isReadableStream:Mk,isRequest:Fk,isResponse:Ik,isHeaders:Lk,isUndefined:Fu,isDate:kk,isFile:Ck,isBlob:Ek,isRegExp:Xk,isFunction:Sa,isStream:Ak,isURLSearchParams:Rk,isTypedArray:Vk,isFileList:Tk,forEach:Ku,merge:qp,extend:Bk,trim:Pk,stripBOM:Dk,inherits:Uk,toFlatObject:$k,kindOf:L0,kindOfTest:xn,endsWith:zk,toArray:Hk,forEachEntry:qk,matchAll:Gk,isHTMLForm:Yk,hasOwnProperty:Dv,hasOwnProp:Dv,reduceDescriptors:Mw,freezeMethods:Kk,toObjectSet:Zk,toCamelCase:Wk,noop:Qk,toFiniteNumber:Jk,findKey:Ow,global:Mo,isContextDefined:Rw,ALPHABET:Fw,generateString:e7,isSpecCompliantForm:t7,toJSONObject:r7,isAsyncFn:s7,isThenable:a7,setImmediate:Iw,asap:n7};function Zt(t,s,e,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),e&&(this.config=e),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}Ze.inherits(Zt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ze.toJSONObject(this.config),code:this.code,status:this.status}}});const Lw=Zt.prototype,Pw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Pw[t]={value:t}});Object.defineProperties(Zt,Pw);Object.defineProperty(Lw,"isAxiosError",{value:!0});Zt.from=(t,s,e,a,n,i)=>{const c=Object.create(Lw);return Ze.toFlatObject(t,c,function(u){return u!==Error.prototype},l=>l!=="isAxiosError"),Zt.call(c,t.message,s,e,a,n),c.cause=t,c.name=t.name,i&&Object.assign(c,i),c};const i7=null;function Gp(t){return Ze.isPlainObject(t)||Ze.isArray(t)}function Bw(t){return Ze.endsWith(t,"[]")?t.slice(0,-2):t}function $v(t,s,e){return t?t.concat(s).map(function(n,i){return n=Bw(n),!e&&i?"["+n+"]":n}).join(e?".":""):s}function o7(t){return Ze.isArray(t)&&!t.some(Gp)}const l7=Ze.toFlatObject(Ze,{},null,function(s){return/^is[A-Z]/.test(s)});function D0(t,s,e){if(!Ze.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,e=Ze.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,b){return!Ze.isUndefined(b[x])});const a=e.metaTokens,n=e.visitor||d,i=e.dots,c=e.indexes,u=(e.Blob||typeof Blob<"u"&&Blob)&&Ze.isSpecCompliantForm(s);if(!Ze.isFunction(n))throw new TypeError("visitor must be a function");function o(f){if(f===null)return"";if(Ze.isDate(f))return f.toISOString();if(!u&&Ze.isBlob(f))throw new Zt("Blob is not supported. Use a Buffer instead.");return Ze.isArrayBuffer(f)||Ze.isTypedArray(f)?u&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function d(f,x,b){let v=f;if(f&&!b&&typeof f=="object"){if(Ze.endsWith(x,"{}"))x=a?x:x.slice(0,-2),f=JSON.stringify(f);else if(Ze.isArray(f)&&o7(f)||(Ze.isFileList(f)||Ze.endsWith(x,"[]"))&&(v=Ze.toArray(f)))return x=Bw(x),v.forEach(function(N,E){!(Ze.isUndefined(N)||N===null)&&s.append(c===!0?$v([x],E,i):c===null?x:x+"[]",o(N))}),!1}return Gp(f)?!0:(s.append($v(b,x,i),o(f)),!1)}const g=[],p=Object.assign(l7,{defaultVisitor:d,convertValue:o,isVisitable:Gp});function h(f,x){if(!Ze.isUndefined(f)){if(g.indexOf(f)!==-1)throw Error("Circular reference detected in "+x.join("."));g.push(f),Ze.forEach(f,function(v,_){(!(Ze.isUndefined(v)||v===null)&&n.call(s,v,Ze.isString(_)?_.trim():_,x,p))===!0&&h(v,x?x.concat(_):[_])}),g.pop()}}if(!Ze.isObject(t))throw new TypeError("data must be an object");return h(t),s}function zv(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return s[a]})}function Bg(t,s){this._pairs=[],t&&D0(t,this,s)}const Dw=Bg.prototype;Dw.append=function(s,e){this._pairs.push([s,e])};Dw.toString=function(s){const e=s?function(a){return s.call(this,a,zv)}:zv;return this._pairs.map(function(n){return e(n[0])+"="+e(n[1])},"").join("&")};function c7(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Uw(t,s,e){if(!s)return t;const a=e&&e.encode||c7;Ze.isFunction(e)&&(e={serialize:e});const n=e&&e.serialize;let i;if(n?i=n(s,e):i=Ze.isURLSearchParams(s)?s.toString():new Bg(s,e).toString(a),i){const c=t.indexOf("#");c!==-1&&(t=t.slice(0,c)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class Hv{constructor(){this.handlers=[]}use(s,e,a){return this.handlers.push({fulfilled:s,rejected:e,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){Ze.forEach(this.handlers,function(a){a!==null&&s(a)})}}const $w={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},u7=typeof URLSearchParams<"u"?URLSearchParams:Bg,d7=typeof FormData<"u"?FormData:null,f7=typeof Blob<"u"?Blob:null,h7={isBrowser:!0,classes:{URLSearchParams:u7,FormData:d7,Blob:f7},protocols:["http","https","file","blob","url","data"]},Dg=typeof window<"u"&&typeof document<"u",Yp=typeof navigator=="object"&&navigator||void 0,m7=Dg&&(!Yp||["ReactNative","NativeScript","NS"].indexOf(Yp.product)<0),p7=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",g7=Dg&&window.location.href||"http://localhost",x7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Dg,hasStandardBrowserEnv:m7,hasStandardBrowserWebWorkerEnv:p7,navigator:Yp,origin:g7},Symbol.toStringTag,{value:"Module"})),Bs={...x7,...h7};function b7(t,s){return D0(t,new Bs.classes.URLSearchParams,Object.assign({visitor:function(e,a,n,i){return Bs.isNode&&Ze.isBuffer(e)?(this.append(a,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},s))}function y7(t){return Ze.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function v7(t){const s={},e=Object.keys(t);let a;const n=e.length;let i;for(a=0;a<n;a++)i=e[a],s[i]=t[i];return s}function zw(t){function s(e,a,n,i){let c=e[i++];if(c==="__proto__")return!0;const l=Number.isFinite(+c),u=i>=e.length;return c=!c&&Ze.isArray(n)?n.length:c,u?(Ze.hasOwnProp(n,c)?n[c]=[n[c],a]:n[c]=a,!l):((!n[c]||!Ze.isObject(n[c]))&&(n[c]=[]),s(e,a,n[c],i)&&Ze.isArray(n[c])&&(n[c]=v7(n[c])),!l)}if(Ze.isFormData(t)&&Ze.isFunction(t.entries)){const e={};return Ze.forEachEntry(t,(a,n)=>{s(y7(a),n,e,0)}),e}return null}function _7(t,s,e){if(Ze.isString(t))try{return(s||JSON.parse)(t),Ze.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(e||JSON.stringify)(t)}const Zu={transitional:$w,adapter:["xhr","http","fetch"],transformRequest:[function(s,e){const a=e.getContentType()||"",n=a.indexOf("application/json")>-1,i=Ze.isObject(s);if(i&&Ze.isHTMLForm(s)&&(s=new FormData(s)),Ze.isFormData(s))return n?JSON.stringify(zw(s)):s;if(Ze.isArrayBuffer(s)||Ze.isBuffer(s)||Ze.isStream(s)||Ze.isFile(s)||Ze.isBlob(s)||Ze.isReadableStream(s))return s;if(Ze.isArrayBufferView(s))return s.buffer;if(Ze.isURLSearchParams(s))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let l;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return b7(s,this.formSerializer).toString();if((l=Ze.isFileList(s))||a.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return D0(l?{"files[]":s}:s,u&&new u,this.formSerializer)}}return i||n?(e.setContentType("application/json",!1),_7(s)):s}],transformResponse:[function(s){const e=this.transitional||Zu.transitional,a=e&&e.forcedJSONParsing,n=this.responseType==="json";if(Ze.isResponse(s)||Ze.isReadableStream(s))return s;if(s&&Ze.isString(s)&&(a&&!this.responseType||n)){const c=!(e&&e.silentJSONParsing)&&n;try{return JSON.parse(s)}catch(l){if(c)throw l.name==="SyntaxError"?Zt.from(l,Zt.ERR_BAD_RESPONSE,this,null,this.response):l}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Bs.classes.FormData,Blob:Bs.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ze.forEach(["delete","get","head","post","put","patch"],t=>{Zu.headers[t]={}});const w7=Ze.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),N7=t=>{const s={};let e,a,n;return t&&t.split(`
`).forEach(function(c){n=c.indexOf(":"),e=c.substring(0,n).trim().toLowerCase(),a=c.substring(n+1).trim(),!(!e||s[e]&&w7[e])&&(e==="set-cookie"?s[e]?s[e].push(a):s[e]=[a]:s[e]=s[e]?s[e]+", "+a:a)}),s},Vv=Symbol("internals");function hu(t){return t&&String(t).trim().toLowerCase()}function $f(t){return t===!1||t==null?t:Ze.isArray(t)?t.map($f):String(t)}function j7(t){const s=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=e.exec(t);)s[a[1]]=a[2];return s}const S7=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function mp(t,s,e,a,n){if(Ze.isFunction(a))return a.call(this,s,e);if(n&&(s=e),!!Ze.isString(s)){if(Ze.isString(a))return s.indexOf(a)!==-1;if(Ze.isRegExp(a))return a.test(s)}}function k7(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,e,a)=>e.toUpperCase()+a)}function C7(t,s){const e=Ze.toCamelCase(" "+s);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+e,{value:function(n,i,c){return this[a].call(this,s,n,i,c)},configurable:!0})})}let la=class{constructor(s){s&&this.set(s)}set(s,e,a){const n=this;function i(l,u,o){const d=hu(u);if(!d)throw new Error("header name must be a non-empty string");const g=Ze.findKey(n,d);(!g||n[g]===void 0||o===!0||o===void 0&&n[g]!==!1)&&(n[g||u]=$f(l))}const c=(l,u)=>Ze.forEach(l,(o,d)=>i(o,d,u));if(Ze.isPlainObject(s)||s instanceof this.constructor)c(s,e);else if(Ze.isString(s)&&(s=s.trim())&&!S7(s))c(N7(s),e);else if(Ze.isHeaders(s))for(const[l,u]of s.entries())i(u,l,a);else s!=null&&i(e,s,a);return this}get(s,e){if(s=hu(s),s){const a=Ze.findKey(this,s);if(a){const n=this[a];if(!e)return n;if(e===!0)return j7(n);if(Ze.isFunction(e))return e.call(this,n,a);if(Ze.isRegExp(e))return e.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,e){if(s=hu(s),s){const a=Ze.findKey(this,s);return!!(a&&this[a]!==void 0&&(!e||mp(this,this[a],a,e)))}return!1}delete(s,e){const a=this;let n=!1;function i(c){if(c=hu(c),c){const l=Ze.findKey(a,c);l&&(!e||mp(a,a[l],l,e))&&(delete a[l],n=!0)}}return Ze.isArray(s)?s.forEach(i):i(s),n}clear(s){const e=Object.keys(this);let a=e.length,n=!1;for(;a--;){const i=e[a];(!s||mp(this,this[i],i,s,!0))&&(delete this[i],n=!0)}return n}normalize(s){const e=this,a={};return Ze.forEach(this,(n,i)=>{const c=Ze.findKey(a,i);if(c){e[c]=$f(n),delete e[i];return}const l=s?k7(i):String(i).trim();l!==i&&delete e[i],e[l]=$f(n),a[l]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const e=Object.create(null);return Ze.forEach(this,(a,n)=>{a!=null&&a!==!1&&(e[n]=s&&Ze.isArray(a)?a.join(", "):a)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,e])=>s+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...e){const a=new this(s);return e.forEach(n=>a.set(n)),a}static accessor(s){const a=(this[Vv]=this[Vv]={accessors:{}}).accessors,n=this.prototype;function i(c){const l=hu(c);a[l]||(C7(n,c),a[l]=!0)}return Ze.isArray(s)?s.forEach(i):i(s),this}};la.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ze.reduceDescriptors(la.prototype,({value:t},s)=>{let e=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(a){this[e]=a}}});Ze.freezeMethods(la);function pp(t,s){const e=this||Zu,a=s||e,n=la.from(a.headers);let i=a.data;return Ze.forEach(t,function(l){i=l.call(e,i,n.normalize(),s?s.status:void 0)}),n.normalize(),i}function Hw(t){return!!(t&&t.__CANCEL__)}function ic(t,s,e){Zt.call(this,t??"canceled",Zt.ERR_CANCELED,s,e),this.name="CanceledError"}Ze.inherits(ic,Zt,{__CANCEL__:!0});function Vw(t,s,e){const a=e.config.validateStatus;!e.status||!a||a(e.status)?t(e):s(new Zt("Request failed with status code "+e.status,[Zt.ERR_BAD_REQUEST,Zt.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function E7(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function T7(t,s){t=t||10;const e=new Array(t),a=new Array(t);let n=0,i=0,c;return s=s!==void 0?s:1e3,function(u){const o=Date.now(),d=a[i];c||(c=o),e[n]=u,a[n]=o;let g=i,p=0;for(;g!==n;)p+=e[g++],g=g%t;if(n=(n+1)%t,n===i&&(i=(i+1)%t),o-c<s)return;const h=d&&o-d;return h?Math.round(p*1e3/h):void 0}}function A7(t,s){let e=0,a=1e3/s,n,i;const c=(o,d=Date.now())=>{e=d,n=null,i&&(clearTimeout(i),i=null),t.apply(null,o)};return[(...o)=>{const d=Date.now(),g=d-e;g>=a?c(o,d):(n=o,i||(i=setTimeout(()=>{i=null,c(n)},a-g)))},()=>n&&c(n)]}const Qf=(t,s,e=3)=>{let a=0;const n=T7(50,250);return A7(i=>{const c=i.loaded,l=i.lengthComputable?i.total:void 0,u=c-a,o=n(u),d=c<=l;a=c;const g={loaded:c,total:l,progress:l?c/l:void 0,bytes:u,rate:o||void 0,estimated:o&&l&&d?(l-c)/o:void 0,event:i,lengthComputable:l!=null,[s?"download":"upload"]:!0};t(g)},e)},qv=(t,s)=>{const e=t!=null;return[a=>s[0]({lengthComputable:e,total:t,loaded:a}),s[1]]},Gv=t=>(...s)=>Ze.asap(()=>t(...s)),O7=Bs.hasStandardBrowserEnv?((t,s)=>e=>(e=new URL(e,Bs.origin),t.protocol===e.protocol&&t.host===e.host&&(s||t.port===e.port)))(new URL(Bs.origin),Bs.navigator&&/(msie|trident)/i.test(Bs.navigator.userAgent)):()=>!0,R7=Bs.hasStandardBrowserEnv?{write(t,s,e,a,n,i){const c=[t+"="+encodeURIComponent(s)];Ze.isNumber(e)&&c.push("expires="+new Date(e).toGMTString()),Ze.isString(a)&&c.push("path="+a),Ze.isString(n)&&c.push("domain="+n),i===!0&&c.push("secure"),document.cookie=c.join("; ")},read(t){const s=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function M7(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function F7(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function qw(t,s){return t&&!M7(s)?F7(t,s):s}const Yv=t=>t instanceof la?{...t}:t;function Uo(t,s){s=s||{};const e={};function a(o,d,g,p){return Ze.isPlainObject(o)&&Ze.isPlainObject(d)?Ze.merge.call({caseless:p},o,d):Ze.isPlainObject(d)?Ze.merge({},d):Ze.isArray(d)?d.slice():d}function n(o,d,g,p){if(Ze.isUndefined(d)){if(!Ze.isUndefined(o))return a(void 0,o,g,p)}else return a(o,d,g,p)}function i(o,d){if(!Ze.isUndefined(d))return a(void 0,d)}function c(o,d){if(Ze.isUndefined(d)){if(!Ze.isUndefined(o))return a(void 0,o)}else return a(void 0,d)}function l(o,d,g){if(g in s)return a(o,d);if(g in t)return a(void 0,o)}const u={url:i,method:i,data:i,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:l,headers:(o,d,g)=>n(Yv(o),Yv(d),g,!0)};return Ze.forEach(Object.keys(Object.assign({},t,s)),function(d){const g=u[d]||n,p=g(t[d],s[d],d);Ze.isUndefined(p)&&g!==l||(e[d]=p)}),e}const Gw=t=>{const s=Uo({},t);let{data:e,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:c,auth:l}=s;s.headers=c=la.from(c),s.url=Uw(qw(s.baseURL,s.url),t.params,t.paramsSerializer),l&&c.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let u;if(Ze.isFormData(e)){if(Bs.hasStandardBrowserEnv||Bs.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if((u=c.getContentType())!==!1){const[o,...d]=u?u.split(";").map(g=>g.trim()).filter(Boolean):[];c.setContentType([o||"multipart/form-data",...d].join("; "))}}if(Bs.hasStandardBrowserEnv&&(a&&Ze.isFunction(a)&&(a=a(s)),a||a!==!1&&O7(s.url))){const o=n&&i&&R7.read(i);o&&c.set(n,o)}return s},I7=typeof XMLHttpRequest<"u",L7=I7&&function(t){return new Promise(function(e,a){const n=Gw(t);let i=n.data;const c=la.from(n.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:o}=n,d,g,p,h,f;function x(){h&&h(),f&&f(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let b=new XMLHttpRequest;b.open(n.method.toUpperCase(),n.url,!0),b.timeout=n.timeout;function v(){if(!b)return;const N=la.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),O={data:!l||l==="text"||l==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:N,config:t,request:b};Vw(function(z){e(z),x()},function(z){a(z),x()},O),b=null}"onloadend"in b?b.onloadend=v:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(v)},b.onabort=function(){b&&(a(new Zt("Request aborted",Zt.ECONNABORTED,t,b)),b=null)},b.onerror=function(){a(new Zt("Network Error",Zt.ERR_NETWORK,t,b)),b=null},b.ontimeout=function(){let E=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const O=n.transitional||$w;n.timeoutErrorMessage&&(E=n.timeoutErrorMessage),a(new Zt(E,O.clarifyTimeoutError?Zt.ETIMEDOUT:Zt.ECONNABORTED,t,b)),b=null},i===void 0&&c.setContentType(null),"setRequestHeader"in b&&Ze.forEach(c.toJSON(),function(E,O){b.setRequestHeader(O,E)}),Ze.isUndefined(n.withCredentials)||(b.withCredentials=!!n.withCredentials),l&&l!=="json"&&(b.responseType=n.responseType),o&&([p,f]=Qf(o,!0),b.addEventListener("progress",p)),u&&b.upload&&([g,h]=Qf(u),b.upload.addEventListener("progress",g),b.upload.addEventListener("loadend",h)),(n.cancelToken||n.signal)&&(d=N=>{b&&(a(!N||N.type?new ic(null,t,b):N),b.abort(),b=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const _=E7(n.url);if(_&&Bs.protocols.indexOf(_)===-1){a(new Zt("Unsupported protocol "+_+":",Zt.ERR_BAD_REQUEST,t));return}b.send(i||null)})},P7=(t,s)=>{const{length:e}=t=t?t.filter(Boolean):[];if(s||e){let a=new AbortController,n;const i=function(o){if(!n){n=!0,l();const d=o instanceof Error?o:this.reason;a.abort(d instanceof Zt?d:new ic(d instanceof Error?d.message:d))}};let c=s&&setTimeout(()=>{c=null,i(new Zt(`timeout ${s} of ms exceeded`,Zt.ETIMEDOUT))},s);const l=()=>{t&&(c&&clearTimeout(c),c=null,t.forEach(o=>{o.unsubscribe?o.unsubscribe(i):o.removeEventListener("abort",i)}),t=null)};t.forEach(o=>o.addEventListener("abort",i));const{signal:u}=a;return u.unsubscribe=()=>Ze.asap(l),u}},B7=function*(t,s){let e=t.byteLength;if(e<s){yield t;return}let a=0,n;for(;a<e;)n=a+s,yield t.slice(a,n),a=n},D7=async function*(t,s){for await(const e of U7(t))yield*B7(e,s)},U7=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:e,value:a}=await s.read();if(e)break;yield a}}finally{await s.cancel()}},Wv=(t,s,e,a)=>{const n=D7(t,s);let i=0,c,l=u=>{c||(c=!0,a&&a(u))};return new ReadableStream({async pull(u){try{const{done:o,value:d}=await n.next();if(o){l(),u.close();return}let g=d.byteLength;if(e){let p=i+=g;e(p)}u.enqueue(new Uint8Array(d))}catch(o){throw l(o),o}},cancel(u){return l(u),n.return()}},{highWaterMark:2})},U0=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Yw=U0&&typeof ReadableStream=="function",$7=U0&&(typeof TextEncoder=="function"?(t=>s=>t.encode(s))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Ww=(t,...s)=>{try{return!!t(...s)}catch{return!1}},z7=Yw&&Ww(()=>{let t=!1;const s=new Request(Bs.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!s}),Xv=64*1024,Wp=Yw&&Ww(()=>Ze.isReadableStream(new Response("").body)),Jf={stream:Wp&&(t=>t.body)};U0&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(s=>{!Jf[s]&&(Jf[s]=Ze.isFunction(t[s])?e=>e[s]():(e,a)=>{throw new Zt(`Response type '${s}' is not supported`,Zt.ERR_NOT_SUPPORT,a)})})})(new Response);const H7=async t=>{if(t==null)return 0;if(Ze.isBlob(t))return t.size;if(Ze.isSpecCompliantForm(t))return(await new Request(Bs.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(Ze.isArrayBufferView(t)||Ze.isArrayBuffer(t))return t.byteLength;if(Ze.isURLSearchParams(t)&&(t=t+""),Ze.isString(t))return(await $7(t)).byteLength},V7=async(t,s)=>{const e=Ze.toFiniteNumber(t.getContentLength());return e??H7(s)},q7=U0&&(async t=>{let{url:s,method:e,data:a,signal:n,cancelToken:i,timeout:c,onDownloadProgress:l,onUploadProgress:u,responseType:o,headers:d,withCredentials:g="same-origin",fetchOptions:p}=Gw(t);o=o?(o+"").toLowerCase():"text";let h=P7([n,i&&i.toAbortSignal()],c),f;const x=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let b;try{if(u&&z7&&e!=="get"&&e!=="head"&&(b=await V7(d,a))!==0){let O=new Request(s,{method:"POST",body:a,duplex:"half"}),F;if(Ze.isFormData(a)&&(F=O.headers.get("content-type"))&&d.setContentType(F),O.body){const[z,P]=qv(b,Qf(Gv(u)));a=Wv(O.body,Xv,z,P)}}Ze.isString(g)||(g=g?"include":"omit");const v="credentials"in Request.prototype;f=new Request(s,{...p,signal:h,method:e.toUpperCase(),headers:d.normalize().toJSON(),body:a,duplex:"half",credentials:v?g:void 0});let _=await fetch(f);const N=Wp&&(o==="stream"||o==="response");if(Wp&&(l||N&&x)){const O={};["status","statusText","headers"].forEach(U=>{O[U]=_[U]});const F=Ze.toFiniteNumber(_.headers.get("content-length")),[z,P]=l&&qv(F,Qf(Gv(l),!0))||[];_=new Response(Wv(_.body,Xv,z,()=>{P&&P(),x&&x()}),O)}o=o||"text";let E=await Jf[Ze.findKey(Jf,o)||"text"](_,t);return!N&&x&&x(),await new Promise((O,F)=>{Vw(O,F,{data:E,headers:la.from(_.headers),status:_.status,statusText:_.statusText,config:t,request:f})})}catch(v){throw x&&x(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new Zt("Network Error",Zt.ERR_NETWORK,t,f),{cause:v.cause||v}):Zt.from(v,v&&v.code,t,f)}}),Xp={http:i7,xhr:L7,fetch:q7};Ze.forEach(Xp,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const Kv=t=>`- ${t}`,G7=t=>Ze.isFunction(t)||t===null||t===!1,Xw={getAdapter:t=>{t=Ze.isArray(t)?t:[t];const{length:s}=t;let e,a;const n={};for(let i=0;i<s;i++){e=t[i];let c;if(a=e,!G7(e)&&(a=Xp[(c=String(e)).toLowerCase()],a===void 0))throw new Zt(`Unknown adapter '${c}'`);if(a)break;n[c||"#"+i]=a}if(!a){const i=Object.entries(n).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let c=s?i.length>1?`since :
`+i.map(Kv).join(`
`):" "+Kv(i[0]):"as no adapter specified";throw new Zt("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return a},adapters:Xp};function gp(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ic(null,t)}function Zv(t){return gp(t),t.headers=la.from(t.headers),t.data=pp.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Xw.getAdapter(t.adapter||Zu.adapter)(t).then(function(a){return gp(t),a.data=pp.call(t,t.transformResponse,a),a.headers=la.from(a.headers),a},function(a){return Hw(a)||(gp(t),a&&a.response&&(a.response.data=pp.call(t,t.transformResponse,a.response),a.response.headers=la.from(a.response.headers))),Promise.reject(a)})}const Kw="1.7.9",$0={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{$0[t]=function(a){return typeof a===t||"a"+(s<1?"n ":" ")+t}});const Qv={};$0.transitional=function(s,e,a){function n(i,c){return"[Axios v"+Kw+"] Transitional option '"+i+"'"+c+(a?". "+a:"")}return(i,c,l)=>{if(s===!1)throw new Zt(n(c," has been removed"+(e?" in "+e:"")),Zt.ERR_DEPRECATED);return e&&!Qv[c]&&(Qv[c]=!0,console.warn(n(c," has been deprecated since v"+e+" and will be removed in the near future"))),s?s(i,c,l):!0}};$0.spelling=function(s){return(e,a)=>(console.warn(`${a} is likely a misspelling of ${s}`),!0)};function Y7(t,s,e){if(typeof t!="object")throw new Zt("options must be an object",Zt.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let n=a.length;for(;n-- >0;){const i=a[n],c=s[i];if(c){const l=t[i],u=l===void 0||c(l,i,t);if(u!==!0)throw new Zt("option "+i+" must be "+u,Zt.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new Zt("Unknown option "+i,Zt.ERR_BAD_OPTION)}}const zf={assertOptions:Y7,validators:$0},On=zf.validators;let Io=class{constructor(s){this.defaults=s,this.interceptors={request:new Hv,response:new Hv}}async request(s,e){try{return await this._request(s,e)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(s,e){typeof s=="string"?(e=e||{},e.url=s):e=s||{},e=Uo(this.defaults,e);const{transitional:a,paramsSerializer:n,headers:i}=e;a!==void 0&&zf.assertOptions(a,{silentJSONParsing:On.transitional(On.boolean),forcedJSONParsing:On.transitional(On.boolean),clarifyTimeoutError:On.transitional(On.boolean)},!1),n!=null&&(Ze.isFunction(n)?e.paramsSerializer={serialize:n}:zf.assertOptions(n,{encode:On.function,serialize:On.function},!0)),zf.assertOptions(e,{baseUrl:On.spelling("baseURL"),withXsrfToken:On.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let c=i&&Ze.merge(i.common,i[e.method]);i&&Ze.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),e.headers=la.concat(c,i);const l=[];let u=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(e)===!1||(u=u&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const o=[];this.interceptors.response.forEach(function(x){o.push(x.fulfilled,x.rejected)});let d,g=0,p;if(!u){const f=[Zv.bind(this),void 0];for(f.unshift.apply(f,l),f.push.apply(f,o),p=f.length,d=Promise.resolve(e);g<p;)d=d.then(f[g++],f[g++]);return d}p=l.length;let h=e;for(g=0;g<p;){const f=l[g++],x=l[g++];try{h=f(h)}catch(b){x.call(this,b);break}}try{d=Zv.call(this,h)}catch(f){return Promise.reject(f)}for(g=0,p=o.length;g<p;)d=d.then(o[g++],o[g++]);return d}getUri(s){s=Uo(this.defaults,s);const e=qw(s.baseURL,s.url);return Uw(e,s.params,s.paramsSerializer)}};Ze.forEach(["delete","get","head","options"],function(s){Io.prototype[s]=function(e,a){return this.request(Uo(a||{},{method:s,url:e,data:(a||{}).data}))}});Ze.forEach(["post","put","patch"],function(s){function e(a){return function(i,c,l){return this.request(Uo(l||{},{method:s,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:c}))}}Io.prototype[s]=e(),Io.prototype[s+"Form"]=e(!0)});let W7=class Zw{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(i){e=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const c=new Promise(l=>{a.subscribe(l),i=l}).then(n);return c.cancel=function(){a.unsubscribe(i)},c},s(function(i,c,l){a.reason||(a.reason=new ic(i,c,l),e(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const e=this._listeners.indexOf(s);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const s=new AbortController,e=a=>{s.abort(a)};return this.subscribe(e),s.signal.unsubscribe=()=>this.unsubscribe(e),s.signal}static source(){let s;return{token:new Zw(function(n){s=n}),cancel:s}}};function X7(t){return function(e){return t.apply(null,e)}}function K7(t){return Ze.isObject(t)&&t.isAxiosError===!0}const Kp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Kp).forEach(([t,s])=>{Kp[s]=t});function Qw(t){const s=new Io(t),e=Ew(Io.prototype.request,s);return Ze.extend(e,Io.prototype,s,{allOwnKeys:!0}),Ze.extend(e,s,null,{allOwnKeys:!0}),e.create=function(n){return Qw(Uo(t,n))},e}const bt=Qw(Zu);bt.Axios=Io;bt.CanceledError=ic;bt.CancelToken=W7;bt.isCancel=Hw;bt.VERSION=Kw;bt.toFormData=D0;bt.AxiosError=Zt;bt.Cancel=bt.CanceledError;bt.all=function(s){return Promise.all(s)};bt.spread=X7;bt.isAxiosError=K7;bt.mergeConfig=Uo;bt.AxiosHeaders=la;bt.formToJSON=t=>zw(Ze.isHTMLForm(t)?new FormData(t):t);bt.getAdapter=Xw.getAdapter;bt.HttpStatusCode=Kp;bt.default=bt;const{Axios:Bq,AxiosError:Dq,CanceledError:Uq,isCancel:$q,CancelToken:zq,VERSION:Hq,all:Vq,Cancel:qq,isAxiosError:Gq,spread:Yq,toFormData:Wq,AxiosHeaders:Xq,HttpStatusCode:Kq,formToJSON:Zq,getAdapter:Qq,mergeConfig:Jq}=bt,Ct={API_URL:`http://${window.location.hostname}:8000/api`};/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z7=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Q7=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,e,a)=>a?a.toUpperCase():e.toLowerCase()),Jv=t=>{const s=Q7(t);return s.charAt(0).toUpperCase()+s.slice(1)},Jw=(...t)=>t.filter((s,e,a)=>!!s&&s.trim()!==""&&a.indexOf(s)===e).join(" ").trim(),J7=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=ne.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:e=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:c,...l},u)=>ne.createElement("svg",{ref:u,...eC,width:s,height:s,stroke:t,strokeWidth:a?Number(e)*24/Number(s):e,className:Jw("lucide",n),...!i&&!J7(l)&&{"aria-hidden":"true"},...l},[...c.map(([o,d])=>ne.createElement(o,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=(t,s)=>{const e=ne.forwardRef(({className:a,...n},i)=>ne.createElement(tC,{ref:i,iconNode:s,className:Jw(`lucide-${Z7(Jv(t))}`,`lucide-${t}`,a),...n}));return e.displayName=Jv(t),e};/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rC=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Zo=wt("arrow-left",rC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sC=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Zr=wt("award",sC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],qr=wt("book-open",aC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Hf=wt("briefcase",nC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iC=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],$s=wt("building-2",iC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oC=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],Ya=wt("building",oC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],e3=wt("calculator",lC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Lr=wt("calendar",cC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],dC=wt("camera",uC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fC=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ug=wt("chart-column",fC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],mC=wt("chart-no-axes-column",hC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pC=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],gC=wt("chart-pie",pC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Vf=wt("chevron-down",xC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],yC=wt("chevron-left",bC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],_C=wt("chevron-up",vC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ht=wt("circle-alert",wC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NC=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],e0=wt("circle-check-big",NC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Xa=wt("clock",jC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],ui=wt("database",SC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kC=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],bn=wt("dollar-sign",kC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CC=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],oc=wt("download",CC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],TC=wt("earth",EC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AC=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],ha=wt("ellipsis",AC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OC=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],t3=wt("external-link",OC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],MC=wt("eye-off",RC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gs=wt("eye",FC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],LC=wt("file-check",IC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PC=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],BC=wt("file-down",PC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DC=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],$o=wt("file-spreadsheet",DC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ys=wt("file-text",UC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],zC=wt("file-up",$C);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],zo=wt("funnel",HC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ql=wt("globe",VC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],gr=wt("graduation-cap",qC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],$g=wt("hash",GC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],xp=wt("house",YC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],pi=wt("info",WC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],bp=wt("layout-dashboard",XC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],e2=wt("lightbulb",KC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],t2=wt("list",ZC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],t0=wt("lock",QC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],r3=wt("log-out",JC);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Dn=wt("mail",eE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],yn=wt("map-pin",tE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],sE=wt("menu",rE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],nE=wt("pen-line",aE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]],r2=wt("phone-call",iE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oE=[["path",{d:"M20 11H4",key:"6ut86h"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"M7 21V4a1 1 0 0 1 1-1h4a1 1 0 0 1 0 12H7",key:"1ana5r"}]],s3=wt("philippine-peso",oE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lE=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],ao=wt("phone",lE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Er=wt("plus",cE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uE=[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]],s2=wt("presentation",uE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dE=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],fE=wt("printer",dE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],a2=wt("quote",hE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mE=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],pE=wt("refresh-cw",mE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gE=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],xE=wt("ruler",gE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ma=wt("save",bE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yE=[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],Bl=wt("school",yE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],pa=wt("search",vE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vf=wt("settings",_E);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Gl=wt("shield",wE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],jE=wt("sparkles",NE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Dr=wt("square-pen",SE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],r0=wt("target",kE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],a3=wt("trash-2",CE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],ga=wt("trash",EE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],Qo=wt("trending-up",TE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Qr=wt("upload",AE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],eo=wt("user-check",OE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Zp=wt("user-x",RE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ir=wt("user",ME);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Jr=wt("users",FE);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],vs=wt("x",IE),z0="/assets/ChedLogo-C854hc7b.png",LE="/assets/cover-DF1qnVmI.jpg",PE=()=>{const t=Aa(),[s,e]=ne.useState(""),[a,n]=ne.useState(""),[i,c]=ne.useState(""),[l,u]=ne.useState(!1),[o,d]=ne.useState(!1),[g,p]=ne.useState(!1),[h,f]=ne.useState(!1),[x,b]=ne.useState(0),[v,_]=ne.useState(!1),[N,E]=ne.useState([]);ne.useEffect(()=>{setTimeout(()=>p(!0),100);const P=Array(15).fill().map((W,Y)=>({id:Y,x:Math.random()*100,y:Math.random()*100,size:Math.random()*4+2,speed:Math.random()*20+15,opacity:Math.random()*.2+.1,color:Y%5===0?"#3b82f6":Y%3===0?"#818cf8":"#c4b5fd",phase:Math.random()*Math.PI*2}));E(P);const U=setTimeout(()=>{_(!0)},2500);return()=>clearTimeout(U)},[]),ne.useEffect(()=>{const P=setInterval(()=>{const U=Date.now()/2e3;E(W=>W.map(Y=>{const q=U/(Y.speed*.5)+Y.phase,M=U/(Y.speed*.7)+Y.phase;return{...Y,x:(Y.x+.01*Math.sin(q))%100,y:(Y.y+.01*Math.cos(M))%100,opacity:.1+Math.abs(Math.sin(U/8))*.15}}))},20);return()=>clearInterval(P)},[]);const O=async P=>{var U,W;if(P.preventDefault(),c(""),u(!0),b(Y=>Y+1),!s||!a){c("Please fill in both fields."),u(!1);return}try{const Y=await bt.post(`${Ct.API_URL}/auth/login`,{email:s,password:a}),{user:q,token:M}=Y.data;if(q.status==="Inactive"){c("Your account is inactive. Please contact support."),u(!1);return}switch(localStorage.setItem("token",M),localStorage.setItem("user",JSON.stringify(q)),bt.defaults.headers.common.Authorization=`Bearer ${M}`,q.role){case"super-admin":t("/super-admin/dashboard");break;case"hei-admin":t("/hei-admin/dashboard");break;case"hei-staff":t("/hei-staff/dashboard");break;default:c("Unknown role. Please contact support."),localStorage.clear();break}}catch(Y){c(((W=(U=Y.response)==null?void 0:U.data)==null?void 0:W.message)||"An error occurred during login. Please try again.")}finally{u(!1)}},F=()=>{d(!o)},z=()=>Math.random()*.5+.1;return r.jsxs("div",{className:"min-h-screen w-full flex items-stretch overflow-hidden relative bg-cover bg-center bg-no-repeat font-sans",style:{backgroundImage:`url(${LE})`},children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-[2px]"}),N.map(P=>r.jsx("div",{className:"absolute rounded-full pointer-events-none",style:{left:`${P.x}%`,top:`${P.y}%`,width:`${P.size}px`,height:`${P.size}px`,backgroundColor:P.color,opacity:P.opacity*.4,transition:"opacity 2s ease-in-out",filter:"blur(1.5px)"}},P.id)),r.jsxs("div",{className:`hidden lg:flex lg:w-3/5 relative overflow-hidden flex-col justify-center items-start px-16 transition-all duration-1000 ease-out ${g?"opacity-100":"opacity-0"}`,children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/40 to-indigo-900/20"}),r.jsx("div",{className:"absolute right-0 top-1/4 w-64 h-64 bg-gradient-to-br from-blue-400/20 to-indigo-500/30 rounded-full blur-3xl transform -translate-x-1/2 -translate-y-1/2",style:{animation:"float 15s ease-in-out infinite"}}),r.jsx("div",{className:"absolute right-1/4 bottom-1/4 w-48 h-48 bg-gradient-to-tr from-purple-500/20 to-pink-500/20 rounded-full blur-3xl",style:{animation:"float 18s ease-in-out infinite 2s"}}),r.jsxs("div",{className:"relative z-10 max-w-xl",children:[r.jsxs("div",{className:`transform transition-all duration-1000 delay-300 ${g?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[r.jsxs("div",{className:"flex items-center mb-6",children:[r.jsx(jE,{className:"text-yellow-400 h-8 w-8 mr-3"}),r.jsx("h1",{className:"text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-blue-200",children:"CHED Region IX"})]}),r.jsx("div",{className:"h-1 w-24 bg-gradient-to-r from-yellow-400 to-yellow-200 rounded-full mb-8"})]}),r.jsxs("div",{className:`transform transition-all duration-1000 delay-500 ${g?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[r.jsx("h2",{className:"text-2xl font-semibold text-white/90 mb-4",children:"Higher Education Management System"}),r.jsx("p",{className:"text-xl font-light mb-8 text-blue-100",children:"Zamboanga Peninsula's innovative platform for educational excellence"})]}),r.jsx("div",{className:`mt-12 transform transition-all duration-1000 delay-1000 ${g?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:r.jsx("div",{className:"flex space-x-4",children:["Efficiency","Innovation","Excellence","Collaboration"].map((P,U)=>r.jsx("div",{className:"px-4 py-2 bg-white/10 rounded-full text-sm text-white/90 border border-white/20 backdrop-blur-sm shadow-sm",style:{animation:v?`pulse 3s infinite ${U*.7}s`:"none"},children:P},P))})})]})]}),r.jsx("div",{className:`w-full lg:w-2/5 flex items-center justify-center transition-all duration-1000 ${g?"opacity-100 translate-x-0":"opacity-0 translate-x-10"}`,children:r.jsxs("div",{className:"w-full max-w-md px-8 py-10 sm:px-12 sm:py-12 relative",children:[r.jsx("div",{className:`absolute inset-0 bg-white/80 backdrop-blur-xl rounded-2xl border border-gray-200 shadow-2xl transform transition-all duration-500 ${h?"scale-[1.02] shadow-blue-500/20":"scale-100"}`}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex flex-col items-center mb-10 transition-all duration-700",style:{transform:g?"translateY(0)":"translateY(20px)"},children:[r.jsxs("div",{className:"relative transform transition-all duration-700 hover:scale-105",style:{animation:"float 6s ease-in-out infinite"},children:[r.jsx("div",{className:"absolute -inset-1 rounded-full bg-gradient-to-r from-yellow-400 to-yellow-500 opacity-60 blur-md"}),r.jsx("div",{className:"relative bg-gradient-to-br from-yellow-100 to-yellow-400 p-2 rounded-full border-2 border-white/30 shadow-xl backdrop-blur-sm",children:r.jsx("div",{className:"relative overflow-hidden rounded-full w-24 h-24 group",children:r.jsx("img",{src:z0,alt:"CHED Region 9 Logo",className:"w-full h-full object-contain transition-all duration-700 group-hover:scale-110 bg-white",style:{borderRadius:"50%",border:"2px solid #e0e7ef"}})})})]}),r.jsx("h2",{className:"mt-8 text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-900 to-blue-400 text-center transition-all duration-700 delay-200",children:"Welcome Back"}),r.jsx("p",{className:"mt-2 text-blue-700/80 text-center transition-all duration-700 delay-300",children:"Sign in to your account to continue"})]}),i&&r.jsx("div",{className:"mb-6 overflow-hidden rounded-xl animate-fadeIn",children:r.jsx("div",{className:"bg-red-500/20 backdrop-blur-sm border border-red-500/30 text-red-100 p-4 rounded-xl shadow-lg transition-all duration-300 hover:bg-red-500/30",children:r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-red-300",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),r.jsx("div",{className:"ml-3 flex-1",children:r.jsx("p",{className:"text-sm",children:i})}),r.jsx("div",{className:"ml-auto pl-3",children:r.jsx("div",{className:"-mx-1.5 -my-1.5",children:r.jsxs("button",{type:"button",className:"inline-flex rounded-md p-1.5 text-red-300 hover:bg-red-400/20 transition-all duration-300 focus:outline-none",onClick:()=>c(""),children:[r.jsx("span",{className:"sr-only",children:"Dismiss"}),r.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})})]})})}),r.jsxs("form",{onSubmit:O,className:"space-y-6",onFocus:()=>f(!0),onBlur:()=>f(!1),children:[r.jsxs("div",{className:"transition-all duration-500",style:{transitionDelay:`${z()}s`,transform:g?"translateY(0)":"translateY(20px)",opacity:g?1:0},children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-black mb-1",children:"Email Address"}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/50 to-indigo-500/50 rounded-lg opacity-0 group-focus-within:opacity-100 -z-10  transition-all duration-500"}),r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none transition-colors group-focus-within:text-blue-300",children:r.jsx(Dn,{className:"h-5 w-5 text-blue-300 group-focus-within:text-blue-200 transition-colors"})}),r.jsx("input",{id:"email",type:"email",className:"bg-white/90 border border-white/30 text-black text-sm rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 block w-full pl-10 p-4 shadow-lg transition-all placeholder-black",placeholder:"name@example.com",value:s,onChange:P=>e(P.target.value),disabled:l,required:!0,style:{boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)"}})]})]}),r.jsxs("div",{className:"transition-all duration-500",style:{transitionDelay:`${z()+.2}s`,transform:g?"translateY(0)":"translateY(20px)",opacity:g?1:0},children:[r.jsx("div",{className:"flex justify-between",children:r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-black mb-1",children:"Password"})}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-500/50 to-purple-500/50 rounded-lg opacity-0 group-focus-within:opacity-100 -z-10 transition-all duration-500"}),r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(t0,{className:"h-5 w-5 text-blue-300 group-focus-within:text-blue-200 transition-colors"})}),r.jsx("input",{id:"password",type:o?"text":"password",className:"bg-white/90 border border-white/30 text-black text-sm rounded-lg focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500/50 block w-full pl-10 pr-10 p-4 shadow-lg transition-all placeholder-black",placeholder:"",value:a,onChange:P=>n(P.target.value),disabled:l,required:!0,style:{boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)"}}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:F,children:o?r.jsx(MC,{className:"h-5 w-5 text-blue-300 hover:text-blue-200 transition-colors"}):r.jsx(Gs,{className:"h-5 w-5 text-blue-300 hover:text-blue-200 transition-colors"})})]})]}),r.jsxs("div",{className:"pt-2 transition-all duration-500",style:{transitionDelay:`${z()+.4}s`,transform:g?"translateY(0)":"translateY(20px)",opacity:g?1:0},children:[r.jsxs("button",{type:"submit",disabled:l,className:"group w-full relative bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 focus:ring-4 focus:ring-blue-300/50 text-white font-medium rounded-lg text-base px-5 py-4 transition-all duration-300 ease-out disabled:opacity-70 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:-translate-y-1 active:translate-y-0 overflow-hidden",children:[r.jsx("span",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-blue-400 to-indigo-400 opacity-0 group-hover:opacity-100 group-hover:animate-pulse-slow transition-opacity"}),r.jsx("span",{className:"absolute inset-0 w-0 bg-gradient-to-r from-yellow-400/20 to-yellow-400/0 transition-all duration-500 ease-out group-hover:w-full"}),r.jsx("span",{className:"relative flex items-center justify-center",children:l?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r.jsx("span",{children:"Securing access..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(Gl,{className:"h-5 w-5 mr-2"}),r.jsx("span",{children:"Sign in to Dashboard"})]})})]}),x>0&&r.jsx("div",{className:"mt-3 flex justify-center space-x-1",children:Array(x).fill().map((P,U)=>r.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-400/60",style:{animation:`pulse 1.5s infinite ${U*.2}s`}},U))})]})]}),r.jsxs("div",{className:"mt-8 text-center transition-all duration-500",style:{transitionDelay:`${z()+.6}s`,transform:g?"translateY(0)":"translateY(20px)",opacity:g?1:0},children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-0 flex items-center",children:r.jsx("div",{className:"w-full border-t border-black/20"})}),r.jsx("div",{className:"relative flex justify-center text-sm",children:r.jsx("span",{className:"px-2 bg-gradient-to-r from-blue-900/40 to-indigo-900/40 text-black backdrop-blur-sm rounded-md font-semibold",children:"System Information"})})]}),r.jsx("div",{className:"mt-6 flex items-center justify-center",children:r.jsxs("p",{className:"text-sm text-black",children:["Powered by"," ",r.jsxs("a",{href:"https://chedro9.ph",target:"_blank",rel:"noopener noreferrer",className:"text-black hover:text-blue-700 font-medium inline-flex items-center group transition-all duration-300",children:[r.jsxs("span",{className:"relative",children:["CHED Region 9",r.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-px bg-blue-300 transition-all duration-300 group-hover:w-full"})]}),r.jsx(t3,{className:"ml-1 h-3.5 w-3.5 text-black group-hover:text-blue-700 transition-colors"})]})]})})]}),r.jsxs("div",{className:"mt-10 text-center text-xs text-black font-semibold",children:[" ",new Date().getFullYear()," CHED Region IX. All rights reserved."]})]})]})}),r.jsx("style",{children:`
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
          0%, 100% { opacity: 0.6; }
          50% { opacity: 1; }
        }

        @keyframes pulse-slow {
          0%, 100% { opacity: 0; }
          50% { opacity: 0.3; }
        }

        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
        }

        html, body, .font-sans {
          font-family: 'Inter', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, 'sans-serif';
        }
      `})]})},BE=[{label:"Total Users",value:1200},{label:"Active Schools",value:35},{label:"Pending Requests",value:8},{label:"System Uptime (days)",value:99}],DE=()=>r.jsxs("div",{style:{padding:32,fontFamily:"sans-serif"},children:[r.jsx("h1",{children:"Hemis Super Admin Dashboard"}),r.jsx("div",{style:{display:"flex",gap:24,marginTop:32},children:BE.map(t=>r.jsxs("div",{style:{background:"#f4f6fa",borderRadius:8,padding:24,minWidth:180,boxShadow:"0 2px 8px rgba(0,0,0,0.06)",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:32,fontWeight:"bold",color:"#1976d2"},children:t.value}),r.jsx("div",{style:{fontSize:16,color:"#555"},children:t.label})]},t.label))})]});var ca="top",Ka="bottom",Za="right",ua="left",zg="auto",Qu=[ca,Ka,Za,ua],Yl="start",Iu="end",UE="clippingParents",n3="viewport",mu="popper",$E="reference",n2=Qu.reduce(function(t,s){return t.concat([s+"-"+Yl,s+"-"+Iu])},[]),i3=[].concat(Qu,[zg]).reduce(function(t,s){return t.concat([s,s+"-"+Yl,s+"-"+Iu])},[]),zE="beforeRead",HE="read",VE="afterRead",qE="beforeMain",GE="main",YE="afterMain",WE="beforeWrite",XE="write",KE="afterWrite",ZE=[zE,HE,VE,qE,GE,YE,WE,XE,KE];function Un(t){return t?(t.nodeName||"").toLowerCase():null}function Ca(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var s=t.ownerDocument;return s&&s.defaultView||window}return t}function Ho(t){var s=Ca(t).Element;return t instanceof s||t instanceof Element}function Wa(t){var s=Ca(t).HTMLElement;return t instanceof s||t instanceof HTMLElement}function Hg(t){if(typeof ShadowRoot>"u")return!1;var s=Ca(t).ShadowRoot;return t instanceof s||t instanceof ShadowRoot}function QE(t){var s=t.state;Object.keys(s.elements).forEach(function(e){var a=s.styles[e]||{},n=s.attributes[e]||{},i=s.elements[e];!Wa(i)||!Un(i)||(Object.assign(i.style,a),Object.keys(n).forEach(function(c){var l=n[c];l===!1?i.removeAttribute(c):i.setAttribute(c,l===!0?"":l)}))})}function JE(t){var s=t.state,e={popper:{position:s.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(s.elements.popper.style,e.popper),s.styles=e,s.elements.arrow&&Object.assign(s.elements.arrow.style,e.arrow),function(){Object.keys(s.elements).forEach(function(a){var n=s.elements[a],i=s.attributes[a]||{},c=Object.keys(s.styles.hasOwnProperty(a)?s.styles[a]:e[a]),l=c.reduce(function(u,o){return u[o]="",u},{});!Wa(n)||!Un(n)||(Object.assign(n.style,l),Object.keys(i).forEach(function(u){n.removeAttribute(u)}))})}}const e9={name:"applyStyles",enabled:!0,phase:"write",fn:QE,effect:JE,requires:["computeStyles"]};function Pn(t){return t.split("-")[0]}var Lo=Math.max,s0=Math.min,Wl=Math.round;function Qp(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(s){return s.brand+"/"+s.version}).join(" "):navigator.userAgent}function o3(){return!/^((?!chrome|android).)*safari/i.test(Qp())}function Xl(t,s,e){s===void 0&&(s=!1),e===void 0&&(e=!1);var a=t.getBoundingClientRect(),n=1,i=1;s&&Wa(t)&&(n=t.offsetWidth>0&&Wl(a.width)/t.offsetWidth||1,i=t.offsetHeight>0&&Wl(a.height)/t.offsetHeight||1);var c=Ho(t)?Ca(t):window,l=c.visualViewport,u=!o3()&&e,o=(a.left+(u&&l?l.offsetLeft:0))/n,d=(a.top+(u&&l?l.offsetTop:0))/i,g=a.width/n,p=a.height/i;return{width:g,height:p,top:d,right:o+g,bottom:d+p,left:o,x:o,y:d}}function Vg(t){var s=Xl(t),e=t.offsetWidth,a=t.offsetHeight;return Math.abs(s.width-e)<=1&&(e=s.width),Math.abs(s.height-a)<=1&&(a=s.height),{x:t.offsetLeft,y:t.offsetTop,width:e,height:a}}function l3(t,s){var e=s.getRootNode&&s.getRootNode();if(t.contains(s))return!0;if(e&&Hg(e)){var a=s;do{if(a&&t.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function gi(t){return Ca(t).getComputedStyle(t)}function t9(t){return["table","td","th"].indexOf(Un(t))>=0}function no(t){return((Ho(t)?t.ownerDocument:t.document)||window.document).documentElement}function H0(t){return Un(t)==="html"?t:t.assignedSlot||t.parentNode||(Hg(t)?t.host:null)||no(t)}function i2(t){return!Wa(t)||gi(t).position==="fixed"?null:t.offsetParent}function r9(t){var s=/firefox/i.test(Qp()),e=/Trident/i.test(Qp());if(e&&Wa(t)){var a=gi(t);if(a.position==="fixed")return null}var n=H0(t);for(Hg(n)&&(n=n.host);Wa(n)&&["html","body"].indexOf(Un(n))<0;){var i=gi(n);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||s&&i.willChange==="filter"||s&&i.filter&&i.filter!=="none")return n;n=n.parentNode}return null}function Ju(t){for(var s=Ca(t),e=i2(t);e&&t9(e)&&gi(e).position==="static";)e=i2(e);return e&&(Un(e)==="html"||Un(e)==="body"&&gi(e).position==="static")?s:e||r9(t)||s}function qg(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function wu(t,s,e){return Lo(t,s0(s,e))}function s9(t,s,e){var a=wu(t,s,e);return a>e?e:a}function c3(){return{top:0,right:0,bottom:0,left:0}}function u3(t){return Object.assign({},c3(),t)}function d3(t,s){return s.reduce(function(e,a){return e[a]=t,e},{})}var a9=function(s,e){return s=typeof s=="function"?s(Object.assign({},e.rects,{placement:e.placement})):s,u3(typeof s!="number"?s:d3(s,Qu))};function n9(t){var s,e=t.state,a=t.name,n=t.options,i=e.elements.arrow,c=e.modifiersData.popperOffsets,l=Pn(e.placement),u=qg(l),o=[ua,Za].indexOf(l)>=0,d=o?"height":"width";if(!(!i||!c)){var g=a9(n.padding,e),p=Vg(i),h=u==="y"?ca:ua,f=u==="y"?Ka:Za,x=e.rects.reference[d]+e.rects.reference[u]-c[u]-e.rects.popper[d],b=c[u]-e.rects.reference[u],v=Ju(i),_=v?u==="y"?v.clientHeight||0:v.clientWidth||0:0,N=x/2-b/2,E=g[h],O=_-p[d]-g[f],F=_/2-p[d]/2+N,z=wu(E,F,O),P=u;e.modifiersData[a]=(s={},s[P]=z,s.centerOffset=z-F,s)}}function i9(t){var s=t.state,e=t.options,a=e.element,n=a===void 0?"[data-popper-arrow]":a;n!=null&&(typeof n=="string"&&(n=s.elements.popper.querySelector(n),!n)||l3(s.elements.popper,n)&&(s.elements.arrow=n))}const o9={name:"arrow",enabled:!0,phase:"main",fn:n9,effect:i9,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Kl(t){return t.split("-")[1]}var l9={top:"auto",right:"auto",bottom:"auto",left:"auto"};function c9(t,s){var e=t.x,a=t.y,n=s.devicePixelRatio||1;return{x:Wl(e*n)/n||0,y:Wl(a*n)/n||0}}function o2(t){var s,e=t.popper,a=t.popperRect,n=t.placement,i=t.variation,c=t.offsets,l=t.position,u=t.gpuAcceleration,o=t.adaptive,d=t.roundOffsets,g=t.isFixed,p=c.x,h=p===void 0?0:p,f=c.y,x=f===void 0?0:f,b=typeof d=="function"?d({x:h,y:x}):{x:h,y:x};h=b.x,x=b.y;var v=c.hasOwnProperty("x"),_=c.hasOwnProperty("y"),N=ua,E=ca,O=window;if(o){var F=Ju(e),z="clientHeight",P="clientWidth";if(F===Ca(e)&&(F=no(e),gi(F).position!=="static"&&l==="absolute"&&(z="scrollHeight",P="scrollWidth")),F=F,n===ca||(n===ua||n===Za)&&i===Iu){E=Ka;var U=g&&F===O&&O.visualViewport?O.visualViewport.height:F[z];x-=U-a.height,x*=u?1:-1}if(n===ua||(n===ca||n===Ka)&&i===Iu){N=Za;var W=g&&F===O&&O.visualViewport?O.visualViewport.width:F[P];h-=W-a.width,h*=u?1:-1}}var Y=Object.assign({position:l},o&&l9),q=d===!0?c9({x:h,y:x},Ca(e)):{x:h,y:x};if(h=q.x,x=q.y,u){var M;return Object.assign({},Y,(M={},M[E]=_?"0":"",M[N]=v?"0":"",M.transform=(O.devicePixelRatio||1)<=1?"translate("+h+"px, "+x+"px)":"translate3d("+h+"px, "+x+"px, 0)",M))}return Object.assign({},Y,(s={},s[E]=_?x+"px":"",s[N]=v?h+"px":"",s.transform="",s))}function u9(t){var s=t.state,e=t.options,a=e.gpuAcceleration,n=a===void 0?!0:a,i=e.adaptive,c=i===void 0?!0:i,l=e.roundOffsets,u=l===void 0?!0:l,o={placement:Pn(s.placement),variation:Kl(s.placement),popper:s.elements.popper,popperRect:s.rects.popper,gpuAcceleration:n,isFixed:s.options.strategy==="fixed"};s.modifiersData.popperOffsets!=null&&(s.styles.popper=Object.assign({},s.styles.popper,o2(Object.assign({},o,{offsets:s.modifiersData.popperOffsets,position:s.options.strategy,adaptive:c,roundOffsets:u})))),s.modifiersData.arrow!=null&&(s.styles.arrow=Object.assign({},s.styles.arrow,o2(Object.assign({},o,{offsets:s.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),s.attributes.popper=Object.assign({},s.attributes.popper,{"data-popper-placement":s.placement})}const d9={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:u9,data:{}};var _f={passive:!0};function f9(t){var s=t.state,e=t.instance,a=t.options,n=a.scroll,i=n===void 0?!0:n,c=a.resize,l=c===void 0?!0:c,u=Ca(s.elements.popper),o=[].concat(s.scrollParents.reference,s.scrollParents.popper);return i&&o.forEach(function(d){d.addEventListener("scroll",e.update,_f)}),l&&u.addEventListener("resize",e.update,_f),function(){i&&o.forEach(function(d){d.removeEventListener("scroll",e.update,_f)}),l&&u.removeEventListener("resize",e.update,_f)}}const h9={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:f9,data:{}};var m9={left:"right",right:"left",bottom:"top",top:"bottom"};function qf(t){return t.replace(/left|right|bottom|top/g,function(s){return m9[s]})}var p9={start:"end",end:"start"};function l2(t){return t.replace(/start|end/g,function(s){return p9[s]})}function Gg(t){var s=Ca(t),e=s.pageXOffset,a=s.pageYOffset;return{scrollLeft:e,scrollTop:a}}function Yg(t){return Xl(no(t)).left+Gg(t).scrollLeft}function g9(t,s){var e=Ca(t),a=no(t),n=e.visualViewport,i=a.clientWidth,c=a.clientHeight,l=0,u=0;if(n){i=n.width,c=n.height;var o=o3();(o||!o&&s==="fixed")&&(l=n.offsetLeft,u=n.offsetTop)}return{width:i,height:c,x:l+Yg(t),y:u}}function x9(t){var s,e=no(t),a=Gg(t),n=(s=t.ownerDocument)==null?void 0:s.body,i=Lo(e.scrollWidth,e.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),c=Lo(e.scrollHeight,e.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),l=-a.scrollLeft+Yg(t),u=-a.scrollTop;return gi(n||e).direction==="rtl"&&(l+=Lo(e.clientWidth,n?n.clientWidth:0)-i),{width:i,height:c,x:l,y:u}}function Wg(t){var s=gi(t),e=s.overflow,a=s.overflowX,n=s.overflowY;return/auto|scroll|overlay|hidden/.test(e+n+a)}function f3(t){return["html","body","#document"].indexOf(Un(t))>=0?t.ownerDocument.body:Wa(t)&&Wg(t)?t:f3(H0(t))}function Nu(t,s){var e;s===void 0&&(s=[]);var a=f3(t),n=a===((e=t.ownerDocument)==null?void 0:e.body),i=Ca(a),c=n?[i].concat(i.visualViewport||[],Wg(a)?a:[]):a,l=s.concat(c);return n?l:l.concat(Nu(H0(c)))}function Jp(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function b9(t,s){var e=Xl(t,!1,s==="fixed");return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}function c2(t,s,e){return s===n3?Jp(g9(t,e)):Ho(s)?b9(s,e):Jp(x9(no(t)))}function y9(t){var s=Nu(H0(t)),e=["absolute","fixed"].indexOf(gi(t).position)>=0,a=e&&Wa(t)?Ju(t):t;return Ho(a)?s.filter(function(n){return Ho(n)&&l3(n,a)&&Un(n)!=="body"}):[]}function v9(t,s,e,a){var n=s==="clippingParents"?y9(t):[].concat(s),i=[].concat(n,[e]),c=i[0],l=i.reduce(function(u,o){var d=c2(t,o,a);return u.top=Lo(d.top,u.top),u.right=s0(d.right,u.right),u.bottom=s0(d.bottom,u.bottom),u.left=Lo(d.left,u.left),u},c2(t,c,a));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function h3(t){var s=t.reference,e=t.element,a=t.placement,n=a?Pn(a):null,i=a?Kl(a):null,c=s.x+s.width/2-e.width/2,l=s.y+s.height/2-e.height/2,u;switch(n){case ca:u={x:c,y:s.y-e.height};break;case Ka:u={x:c,y:s.y+s.height};break;case Za:u={x:s.x+s.width,y:l};break;case ua:u={x:s.x-e.width,y:l};break;default:u={x:s.x,y:s.y}}var o=n?qg(n):null;if(o!=null){var d=o==="y"?"height":"width";switch(i){case Yl:u[o]=u[o]-(s[d]/2-e[d]/2);break;case Iu:u[o]=u[o]+(s[d]/2-e[d]/2);break}}return u}function Lu(t,s){s===void 0&&(s={});var e=s,a=e.placement,n=a===void 0?t.placement:a,i=e.strategy,c=i===void 0?t.strategy:i,l=e.boundary,u=l===void 0?UE:l,o=e.rootBoundary,d=o===void 0?n3:o,g=e.elementContext,p=g===void 0?mu:g,h=e.altBoundary,f=h===void 0?!1:h,x=e.padding,b=x===void 0?0:x,v=u3(typeof b!="number"?b:d3(b,Qu)),_=p===mu?$E:mu,N=t.rects.popper,E=t.elements[f?_:p],O=v9(Ho(E)?E:E.contextElement||no(t.elements.popper),u,d,c),F=Xl(t.elements.reference),z=h3({reference:F,element:N,placement:n}),P=Jp(Object.assign({},N,z)),U=p===mu?P:F,W={top:O.top-U.top+v.top,bottom:U.bottom-O.bottom+v.bottom,left:O.left-U.left+v.left,right:U.right-O.right+v.right},Y=t.modifiersData.offset;if(p===mu&&Y){var q=Y[n];Object.keys(W).forEach(function(M){var D=[Za,Ka].indexOf(M)>=0?1:-1,T=[ca,Ka].indexOf(M)>=0?"y":"x";W[M]+=q[T]*D})}return W}function _9(t,s){s===void 0&&(s={});var e=s,a=e.placement,n=e.boundary,i=e.rootBoundary,c=e.padding,l=e.flipVariations,u=e.allowedAutoPlacements,o=u===void 0?i3:u,d=Kl(a),g=d?l?n2:n2.filter(function(f){return Kl(f)===d}):Qu,p=g.filter(function(f){return o.indexOf(f)>=0});p.length===0&&(p=g);var h=p.reduce(function(f,x){return f[x]=Lu(t,{placement:x,boundary:n,rootBoundary:i,padding:c})[Pn(x)],f},{});return Object.keys(h).sort(function(f,x){return h[f]-h[x]})}function w9(t){if(Pn(t)===zg)return[];var s=qf(t);return[l2(t),s,l2(s)]}function N9(t){var s=t.state,e=t.options,a=t.name;if(!s.modifiersData[a]._skip){for(var n=e.mainAxis,i=n===void 0?!0:n,c=e.altAxis,l=c===void 0?!0:c,u=e.fallbackPlacements,o=e.padding,d=e.boundary,g=e.rootBoundary,p=e.altBoundary,h=e.flipVariations,f=h===void 0?!0:h,x=e.allowedAutoPlacements,b=s.options.placement,v=Pn(b),_=v===b,N=u||(_||!f?[qf(b)]:w9(b)),E=[b].concat(N).reduce(function(K,re){return K.concat(Pn(re)===zg?_9(s,{placement:re,boundary:d,rootBoundary:g,padding:o,flipVariations:f,allowedAutoPlacements:x}):re)},[]),O=s.rects.reference,F=s.rects.popper,z=new Map,P=!0,U=E[0],W=0;W<E.length;W++){var Y=E[W],q=Pn(Y),M=Kl(Y)===Yl,D=[ca,Ka].indexOf(q)>=0,T=D?"width":"height",C=Lu(s,{placement:Y,boundary:d,rootBoundary:g,altBoundary:p,padding:o}),S=D?M?Za:ua:M?Ka:ca;O[T]>F[T]&&(S=qf(S));var w=qf(S),j=[];if(i&&j.push(C[q]<=0),l&&j.push(C[S]<=0,C[w]<=0),j.every(function(K){return K})){U=Y,P=!1;break}z.set(Y,j)}if(P)for(var A=f?3:1,L=function(re){var G=E.find(function(ae){var V=z.get(ae);if(V)return V.slice(0,re).every(function(H){return H})});if(G)return U=G,"break"},I=A;I>0;I--){var Z=L(I);if(Z==="break")break}s.placement!==U&&(s.modifiersData[a]._skip=!0,s.placement=U,s.reset=!0)}}const j9={name:"flip",enabled:!0,phase:"main",fn:N9,requiresIfExists:["offset"],data:{_skip:!1}};function u2(t,s,e){return e===void 0&&(e={x:0,y:0}),{top:t.top-s.height-e.y,right:t.right-s.width+e.x,bottom:t.bottom-s.height+e.y,left:t.left-s.width-e.x}}function d2(t){return[ca,Za,Ka,ua].some(function(s){return t[s]>=0})}function S9(t){var s=t.state,e=t.name,a=s.rects.reference,n=s.rects.popper,i=s.modifiersData.preventOverflow,c=Lu(s,{elementContext:"reference"}),l=Lu(s,{altBoundary:!0}),u=u2(c,a),o=u2(l,n,i),d=d2(u),g=d2(o);s.modifiersData[e]={referenceClippingOffsets:u,popperEscapeOffsets:o,isReferenceHidden:d,hasPopperEscaped:g},s.attributes.popper=Object.assign({},s.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":g})}const k9={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:S9};function C9(t,s,e){var a=Pn(t),n=[ua,ca].indexOf(a)>=0?-1:1,i=typeof e=="function"?e(Object.assign({},s,{placement:t})):e,c=i[0],l=i[1];return c=c||0,l=(l||0)*n,[ua,Za].indexOf(a)>=0?{x:l,y:c}:{x:c,y:l}}function E9(t){var s=t.state,e=t.options,a=t.name,n=e.offset,i=n===void 0?[0,0]:n,c=i3.reduce(function(d,g){return d[g]=C9(g,s.rects,i),d},{}),l=c[s.placement],u=l.x,o=l.y;s.modifiersData.popperOffsets!=null&&(s.modifiersData.popperOffsets.x+=u,s.modifiersData.popperOffsets.y+=o),s.modifiersData[a]=c}const T9={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:E9};function A9(t){var s=t.state,e=t.name;s.modifiersData[e]=h3({reference:s.rects.reference,element:s.rects.popper,placement:s.placement})}const O9={name:"popperOffsets",enabled:!0,phase:"read",fn:A9,data:{}};function R9(t){return t==="x"?"y":"x"}function M9(t){var s=t.state,e=t.options,a=t.name,n=e.mainAxis,i=n===void 0?!0:n,c=e.altAxis,l=c===void 0?!1:c,u=e.boundary,o=e.rootBoundary,d=e.altBoundary,g=e.padding,p=e.tether,h=p===void 0?!0:p,f=e.tetherOffset,x=f===void 0?0:f,b=Lu(s,{boundary:u,rootBoundary:o,padding:g,altBoundary:d}),v=Pn(s.placement),_=Kl(s.placement),N=!_,E=qg(v),O=R9(E),F=s.modifiersData.popperOffsets,z=s.rects.reference,P=s.rects.popper,U=typeof x=="function"?x(Object.assign({},s.rects,{placement:s.placement})):x,W=typeof U=="number"?{mainAxis:U,altAxis:U}:Object.assign({mainAxis:0,altAxis:0},U),Y=s.modifiersData.offset?s.modifiersData.offset[s.placement]:null,q={x:0,y:0};if(F){if(i){var M,D=E==="y"?ca:ua,T=E==="y"?Ka:Za,C=E==="y"?"height":"width",S=F[E],w=S+b[D],j=S-b[T],A=h?-P[C]/2:0,L=_===Yl?z[C]:P[C],I=_===Yl?-P[C]:-z[C],Z=s.elements.arrow,K=h&&Z?Vg(Z):{width:0,height:0},re=s.modifiersData["arrow#persistent"]?s.modifiersData["arrow#persistent"].padding:c3(),G=re[D],ae=re[T],V=wu(0,z[C],K[C]),H=N?z[C]/2-A-V-G-W.mainAxis:L-V-G-W.mainAxis,Q=N?-z[C]/2+A+V+ae+W.mainAxis:I+V+ae+W.mainAxis,oe=s.elements.arrow&&Ju(s.elements.arrow),se=oe?E==="y"?oe.clientTop||0:oe.clientLeft||0:0,le=(M=Y==null?void 0:Y[E])!=null?M:0,he=S+H-le-se,Ne=S+Q-le,we=wu(h?s0(w,he):w,S,h?Lo(j,Ne):j);F[E]=we,q[E]=we-S}if(l){var ue,Se=E==="x"?ca:ua,ke=E==="x"?Ka:Za,Me=F[O],Oe=O==="y"?"height":"width",je=Me+b[Se],Ie=Me-b[ke],Pe=[ca,ua].indexOf(v)!==-1,He=(ue=Y==null?void 0:Y[O])!=null?ue:0,ct=Pe?je:Me-z[Oe]-P[Oe]-He+W.altAxis,ie=Pe?Me+z[Oe]+P[Oe]-He-W.altAxis:Ie,ee=h&&Pe?s9(ct,Me,ie):wu(h?ct:je,Me,h?ie:Ie);F[O]=ee,q[O]=ee-Me}s.modifiersData[a]=q}}const F9={name:"preventOverflow",enabled:!0,phase:"main",fn:M9,requiresIfExists:["offset"]};function I9(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function L9(t){return t===Ca(t)||!Wa(t)?Gg(t):I9(t)}function P9(t){var s=t.getBoundingClientRect(),e=Wl(s.width)/t.offsetWidth||1,a=Wl(s.height)/t.offsetHeight||1;return e!==1||a!==1}function B9(t,s,e){e===void 0&&(e=!1);var a=Wa(s),n=Wa(s)&&P9(s),i=no(s),c=Xl(t,n,e),l={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(a||!a&&!e)&&((Un(s)!=="body"||Wg(i))&&(l=L9(s)),Wa(s)?(u=Xl(s,!0),u.x+=s.clientLeft,u.y+=s.clientTop):i&&(u.x=Yg(i))),{x:c.left+l.scrollLeft-u.x,y:c.top+l.scrollTop-u.y,width:c.width,height:c.height}}function D9(t){var s=new Map,e=new Set,a=[];t.forEach(function(i){s.set(i.name,i)});function n(i){e.add(i.name);var c=[].concat(i.requires||[],i.requiresIfExists||[]);c.forEach(function(l){if(!e.has(l)){var u=s.get(l);u&&n(u)}}),a.push(i)}return t.forEach(function(i){e.has(i.name)||n(i)}),a}function U9(t){var s=D9(t);return ZE.reduce(function(e,a){return e.concat(s.filter(function(n){return n.phase===a}))},[])}function $9(t){var s;return function(){return s||(s=new Promise(function(e){Promise.resolve().then(function(){s=void 0,e(t())})})),s}}function z9(t){var s=t.reduce(function(e,a){var n=e[a.name];return e[a.name]=n?Object.assign({},n,a,{options:Object.assign({},n.options,a.options),data:Object.assign({},n.data,a.data)}):a,e},{});return Object.keys(s).map(function(e){return s[e]})}var f2={placement:"bottom",modifiers:[],strategy:"absolute"};function h2(){for(var t=arguments.length,s=new Array(t),e=0;e<t;e++)s[e]=arguments[e];return!s.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function H9(t){t===void 0&&(t={});var s=t,e=s.defaultModifiers,a=e===void 0?[]:e,n=s.defaultOptions,i=n===void 0?f2:n;return function(l,u,o){o===void 0&&(o=i);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},f2,i),modifiersData:{},elements:{reference:l,popper:u},attributes:{},styles:{}},g=[],p=!1,h={state:d,setOptions:function(v){var _=typeof v=="function"?v(d.options):v;x(),d.options=Object.assign({},i,d.options,_),d.scrollParents={reference:Ho(l)?Nu(l):l.contextElement?Nu(l.contextElement):[],popper:Nu(u)};var N=U9(z9([].concat(a,d.options.modifiers)));return d.orderedModifiers=N.filter(function(E){return E.enabled}),f(),h.update()},forceUpdate:function(){if(!p){var v=d.elements,_=v.reference,N=v.popper;if(h2(_,N)){d.rects={reference:B9(_,Ju(N),d.options.strategy==="fixed"),popper:Vg(N)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(W){return d.modifiersData[W.name]=Object.assign({},W.data)});for(var E=0;E<d.orderedModifiers.length;E++){if(d.reset===!0){d.reset=!1,E=-1;continue}var O=d.orderedModifiers[E],F=O.fn,z=O.options,P=z===void 0?{}:z,U=O.name;typeof F=="function"&&(d=F({state:d,options:P,name:U,instance:h})||d)}}}},update:$9(function(){return new Promise(function(b){h.forceUpdate(),b(d)})}),destroy:function(){x(),p=!0}};if(!h2(l,u))return h;h.setOptions(o).then(function(b){!p&&o.onFirstUpdate&&o.onFirstUpdate(b)});function f(){d.orderedModifiers.forEach(function(b){var v=b.name,_=b.options,N=_===void 0?{}:_,E=b.effect;if(typeof E=="function"){var O=E({state:d,name:v,instance:h,options:N}),F=function(){};g.push(O||F)}})}function x(){g.forEach(function(b){return b()}),g=[]}return h}}var V9=[h9,O9,d9,e9,T9,j9,F9,o9,k9],q9=H9({defaultModifiers:V9});function ra({trigger:t,children:s,placement:e="bottom-end",offset:a=[0,8],className:n="",onToggle:i=null,closeOnItemClick:c=!0,disabled:l=!1,usePortal:u=!0,smartPositioning:o=!0,isOpen:d=!1,onOpenChange:g=null}){const[p,h]=ne.useState(d),[f,x]=ne.useState({top:0,left:0,placement:e}),b=ne.useRef(null),v=ne.useRef(null),_=ne.useRef(null);ne.useEffect(()=>{h(d)},[d]);const N=ne.useCallback(()=>{if(!b.current||!v.current||!p)return;const z=b.current.getBoundingClientRect(),P=v.current.getBoundingClientRect(),U={width:window.innerWidth,height:window.innerHeight};let W=z.bottom+a[1],Y=z.right-P.width,q=e;if(W+P.height>U.height-10){const M=z.top-P.height-a[1];M>=10?(W=M,q=e.replace("bottom","top")):(W=Math.max(10,Math.min(U.height-P.height-10,z.top)),q="middle-end")}Y+P.width>U.width-10&&(Y=z.left,q=q.replace("end","start")),Y<10&&(Y=10),x(M=>M.top!==W||M.left!==Y||M.placement!==q?{top:W,left:Y,placement:q}:M)},[e,a,p]);ne.useEffect(()=>{if(!p)return;const z=U=>{v.current&&!v.current.contains(U.target)&&b.current&&!b.current.contains(U.target)&&(h(!1),g&&g(!1),i&&i(!1))},P=U=>{U.key==="Escape"&&(h(!1),g&&g(!1),i&&i(!1))};return document.addEventListener("mousedown",z),document.addEventListener("keydown",P),()=>{document.removeEventListener("mousedown",z),document.removeEventListener("keydown",P)}},[p,g,i]),ne.useEffect(()=>{if(!p||!b.current||!v.current){_.current&&(_.current.destroy(),_.current=null);return}if(o){const z=setTimeout(()=>{N()},0);return()=>clearTimeout(z)}else return _.current=q9(b.current,v.current,{placement:e,strategy:u?"fixed":"absolute",modifiers:[{name:"offset",options:{offset:a}},{name:"preventOverflow",options:{boundary:"viewport",padding:8}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-start","top-start"]}}]}),()=>{_.current&&(_.current.destroy(),_.current=null)}},[p,e,u,o]),ne.useEffect(()=>{if(!p||!o)return;let z=null;const P=()=>{z||(z=setTimeout(()=>{N(),z=null},16))};return window.addEventListener("resize",P),window.addEventListener("scroll",P,!0),()=>{z&&clearTimeout(z),window.removeEventListener("resize",P),window.removeEventListener("scroll",P,!0)}},[p,o,N]);const E=ne.useCallback(()=>{if(l)return;const z=!p;h(z),g&&g(z),i&&i(z)},[l,p,g,i]),O=ne.useCallback(()=>{h(!1),g&&g(!1),i&&i(!1)},[g,i]),F=ne.useCallback(z=>{c&&(z.target.closest("[data-no-close]")||O())},[c,O]);return r.jsxs("div",{className:"relative inline-block",children:[r.jsx("div",{ref:b,onClick:E,className:l?"cursor-not-allowed opacity-50":"cursor-pointer",children:typeof t=="function"?t({isOpen:p,toggle:E,close:O}):t}),p&&(u?typeof document<"u"&&Cw.createPortal(r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:O}),r.jsx("div",{ref:v,className:`z-[9999] transition-opacity duration-200 ease-in-out ${n}`,onClick:F,role:"menu","aria-orientation":"vertical",style:{position:u?"fixed":"absolute",zIndex:9999,...o&&{top:`${f.top}px`,left:`${f.left}px`}},children:typeof s=="function"?s({isOpen:p,toggle:E,close:O}):s})]}),document.body):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:O}),r.jsx("div",{ref:v,className:`z-[9999] transition-opacity duration-200 ease-in-out ${n}`,onClick:F,role:"menu","aria-orientation":"vertical",style:{position:u?"fixed":"absolute",zIndex:9999,...o&&{top:`${f.top}px`,left:`${f.left}px`}},children:typeof s=="function"?s({isOpen:p,toggle:E,close:O}):s})]}))]})}ra.propTypes={trigger:B.oneOfType([B.node,B.func]).isRequired,children:B.oneOfType([B.node,B.func]).isRequired,placement:B.oneOf(["auto","auto-start","auto-end","top","top-start","top-end","bottom","bottom-start","bottom-end","right","right-start","right-end","left","left-start","left-end"]),offset:B.arrayOf(B.number),className:B.string,onToggle:B.func,closeOnItemClick:B.bool,disabled:B.bool,usePortal:B.bool,smartPositioning:B.bool,isOpen:B.bool,onOpenChange:B.func};function mr({isOpen:t,onClose:s,title:e,subtitle:a,icon:n,children:i,footer:c,showCloseButton:l=!0,overlayClassName:u="fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center min-h-full w-full z-50 p-4 sm:p-6",containerClassName:o="relative w-full flex flex-col",modalClassName:d="bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 flex flex-col overflow-hidden max-h-[90vh]",headerClassName:g="bg-gradient-to-r from-blue-600 to-blue-700 p-4 sm:p-6 text-white flex-shrink-0",headerContentClassName:p="flex justify-between items-center",iconContainerClassName:h="h-10 w-10 sm:h-12 sm:w-12 bg-white/20 rounded-xl flex items-center justify-center mr-3 sm:mr-4 flex-shrink-0",iconClassName:f="w-5 h-5 sm:w-6 sm:h-6",titleContainerClassName:x="min-w-0 flex-1",titleClassName:b="text-lg sm:text-xl font-bold truncate",subtitleClassName:v="text-blue-100 text-sm hidden sm:block",closeButtonClassName:_="text-white/80 hover:text-white hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/20 rounded-lg p-1.5 sm:p-2 transition-all duration-200 flex-shrink-0",closeIconClassName:N="w-5 h-5 sm:w-6 sm:h-6",contentClassName:E="flex-1 min-h-0 relative overflow-y-auto",footerClassName:O="border-t border-gray-200 p-4 sm:p-6 flex-shrink-0",variant:F="default",size:z="default"}){if(!t)return null;const P={default:{header:"bg-gradient-to-r from-blue-600 to-blue-700 text-white",modal:"bg-white/90 backdrop-blur-md",iconContainer:"bg-white/20",subtitle:"text-blue-100",closeButton:"text-white/80 hover:text-white hover:bg-white/10"},success:{header:"bg-gradient-to-r from-green-600 to-green-700 text-white",modal:"bg-white/90 backdrop-blur-md",iconContainer:"bg-white/20",subtitle:"text-green-100",closeButton:"text-white/80 hover:text-white hover:bg-white/10"},warning:{header:"bg-gradient-to-r from-amber-600 to-amber-700 text-white",modal:"bg-white/90 backdrop-blur-md",iconContainer:"bg-white/20",subtitle:"text-amber-100",closeButton:"text-white/80 hover:text-white hover:bg-white/10"},danger:{header:"bg-gradient-to-r from-red-600 to-red-700 text-white",modal:"bg-white/90 backdrop-blur-md",iconContainer:"bg-white/20",subtitle:"text-red-100",closeButton:"text-white/80 hover:text-white hover:bg-white/10"},dark:{header:"bg-gradient-to-r from-gray-800 to-gray-900 text-white",modal:"bg-gray-900/95 backdrop-blur-md text-white",iconContainer:"bg-white/10",subtitle:"text-gray-300",closeButton:"text-gray-300 hover:text-white hover:bg-white/10"},minimal:{header:"bg-white border-b border-gray-200 text-gray-900",modal:"bg-white",iconContainer:"bg-gray-100",subtitle:"text-gray-600",closeButton:"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}},U={xs:"max-w-sm max-h-[80vh]",sm:"max-w-md max-h-[85vh]",default:"max-w-2xl max-h-[90vh]",lg:"max-w-4xl max-h-[90vh]",xl:"max-w-6xl max-h-[95vh]",full:"max-w-full max-h-[95vh] mx-4"},W=P[F]||P.default,Y=U[z]||U.default,q=(M,D,T="")=>D!==M?D:T?`${M.replace(/bg-gradient-to-r from-\w+-\d+ to-\w+-\d+|bg-\w+\/\d+|text-\w+|bg-\w+-\d+/,"")} ${T}`.trim():M;return r.jsx("div",{className:u,children:r.jsx("div",{className:`${o} ${Y}`,children:r.jsxs("div",{className:q(d,d,W.modal),children:[r.jsx("div",{className:q(g,g,W.header),children:r.jsxs("div",{className:p,children:[r.jsxs("div",{className:"flex items-center min-w-0 flex-1 mr-4",children:[n&&r.jsx("div",{className:q(h,h,W.iconContainer),children:r.jsx(n,{className:f})}),r.jsxs("div",{className:x,children:[r.jsx("h3",{className:b,children:e}),a&&r.jsx("p",{className:q(v,v,W.subtitle),children:a})]})]}),l&&r.jsx("button",{onClick:s,className:q(_,_,W.closeButton),"aria-label":"Close dialog",children:r.jsx(vs,{className:N})})]})}),r.jsx("div",{className:E,children:r.jsxs("div",{className:"h-full overflow-y-auto overflow-x-hidden",children:[r.jsx("style",{children:`
                                .scroll-content::-webkit-scrollbar {
                                    width: 8px;
                                }
                                .scroll-content::-webkit-scrollbar-track {
                                    background: rgba(0, 0, 0, 0.05);
                                    border-radius: 4px;
                                }
                                .scroll-content::-webkit-scrollbar-thumb {
                                    background: linear-gradient(to bottom, rgba(59, 130, 246, 0.6), rgba(37, 99, 235, 0.8));
                                    border-radius: 4px;
                                    border: 1px solid rgba(255, 255, 255, 0.2);
                                }
                                .scroll-content::-webkit-scrollbar-thumb:hover {
                                    background: linear-gradient(to bottom, rgba(59, 130, 246, 0.8), rgba(37, 99, 235, 1));
                                }
                                /* For Firefox */
                                .scroll-content {
                                    scrollbar-width: thin;
                                    scrollbar-color: rgba(59, 130, 246, 0.6) rgba(0, 0, 0, 0.05);
                                }
                            `}),r.jsx("div",{className:"scroll-content h-full overflow-y-auto overflow-x-hidden",children:i}),r.jsx("div",{className:"absolute top-0 left-0 right-0 h-4 bg-gradient-to-b from-white/80 to-transparent pointer-events-none opacity-0 transition-opacity duration-300",id:"scroll-top-indicator"}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-4 bg-gradient-to-t from-white/80 to-transparent pointer-events-none opacity-0 transition-opacity duration-300",id:"scroll-bottom-indicator"})]})}),c&&r.jsx("div",{className:O,children:c})]})})})}mr.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,title:B.string.isRequired,subtitle:B.string,icon:B.elementType,children:B.node,footer:B.node,showCloseButton:B.bool,overlayClassName:B.string,containerClassName:B.string,modalClassName:B.string,headerClassName:B.string,headerContentClassName:B.string,iconContainerClassName:B.string,iconClassName:B.string,titleContainerClassName:B.string,titleClassName:B.string,subtitleClassName:B.string,closeButtonClassName:B.string,closeIconClassName:B.string,contentClassName:B.string,footerClassName:B.string,variant:B.oneOf(["default","success","warning","danger","dark","minimal"]),size:B.oneOf(["xs","sm","default","lg","xl","full"])};mr.defaultProps={showCloseButton:!0,overlayClassName:"fixed inset-0 bg-black/20 backdrop-blur-sm overflow-y-auto h-full w-full z-50 p-4 sm:p-6 flex items-center justify-center",containerClassName:"relative w-full flex flex-col",modalClassName:"bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 flex flex-col overflow-hidden max-h-[90vh]",headerClassName:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 sm:p-6 text-white flex-shrink-0",headerContentClassName:"flex justify-between items-center",iconContainerClassName:"h-10 w-10 sm:h-12 sm:w-12 bg-white/20 rounded-xl flex items-center justify-center mr-3 sm:mr-4 flex-shrink-0",iconClassName:"w-5 h-5 sm:w-6 sm:h-6",titleContainerClassName:"min-w-0 flex-1",titleClassName:"text-lg sm:text-xl font-bold truncate",subtitleClassName:"text-blue-100 text-sm hidden sm:block",closeButtonClassName:"text-white/80 hover:text-white hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/20 rounded-lg p-1.5 sm:p-2 transition-all duration-200 flex-shrink-0",closeIconClassName:"w-5 h-5 sm:w-6 sm:h-6",contentClassName:"flex-1 min-h-0 relative overflow-y-auto",footerClassName:"border-t border-gray-200 p-4 sm:p-6 flex-shrink-0",variant:"default",size:"default"};function m3({isOpen:t,onClose:s,programData:e}){if(!e)return null;const a=h=>h?new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(h):"0.00",n=()=>["1st_year_male","1st_year_female","2nd_year_male","2nd_year_female","3rd_year_male","3rd_year_female","4th_year_male","4th_year_female","5th_year_male","5th_year_female","6th_year_male","6th_year_female","7th_year_male","7th_year_female"].reduce((f,x)=>f+(Number(e[x])||0),0),i=()=>["1st_year_male","2nd_year_male","3rd_year_male","4th_year_male","5th_year_male","6th_year_male","7th_year_male"].reduce((f,x)=>f+(Number(e[x])||0),0),c=()=>["1st_year_female","2nd_year_female","3rd_year_female","4th_year_female","5th_year_female","6th_year_female","7th_year_female"].reduce((f,x)=>f+(Number(e[x])||0),0),l=()=>[{year:"1st Year",male:Number(e["1st_year_male"])||0,female:Number(e["1st_year_female"])||0},{year:"2nd Year",male:Number(e["2nd_year_male"])||0,female:Number(e["2nd_year_female"])||0},{year:"3rd Year",male:Number(e["3rd_year_male"])||0,female:Number(e["3rd_year_female"])||0},{year:"4th Year",male:Number(e["4th_year_male"])||0,female:Number(e["4th_year_female"])||0},{year:"5th Year",male:Number(e["5th_year_male"])||0,female:Number(e["5th_year_female"])||0},{year:"6th Year",male:Number(e["6th_year_male"])||0,female:Number(e["6th_year_female"])||0},{year:"7th Year",male:Number(e["7th_year_male"])||0,female:Number(e["7th_year_female"])||0}].filter(f=>f.male>0||f.female>0),u=h=>{switch(h==null?void 0:h.toLowerCase()){case"undergraduate":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border-blue-300";case"graduate":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border-purple-300";case"doctoral":return"bg-gradient-to-r from-emerald-100 to-emerald-200 text-emerald-800 border-emerald-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border-gray-300"}},o=h=>({SEM:"Semester",TRI:"Trimester",QTR:"Quarter",ANN:"Annual",MOD:"Modular"})[h]||String(h)||"Not specified",d=h=>({ACTIVE:{label:"Active",color:"bg-green-100 text-green-800 border-green-300"},INACTIVE:{label:"Inactive",color:"bg-red-100 text-red-800 border-red-300"},SUSPENDED:{label:"Suspended",color:"bg-yellow-100 text-yellow-800 border-yellow-300"},PHASED_OUT:{label:"Phased Out",color:"bg-gray-100 text-gray-800 border-gray-300"}})[h]||{label:String(h)||"Unknown",color:"bg-gray-100 text-gray-800 border-gray-300"},g=(h,f="Not specified")=>h==null||h===""?f:typeof h=="object"?String(h)||f:String(h),p=(h,f=0)=>{const x=Number(h);return isNaN(x)?f:x};return r.jsx(mr,{isOpen:t,onClose:s,title:g(e.program_name,"Program Details"),subtitle:"Academic Program Information",icon:Gs,variant:"view",size:"xl",children:r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Program Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Program Name"}),r.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:g(e.program_name)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Program Code"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.program_code,"Not assigned")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Major/Specialization"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.major_name,"No major specified")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Major Code"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.major_code,"Not assigned")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Type & Status"}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full border ${u(e.program_type)}`,children:g(e.program_type,"Unknown Type")}),r.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full border ${d(e.program_status).color}`,children:d(e.program_status).label}),e.is_thesis_dissertation_required&&r.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800 border border-purple-300",children:"Thesis Required"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Academic Details"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"AOP Category"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.aop_category)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"AOP Serial"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.aop_serial,"Not assigned")})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Program Length"]}),r.jsxs("p",{className:"text-sm text-gray-900",children:[p(e.program_normal_length_in_years)," years"]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[r.jsx(Xa,{className:"w-4 h-4 inline mr-1"}),"Calendar System"]}),r.jsx("p",{className:"text-sm text-gray-900",children:o(e.calendar_use_code)})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Units Distribution"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lecture"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.lecture_units)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lab"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.lab_units)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border border-emerald-300",children:[r.jsx("div",{className:"text-xs text-emerald-600",children:"Total"}),r.jsx("div",{className:"text-sm font-semibold text-emerald-900",children:p(e.total_units)})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(bn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Financial Information"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tuition per Unit"}),r.jsx("p",{className:"text-lg font-semibold text-purple-900",children:a(e.tuition_per_unit)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Program Fee"}),r.jsx("p",{className:"text-lg font-semibold text-purple-900",children:a(e.program_fee)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estimated Total Cost"}),r.jsxs("p",{className:"text-sm text-gray-600",children:["(",p(e.total_units)," units  ",a(e.tuition_per_unit)," + ",a(e.program_fee),")"]}),r.jsx("p",{className:"text-xl font-bold text-purple-900",children:a(p(e.total_units)*p(e.tuition_per_unit)+p(e.program_fee))})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Enrollment Statistics"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Total Male"}),r.jsx("div",{className:"text-xl font-bold text-blue-600",children:i()})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Total Female"}),r.jsx("div",{className:"text-xl font-bold text-pink-600",children:c()})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border border-amber-300",children:[r.jsx("div",{className:"text-xs text-amber-600",children:"Total Enrollment"}),r.jsx("div",{className:"text-xl font-bold text-amber-900",children:n()})]})]}),l().length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year-wise Distribution"}),r.jsx("div",{className:"space-y-2",children:l().map((h,f)=>r.jsxs("div",{className:"flex items-center justify-between bg-white/60 rounded-lg p-2 border",children:[r.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.year}),r.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[r.jsxs("span",{className:"text-blue-600",children:["M: ",h.male]}),r.jsxs("span",{className:"text-pink-600",children:["F: ",h.female]}),r.jsxs("span",{className:"font-semibold text-gray-900",children:["Total: ",h.male+h.female]})]})]},f))})]}),(p(e.new_students_freshmen_male)>0||p(e.new_students_freshmen_female)>0)&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Freshmen Students"}),r.jsxs("div",{className:"flex justify-between bg-white/60 rounded-lg p-2 border border-green-300",children:[r.jsxs("span",{className:"text-sm text-green-600",children:["Male: ",p(e.new_students_freshmen_male)]}),r.jsxs("span",{className:"text-sm text-green-600",children:["Female: ",p(e.new_students_freshmen_female)]}),r.jsxs("span",{className:"text-sm font-semibold text-green-900",children:["Total: ",p(e.new_students_freshmen_male)+p(e.new_students_freshmen_female)]})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(Zr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduates"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Male"}),r.jsx("div",{className:"text-lg font-semibold text-slate-900",children:p(e.graduates_males)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Female"}),r.jsx("div",{className:"text-lg font-semibold text-slate-900",children:p(e.graduates_females)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border border-slate-300",children:[r.jsx("div",{className:"text-xs text-slate-600",children:"Total"}),r.jsx("div",{className:"text-lg font-bold text-slate-900",children:p(e.graduates_total)})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Actual Units Taken"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mt-1",children:[r.jsxs("div",{className:"bg-white/60 rounded p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lecture"}),r.jsx("div",{className:"text-sm font-semibold",children:p(e.lecture_units_actual)})]}),r.jsxs("div",{className:"bg-white/60 rounded p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lab"}),r.jsx("div",{className:"text-sm font-semibold",children:p(e.laboratory_units_actual)})]}),r.jsxs("div",{className:"bg-white/60 rounded p-2 border border-slate-300",children:[r.jsx("div",{className:"text-xs text-slate-600",children:"Total"}),r.jsx("div",{className:"text-sm font-semibold",children:p(e.total_units_actual)})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-cyan-100 rounded-xl p-4 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-indigo-500 rounded-lg shadow-sm",children:r.jsx(Qo,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Scholarships & Aid"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"External Merit Scholars"}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"text-2xl font-bold text-indigo-900",children:p(e.externally_funded_merit_scholars)}),r.jsx("div",{className:"text-xs text-gray-600",children:"Students with external scholarships"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Internal Grantees"}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"text-2xl font-bold text-indigo-900",children:p(e.internally_funded_grantees)}),r.jsx("div",{className:"text-xs text-gray-600",children:"Students with institutional aid"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Funded Students"}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border border-indigo-300",children:[r.jsx("div",{className:"text-2xl font-bold text-indigo-900",children:p(e.funded_grantees)}),r.jsx("div",{className:"text-xs text-indigo-600",children:"All scholarship recipients"})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-gray-50 to-slate-100 rounded-xl p-4 border border-gray-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-gray-600 rounded-lg shadow-sm",children:r.jsx(ys,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Additional Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"AOP Year"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.aop_year)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Report Year"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.report_year.year)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subtotal Male Students"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.subtotal_male,"Auto-calculated")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subtotal Female Students"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.subtotal_female,"Auto-calculated")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Grand Total Enrollment"}),r.jsx("p",{className:"text-lg font-semibold text-gray-900",children:g(e.grand_total,n().toString())})]})]})]})]})})}m3.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,programData:B.shape({id:B.oneOfType([B.string,B.number]),program_name:B.string,program_code:B.oneOfType([B.string,B.number]),major_name:B.string,major_code:B.oneOfType([B.string,B.number]),aop_category:B.string,aop_serial:B.string,aop_year:B.oneOfType([B.string,B.number]),is_thesis_dissertation_required:B.bool,program_status:B.string,calendar_use_code:B.string,program_normal_length_in_years:B.oneOfType([B.string,B.number]),lab_units:B.oneOfType([B.string,B.number]),lecture_units:B.oneOfType([B.string,B.number]),total_units:B.oneOfType([B.string,B.number]),tuition_per_unit:B.oneOfType([B.string,B.number]),program_fee:B.oneOfType([B.string,B.number]),program_type:B.string,new_students_freshmen_male:B.oneOfType([B.string,B.number]),new_students_freshmen_female:B.oneOfType([B.string,B.number]),"1st_year_male":B.oneOfType([B.string,B.number]),"1st_year_female":B.oneOfType([B.string,B.number]),"2nd_year_male":B.oneOfType([B.string,B.number]),"2nd_year_female":B.oneOfType([B.string,B.number]),"3rd_year_male":B.oneOfType([B.string,B.number]),"3rd_year_female":B.oneOfType([B.string,B.number]),"4th_year_male":B.oneOfType([B.string,B.number]),"4th_year_female":B.oneOfType([B.string,B.number]),"5th_year_male":B.oneOfType([B.string,B.number]),"5th_year_female":B.oneOfType([B.string,B.number]),"6th_year_male":B.oneOfType([B.string,B.number]),"6th_year_female":B.oneOfType([B.string,B.number]),"7th_year_male":B.oneOfType([B.string,B.number]),"7th_year_female":B.oneOfType([B.string,B.number]),subtotal_male:B.oneOfType([B.string,B.number]),subtotal_female:B.oneOfType([B.string,B.number]),grand_total:B.oneOfType([B.string,B.number]),lecture_units_actual:B.oneOfType([B.string,B.number]),laboratory_units_actual:B.oneOfType([B.string,B.number]),total_units_actual:B.oneOfType([B.string,B.number]),graduates_males:B.oneOfType([B.string,B.number]),graduates_females:B.oneOfType([B.string,B.number]),graduates_total:B.oneOfType([B.string,B.number]),externally_funded_merit_scholars:B.oneOfType([B.string,B.number]),internally_funded_grantees:B.oneOfType([B.string,B.number]),funded_grantees:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number])})};/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function p3(t,s,e){if(typeof t=="function"?t===s:t.has(s))return arguments.length<3?s:e;throw new TypeError("Private element is not present on this object")}function G9(t,s){if(s.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m2(t,s){return t.get(p3(t,s))}function Y9(t,s,e){G9(t,s),s.set(t,e)}function W9(t,s,e){return t.set(p3(t,s),e),e}const X9=100,Pt={},K9=()=>{Pt.previousActiveElement instanceof HTMLElement?(Pt.previousActiveElement.focus(),Pt.previousActiveElement=null):document.body&&document.body.focus()},Z9=t=>new Promise(s=>{if(!t)return s();const e=window.scrollX,a=window.scrollY;Pt.restoreFocusTimeout=setTimeout(()=>{K9(),s()},X9),window.scrollTo(e,a)}),g3="swal2-",Q9=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],Je=Q9.reduce((t,s)=>(t[s]=g3+s,t),{}),J9=["success","warning","info","question","error"],a0=J9.reduce((t,s)=>(t[s]=g3+s,t),{}),x3="SweetAlert2:",Xg=t=>t.charAt(0).toUpperCase()+t.slice(1),ea=t=>{console.warn(`${x3} ${typeof t=="object"?t.join(" "):t}`)},Jo=t=>{console.error(`${x3} ${t}`)},p2=[],eT=t=>{p2.includes(t)||(p2.push(t),ea(t))},b3=function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;eT(`"${t}" is deprecated and will be removed in the next major release.${s?` Use "${s}" instead.`:""}`)},V0=t=>typeof t=="function"?t():t,Kg=t=>t&&typeof t.toPromise=="function",ed=t=>Kg(t)?t.toPromise():Promise.resolve(t),Zg=t=>t&&Promise.resolve(t)===t,sa=()=>document.body.querySelector(`.${Je.container}`),td=t=>{const s=sa();return s?s.querySelector(t):null},Oa=t=>td(`.${t}`),yr=()=>Oa(Je.popup),lc=()=>Oa(Je.icon),tT=()=>Oa(Je["icon-content"]),y3=()=>Oa(Je.title),Qg=()=>Oa(Je["html-container"]),v3=()=>Oa(Je.image),Jg=()=>Oa(Je["progress-steps"]),q0=()=>Oa(Je["validation-message"]),$n=()=>td(`.${Je.actions} .${Je.confirm}`),cc=()=>td(`.${Je.actions} .${Je.cancel}`),el=()=>td(`.${Je.actions} .${Je.deny}`),rT=()=>Oa(Je["input-label"]),uc=()=>td(`.${Je.loader}`),rd=()=>Oa(Je.actions),_3=()=>Oa(Je.footer),G0=()=>Oa(Je["timer-progress-bar"]),ex=()=>Oa(Je.close),sT=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,tx=()=>{const t=yr();if(!t)return[];const s=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),e=Array.from(s).sort((i,c)=>{const l=parseInt(i.getAttribute("tabindex")||"0"),u=parseInt(c.getAttribute("tabindex")||"0");return l>u?1:l<u?-1:0}),a=t.querySelectorAll(sT),n=Array.from(a).filter(i=>i.getAttribute("tabindex")!=="-1");return[...new Set(e.concat(n))].filter(i=>da(i))},rx=()=>di(document.body,Je.shown)&&!di(document.body,Je["toast-shown"])&&!di(document.body,Je["no-backdrop"]),Y0=()=>{const t=yr();return t?di(t,Je.toast):!1},aT=()=>{const t=yr();return t?t.hasAttribute("data-loading"):!1},Ra=(t,s)=>{if(t.textContent="",s){const a=new DOMParser().parseFromString(s,"text/html"),n=a.querySelector("head");n&&Array.from(n.childNodes).forEach(c=>{t.appendChild(c)});const i=a.querySelector("body");i&&Array.from(i.childNodes).forEach(c=>{c instanceof HTMLVideoElement||c instanceof HTMLAudioElement?t.appendChild(c.cloneNode(!0)):t.appendChild(c)})}},di=(t,s)=>{if(!s)return!1;const e=s.split(/\s+/);for(let a=0;a<e.length;a++)if(!t.classList.contains(e[a]))return!1;return!0},nT=(t,s)=>{Array.from(t.classList).forEach(e=>{!Object.values(Je).includes(e)&&!Object.values(a0).includes(e)&&!Object.values(s.showClass||{}).includes(e)&&t.classList.remove(e)})},Ea=(t,s,e)=>{if(nT(t,s),!s.customClass)return;const a=s.customClass[e];if(a){if(typeof a!="string"&&!a.forEach){ea(`Invalid type of customClass.${e}! Expected string or iterable object, got "${typeof a}"`);return}wr(t,a)}},W0=(t,s)=>{if(!s)return null;switch(s){case"select":case"textarea":case"file":return t.querySelector(`.${Je.popup} > .${Je[s]}`);case"checkbox":return t.querySelector(`.${Je.popup} > .${Je.checkbox} input`);case"radio":return t.querySelector(`.${Je.popup} > .${Je.radio} input:checked`)||t.querySelector(`.${Je.popup} > .${Je.radio} input:first-child`);case"range":return t.querySelector(`.${Je.popup} > .${Je.range} input`);default:return t.querySelector(`.${Je.popup} > .${Je.input}`)}},w3=t=>{if(t.focus(),t.type!=="file"){const s=t.value;t.value="",t.value=s}},N3=(t,s,e)=>{!t||!s||(typeof s=="string"&&(s=s.split(/\s+/).filter(Boolean)),s.forEach(a=>{Array.isArray(t)?t.forEach(n=>{e?n.classList.add(a):n.classList.remove(a)}):e?t.classList.add(a):t.classList.remove(a)}))},wr=(t,s)=>{N3(t,s,!0)},Qa=(t,s)=>{N3(t,s,!1)},Wi=(t,s)=>{const e=Array.from(t.children);for(let a=0;a<e.length;a++){const n=e[a];if(n instanceof HTMLElement&&di(n,s))return n}},Po=(t,s,e)=>{e===`${parseInt(e)}`&&(e=parseInt(e)),e||parseInt(e)===0?t.style.setProperty(s,typeof e=="number"?`${e}px`:e):t.style.removeProperty(s)},_s=function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=s)},Hs=t=>{t&&(t.style.display="none")},sx=function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{sd(t,t.innerHTML,s)}).observe(t,{childList:!0,subtree:!0})},g2=(t,s,e,a)=>{const n=t.querySelector(s);n&&n.style.setProperty(e,a)},sd=function(t,s){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";s?_s(t,e):Hs(t)},da=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),iT=()=>!da($n())&&!da(el())&&!da(cc()),x2=t=>t.scrollHeight>t.clientHeight,j3=t=>{const s=window.getComputedStyle(t),e=parseFloat(s.getPropertyValue("animation-duration")||"0"),a=parseFloat(s.getPropertyValue("transition-duration")||"0");return e>0||a>0},ax=function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const e=G0();e&&da(e)&&(s&&(e.style.transition="none",e.style.width="100%"),setTimeout(()=>{e.style.transition=`width ${t/1e3}s linear`,e.style.width="0%"},10))},oT=()=>{const t=G0();if(!t)return;const s=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const e=parseInt(window.getComputedStyle(t).width),a=s/e*100;t.style.width=`${a}%`},lT=()=>typeof window>"u"||typeof document>"u",cT=`
 <div aria-labelledby="${Je.title}" aria-describedby="${Je["html-container"]}" class="${Je.popup}" tabindex="-1">
   <button type="button" class="${Je.close}"></button>
   <ul class="${Je["progress-steps"]}"></ul>
   <div class="${Je.icon}"></div>
   <img class="${Je.image}" />
   <h2 class="${Je.title}" id="${Je.title}"></h2>
   <div class="${Je["html-container"]}" id="${Je["html-container"]}"></div>
   <input class="${Je.input}" id="${Je.input}" />
   <input type="file" class="${Je.file}" />
   <div class="${Je.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${Je.select}" id="${Je.select}"></select>
   <div class="${Je.radio}"></div>
   <label class="${Je.checkbox}">
     <input type="checkbox" id="${Je.checkbox}" />
     <span class="${Je.label}"></span>
   </label>
   <textarea class="${Je.textarea}" id="${Je.textarea}"></textarea>
   <div class="${Je["validation-message"]}" id="${Je["validation-message"]}"></div>
   <div class="${Je.actions}">
     <div class="${Je.loader}"></div>
     <button type="button" class="${Je.confirm}"></button>
     <button type="button" class="${Je.deny}"></button>
     <button type="button" class="${Je.cancel}"></button>
   </div>
   <div class="${Je.footer}"></div>
   <div class="${Je["timer-progress-bar-container"]}">
     <div class="${Je["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),uT=()=>{const t=sa();return t?(t.remove(),Qa([document.documentElement,document.body],[Je["no-backdrop"],Je["toast-shown"],Je["has-column"]]),!0):!1},Oo=()=>{Pt.currentInstance.resetValidationMessage()},dT=()=>{const t=yr(),s=Wi(t,Je.input),e=Wi(t,Je.file),a=t.querySelector(`.${Je.range} input`),n=t.querySelector(`.${Je.range} output`),i=Wi(t,Je.select),c=t.querySelector(`.${Je.checkbox} input`),l=Wi(t,Je.textarea);s.oninput=Oo,e.onchange=Oo,i.onchange=Oo,c.onchange=Oo,l.oninput=Oo,a.oninput=()=>{Oo(),n.value=a.value},a.onchange=()=>{Oo(),n.value=a.value}},fT=t=>typeof t=="string"?document.querySelector(t):t,hT=t=>{const s=yr();s.setAttribute("role",t.toast?"alert":"dialog"),s.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||s.setAttribute("aria-modal","true")},mT=t=>{window.getComputedStyle(t).direction==="rtl"&&wr(sa(),Je.rtl)},pT=t=>{const s=uT();if(lT()){Jo("SweetAlert2 requires document to initialize");return}const e=document.createElement("div");e.className=Je.container,s&&wr(e,Je["no-transition"]),Ra(e,cT),e.dataset.swal2Theme=t.theme;const a=fT(t.target);a.appendChild(e),t.topLayer&&(e.setAttribute("popover",""),e.showPopover()),hT(t),mT(a),dT()},nx=(t,s)=>{t instanceof HTMLElement?s.appendChild(t):typeof t=="object"?gT(t,s):t&&Ra(s,t)},gT=(t,s)=>{t.jquery?xT(s,t):Ra(s,t.toString())},xT=(t,s)=>{if(t.textContent="",0 in s)for(let e=0;e in s;e++)t.appendChild(s[e].cloneNode(!0));else t.appendChild(s.cloneNode(!0))},bT=(t,s)=>{const e=rd(),a=uc();!e||!a||(!s.showConfirmButton&&!s.showDenyButton&&!s.showCancelButton?Hs(e):_s(e),Ea(e,s,"actions"),yT(e,a,s),Ra(a,s.loaderHtml||""),Ea(a,s,"loader"))};function yT(t,s,e){const a=$n(),n=el(),i=cc();!a||!n||!i||(vp(a,"confirm",e),vp(n,"deny",e),vp(i,"cancel",e),vT(a,n,i,e),e.reverseButtons&&(e.toast?(t.insertBefore(i,a),t.insertBefore(n,a)):(t.insertBefore(i,s),t.insertBefore(n,s),t.insertBefore(a,s))))}function vT(t,s,e,a){if(!a.buttonsStyling){Qa([t,s,e],Je.styled);return}wr([t,s,e],Je.styled),a.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",a.confirmButtonColor),a.denyButtonColor&&s.style.setProperty("--swal2-deny-button-background-color",a.denyButtonColor),a.cancelButtonColor&&e.style.setProperty("--swal2-cancel-button-background-color",a.cancelButtonColor),yp(t),yp(s),yp(e)}function yp(t){const s=window.getComputedStyle(t),e=s.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",s.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${e}`))}function vp(t,s,e){const a=Xg(s);sd(t,e[`show${a}Button`],"inline-block"),Ra(t,e[`${s}ButtonText`]||""),t.setAttribute("aria-label",e[`${s}ButtonAriaLabel`]||""),t.className=Je[s],Ea(t,e,`${s}Button`)}const _T=(t,s)=>{const e=ex();e&&(Ra(e,s.closeButtonHtml||""),Ea(e,s,"closeButton"),sd(e,s.showCloseButton),e.setAttribute("aria-label",s.closeButtonAriaLabel||""))},wT=(t,s)=>{const e=sa();e&&(NT(e,s.backdrop),jT(e,s.position),ST(e,s.grow),Ea(e,s,"container"))};function NT(t,s){typeof s=="string"?t.style.background=s:s||wr([document.documentElement,document.body],Je["no-backdrop"])}function jT(t,s){s&&(s in Je?wr(t,Je[s]):(ea('The "position" parameter is not valid, defaulting to "center"'),wr(t,Je.center)))}function ST(t,s){s&&wr(t,Je[`grow-${s}`])}var Rr={innerParams:new WeakMap,domCache:new WeakMap};const kT=["input","file","range","select","radio","checkbox","textarea"],CT=(t,s)=>{const e=yr();if(!e)return;const a=Rr.innerParams.get(t),n=!a||s.input!==a.input;kT.forEach(i=>{const c=Wi(e,Je[i]);c&&(AT(i,s.inputAttributes),c.className=Je[i],n&&Hs(c))}),s.input&&(n&&ET(s),OT(s))},ET=t=>{if(!t.input)return;if(!Kr[t.input]){Jo(`Unexpected type of input! Expected ${Object.keys(Kr).join(" | ")}, got "${t.input}"`);return}const s=S3(t.input);if(!s)return;const e=Kr[t.input](s,t);_s(s),t.inputAutoFocus&&setTimeout(()=>{w3(e)})},TT=t=>{for(let s=0;s<t.attributes.length;s++){const e=t.attributes[s].name;["id","type","value","style"].includes(e)||t.removeAttribute(e)}},AT=(t,s)=>{const e=yr();if(!e)return;const a=W0(e,t);if(a){TT(a);for(const n in s)a.setAttribute(n,s[n])}},OT=t=>{if(!t.input)return;const s=S3(t.input);s&&Ea(s,t,"input")},ix=(t,s)=>{!t.placeholder&&s.inputPlaceholder&&(t.placeholder=s.inputPlaceholder)},ad=(t,s,e)=>{if(e.inputLabel){const a=document.createElement("label"),n=Je["input-label"];a.setAttribute("for",t.id),a.className=n,typeof e.customClass=="object"&&wr(a,e.customClass.inputLabel),a.innerText=e.inputLabel,s.insertAdjacentElement("beforebegin",a)}},S3=t=>{const s=yr();if(s)return Wi(s,Je[t]||Je.input)},n0=(t,s)=>{["string","number"].includes(typeof s)?t.value=`${s}`:Zg(s)||ea(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof s}"`)},Kr={};Kr.text=Kr.email=Kr.password=Kr.number=Kr.tel=Kr.url=Kr.search=Kr.date=Kr["datetime-local"]=Kr.time=Kr.week=Kr.month=(t,s)=>(n0(t,s.inputValue),ad(t,t,s),ix(t,s),t.type=s.input,t);Kr.file=(t,s)=>(ad(t,t,s),ix(t,s),t);Kr.range=(t,s)=>{const e=t.querySelector("input"),a=t.querySelector("output");return n0(e,s.inputValue),e.type=s.input,n0(a,s.inputValue),ad(e,t,s),t};Kr.select=(t,s)=>{if(t.textContent="",s.inputPlaceholder){const e=document.createElement("option");Ra(e,s.inputPlaceholder),e.value="",e.disabled=!0,e.selected=!0,t.appendChild(e)}return ad(t,t,s),t};Kr.radio=t=>(t.textContent="",t);Kr.checkbox=(t,s)=>{const e=W0(yr(),"checkbox");e.value="1",e.checked=!!s.inputValue;const a=t.querySelector("span");return Ra(a,s.inputPlaceholder||s.inputLabel),e};Kr.textarea=(t,s)=>{n0(t,s.inputValue),ix(t,s),ad(t,t,s);const e=a=>parseInt(window.getComputedStyle(a).marginLeft)+parseInt(window.getComputedStyle(a).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const a=parseInt(window.getComputedStyle(yr()).width),n=()=>{if(!document.body.contains(t))return;const i=t.offsetWidth+e(t);i>a?yr().style.width=`${i}px`:Po(yr(),"width",s.width)};new MutationObserver(n).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const RT=(t,s)=>{const e=Qg();e&&(sx(e),Ea(e,s,"htmlContainer"),s.html?(nx(s.html,e),_s(e,"block")):s.text?(e.textContent=s.text,_s(e,"block")):Hs(e),CT(t,s))},MT=(t,s)=>{const e=_3();e&&(sx(e),sd(e,s.footer,"block"),s.footer&&nx(s.footer,e),Ea(e,s,"footer"))},FT=(t,s)=>{const e=Rr.innerParams.get(t),a=lc();if(!a)return;if(e&&s.icon===e.icon){y2(a,s),b2(a,s);return}if(!s.icon&&!s.iconHtml){Hs(a);return}if(s.icon&&Object.keys(a0).indexOf(s.icon)===-1){Jo(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${s.icon}"`),Hs(a);return}_s(a),y2(a,s),b2(a,s),wr(a,s.showClass&&s.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",k3)},b2=(t,s)=>{for(const[e,a]of Object.entries(a0))s.icon!==e&&Qa(t,a);wr(t,s.icon&&a0[s.icon]),PT(t,s),k3(),Ea(t,s,"icon")},k3=()=>{const t=yr();if(!t)return;const s=window.getComputedStyle(t).getPropertyValue("background-color"),e=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let a=0;a<e.length;a++)e[a].style.backgroundColor=s},IT=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,LT=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,y2=(t,s)=>{if(!s.icon&&!s.iconHtml)return;let e=t.innerHTML,a="";s.iconHtml?a=v2(s.iconHtml):s.icon==="success"?(a=IT,e=e.replace(/ style=".*?"/g,"")):s.icon==="error"?a=LT:s.icon&&(a=v2({question:"?",warning:"!",info:"i"}[s.icon])),e.trim()!==a.trim()&&Ra(t,a)},PT=(t,s)=>{if(s.iconColor){t.style.color=s.iconColor,t.style.borderColor=s.iconColor;for(const e of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])g2(t,e,"background-color",s.iconColor);g2(t,".swal2-success-ring","border-color",s.iconColor)}},v2=t=>`<div class="${Je["icon-content"]}">${t}</div>`,BT=(t,s)=>{const e=v3();if(e){if(!s.imageUrl){Hs(e);return}_s(e,""),e.setAttribute("src",s.imageUrl),e.setAttribute("alt",s.imageAlt||""),Po(e,"width",s.imageWidth),Po(e,"height",s.imageHeight),e.className=Je.image,Ea(e,s,"image")}};let ox=!1,C3=0,E3=0,T3=0,A3=0;const DT=t=>{t.addEventListener("mousedown",i0),document.body.addEventListener("mousemove",o0),t.addEventListener("mouseup",l0),t.addEventListener("touchstart",i0),document.body.addEventListener("touchmove",o0),t.addEventListener("touchend",l0)},UT=t=>{t.removeEventListener("mousedown",i0),document.body.removeEventListener("mousemove",o0),t.removeEventListener("mouseup",l0),t.removeEventListener("touchstart",i0),document.body.removeEventListener("touchmove",o0),t.removeEventListener("touchend",l0)},i0=t=>{const s=yr();if(t.target===s||lc().contains(t.target)){ox=!0;const e=O3(t);C3=e.clientX,E3=e.clientY,T3=parseInt(s.style.insetInlineStart)||0,A3=parseInt(s.style.insetBlockStart)||0,wr(s,"swal2-dragging")}},o0=t=>{const s=yr();if(ox){let{clientX:e,clientY:a}=O3(t);s.style.insetInlineStart=`${T3+(e-C3)}px`,s.style.insetBlockStart=`${A3+(a-E3)}px`}},l0=()=>{const t=yr();ox=!1,Qa(t,"swal2-dragging")},O3=t=>{let s=0,e=0;return t.type.startsWith("mouse")?(s=t.clientX,e=t.clientY):t.type.startsWith("touch")&&(s=t.touches[0].clientX,e=t.touches[0].clientY),{clientX:s,clientY:e}},$T=(t,s)=>{const e=sa(),a=yr();if(!(!e||!a)){if(s.toast){Po(e,"width",s.width),a.style.width="100%";const n=uc();n&&a.insertBefore(n,lc())}else Po(a,"width",s.width);Po(a,"padding",s.padding),s.color&&(a.style.color=s.color),s.background&&(a.style.background=s.background),Hs(q0()),zT(a,s),s.draggable&&!s.toast?(wr(a,Je.draggable),DT(a)):(Qa(a,Je.draggable),UT(a))}},zT=(t,s)=>{const e=s.showClass||{};t.className=`${Je.popup} ${da(t)?e.popup:""}`,s.toast?(wr([document.documentElement,document.body],Je["toast-shown"]),wr(t,Je.toast)):wr(t,Je.modal),Ea(t,s,"popup"),typeof s.customClass=="string"&&wr(t,s.customClass),s.icon&&wr(t,Je[`icon-${s.icon}`])},HT=(t,s)=>{const e=Jg();if(!e)return;const{progressSteps:a,currentProgressStep:n}=s;if(!a||a.length===0||n===void 0){Hs(e);return}_s(e),e.textContent="",n>=a.length&&ea("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),a.forEach((i,c)=>{const l=VT(i);if(e.appendChild(l),c===n&&wr(l,Je["active-progress-step"]),c!==a.length-1){const u=qT(s);e.appendChild(u)}})},VT=t=>{const s=document.createElement("li");return wr(s,Je["progress-step"]),Ra(s,t),s},qT=t=>{const s=document.createElement("li");return wr(s,Je["progress-step-line"]),t.progressStepsDistance&&Po(s,"width",t.progressStepsDistance),s},GT=(t,s)=>{const e=y3();e&&(sx(e),sd(e,s.title||s.titleText,"block"),s.title&&nx(s.title,e),s.titleText&&(e.innerText=s.titleText),Ea(e,s,"title"))},R3=(t,s)=>{$T(t,s),wT(t,s),HT(t,s),FT(t,s),BT(t,s),GT(t,s),_T(t,s),RT(t,s),bT(t,s),MT(t,s);const e=yr();typeof s.didRender=="function"&&e&&s.didRender(e),Pt.eventEmitter.emit("didRender",e)},YT=()=>da(yr()),M3=()=>{var t;return(t=$n())===null||t===void 0?void 0:t.click()},WT=()=>{var t;return(t=el())===null||t===void 0?void 0:t.click()},XT=()=>{var t;return(t=cc())===null||t===void 0?void 0:t.click()},dc=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),F3=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},KT=(t,s,e)=>{F3(t),s.toast||(t.keydownHandler=a=>QT(s,a,e),t.keydownTarget=s.keydownListenerCapture?window:yr(),t.keydownListenerCapture=s.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},eg=(t,s)=>{var e;const a=tx();if(a.length){t=t+s,t===-2&&(t=a.length-1),t===a.length?t=0:t===-1&&(t=a.length-1),a[t].focus();return}(e=yr())===null||e===void 0||e.focus()},I3=["ArrowRight","ArrowDown"],ZT=["ArrowLeft","ArrowUp"],QT=(t,s,e)=>{t&&(s.isComposing||s.keyCode===229||(t.stopKeydownPropagation&&s.stopPropagation(),s.key==="Enter"?JT(s,t):s.key==="Tab"?eA(s):[...I3,...ZT].includes(s.key)?tA(s.key):s.key==="Escape"&&rA(s,t,e)))},JT=(t,s)=>{if(!V0(s.allowEnterKey))return;const e=W0(yr(),s.input);if(t.target&&e&&t.target instanceof HTMLElement&&t.target.outerHTML===e.outerHTML){if(["textarea","file"].includes(s.input))return;M3(),t.preventDefault()}},eA=t=>{const s=t.target,e=tx();let a=-1;for(let n=0;n<e.length;n++)if(s===e[n]){a=n;break}t.shiftKey?eg(a,-1):eg(a,1),t.stopPropagation(),t.preventDefault()},tA=t=>{const s=rd(),e=$n(),a=el(),n=cc();if(!s||!e||!a||!n)return;const i=[e,a,n];if(document.activeElement instanceof HTMLElement&&!i.includes(document.activeElement))return;const c=I3.includes(t)?"nextElementSibling":"previousElementSibling";let l=document.activeElement;if(l){for(let u=0;u<s.children.length;u++){if(l=l[c],!l)return;if(l instanceof HTMLButtonElement&&da(l))break}l instanceof HTMLButtonElement&&l.focus()}},rA=(t,s,e)=>{V0(s.allowEscapeKey)&&(t.preventDefault(),e(dc.esc))};var Zl={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const sA=()=>{const t=sa();Array.from(document.body.children).forEach(e=>{e.contains(t)||(e.hasAttribute("aria-hidden")&&e.setAttribute("data-previous-aria-hidden",e.getAttribute("aria-hidden")||""),e.setAttribute("aria-hidden","true"))})},L3=()=>{Array.from(document.body.children).forEach(s=>{s.hasAttribute("data-previous-aria-hidden")?(s.setAttribute("aria-hidden",s.getAttribute("data-previous-aria-hidden")||""),s.removeAttribute("data-previous-aria-hidden")):s.removeAttribute("aria-hidden")})},P3=typeof window<"u"&&!!window.GestureEvent,aA=()=>{if(P3&&!di(document.body,Je.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,wr(document.body,Je.iosfix),nA()}},nA=()=>{const t=sa();if(!t)return;let s;t.ontouchstart=e=>{s=iA(e)},t.ontouchmove=e=>{s&&(e.preventDefault(),e.stopPropagation())}},iA=t=>{const s=t.target,e=sa(),a=Qg();return!e||!a||oA(t)||lA(t)?!1:s===e||!x2(e)&&s instanceof HTMLElement&&s.tagName!=="INPUT"&&s.tagName!=="TEXTAREA"&&!(x2(a)&&a.contains(s))},oA=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",lA=t=>t.touches&&t.touches.length>1,cA=()=>{if(di(document.body,Je.iosfix)){const t=parseInt(document.body.style.top,10);Qa(document.body,Je.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},uA=()=>{const t=document.createElement("div");t.className=Je["scrollbar-measure"],document.body.appendChild(t);const s=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),s};let Dl=null;const dA=t=>{Dl===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(Dl=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Dl+uA()}px`)},fA=()=>{Dl!==null&&(document.body.style.paddingRight=`${Dl}px`,Dl=null)};function B3(t,s,e,a){Y0()?_2(t,a):(Z9(e).then(()=>_2(t,a)),F3(Pt)),P3?(s.setAttribute("style","display:none !important"),s.removeAttribute("class"),s.innerHTML=""):s.remove(),rx()&&(fA(),cA(),L3()),hA()}function hA(){Qa([document.documentElement,document.body],[Je.shown,Je["height-auto"],Je["no-backdrop"],Je["toast-shown"]])}function Xi(t){t=pA(t);const s=Zl.swalPromiseResolve.get(this),e=mA(this);this.isAwaitingPromise?t.isDismissed||(nd(this),s(t)):e&&s(t)}const mA=t=>{const s=yr();if(!s)return!1;const e=Rr.innerParams.get(t);if(!e||di(s,e.hideClass.popup))return!1;Qa(s,e.showClass.popup),wr(s,e.hideClass.popup);const a=sa();return Qa(a,e.showClass.backdrop),wr(a,e.hideClass.backdrop),gA(t,s,e),!0};function D3(t){const s=Zl.swalPromiseReject.get(this);nd(this),s&&s(t)}const nd=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Rr.innerParams.get(t)||t._destroy())},pA=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),gA=(t,s,e)=>{var a;const n=sa(),i=j3(s);typeof e.willClose=="function"&&e.willClose(s),(a=Pt.eventEmitter)===null||a===void 0||a.emit("willClose",s),i?xA(t,s,n,e.returnFocus,e.didClose):B3(t,n,e.returnFocus,e.didClose)},xA=(t,s,e,a,n)=>{Pt.swalCloseEventFinishedCallback=B3.bind(null,t,e,a,n);const i=function(c){if(c.target===s){var l;(l=Pt.swalCloseEventFinishedCallback)===null||l===void 0||l.call(Pt),delete Pt.swalCloseEventFinishedCallback,s.removeEventListener("animationend",i),s.removeEventListener("transitionend",i)}};s.addEventListener("animationend",i),s.addEventListener("transitionend",i)},_2=(t,s)=>{setTimeout(()=>{var e;typeof s=="function"&&s.bind(t.params)(),(e=Pt.eventEmitter)===null||e===void 0||e.emit("didClose"),t._destroy&&t._destroy()})},Ql=t=>{let s=yr();if(s||new jr,s=yr(),!s)return;const e=uc();Y0()?Hs(lc()):bA(s,t),_s(e),s.setAttribute("data-loading","true"),s.setAttribute("aria-busy","true"),s.focus()},bA=(t,s)=>{const e=rd(),a=uc();!e||!a||(!s&&da($n())&&(s=$n()),_s(e),s&&(Hs(s),a.setAttribute("data-button-to-replace",s.className),e.insertBefore(a,s)),wr([t,e],Je.loading))},yA=(t,s)=>{s.input==="select"||s.input==="radio"?jA(t,s):["text","email","number","tel","textarea"].some(e=>e===s.input)&&(Kg(s.inputValue)||Zg(s.inputValue))&&(Ql($n()),SA(t,s))},vA=(t,s)=>{const e=t.getInput();if(!e)return null;switch(s.input){case"checkbox":return _A(e);case"radio":return wA(e);case"file":return NA(e);default:return s.inputAutoTrim?e.value.trim():e.value}},_A=t=>t.checked?1:0,wA=t=>t.checked?t.value:null,NA=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,jA=(t,s)=>{const e=yr();if(!e)return;const a=n=>{s.input==="select"?kA(e,c0(n),s):s.input==="radio"&&CA(e,c0(n),s)};Kg(s.inputOptions)||Zg(s.inputOptions)?(Ql($n()),ed(s.inputOptions).then(n=>{t.hideLoading(),a(n)})):typeof s.inputOptions=="object"?a(s.inputOptions):Jo(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof s.inputOptions}`)},SA=(t,s)=>{const e=t.getInput();e&&(Hs(e),ed(s.inputValue).then(a=>{e.value=s.input==="number"?`${parseFloat(a)||0}`:`${a}`,_s(e),e.focus(),t.hideLoading()}).catch(a=>{Jo(`Error in inputValue promise: ${a}`),e.value="",_s(e),e.focus(),t.hideLoading()}))};function kA(t,s,e){const a=Wi(t,Je.select);if(!a)return;const n=(i,c,l)=>{const u=document.createElement("option");u.value=l,Ra(u,c),u.selected=U3(l,e.inputValue),i.appendChild(u)};s.forEach(i=>{const c=i[0],l=i[1];if(Array.isArray(l)){const u=document.createElement("optgroup");u.label=c,u.disabled=!1,a.appendChild(u),l.forEach(o=>n(u,o[1],o[0]))}else n(a,l,c)}),a.focus()}function CA(t,s,e){const a=Wi(t,Je.radio);if(!a)return;s.forEach(i=>{const c=i[0],l=i[1],u=document.createElement("input"),o=document.createElement("label");u.type="radio",u.name=Je.radio,u.value=c,U3(c,e.inputValue)&&(u.checked=!0);const d=document.createElement("span");Ra(d,l),d.className=Je.label,o.appendChild(u),o.appendChild(d),a.appendChild(o)});const n=a.querySelectorAll("input");n.length&&n[0].focus()}const c0=t=>{const s=[];return t instanceof Map?t.forEach((e,a)=>{let n=e;typeof n=="object"&&(n=c0(n)),s.push([a,n])}):Object.keys(t).forEach(e=>{let a=t[e];typeof a=="object"&&(a=c0(a)),s.push([e,a])}),s},U3=(t,s)=>!!s&&s.toString()===t.toString(),EA=t=>{const s=Rr.innerParams.get(t);t.disableButtons(),s.input?$3(t,"confirm"):cx(t,!0)},TA=t=>{const s=Rr.innerParams.get(t);t.disableButtons(),s.returnInputValueOnDeny?$3(t,"deny"):lx(t,!1)},AA=(t,s)=>{t.disableButtons(),s(dc.cancel)},$3=(t,s)=>{const e=Rr.innerParams.get(t);if(!e.input){Jo(`The "input" parameter is needed to be set when using returnInputValueOn${Xg(s)}`);return}const a=t.getInput(),n=vA(t,e);e.inputValidator?OA(t,n,s):a&&!a.checkValidity()?(t.enableButtons(),t.showValidationMessage(e.validationMessage||a.validationMessage)):s==="deny"?lx(t,n):cx(t,n)},OA=(t,s,e)=>{const a=Rr.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>ed(a.inputValidator(s,a.validationMessage))).then(i=>{t.enableButtons(),t.enableInput(),i?t.showValidationMessage(i):e==="deny"?lx(t,s):cx(t,s)})},lx=(t,s)=>{const e=Rr.innerParams.get(t||void 0);e.showLoaderOnDeny&&Ql(el()),e.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>ed(e.preDeny(s,e.validationMessage))).then(n=>{n===!1?(t.hideLoading(),nd(t)):t.close({isDenied:!0,value:typeof n>"u"?s:n})}).catch(n=>z3(t||void 0,n))):t.close({isDenied:!0,value:s})},w2=(t,s)=>{t.close({isConfirmed:!0,value:s})},z3=(t,s)=>{t.rejectPromise(s)},cx=(t,s)=>{const e=Rr.innerParams.get(t||void 0);e.showLoaderOnConfirm&&Ql(),e.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>ed(e.preConfirm(s,e.validationMessage))).then(n=>{da(q0())||n===!1?(t.hideLoading(),nd(t)):w2(t,typeof n>"u"?s:n)}).catch(n=>z3(t||void 0,n))):w2(t,s)};function u0(){const t=Rr.innerParams.get(this);if(!t)return;const s=Rr.domCache.get(this);Hs(s.loader),Y0()?t.icon&&_s(lc()):RA(s),Qa([s.popup,s.actions],Je.loading),s.popup.removeAttribute("aria-busy"),s.popup.removeAttribute("data-loading"),s.confirmButton.disabled=!1,s.denyButton.disabled=!1,s.cancelButton.disabled=!1}const RA=t=>{const s=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));s.length?_s(s[0],"inline-block"):iT()&&Hs(t.actions)};function H3(){const t=Rr.innerParams.get(this),s=Rr.domCache.get(this);return s?W0(s.popup,t.input):null}function V3(t,s,e){const a=Rr.domCache.get(t);s.forEach(n=>{a[n].disabled=e})}function q3(t,s){const e=yr();if(!(!e||!t))if(t.type==="radio"){const a=e.querySelectorAll(`[name="${Je.radio}"]`);for(let n=0;n<a.length;n++)a[n].disabled=s}else t.disabled=s}function G3(){V3(this,["confirmButton","denyButton","cancelButton"],!1)}function Y3(){V3(this,["confirmButton","denyButton","cancelButton"],!0)}function W3(){q3(this.getInput(),!1)}function X3(){q3(this.getInput(),!0)}function K3(t){const s=Rr.domCache.get(this),e=Rr.innerParams.get(this);Ra(s.validationMessage,t),s.validationMessage.className=Je["validation-message"],e.customClass&&e.customClass.validationMessage&&wr(s.validationMessage,e.customClass.validationMessage),_s(s.validationMessage);const a=this.getInput();a&&(a.setAttribute("aria-invalid","true"),a.setAttribute("aria-describedby",Je["validation-message"]),w3(a),wr(a,Je.inputerror))}function Z3(){const t=Rr.domCache.get(this);t.validationMessage&&Hs(t.validationMessage);const s=this.getInput();s&&(s.removeAttribute("aria-invalid"),s.removeAttribute("aria-describedby"),Qa(s,Je.inputerror))}const Ul={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},MA=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],FA={allowEnterKey:void 0},IA=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Q3=t=>Object.prototype.hasOwnProperty.call(Ul,t),J3=t=>MA.indexOf(t)!==-1,e5=t=>FA[t],LA=t=>{Q3(t)||ea(`Unknown parameter "${t}"`)},PA=t=>{IA.includes(t)&&ea(`The parameter "${t}" is incompatible with toasts`)},BA=t=>{const s=e5(t);s&&b3(t,s)},t5=t=>{t.backdrop===!1&&t.allowOutsideClick&&ea('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&ea(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const s in t)LA(s),t.toast&&PA(s),BA(s)};function r5(t){const s=sa(),e=yr(),a=Rr.innerParams.get(this);if(!e||di(e,a.hideClass.popup)){ea("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const n=DA(t),i=Object.assign({},a,n);t5(i),s.dataset.swal2Theme=i.theme,R3(this,i),Rr.innerParams.set(this,i),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const DA=t=>{const s={};return Object.keys(t).forEach(e=>{J3(e)?s[e]=t[e]:ea(`Invalid parameter to update: ${e}`)}),s};function s5(){const t=Rr.domCache.get(this),s=Rr.innerParams.get(this);if(!s){a5(this);return}t.popup&&Pt.swalCloseEventFinishedCallback&&(Pt.swalCloseEventFinishedCallback(),delete Pt.swalCloseEventFinishedCallback),typeof s.didDestroy=="function"&&s.didDestroy(),Pt.eventEmitter.emit("didDestroy"),UA(this)}const UA=t=>{a5(t),delete t.params,delete Pt.keydownHandler,delete Pt.keydownTarget,delete Pt.currentInstance},a5=t=>{t.isAwaitingPromise?(_p(Rr,t),t.isAwaitingPromise=!0):(_p(Zl,t),_p(Rr,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},_p=(t,s)=>{for(const e in t)t[e].delete(s)};var $A=Object.freeze({__proto__:null,_destroy:s5,close:Xi,closeModal:Xi,closePopup:Xi,closeToast:Xi,disableButtons:Y3,disableInput:X3,disableLoading:u0,enableButtons:G3,enableInput:W3,getInput:H3,handleAwaitingPromise:nd,hideLoading:u0,rejectPromise:D3,resetValidationMessage:Z3,showValidationMessage:K3,update:r5});const zA=(t,s,e)=>{t.toast?HA(t,s,e):(qA(s),GA(s),YA(t,s,e))},HA=(t,s,e)=>{s.popup.onclick=()=>{t&&(VA(t)||t.timer||t.input)||e(dc.close)}},VA=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let d0=!1;const qA=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(s){t.container.onmouseup=()=>{},s.target===t.container&&(d0=!0)}}},GA=t=>{t.container.onmousedown=s=>{s.target===t.container&&s.preventDefault(),t.popup.onmouseup=function(e){t.popup.onmouseup=()=>{},(e.target===t.popup||e.target instanceof HTMLElement&&t.popup.contains(e.target))&&(d0=!0)}}},YA=(t,s,e)=>{s.container.onclick=a=>{if(d0){d0=!1;return}a.target===s.container&&V0(t.allowOutsideClick)&&e(dc.backdrop)}},WA=t=>typeof t=="object"&&t.jquery,N2=t=>t instanceof Element||WA(t),XA=t=>{const s={};return typeof t[0]=="object"&&!N2(t[0])?Object.assign(s,t[0]):["title","html","icon"].forEach((e,a)=>{const n=t[a];typeof n=="string"||N2(n)?s[e]=n:n!==void 0&&Jo(`Unexpected type of ${e}! Expected "string" or "Element", got ${typeof n}`)}),s};function KA(){for(var t=arguments.length,s=new Array(t),e=0;e<t;e++)s[e]=arguments[e];return new this(...s)}function ZA(t){class s extends this{_main(a,n){return super._main(a,Object.assign({},t,n))}}return s}const QA=()=>Pt.timeout&&Pt.timeout.getTimerLeft(),n5=()=>{if(Pt.timeout)return oT(),Pt.timeout.stop()},i5=()=>{if(Pt.timeout){const t=Pt.timeout.start();return ax(t),t}},JA=()=>{const t=Pt.timeout;return t&&(t.running?n5():i5())},eO=t=>{if(Pt.timeout){const s=Pt.timeout.increase(t);return ax(s,!0),s}},tO=()=>!!(Pt.timeout&&Pt.timeout.isRunning());let j2=!1;const tg={};function rO(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";tg[t]=this,j2||(document.body.addEventListener("click",sO),j2=!0)}const sO=t=>{for(let s=t.target;s&&s!==document;s=s.parentNode)for(const e in tg){const a=s.getAttribute(e);if(a){tg[e].fire({template:a});return}}};class aO{constructor(){this.events={}}_getHandlersByEventName(s){return typeof this.events[s]>"u"&&(this.events[s]=[]),this.events[s]}on(s,e){const a=this._getHandlersByEventName(s);a.includes(e)||a.push(e)}once(s,e){var a=this;const n=function(){a.removeListener(s,n);for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];e.apply(a,c)};this.on(s,n)}emit(s){for(var e=arguments.length,a=new Array(e>1?e-1:0),n=1;n<e;n++)a[n-1]=arguments[n];this._getHandlersByEventName(s).forEach(i=>{try{i.apply(this,a)}catch(c){console.error(c)}})}removeListener(s,e){const a=this._getHandlersByEventName(s),n=a.indexOf(e);n>-1&&a.splice(n,1)}removeAllListeners(s){this.events[s]!==void 0&&(this.events[s].length=0)}reset(){this.events={}}}Pt.eventEmitter=new aO;const nO=(t,s)=>{Pt.eventEmitter.on(t,s)},iO=(t,s)=>{Pt.eventEmitter.once(t,s)},oO=(t,s)=>{if(!t){Pt.eventEmitter.reset();return}s?Pt.eventEmitter.removeListener(t,s):Pt.eventEmitter.removeAllListeners(t)};var lO=Object.freeze({__proto__:null,argsToParams:XA,bindClickHandler:rO,clickCancel:XT,clickConfirm:M3,clickDeny:WT,enableLoading:Ql,fire:KA,getActions:rd,getCancelButton:cc,getCloseButton:ex,getConfirmButton:$n,getContainer:sa,getDenyButton:el,getFocusableElements:tx,getFooter:_3,getHtmlContainer:Qg,getIcon:lc,getIconContent:tT,getImage:v3,getInputLabel:rT,getLoader:uc,getPopup:yr,getProgressSteps:Jg,getTimerLeft:QA,getTimerProgressBar:G0,getTitle:y3,getValidationMessage:q0,increaseTimer:eO,isDeprecatedParameter:e5,isLoading:aT,isTimerRunning:tO,isUpdatableParameter:J3,isValidParameter:Q3,isVisible:YT,mixin:ZA,off:oO,on:nO,once:iO,resumeTimer:i5,showLoading:Ql,stopTimer:n5,toggleTimer:JA});class cO{constructor(s,e){this.callback=s,this.remaining=e,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(s){const e=this.running;return e&&this.stop(),this.remaining+=s,e&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const o5=["swal-title","swal-html","swal-footer"],uO=t=>{const s=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!s)return{};const e=s.content;return bO(e),Object.assign(dO(e),fO(e),hO(e),mO(e),pO(e),gO(e),xO(e,o5))},dO=t=>{const s={};return Array.from(t.querySelectorAll("swal-param")).forEach(a=>{Vo(a,["name","value"]);const n=a.getAttribute("name"),i=a.getAttribute("value");!n||!i||(typeof Ul[n]=="boolean"?s[n]=i!=="false":typeof Ul[n]=="object"?s[n]=JSON.parse(i):s[n]=i)}),s},fO=t=>{const s={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(a=>{const n=a.getAttribute("name"),i=a.getAttribute("value");!n||!i||(s[n]=new Function(`return ${i}`)())}),s},hO=t=>{const s={};return Array.from(t.querySelectorAll("swal-button")).forEach(a=>{Vo(a,["type","color","aria-label"]);const n=a.getAttribute("type");!n||!["confirm","cancel","deny"].includes(n)||(s[`${n}ButtonText`]=a.innerHTML,s[`show${Xg(n)}Button`]=!0,a.hasAttribute("color")&&(s[`${n}ButtonColor`]=a.getAttribute("color")),a.hasAttribute("aria-label")&&(s[`${n}ButtonAriaLabel`]=a.getAttribute("aria-label")))}),s},mO=t=>{const s={},e=t.querySelector("swal-image");return e&&(Vo(e,["src","width","height","alt"]),e.hasAttribute("src")&&(s.imageUrl=e.getAttribute("src")||void 0),e.hasAttribute("width")&&(s.imageWidth=e.getAttribute("width")||void 0),e.hasAttribute("height")&&(s.imageHeight=e.getAttribute("height")||void 0),e.hasAttribute("alt")&&(s.imageAlt=e.getAttribute("alt")||void 0)),s},pO=t=>{const s={},e=t.querySelector("swal-icon");return e&&(Vo(e,["type","color"]),e.hasAttribute("type")&&(s.icon=e.getAttribute("type")),e.hasAttribute("color")&&(s.iconColor=e.getAttribute("color")),s.iconHtml=e.innerHTML),s},gO=t=>{const s={},e=t.querySelector("swal-input");e&&(Vo(e,["type","label","placeholder","value"]),s.input=e.getAttribute("type")||"text",e.hasAttribute("label")&&(s.inputLabel=e.getAttribute("label")),e.hasAttribute("placeholder")&&(s.inputPlaceholder=e.getAttribute("placeholder")),e.hasAttribute("value")&&(s.inputValue=e.getAttribute("value")));const a=Array.from(t.querySelectorAll("swal-input-option"));return a.length&&(s.inputOptions={},a.forEach(n=>{Vo(n,["value"]);const i=n.getAttribute("value");if(!i)return;const c=n.innerHTML;s.inputOptions[i]=c})),s},xO=(t,s)=>{const e={};for(const a in s){const n=s[a],i=t.querySelector(n);i&&(Vo(i,[]),e[n.replace(/^swal-/,"")]=i.innerHTML.trim())}return e},bO=t=>{const s=o5.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(e=>{const a=e.tagName.toLowerCase();s.includes(a)||ea(`Unrecognized element <${a}>`)})},Vo=(t,s)=>{Array.from(t.attributes).forEach(e=>{s.indexOf(e.name)===-1&&ea([`Unrecognized attribute "${e.name}" on <${t.tagName.toLowerCase()}>.`,`${s.length?`Allowed attributes are: ${s.join(", ")}`:"To set the value, use HTML within the element."}`])})},l5=10,yO=t=>{const s=sa(),e=yr();typeof t.willOpen=="function"&&t.willOpen(e),Pt.eventEmitter.emit("willOpen",e);const n=window.getComputedStyle(document.body).overflowY;wO(s,e,t),setTimeout(()=>{vO(s,e)},l5),rx()&&(_O(s,t.scrollbarPadding,n),sA()),!Y0()&&!Pt.previousActiveElement&&(Pt.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(e)),Pt.eventEmitter.emit("didOpen",e),Qa(s,Je["no-transition"])},f0=t=>{const s=yr();if(t.target!==s)return;const e=sa();s.removeEventListener("animationend",f0),s.removeEventListener("transitionend",f0),e.style.overflowY="auto"},vO=(t,s)=>{j3(s)?(t.style.overflowY="hidden",s.addEventListener("animationend",f0),s.addEventListener("transitionend",f0)):t.style.overflowY="auto"},_O=(t,s,e)=>{aA(),s&&e!=="hidden"&&dA(e),setTimeout(()=>{t.scrollTop=0})},wO=(t,s,e)=>{wr(t,e.showClass.backdrop),e.animation?(s.style.setProperty("opacity","0","important"),_s(s,"grid"),setTimeout(()=>{wr(s,e.showClass.popup),s.style.removeProperty("opacity")},l5)):_s(s,"grid"),wr([document.documentElement,document.body],Je.shown),e.heightAuto&&e.backdrop&&!e.toast&&wr([document.documentElement,document.body],Je["height-auto"])};var S2={email:(t,s)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(s||"Invalid email address"),url:(t,s)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(s||"Invalid URL")};function NO(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=S2.email),t.input==="url"&&(t.inputValidator=S2.url))}function jO(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(ea('Target parameter is not valid, defaulting to "body"'),t.target="body")}function SO(t){NO(t),t.showLoaderOnConfirm&&!t.preConfirm&&ea(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),jO(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),pT(t)}let Fn;var wf=new WeakMap;class es{constructor(){if(Y9(this,wf,void 0),typeof window>"u")return;Fn=this;for(var s=arguments.length,e=new Array(s),a=0;a<s;a++)e[a]=arguments[a];const n=Object.freeze(this.constructor.argsToParams(e));this.params=n,this.isAwaitingPromise=!1,W9(wf,this,this._main(Fn.params))}_main(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t5(Object.assign({},e,s)),Pt.currentInstance){const i=Zl.swalPromiseResolve.get(Pt.currentInstance),{isAwaitingPromise:c}=Pt.currentInstance;Pt.currentInstance._destroy(),c||i({isDismissed:!0}),rx()&&L3()}Pt.currentInstance=Fn;const a=CO(s,e);SO(a),Object.freeze(a),Pt.timeout&&(Pt.timeout.stop(),delete Pt.timeout),clearTimeout(Pt.restoreFocusTimeout);const n=EO(Fn);return R3(Fn,a),Rr.innerParams.set(Fn,a),kO(Fn,n,a)}then(s){return m2(wf,this).then(s)}finally(s){return m2(wf,this).finally(s)}}const kO=(t,s,e)=>new Promise((a,n)=>{const i=c=>{t.close({isDismissed:!0,dismiss:c})};Zl.swalPromiseResolve.set(t,a),Zl.swalPromiseReject.set(t,n),s.confirmButton.onclick=()=>{EA(t)},s.denyButton.onclick=()=>{TA(t)},s.cancelButton.onclick=()=>{AA(t,i)},s.closeButton.onclick=()=>{i(dc.close)},zA(e,s,i),KT(Pt,e,i),yA(t,e),yO(e),TO(Pt,e,i),AO(s,e),setTimeout(()=>{s.container.scrollTop=0})}),CO=(t,s)=>{const e=uO(t),a=Object.assign({},Ul,s,e,t);return a.showClass=Object.assign({},Ul.showClass,a.showClass),a.hideClass=Object.assign({},Ul.hideClass,a.hideClass),a.animation===!1&&(a.showClass={backdrop:"swal2-noanimation"},a.hideClass={}),a},EO=t=>{const s={popup:yr(),container:sa(),actions:rd(),confirmButton:$n(),denyButton:el(),cancelButton:cc(),loader:uc(),closeButton:ex(),validationMessage:q0(),progressSteps:Jg()};return Rr.domCache.set(t,s),s},TO=(t,s,e)=>{const a=G0();Hs(a),s.timer&&(t.timeout=new cO(()=>{e("timer"),delete t.timeout},s.timer),s.timerProgressBar&&(_s(a),Ea(a,s,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&ax(s.timer)})))},AO=(t,s)=>{if(!s.toast){if(!V0(s.allowEnterKey)){b3("allowEnterKey"),MO();return}OO(t)||RO(t,s)||eg(-1,1)}},OO=t=>{const s=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const e of s)if(e instanceof HTMLElement&&da(e))return e.focus(),!0;return!1},RO=(t,s)=>s.focusDeny&&da(t.denyButton)?(t.denyButton.focus(),!0):s.focusCancel&&da(t.cancelButton)?(t.cancelButton.focus(),!0):s.focusConfirm&&da(t.confirmButton)?(t.confirmButton.focus(),!0):!1,MO=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,s=localStorage.getItem("swal-initiation");s?(t.getTime()-Date.parse(s))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const e=document.createElement("audio");e.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",e.loop=!0,document.body.appendChild(e),setTimeout(()=>{e.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}es.prototype.disableButtons=Y3;es.prototype.enableButtons=G3;es.prototype.getInput=H3;es.prototype.disableInput=X3;es.prototype.enableInput=W3;es.prototype.hideLoading=u0;es.prototype.disableLoading=u0;es.prototype.showValidationMessage=K3;es.prototype.resetValidationMessage=Z3;es.prototype.close=Xi;es.prototype.closePopup=Xi;es.prototype.closeModal=Xi;es.prototype.closeToast=Xi;es.prototype.rejectPromise=D3;es.prototype.update=r5;es.prototype._destroy=s5;Object.assign(es,lO);Object.keys($A).forEach(t=>{es[t]=function(){return Fn&&Fn[t]?Fn[t](...arguments):null}});es.DismissReason=dc;es.version="11.21.0";const jr=es;jr.default=jr;typeof document<"u"&&function(t,s){var e=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(e),e.styleSheet)e.styleSheet.disabled||(e.styleSheet.cssText=s);else try{e.innerHTML=s}catch{e.innerText=s}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const Ft={showAlert:(t,s)=>{jr.fire({title:s==="error"?"Error":s==="success"?"Success":"Info",text:t,icon:s,confirmButtonText:"OK",timer:3e3,timerProgressBar:!0})},showConfirmation:(t,s,e)=>{jr.fire({title:"Are you sure?",text:t,icon:"question",showCancelButton:!0,confirmButtonText:"Yes, proceed",cancelButtonText:"Cancel"}).then(a=>{a.isConfirmed?s():a.dismiss===jr.DismissReason.cancel&&e&&e()})}};function c5({isOpen:t,onClose:s,onSave:e,institutionId:a,loading:n=!1}){const[i,c]=ne.useState({suc_details_id:a||"",program_name:"",program_code:"",major_name:"",major_code:"",aop_category:"",aop_serial:"",aop_year:"",is_thesis_dissertation_required:!1,program_status:"ACTIVE",calendar_use_code:"SEM",program_normal_length_in_years:"",lab_units:"",lecture_units:"",total_units:"",tuition_per_unit:"",program_fee:"",program_type:"undergraduate",new_students_freshmen_male:"",new_students_freshmen_female:"","1st_year_male":"","1st_year_female":"","2nd_year_male":"","2nd_year_female":"","3rd_year_male":"","3rd_year_female":"","4th_year_male":"","4th_year_female":"","5th_year_male":"","5th_year_female":"","6th_year_male":"","6th_year_female":"","7th_year_male":"","7th_year_female":"",subtotal_male:"",subtotal_female:"",grand_total:"",lecture_units_actual:"",laboratory_units_actual:"",total_units_actual:"",graduates_males:"",graduates_females:"",graduates_total:"",externally_funded_merit_scholars:"",internally_funded_grantees:"",funded_grantees:"",report_year:new Date().getFullYear()}),[l,u]=ne.useState({}),o=(f,x)=>{if(c(b=>({...b,[f]:x})),l[f]&&u(b=>({...b,[f]:""})),(f.includes("_male")||f.includes("_female"))&&d({...i,[f]:x}),f==="lecture_units"||f==="lab_units"){const b=f==="lecture_units"?parseFloat(x)||0:parseFloat(i.lecture_units)||0,v=f==="lab_units"?parseFloat(x)||0:parseFloat(i.lab_units)||0;c(_=>({..._,[f]:x,total_units:b+v}))}if(f==="graduates_males"||f==="graduates_females"){const b=f==="graduates_males"?parseInt(x)||0:parseInt(i.graduates_males)||0,v=f==="graduates_females"?parseInt(x)||0:parseInt(i.graduates_females)||0;c(_=>({..._,[f]:x,graduates_total:b+v}))}},d=f=>{const x=["1st_year_male","2nd_year_male","3rd_year_male","4th_year_male","5th_year_male","6th_year_male","7th_year_male"],b=["1st_year_female","2nd_year_female","3rd_year_female","4th_year_female","5th_year_female","6th_year_female","7th_year_female"],v=x.reduce((E,O)=>E+(parseInt(f[O])||0),0),_=b.reduce((E,O)=>E+(parseInt(f[O])||0),0),N=v+_;c(E=>({...E,subtotal_male:v,subtotal_female:_,grand_total:N}))},g=()=>{const f={};return i.program_name.trim()||(f.program_name="Program name is required"),i.suc_details_id||(f.suc_details_id="Institution ID is required"),i.report_year||(f.report_year="Report year is required"),i.program_normal_length_in_years&&(isNaN(i.program_normal_length_in_years)||i.program_normal_length_in_years<1||i.program_normal_length_in_years>10)&&(f.program_normal_length_in_years="Program length must be between 1 and 10 years"),i.lab_units&&(isNaN(i.lab_units)||i.lab_units<0)&&(f.lab_units="Lab units must be a positive number"),i.lecture_units&&(isNaN(i.lecture_units)||i.lecture_units<0)&&(f.lecture_units="Lecture units must be a positive number"),i.tuition_per_unit&&(isNaN(i.tuition_per_unit)||i.tuition_per_unit<0)&&(f.tuition_per_unit="Tuition per unit must be a positive number"),i.program_fee&&(isNaN(i.program_fee)||i.program_fee<0)&&(f.program_fee="Program fee must be a positive number"),u(f),Object.keys(f).length===0},p=()=>{if(g()){const f=v=>{if(v==null||v==="")return null;const _=String(v).trim();if(_==="")return null;const N=parseInt(_,10);return isNaN(N)?null:N},x=v=>{if(v==null||v==="")return null;const _=String(v).trim();if(_==="")return null;const N=parseFloat(_);return isNaN(N)?null:N},b={...i,suc_details_id:f(i.suc_details_id),program_code:f(i.program_code),major_code:f(i.major_code),aop_year:f(i.aop_year),program_normal_length_in_years:f(i.program_normal_length_in_years),lab_units:f(i.lab_units),lecture_units:f(i.lecture_units),total_units:f(i.total_units),tuition_per_unit:x(i.tuition_per_unit),program_fee:x(i.program_fee),new_students_freshmen_male:f(i.new_students_freshmen_male),new_students_freshmen_female:f(i.new_students_freshmen_female),"1st_year_male":f(i["1st_year_male"]),"1st_year_female":f(i["1st_year_female"]),"2nd_year_male":f(i["2nd_year_male"]),"2nd_year_female":f(i["2nd_year_female"]),"3rd_year_male":f(i["3rd_year_male"]),"3rd_year_female":f(i["3rd_year_female"]),"4th_year_male":f(i["4th_year_male"]),"4th_year_female":f(i["4th_year_female"]),"5th_year_male":f(i["5th_year_male"]),"5th_year_female":f(i["5th_year_female"]),"6th_year_male":f(i["6th_year_male"]),"6th_year_female":f(i["6th_year_female"]),"7th_year_male":f(i["7th_year_male"]),"7th_year_female":f(i["7th_year_female"]),subtotal_male:f(i.subtotal_male),subtotal_female:f(i.subtotal_female),grand_total:f(i.grand_total),lecture_units_actual:f(i.lecture_units_actual),laboratory_units_actual:f(i.laboratory_units_actual),total_units_actual:f(i.total_units_actual),graduates_males:f(i.graduates_males),graduates_females:f(i.graduates_females),graduates_total:f(i.graduates_total),externally_funded_merit_scholars:f(i.externally_funded_merit_scholars),internally_funded_grantees:f(i.internally_funded_grantees),funded_grantees:f(i.funded_grantees),report_year:f(i.report_year)};Ft.showConfirmation("Are you sure you want to add this program?",()=>{e(b)})}else Ft.showAlert("Please fix the validation errors before submitting.","error")},h=()=>{Object.keys(l).length>0?Ft.showConfirmation("You have unsaved changes. Are you sure you want to close?",()=>{u({}),s()}):(u({}),s())};return r.jsx(mr,{isOpen:t,onClose:h,title:"Add New Academic Program",subtitle:"Create a new program for the institution",icon:Er,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Program Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Program Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.program_name,onChange:f=>o("program_name",f.target.value),placeholder:"e.g., Bachelor of Science in Computer Science",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.program_name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Code"}),r.jsx("input",{type:"number",value:i.program_code,onChange:f=>o("program_code",f.target.value),placeholder:"e.g., 101",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Type"}),r.jsxs("select",{value:i.program_type,onChange:f=>o("program_type",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",children:[r.jsx("option",{value:"Baccalaureate",children:"Baccalaureate"}),r.jsx("option",{value:"Masters",children:"Masters"}),r.jsx("option",{value:"Doctoral",children:"Doctoral"}),r.jsx("option",{value:"Post-Baccalaureate",children:"Post-Baccalaureate"}),r.jsx("option",{value:"Pre-Baccalaureate",children:"Pre-Baccalaureate"}),r.jsx("option",{value:"VocTech",children:"VocTech"}),r.jsx("option",{value:"Basic",children:"Basic"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Major/Specialization"}),r.jsx("input",{type:"text",value:i.major_name,onChange:f=>o("major_name",f.target.value),placeholder:"e.g., Software Engineering",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Major Code"}),r.jsx("input",{type:"number",value:i.major_code,onChange:f=>o("major_code",f.target.value),placeholder:"e.g., 201",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Academic Details"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AOP Category"}),r.jsxs("select",{value:i.aop_category,onChange:f=>o("aop_category",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200",children:[r.jsx("option",{value:"",children:"Select Category"}),r.jsx("option",{value:"Bachelor",children:"Bachelor"}),r.jsx("option",{value:"Master",children:"Master"}),r.jsx("option",{value:"Doctoral",children:"Doctoral"}),r.jsx("option",{value:"Certificate",children:"Certificate"}),r.jsx("option",{value:"Diploma",children:"Diploma"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AOP Serial"}),r.jsx("input",{type:"text",value:i.aop_serial,onChange:f=>o("aop_serial",f.target.value),placeholder:"e.g., AOP-001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AOP Year"}),r.jsx("input",{type:"number",value:i.aop_year,onChange:f=>o("aop_year",f.target.value),placeholder:"e.g., 2024",min:"2000",max:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Program Length (Years)"]}),r.jsx("input",{type:"number",value:i.program_normal_length_in_years,onChange:f=>o("program_normal_length_in_years",f.target.value),placeholder:"e.g., 4",min:"1",max:"10",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.program_normal_length_in_years?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_normal_length_in_years&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_normal_length_in_years})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Status"}),r.jsxs("select",{value:i.program_status,onChange:f=>o("program_status",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200",children:[r.jsx("option",{value:"ACTIVE",children:"Active"}),r.jsx("option",{value:"INACTIVE",children:"Inactive"}),r.jsx("option",{value:"SUSPENDED",children:"Suspended"}),r.jsx("option",{value:"PHASED_OUT",children:"Phased Out"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Xa,{className:"w-4 h-4 inline mr-1"}),"Calendar System"]}),r.jsxs("select",{value:i.calendar_use_code,onChange:f=>o("calendar_use_code",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200",children:[r.jsx("option",{value:"SEM",children:"Semester"}),r.jsx("option",{value:"TRI",children:"Trimester"}),r.jsx("option",{value:"QTR",children:"Quarter"}),r.jsx("option",{value:"ANN",children:"Annual"}),r.jsx("option",{value:"MOD",children:"Modular"})]})]})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"thesis_required",checked:i.is_thesis_dissertation_required,onChange:f=>o("is_thesis_dissertation_required",f.target.checked),className:"h-4 w-4 text-emerald-600 focus:ring-emerald-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"thesis_required",className:"ml-2 text-sm text-gray-700",children:"Thesis/Dissertation Required"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(e3,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Units & Finances"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Units Distribution"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.lecture_units,onChange:f=>o("lecture_units",f.target.value),placeholder:"Lecture",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.lecture_units?"border-red-300 bg-red-50":"border-gray-300"}`}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture Units"}),l.lecture_units&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.lecture_units})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.lab_units,onChange:f=>o("lab_units",f.target.value),placeholder:"Lab",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.lab_units?"border-red-300 bg-red-50":"border-gray-300"}`}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab Units"}),l.lab_units&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.lab_units})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.total_units,onChange:f=>o("total_units",f.target.value),placeholder:"Total",min:"0",className:"w-full px-3 py-2 border border-purple-300 rounded-lg bg-purple-50 transition-colors duration-200",readOnly:!0}),r.jsx("label",{className:"text-xs text-purple-600",children:"Total Units"})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(bn,{className:"w-4 h-4 inline mr-1"}),"Tuition per Unit ()"]}),r.jsx("input",{type:"number",value:i.tuition_per_unit,onChange:f=>o("tuition_per_unit",f.target.value),placeholder:"e.g., 500.00",min:"0",step:"0.01",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.tuition_per_unit?"border-red-300 bg-red-50":"border-gray-300"}`}),l.tuition_per_unit&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.tuition_per_unit})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Fee ()"}),r.jsx("input",{type:"number",value:i.program_fee,onChange:f=>o("program_fee",f.target.value),placeholder:"e.g., 5000.00",min:"0",step:"0.01",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.program_fee?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_fee&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_fee})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Year"}),r.jsx("select",{value:i.report_year,onChange:f=>o("report_year",f.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.report_year?"border-red-300 bg-red-50":"border-gray-300"}`,children:Array.from({length:10},(f,x)=>{const b=new Date().getFullYear()-x;return r.jsx("option",{value:b,children:b},b)})}),l.report_year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.report_year})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Enrollment Data"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Freshmen Students"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.new_students_freshmen_male,onChange:f=>o("new_students_freshmen_male",f.target.value),placeholder:"Male freshmen",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Male"})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.new_students_freshmen_female,onChange:f=>o("new_students_freshmen_female",f.target.value),placeholder:"Female freshmen",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Female"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Enrollment by Year Level"}),r.jsx("div",{className:"space-y-2",children:[1,2,3,4,5,6,7].map(f=>r.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center",children:[r.jsxs("label",{className:"text-sm text-gray-700 font-medium",children:[f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`," Year"]}),r.jsx("input",{type:"number",value:i[`${f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`}_year_male`],onChange:x=>o(`${f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`}_year_male`,x.target.value),placeholder:"Male",min:"0",className:"px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200 text-sm"}),r.jsx("input",{type:"number",value:i[`${f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`}_year_female`],onChange:x=>o(`${f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`}_year_female`,x.target.value),placeholder:"Female",min:"0",className:"px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200 text-sm"})]},f))})]}),r.jsx("div",{className:"bg-white/60 rounded-lg p-3 border border-amber-300",children:r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-semibold text-blue-600",children:i.subtotal_male||0}),r.jsx("div",{className:"text-xs text-gray-600",children:"Total Male"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-semibold text-pink-600",children:i.subtotal_female||0}),r.jsx("div",{className:"text-xs text-gray-600",children:"Total Female"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-bold text-amber-900",children:i.grand_total||0}),r.jsx("div",{className:"text-xs text-amber-600",children:"Grand Total"})]})]})})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(Zr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduates"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Male Graduates"}),r.jsx("input",{type:"number",value:i.graduates_males,onChange:f=>o("graduates_males",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Female Graduates"}),r.jsx("input",{type:"number",value:i.graduates_females,onChange:f=>o("graduates_females",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Graduates"}),r.jsx("input",{type:"number",value:i.graduates_total,className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-slate-50 transition-colors duration-200",readOnly:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Actual Units Taken"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.lecture_units_actual,onChange:f=>o("lecture_units_actual",f.target.value),placeholder:"Lecture",min:"0",className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200 text-sm"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.laboratory_units_actual,onChange:f=>o("laboratory_units_actual",f.target.value),placeholder:"Lab",min:"0",className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200 text-sm"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.total_units_actual,onChange:f=>o("total_units_actual",f.target.value),placeholder:"Total",min:"0",className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200 text-sm"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Total"})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-cyan-100 rounded-xl p-4 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-indigo-500 rounded-lg shadow-sm",children:r.jsx(ys,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Scholarships & Aid"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"External Merit Scholars"}),r.jsx("input",{type:"number",value:i.externally_funded_merit_scholars,onChange:f=>o("externally_funded_merit_scholars",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Internal Grantees"}),r.jsx("input",{type:"number",value:i.internally_funded_grantees,onChange:f=>o("internally_funded_grantees",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Funded Students"}),r.jsx("input",{type:"number",value:i.funded_grantees,onChange:f=>o("funded_grantees",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200"})]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:h,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),r.jsx("button",{onClick:p,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2"}),"Create Program"]})})]})]})})}c5.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired,loading:B.bool};function u5({isOpen:t,onClose:s,onSave:e,programData:a,loading:n=!1}){const[i,c]=ne.useState({suc_details_id:"",program_name:"",program_code:"",major_name:"",major_code:"",aop_category:"",aop_serial:"",aop_year:"",is_thesis_dissertation_required:!1,program_status:"ACTIVE",calendar_use_code:"SEM",program_normal_length_in_years:"",lab_units:"",lecture_units:"",total_units:"",tuition_per_unit:"",program_fee:"",program_type:"undergraduate",new_students_freshmen_male:"",new_students_freshmen_female:"","1st_year_male":"","1st_year_female":"","2nd_year_male":"","2nd_year_female":"","3rd_year_male":"","3rd_year_female":"","4th_year_male":"","4th_year_female":"","5th_year_male":"","5th_year_female":"","6th_year_male":"","6th_year_female":"","7th_year_male":"","7th_year_female":"",subtotal_male:"",subtotal_female:"",grand_total:"",lecture_units_actual:"",laboratory_units_actual:"",total_units_actual:"",graduates_males:"",graduates_females:"",graduates_total:"",externally_funded_merit_scholars:"",internally_funded_grantees:"",funded_grantees:"",report_year:new Date().getFullYear()}),[l,u]=ne.useState({});ne.useEffect(()=>{if(a){const f=x=>x&&typeof x=="object"&&x.year?x.year.toString():x&&(typeof x=="number"||typeof x=="string")?x.toString():new Date().getFullYear().toString();c({suc_details_id:a.suc_details_id||"",program_name:a.program_name||"",program_code:a.program_code?a.program_code.toString():"",major_name:a.major_name||"",major_code:a.major_code?a.major_code.toString():"",aop_category:a.aop_category||"",aop_serial:a.aop_serial||"",aop_year:a.aop_year?a.aop_year.toString():"",is_thesis_dissertation_required:a.is_thesis_dissertation_required||!1,program_status:a.program_status||"ACTIVE",calendar_use_code:a.calendar_use_code||"SEM",program_normal_length_in_years:a.program_normal_length_in_years?a.program_normal_length_in_years.toString():"",lab_units:a.lab_units?a.lab_units.toString():"",lecture_units:a.lecture_units?a.lecture_units.toString():"",total_units:a.total_units?a.total_units.toString():"",tuition_per_unit:a.tuition_per_unit?a.tuition_per_unit.toString():"",program_fee:a.program_fee?a.program_fee.toString():"",program_type:a.program_type||"undergraduate",new_students_freshmen_male:a.new_students_freshmen_male?a.new_students_freshmen_male.toString():"",new_students_freshmen_female:a.new_students_freshmen_female?a.new_students_freshmen_female.toString():"","1st_year_male":a["1st_year_male"]?a["1st_year_male"].toString():"","1st_year_female":a["1st_year_female"]?a["1st_year_female"].toString():"","2nd_year_male":a["2nd_year_male"]?a["2nd_year_male"].toString():"","2nd_year_female":a["2nd_year_female"]?a["2nd_year_female"].toString():"","3rd_year_male":a["3rd_year_male"]?a["3rd_year_male"].toString():"","3rd_year_female":a["3rd_year_female"]?a["3rd_year_female"].toString():"","4th_year_male":a["4th_year_male"]?a["4th_year_male"].toString():"","4th_year_female":a["4th_year_female"]?a["4th_year_female"].toString():"","5th_year_male":a["5th_year_male"]?a["5th_year_male"].toString():"","5th_year_female":a["5th_year_female"]?a["5th_year_female"].toString():"","6th_year_male":a["6th_year_male"]?a["6th_year_male"].toString():"","6th_year_female":a["6th_year_female"]?a["6th_year_female"].toString():"","7th_year_male":a["7th_year_male"]?a["7th_year_male"].toString():"","7th_year_female":a["7th_year_female"]?a["7th_year_female"].toString():"",subtotal_male:a.subtotal_male?a.subtotal_male.toString():"",subtotal_female:a.subtotal_female?a.subtotal_female.toString():"",grand_total:a.grand_total?a.grand_total.toString():"",lecture_units_actual:a.lecture_units_actual?a.lecture_units_actual.toString():"",laboratory_units_actual:a.laboratory_units_actual?a.laboratory_units_actual.toString():"",total_units_actual:a.total_units_actual?a.total_units_actual.toString():"",graduates_males:a.graduates_males?a.graduates_males.toString():"",graduates_females:a.graduates_females?a.graduates_females.toString():"",graduates_total:a.graduates_total?a.graduates_total.toString():"",externally_funded_merit_scholars:a.externally_funded_merit_scholars?a.externally_funded_merit_scholars.toString():"",internally_funded_grantees:a.internally_funded_grantees?a.internally_funded_grantees.toString():"",funded_grantees:a.funded_grantees?a.funded_grantees.toString():"",report_year:f(a.report_year)})}console.log("Program data loaded:",a)},[a]);const o=(f,x)=>{if(c(b=>({...b,[f]:x})),l[f]&&u(b=>({...b,[f]:""})),(f.includes("_male")||f.includes("_female"))&&d({...i,[f]:x}),f==="lecture_units"||f==="lab_units"){const b=f==="lecture_units"?parseFloat(x)||0:parseFloat(i.lecture_units)||0,v=f==="lab_units"?parseFloat(x)||0:parseFloat(i.lab_units)||0;c(_=>({..._,[f]:x,total_units:b+v}))}if(f==="graduates_males"||f==="graduates_females"){const b=f==="graduates_males"?parseInt(x)||0:parseInt(i.graduates_males)||0,v=f==="graduates_females"?parseInt(x)||0:parseInt(i.graduates_females)||0;c(_=>({..._,[f]:x,graduates_total:b+v}))}},d=f=>{const x=["1st_year_male","2nd_year_male","3rd_year_male","4th_year_male","5th_year_male","6th_year_male","7th_year_male"],b=["1st_year_female","2nd_year_female","3rd_year_female","4th_year_female","5th_year_female","6th_year_female","7th_year_female"],v=x.reduce((E,O)=>E+(parseInt(f[O])||0),0),_=b.reduce((E,O)=>E+(parseInt(f[O])||0),0),N=v+_;c(E=>({...E,subtotal_male:v,subtotal_female:_,grand_total:N}))},g=()=>{const f={};return i.program_name.trim()||(f.program_name="Program name is required"),i.suc_details_id||(f.suc_details_id="Institution ID is required"),i.report_year||(f.report_year="Report year is required"),i.program_normal_length_in_years&&(isNaN(i.program_normal_length_in_years)||i.program_normal_length_in_years<1||i.program_normal_length_in_years>10)&&(f.program_normal_length_in_years="Program length must be between 1 and 10 years"),i.lab_units&&(isNaN(i.lab_units)||i.lab_units<0)&&(f.lab_units="Lab units must be a positive number"),i.lecture_units&&(isNaN(i.lecture_units)||i.lecture_units<0)&&(f.lecture_units="Lecture units must be a positive number"),i.tuition_per_unit&&(isNaN(i.tuition_per_unit)||i.tuition_per_unit<0)&&(f.tuition_per_unit="Tuition per unit must be a positive number"),i.program_fee&&(isNaN(i.program_fee)||i.program_fee<0)&&(f.program_fee="Program fee must be a positive number"),u(f),Object.keys(f).length===0},p=()=>{if(g()){const f=v=>{if(v==null||v==="")return null;const _=String(v).trim();if(_==="")return null;const N=parseInt(_,10);return isNaN(N)?null:N},x=v=>{if(v==null||v==="")return null;const _=String(v).trim();if(_==="")return null;const N=parseFloat(_);return isNaN(N)?null:N},b={...i,id:a.id,suc_details_id:f(i.suc_details_id),program_code:f(i.program_code),major_code:f(i.major_code),aop_year:f(i.aop_year),program_normal_length_in_years:f(i.program_normal_length_in_years),lab_units:f(i.lab_units),lecture_units:f(i.lecture_units),total_units:f(i.total_units),tuition_per_unit:x(i.tuition_per_unit),program_fee:x(i.program_fee),new_students_freshmen_male:f(i.new_students_freshmen_male),new_students_freshmen_female:f(i.new_students_freshmen_female),"1st_year_male":f(i["1st_year_male"]),"1st_year_female":f(i["1st_year_female"]),"2nd_year_male":f(i["2nd_year_male"]),"2nd_year_female":f(i["2nd_year_female"]),"3rd_year_male":f(i["3rd_year_male"]),"3rd_year_female":f(i["3rd_year_female"]),"4th_year_male":f(i["4th_year_male"]),"4th_year_female":f(i["4th_year_female"]),"5th_year_male":f(i["5th_year_male"]),"5th_year_female":f(i["5th_year_female"]),"6th_year_male":f(i["6th_year_male"]),"6th_year_female":f(i["6th_year_female"]),"7th_year_male":f(i["7th_year_male"]),"7th_year_female":f(i["7th_year_female"]),subtotal_male:f(i.subtotal_male),subtotal_female:f(i.subtotal_female),grand_total:f(i.grand_total),lecture_units_actual:f(i.lecture_units_actual),laboratory_units_actual:f(i.laboratory_units_actual),total_units_actual:f(i.total_units_actual),graduates_males:f(i.graduates_males),graduates_females:f(i.graduates_females),graduates_total:f(i.graduates_total),externally_funded_merit_scholars:f(i.externally_funded_merit_scholars),internally_funded_grantees:f(i.internally_funded_grantees),funded_grantees:f(i.funded_grantees),report_year:f(i.report_year)};Ft.showConfirmation("Are you sure you want to update this program?",()=>{e(b)})}else Ft.showAlert("Please fix the validation errors before submitting.","error")},h=()=>{Object.keys(l).length>0?Ft.showConfirmation("You have unsaved changes. Are you sure you want to close?",()=>{u({}),s()}):(u({}),s())};return r.jsx(mr,{isOpen:t,onClose:h,title:`Edit ${(a==null?void 0:a.program_name)||"Program"}`,subtitle:"Update program information and details",icon:Dr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Program Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Program Name"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.program_name,onChange:f=>o("program_name",f.target.value),placeholder:"e.g., Bachelor of Science in Computer Science",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.program_name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Code"}),r.jsx("input",{type:"number",value:i.program_code,onChange:f=>o("program_code",f.target.value),placeholder:"e.g., 101",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Type"}),r.jsxs("select",{value:i.program_type,onChange:f=>o("program_type",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",children:[r.jsx("option",{value:"Baccalaureate",children:"Baccalaureate"}),r.jsx("option",{value:"Masters",children:"Masters"}),r.jsx("option",{value:"Doctoral",children:"Doctoral"}),r.jsx("option",{value:"Post-Baccalaureate",children:"Post-Baccalaureate"}),r.jsx("option",{value:"Pre-Baccalaureate",children:"Pre-Baccalaureate"}),r.jsx("option",{value:"VocTech",children:"VocTech"}),r.jsx("option",{value:"Basic",children:"Basic"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Major/Specialization"}),r.jsx("input",{type:"text",value:i.major_name,onChange:f=>o("major_name",f.target.value),placeholder:"e.g., Software Engineering",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Major Code"}),r.jsx("input",{type:"number",value:i.major_code,onChange:f=>o("major_code",f.target.value),placeholder:"e.g., 201",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Academic Details"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AOP Category"}),r.jsxs("select",{value:i.aop_category,onChange:f=>o("aop_category",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200",children:[r.jsx("option",{value:"",children:"Select Category"}),r.jsx("option",{value:"Bachelor",children:"Bachelor"}),r.jsx("option",{value:"Master",children:"Master"}),r.jsx("option",{value:"Doctoral",children:"Doctoral"}),r.jsx("option",{value:"Certificate",children:"Certificate"}),r.jsx("option",{value:"Diploma",children:"Diploma"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AOP Serial"}),r.jsx("input",{type:"text",value:i.aop_serial,onChange:f=>o("aop_serial",f.target.value),placeholder:"e.g., AOP-001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AOP Year"}),r.jsx("input",{type:"number",value:i.aop_year,onChange:f=>o("aop_year",f.target.value),placeholder:"e.g., 2024",min:"2000",max:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Program Length (Years)"]}),r.jsx("input",{type:"number",value:i.program_normal_length_in_years,onChange:f=>o("program_normal_length_in_years",f.target.value),placeholder:"e.g., 4",min:"1",max:"10",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.program_normal_length_in_years?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_normal_length_in_years&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_normal_length_in_years})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Status"}),r.jsxs("select",{value:i.program_status,onChange:f=>o("program_status",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200",children:[r.jsx("option",{value:"ACTIVE",children:"Active"}),r.jsx("option",{value:"INACTIVE",children:"Inactive"}),r.jsx("option",{value:"SUSPENDED",children:"Suspended"}),r.jsx("option",{value:"PHASED_OUT",children:"Phased Out"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Xa,{className:"w-4 h-4 inline mr-1"}),"Calendar System"]}),r.jsxs("select",{value:i.calendar_use_code,onChange:f=>o("calendar_use_code",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200",children:[r.jsx("option",{value:"SEM",children:"Semester"}),r.jsx("option",{value:"TRI",children:"Trimester"}),r.jsx("option",{value:"QTR",children:"Quarter"}),r.jsx("option",{value:"ANN",children:"Annual"}),r.jsx("option",{value:"MOD",children:"Modular"})]})]})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"thesis_required_edit",checked:i.is_thesis_dissertation_required,onChange:f=>o("is_thesis_dissertation_required",f.target.checked),className:"h-4 w-4 text-emerald-600 focus:ring-emerald-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"thesis_required_edit",className:"ml-2 text-sm text-gray-700",children:"Thesis/Dissertation Required"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(e3,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Units & Finances"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Units Distribution"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.lecture_units,onChange:f=>o("lecture_units",f.target.value),placeholder:"Lecture",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.lecture_units?"border-red-300 bg-red-50":"border-gray-300"}`}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture Units"}),l.lecture_units&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.lecture_units})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.lab_units,onChange:f=>o("lab_units",f.target.value),placeholder:"Lab",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.lab_units?"border-red-300 bg-red-50":"border-gray-300"}`}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab Units"}),l.lab_units&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.lab_units})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.total_units,onChange:f=>o("total_units",f.target.value),placeholder:"Total",min:"0",className:"w-full px-3 py-2 border border-purple-300 rounded-lg bg-purple-50 transition-colors duration-200",readOnly:!0}),r.jsx("label",{className:"text-xs text-purple-600",children:"Total Units"})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(bn,{className:"w-4 h-4 inline mr-1"}),"Tuition per Unit ()"]}),r.jsx("input",{type:"number",value:i.tuition_per_unit,onChange:f=>o("tuition_per_unit",f.target.value),placeholder:"e.g., 500.00",min:"0",step:"0.01",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.tuition_per_unit?"border-red-300 bg-red-50":"border-gray-300"}`}),l.tuition_per_unit&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.tuition_per_unit})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Fee ()"}),r.jsx("input",{type:"number",value:i.program_fee,onChange:f=>o("program_fee",f.target.value),placeholder:"e.g., 5000.00",min:"0",step:"0.01",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.program_fee?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_fee&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_fee})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Year"}),r.jsx("select",{value:i.report_year,onChange:f=>o("report_year",f.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.report_year?"border-red-300 bg-red-50":"border-gray-300"}`,children:Array.from({length:10},(f,x)=>{const b=new Date().getFullYear()-x;return r.jsx("option",{value:b,children:b},b)})}),l.report_year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.report_year})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Enrollment Data"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Freshmen Students"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.new_students_freshmen_male,onChange:f=>o("new_students_freshmen_male",f.target.value),placeholder:"Male freshmen",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Male"})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.new_students_freshmen_female,onChange:f=>o("new_students_freshmen_female",f.target.value),placeholder:"Female freshmen",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Female"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Enrollment by Year Level"}),r.jsx("div",{className:"space-y-2",children:[1,2,3,4,5,6,7].map(f=>r.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center",children:[r.jsxs("label",{className:"text-sm text-gray-700 font-medium",children:[f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`," ","Year"]}),r.jsx("input",{type:"number",value:i[`${f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`}_year_male`],onChange:x=>o(`${f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`}_year_male`,x.target.value),placeholder:"Male",min:"0",className:"px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200 text-sm"}),r.jsx("input",{type:"number",value:i[`${f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`}_year_female`],onChange:x=>o(`${f===1?"1st":f===2?"2nd":f===3?"3rd":`${f}th`}_year_female`,x.target.value),placeholder:"Female",min:"0",className:"px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200 text-sm"})]},f))})]}),r.jsx("div",{className:"bg-white/60 rounded-lg p-3 border border-amber-300",children:r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-semibold text-blue-600",children:i.subtotal_male||0}),r.jsx("div",{className:"text-xs text-gray-600",children:"Total Male"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-semibold text-pink-600",children:i.subtotal_female||0}),r.jsx("div",{className:"text-xs text-gray-600",children:"Total Female"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-bold text-amber-900",children:i.grand_total||0}),r.jsx("div",{className:"text-xs text-amber-600",children:"Grand Total"})]})]})})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(Zr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduates"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Male Graduates"}),r.jsx("input",{type:"number",value:i.graduates_males,onChange:f=>o("graduates_males",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Female Graduates"}),r.jsx("input",{type:"number",value:i.graduates_females,onChange:f=>o("graduates_females",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Graduates"}),r.jsx("input",{type:"number",value:i.graduates_total,className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-slate-50 transition-colors duration-200",readOnly:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Actual Units Taken"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.lecture_units_actual,onChange:f=>o("lecture_units_actual",f.target.value),placeholder:"Lecture",min:"0",className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200 text-sm"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.laboratory_units_actual,onChange:f=>o("laboratory_units_actual",f.target.value),placeholder:"Lab",min:"0",className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200 text-sm"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",value:i.total_units_actual,onChange:f=>o("total_units_actual",f.target.value),placeholder:"Total",min:"0",className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200 text-sm"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Total"})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-cyan-100 rounded-xl p-4 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-indigo-500 rounded-lg shadow-sm",children:r.jsx(ys,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Scholarships & Aid"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"External Merit Scholars"}),r.jsx("input",{type:"number",value:i.externally_funded_merit_scholars,onChange:f=>o("externally_funded_merit_scholars",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Internal Grantees"}),r.jsx("input",{type:"number",value:i.internally_funded_grantees,onChange:f=>o("internally_funded_grantees",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Funded Students"}),r.jsx("input",{type:"number",value:i.funded_grantees,onChange:f=>o("funded_grantees",f.target.value),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200"})]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:h,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),r.jsx("button",{onClick:p,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2"}),"Update Program"]})})]})]})})}u5.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,programData:B.shape({id:B.oneOfType([B.string,B.number]),suc_details_id:B.oneOfType([B.string,B.number]),program_name:B.string,program_code:B.oneOfType([B.string,B.number]),major_name:B.string,major_code:B.oneOfType([B.string,B.number]),aop_category:B.string,aop_serial:B.string,aop_year:B.oneOfType([B.string,B.number]),is_thesis_dissertation_required:B.bool,program_status:B.string,calendar_use_code:B.string,program_normal_length_in_years:B.oneOfType([B.string,B.number]),lab_units:B.oneOfType([B.string,B.number]),lecture_units:B.oneOfType([B.string,B.number]),total_units:B.oneOfType([B.string,B.number]),tuition_per_unit:B.oneOfType([B.string,B.number]),program_fee:B.oneOfType([B.string,B.number]),program_type:B.string,new_students_freshmen_male:B.oneOfType([B.string,B.number]),new_students_freshmen_female:B.oneOfType([B.string,B.number]),"1st_year_male":B.oneOfType([B.string,B.number]),"1st_year_female":B.oneOfType([B.string,B.number]),"2nd_year_male":B.oneOfType([B.string,B.number]),"2nd_year_female":B.oneOfType([B.string,B.number]),"3rd_year_male":B.oneOfType([B.string,B.number]),"3rd_year_female":B.oneOfType([B.string,B.number]),"4th_year_male":B.oneOfType([B.string,B.number]),"4th_year_female":B.oneOfType([B.string,B.number]),"5th_year_male":B.oneOfType([B.string,B.number]),"5th_year_female":B.oneOfType([B.string,B.number]),"6th_year_male":B.oneOfType([B.string,B.number]),"6th_year_female":B.oneOfType([B.string,B.number]),"7th_year_male":B.oneOfType([B.string,B.number]),"7th_year_female":B.oneOfType([B.string,B.number]),subtotal_male:B.oneOfType([B.string,B.number]),subtotal_female:B.oneOfType([B.string,B.number]),grand_total:B.oneOfType([B.string,B.number]),lecture_units_actual:B.oneOfType([B.string,B.number]),laboratory_units_actual:B.oneOfType([B.string,B.number]),total_units_actual:B.oneOfType([B.string,B.number]),graduates_males:B.oneOfType([B.string,B.number]),graduates_females:B.oneOfType([B.string,B.number]),graduates_total:B.oneOfType([B.string,B.number]),externally_funded_merit_scholars:B.oneOfType([B.string,B.number]),internally_funded_grantees:B.oneOfType([B.string,B.number]),funded_grantees:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number])}),loading:B.bool};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var d5=1252,FO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ux={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},dx=function(t){FO.indexOf(t)!=-1&&(d5=ux[0]=t)};function IO(){dx(1252)}var fn=function(t){dx(t)};function f5(){fn(1200),IO()}function k2(t){for(var s=[],e=0,a=t.length;e<a;++e)s[e]=t.charCodeAt(e);return s}function LO(t){for(var s=[],e=0;e<t.length>>1;++e)s[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return s.join("")}function h5(t){for(var s=[],e=0;e<t.length>>1;++e)s[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return s.join("")}var xu=function(t){var s=t.charCodeAt(0),e=t.charCodeAt(1);return s==255&&e==254?LO(t.slice(2)):s==254&&e==255?h5(t.slice(2)):s==65279?t.slice(1):t},Nf=function(s){return String.fromCharCode(s)},C2=function(s){return String.fromCharCode(s)},rg,Ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function E2(t){for(var s="",e=0,a=0,n=0,i=0,c=0,l=0,u=0,o=0;o<t.length;)e=t.charCodeAt(o++),i=e>>2,a=t.charCodeAt(o++),c=(e&3)<<4|a>>4,n=t.charCodeAt(o++),l=(a&15)<<2|n>>6,u=n&63,isNaN(a)?l=u=64:isNaN(n)&&(u=64),s+=Ki.charAt(i)+Ki.charAt(c)+Ki.charAt(l)+Ki.charAt(u);return s}function Ta(t){var s="",e=0,a=0,n=0,i=0,c=0,l=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var o=0;o<t.length;)i=Ki.indexOf(t.charAt(o++)),c=Ki.indexOf(t.charAt(o++)),e=i<<2|c>>4,s+=String.fromCharCode(e),l=Ki.indexOf(t.charAt(o++)),a=(c&15)<<4|l>>2,l!==64&&(s+=String.fromCharCode(a)),u=Ki.indexOf(t.charAt(o++)),n=(l&3)<<6|u,u!==64&&(s+=String.fromCharCode(n));return s}var cr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),tl=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(s,e){return e?new Buffer(s,e):new Buffer(s)}:Buffer.from.bind(Buffer)}return function(){}}();function to(t){return cr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function T2(t){return cr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var dn=function(s){return cr?tl(s,"binary"):s.split("").map(function(e){return e.charCodeAt(0)&255})};function rl(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var s=[],e=0;e<t.length;++e)s[e]=String.fromCharCode(t[e]);return s.join("")}function fx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return fx(new Uint8Array(t));for(var s=new Array(t.length),e=0;e<t.length;++e)s[e]=t[e];return s}var Yi=cr?function(t){return Buffer.concat(t.map(function(s){return Buffer.isBuffer(s)?s:tl(s)}))}:function(t){if(typeof Uint8Array<"u"){var s=0,e=0;for(s=0;s<t.length;++s)e+=t[s].length;var a=new Uint8Array(e),n=0;for(s=0,e=0;s<t.length;e+=n,++s)if(n=t[s].length,t[s]instanceof Uint8Array)a.set(t[s],e);else{if(typeof t[s]=="string")throw"wtf";a.set(new Uint8Array(t[s]),e)}return a}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function PO(t){for(var s=[],e=0,a=t.length+250,n=to(t.length+255),i=0;i<t.length;++i){var c=t.charCodeAt(i);if(c<128)n[e++]=c;else if(c<2048)n[e++]=192|c>>6&31,n[e++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var l=t.charCodeAt(++i)&1023;n[e++]=240|c>>8&7,n[e++]=128|c>>2&63,n[e++]=128|l>>6&15|(c&3)<<4,n[e++]=128|l&63}else n[e++]=224|c>>12&15,n[e++]=128|c>>6&63,n[e++]=128|c&63;e>a&&(s.push(n.slice(0,e)),e=0,n=to(65535),a=65530)}return s.push(n.slice(0,e)),Yi(s)}var Js=/\u0000/g,bu=/[\u0001-\u0006]/g;function $l(t){for(var s="",e=t.length-1;e>=0;)s+=t.charAt(e--);return s}function hn(t,s){var e=""+t;return e.length>=s?e:Hr("0",s-e.length)+e}function hx(t,s){var e=""+t;return e.length>=s?e:Hr(" ",s-e.length)+e}function h0(t,s){var e=""+t;return e.length>=s?e:e+Hr(" ",s-e.length)}function BO(t,s){var e=""+Math.round(t);return e.length>=s?e:Hr("0",s-e.length)+e}function DO(t,s){var e=""+t;return e.length>=s?e:Hr("0",s-e.length)+e}var A2=Math.pow(2,32);function Fl(t,s){if(t>A2||t<-A2)return BO(t,s);var e=Math.round(t);return DO(e,s)}function m0(t,s){return s=s||0,t.length>=7+s&&(t.charCodeAt(s)|32)===103&&(t.charCodeAt(s+1)|32)===101&&(t.charCodeAt(s+2)|32)===110&&(t.charCodeAt(s+3)|32)===101&&(t.charCodeAt(s+4)|32)===114&&(t.charCodeAt(s+5)|32)===97&&(t.charCodeAt(s+6)|32)===108}var O2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],wp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function UO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},R2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$O={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function p0(t,s,e){for(var a=t<0?-1:1,n=t*a,i=0,c=1,l=0,u=1,o=0,d=0,g=Math.floor(n);o<s&&(g=Math.floor(n),l=g*c+i,d=g*o+u,!(n-g<5e-8));)n=1/(n-g),i=c,c=l,u=o,o=d;if(d>s&&(o>s?(d=u,l=i):(d=o,l=c)),!e)return[0,a*l,d];var p=Math.floor(a*l/d);return[p,a*l-p*d,d]}function Fo(t,s,e){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),i=0,c=[],l={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),s&&s.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++a,++l.D)),a===60)c=e?[1317,10,29]:[1900,2,29],i=3;else if(a===0)c=e?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),c=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),a<60&&(i=(i+6)%7),e&&(i=YO(u,c))}return l.y=c[0],l.m=c[1],l.d=c[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var m5=new Date(1899,11,31,0,0,0),zO=m5.getTime(),HO=new Date(1900,2,1,0,0,0);function p5(t,s){var e=t.getTime();return s?e-=1461*24*60*60*1e3:t>=HO&&(e+=24*60*60*1e3),(e-(zO+(t.getTimezoneOffset()-m5.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function mx(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function VO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qO(t){var s=t<0?12:11,e=mx(t.toFixed(12));return e.length<=s||(e=t.toPrecision(10),e.length<=s)?e:t.toExponential(5)}function GO(t){var s=mx(t.toFixed(11));return s.length>(t<0?12:11)||s==="0"||s==="-0"?t.toPrecision(6):s}function Pu(t){var s=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return s>=-4&&s<=-1?e=t.toPrecision(10+s):Math.abs(s)<=9?e=qO(t):s===10?e=t.toFixed(10).substr(0,12):e=GO(t),mx(VO(e.toUpperCase()))}function qo(t,s){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Pu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ja(14,p5(t,s&&s.date1904),s)}throw new Error("unsupported value in General format: "+t)}function YO(t,s){s[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function WO(t,s,e,a){var n="",i=0,c=0,l=e.y,u,o=0;switch(t){case 98:l=e.y+543;case 121:switch(s.length){case 1:case 2:u=l%100,o=2;break;default:u=l%1e4,o=4;break}break;case 109:switch(s.length){case 1:case 2:u=e.m,o=s.length;break;case 3:return wp[e.m-1][1];case 5:return wp[e.m-1][0];default:return wp[e.m-1][2]}break;case 100:switch(s.length){case 1:case 2:u=e.d,o=s.length;break;case 3:return O2[e.q][0];default:return O2[e.q][1]}break;case 104:switch(s.length){case 1:case 2:u=1+(e.H+11)%12,o=s.length;break;default:throw"bad hour format: "+s}break;case 72:switch(s.length){case 1:case 2:u=e.H,o=s.length;break;default:throw"bad hour format: "+s}break;case 77:switch(s.length){case 1:case 2:u=e.M,o=s.length;break;default:throw"bad minute format: "+s}break;case 115:if(s!="s"&&s!="ss"&&s!=".0"&&s!=".00"&&s!=".000")throw"bad second format: "+s;return e.u===0&&(s=="s"||s=="ss")?hn(e.S,s.length):(a>=2?c=a===3?1e3:100:c=a===1?10:1,i=Math.round(c*(e.S+e.u)),i>=60*c&&(i=0),s==="s"?i===0?"0":""+i/c:(n=hn(i,2+a),s==="ss"?n.substr(0,2):"."+n.substr(2,s.length-1)));case 90:switch(s){case"[h]":case"[hh]":u=e.D*24+e.H;break;case"[m]":case"[mm]":u=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":u=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+s}o=s.length===3?1:2;break;case 101:u=l,o=1;break}var d=o>0?hn(u,o):"";return d}function Zi(t){var s=3;if(t.length<=s)return t;for(var e=t.length%s,a=t.substr(0,e);e!=t.length;e+=s)a+=(a.length>0?",":"")+t.substr(e,s);return a}var g5=/%/g;function XO(t,s,e){var a=s.replace(g5,""),n=s.length-a.length;return fi(t,a,e*Math.pow(10,2*n))+Hr("%",n)}function KO(t,s,e){for(var a=s.length-1;s.charCodeAt(a-1)===44;)--a;return fi(t,s.substr(0,a),e/Math.pow(10,3*(s.length-a)))}function x5(t,s){var e,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+x5(t,-s);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(s)*Math.LOG10E)%n;if(i<0&&(i+=n),e=(s/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),e.indexOf("e")===-1){var c=Math.floor(Math.log(s)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(c-e.length+i):e+="E+"+(c-i);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,n)+"."+e.substr(2+n),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,o,d){return u+o+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else e=s.toExponential(a);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var b5=/# (\?+)( ?)\/( ?)(\d+)/;function ZO(t,s,e){var a=parseInt(t[4],10),n=Math.round(s*a),i=Math.floor(n/a),c=n-i*a,l=a;return e+(i===0?"":""+i)+" "+(c===0?Hr(" ",t[1].length+1+t[4].length):hx(c,t[1].length)+t[2]+"/"+t[3]+hn(l,t[4].length))}function QO(t,s,e){return e+(s===0?"":""+s)+Hr(" ",t[1].length+2+t[4].length)}var y5=/^#*0*\.([0#]+)/,v5=/\).*[0#]/,_5=/\(###\) ###\\?-####/;function Ks(t){for(var s="",e,a=0;a!=t.length;++a)switch(e=t.charCodeAt(a)){case 35:break;case 63:s+=" ";break;case 48:s+="0";break;default:s+=String.fromCharCode(e)}return s}function M2(t,s){var e=Math.pow(10,s);return""+Math.round(t*e)/e}function F2(t,s){var e=t-Math.floor(t),a=Math.pow(10,s);return s<(""+Math.round(e*a)).length?0:Math.round(e*a)}function JO(t,s){return s<(""+Math.round((t-Math.floor(t))*Math.pow(10,s))).length?1:0}function eR(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function qa(t,s,e){if(t.charCodeAt(0)===40&&!s.match(v5)){var a=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?qa("n",a,e):"("+qa("n",a,-e)+")"}if(s.charCodeAt(s.length-1)===44)return KO(t,s,e);if(s.indexOf("%")!==-1)return XO(t,s,e);if(s.indexOf("E")!==-1)return x5(s,e);if(s.charCodeAt(0)===36)return"$"+qa(t,s.substr(s.charAt(1)==" "?2:1),e);var n,i,c,l,u=Math.abs(e),o=e<0?"-":"";if(s.match(/^00+$/))return o+Fl(u,s.length);if(s.match(/^[#?]+$/))return n=Fl(e,0),n==="0"&&(n=""),n.length>s.length?n:Ks(s.substr(0,s.length-n.length))+n;if(i=s.match(b5))return ZO(i,u,o);if(s.match(/^#+0+$/))return o+Fl(u,s.length-s.indexOf("0"));if(i=s.match(y5))return n=M2(e,i[1].length).replace(/^([^\.]+)$/,"$1."+Ks(i[1])).replace(/\.$/,"."+Ks(i[1])).replace(/\.(\d*)$/,function(f,x){return"."+x+Hr("0",Ks(i[1]).length-x.length)}),s.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),i=s.match(/^(0*)\.(#*)$/))return o+M2(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=s.match(/^#{1,3},##0(\.?)$/))return o+Zi(Fl(u,0));if(i=s.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+qa(t,s,-e):Zi(""+(Math.floor(e)+JO(e,i[1].length)))+"."+hn(F2(e,i[1].length),i[1].length);if(i=s.match(/^#,#*,#0/))return qa(t,s.replace(/^#,#*,/,""),e);if(i=s.match(/^([0#]+)(\\?-([0#]+))+$/))return n=$l(qa(t,s.replace(/[\\-]/g,""),e)),c=0,$l($l(s.replace(/\\/g,"")).replace(/[0#]/g,function(f){return c<n.length?n.charAt(c++):f==="0"?"0":""}));if(s.match(_5))return n=qa(t,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(i[4].length,7),l=p0(u,Math.pow(10,c)-1,!1),n=""+o,d=fi("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=h0(l[2],c),d.length<i[4].length&&(d=Ks(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(i[1].length,i[4].length),7),l=p0(u,Math.pow(10,c)-1,!0),o+(l[0]||(l[1]?"":"0"))+" "+(l[1]?hx(l[1],c)+i[2]+"/"+i[3]+h0(l[2],c):Hr(" ",2*c+1+i[2].length+i[3].length));if(i=s.match(/^[#0?]+$/))return n=Fl(e,0),s.length<=n.length?n:Ks(s.substr(0,s.length-n.length))+n;if(i=s.match(/^([#0?]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),c=n.indexOf(".");var g=s.indexOf(".")-c,p=s.length-n.length-g;return Ks(s.substr(0,g)+n+s.substr(s.length-p))}if(i=s.match(/^00,000\.([#0]*0)$/))return c=F2(e,i[1].length),e<0?"-"+qa(t,s,-e):Zi(eR(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(f){return"00,"+(f.length<3?hn(0,3-f.length):"")+f})+"."+hn(c,i[1].length);switch(s){case"###,##0.00":return qa(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var h=Zi(Fl(u,0));return h!=="0"?o+h:"";case"###,###.00":return qa(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return qa(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+s+"|")}function tR(t,s,e){for(var a=s.length-1;s.charCodeAt(a-1)===44;)--a;return fi(t,s.substr(0,a),e/Math.pow(10,3*(s.length-a)))}function rR(t,s,e){var a=s.replace(g5,""),n=s.length-a.length;return fi(t,a,e*Math.pow(10,2*n))+Hr("%",n)}function w5(t,s){var e,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+w5(t,-s);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(s)*Math.LOG10E)%n;if(i<0&&(i+=n),e=(s/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!e.match(/[Ee]/)){var c=Math.floor(Math.log(s)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(c-e.length+i):e+="E+"+(c-i),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,o,d){return u+o+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else e=s.toExponential(a);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Mn(t,s,e){if(t.charCodeAt(0)===40&&!s.match(v5)){var a=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Mn("n",a,e):"("+Mn("n",a,-e)+")"}if(s.charCodeAt(s.length-1)===44)return tR(t,s,e);if(s.indexOf("%")!==-1)return rR(t,s,e);if(s.indexOf("E")!==-1)return w5(s,e);if(s.charCodeAt(0)===36)return"$"+Mn(t,s.substr(s.charAt(1)==" "?2:1),e);var n,i,c,l,u=Math.abs(e),o=e<0?"-":"";if(s.match(/^00+$/))return o+hn(u,s.length);if(s.match(/^[#?]+$/))return n=""+e,e===0&&(n=""),n.length>s.length?n:Ks(s.substr(0,s.length-n.length))+n;if(i=s.match(b5))return QO(i,u,o);if(s.match(/^#+0+$/))return o+hn(u,s.length-s.indexOf("0"));if(i=s.match(y5))return n=(""+e).replace(/^([^\.]+)$/,"$1."+Ks(i[1])).replace(/\.$/,"."+Ks(i[1])),n=n.replace(/\.(\d*)$/,function(f,x){return"."+x+Hr("0",Ks(i[1]).length-x.length)}),s.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),i=s.match(/^(0*)\.(#*)$/))return o+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=s.match(/^#{1,3},##0(\.?)$/))return o+Zi(""+u);if(i=s.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Mn(t,s,-e):Zi(""+e)+"."+Hr("0",i[1].length);if(i=s.match(/^#,#*,#0/))return Mn(t,s.replace(/^#,#*,/,""),e);if(i=s.match(/^([0#]+)(\\?-([0#]+))+$/))return n=$l(Mn(t,s.replace(/[\\-]/g,""),e)),c=0,$l($l(s.replace(/\\/g,"")).replace(/[0#]/g,function(f){return c<n.length?n.charAt(c++):f==="0"?"0":""}));if(s.match(_5))return n=Mn(t,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(i[4].length,7),l=p0(u,Math.pow(10,c)-1,!1),n=""+o,d=fi("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=h0(l[2],c),d.length<i[4].length&&(d=Ks(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(i[1].length,i[4].length),7),l=p0(u,Math.pow(10,c)-1,!0),o+(l[0]||(l[1]?"":"0"))+" "+(l[1]?hx(l[1],c)+i[2]+"/"+i[3]+h0(l[2],c):Hr(" ",2*c+1+i[2].length+i[3].length));if(i=s.match(/^[#0?]+$/))return n=""+e,s.length<=n.length?n:Ks(s.substr(0,s.length-n.length))+n;if(i=s.match(/^([#0]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),c=n.indexOf(".");var g=s.indexOf(".")-c,p=s.length-n.length-g;return Ks(s.substr(0,g)+n+s.substr(s.length-p))}if(i=s.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Mn(t,s,-e):Zi(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(f){return"00,"+(f.length<3?hn(0,3-f.length):"")+f})+"."+hn(0,i[1].length);switch(s){case"###,###":case"##,###":case"#,###":var h=Zi(""+u);return h!=="0"?o+h:"";default:if(s.match(/\.[0#?]*$/))return Mn(t,s.slice(0,s.lastIndexOf(".")),e)+Ks(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}function fi(t,s,e){return(e|0)===e?Mn(t,s,e):qa(t,s,e)}function sR(t){for(var s=[],e=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:e=!e;break;case 95:case 42:case 92:++a;break;case 59:s[s.length]=t.substr(n,a-n),n=a+1}if(s[s.length]=t.substr(n),e===!0)throw new Error("Format |"+t+"| unterminated string ");return s}var N5=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fc(t){for(var s=0,e="",a="";s<t.length;)switch(e=t.charAt(s)){case"G":m0(t,s)&&(s+=6),s++;break;case'"':for(;t.charCodeAt(++s)!==34&&s<t.length;);++s;break;case"\\":s+=2;break;case"_":s+=2;break;case"@":++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(s,3).toUpperCase()==="A/P"||t.substr(s,5).toUpperCase()==="AM/PM"||t.substr(s,5).toUpperCase()==="/")return!0;++s;break;case"[":for(a=e;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.match(N5))return!0;break;case".":case"0":case"#":for(;s<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++s))>-1||e=="\\"&&t.charAt(s+1)=="-"&&"0#".indexOf(t.charAt(s+2))>-1););break;case"?":for(;t.charAt(++s)===e;);break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;);break;case" ":++s;break;default:++s;break}return!1}function aR(t,s,e,a){for(var n=[],i="",c=0,l="",u="t",o,d,g,p="H";c<t.length;)switch(l=t.charAt(c)){case"G":if(!m0(t,c))throw new Error("unrecognized character "+l+" in "+t);n[n.length]={t:"G",v:"General"},c+=7;break;case'"':for(i="";(g=t.charCodeAt(++c))!==34&&c<t.length;)i+=String.fromCharCode(g);n[n.length]={t:"t",v:i},++c;break;case"\\":var h=t.charAt(++c),f=h==="("||h===")"?h:"t";n[n.length]={t:f,v:h},++c;break;case"_":n[n.length]={t:"t",v:" "},c+=2;break;case"@":n[n.length]={t:"T",v:s},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(o==null&&(o=Fo(s,e,t.charAt(c+1)==="2"),o==null))return"";n[n.length]={t:"X",v:t.substr(c,2)},u=l,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(s<0||o==null&&(o=Fo(s,e),o==null))return"";for(i=l;++c<t.length&&t.charAt(c).toLowerCase()===l;)i+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),n[n.length]={t:l,v:i},u=l;break;case"A":case"a":case"":var x={t:l,v:l};if(o==null&&(o=Fo(s,e)),t.substr(c,3).toUpperCase()==="A/P"?(o!=null&&(x.v=o.H>=12?"P":"A"),x.t="T",p="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(o!=null&&(x.v=o.H>=12?"PM":"AM"),x.t="T",c+=5,p="h"):t.substr(c,5).toUpperCase()==="/"?(o!=null&&(x.v=o.H>=12?"":""),x.t="T",c+=5,p="h"):(x.t="t",++c),o==null&&x.t==="T")return"";n[n.length]=x,u=l;break;case"[":for(i=l;t.charAt(c++)!=="]"&&c<t.length;)i+=t.charAt(c);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(N5)){if(o==null&&(o=Fo(s,e),o==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",fc(t)||(n[n.length]={t:"t",v:i}));break;case".":if(o!=null){for(i=l;++c<t.length&&(l=t.charAt(c))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++c<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(c))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;t.charAt(++c)===l;)i+=l;n[n.length]={t:l,v:i},u=l;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":n[n.length]={t:a===1?"t":l,v:l},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)i+=t.charAt(c);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++c;break;case"$":n[n.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);n[n.length]={t:"t",v:l},++c;break}var b=0,v=0,_;for(c=n.length-1,u="t";c>=0;--c)switch(n[c].t){case"h":case"H":n[c].t=p,u="h",b<1&&(b=1);break;case"s":(_=n[c].v.match(/\.0+$/))&&(v=Math.max(v,_[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":u=n[c].t;break;case"m":u==="s"&&(n[c].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&n[c].v.match(/[Hh]/)&&(b=1),b<2&&n[c].v.match(/[Mm]/)&&(b=2),b<3&&n[c].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M),o.M>=60&&(o.M=0,++o.H);break;case 2:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M);break}var N="",E;for(c=0;c<n.length;++c)switch(n[c].t){case"t":case"T":case" ":case"D":break;case"X":n[c].v="",n[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[c].v=WO(n[c].t.charCodeAt(0),n[c].v,o,v),n[c].t="t";break;case"n":case"?":for(E=c+1;n[E]!=null&&((l=n[E].t)==="?"||l==="D"||(l===" "||l==="t")&&n[E+1]!=null&&(n[E+1].t==="?"||n[E+1].t==="t"&&n[E+1].v==="/")||n[c].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[E].v==="/"||n[E].v===" "&&n[E+1]!=null&&n[E+1].t=="?"));)n[c].v+=n[E].v,n[E]={v:"",t:";"},++E;N+=n[c].v,c=E-1;break;case"G":n[c].t="t",n[c].v=qo(s,e);break}var O="",F,z;if(N.length>0){N.charCodeAt(0)==40?(F=s<0&&N.charCodeAt(0)===45?-s:s,z=fi("n",N,F)):(F=s<0&&a>1?-s:s,z=fi("n",N,F),F<0&&n[0]&&n[0].t=="t"&&(z=z.substr(1),n[0].v="-"+n[0].v)),E=z.length-1;var P=n.length;for(c=0;c<n.length;++c)if(n[c]!=null&&n[c].t!="t"&&n[c].v.indexOf(".")>-1){P=c;break}var U=n.length;if(P===n.length&&z.indexOf("E")===-1){for(c=n.length-1;c>=0;--c)n[c]==null||"n?".indexOf(n[c].t)===-1||(E>=n[c].v.length-1?(E-=n[c].v.length,n[c].v=z.substr(E+1,n[c].v.length)):E<0?n[c].v="":(n[c].v=z.substr(0,E+1),E=-1),n[c].t="t",U=c);E>=0&&U<n.length&&(n[U].v=z.substr(0,E+1)+n[U].v)}else if(P!==n.length&&z.indexOf("E")===-1){for(E=z.indexOf(".")-1,c=P;c>=0;--c)if(!(n[c]==null||"n?".indexOf(n[c].t)===-1)){for(d=n[c].v.indexOf(".")>-1&&c===P?n[c].v.indexOf(".")-1:n[c].v.length-1,O=n[c].v.substr(d+1);d>=0;--d)E>=0&&(n[c].v.charAt(d)==="0"||n[c].v.charAt(d)==="#")&&(O=z.charAt(E--)+O);n[c].v=O,n[c].t="t",U=c}for(E>=0&&U<n.length&&(n[U].v=z.substr(0,E+1)+n[U].v),E=z.indexOf(".")+1,c=P;c<n.length;++c)if(!(n[c]==null||"n?(".indexOf(n[c].t)===-1&&c!==P)){for(d=n[c].v.indexOf(".")>-1&&c===P?n[c].v.indexOf(".")+1:0,O=n[c].v.substr(0,d);d<n[c].v.length;++d)E<z.length&&(O+=z.charAt(E++));n[c].v=O,n[c].t="t",U=c}}}for(c=0;c<n.length;++c)n[c]!=null&&"n?".indexOf(n[c].t)>-1&&(F=a>1&&s<0&&c>0&&n[c-1].v==="-"?-s:s,n[c].v=fi(n[c].t,n[c].v,F),n[c].t="t");var W="";for(c=0;c!==n.length;++c)n[c]!=null&&(W+=n[c].v);return W}var I2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function L2(t,s){if(s==null)return!1;var e=parseFloat(s[2]);switch(s[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function nR(t,s){var e=sR(t),a=e.length,n=e[a-1].indexOf("@");if(a<4&&n>-1&&--a,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof s!="number")return[4,e.length===4||n>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=n>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=n>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=n>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var i=s>0?e[0]:s<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[a,i];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var c=e[0].match(I2),l=e[1].match(I2);return L2(s,c)?[a,e[0]]:L2(s,l)?[a,e[1]]:[a,e[c!=null&&l!=null?2:1]]}return[a,i]}function Ja(t,s,e){e==null&&(e={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?a=e.dateNF:a=t;break;case"number":t==14&&e.dateNF?a=e.dateNF:a=(e.table!=null?e.table:Kt)[t],a==null&&(a=e.table&&e.table[R2[t]]||Kt[R2[t]]),a==null&&(a=$O[t]||"General");break}if(m0(a,0))return qo(s,e);s instanceof Date&&(s=p5(s,e.date1904));var n=nR(a,s);if(m0(n[1]))return qo(s,e);if(s===!0)s="TRUE";else if(s===!1)s="FALSE";else if(s===""||s==null)return"";return aR(n[1],s,e,n[0])}function Bo(t,s){if(typeof s!="number"){s=+s||-1;for(var e=0;e<392;++e){if(Kt[e]==null){s<0&&(s=e);continue}if(Kt[e]==t){s=e;break}}s<0&&(s=391)}return Kt[s]=t,s}function j5(){Kt=UO()}var iR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},S5=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function oR(t){var s=typeof t=="number"?Kt[t]:t;return s=s.replace(S5,"(\\d+)"),new RegExp("^"+s+"$")}function lR(t,s,e){var a=-1,n=-1,i=-1,c=-1,l=-1,u=-1;(s.match(S5)||[]).forEach(function(g,p){var h=parseInt(e[p+1],10);switch(g.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":c=h;break;case"s":u=h;break;case"m":c>=0?l=h:n=h;break}}),u>=0&&l==-1&&n>=0&&(l=n,n=-1);var o=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);o.length==7&&(o="0"+o),o.length==8&&(o="20"+o);var d=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return c==-1&&l==-1&&u==-1?o:a==-1&&n==-1&&i==-1?d:o+"T"+d}var cR=function(){var t={};t.version="1.2.0";function s(){for(var z=0,P=new Array(256),U=0;U!=256;++U)z=U,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,P[U]=z;return typeof Int32Array<"u"?new Int32Array(P):P}var e=s();function a(z){var P=0,U=0,W=0,Y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)Y[W]=z[W];for(W=0;W!=256;++W)for(U=z[W],P=256+W;P<4096;P+=256)U=Y[P]=U>>>8^z[U&255];var q=[];for(W=1;W!=16;++W)q[W-1]=typeof Int32Array<"u"?Y.subarray(W*256,W*256+256):Y.slice(W*256,W*256+256);return q}var n=a(e),i=n[0],c=n[1],l=n[2],u=n[3],o=n[4],d=n[5],g=n[6],p=n[7],h=n[8],f=n[9],x=n[10],b=n[11],v=n[12],_=n[13],N=n[14];function E(z,P){for(var U=P^-1,W=0,Y=z.length;W<Y;)U=U>>>8^e[(U^z.charCodeAt(W++))&255];return~U}function O(z,P){for(var U=P^-1,W=z.length-15,Y=0;Y<W;)U=N[z[Y++]^U&255]^_[z[Y++]^U>>8&255]^v[z[Y++]^U>>16&255]^b[z[Y++]^U>>>24]^x[z[Y++]]^f[z[Y++]]^h[z[Y++]]^p[z[Y++]]^g[z[Y++]]^d[z[Y++]]^o[z[Y++]]^u[z[Y++]]^l[z[Y++]]^c[z[Y++]]^i[z[Y++]]^e[z[Y++]];for(W+=15;Y<W;)U=U>>>8^e[(U^z[Y++])&255];return~U}function F(z,P){for(var U=P^-1,W=0,Y=z.length,q=0,M=0;W<Y;)q=z.charCodeAt(W++),q<128?U=U>>>8^e[(U^q)&255]:q<2048?(U=U>>>8^e[(U^(192|q>>6&31))&255],U=U>>>8^e[(U^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,M=z.charCodeAt(W++)&1023,U=U>>>8^e[(U^(240|q>>8&7))&255],U=U>>>8^e[(U^(128|q>>2&63))&255],U=U>>>8^e[(U^(128|M>>6&15|(q&3)<<4))&255],U=U>>>8^e[(U^(128|M&63))&255]):(U=U>>>8^e[(U^(224|q>>12&15))&255],U=U>>>8^e[(U^(128|q>>6&63))&255],U=U>>>8^e[(U^(128|q&63))&255]);return~U}return t.table=e,t.bstr=E,t.buf=O,t.str=F,t}(),fr=function(){var s={};s.version="1.2.1";function e(de,be){for(var me=de.split("/"),ge=be.split("/"),ye=0,ve=0,Le=Math.min(me.length,ge.length);ye<Le;++ye){if(ve=me[ye].length-ge[ye].length)return ve;if(me[ye]!=ge[ye])return me[ye]<ge[ye]?-1:1}return me.length-ge.length}function a(de){if(de.charAt(de.length-1)=="/")return de.slice(0,-1).indexOf("/")===-1?de:a(de.slice(0,-1));var be=de.lastIndexOf("/");return be===-1?de:de.slice(0,be+1)}function n(de){if(de.charAt(de.length-1)=="/")return n(de.slice(0,-1));var be=de.lastIndexOf("/");return be===-1?de:de.slice(be+1)}function i(de,be){typeof be=="string"&&(be=new Date(be));var me=be.getHours();me=me<<6|be.getMinutes(),me=me<<5|be.getSeconds()>>>1,de.write_shift(2,me);var ge=be.getFullYear()-1980;ge=ge<<4|be.getMonth()+1,ge=ge<<5|be.getDate(),de.write_shift(2,ge)}function c(de){var be=de.read_shift(2)&65535,me=de.read_shift(2)&65535,ge=new Date,ye=me&31;me>>>=5;var ve=me&15;me>>>=4,ge.setMilliseconds(0),ge.setFullYear(me+1980),ge.setMonth(ve-1),ge.setDate(ye);var Le=be&31;be>>>=5;var qe=be&63;return be>>>=6,ge.setHours(be),ge.setMinutes(qe),ge.setSeconds(Le<<1),ge}function l(de){ks(de,0);for(var be={},me=0;de.l<=de.length-4;){var ge=de.read_shift(2),ye=de.read_shift(2),ve=de.l+ye,Le={};switch(ge){case 21589:me=de.read_shift(1),me&1&&(Le.mtime=de.read_shift(4)),ye>5&&(me&2&&(Le.atime=de.read_shift(4)),me&4&&(Le.ctime=de.read_shift(4))),Le.mtime&&(Le.mt=new Date(Le.mtime*1e3));break}de.l=ve,be[ge]=Le}return be}var u;function o(){return u||(u={})}function d(de,be){if(de[0]==80&&de[1]==75)return Nt(de,be);if((de[0]|32)==109&&(de[1]|32)==105)return St(de,be);if(de.length<512)throw new Error("CFB file size "+de.length+" < 512");var me=3,ge=512,ye=0,ve=0,Le=0,qe=0,Be=0,$e=[],ze=de.slice(0,512);ks(ze,0);var nt=g(ze);switch(me=nt[0],me){case 3:ge=512;break;case 4:ge=4096;break;case 0:if(nt[1]==0)return Nt(de,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+me)}ge!==512&&(ze=de.slice(0,ge),ks(ze,28));var ht=de.slice(0,ge);p(ze,me);var xt=ze.read_shift(4,"i");if(me===3&&xt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xt);ze.l+=4,Le=ze.read_shift(4,"i"),ze.l+=4,ze.chk("00100000","Mini Stream Cutoff Size: "),qe=ze.read_shift(4,"i"),ye=ze.read_shift(4,"i"),Be=ze.read_shift(4,"i"),ve=ze.read_shift(4,"i");for(var pe=-1,Ce=0;Ce<109&&(pe=ze.read_shift(4,"i"),!(pe<0));++Ce)$e[Ce]=pe;var Ye=h(de,ge);b(Be,ve,Ye,ge,$e);var tt=_(Ye,Le,$e,ge);tt[Le].name="!Directory",ye>0&&qe!==M&&(tt[qe].name="!MiniFAT"),tt[$e[0]].name="!FAT",tt.fat_addrs=$e,tt.ssz=ge;var gt={},ft=[],pt=[],Yt=[];N(Le,tt,Ye,ft,ye,gt,pt,qe),f(pt,Yt,ft),ft.shift();var Dt={FileIndex:pt,FullPaths:Yt};return be&&be.raw&&(Dt.raw={header:ht,sectors:Ye}),Dt}function g(de){if(de[de.l]==80&&de[de.l+1]==75)return[0,0];de.chk(D,"Header Signature: "),de.l+=16;var be=de.read_shift(2,"u");return[de.read_shift(2,"u"),be]}function p(de,be){var me=9;switch(de.l+=2,me=de.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+me);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+me);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+me)}de.chk("0600","Mini Sector Shift: "),de.chk("000000000000","Reserved: ")}function h(de,be){for(var me=Math.ceil(de.length/be)-1,ge=[],ye=1;ye<me;++ye)ge[ye-1]=de.slice(ye*be,(ye+1)*be);return ge[me-1]=de.slice(me*be),ge}function f(de,be,me){for(var ge=0,ye=0,ve=0,Le=0,qe=0,Be=me.length,$e=[],ze=[];ge<Be;++ge)$e[ge]=ze[ge]=ge,be[ge]=me[ge];for(;qe<ze.length;++qe)ge=ze[qe],ye=de[ge].L,ve=de[ge].R,Le=de[ge].C,$e[ge]===ge&&(ye!==-1&&$e[ye]!==ye&&($e[ge]=$e[ye]),ve!==-1&&$e[ve]!==ve&&($e[ge]=$e[ve])),Le!==-1&&($e[Le]=ge),ye!==-1&&ge!=$e[ge]&&($e[ye]=$e[ge],ze.lastIndexOf(ye)<qe&&ze.push(ye)),ve!==-1&&ge!=$e[ge]&&($e[ve]=$e[ge],ze.lastIndexOf(ve)<qe&&ze.push(ve));for(ge=1;ge<Be;++ge)$e[ge]===ge&&(ve!==-1&&$e[ve]!==ve?$e[ge]=$e[ve]:ye!==-1&&$e[ye]!==ye&&($e[ge]=$e[ye]));for(ge=1;ge<Be;++ge)if(de[ge].type!==0){if(qe=ge,qe!=$e[qe])do qe=$e[qe],be[ge]=be[qe]+"/"+be[ge];while(qe!==0&&$e[qe]!==-1&&qe!=$e[qe]);$e[ge]=-1}for(be[0]+="/",ge=1;ge<Be;++ge)de[ge].type!==2&&(be[ge]+="/")}function x(de,be,me){for(var ge=de.start,ye=de.size,ve=[],Le=ge;me&&ye>0&&Le>=0;)ve.push(be.slice(Le*q,Le*q+q)),ye-=q,Le=Ro(me,Le*4);return ve.length===0?ds(0):Yi(ve).slice(0,de.size)}function b(de,be,me,ge,ye){var ve=M;if(de===M){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(de!==-1){var Le=me[de],qe=(ge>>>2)-1;if(!Le)return;for(var Be=0;Be<qe&&(ve=Ro(Le,Be*4))!==M;++Be)ye.push(ve);b(Ro(Le,ge-4),be-1,me,ge,ye)}}function v(de,be,me,ge,ye){var ve=[],Le=[];ye||(ye=[]);var qe=ge-1,Be=0,$e=0;for(Be=be;Be>=0;){ye[Be]=!0,ve[ve.length]=Be,Le.push(de[Be]);var ze=me[Math.floor(Be*4/ge)];if($e=Be*4&qe,ge<4+$e)throw new Error("FAT boundary crossed: "+Be+" 4 "+ge);if(!de[ze])break;Be=Ro(de[ze],$e)}return{nodes:ve,data:G2([Le])}}function _(de,be,me,ge){var ye=de.length,ve=[],Le=[],qe=[],Be=[],$e=ge-1,ze=0,nt=0,ht=0,xt=0;for(ze=0;ze<ye;++ze)if(qe=[],ht=ze+be,ht>=ye&&(ht-=ye),!Le[ht]){Be=[];var pe=[];for(nt=ht;nt>=0;){pe[nt]=!0,Le[nt]=!0,qe[qe.length]=nt,Be.push(de[nt]);var Ce=me[Math.floor(nt*4/ge)];if(xt=nt*4&$e,ge<4+xt)throw new Error("FAT boundary crossed: "+nt+" 4 "+ge);if(!de[Ce]||(nt=Ro(de[Ce],xt),pe[nt]))break}ve[ht]={nodes:qe,data:G2([Be])}}return ve}function N(de,be,me,ge,ye,ve,Le,qe){for(var Be=0,$e=ge.length?2:0,ze=be[de].data,nt=0,ht=0,xt;nt<ze.length;nt+=128){var pe=ze.slice(nt,nt+128);ks(pe,64),ht=pe.read_shift(2),xt=yx(pe,0,ht-$e),ge.push(xt);var Ce={name:xt,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Ye=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Ye!==0&&(Ce.ct=E(pe,pe.l-8));var tt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);tt!==0&&(Ce.mt=E(pe,pe.l-8)),Ce.start=pe.read_shift(4,"i"),Ce.size=pe.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=M,Ce.name=""),Ce.type===5?(Be=Ce.start,ye>0&&Be!==M&&(be[Be].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",be[Ce.start]===void 0&&(be[Ce.start]=v(me,Ce.start,be.fat_addrs,be.ssz)),be[Ce.start].name=Ce.name,Ce.content=be[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:Be!==M&&Ce.start!==M&&be[Be]&&(Ce.content=x(Ce,be[Be].data,(be[qe]||{}).data))),Ce.content&&ks(Ce.content,0),ve[xt]=Ce,Le.push(Ce)}}function E(de,be){return new Date((wa(de,be+4)/1e7*Math.pow(2,32)+wa(de,be)/1e7-11644473600)*1e3)}function O(de,be){return o(),d(u.readFileSync(de),be)}function F(de,be){var me=be&&be.type;switch(me||cr&&Buffer.isBuffer(de)&&(me="buffer"),me||"base64"){case"file":return O(de,be);case"base64":return d(dn(Ta(de)),be);case"binary":return d(dn(de),be)}return d(de,be)}function z(de,be){var me=be||{},ge=me.root||"Root Entry";if(de.FullPaths||(de.FullPaths=[]),de.FileIndex||(de.FileIndex=[]),de.FullPaths.length!==de.FileIndex.length)throw new Error("inconsistent CFB structure");de.FullPaths.length===0&&(de.FullPaths[0]=ge+"/",de.FileIndex[0]={name:ge,type:5}),me.CLSID&&(de.FileIndex[0].clsid=me.CLSID),P(de)}function P(de){var be="Sh33tJ5";if(!fr.find(de,"/"+be)){var me=ds(4);me[0]=55,me[1]=me[3]=50,me[2]=54,de.FileIndex.push({name:be,type:2,content:me,size:4,L:69,R:69,C:69}),de.FullPaths.push(de.FullPaths[0]+be),U(de)}}function U(de,be){z(de);for(var me=!1,ge=!1,ye=de.FullPaths.length-1;ye>=0;--ye){var ve=de.FileIndex[ye];switch(ve.type){case 0:ge?me=!0:(de.FileIndex.pop(),de.FullPaths.pop());break;case 1:case 2:case 5:ge=!0,isNaN(ve.R*ve.L*ve.C)&&(me=!0),ve.R>-1&&ve.L>-1&&ve.R==ve.L&&(me=!0);break;default:me=!0;break}}if(!(!me&&!be)){var Le=new Date(1987,1,19),qe=0,Be=Object.create?Object.create(null):{},$e=[];for(ye=0;ye<de.FullPaths.length;++ye)Be[de.FullPaths[ye]]=!0,de.FileIndex[ye].type!==0&&$e.push([de.FullPaths[ye],de.FileIndex[ye]]);for(ye=0;ye<$e.length;++ye){var ze=a($e[ye][0]);ge=Be[ze],ge||($e.push([ze,{name:n(ze).replace("/",""),type:1,clsid:C,ct:Le,mt:Le,content:null}]),Be[ze]=!0)}for($e.sort(function(xt,pe){return e(xt[0],pe[0])}),de.FullPaths=[],de.FileIndex=[],ye=0;ye<$e.length;++ye)de.FullPaths[ye]=$e[ye][0],de.FileIndex[ye]=$e[ye][1];for(ye=0;ye<$e.length;++ye){var nt=de.FileIndex[ye],ht=de.FullPaths[ye];if(nt.name=n(ht).replace("/",""),nt.L=nt.R=nt.C=-(nt.color=1),nt.size=nt.content?nt.content.length:0,nt.start=0,nt.clsid=nt.clsid||C,ye===0)nt.C=$e.length>1?1:-1,nt.size=0,nt.type=5;else if(ht.slice(-1)=="/"){for(qe=ye+1;qe<$e.length&&a(de.FullPaths[qe])!=ht;++qe);for(nt.C=qe>=$e.length?-1:qe,qe=ye+1;qe<$e.length&&a(de.FullPaths[qe])!=a(ht);++qe);nt.R=qe>=$e.length?-1:qe,nt.type=1}else a(de.FullPaths[ye+1]||"")==a(ht)&&(nt.R=ye+1),nt.type=2}}}function W(de,be){var me=be||{};if(me.fileType=="mad")return et(de,me);switch(U(de),me.fileType){case"zip":return Et(de,me)}var ge=function(xt){for(var pe=0,Ce=0,Ye=0;Ye<xt.FileIndex.length;++Ye){var tt=xt.FileIndex[Ye];if(tt.content){var gt=tt.content.length;gt>0&&(gt<4096?pe+=gt+63>>6:Ce+=gt+511>>9)}}for(var ft=xt.FullPaths.length+3>>2,pt=pe+7>>3,Yt=pe+127>>7,Dt=pt+Ce+ft+Yt,Ut=Dt+127>>7,Ot=Ut<=109?0:Math.ceil((Ut-109)/127);Dt+Ut+Ot+127>>7>Ut;)Ot=++Ut<=109?0:Math.ceil((Ut-109)/127);var Gt=[1,Ot,Ut,Yt,ft,Ce,pe,0];return xt.FileIndex[0].size=pe<<6,Gt[7]=(xt.FileIndex[0].start=Gt[0]+Gt[1]+Gt[2]+Gt[3]+Gt[4]+Gt[5])+(Gt[6]+7>>3),Gt}(de),ye=ds(ge[7]<<9),ve=0,Le=0;{for(ve=0;ve<8;++ve)ye.write_shift(1,T[ve]);for(ve=0;ve<8;++ve)ye.write_shift(2,0);for(ye.write_shift(2,62),ye.write_shift(2,3),ye.write_shift(2,65534),ye.write_shift(2,9),ye.write_shift(2,6),ve=0;ve<3;++ve)ye.write_shift(2,0);for(ye.write_shift(4,0),ye.write_shift(4,ge[2]),ye.write_shift(4,ge[0]+ge[1]+ge[2]+ge[3]-1),ye.write_shift(4,0),ye.write_shift(4,4096),ye.write_shift(4,ge[3]?ge[0]+ge[1]+ge[2]-1:M),ye.write_shift(4,ge[3]),ye.write_shift(-4,ge[1]?ge[0]-1:M),ye.write_shift(4,ge[1]),ve=0;ve<109;++ve)ye.write_shift(-4,ve<ge[2]?ge[1]+ve:-1)}if(ge[1])for(Le=0;Le<ge[1];++Le){for(;ve<236+Le*127;++ve)ye.write_shift(-4,ve<ge[2]?ge[1]+ve:-1);ye.write_shift(-4,Le===ge[1]-1?M:Le+1)}var qe=function(xt){for(Le+=xt;ve<Le-1;++ve)ye.write_shift(-4,ve+1);xt&&(++ve,ye.write_shift(-4,M))};for(Le=ve=0,Le+=ge[1];ve<Le;++ve)ye.write_shift(-4,S.DIFSECT);for(Le+=ge[2];ve<Le;++ve)ye.write_shift(-4,S.FATSECT);qe(ge[3]),qe(ge[4]);for(var Be=0,$e=0,ze=de.FileIndex[0];Be<de.FileIndex.length;++Be)ze=de.FileIndex[Be],ze.content&&($e=ze.content.length,!($e<4096)&&(ze.start=Le,qe($e+511>>9)));for(qe(ge[6]+7>>3);ye.l&511;)ye.write_shift(-4,S.ENDOFCHAIN);for(Le=ve=0,Be=0;Be<de.FileIndex.length;++Be)ze=de.FileIndex[Be],ze.content&&($e=ze.content.length,!(!$e||$e>=4096)&&(ze.start=Le,qe($e+63>>6)));for(;ye.l&511;)ye.write_shift(-4,S.ENDOFCHAIN);for(ve=0;ve<ge[4]<<2;++ve){var nt=de.FullPaths[ve];if(!nt||nt.length===0){for(Be=0;Be<17;++Be)ye.write_shift(4,0);for(Be=0;Be<3;++Be)ye.write_shift(4,-1);for(Be=0;Be<12;++Be)ye.write_shift(4,0);continue}ze=de.FileIndex[ve],ve===0&&(ze.start=ze.size?ze.start-1:M);var ht=ve===0&&me.root||ze.name;if($e=2*(ht.length+1),ye.write_shift(64,ht,"utf16le"),ye.write_shift(2,$e),ye.write_shift(1,ze.type),ye.write_shift(1,ze.color),ye.write_shift(-4,ze.L),ye.write_shift(-4,ze.R),ye.write_shift(-4,ze.C),ze.clsid)ye.write_shift(16,ze.clsid,"hex");else for(Be=0;Be<4;++Be)ye.write_shift(4,0);ye.write_shift(4,ze.state||0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,ze.start),ye.write_shift(4,ze.size),ye.write_shift(4,0)}for(ve=1;ve<de.FileIndex.length;++ve)if(ze=de.FileIndex[ve],ze.size>=4096)if(ye.l=ze.start+1<<9,cr&&Buffer.isBuffer(ze.content))ze.content.copy(ye,ye.l,0,ze.size),ye.l+=ze.size+511&-512;else{for(Be=0;Be<ze.size;++Be)ye.write_shift(1,ze.content[Be]);for(;Be&511;++Be)ye.write_shift(1,0)}for(ve=1;ve<de.FileIndex.length;++ve)if(ze=de.FileIndex[ve],ze.size>0&&ze.size<4096)if(cr&&Buffer.isBuffer(ze.content))ze.content.copy(ye,ye.l,0,ze.size),ye.l+=ze.size+63&-64;else{for(Be=0;Be<ze.size;++Be)ye.write_shift(1,ze.content[Be]);for(;Be&63;++Be)ye.write_shift(1,0)}if(cr)ye.l=ye.length;else for(;ye.l<ye.length;)ye.write_shift(1,0);return ye}function Y(de,be){var me=de.FullPaths.map(function(Be){return Be.toUpperCase()}),ge=me.map(function(Be){var $e=Be.split("/");return $e[$e.length-(Be.slice(-1)=="/"?2:1)]}),ye=!1;be.charCodeAt(0)===47?(ye=!0,be=me[0].slice(0,-1)+be):ye=be.indexOf("/")!==-1;var ve=be.toUpperCase(),Le=ye===!0?me.indexOf(ve):ge.indexOf(ve);if(Le!==-1)return de.FileIndex[Le];var qe=!ve.match(bu);for(ve=ve.replace(Js,""),qe&&(ve=ve.replace(bu,"!")),Le=0;Le<me.length;++Le)if((qe?me[Le].replace(bu,"!"):me[Le]).replace(Js,"")==ve||(qe?ge[Le].replace(bu,"!"):ge[Le]).replace(Js,"")==ve)return de.FileIndex[Le];return null}var q=64,M=-2,D="d0cf11e0a1b11ae1",T=[208,207,17,224,161,177,26,225],C="00000000000000000000000000000000",S={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:D,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:C,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function w(de,be,me){o();var ge=W(de,me);u.writeFileSync(be,ge)}function j(de){for(var be=new Array(de.length),me=0;me<de.length;++me)be[me]=String.fromCharCode(de[me]);return be.join("")}function A(de,be){var me=W(de,be);switch(be&&be.type||"buffer"){case"file":return o(),u.writeFileSync(be.filename,me),me;case"binary":return typeof me=="string"?me:j(me);case"base64":return E2(typeof me=="string"?me:j(me));case"buffer":if(cr)return Buffer.isBuffer(me)?me:tl(me);case"array":return typeof me=="string"?dn(me):me}return me}var L;function I(de){try{var be=de.InflateRaw,me=new be;if(me._processChunk(new Uint8Array([3,0]),me._finishFlushFlag),me.bytesRead)L=de;else throw new Error("zlib does not expose bytesRead")}catch(ge){console.error("cannot use native zlib: "+(ge.message||ge))}}function Z(de,be){if(!L)return yt(de,be);var me=L.InflateRaw,ge=new me,ye=ge._processChunk(de.slice(de.l),ge._finishFlushFlag);return de.l+=ge.bytesRead,ye}function K(de){return L?L.deflateRawSync(de):fe(de)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function V(de){var be=(de<<1|de<<11)&139536|(de<<5|de<<15)&558144;return(be>>16|be>>8|be)&255}for(var H=typeof Uint8Array<"u",Q=H?new Uint8Array(256):[],oe=0;oe<256;++oe)Q[oe]=V(oe);function se(de,be){var me=Q[de&255];return be<=8?me>>>8-be:(me=me<<8|Q[de>>8&255],be<=16?me>>>16-be:(me=me<<8|Q[de>>16&255],me>>>24-be))}function le(de,be){var me=be&7,ge=be>>>3;return(de[ge]|(me<=6?0:de[ge+1]<<8))>>>me&3}function he(de,be){var me=be&7,ge=be>>>3;return(de[ge]|(me<=5?0:de[ge+1]<<8))>>>me&7}function Ne(de,be){var me=be&7,ge=be>>>3;return(de[ge]|(me<=4?0:de[ge+1]<<8))>>>me&15}function we(de,be){var me=be&7,ge=be>>>3;return(de[ge]|(me<=3?0:de[ge+1]<<8))>>>me&31}function ue(de,be){var me=be&7,ge=be>>>3;return(de[ge]|(me<=1?0:de[ge+1]<<8))>>>me&127}function Se(de,be,me){var ge=be&7,ye=be>>>3,ve=(1<<me)-1,Le=de[ye]>>>ge;return me<8-ge||(Le|=de[ye+1]<<8-ge,me<16-ge)||(Le|=de[ye+2]<<16-ge,me<24-ge)||(Le|=de[ye+3]<<24-ge),Le&ve}function ke(de,be,me){var ge=be&7,ye=be>>>3;return ge<=5?de[ye]|=(me&7)<<ge:(de[ye]|=me<<ge&255,de[ye+1]=(me&7)>>8-ge),be+3}function Me(de,be,me){var ge=be&7,ye=be>>>3;return me=(me&1)<<ge,de[ye]|=me,be+1}function Oe(de,be,me){var ge=be&7,ye=be>>>3;return me<<=ge,de[ye]|=me&255,me>>>=8,de[ye+1]=me,be+8}function je(de,be,me){var ge=be&7,ye=be>>>3;return me<<=ge,de[ye]|=me&255,me>>>=8,de[ye+1]=me&255,de[ye+2]=me>>>8,be+16}function Ie(de,be){var me=de.length,ge=2*me>be?2*me:be+5,ye=0;if(me>=be)return de;if(cr){var ve=T2(ge);if(de.copy)de.copy(ve);else for(;ye<de.length;++ye)ve[ye]=de[ye];return ve}else if(H){var Le=new Uint8Array(ge);if(Le.set)Le.set(de);else for(;ye<me;++ye)Le[ye]=de[ye];return Le}return de.length=ge,de}function Pe(de){for(var be=new Array(de),me=0;me<de;++me)be[me]=0;return be}function He(de,be,me){var ge=1,ye=0,ve=0,Le=0,qe=0,Be=de.length,$e=H?new Uint16Array(32):Pe(32);for(ve=0;ve<32;++ve)$e[ve]=0;for(ve=Be;ve<me;++ve)de[ve]=0;Be=de.length;var ze=H?new Uint16Array(Be):Pe(Be);for(ve=0;ve<Be;++ve)$e[ye=de[ve]]++,ge<ye&&(ge=ye),ze[ve]=0;for($e[0]=0,ve=1;ve<=ge;++ve)$e[ve+16]=qe=qe+$e[ve-1]<<1;for(ve=0;ve<Be;++ve)qe=de[ve],qe!=0&&(ze[ve]=$e[qe+16]++);var nt=0;for(ve=0;ve<Be;++ve)if(nt=de[ve],nt!=0)for(qe=se(ze[ve],ge)>>ge-nt,Le=(1<<ge+4-nt)-1;Le>=0;--Le)be[qe|Le<<nt]=nt&15|ve<<4;return ge}var ct=H?new Uint16Array(512):Pe(512),ie=H?new Uint16Array(32):Pe(32);if(!H){for(var ee=0;ee<512;++ee)ct[ee]=0;for(ee=0;ee<32;++ee)ie[ee]=0}(function(){for(var de=[],be=0;be<32;be++)de.push(5);He(de,ie,32);var me=[];for(be=0;be<=143;be++)me.push(8);for(;be<=255;be++)me.push(9);for(;be<=279;be++)me.push(7);for(;be<=287;be++)me.push(8);He(me,ct,288)})();var te=function(){for(var be=H?new Uint8Array(32768):[],me=0,ge=0;me<ae.length-1;++me)for(;ge<ae[me+1];++ge)be[ge]=me;for(;ge<32768;++ge)be[ge]=29;var ye=H?new Uint8Array(259):[];for(me=0,ge=0;me<G.length-1;++me)for(;ge<G[me+1];++ge)ye[ge]=me;function ve(qe,Be){for(var $e=0;$e<qe.length;){var ze=Math.min(65535,qe.length-$e),nt=$e+ze==qe.length;for(Be.write_shift(1,+nt),Be.write_shift(2,ze),Be.write_shift(2,~ze&65535);ze-- >0;)Be[Be.l++]=qe[$e++]}return Be.l}function Le(qe,Be){for(var $e=0,ze=0,nt=H?new Uint16Array(32768):[];ze<qe.length;){var ht=Math.min(65535,qe.length-ze);if(ht<10){for($e=ke(Be,$e,+(ze+ht==qe.length)),$e&7&&($e+=8-($e&7)),Be.l=$e/8|0,Be.write_shift(2,ht),Be.write_shift(2,~ht&65535);ht-- >0;)Be[Be.l++]=qe[ze++];$e=Be.l*8;continue}$e=ke(Be,$e,+(ze+ht==qe.length)+2);for(var xt=0;ht-- >0;){var pe=qe[ze];xt=(xt<<5^pe)&32767;var Ce=-1,Ye=0;if((Ce=nt[xt])&&(Ce|=ze&-32768,Ce>ze&&(Ce-=32768),Ce<ze))for(;qe[Ce+Ye]==qe[ze+Ye]&&Ye<250;)++Ye;if(Ye>2){pe=ye[Ye],pe<=22?$e=Oe(Be,$e,Q[pe+1]>>1)-1:(Oe(Be,$e,3),$e+=5,Oe(Be,$e,Q[pe-23]>>5),$e+=3);var tt=pe<8?0:pe-4>>2;tt>0&&(je(Be,$e,Ye-G[pe]),$e+=tt),pe=be[ze-Ce],$e=Oe(Be,$e,Q[pe]>>3),$e-=3;var gt=pe<4?0:pe-2>>1;gt>0&&(je(Be,$e,ze-Ce-ae[pe]),$e+=gt);for(var ft=0;ft<Ye;++ft)nt[xt]=ze&32767,xt=(xt<<5^qe[ze])&32767,++ze;ht-=Ye-1}else pe<=143?pe=pe+48:$e=Me(Be,$e,1),$e=Oe(Be,$e,Q[pe]),nt[xt]=ze&32767,++ze}$e=Oe(Be,$e,0)-1}return Be.l=($e+7)/8|0,Be.l}return function(Be,$e){return Be.length<8?ve(Be,$e):Le(Be,$e)}}();function fe(de){var be=ds(50+Math.floor(de.length*1.1)),me=te(de,be);return be.slice(0,me)}var _e=H?new Uint16Array(32768):Pe(32768),Te=H?new Uint16Array(32768):Pe(32768),Ae=H?new Uint16Array(128):Pe(128),Fe=1,st=1;function it(de,be){var me=we(de,be)+257;be+=5;var ge=we(de,be)+1;be+=5;var ye=Ne(de,be)+4;be+=4;for(var ve=0,Le=H?new Uint8Array(19):Pe(19),qe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Be=1,$e=H?new Uint8Array(8):Pe(8),ze=H?new Uint8Array(8):Pe(8),nt=Le.length,ht=0;ht<ye;++ht)Le[re[ht]]=ve=he(de,be),Be<ve&&(Be=ve),$e[ve]++,be+=3;var xt=0;for($e[0]=0,ht=1;ht<=Be;++ht)ze[ht]=xt=xt+$e[ht-1]<<1;for(ht=0;ht<nt;++ht)(xt=Le[ht])!=0&&(qe[ht]=ze[xt]++);var pe=0;for(ht=0;ht<nt;++ht)if(pe=Le[ht],pe!=0){xt=Q[qe[ht]]>>8-pe;for(var Ce=(1<<7-pe)-1;Ce>=0;--Ce)Ae[xt|Ce<<pe]=pe&7|ht<<3}var Ye=[];for(Be=1;Ye.length<me+ge;)switch(xt=Ae[ue(de,be)],be+=xt&7,xt>>>=3){case 16:for(ve=3+le(de,be),be+=2,xt=Ye[Ye.length-1];ve-- >0;)Ye.push(xt);break;case 17:for(ve=3+he(de,be),be+=3;ve-- >0;)Ye.push(0);break;case 18:for(ve=11+ue(de,be),be+=7;ve-- >0;)Ye.push(0);break;default:Ye.push(xt),Be<xt&&(Be=xt);break}var tt=Ye.slice(0,me),gt=Ye.slice(me);for(ht=me;ht<286;++ht)tt[ht]=0;for(ht=ge;ht<30;++ht)gt[ht]=0;return Fe=He(tt,_e,286),st=He(gt,Te,30),be}function lt(de,be){if(de[0]==3&&!(de[1]&3))return[to(be),2];for(var me=0,ge=0,ye=T2(be||1<<18),ve=0,Le=ye.length>>>0,qe=0,Be=0;!(ge&1);){if(ge=he(de,me),me+=3,ge>>>1)ge>>1==1?(qe=9,Be=5):(me=it(de,me),qe=Fe,Be=st);else{me&7&&(me+=8-(me&7));var $e=de[me>>>3]|de[(me>>>3)+1]<<8;if(me+=32,$e>0)for(!be&&Le<ve+$e&&(ye=Ie(ye,ve+$e),Le=ye.length);$e-- >0;)ye[ve++]=de[me>>>3],me+=8;continue}for(;;){!be&&Le<ve+32767&&(ye=Ie(ye,ve+32767),Le=ye.length);var ze=Se(de,me,qe),nt=ge>>>1==1?ct[ze]:_e[ze];if(me+=nt&15,nt>>>=4,!(nt>>>8&255))ye[ve++]=nt;else{if(nt==256)break;nt-=257;var ht=nt<8?0:nt-4>>2;ht>5&&(ht=0);var xt=ve+G[nt];ht>0&&(xt+=Se(de,me,ht),me+=ht),ze=Se(de,me,Be),nt=ge>>>1==1?ie[ze]:Te[ze],me+=nt&15,nt>>>=4;var pe=nt<4?0:nt-2>>1,Ce=ae[nt];for(pe>0&&(Ce+=Se(de,me,pe),me+=pe),!be&&Le<xt&&(ye=Ie(ye,xt+100),Le=ye.length);ve<xt;)ye[ve]=ye[ve-Ce],++ve}}}return be?[ye,me+7>>>3]:[ye.slice(0,ve),me+7>>>3]}function yt(de,be){var me=de.slice(de.l||0),ge=lt(me,be);return de.l+=ge[1],ge[0]}function vt(de,be){if(de)typeof console<"u"&&console.error(be);else throw new Error(be)}function Nt(de,be){var me=de;ks(me,0);var ge=[],ye=[],ve={FileIndex:ge,FullPaths:ye};z(ve,{root:be.root});for(var Le=me.length-4;(me[Le]!=80||me[Le+1]!=75||me[Le+2]!=5||me[Le+3]!=6)&&Le>=0;)--Le;me.l=Le+4,me.l+=4;var qe=me.read_shift(2);me.l+=6;var Be=me.read_shift(4);for(me.l=Be,Le=0;Le<qe;++Le){me.l+=20;var $e=me.read_shift(4),ze=me.read_shift(4),nt=me.read_shift(2),ht=me.read_shift(2),xt=me.read_shift(2);me.l+=8;var pe=me.read_shift(4),Ce=l(me.slice(me.l+nt,me.l+nt+ht));me.l+=nt+ht+xt;var Ye=me.l;me.l=pe+4,Mt(me,$e,ze,ve,Ce),me.l=Ye}return ve}function Mt(de,be,me,ge,ye){de.l+=2;var ve=de.read_shift(2),Le=de.read_shift(2),qe=c(de);if(ve&8257)throw new Error("Unsupported ZIP encryption");for(var Be=de.read_shift(4),$e=de.read_shift(4),ze=de.read_shift(4),nt=de.read_shift(2),ht=de.read_shift(2),xt="",pe=0;pe<nt;++pe)xt+=String.fromCharCode(de[de.l++]);if(ht){var Ce=l(de.slice(de.l,de.l+ht));(Ce[21589]||{}).mt&&(qe=Ce[21589].mt),((ye||{})[21589]||{}).mt&&(qe=ye[21589].mt)}de.l+=ht;var Ye=de.slice(de.l,de.l+$e);switch(Le){case 8:Ye=Z(de,ze);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Le)}var tt=!1;ve&8&&(Be=de.read_shift(4),Be==134695760&&(Be=de.read_shift(4),tt=!0),$e=de.read_shift(4),ze=de.read_shift(4)),$e!=be&&vt(tt,"Bad compressed size: "+be+" != "+$e),ze!=me&&vt(tt,"Bad uncompressed size: "+me+" != "+ze),At(ge,xt,Ye,{unsafe:!0,mt:qe})}function Et(de,be){var me=be||{},ge=[],ye=[],ve=ds(1),Le=me.compression?8:0,qe=0,Be=0,$e=0,ze=0,nt=0,ht=de.FullPaths[0],xt=ht,pe=de.FileIndex[0],Ce=[],Ye=0;for(Be=1;Be<de.FullPaths.length;++Be)if(xt=de.FullPaths[Be].slice(ht.length),pe=de.FileIndex[Be],!(!pe.size||!pe.content||xt=="Sh33tJ5")){var tt=ze,gt=ds(xt.length);for($e=0;$e<xt.length;++$e)gt.write_shift(1,xt.charCodeAt($e)&127);gt=gt.slice(0,gt.l),Ce[nt]=cR.buf(pe.content,0);var ft=pe.content;Le==8&&(ft=K(ft)),ve=ds(30),ve.write_shift(4,67324752),ve.write_shift(2,20),ve.write_shift(2,qe),ve.write_shift(2,Le),pe.mt?i(ve,pe.mt):ve.write_shift(4,0),ve.write_shift(-4,Ce[nt]),ve.write_shift(4,ft.length),ve.write_shift(4,pe.content.length),ve.write_shift(2,gt.length),ve.write_shift(2,0),ze+=ve.length,ge.push(ve),ze+=gt.length,ge.push(gt),ze+=ft.length,ge.push(ft),ve=ds(46),ve.write_shift(4,33639248),ve.write_shift(2,0),ve.write_shift(2,20),ve.write_shift(2,qe),ve.write_shift(2,Le),ve.write_shift(4,0),ve.write_shift(-4,Ce[nt]),ve.write_shift(4,ft.length),ve.write_shift(4,pe.content.length),ve.write_shift(2,gt.length),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(4,0),ve.write_shift(4,tt),Ye+=ve.l,ye.push(ve),Ye+=gt.length,ye.push(gt),++nt}return ve=ds(22),ve.write_shift(4,101010256),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,nt),ve.write_shift(2,nt),ve.write_shift(4,Ye),ve.write_shift(4,ze),ve.write_shift(2,0),Yi([Yi(ge),Yi(ye),ve])}var _t={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tt(de,be){if(de.ctype)return de.ctype;var me=de.name||"",ge=me.match(/\.([^\.]+)$/);return ge&&_t[ge[1]]||be&&(ge=(me=be).match(/[\.\\]([^\.\\])+$/),ge&&_t[ge[1]])?_t[ge[1]]:"application/octet-stream"}function ut(de){for(var be=E2(de),me=[],ge=0;ge<be.length;ge+=76)me.push(be.slice(ge,ge+76));return me.join(`\r
`)+`\r
`}function jt(de){var be=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function($e){var ze=$e.charCodeAt(0).toString(16).toUpperCase();return"="+(ze.length==1?"0"+ze:ze)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var me=[],ge=be.split(`\r
`),ye=0;ye<ge.length;++ye){var ve=ge[ye];if(ve.length==0){me.push("");continue}for(var Le=0;Le<ve.length;){var qe=76,Be=ve.slice(Le,Le+qe);Be.charAt(qe-1)=="="?qe--:Be.charAt(qe-2)=="="?qe-=2:Be.charAt(qe-3)=="="&&(qe-=3),Be=ve.slice(Le,Le+qe),Le+=qe,Le<ve.length&&(Be+="="),me.push(Be)}}return me.join(`\r
`)}function Ke(de){for(var be=[],me=0;me<de.length;++me){for(var ge=de[me];me<=de.length&&ge.charAt(ge.length-1)=="=";)ge=ge.slice(0,ge.length-1)+de[++me];be.push(ge)}for(var ye=0;ye<be.length;++ye)be[ye]=be[ye].replace(/[=][0-9A-Fa-f]{2}/g,function(ve){return String.fromCharCode(parseInt(ve.slice(1),16))});return dn(be.join(`\r
`))}function Vt(de,be,me){for(var ge="",ye="",ve="",Le,qe=0;qe<10;++qe){var Be=be[qe];if(!Be||Be.match(/^\s*$/))break;var $e=Be.match(/^(.*?):\s*([^\s].*)$/);if($e)switch($e[1].toLowerCase()){case"content-location":ge=$e[2].trim();break;case"content-type":ve=$e[2].trim();break;case"content-transfer-encoding":ye=$e[2].trim();break}}switch(++qe,ye.toLowerCase()){case"base64":Le=dn(Ta(be.slice(qe).join("")));break;case"quoted-printable":Le=Ke(be.slice(qe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ye)}var ze=At(de,ge.slice(me.length),Le,{unsafe:!0});ve&&(ze.ctype=ve)}function St(de,be){if(j(de.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var me=be&&be.root||"",ge=(cr&&Buffer.isBuffer(de)?de.toString("binary"):j(de)).split(`\r
`),ye=0,ve="";for(ye=0;ye<ge.length;++ye)if(ve=ge[ye],!!/^Content-Location:/i.test(ve)&&(ve=ve.slice(ve.indexOf("file")),me||(me=ve.slice(0,ve.lastIndexOf("/")+1)),ve.slice(0,me.length)!=me))for(;me.length>0&&(me=me.slice(0,me.length-1),me=me.slice(0,me.lastIndexOf("/")+1),ve.slice(0,me.length)!=me););var Le=(ge[1]||"").match(/boundary="(.*?)"/);if(!Le)throw new Error("MAD cannot find boundary");var qe="--"+(Le[1]||""),Be=[],$e=[],ze={FileIndex:Be,FullPaths:$e};z(ze);var nt,ht=0;for(ye=0;ye<ge.length;++ye){var xt=ge[ye];xt!==qe&&xt!==qe+"--"||(ht++&&Vt(ze,ge.slice(nt,ye),me),nt=ye)}return ze}function et(de,be){var me=be||{},ge=me.boundary||"SheetJS";ge="------="+ge;for(var ye=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ge.slice(2)+'"',"","",""],ve=de.FullPaths[0],Le=ve,qe=de.FileIndex[0],Be=1;Be<de.FullPaths.length;++Be)if(Le=de.FullPaths[Be].slice(ve.length),qe=de.FileIndex[Be],!(!qe.size||!qe.content||Le=="Sh33tJ5")){Le=Le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var $e=qe.content,ze=cr&&Buffer.isBuffer($e)?$e.toString("binary"):j($e),nt=0,ht=Math.min(1024,ze.length),xt=0,pe=0;pe<=ht;++pe)(xt=ze.charCodeAt(pe))>=32&&xt<128&&++nt;var Ce=nt>=ht*4/5;ye.push(ge),ye.push("Content-Location: "+(me.root||"file:///C:/SheetJS/")+Le),ye.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),ye.push("Content-Type: "+Tt(qe,Le)),ye.push(""),ye.push(Ce?jt(ze):ut(ze))}return ye.push(ge+`--\r
`),ye.join(`\r
`)}function ot(de){var be={};return z(be,de),be}function At(de,be,me,ge){var ye=ge&&ge.unsafe;ye||z(de);var ve=!ye&&fr.find(de,be);if(!ve){var Le=de.FullPaths[0];be.slice(0,Le.length)==Le?Le=be:(Le.slice(-1)!="/"&&(Le+="/"),Le=(Le+be).replace("//","/")),ve={name:n(be),type:2},de.FileIndex.push(ve),de.FullPaths.push(Le),ye||fr.utils.cfb_gc(de)}return ve.content=me,ve.size=me?me.length:0,ge&&(ge.CLSID&&(ve.clsid=ge.CLSID),ge.mt&&(ve.mt=ge.mt),ge.ct&&(ve.ct=ge.ct)),ve}function Re(de,be){z(de);var me=fr.find(de,be);if(me){for(var ge=0;ge<de.FileIndex.length;++ge)if(de.FileIndex[ge]==me)return de.FileIndex.splice(ge,1),de.FullPaths.splice(ge,1),!0}return!1}function Ve(de,be,me){z(de);var ge=fr.find(de,be);if(ge){for(var ye=0;ye<de.FileIndex.length;++ye)if(de.FileIndex[ye]==ge)return de.FileIndex[ye].name=n(me),de.FullPaths[ye]=me,!0}return!1}function Qe(de){U(de,!0)}return s.find=Y,s.read=F,s.parse=d,s.write=A,s.writeFile=w,s.utils={cfb_new:ot,cfb_add:At,cfb_del:Re,cfb_mov:Ve,cfb_gc:Qe,ReadShift:ju,CheckField:Y5,prep_blob:ks,bconcat:Yi,use_zlib:I,_deflateRaw:fe,_inflateRaw:yt,consts:S},s}();function uR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var s=File(t);s.open("r"),s.encoding="binary";var e=s.read();return s.close(),e}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function zn(t){for(var s=Object.keys(t),e=[],a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(t,s[a])&&e.push(s[a]);return e}function px(t){for(var s=[],e=zn(t),a=0;a!==e.length;++a)s[t[e[a]]]=e[a];return s}var g0=new Date(1899,11,30,0,0,0);function ta(t,s){var e=t.getTime(),a=g0.getTime()+(t.getTimezoneOffset()-g0.getTimezoneOffset())*6e4;return(e-a)/(24*60*60*1e3)}var k5=new Date,dR=g0.getTime()+(k5.getTimezoneOffset()-g0.getTimezoneOffset())*6e4,P2=k5.getTimezoneOffset();function X0(t){var s=new Date;return s.setTime(t*24*60*60*1e3+dR),s.getTimezoneOffset()!==P2&&s.setTime(s.getTime()+(s.getTimezoneOffset()-P2)*6e4),s}function fR(t){var s=0,e=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(e=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":e*=24;case"H":e*=60;case"M":if(a)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}s+=e*parseInt(n[i],10)}return s}var B2=new Date("2017-02-19T19:06:09.000Z"),C5=isNaN(B2.getFullYear())?new Date("2/19/17"):B2,hR=C5.getFullYear()==2017;function bs(t,s){var e=new Date(t);if(hR)return s>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):s<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(C5.getFullYear()==1917&&!isNaN(e.getFullYear())){var a=e.getFullYear();return t.indexOf(""+a)>-1||e.setFullYear(e.getFullYear()+100),e}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Go(t,s){if(cr&&Buffer.isBuffer(t)){if(s){if(t[0]==255&&t[1]==254)return vu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return vu(h5(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(s){if(t[0]==255&&t[1]==254)return vu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return vu(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return e[i]||i})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function Es(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var s={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(s[e]=Es(t[e]));return s}function Hr(t,s){for(var e="";e.length<s;)e+=t;return e}function mn(t){var s=Number(t);if(!isNaN(s))return isFinite(s)?s:NaN;if(!/\d/.test(t))return s;var e=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(s=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return e=-e,i}),!isNaN(s=Number(a)))?s/e:s}var mR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jl(t){var s=new Date(t),e=new Date(NaN),a=s.getYear(),n=s.getMonth(),i=s.getDate();if(isNaN(i))return e;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&mR.indexOf(c)==-1)return e}else if(c.match(/[a-z]/))return e;return a<0||a>8099?e:(n>0||i>1)&&a!=101?s:t.match(/[^-0-9:,\/\\]/)?e:s}var pR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,a,n){if(t||typeof a=="string")return e.split(a);for(var i=e.split(a),c=[i[0]],l=1;l<i.length;++l)c.push(n),c.push(i[l]);return c}}();function E5(t){return t?t.content&&t.type?Go(t.content,!0):t.data?xu(t.data):t.asNodeBuffer&&cr?xu(t.asNodeBuffer().toString("binary")):t.asBinary?xu(t.asBinary()):t._data&&t._data.getContent?xu(Go(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function T5(t){if(!t)return null;if(t.data)return k2(t.data);if(t.asNodeBuffer&&cr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var s=t._data.getContent();return typeof s=="string"?k2(s):Array.prototype.slice.call(s)}return t.content&&t.type?t.content:null}function gR(t){return t&&t.name.slice(-4)===".bin"?T5(t):E5(t)}function Ga(t,s){for(var e=t.FullPaths||zn(t.files),a=s.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<e.length;++i){var c=e[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==c||n==c)return t.files?t.files[e[i]]:t.FileIndex[i]}return null}function gx(t,s){var e=Ga(t,s);if(e==null)throw new Error("Cannot find file "+s+" in zip");return e}function ns(t,s,e){if(!e)return gR(gx(t,s));if(!s)return null;try{return ns(t,s)}catch{return null}}function ja(t,s,e){if(!e)return E5(gx(t,s));if(!s)return null;try{return ja(t,s)}catch{return null}}function xR(t,s,e){return T5(gx(t,s))}function D2(t){for(var s=t.FullPaths||zn(t.files),e=[],a=0;a<s.length;++a)s[a].slice(-1)!="/"&&e.push(s[a].replace(/^Root Entry[\/]/,""));return e.sort()}function bR(t,s,e){if(t.FullPaths){if(typeof e=="string"){var a;return cr?a=tl(e):a=PO(e),fr.utils.cfb_add(t,s,a)}fr.utils.cfb_add(t,s,e)}else t.file(s,e)}function A5(t,s){switch(s.type){case"base64":return fr.read(t,{type:"base64"});case"binary":return fr.read(t,{type:"binary"});case"buffer":case"array":return fr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+s.type)}function yu(t,s){if(t.charAt(0)=="/")return t.slice(1);var e=s.split("/");s.slice(-1)!="/"&&e.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?e.pop():n!=="."&&e.push(n)}return e.join("/")}var O5=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,U2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,vR=/<[^>]*>/g,Ys=O5.match(U2)?U2:vR,_R=/<\w*:/,wR=/<(\/?)\w+:/;function qt(t,s,e){for(var a={},n=0,i=0;n!==t.length&&!((i=t.charCodeAt(n))===32||i===10||i===13);++n);if(s||(a[0]=t.slice(0,n)),n===t.length)return a;var c=t.match(yR),l=0,u="",o=0,d="",g="",p=1;if(c)for(o=0;o!=c.length;++o){for(g=c[o],i=0;i!=g.length&&g.charCodeAt(i)!==61;++i);for(d=g.slice(0,i).trim();g.charCodeAt(i+1)==32;)++i;for(p=(n=g.charCodeAt(i+1))==34||n==39?1:0,u=g.slice(i+1+p,g.length-p),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=u,a[d.toLowerCase()]=u;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(a[h]&&d.slice(l-3,l)=="ext")continue;a[h]=u,a[h.toLowerCase()]=u}}return a}function Hn(t){return t.replace(wR,"<$1")}var R5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},NR=px(R5),pr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,s=/_x([\da-fA-F]{4})_/ig;return function e(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(t,function(l,u){return R5[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(s,function(l,u){return String.fromCharCode(parseInt(u,16))});var c=n.indexOf("]]>");return e(n.slice(0,i))+n.slice(i+9,c)+e(n.slice(c+3))}}(),jR=/[&<>'"]/g,SR=/[\u0000-\u001f]/g;function xx(t){var s=t+"";return s.replace(jR,function(e){return NR[e]}).replace(/\n/g,"<br/>").replace(SR,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var $2=function(){var t=/&#(\d+);/g;function s(e,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,s)}}();function Fr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Np(t){for(var s="",e=0,a=0,n=0,i=0,c=0,l=0;e<t.length;){if(a=t.charCodeAt(e++),a<128){s+=String.fromCharCode(a);continue}if(n=t.charCodeAt(e++),a>191&&a<224){c=(a&31)<<6,c|=n&63,s+=String.fromCharCode(c);continue}if(i=t.charCodeAt(e++),a<240){s+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}c=t.charCodeAt(e++),l=((a&7)<<18|(n&63)<<12|(i&63)<<6|c&63)-65536,s+=String.fromCharCode(55296+(l>>>10&1023)),s+=String.fromCharCode(56320+(l&1023))}return s}function z2(t){var s=to(2*t.length),e,a,n=1,i=0,c=0,l;for(a=0;a<t.length;a+=n)n=1,(l=t.charCodeAt(a))<128?e=l:l<224?(e=(l&31)*64+(t.charCodeAt(a+1)&63),n=2):l<240?(e=(l&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,e=(l&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),e-=65536,c=55296+(e>>>10&1023),e=56320+(e&1023)),c!==0&&(s[i++]=c&255,s[i++]=c>>>8,c=0),s[i++]=e%256,s[i++]=e>>>8;return s.slice(0,i).toString("ucs2")}function H2(t){return tl(t,"binary").toString("utf8")}var jf="foo bar baz",Or=cr&&(H2(jf)==Np(jf)&&H2||z2(jf)==Np(jf)&&z2)||Np,vu=cr?function(t){return tl(t,"utf8").toString("binary")}:function(t){for(var s=[],e=0,a=0,n=0;e<t.length;)switch(a=t.charCodeAt(e++),!0){case a<128:s.push(String.fromCharCode(a));break;case a<2048:s.push(String.fromCharCode(192+(a>>6))),s.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(e++)-56320+(a<<10),s.push(String.fromCharCode(240+(n>>18&7))),s.push(String.fromCharCode(144+(n>>12&63))),s.push(String.fromCharCode(128+(n>>6&63))),s.push(String.fromCharCode(128+(n&63)));break;default:s.push(String.fromCharCode(224+(a>>12))),s.push(String.fromCharCode(128+(a>>6&63))),s.push(String.fromCharCode(128+(a&63)))}return s.join("")},Bu=function(){var t={};return function(e,a){var n=e+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",a||"")}}(),M5=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(s){return[new RegExp("&"+s[0]+";","ig"),s[1]]});return function(e){for(var a=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}}(),kR=function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),CR=/<\/?(?:vt:)?variant>/g,ER=/<(?:vt:)([^>]*)>([\s\S]*)</;function V2(t,s){var e=qt(t),a=t.match(kR(e.baseType))||[],n=[];if(a.length!=e.size){if(s.WTF)throw new Error("unexpected vector length "+a.length+" != "+e.size);return n}return a.forEach(function(i){var c=i.replace(CR,"").match(ER);c&&n.push({v:Or(c[2]),t:c[1]})}),n}var TR=/(^\s|\s$|\n)/;function AR(t){return zn(t).map(function(s){return" "+s+'="'+t[s]+'"'}).join("")}function OR(t,s,e){return"<"+t+(e!=null?AR(e):"")+(s!=null?(s.match(TR)?' xml:space="preserve"':"")+">"+s+"</"+t:"/")+">"}function bx(t){if(cr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Or(rl(fx(t)));throw new Error("Bad input format: expected Buffer or string")}var Du=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,RR={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},MR=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function FR(t,s){for(var e=1-2*(t[s+7]>>>7),a=((t[s+7]&127)<<4)+(t[s+6]>>>4&15),n=t[s+6]&15,i=5;i>=0;--i)n=n*256+t[s+i];return a==2047?n==0?e*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),e*Math.pow(2,a-52)*n)}function IR(t,s,e){var a=(s<0||1/s==-1/0?1:0)<<7,n=0,i=0,c=a?-s:s;isFinite(c)?c==0?n=i=0:(n=Math.floor(Math.log(c)/Math.LN2),i=c*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(s)?26985:0);for(var l=0;l<=5;++l,i/=256)t[e+l]=i&255;t[e+6]=(n&15)<<4|i&15,t[e+7]=n>>4|a}var q2=function(t){for(var s=[],e=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,i=t[0][a].length;n<i;n+=e)s.push.apply(s,t[0][a].slice(n,n+e));return s},G2=cr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(s){return Buffer.isBuffer(s)?s:tl(s)})):q2(t)}:q2,Y2=function(t,s,e){for(var a=[],n=s;n<e;n+=2)a.push(String.fromCharCode(li(t,n)));return a.join("").replace(Js,"")},yx=cr?function(t,s,e){return Buffer.isBuffer(t)?t.toString("utf16le",s,e).replace(Js,""):Y2(t,s,e)}:Y2,W2=function(t,s,e){for(var a=[],n=s;n<s+e;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},F5=cr?function(t,s,e){return Buffer.isBuffer(t)?t.toString("hex",s,s+e):W2(t,s,e)}:W2,X2=function(t,s,e){for(var a=[],n=s;n<e;n++)a.push(String.fromCharCode(Ll(t,n)));return a.join("")},id=cr?function(s,e,a){return Buffer.isBuffer(s)?s.toString("utf8",e,a):X2(s,e,a)}:X2,I5=function(t,s){var e=wa(t,s);return e>0?id(t,s+4,s+4+e-1):""},L5=I5,P5=function(t,s){var e=wa(t,s);return e>0?id(t,s+4,s+4+e-1):""},B5=P5,D5=function(t,s){var e=2*wa(t,s);return e>0?id(t,s+4,s+4+e-1):""},U5=D5,$5=function(s,e){var a=wa(s,e);return a>0?yx(s,e+4,e+4+a):""},z5=$5,H5=function(t,s){var e=wa(t,s);return e>0?id(t,s+4,s+4+e):""},V5=H5,q5=function(t,s){return FR(t,s)},x0=q5,G5=function(s){return Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array};cr&&(L5=function(s,e){if(!Buffer.isBuffer(s))return I5(s,e);var a=s.readUInt32LE(e);return a>0?s.toString("utf8",e+4,e+4+a-1):""},B5=function(s,e){if(!Buffer.isBuffer(s))return P5(s,e);var a=s.readUInt32LE(e);return a>0?s.toString("utf8",e+4,e+4+a-1):""},U5=function(s,e){if(!Buffer.isBuffer(s))return D5(s,e);var a=2*s.readUInt32LE(e);return s.toString("utf16le",e+4,e+4+a-1)},z5=function(s,e){if(!Buffer.isBuffer(s))return $5(s,e);var a=s.readUInt32LE(e);return s.toString("utf16le",e+4,e+4+a)},V5=function(s,e){if(!Buffer.isBuffer(s))return H5(s,e);var a=s.readUInt32LE(e);return s.toString("utf8",e+4,e+4+a)},x0=function(s,e){return Buffer.isBuffer(s)?s.readDoubleLE(e):q5(s,e)},G5=function(s){return Buffer.isBuffer(s)||Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array});var Ll=function(t,s){return t[s]},li=function(t,s){return t[s+1]*256+t[s]},LR=function(t,s){var e=t[s+1]*256+t[s];return e<32768?e:(65535-e+1)*-1},wa=function(t,s){return t[s+3]*(1<<24)+(t[s+2]<<16)+(t[s+1]<<8)+t[s]},Ro=function(t,s){return t[s+3]<<24|t[s+2]<<16|t[s+1]<<8|t[s]},PR=function(t,s){return t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3]};function ju(t,s){var e="",a,n,i=[],c,l,u,o;switch(s){case"dbcs":if(o=this.l,cr&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)e+=String.fromCharCode(li(this,o)),o+=2;t*=2;break;case"utf8":e=id(this,this.l,this.l+t);break;case"utf16le":t*=2,e=yx(this,this.l,this.l+t);break;case"wstr":return ju.call(this,t,"dbcs");case"lpstr-ansi":e=L5(this,this.l),t=4+wa(this,this.l);break;case"lpstr-cp":e=B5(this,this.l),t=4+wa(this,this.l);break;case"lpwstr":e=U5(this,this.l),t=4+2*wa(this,this.l);break;case"lpp4":t=4+wa(this,this.l),e=z5(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+wa(this,this.l),e=V5(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(c=Ll(this,this.l+t++))!==0;)i.push(Nf(c));e=i.join("");break;case"_wstr":for(t=0,e="";(c=li(this,this.l+t))!==0;)i.push(Nf(c)),t+=2;t+=2,e=i.join("");break;case"dbcs-cont":for(e="",o=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(o)!==-1)return c=Ll(this,o),this.l=o+1,l=ju.call(this,t-u,c?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Nf(li(this,o))),o+=2}e=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",o=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(o)!==-1)return c=Ll(this,o),this.l=o+1,l=ju.call(this,t-u,c?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Nf(Ll(this,o))),o+=1}e=i.join("");break;default:switch(t){case 1:return a=Ll(this,this.l),this.l++,a;case 2:return a=(s==="i"?LR:li)(this,this.l),this.l+=2,a;case 4:case-4:return s==="i"||!(this[this.l+3]&128)?(a=(t>0?Ro:PR)(this,this.l),this.l+=4,a):(n=wa(this,this.l),this.l+=4,n);case 8:case-8:if(s==="f")return t==8?n=x0(this,this.l):n=x0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:e=F5(this,this.l,t);break}}return this.l+=t,e}var BR=function(t,s,e){t[e]=s&255,t[e+1]=s>>>8&255,t[e+2]=s>>>16&255,t[e+3]=s>>>24&255},DR=function(t,s,e){t[e]=s&255,t[e+1]=s>>8&255,t[e+2]=s>>16&255,t[e+3]=s>>24&255},UR=function(t,s,e){t[e]=s&255,t[e+1]=s>>>8&255};function $R(t,s,e){var a=0,n=0;if(e==="dbcs"){for(n=0;n!=s.length;++n)UR(this,s.charCodeAt(n),this.l+2*n);a=2*s.length}else if(e==="sbcs"){for(s=s.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=s.length;++n)this[this.l+n]=s.charCodeAt(n)&255;a=s.length}else if(e==="hex"){for(;n<t;++n)this[this.l++]=parseInt(s.slice(2*n,2*n+2),16)||0;return this}else if(e==="utf16le"){var i=Math.min(this.l+t,this.length);for(n=0;n<Math.min(s.length,t);++n){var c=s.charCodeAt(n);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=s&255;break;case 2:a=2,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255;break;case 3:a=3,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255,s>>>=8,this[this.l+2]=s&255;break;case 4:a=4,BR(this,s,this.l);break;case 8:if(a=8,e==="f"){IR(this,s,this.l);break}case 16:break;case-4:a=4,DR(this,s,this.l);break}return this.l+=a,this}function Y5(t,s){var e=F5(this,this.l,t.length>>1);if(e!==t)throw new Error(s+"Expected "+t+" saw "+e);this.l+=t.length>>1}function ks(t,s){t.l=s,t.read_shift=ju,t.chk=Y5,t.write_shift=$R}function Vs(t,s){t.l+=s}function ds(t){var s=to(t);return ks(s,0),s}function yi(t,s,e){if(t){var a,n,i;ks(t,t.l||0);for(var c=t.length,l=0,u=0;t.l<c;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var o=N0[l]||N0[65535];for(a=t.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=t.read_shift(1))&127)<<7*n;u=t.l+i;var d=o.f&&o.f(t,i,e);if(t.l=u,s(d,o,l))return}}}function sg(){var t=[],s=cr?256:2048,e=function(o){var d=ds(o);return ks(d,0),d},a=e(s),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},i=function(o){return a&&o<a.length-a.l?a:(n(),a=e(Math.max(o+1,s)))},c=function(){return n(),Yi(t)},l=function(o){n(),a=o,a.l==null&&(a.l=a.length),i(s)};return{next:i,push:l,end:c,_bufs:t}}function Su(t,s,e){var a=Es(t);if(s.s?(a.cRel&&(a.c+=s.s.c),a.rRel&&(a.r+=s.s.r)):(a.cRel&&(a.c+=s.c),a.rRel&&(a.r+=s.r)),!e||e.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function K2(t,s,e){var a=Es(t);return a.s=Su(a.s,s.s,e),a.e=Su(a.e,s.s,e),a}function ku(t,s){if(t.cRel&&t.c<0)for(t=Es(t);t.c<0;)t.c+=s>8?16384:256;if(t.rRel&&t.r<0)for(t=Es(t);t.r<0;)t.r+=s>8?1048576:s>5?65536:16384;var e=Xt(t);return!t.cRel&&t.cRel!=null&&(e=VR(e)),!t.rRel&&t.rRel!=null&&(e=zR(e)),e}function jp(t,s){return t.s.r==0&&!t.s.rRel&&t.e.r==(s.biff>=12?1048575:s.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+fs(t.s.c)+":"+(t.e.cRel?"":"$")+fs(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(s.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ts(t.s.r)+":"+(t.e.rRel?"":"$")+Ts(t.e.r):ku(t.s,s.biff)+":"+ku(t.e,s.biff)}function vx(t){return parseInt(HR(t),10)-1}function Ts(t){return""+(t+1)}function zR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function HR(t){return t.replace(/\$(\d+)$/,"$1")}function _x(t){for(var s=qR(t),e=0,a=0;a!==s.length;++a)e=26*e+s.charCodeAt(a)-64;return e-1}function fs(t){if(t<0)throw new Error("invalid column "+t);var s="";for(++t;t;t=Math.floor((t-1)/26))s=String.fromCharCode((t-1)%26+65)+s;return s}function VR(t){return t.replace(/^([A-Z])/,"$$$1")}function qR(t){return t.replace(/^\$([A-Z])/,"$1")}function GR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qs(t){for(var s=0,e=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?s=10*s+(n-48):n>=65&&n<=90&&(e=26*e+(n-64))}return{c:e-1,r:s-1}}function Xt(t){for(var s=t.c+1,e="";s;s=(s-1)/26|0)e=String.fromCharCode((s-1)%26+65)+e;return e+(t.r+1)}function hc(t){var s=t.indexOf(":");return s==-1?{s:Qs(t),e:Qs(t)}:{s:Qs(t.slice(0,s)),e:Qs(t.slice(s+1))}}function hr(t,s){return typeof s>"u"||typeof s=="number"?hr(t.s,t.e):(typeof t!="string"&&(t=Xt(t)),typeof s!="string"&&(s=Xt(s)),t==s?t:t+":"+s)}function Gr(t){var s={s:{c:0,r:0},e:{c:0,r:0}},e=0,a=0,n=0,i=t.length;for(e=0;a<i&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)e=26*e+n;for(s.s.c=--e,e=0;a<i&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)e=10*e+n;if(s.s.r=--e,a===i||n!=10)return s.e.c=s.s.c,s.e.r=s.s.r,s;for(++a,e=0;a!=i&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)e=26*e+n;for(s.e.c=--e,e=0;a!=i&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)e=10*e+n;return s.e.r=--e,s}function Z2(t,s){var e=t.t=="d"&&s instanceof Date;if(t.z!=null)try{return t.w=Ja(t.z,e?ta(s):s)}catch{}try{return t.w=Ja((t.XF||{}).numFmtId||(e?14:0),e?ta(s):s)}catch{return""+s}}function xi(t,s,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?nl[t.v]||t.v:s==null?Z2(t,t.v):Z2(t,s))}function io(t,s){var e=s&&s.sheet?s.sheet:"Sheet1",a={};return a[e]=t,{SheetNames:[e],Sheets:a}}function W5(t,s,e){var a=e||{},n=t?Array.isArray(t):a.dense,i=t||(n?[]:{}),c=0,l=0;if(i&&a.origin!=null){if(typeof a.origin=="number")c=a.origin;else{var u=typeof a.origin=="string"?Qs(a.origin):a.origin;c=u.r,l=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var o={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Gr(i["!ref"]);o.s.c=d.s.c,o.s.r=d.s.r,o.e.c=Math.max(o.e.c,d.e.c),o.e.r=Math.max(o.e.r,d.e.r),c==-1&&(o.e.r=c=d.e.r+1)}for(var g=0;g!=s.length;++g)if(s[g]){if(!Array.isArray(s[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=s[g].length;++p)if(!(typeof s[g][p]>"u")){var h={v:s[g][p]},f=c+g,x=l+p;if(o.s.r>f&&(o.s.r=f),o.s.c>x&&(o.s.c=x),o.e.r<f&&(o.e.r=f),o.e.c<x&&(o.e.c=x),s[g][p]&&typeof s[g][p]=="object"&&!Array.isArray(s[g][p])&&!(s[g][p]instanceof Date))h=s[g][p];else if(Array.isArray(h.v)&&(h.f=s[g][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||Kt[14],a.cellDates?(h.t="d",h.w=Ja(h.z,ta(h.v))):(h.t="n",h.v=ta(h.v),h.w=Ja(h.z,h.v))):h.t="s";if(n)i[f]||(i[f]=[]),i[f][x]&&i[f][x].z&&(h.z=i[f][x].z),i[f][x]=h;else{var b=Xt({c:x,r:f});i[b]&&i[b].z&&(h.z=i[b].z),i[b]=h}}}return o.s.c<1e7&&(i["!ref"]=hr(o)),i}function mc(t,s){return W5(null,t,s)}function YR(t){return t.read_shift(4,"i")}function zs(t){var s=t.read_shift(4);return s===0?"":t.read_shift(s,"dbcs")}function WR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function wx(t,s){var e=t.l,a=t.read_shift(1),n=zs(t),i=[],c={t:n,h:n};if(a&1){for(var l=t.read_shift(4),u=0;u!=l;++u)i.push(WR(t));c.r=i}else c.r=[{ich:0,ifnt:0}];return t.l=e+s,c}var XR=wx;function tn(t){var s=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:s,iStyleRef:e}}function sl(t){var s=t.read_shift(2);return s+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:s}}var KR=zs;function Nx(t){var s=t.read_shift(4);return s===0||s===4294967295?"":t.read_shift(s,"dbcs")}var ZR=zs,ag=Nx;function jx(t){var s=t.slice(t.l,t.l+4),e=s[0]&1,a=s[0]&2;t.l+=4;var n=a===0?x0([0,0,0,0,s[0]&252,s[1],s[2],s[3]],0):Ro(s,0)>>2;return e?n/100:n}function X5(t){var s={s:{},e:{}};return s.s.r=t.read_shift(4),s.e.r=t.read_shift(4),s.s.c=t.read_shift(4),s.e.c=t.read_shift(4),s}var al=X5;function Ds(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function QR(t){var s={},e=t.read_shift(1),a=e>>>1,n=t.read_shift(1),i=t.read_shift(2,"i"),c=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(1);switch(t.l++,a){case 0:s.auto=1;break;case 1:s.index=n;var o=Do[n];o&&(s.rgb=$u(o));break;case 2:s.rgb=$u([c,l,u]);break;case 3:s.theme=n;break}return i!=0&&(s.tint=i>0?i/32767:i/32768),s}function JR(t){var s=t.read_shift(1);t.l++;var e={fBold:s&1,fItalic:s&2,fUnderline:s&4,fStrikeout:s&8,fOutline:s&16,fShadow:s&32,fCondense:s&64,fExtend:s&128};return e}function K5(t,s){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,s==1?"lpstr":"lpwstr")}function eM(t){return K5(t,1)}function tM(t){return K5(t,2)}var Sx=2,oa=3,Sf=11,Q2=12,b0=19,kf=64,rM=65,sM=71,aM=4108,nM=4126,xs=80,Z5=81,iM=[xs,Z5],oM={1:{n:"CodePage",t:Sx},2:{n:"Category",t:xs},3:{n:"PresentationFormat",t:xs},4:{n:"ByteCount",t:oa},5:{n:"LineCount",t:oa},6:{n:"ParagraphCount",t:oa},7:{n:"SlideCount",t:oa},8:{n:"NoteCount",t:oa},9:{n:"HiddenCount",t:oa},10:{n:"MultimediaClipCount",t:oa},11:{n:"ScaleCrop",t:Sf},12:{n:"HeadingPairs",t:aM},13:{n:"TitlesOfParts",t:nM},14:{n:"Manager",t:xs},15:{n:"Company",t:xs},16:{n:"LinksUpToDate",t:Sf},17:{n:"CharacterCount",t:oa},19:{n:"SharedDoc",t:Sf},22:{n:"HyperlinksChanged",t:Sf},23:{n:"AppVersion",t:oa,p:"version"},24:{n:"DigSig",t:rM},26:{n:"ContentType",t:xs},27:{n:"ContentStatus",t:xs},28:{n:"Language",t:xs},29:{n:"Version",t:xs},255:{},2147483648:{n:"Locale",t:b0},2147483651:{n:"Behavior",t:b0},1919054434:{}},lM={1:{n:"CodePage",t:Sx},2:{n:"Title",t:xs},3:{n:"Subject",t:xs},4:{n:"Author",t:xs},5:{n:"Keywords",t:xs},6:{n:"Comments",t:xs},7:{n:"Template",t:xs},8:{n:"LastAuthor",t:xs},9:{n:"RevNumber",t:xs},10:{n:"EditTime",t:kf},11:{n:"LastPrinted",t:kf},12:{n:"CreatedDate",t:kf},13:{n:"ModifiedDate",t:kf},14:{n:"PageCount",t:oa},15:{n:"WordCount",t:oa},16:{n:"CharCount",t:oa},17:{n:"Thumbnail",t:sM},18:{n:"Application",t:xs},19:{n:"DocSecurity",t:oa},255:{},2147483648:{n:"Locale",t:b0},2147483651:{n:"Behavior",t:b0},1919054434:{}},J2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},cM=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function uM(t){return t.map(function(s){return[s>>16&255,s>>8&255,s&255]})}var dM=uM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Do=Es(dM),nl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Q5={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},e_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function fM(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function hM(t){var s=fM();if(!t||!t.match)return s;var e={};if((t.match(Ys)||[]).forEach(function(a){var n=qt(a);switch(n[0].replace(_R,"<")){case"<?xml":break;case"<Types":s.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[n.Extension]=n.ContentType;break;case"<Override":s[e_[n.ContentType]]!==void 0&&s[e_[n.ContentType]].push(n.PartName);break}}),s.xmlns!==RR.CT)throw new Error("Unknown Namespace: "+s.xmlns);return s.calcchain=s.calcchains.length>0?s.calcchains[0]:"",s.sst=s.strs.length>0?s.strs[0]:"",s.style=s.styles.length>0?s.styles[0]:"",s.defaults=e,delete s.calcchains,s}var Pl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ng(t){var s=t.lastIndexOf("/");return t.slice(0,s+1)+"_rels/"+t.slice(s+1)+".rels"}function Cu(t,s){var e={"!id":{}};if(!t)return e;s.charAt(0)!=="/"&&(s="/"+s);var a={};return(t.match(Ys)||[]).forEach(function(n){var i=qt(n);if(i[0]==="<Relationship"){var c={};c.Type=i.Type,c.Target=i.Target,c.Id=i.Id,i.TargetMode&&(c.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:yu(i.Target,s);e[l]=c,a[i.Id]=c}}),e["!id"]=a,e}var mM="application/vnd.oasis.opendocument.spreadsheet";function pM(t,s){for(var e=bx(t),a,n;a=Du.exec(e);)switch(a[3]){case"manifest":break;case"file-entry":if(n=qt(a[0],!1),n.path=="/"&&n.type!==mM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(s&&s.WTF)throw a}}var Eu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gM=function(){for(var t=new Array(Eu.length),s=0;s<Eu.length;++s){var e=Eu[s],a="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[s]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t}();function J5(t){var s={};t=Or(t);for(var e=0;e<Eu.length;++e){var a=Eu[e],n=t.match(gM[e]);n!=null&&n.length>0&&(s[a[1]]=pr(n[1])),a[2]==="date"&&s[a[1]]&&(s[a[1]]=bs(s[a[1]]))}return s}var xM=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function e4(t,s,e,a){var n=[];if(typeof t=="string")n=V2(t,a);else for(var i=0;i<t.length;++i)n=n.concat(t[i].map(function(d){return{v:d}}));var c=typeof s=="string"?V2(s,a).map(function(d){return d.v}):s,l=0,u=0;if(c.length>0)for(var o=0;o!==n.length;o+=2){switch(u=+n[o+1].v,n[o].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=u,e.SheetNames=c.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=u,e.DefinedNames=c.slice(l,l+u);break;case"Charts":case"Diagramme":e.Chartsheets=u,e.ChartNames=c.slice(l,l+u);break}l+=u}}function bM(t,s,e){var a={};return s||(s={}),t=Or(t),xM.forEach(function(n){var i=(t.match(Bu(n[0]))||[])[1];switch(n[2]){case"string":i&&(s[n[1]]=pr(i));break;case"bool":s[n[1]]=i==="true";break;case"raw":var c=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));c&&c.length>0&&(a[n[1]]=c[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&e4(a.HeadingPairs,a.TitlesOfParts,s,e),s}var yM=/<[^>]+>[^<]*/g;function vM(t,s){var e={},a="",n=t.match(yM);if(n)for(var i=0;i!=n.length;++i){var c=n[i],l=qt(c);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=pr(l.name);break;case"</property>":a=null;break;default:if(c.indexOf("<vt:")===0){var u=c.split(">"),o=u[0].slice(4),d=u[1];switch(o){case"lpstr":case"bstr":case"lpwstr":e[a]=pr(d);break;case"bool":e[a]=Fr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":e[a]=parseFloat(d);break;case"filetime":case"date":e[a]=bs(d);break;case"cy":case"error":e[a]=pr(d);break;default:if(o.slice(-1)=="/")break;s.WTF&&typeof console<"u"&&console.warn("Unexpected",c,o,u)}}else if(c.slice(0,2)!=="</"){if(s.WTF)throw new Error(c)}}}return e}var _M={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Sp;function wM(t,s,e){Sp||(Sp=px(_M)),s=Sp[s]||s,t[s]=e}function kx(t){var s=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+s/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function t4(t,s,e){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-a&3;)++t.l;return n}function r4(t,s,e){var a=t.read_shift(0,"lpwstr");return a}function s4(t,s,e){return s===31?r4(t):t4(t,s,e)}function ig(t,s,e){return s4(t,s,e===!1?0:4)}function NM(t,s){if(!s)throw new Error("VtUnalignedString must have positive length");return s4(t,s,0)}function jM(t){for(var s=t.read_shift(4),e=[],a=0;a!=s;++a){var n=t.l;e[a]=t.read_shift(0,"lpwstr").replace(Js,""),t.l-n&2&&(t.l+=2)}return e}function SM(t){for(var s=t.read_shift(4),e=[],a=0;a!=s;++a)e[a]=t.read_shift(0,"lpstr-cp").replace(Js,"");return e}function kM(t){var s=t.l,e=y0(t,Z5);t[t.l]==0&&t[t.l+1]==0&&t.l-s&2&&(t.l+=2);var a=y0(t,oa);return[e,a]}function CM(t){for(var s=t.read_shift(4),e=[],a=0;a<s/2;++a)e.push(kM(t));return e}function t_(t,s){for(var e=t.read_shift(4),a={},n=0;n!=e;++n){var i=t.read_shift(4),c=t.read_shift(4);a[i]=t.read_shift(c,s===1200?"utf16le":"utf8").replace(Js,"").replace(bu,"!"),s===1200&&c%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function a4(t){var s=t.read_shift(4),e=t.slice(t.l,t.l+s);return t.l+=s,(s&3)>0&&(t.l+=4-(s&3)&3),e}function EM(t){var s={};return s.Size=t.read_shift(4),t.l+=s.Size+3-(s.Size-1)%4,s}function y0(t,s,e){var a=t.read_shift(2),n,i=e||{};if(t.l+=2,s!==Q2&&a!==s&&iM.indexOf(s)===-1&&!((s&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+s+" saw "+a);switch(s===Q2?a:s){case 2:return n=t.read_shift(2,"i"),i.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return t4(t,a,4).replace(Js,"");case 31:return r4(t);case 64:return kx(t);case 65:return a4(t);case 71:return EM(t);case 80:return ig(t,a,!i.raw).replace(Js,"");case 81:return NM(t,a).replace(Js,"");case 4108:return CM(t);case 4126:case 4127:return a==4127?jM(t):SM(t);default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+a)}}function r_(t,s){var e=t.l,a=t.read_shift(4),n=t.read_shift(4),i=[],c=0,l=0,u=-1,o={};for(c=0;c!=n;++c){var d=t.read_shift(4),g=t.read_shift(4);i[c]=[d,g+e]}i.sort(function(_,N){return _[1]-N[1]});var p={};for(c=0;c!=n;++c){if(t.l!==i[c][1]){var h=!0;if(c>0&&s)switch(s[i[c-1][0]].t){case 2:t.l+2===i[c][1]&&(t.l+=2,h=!1);break;case 80:t.l<=i[c][1]&&(t.l=i[c][1],h=!1);break;case 4108:t.l<=i[c][1]&&(t.l=i[c][1],h=!1);break}if((!s||c==0)&&t.l<=i[c][1]&&(h=!1,t.l=i[c][1]),h)throw new Error("Read Error: Expected address "+i[c][1]+" at "+t.l+" :"+c)}if(s){var f=s[i[c][0]];if(p[f.n]=y0(t,f.t,{raw:!0}),f.p==="version"&&(p[f.n]=String(p[f.n]>>16)+"."+("0000"+String(p[f.n]&65535)).slice(-4)),f.n=="CodePage")switch(p[f.n]){case 0:p[f.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fn(l=p[f.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[f.n])}}else if(i[c][0]===1){if(l=p.CodePage=y0(t,Sx),fn(l),u!==-1){var x=t.l;t.l=i[u][1],o=t_(t,l),t.l=x}}else if(i[c][0]===0){if(l===0){u=c,t.l=i[c+1][1];continue}o=t_(t,l)}else{var b=o[i[c][0]],v;switch(t[t.l]){case 65:t.l+=4,v=a4(t);break;case 30:t.l+=4,v=ig(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=ig(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t.read_shift(4,"i");break;case 19:t.l+=4,v=t.read_shift(4);break;case 5:t.l+=4,v=t.read_shift(8,"f");break;case 11:t.l+=4,v=Xr(t,4);break;case 64:t.l+=4,v=bs(kx(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[b]=v}}return t.l=e+a,p}function s_(t,s,e){var a=t.content;if(!a)return{};ks(a,0);var n,i,c,l,u=0;a.chk("feff","Byte Order: "),a.read_shift(2);var o=a.read_shift(4),d=a.read_shift(16);if(d!==fr.utils.consts.HEADER_CLSID&&d!==e)throw new Error("Bad PropertySet CLSID "+d);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),l=a.read_shift(4),n===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);n===2&&(c=a.read_shift(16),u=a.read_shift(4));var g=r_(a,s),p={SystemIdentifier:o};for(var h in g)p[h]=g[h];if(p.FMTID=i,n===1)return p;if(u-a.l==2&&(a.l+=2),a.l!==u)throw new Error("Length mismatch 2: "+a.l+" !== "+u);var f;try{f=r_(a,null)}catch{}for(h in f)p[h]=f[h];return p.FMTID=[i,c],p}function Gi(t,s){return t.read_shift(s),null}function TM(t,s,e){for(var a=[],n=t.l+s;t.l<n;)a.push(e(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function Xr(t,s){return t.read_shift(s)===1}function is(t){return t.read_shift(2,"u")}function n4(t,s){return TM(t,s,is)}function AM(t){var s=t.read_shift(1),e=t.read_shift(1);return e===1?s:s===1}function od(t,s,e){var a=t.read_shift(e&&e.biff>=12?2:1),n="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var i=t.read_shift(1);i&&(n="dbcs-cont")}else e.biff==12&&(n="wstr");e.biff>=2&&e.biff<=5&&(n="cpstr");var c=a?t.read_shift(a,n):"";return c}function OM(t){var s=t.read_shift(2),e=t.read_shift(1),a=e&4,n=e&8,i=1+(e&1),c=0,l,u={};n&&(c=t.read_shift(2)),a&&(l=t.read_shift(4));var o=i==2?"dbcs-cont":"sbcs-cont",d=s===0?"":t.read_shift(s,o);return n&&(t.l+=4*c),a&&(t.l+=l),u.t=d,n||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Yo(t,s,e){var a;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(s,"cpstr");if(e.biff>=12)return t.read_shift(s,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(s,"sbcs-cont"):a=t.read_shift(s,"dbcs-cont"),a}function ld(t,s,e){var a=t.read_shift(e&&e.biff==2?1:2);return a===0?(t.l++,""):Yo(t,a,e)}function il(t,s,e){if(e.biff>5)return ld(t,s,e);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function RM(t){var s=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[s,e]}function MM(t){var s=t.read_shift(4),e=t.l,a=!1;s>24&&(t.l+=s-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=e);var n=t.read_shift((a?s-24:s)>>1,"utf16le").replace(Js,"");return a&&(t.l+=24),n}function FM(t){for(var s=t.read_shift(2),e="";s-- >0;)e+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return e+a.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=t.read_shift(i>>1,"utf16le").replace(Js,"");return e+c}function IM(t,s){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return MM(t);case"0303000000000000c000000000000046":return FM(t);default:throw new Error("Unsupported Moniker "+e)}}function Cf(t){var s=t.read_shift(4),e=s>0?t.read_shift(s,"utf16le").replace(Js,""):"";return e}function LM(t,s){var e=t.l+s,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var i,c,l,u,o="",d,g;n&16&&(i=Cf(t,e-t.l)),n&128&&(c=Cf(t,e-t.l)),(n&257)===257&&(l=Cf(t,e-t.l)),(n&257)===1&&(u=IM(t,e-t.l)),n&8&&(o=Cf(t,e-t.l)),n&32&&(d=t.read_shift(16)),n&64&&(g=kx(t)),t.l=e;var p=c||l||u||"";p&&o&&(p+="#"+o),p||(p="#"+o),n&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return d&&(h.guid=d),g&&(h.time=g),i&&(h.Tooltip=i),h}function i4(t){var s=t.read_shift(1),e=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[s,e,a,n]}function o4(t,s){var e=i4(t);return e[3]=0,e}function Vn(t){var s=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2);return{r:s,c:e,ixfe:a}}function PM(t){var s=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:s,flags:e}}function BM(t,s,e){return s===0?"":il(t,s,e)}function DM(t,s,e){var a=e.biff>8?4:2,n=t.read_shift(a),i=t.read_shift(a,"i"),c=t.read_shift(a,"i");return[n,i,c]}function l4(t){var s=t.read_shift(2),e=jx(t);return[s,e]}function UM(t,s,e){t.l+=4,s-=4;var a=t.l+s,n=od(t,s,e),i=t.read_shift(2);if(a-=t.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return t.l+=i,n}function K0(t){var s=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r:s},e:{c:n,r:e}}}function c4(t){var s=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r:s},e:{c:n,r:e}}}var $M=c4;function u4(t){t.l+=4;var s=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[e,s,a]}function zM(t){var s={};return t.l+=4,t.l+=16,s.fSharedNote=t.read_shift(2),t.l+=4,s}function HM(t){var s={};return t.l+=4,t.cf=t.read_shift(2),s}function Is(t){t.l+=2,t.l+=t.read_shift(2)}var VM={0:Is,4:Is,5:Is,6:Is,7:HM,8:Is,9:Is,10:Is,11:Is,12:Is,13:zM,14:Is,15:Is,16:Is,17:Is,18:Is,19:Is,20:Is,21:u4};function qM(t,s){for(var e=t.l+s,a=[];t.l<e;){var n=t.read_shift(2);t.l-=2;try{a.push(VM[n](t,e-t.l))}catch{return t.l=e,a}}return t.l!=e&&(t.l=e),a}function Ef(t,s){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),s-=2,s>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(s>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(s),e}function GM(t,s){return s===0||t.read_shift(2),1200}function YM(t,s,e){if(e.enc)return t.l+=s,"";var a=t.l,n=il(t,0,e);return t.read_shift(s+a-t.l),n}function WM(t,s,e){var a=e&&e.biff==8||s==2?t.read_shift(2):(t.l+=s,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function XM(t,s,e){var a=t.read_shift(4),n=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var c=od(t,0,e);return c.length===0&&(c="Sheet1"),{pos:a,hs:n,dt:i,name:c}}function KM(t,s){for(var e=t.l+s,a=t.read_shift(4),n=t.read_shift(4),i=[],c=0;c!=n&&t.l<e;++c)i.push(OM(t));return i.Count=a,i.Unique=n,i}function ZM(t,s){var e={};return e.dsst=t.read_shift(2),t.l+=s-2,e}function QM(t){var s={};s.r=t.read_shift(2),s.c=t.read_shift(2),s.cnt=t.read_shift(2)-s.c;var e=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(s.level=a&7),a&32&&(s.hidden=!0),a&64&&(s.hpt=e/20),s}function JM(t){var s=PM(t);if(s.type!=2211)throw new Error("Invalid Future Record "+s.type);var e=t.read_shift(4);return e!==0}function eF(t){return t.read_shift(2),t.read_shift(4)}function a_(t,s,e){var a=0;e&&e.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);e&&e.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function tF(t){var s=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),c=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),o=t.read_shift(2);return{Pos:[s,e],Dim:[a,n],Flags:i,CurTab:c,FirstTab:l,Selected:u,TabRatio:o}}function rF(t,s,e){if(e&&e.biff>=2&&e.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function sF(){}function aF(t,s,e){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=od(t,0,e),a}function nF(t){var s=Vn(t);return s.isst=t.read_shift(4),s}function iF(t,s,e){e.biffguess&&e.biff==2&&(e.biff=5);var a=t.l+s,n=Vn(t);e.biff==2&&t.l++;var i=ld(t,a-t.l,e);return n.val=i,n}function oF(t,s,e){var a=t.read_shift(2),n=il(t,0,e);return[a,n]}var lF=il;function n_(t,s,e){var a=t.l+s,n=e.biff==8||!e.biff?4:2,i=t.read_shift(n),c=t.read_shift(n),l=t.read_shift(2),u=t.read_shift(2);return t.l=a,{s:{r:i,c:l},e:{r:c,c:u}}}function cF(t){var s=t.read_shift(2),e=t.read_shift(2),a=l4(t);return{r:s,c:e,ixfe:a[0],rknum:a[1]}}function uF(t,s){for(var e=t.l+s-2,a=t.read_shift(2),n=t.read_shift(2),i=[];t.l<e;)i.push(l4(t));if(t.l!==e)throw new Error("MulRK read error");var c=t.read_shift(2);if(i.length!=c-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:c,rkrec:i}}function dF(t,s){for(var e=t.l+s-2,a=t.read_shift(2),n=t.read_shift(2),i=[];t.l<e;)i.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var c=t.read_shift(2);if(i.length!=c-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:c,ixfe:i}}function fF(t,s,e,a){var n={},i=t.read_shift(4),c=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(2);return n.patternType=cM[l>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=c&15,n.dgRight=c>>4&15,n.dgTop=c>>8&15,n.dgBottom=c>>12&15,n.icvLeft=c>>16&127,n.icvRight=c>>23&127,n.grbitDiag=c>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=u&127,n.icvBack=u>>7&127,n.fsxButton=u>>14&1),n}function hF(t,s,e){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,s-=6,a.data=fF(t,s,a.fStyle,e),a}function mF(t){t.l+=4;var s=[t.read_shift(2),t.read_shift(2)];if(s[0]!==0&&s[0]--,s[1]!==0&&s[1]--,s[0]>7||s[1]>7)throw new Error("Bad Gutters: "+s.join("|"));return s}function i_(t,s,e){var a=Vn(t);(e.biff==2||s==9)&&++t.l;var n=AM(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function pF(t,s,e){e.biffguess&&e.biff==2&&(e.biff=5);var a=Vn(t),n=Ds(t);return a.val=n,a}var o_=BM;function gF(t,s,e){var a=t.l+s,n=t.read_shift(2),i=t.read_shift(2);if(e.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var c=Yo(t,i),l=[];a>t.l;)l.push(ld(t));return[i,n,c,l]}function l_(t,s,e){var a=t.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return e.sbcch===14849&&(n=UM(t,s-2,e)),i.body=n||t.read_shift(s-2),typeof n=="string"&&(i.Name=n),i}var xF=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function c_(t,s,e){var a=t.l+s,n=t.read_shift(2),i=t.read_shift(1),c=t.read_shift(1),l=t.read_shift(e&&e.biff==2?1:2),u=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),u=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var o=Yo(t,c,e);n&32&&(o=xF[o.charCodeAt(0)]);var d=a-t.l;e&&e.biff==2&&--d;var g=a==t.l||l===0||!(d>0)?[]:QP(t,d,e,l);return{chKey:i,Name:o,itab:u,rgce:g}}function d4(t,s,e){if(e.biff<8)return bF(t,s,e);for(var a=[],n=t.l+s,i=t.read_shift(e.biff>8?4:2);i--!==0;)a.push(DM(t,e.biff>8?12:6,e));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function bF(t,s,e){t[t.l+1]==3&&t[t.l]++;var a=od(t,s,e);return a.charCodeAt(0)==3?a.slice(1):a}function yF(t,s,e){if(e.biff<8){t.l+=s;return}var a=t.read_shift(2),n=t.read_shift(2),i=Yo(t,a,e),c=Yo(t,n,e);return[i,c]}function vF(t,s,e){var a=c4(t);t.l++;var n=t.read_shift(1);return s-=8,[JP(t,s,e),n,a]}function u_(t,s,e){var a=$M(t);switch(e.biff){case 2:t.l++,s-=7;break;case 3:case 4:t.l+=2,s-=8;break;default:t.l+=6,s-=12}return[a,KP(t,s,e)]}function _F(t){var s=t.read_shift(4)!==0,e=t.read_shift(4)!==0,a=t.read_shift(4);return[s,e,a]}function wF(t,s,e){if(!(e.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),c=t.read_shift(2),l=il(t,0,e);return e.biff<8&&t.read_shift(1),[{r:a,c:n},l,c,i]}}function NF(t,s,e){return wF(t,s,e)}function jF(t,s){for(var e=[],a=t.read_shift(2);a--;)e.push(K0(t));return e}function SF(t,s,e){if(e&&e.biff<8)return CF(t,s,e);var a=u4(t),n=qM(t,s-22,a[1]);return{cmo:a,ft:n}}var kF={8:function(t,s){var e=t.l+s;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=e,{fmt:a}}};function CF(t,s,e){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,s-=36;var c=[];return c.push((kF[a]||Vs)(t,s,e)),{cmo:[n,a,i],ft:c}}function EF(t,s,e){var a=t.l,n="";try{t.l+=4;var i=(e.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:c=RM(t,6,e);var l=t.read_shift(2);t.read_shift(2),is(t,2);var u=t.read_shift(2);t.l+=u;for(var o=1;o<t.lens.length-1;++o){if(t.l-a!=t.lens[o])throw new Error("TxO: bad continue record");var d=t[t.l],g=Yo(t,t.lens[o+1]-t.lens[o]-1);if(n+=g,n.length>=(d?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return t.l=a+s,{t:n}}catch{return t.l=a+s,{t:n}}}function TF(t,s){var e=K0(t);t.l+=16;var a=LM(t,s-24);return[e,a]}function AF(t,s){t.read_shift(2);var e=K0(t),a=t.read_shift((s-10)/2,"dbcs-cont");return a=a.replace(Js,""),[e,a]}function OF(t){var s=[0,0],e;return e=t.read_shift(2),s[0]=J2[e]||e,e=t.read_shift(2),s[1]=J2[e]||e,s}function RF(t){for(var s=t.read_shift(2),e=[];s-- >0;)e.push(o4(t));return e}function MF(t){for(var s=t.read_shift(2),e=[];s-- >0;)e.push(o4(t));return e}function FF(t){t.l+=2;var s={cxfs:0,crc:0};return s.cxfs=t.read_shift(2),s.crc=t.read_shift(4),s}function f4(t,s,e){if(!e.cellStyles)return Vs(t,s);var a=e&&e.biff>=12?4:2,n=t.read_shift(a),i=t.read_shift(a),c=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2);a==2&&(t.l+=2);var o={s:n,e:i,w:c,ixfe:l,flags:u};return(e.biff>=5||!e.biff)&&(o.level=u>>8&7),o}function IF(t,s){var e={};return s<32||(t.l+=16,e.header=Ds(t),e.footer=Ds(t),t.l+=2),e}function LF(t,s,e){var a={area:!1};if(e.biff!=5)return t.l+=s,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}var PF=Vn,BF=n4,DF=ld;function UF(t){var s=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(4),n={fmt:s,env:e,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function $F(t,s,e){e.biffguess&&e.biff==5&&(e.biff=2);var a=Vn(t);++t.l;var n=il(t,s-7,e);return a.t="str",a.val=n,a}function zF(t){var s=Vn(t);++t.l;var e=Ds(t);return s.t="n",s.val=e,s}function HF(t){var s=Vn(t);++t.l;var e=t.read_shift(2);return s.t="n",s.val=e,s}function VF(t){var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,"sbcs-cont")}function qF(t,s){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=s-13}function GF(t,s,e){var a=t.l+s,n=Vn(t),i=t.read_shift(2),c=Yo(t,i,e);return t.l=a,n.t="str",n.val=c,n}var YF=[2,3,48,49,131,139,140,245],d_=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},s=px({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,u){var o=[],d=to(1);switch(u.type){case"base64":d=dn(Ta(l));break;case"binary":d=dn(l);break;case"buffer":case"array":d=l;break}ks(d,0);var g=d.read_shift(1),p=!!(g&136),h=!1,f=!1;switch(g){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:f=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var x=0,b=521;g==2&&(x=d.read_shift(2)),d.l+=3,g!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),g!=2&&(b=d.read_shift(2));var v=d.read_shift(2),_=u.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(_=t[d[d.l]]),d.l+=1,d.l+=2),f&&(d.l+=36);for(var N=[],E={},O=Math.min(d.length,g==2?521:b-10-(h?264:0)),F=f?32:11;d.l<O&&d[d.l]!=13;)switch(E={},E.name=rg.utils.decode(_,d.slice(d.l,d.l+F)).replace(/[\u0000\r\n].*$/g,""),d.l+=F,E.type=String.fromCharCode(d.read_shift(1)),g!=2&&!f&&(E.offset=d.read_shift(4)),E.len=d.read_shift(1),g==2&&(E.offset=d.read_shift(2)),E.dec=d.read_shift(1),E.name.length&&N.push(E),g!=2&&(d.l+=f?13:14),E.type){case"B":(!h||E.len!=8)&&u.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(d[d.l]!==13&&(d.l=b-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=b;var z=0,P=0;for(o[0]=[],P=0;P!=N.length;++P)o[0][P]=N[P].name;for(;x-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,o[++z]=[],P=0,P=0;P!=N.length;++P){var U=d.slice(d.l,d.l+N[P].len);d.l+=N[P].len,ks(U,0);var W=rg.utils.decode(_,U);switch(N[P].type){case"C":W.trim().length&&(o[z][P]=W.replace(/\s+$/,""));break;case"D":W.length===8?o[z][P]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):o[z][P]=W;break;case"F":o[z][P]=parseFloat(W.trim());break;case"+":case"I":o[z][P]=f?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":o[z][P]=!0;break;case"N":case"F":o[z][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));o[z][P]="##MEMO##"+(f?parseInt(W.trim(),10):U.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(o[z][P]=+W||0);break;case"@":o[z][P]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":o[z][P]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":o[z][P]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":o[z][P]=-U.read_shift(-8,"f");break;case"B":if(h&&N[P].len==8){o[z][P]=U.read_shift(8,"f");break}case"G":case"P":U.l+=N[P].len;break;case"0":if(N[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[P].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(o=o.slice(0,u.sheetRows)),u.DBF=N,o}function a(l,u){var o=u||{};o.dateNF||(o.dateNF="yyyymmdd");var d=mc(e(l,o),o);return d["!cols"]=o.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete o.DBF,d}function n(l,u){try{return io(a(l,u),u)}catch(o){if(u&&u.WTF)throw o}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function c(l,u){var o=u||{};if(+o.codepage>=0&&fn(+o.codepage),o.type=="string")throw new Error("Cannot write DBF to JS string");var d=sg(),g=fg(l,{header:1,raw:!0,cellDates:!0}),p=g[0],h=g.slice(1),f=l["!cols"]||[],x=0,b=0,v=0,_=1;for(x=0;x<p.length;++x){if(((f[x]||{}).DBF||{}).name){p[x]=f[x].DBF.name,++v;continue}if(p[x]!=null){if(++v,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(b=0;b<1024;++b)if(p.indexOf(p[x]+"_"+b)==-1){p[x]+="_"+b;break}}}}var N=Gr(l["!ref"]),E=[],O=[],F=[];for(x=0;x<=N.e.c-N.s.c;++x){var z="",P="",U=0,W=[];for(b=0;b<h.length;++b)h[b][x]!=null&&W.push(h[b][x]);if(W.length==0||p[x]==null){E[x]="?";continue}for(b=0;b<W.length;++b){switch(typeof W[b]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=W[b]instanceof Date?"D":"C";break;default:P="C"}U=Math.max(U,String(W[b]).length),z=z&&z!=P?"C":P}U>250&&(U=250),P=((f[x]||{}).DBF||{}).type,P=="C"&&f[x].DBF.len>U&&(U=f[x].DBF.len),z=="B"&&P=="N"&&(z="N",F[x]=f[x].DBF.dec,U=f[x].DBF.len),O[x]=z=="C"||P=="N"?U:i[z]||0,_+=O[x],E[x]=z}var Y=d.next(32);for(Y.write_shift(4,318902576),Y.write_shift(4,h.length),Y.write_shift(2,296+32*v),Y.write_shift(2,_),x=0;x<4;++x)Y.write_shift(4,0);for(Y.write_shift(4,0|(+s[d5]||3)<<8),x=0,b=0;x<p.length;++x)if(p[x]!=null){var q=d.next(32),M=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,M,"sbcs"),q.write_shift(1,E[x]=="?"?"C":E[x],"sbcs"),q.write_shift(4,b),q.write_shift(1,O[x]||i[E[x]]||0),q.write_shift(1,F[x]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),b+=O[x]||i[E[x]]||0}var D=d.next(264);for(D.write_shift(4,13),x=0;x<65;++x)D.write_shift(4,0);for(x=0;x<h.length;++x){var T=d.next(_);for(T.write_shift(1,0),b=0;b<p.length;++b)if(p[b]!=null)switch(E[b]){case"L":T.write_shift(1,h[x][b]==null?63:h[x][b]?84:70);break;case"B":T.write_shift(8,h[x][b]||0,"f");break;case"N":var C="0";for(typeof h[x][b]=="number"&&(C=h[x][b].toFixed(F[b]||0)),v=0;v<O[b]-C.length;++v)T.write_shift(1,32);T.write_shift(1,C,"sbcs");break;case"D":h[x][b]?(T.write_shift(4,("0000"+h[x][b].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(h[x][b].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+h[x][b].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var S=String(h[x][b]!=null?h[x][b]:"").slice(0,O[b]);for(T.write_shift(1,S,"sbcs"),v=0;v<O[b]-S.length;++v)T.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:a,from_sheet:c}}(),WF=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},s=new RegExp("\x1BN("+zn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(p,h){var f=t[h];return typeof f=="number"?C2(f):f},a=function(p,h,f){var x=h.charCodeAt(0)-32<<4|f.charCodeAt(0)-48;return x==59?p:C2(x)};t["|"]=254;function n(p,h){switch(h.type){case"base64":return i(Ta(p),h);case"binary":return i(p,h);case"buffer":return i(cr&&Buffer.isBuffer(p)?p.toString("binary"):rl(p),h);case"array":return i(Go(p),h)}throw new Error("Unrecognized type "+h.type)}function i(p,h){var f=p.split(/[\n\r]+/),x=-1,b=-1,v=0,_=0,N=[],E=[],O=null,F={},z=[],P=[],U=[],W=0,Y;for(+h.codepage>=0&&fn(+h.codepage);v!==f.length;++v){W=0;var q=f[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(s,e),M=q.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),D=M[0],T;if(q.length>0)switch(D){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&E.push(q.slice(3).replace(/;;/g,";"));break;case"C":var C=!1,S=!1,w=!1,j=!1,A=-1,L=-1;for(_=1;_<M.length;++_)switch(M[_].charAt(0)){case"A":break;case"X":b=parseInt(M[_].slice(1))-1,S=!0;break;case"Y":for(x=parseInt(M[_].slice(1))-1,S||(b=0),Y=N.length;Y<=x;++Y)N[Y]=[];break;case"K":T=M[_].slice(1),T.charAt(0)==='"'?T=T.slice(1,T.length-1):T==="TRUE"?T=!0:T==="FALSE"?T=!1:isNaN(mn(T))?isNaN(Jl(T).getDate())||(T=bs(T)):(T=mn(T),O!==null&&fc(O)&&(T=X0(T))),C=!0;break;case"E":j=!0;var I=zl(M[_].slice(1),{r:x,c:b});N[x][b]=[N[x][b],I];break;case"S":w=!0,N[x][b]=[N[x][b],"S5S"];break;case"G":break;case"R":A=parseInt(M[_].slice(1))-1;break;case"C":L=parseInt(M[_].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+q)}if(C&&(N[x][b]&&N[x][b].length==2?N[x][b][0]=T:N[x][b]=T,O=null),w){if(j)throw new Error("SYLK shared formula cannot have own formula");var Z=A>-1&&N[A][L];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");N[x][b][1]=w4(Z[1],{r:x-A,c:b-L})}break;case"F":var K=0;for(_=1;_<M.length;++_)switch(M[_].charAt(0)){case"X":b=parseInt(M[_].slice(1))-1,++K;break;case"Y":for(x=parseInt(M[_].slice(1))-1,Y=N.length;Y<=x;++Y)N[Y]=[];break;case"M":W=parseInt(M[_].slice(1))/20;break;case"F":break;case"G":break;case"P":O=E[parseInt(M[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=M[_].slice(1).split(" "),Y=parseInt(U[0],10);Y<=parseInt(U[1],10);++Y)W=parseInt(U[2],10),P[Y-1]=W===0?{hidden:!0}:{wch:W},ec(P[Y-1]);break;case"C":b=parseInt(M[_].slice(1))-1,P[b]||(P[b]={});break;case"R":x=parseInt(M[_].slice(1))-1,z[x]||(z[x]={}),W>0?(z[x].hpt=W,z[x].hpx=zu(W)):W===0&&(z[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+q)}K<1&&(O=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+q)}}return z.length>0&&(F["!rows"]=z),P.length>0&&(F["!cols"]=P),h&&h.sheetRows&&(N=N.slice(0,h.sheetRows)),[N,F]}function c(p,h){var f=n(p,h),x=f[0],b=f[1],v=mc(x,h);return zn(b).forEach(function(_){v[_]=b[_]}),v}function l(p,h){return io(c(p,h),h)}function u(p,h,f,x){var b="C;Y"+(f+1)+";X"+(x+1)+";K";switch(p.t){case"n":b+=p.v||0,p.f&&!p.F&&(b+=";E"+FL(p.f,{r:f,c:x}));break;case"b":b+=p.v?"TRUE":"FALSE";break;case"e":b+=p.w||p.v;break;case"d":b+='"'+(p.w||p.v)+'"';break;case"s":b+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function o(p,h){h.forEach(function(f,x){var b="F;W"+(x+1)+" "+(x+1)+" ";f.hidden?b+="0":(typeof f.width=="number"&&!f.wpx&&(f.wpx=_0(f.width)),typeof f.wpx=="number"&&!f.wch&&(f.wch=w0(f.wpx)),typeof f.wch=="number"&&(b+=Math.round(f.wch))),b.charAt(b.length-1)!=" "&&p.push(b)})}function d(p,h){h.forEach(function(f,x){var b="F;";f.hidden?b+="M0;":f.hpt?b+="M"+20*f.hpt+";":f.hpx&&(b+="M"+20*y4(f.hpx)+";"),b.length>2&&p.push(b+"R"+(x+1))})}function g(p,h){var f=["ID;PWXL;N;E"],x=[],b=Gr(p["!ref"]),v,_=Array.isArray(p),N=`\r
`;f.push("P;PGeneral"),f.push("F;P0;DG0G8;M255"),p["!cols"]&&o(f,p["!cols"]),p["!rows"]&&d(f,p["!rows"]),f.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var E=b.s.r;E<=b.e.r;++E)for(var O=b.s.c;O<=b.e.c;++O){var F=Xt({r:E,c:O});v=_?(p[E]||[])[O]:p[F],!(!v||v.v==null&&(!v.f||v.F))&&x.push(u(v,p,E,O))}return f.join(N)+N+x.join(N)+N+"E"+N}return{to_workbook:l,to_sheet:c,from_sheet:g}}(),XF=function(){function t(i,c){switch(c.type){case"base64":return s(Ta(i),c);case"binary":return s(i,c);case"buffer":return s(cr&&Buffer.isBuffer(i)?i.toString("binary"):rl(i),c);case"array":return s(Go(i),c)}throw new Error("Unrecognized type "+c.type)}function s(i,c){for(var l=i.split(`
`),u=-1,o=-1,d=0,g=[];d!==l.length;++d){if(l[d].trim()==="BOT"){g[++u]=[],o=0;continue}if(!(u<0)){var p=l[d].trim().split(","),h=p[0],f=p[1];++d;for(var x=l[d]||"";(x.match(/["]/g)||[]).length&1&&d<l.length-1;)x+=`
`+l[++d];switch(x=x.trim(),+h){case-1:if(x==="BOT"){g[++u]=[],o=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?g[u][o]=!0:x==="FALSE"?g[u][o]=!1:isNaN(mn(f))?isNaN(Jl(f).getDate())?g[u][o]=f:g[u][o]=bs(f):g[u][o]=mn(f),++o;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),g[u][o++]=x!==""?x:null;break}if(x==="EOD")break}}return c&&c.sheetRows&&(g=g.slice(0,c.sheetRows)),g}function e(i,c){return mc(t(i,c),c)}function a(i,c){return io(e(i,c),c)}var n=function(){var i=function(u,o,d,g,p){u.push(o),u.push(d+","+g),u.push('"'+p.replace(/"/g,'""')+'"')},c=function(u,o,d,g){u.push(o+","+d),u.push(o==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var o=[],d=Gr(u["!ref"]),g,p=Array.isArray(u);i(o,"TABLE",0,1,"sheetjs"),i(o,"VECTORS",0,d.e.r-d.s.r+1,""),i(o,"TUPLES",0,d.e.c-d.s.c+1,""),i(o,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){c(o,-1,0,"BOT");for(var f=d.s.c;f<=d.e.c;++f){var x=Xt({r:h,c:f});if(g=p?(u[h]||[])[f]:u[x],!g){c(o,1,0,"");continue}switch(g.t){case"n":var b=g.w;!b&&g.v!=null&&(b=g.v),b==null?g.f&&!g.F?c(o,1,0,"="+g.f):c(o,1,0,""):c(o,0,b,"V");break;case"b":c(o,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":c(o,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Ja(g.z||Kt[14],ta(bs(g.v)))),c(o,0,g.w,"V");break;default:c(o,1,0,"")}}}c(o,-1,0,"EOD");var v=`\r
`,_=o.join(v);return _}}();return{to_workbook:a,to_sheet:e,from_sheet:n}}(),KF=function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function s(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(g,p){for(var h=g.split(`
`),f=-1,x=-1,b=0,v=[];b!==h.length;++b){var _=h[b].trim().split(":");if(_[0]==="cell"){var N=Qs(_[1]);if(v.length<=N.r)for(f=v.length;f<=N.r;++f)v[f]||(v[f]=[]);switch(f=N.r,x=N.c,_[2]){case"t":v[f][x]=t(_[3]);break;case"v":v[f][x]=+_[3];break;case"vtf":var E=_[_.length-1];case"vtc":switch(_[3]){case"nl":v[f][x]=!!+_[4];break;default:v[f][x]=+_[4];break}_[2]=="vtf"&&(v[f][x]=[v[f][x],E])}}}return p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}function a(g,p){return mc(e(g,p),p)}function n(g,p){return io(a(g,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function o(g){if(!g||!g["!ref"])return"";for(var p=[],h=[],f,x="",b=hc(g["!ref"]),v=Array.isArray(g),_=b.s.r;_<=b.e.r;++_)for(var N=b.s.c;N<=b.e.c;++N)if(x=Xt({r:_,c:N}),f=v?(g[_]||[])[N]:g[x],!(!f||f.v==null||f.t==="z")){switch(h=["cell",x,"t"],f.t){case"s":case"str":h.push(s(f.v));break;case"n":f.f?(h[2]="vtf",h[3]="n",h[4]=f.v,h[5]=s(f.f)):(h[2]="v",h[3]=f.v);break;case"b":h[2]="vt"+(f.f?"f":"c"),h[3]="nl",h[4]=f.v?"1":"0",h[5]=s(f.f||(f.v?"TRUE":"FALSE"));break;case"d":var E=ta(bs(f.v));h[2]="vtc",h[3]="nd",h[4]=""+E,h[5]=f.w||Ja(f.z||Kt[14],E);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(g){return[i,c,l,c,o(g),u].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:d}}(),Uu=function(){function t(d,g,p,h,f){f.raw?g[p][h]=d:d===""||(d==="TRUE"?g[p][h]=!0:d==="FALSE"?g[p][h]=!1:isNaN(mn(d))?isNaN(Jl(d).getDate())?g[p][h]=d:g[p][h]=bs(d):g[p][h]=mn(d))}function s(d,g){var p=g||{},h=[];if(!d||d.length===0)return h;for(var f=d.split(/[\r\n]/),x=f.length-1;x>=0&&f[x].length===0;)--x;for(var b=10,v=0,_=0;_<=x;++_)v=f[_].indexOf(" "),v==-1?v=f[_].length:v++,b=Math.max(b,v);for(_=0;_<=x;++_){h[_]=[];var N=0;for(t(f[_].slice(0,b).trim(),h,_,N,p),N=1;N<=(f[_].length-b)/10+1;++N)t(f[_].slice(b+(N-1)*10,b+N*10).trim(),h,_,N,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var e={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(d){for(var g={},p=!1,h=0,f=0;h<d.length;++h)(f=d.charCodeAt(h))==34?p=!p:!p&&f in e&&(g[f]=(g[f]||0)+1);f=[];for(h in g)Object.prototype.hasOwnProperty.call(g,h)&&f.push([g[h],h]);if(!f.length){g=a;for(h in g)Object.prototype.hasOwnProperty.call(g,h)&&f.push([g[h],h])}return f.sort(function(x,b){return x[0]-b[0]||a[x[1]]-a[b[1]]}),e[f.pop()[1]]||44}function i(d,g){var p=g||{},h="",f=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=n(d.slice(0,1024)):p&&p.FS?h=p.FS:h=n(d.slice(0,1024));var b=0,v=0,_=0,N=0,E=0,O=h.charCodeAt(0),F=!1,z=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var U=p.dateNF!=null?oR(p.dateNF):null;function W(){var Y=d.slice(N,E),q={};if(Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'&&(Y=Y.slice(1,-1).replace(/""/g,'"')),Y.length===0)q.t="z";else if(p.raw)q.t="s",q.v=Y;else if(Y.trim().length===0)q.t="s",q.v=Y;else if(Y.charCodeAt(0)==61)Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(q.t="s",q.v=Y.slice(2,-1).replace(/""/g,'"')):LL(Y)?(q.t="n",q.f=Y.slice(1)):(q.t="s",q.v=Y);else if(Y=="TRUE")q.t="b",q.v=!0;else if(Y=="FALSE")q.t="b",q.v=!1;else if(!isNaN(_=mn(Y)))q.t="n",p.cellText!==!1&&(q.w=Y),q.v=_;else if(!isNaN(Jl(Y).getDate())||U&&Y.match(U)){q.z=p.dateNF||Kt[14];var M=0;U&&Y.match(U)&&(Y=lR(Y,p.dateNF,Y.match(U)||[]),M=1),p.cellDates?(q.t="d",q.v=bs(Y,M)):(q.t="n",q.v=ta(bs(Y,M))),p.cellText!==!1&&(q.w=Ja(q.z,q.v instanceof Date?ta(q.v):q.v)),p.cellNF||delete q.z}else q.t="s",q.v=Y;if(q.t=="z"||(p.dense?(f[b]||(f[b]=[]),f[b][v]=q):f[Xt({c:v,r:b})]=q),N=E+1,P=d.charCodeAt(N),x.e.c<v&&(x.e.c=v),x.e.r<b&&(x.e.r=b),z==O)++v;else if(v=0,++b,p.sheetRows&&p.sheetRows<=b)return!0}e:for(;E<d.length;++E)switch(z=d.charCodeAt(E)){case 34:P===34&&(F=!F);break;case O:case 10:case 13:if(!F&&W())break e;break}return E-N>0&&W(),f["!ref"]=hr(x),f}function c(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,g):mc(s(d,g),g)}function l(d,g){var p="",h=g.type=="string"?[0,0,0,0]:Fx(d,g);switch(g.type){case"base64":p=Ta(d);break;case"binary":p=d;break;case"buffer":g.codepage==65001?p=d.toString("utf8"):(g.codepage,p=cr&&Buffer.isBuffer(d)?d.toString("binary"):rl(d));break;case"array":p=Go(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+g.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=Or(p.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?p=Or(p):g.type=="binary",p.slice(0,19)=="socialcalc:version:"?KF.to_sheet(g.type=="string"?p:Or(p),g):c(p,g)}function u(d,g){return io(l(d,g),g)}function o(d){for(var g=[],p=Gr(d["!ref"]),h,f=Array.isArray(d),x=p.s.r;x<=p.e.r;++x){for(var b=[],v=p.s.c;v<=p.e.c;++v){var _=Xt({r:x,c:v});if(h=f?(d[x]||[])[v]:d[_],!h||h.v==null){b.push("          ");continue}for(var N=(h.w||(xi(h),h.w)||"").slice(0,10);N.length<10;)N+=" ";b.push(N+(v===0?" ":""))}g.push(b.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:o}}();function ZF(t,s){var e=s||{},a=!!e.WTF;e.WTF=!0;try{var n=WF.to_workbook(t,e);return e.WTF=a,n}catch(i){if(e.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Uu.to_workbook(t,s)}}var Tu=function(){function t(I,Z,K){if(I){ks(I,I.l||0);for(var re=K.Enum||A;I.l<I.length;){var G=I.read_shift(2),ae=re[G]||re[65535],V=I.read_shift(2),H=I.l+V,Q=ae.f&&ae.f(I,V,K);if(I.l=H,Z(Q,ae,G))return}}}function s(I,Z){switch(Z.type){case"base64":return e(dn(Ta(I)),Z);case"binary":return e(dn(I),Z);case"buffer":case"array":return e(I,Z)}throw"Unsupported type "+Z.type}function e(I,Z){if(!I)return I;var K=Z||{},re=K.dense?[]:{},G="Sheet1",ae="",V=0,H={},Q=[],oe=[],se={s:{r:0,c:0},e:{r:0,c:0}},le=K.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)K.Enum=A,t(I,function(ue,Se,ke){switch(ke){case 0:K.vers=ue,ue>=4096&&(K.qpro=!0);break;case 6:se=ue;break;case 204:ue&&(ae=ue);break;case 222:ae=ue;break;case 15:case 51:K.qpro||(ue[1].v=ue[1].v.slice(1));case 13:case 14:case 16:ke==14&&(ue[2]&112)==112&&(ue[2]&15)>1&&(ue[2]&15)<15&&(ue[1].z=K.dateNF||Kt[14],K.cellDates&&(ue[1].t="d",ue[1].v=X0(ue[1].v))),K.qpro&&ue[3]>V&&(re["!ref"]=hr(se),H[G]=re,Q.push(G),re=K.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},V=ue[3],G=ae||"Sheet"+(V+1),ae="");var Me=K.dense?(re[ue[0].r]||[])[ue[0].c]:re[Xt(ue[0])];if(Me){Me.t=ue[1].t,Me.v=ue[1].v,ue[1].z!=null&&(Me.z=ue[1].z),ue[1].f!=null&&(Me.f=ue[1].f);break}K.dense?(re[ue[0].r]||(re[ue[0].r]=[]),re[ue[0].r][ue[0].c]=ue[1]):re[Xt(ue[0])]=ue[1];break}},K);else if(I[2]==26||I[2]==14)K.Enum=L,I[2]==14&&(K.qpro=!0,I.l=0),t(I,function(ue,Se,ke){switch(ke){case 204:G=ue;break;case 22:ue[1].v=ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ue[3]>V&&(re["!ref"]=hr(se),H[G]=re,Q.push(G),re=K.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},V=ue[3],G="Sheet"+(V+1)),le>0&&ue[0].r>=le)break;K.dense?(re[ue[0].r]||(re[ue[0].r]=[]),re[ue[0].r][ue[0].c]=ue[1]):re[Xt(ue[0])]=ue[1],se.e.c<ue[0].c&&(se.e.c=ue[0].c),se.e.r<ue[0].r&&(se.e.r=ue[0].r);break;case 27:ue[14e3]&&(oe[ue[14e3][0]]=ue[14e3][1]);break;case 1537:oe[ue[0]]=ue[1],ue[0]==V&&(G=ue[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(re["!ref"]=hr(se),H[ae||G]=re,Q.push(ae||G),!oe.length)return{SheetNames:Q,Sheets:H};for(var he={},Ne=[],we=0;we<oe.length;++we)H[Q[we]]?(Ne.push(oe[we]||Q[we]),he[oe[we]]=H[oe[we]]||H[Q[we]]):(Ne.push(oe[we]),he[oe[we]]={"!ref":"A1"});return{SheetNames:Ne,Sheets:he}}function a(I,Z){var K=Z||{};if(+K.codepage>=0&&fn(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var re=sg(),G=Gr(I["!ref"]),ae=Array.isArray(I),V=[];un(re,0,i(1030)),un(re,6,u(G));for(var H=Math.min(G.e.r,8191),Q=G.s.r;Q<=H;++Q)for(var oe=Ts(Q),se=G.s.c;se<=G.e.c;++se){Q===G.s.r&&(V[se]=fs(se));var le=V[se]+oe,he=ae?(I[Q]||[])[se]:I[le];if(!(!he||he.t=="z"))if(he.t=="n")(he.v|0)==he.v&&he.v>=-32768&&he.v<=32767?un(re,13,h(Q,se,he.v)):un(re,14,x(Q,se,he.v));else{var Ne=xi(he);un(re,15,g(Q,se,Ne.slice(0,239)))}}return un(re,1),re.end()}function n(I,Z){var K=Z||{};if(+K.codepage>=0&&fn(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var re=sg();un(re,0,c(I));for(var G=0,ae=0;G<I.SheetNames.length;++G)(I.Sheets[I.SheetNames[G]]||{})["!ref"]&&un(re,27,j(I.SheetNames[G],ae++));var V=0;for(G=0;G<I.SheetNames.length;++G){var H=I.Sheets[I.SheetNames[G]];if(!(!H||!H["!ref"])){for(var Q=Gr(H["!ref"]),oe=Array.isArray(H),se=[],le=Math.min(Q.e.r,8191),he=Q.s.r;he<=le;++he)for(var Ne=Ts(he),we=Q.s.c;we<=Q.e.c;++we){he===Q.s.r&&(se[we]=fs(we));var ue=se[we]+Ne,Se=oe?(H[he]||[])[we]:H[ue];if(!(!Se||Se.t=="z"))if(Se.t=="n")un(re,23,W(he,we,V,Se.v));else{var ke=xi(Se);un(re,22,z(he,we,V,ke.slice(0,239)))}}++V}}return un(re,1),re.end()}function i(I){var Z=ds(2);return Z.write_shift(2,I),Z}function c(I){var Z=ds(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var K=0,re=0,G=0,ae=0;ae<I.SheetNames.length;++ae){var V=I.SheetNames[ae],H=I.Sheets[V];if(!(!H||!H["!ref"])){++G;var Q=hc(H["!ref"]);K<Q.e.r&&(K=Q.e.r),re<Q.e.c&&(re=Q.e.c)}}return K>8191&&(K=8191),Z.write_shift(2,K),Z.write_shift(1,G),Z.write_shift(1,re),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function l(I,Z,K){var re={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&K.qpro?(re.s.c=I.read_shift(1),I.l++,re.s.r=I.read_shift(2),re.e.c=I.read_shift(1),I.l++,re.e.r=I.read_shift(2),re):(re.s.c=I.read_shift(2),re.s.r=I.read_shift(2),Z==12&&K.qpro&&(I.l+=2),re.e.c=I.read_shift(2),re.e.r=I.read_shift(2),Z==12&&K.qpro&&(I.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function u(I){var Z=ds(8);return Z.write_shift(2,I.s.c),Z.write_shift(2,I.s.r),Z.write_shift(2,I.e.c),Z.write_shift(2,I.e.r),Z}function o(I,Z,K){var re=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(re[0].c=I.read_shift(1),re[3]=I.read_shift(1),re[0].r=I.read_shift(2),I.l+=2):(re[2]=I.read_shift(1),re[0].c=I.read_shift(2),re[0].r=I.read_shift(2)),re}function d(I,Z,K){var re=I.l+Z,G=o(I,Z,K);if(G[1].t="s",K.vers==20768){I.l++;var ae=I.read_shift(1);return G[1].v=I.read_shift(ae,"utf8"),G}return K.qpro&&I.l++,G[1].v=I.read_shift(re-I.l,"cstr"),G}function g(I,Z,K){var re=ds(7+K.length);re.write_shift(1,255),re.write_shift(2,Z),re.write_shift(2,I),re.write_shift(1,39);for(var G=0;G<re.length;++G){var ae=K.charCodeAt(G);re.write_shift(1,ae>=128?95:ae)}return re.write_shift(1,0),re}function p(I,Z,K){var re=o(I,Z,K);return re[1].v=I.read_shift(2,"i"),re}function h(I,Z,K){var re=ds(7);return re.write_shift(1,255),re.write_shift(2,Z),re.write_shift(2,I),re.write_shift(2,K,"i"),re}function f(I,Z,K){var re=o(I,Z,K);return re[1].v=I.read_shift(8,"f"),re}function x(I,Z,K){var re=ds(13);return re.write_shift(1,255),re.write_shift(2,Z),re.write_shift(2,I),re.write_shift(8,K,"f"),re}function b(I,Z,K){var re=I.l+Z,G=o(I,Z,K);if(G[1].v=I.read_shift(8,"f"),K.qpro)I.l=re;else{var ae=I.read_shift(2);E(I.slice(I.l,I.l+ae),G),I.l+=ae}return G}function v(I,Z,K){var re=Z&32768;return Z&=-32769,Z=(re?I:0)+(Z>=8192?Z-16384:Z),(re?"":"$")+(K?fs(Z):Ts(Z))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(I,Z){ks(I,0);for(var K=[],re=0,G="",ae="",V="",H="";I.l<I.length;){var Q=I[I.l++];switch(Q){case 0:K.push(I.read_shift(8,"f"));break;case 1:ae=v(Z[0].c,I.read_shift(2),!0),G=v(Z[0].r,I.read_shift(2),!1),K.push(ae+G);break;case 2:{var oe=v(Z[0].c,I.read_shift(2),!0),se=v(Z[0].r,I.read_shift(2),!1);ae=v(Z[0].c,I.read_shift(2),!0),G=v(Z[0].r,I.read_shift(2),!1),K.push(oe+se+":"+ae+G)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(I.read_shift(2));break;case 6:{for(var le="";Q=I[I.l++];)le+=String.fromCharCode(Q);K.push('"'+le.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:H=K.pop(),V=K.pop(),K.push(["AND","OR"][Q-20]+"("+V+","+H+")");break;default:if(Q<32&&N[Q])H=K.pop(),V=K.pop(),K.push(V+N[Q]+H);else if(_[Q]){if(re=_[Q][1],re==69&&(re=I[I.l++]),re>K.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+K.join("|")+"|");return}var he=K.slice(-re);K.length-=re,K.push(_[Q][0]+"("+he.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}K.length==1?Z[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function O(I){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=I.read_shift(2),Z[3]=I[I.l++],Z[0].c=I[I.l++],Z}function F(I,Z){var K=O(I);return K[1].t="s",K[1].v=I.read_shift(Z-4,"cstr"),K}function z(I,Z,K,re){var G=ds(6+re.length);G.write_shift(2,I),G.write_shift(1,K),G.write_shift(1,Z),G.write_shift(1,39);for(var ae=0;ae<re.length;++ae){var V=re.charCodeAt(ae);G.write_shift(1,V>=128?95:V)}return G.write_shift(1,0),G}function P(I,Z){var K=O(I);K[1].v=I.read_shift(2);var re=K[1].v>>1;if(K[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return K[1].v=re,K}function U(I,Z){var K=O(I),re=I.read_shift(4),G=I.read_shift(4),ae=I.read_shift(2);if(ae==65535)return re===0&&G===3221225472?(K[1].t="e",K[1].v=15):re===0&&G===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var V=ae&32768;return ae=(ae&32767)-16446,K[1].v=(1-V*2)*(G*Math.pow(2,ae+32)+re*Math.pow(2,ae)),K}function W(I,Z,K,re){var G=ds(14);if(G.write_shift(2,I),G.write_shift(1,K),G.write_shift(1,Z),re==0)return G.write_shift(4,0),G.write_shift(4,0),G.write_shift(2,65535),G;var ae=0,V=0,H=0,Q=0;return re<0&&(ae=1,re=-re),V=Math.log2(re)|0,re/=Math.pow(2,V-31),Q=re>>>0,Q&2147483648||(re/=2,++V,Q=re>>>0),re-=Q,Q|=2147483648,Q>>>=0,re*=Math.pow(2,32),H=re>>>0,G.write_shift(4,H),G.write_shift(4,Q),V+=16383+(ae?32768:0),G.write_shift(2,V),G}function Y(I,Z){var K=U(I);return I.l+=Z-14,K}function q(I,Z){var K=O(I),re=I.read_shift(4);return K[1].v=re>>6,K}function M(I,Z){var K=O(I),re=I.read_shift(8,"f");return K[1].v=re,K}function D(I,Z){var K=M(I);return I.l+=Z-10,K}function T(I,Z){return I[I.l+Z-1]==0?I.read_shift(Z,"cstr"):""}function C(I,Z){var K=I[I.l++];K>Z-1&&(K=Z-1);for(var re="";re.length<K;)re+=String.fromCharCode(I[I.l++]);return re}function S(I,Z,K){if(!(!K.qpro||Z<21)){var re=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var G=I.read_shift(Z-21,"cstr");return[re,G]}}function w(I,Z){for(var K={},re=I.l+Z;I.l<re;){var G=I.read_shift(2);if(G==14e3){for(K[G]=[0,""],K[G][0]=I.read_shift(2);I[I.l];)K[G][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return K}function j(I,Z){var K=ds(5+I.length);K.write_shift(2,14e3),K.write_shift(2,Z);for(var re=0;re<I.length;++re){var G=I.charCodeAt(re);K[K.l++]=G>127?95:G}return K[K.l++]=0,K}var A={0:{n:"BOF",f:is},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:T},222:{n:"SHEETNAMELP",f:C},65535:{n:""}},L={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:Y},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:w},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:D},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:T},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:S},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:s}}();function QF(t){var s={},e=t.match(Ys),a=0,n=!1;if(e)for(;a!=e.length;++a){var i=qt(e[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":s.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;s.cp=ux[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":s.outline=1;break;case"</outline>":break;case"<rFont":s.name=i.val;break;case"<sz":s.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":s.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":s.uval="double";break;case"singleAccounting":s.uval="single-accounting";break;case"doubleAccounting":s.uval="double-accounting";break}case"<u>":case"<u/>":s.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":s.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":s.i=1;break;case"</i>":break;case"<color":i.rgb&&(s.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":s.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":s.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return s}var JF=function(){var t=Bu("t"),s=Bu("rPr");function e(i){var c=i.match(t);if(!c)return{t:"s",v:""};var l={t:"s",v:pr(c[1])},u=i.match(s);return u&&(l.s=QF(u[1])),l}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(c){return c.replace(a,"").split(n).map(e).filter(function(l){return l.v})}}(),eI=function(){var s=/(\r\n|\n)/g;function e(n,i,c){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),n.b&&(i.push("<b>"),c.push("</b>")),n.i&&(i.push("<i>"),c.push("</i>")),n.strike&&(i.push("<s>"),c.push("</s>"));var u=n.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),c.push("</"+u+">")),c.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&e(n.s,i[0],i[2]),i[0].join("")+i[1].replace(s,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),tI=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,rI=/<(?:\w+:)?r>/,sI=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Cx(t,s){var e=s?s.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=pr(Or(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Or(t),e&&(a.h=xx(a.t))):t.match(rI)&&(a.r=Or(t),a.t=pr(Or((t.replace(sI,"").match(tI)||[]).join("").replace(Ys,""))),e&&(a.h=eI(JF(a.r)))),a):{t:""}}var aI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nI=/<(?:\w+:)?(?:si|sstItem)>/g,iI=/<\/(?:\w+:)?(?:si|sstItem)>/;function oI(t,s){var e=[],a="";if(!t)return e;var n=t.match(aI);if(n){a=n[2].replace(nI,"").split(iI);for(var i=0;i!=a.length;++i){var c=Cx(a[i].trim(),s);c!=null&&(e[e.length]=c)}n=qt(n[1]),e.Count=n.count,e.Unique=n.uniqueCount}return e}function lI(t){return[t.read_shift(4),t.read_shift(4)]}function cI(t,s){var e=[],a=!1;return yi(t,function(i,c,l){switch(l){case 159:e.Count=i[0],e.Unique=i[1];break;case 19:e.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(c.T,!a||s.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),e}function h4(t){for(var s=[],e=t.split(""),a=0;a<e.length;++a)s[a]=e[a].charCodeAt(0);return s}function hi(t,s){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),s>=4&&(t.l+=s-4),e}function uI(t){var s={};return s.id=t.read_shift(0,"lpp4"),s.R=hi(t,4),s.U=hi(t,4),s.W=hi(t,4),s}function dI(t){for(var s=t.read_shift(4),e=t.l+s-4,a={},n=t.read_shift(4),i=[];n-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=i,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return a}function fI(t){var s=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)s.push(dI(t));return s}function hI(t){var s=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)s.push(t.read_shift(0,"lpp4"));return s}function mI(t){var s={};return t.read_shift(4),t.l+=4,s.id=t.read_shift(0,"lpp4"),s.name=t.read_shift(0,"lpp4"),s.R=hi(t,4),s.U=hi(t,4),s.W=hi(t,4),s}function pI(t){var s=mI(t);if(s.ename=t.read_shift(0,"8lpp4"),s.blksz=t.read_shift(4),s.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return s}function m4(t,s){var e=t.l+s,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,a}function p4(t,s){var e={},a=t.l+s;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,a),t.l=a,e}function gI(t){var s=hi(t);switch(s.Minor){case 2:return[s.Minor,xI(t)];case 3:return[s.Minor,bI()];case 4:return[s.Minor,yI(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+s.Minor)}function xI(t){var s=t.read_shift(4);if((s&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),a=m4(t,e),n=p4(t,t.length-t.l);return{t:"Std",h:a,v:n}}function bI(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yI(t){var s=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),a={};return e.replace(Ys,function(i){var c=qt(i);switch(Hn(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":s.forEach(function(l){a[l]=c[l]});break;case"<dataIntegrity":a.encryptedHmacKey=c.encryptedHmacKey,a.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(c);break;default:throw c[0]}}),a}function vI(t,s){var e={},a=e.EncryptionVersionInfo=hi(t,4);if(s-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);e.Flags=t.read_shift(4),s-=4;var n=t.read_shift(4);return s-=4,e.EncryptionHeader=m4(t,n),s-=n,e.EncryptionVerifier=p4(t,s),e}function _I(t){var s={},e=s.EncryptionVersionInfo=hi(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return s.Salt=t.read_shift(16),s.EncryptedVerifier=t.read_shift(16),s.EncryptedVerifierHash=t.read_shift(16),s}function wI(t){var s=0,e,a=h4(t),n=a.length+1,i,c,l,u,o;for(e=to(n),e[0]=a.length,i=1;i!=n;++i)e[i]=a[i-1];for(i=n-1;i>=0;--i)c=e[i],l=s&16384?1:0,u=s<<1&32767,o=l|u,s=o^c;return s^52811}var g4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],s=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(c){return(c/2|c*128)&255},n=function(c,l){return a(c^l)},i=function(c){for(var l=s[c.length-1],u=104,o=c.length-1;o>=0;--o)for(var d=c[o],g=0;g!=7;++g)d&64&&(l^=e[u]),d*=2,--u;return l};return function(c){for(var l=h4(c),u=i(l),o=l.length,d=to(16),g=0;g!=16;++g)d[g]=0;var p,h,f;for((o&1)===1&&(p=u>>8,d[o]=n(t[0],p),--o,p=u&255,h=l[l.length-1],d[o]=n(h,p));o>0;)--o,p=u>>8,d[o]=n(l[o],p),--o,p=u&255,d[o]=n(l[o],p);for(o=15,f=15-l.length;f>0;)p=u>>8,d[o]=n(t[f],p),--o,--f,p=u&255,d[o]=n(l[o],p),--o,--f;return d}}(),NI=function(t,s,e,a,n){n||(n=s),a||(a=g4(t));var i,c;for(i=0;i!=s.length;++i)c=s[i],c^=a[e],c=(c>>5|c<<3)&255,n[i]=c,++e;return[n,e,a]},jI=function(t){var s=0,e=g4(t);return function(a){var n=NI("",a,s,e);return s=n[1],n[0]}};function SI(t,s,e,a){var n={key:is(t),verificationBytes:is(t)};return e.password&&(n.verifier=wI(e.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=jI(e.password)),n}function kI(t,s,e){var a=e||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=_I(t):a.Data=vI(t,s),a}function CI(t,s,e){var a={Type:e.biff>=8?t.read_shift(2):0};return a.Type?kI(t,s-2,a):SI(t,e.biff>=8?s:s-2,e,a),a}var EI=function(){function t(n,i){switch(i.type){case"base64":return s(Ta(n),i);case"binary":return s(n,i);case"buffer":return s(cr&&Buffer.isBuffer(n)?n.toString("binary"):rl(n),i);case"array":return s(Go(n),i)}throw new Error("Unrecognized type "+i.type)}function s(n,i){var c=i||{},l=c.dense?[]:{},u=n.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var o={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,g){Array.isArray(l)&&(l[g]=[]);for(var p=/\\\w+\b/g,h=0,f,x=-1;f=p.exec(d);){switch(f[0]){case"\\cell":var b=d.slice(h,p.lastIndex-f[0].length);if(b[0]==" "&&(b=b.slice(1)),++x,b.length){var v={v:b,t:"s"};Array.isArray(l)?l[g][x]=v:l[Xt({r:g,c:x})]=v}break}h=p.lastIndex}x>o.e.c&&(o.e.c=x)}),l["!ref"]=hr(o),l}function e(n,i){return io(t(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],c=Gr(n["!ref"]),l,u=Array.isArray(n),o=c.s.r;o<=c.e.r;++o){i.push("\\trowd\\trautofit1");for(var d=c.s.c;d<=c.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=c.s.c;d<=c.e.c;++d){var g=Xt({r:o,c:d});l=u?(n[o]||[])[d]:n[g],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(xi(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:a}}();function TI(t){var s=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)]}function $u(t){for(var s=0,e=1;s!=3;++s)e=e*256+(t[s]>255?255:t[s]<0?0:t[s]);return e.toString(16).toUpperCase().slice(1)}function AI(t){var s=t[0]/255,e=t[1]/255,a=t[2]/255,n=Math.max(s,e,a),i=Math.min(s,e,a),c=n-i;if(c===0)return[0,0,s];var l=0,u=0,o=n+i;switch(u=c/(o>1?2-o:o),n){case s:l=((e-a)/c+6)%6;break;case e:l=(a-s)/c+2;break;case a:l=(s-e)/c+4;break}return[l/6,u,o/2]}function OI(t){var s=t[0],e=t[1],a=t[2],n=e*2*(a<.5?a:1-a),i=a-n/2,c=[i,i,i],l=6*s,u;if(e!==0)switch(l|0){case 0:case 6:u=n*l,c[0]+=n,c[1]+=u;break;case 1:u=n*(2-l),c[0]+=u,c[1]+=n;break;case 2:u=n*(l-2),c[1]+=n,c[2]+=u;break;case 3:u=n*(4-l),c[1]+=u,c[2]+=n;break;case 4:u=n*(l-4),c[2]+=n,c[0]+=u;break;case 5:u=n*(6-l),c[2]+=u,c[0]+=n;break}for(var o=0;o!=3;++o)c[o]=Math.round(c[o]*255);return c}function v0(t,s){if(s===0)return t;var e=AI(TI(t));return s<0?e[2]=e[2]*(1+s):e[2]=1-(1-e[2])*(1-s),$u(OI(e))}var x4=6,RI=15,MI=1,Zs=x4;function _0(t){return Math.floor((t+Math.round(128/Zs)/256)*Zs)}function w0(t){return Math.floor((t-5)/Zs*100+.5)/100}function og(t){return Math.round((t*Zs+5)/Zs*256)/256}function kp(t){return og(w0(_0(t)))}function Ex(t){var s=Math.abs(t-kp(t)),e=Zs;if(s>.005)for(Zs=MI;Zs<RI;++Zs)Math.abs(t-kp(t))<=s&&(s=Math.abs(t-kp(t)),e=Zs);Zs=e}function ec(t){t.width?(t.wpx=_0(t.width),t.wch=w0(t.wpx),t.MDW=Zs):t.wpx?(t.wch=w0(t.wpx),t.width=og(t.wch),t.MDW=Zs):typeof t.wch=="number"&&(t.width=og(t.wch),t.wpx=_0(t.width),t.MDW=Zs),t.customWidth&&delete t.customWidth}var FI=96,b4=FI;function y4(t){return t*96/b4}function zu(t){return t*b4/96}var II={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function LI(t,s,e,a){s.Borders=[];var n={},i=!1;(t[0].match(Ys)||[]).forEach(function(c){var l=qt(c);switch(Hn(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=Fr(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=Fr(l.diagonalDown)),s.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function PI(t,s,e,a){s.Fills=[];var n={},i=!1;(t[0].match(Ys)||[]).forEach(function(c){var l=qt(c);switch(Hn(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},s.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":s.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function BI(t,s,e,a){s.Fonts=[];var n={},i=!1;(t[0].match(Ys)||[]).forEach(function(c){var l=qt(c);switch(Hn(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":s.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=Or(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?Fr(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?Fr(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?Fr(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?Fr(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?Fr(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?Fr(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?Fr(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=ux[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=Fr(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var u=Do[n.color.index];n.color.index==81&&(u=Do[1]),u||(u=Do[1]),n.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&e.themeElements&&e.themeElements.clrScheme&&(n.color.rgb=v0(e.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function DI(t,s,e){s.NumberFmt=[];for(var a=zn(Kt),n=0;n<a.length;++n)s.NumberFmt[a[n]]=Kt[a[n]];var i=t[0].match(Ys);if(i)for(n=0;n<i.length;++n){var c=qt(i[n]);switch(Hn(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=pr(Or(c.formatCode)),u=parseInt(c.numFmtId,10);if(s.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&s.NumberFmt[u]!=null;--u);s.NumberFmt[u]=l}Bo(l,u)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var Tf=["numFmtId","fillId","fontId","borderId","xfId"],Af=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function UI(t,s,e){s.CellXf=[];var a,n=!1;(t[0].match(Ys)||[]).forEach(function(i){var c=qt(i),l=0;switch(Hn(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=c,delete a[0],l=0;l<Tf.length;++l)a[Tf[l]]&&(a[Tf[l]]=parseInt(a[Tf[l]],10));for(l=0;l<Af.length;++l)a[Af[l]]&&(a[Af[l]]=Fr(a[Af[l]]));if(s.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(s.NumberFmt[a.numFmtId]==s.NumberFmt[l]){a.numFmtId=l;break}}s.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};c.vertical&&(u.vertical=c.vertical),c.horizontal&&(u.horizontal=c.horizontal),c.textRotation!=null&&(u.textRotation=c.textRotation),c.indent&&(u.indent=c.indent),c.wrapText&&(u.wrapText=Fr(c.wrapText)),a.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(e&&e.WTF&&!n)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var $I=function(){var s=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,o){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=l.match(s))&&DI(g,d,o),(g=l.match(n))&&BI(g,d,u,o),(g=l.match(a))&&PI(g,d,u,o),(g=l.match(i))&&LI(g,d,u,o),(g=l.match(e))&&UI(g,d,o),d}}();function zI(t,s){var e=t.read_shift(2),a=zs(t);return[e,a]}function HI(t,s,e){var a={};a.sz=t.read_shift(2)/20;var n=JR(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=t.read_shift(2);switch(i===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(a.underline=c);var l=t.read_shift(1);l>0&&(a.family=l);var u=t.read_shift(1);switch(u>0&&(a.charset=u),t.l++,a.color=QR(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=zs(t),a}var VI=Vs;function qI(t,s){var e=t.l+s,a=t.read_shift(2),n=t.read_shift(2);return t.l=e,{ixfe:a,numFmtId:n}}var GI=Vs;function YI(t,s,e){var a={};a.NumberFmt=[];for(var n in Kt)a.NumberFmt[n]=Kt[n];a.CellXf=[],a.Fonts=[];var i=[],c=!1;return yi(t,function(u,o,d){switch(d){case 44:a.NumberFmt[u[0]]=u[1],Bo(u[1],u[0]);break;case 43:a.Fonts.push(u),u.color.theme!=null&&s&&s.themeElements&&s.themeElements.clrScheme&&(u.color.rgb=v0(s.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:i.push(d),c=!0;break;case 38:i.pop(),c=!1;break;default:if(o.T>0)i.push(d);else if(o.T<0)i.pop();else if(!c||e.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}var WI=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function XI(t,s,e){s.themeElements.clrScheme=[];var a={};(t[0].match(Ys)||[]).forEach(function(n){var i=qt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(s.themeElements.clrScheme[WI.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function KI(){}function ZI(){}var QI=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JI=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eL=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tL(t,s,e){s.themeElements={};var a;[["clrScheme",QI,XI],["fontScheme",JI,KI],["fmtScheme",eL,ZI]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,s,e)})}var rL=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function v4(t,s){(!t||t.length===0)&&(t=sL());var e,a={};if(!(e=t.match(rL)))throw new Error("themeElements not found in theme");return tL(e[0],a,s),a.raw=t,a}function sL(t,s){var e=[O5];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function aL(t,s,e){var a=t.l+s,n=t.read_shift(4);if(n!==124226){if(!e.cellStyles){t.l=a;return}var i=t.slice(t.l);t.l=a;var c;try{c=A5(i,{type:"array"})}catch{return}var l=ja(c,"theme/theme/theme1.xml",!0);if(l)return v4(l,e)}}function nL(t){return t.read_shift(4)}function iL(t){var s={};switch(s.xclrType=t.read_shift(2),s.nTintShade=t.read_shift(2),s.xclrType){case 0:t.l+=4;break;case 1:s.xclrValue=oL(t,4);break;case 2:s.xclrValue=i4(t);break;case 3:s.xclrValue=nL(t);break;case 4:t.l+=4;break}return t.l+=8,s}function oL(t,s){return Vs(t,s)}function lL(t,s){return Vs(t,s)}function cL(t){var s=t.read_shift(2),e=t.read_shift(2)-4,a=[s];switch(s){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=iL(t);break;case 6:a[1]=lL(t,e);break;case 14:case 15:a[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+s+" "+e)}return a}function uL(t,s){var e=t.l+s;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),i=[];n-- >0;)i.push(cL(t,e-t.l));return{ixfe:a,ext:i}}function dL(t,s){s.forEach(function(e){switch(e[0]){}})}function fL(t,s){return{flags:t.read_shift(4),version:t.read_shift(4),name:zs(t)}}function hL(t){for(var s=[],e=t.read_shift(4);e-- >0;)s.push([t.read_shift(4),t.read_shift(4)]);return s}function mL(t){return t.l+=4,t.read_shift(4)!=0}function pL(t,s,e){var a={Types:[],Cell:[],Value:[]},n=e||{},i=[],c=!1,l=2;return yi(t,function(u,o,d){switch(d){case 335:a.Types.push({name:u.name});break;case 51:u.forEach(function(g){l==1?a.Cell.push({type:a.Types[g[0]-1].name,index:g[1]}):l==0&&a.Value.push({type:a.Types[g[0]-1].name,index:g[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:i.push(d),c=!0;break;case 36:i.pop(),c=!1;break;default:if(!o.T){if(!c||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function gL(t,s,e){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,i=2,c;return t.replace(Ys,function(l){var u=qt(l);switch(Hn(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var o=0;o<a.Types.length;++o)a.Types[o].name==u.name&&(c=a.Types[o]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[u.t-1].name,index:+u.v}):i==0&&a.Value.push({type:a.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+u.i);break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),a}function xL(t){var s=[];if(!t)return s;var e=1;return(t.match(Ys)||[]).forEach(function(a){var n=qt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?e=n.i:n.i=e,s.push(n);break}}),s}function bL(t){var s={};s.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),s.r=Xt(e);var a=t.read_shift(1);return a&2&&(s.l="1"),a&8&&(s.a="1"),s}function yL(t,s,e){var a=[];return yi(t,function(i,c,l){switch(l){case 63:a.push(i);break;default:if(!c.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function vL(t,s,e,a){if(!t)return t;var n=a||{},i=!1;yi(t,function(l,u,o){switch(o){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}},n)}function _L(t,s){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return s["!id"][e].Target}function f_(t,s,e,a){var n=Array.isArray(t),i;s.forEach(function(c){var l=Qs(c.ref);if(n?(t[l.r]||(t[l.r]=[]),i=t[l.r][l.c]):i=t[c.ref],!i){i={t:"z"},n?t[l.r][l.c]=i:t[c.ref]=i;var u=Gr(t["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var o=hr(u);o!==t["!ref"]&&(t["!ref"]=o)}i.c||(i.c=[]);var d={a:c.author,t:c.t,r:c.r,T:e};c.h&&(d.h=c.h);for(var g=i.c.length-1;g>=0;--g){if(!e&&i.c[g].T)return;e&&!i.c[g].T&&i.c.splice(g,1)}if(e&&a){for(g=0;g<a.length;++g)if(d.a==a[g].id){d.a=a[g].name||d.a;break}}i.c.push(d)})}function wL(t,s){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var l=c.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&e.push(l[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var l=c.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=qt(l[0]),o={author:u.authorId&&e[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Qs(u.ref);if(!(s.sheetRows&&s.sheetRows<=d.r)){var g=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!g&&!!g[1]&&Cx(g[1])||{r:"",t:"",h:""};o.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),o.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),s.cellHTML&&(o.h=p.h),a.push(o)}}}}),a}function NL(t,s){var e=[],a=!1,n={},i=0;return t.replace(Ys,function(l,u){var o=qt(l);switch(Hn(o[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:o.personId,guid:o.id,ref:o.ref,T:1};break;case"</threadedComment>":n.t!=null&&e.push(n);break;case"<text>":case"<text":i=u+l.length;break;case"</text>":n.t=t.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),e}function jL(t,s){var e=[],a=!1;return t.replace(Ys,function(i){var c=qt(i);switch(Hn(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return i}),e}function SL(t){var s={};s.iauthor=t.read_shift(4);var e=al(t);return s.rfx=e.s,s.ref=Xt(e.s),t.l+=16,s}var kL=zs;function CL(t,s){var e=[],a=[],n={},i=!1;return yi(t,function(l,u,o){switch(o){case 632:a.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,s.sheetRows&&n.rfx&&s.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,e.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}}),e}var EL="application/vnd.ms-office.vbaProject";function TL(t){var s=fr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,a){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var n=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");fr.utils.cfb_add(s,n,t.FileIndex[a].content)}}),fr.write(s)}function AL(){return{"!type":"dialog"}}function OL(){return{"!type":"dialog"}}function RL(){return{"!type":"macro"}}function ML(){return{"!type":"macro"}}var zl=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,s={r:0,c:0};function e(a,n,i,c){var l=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),c.length==0?l=!0:c.charAt(0)=="["&&(l=!0,c=c.slice(1,-1));var o=i.length>0?parseInt(i,10)|0:0,d=c.length>0?parseInt(c,10)|0:0;return l?d+=s.c:--d,u?o+=s.r:--o,n+(l?"":"$")+fs(d)+(u?"":"$")+Ts(o)}return function(n,i){return s=i,n.replace(t,e)}}(),_4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,FL=function(){return function(s,e){return s.replace(_4,function(a,n,i,c,l,u){var o=_x(c)-(i?0:e.c),d=vx(u)-(l?0:e.r),g=d==0?"":l?d+1:"["+d+"]",p=o==0?"":i?o+1:"["+o+"]";return n+"R"+g+"C"+p})}}();function w4(t,s){return t.replace(_4,function(e,a,n,i,c,l){return a+(n=="$"?n+i:fs(_x(i)+s.c))+(c=="$"?c+l:Ts(vx(l)+s.r))})}function IL(t,s,e){var a=hc(s),n=a.s,i=Qs(e),c={r:i.r-n.r,c:i.c-n.c};return w4(t,c)}function LL(t){return t.length!=1}function h_(t){return t.replace(/_xlfn\./g,"")}function as(t){t.l+=1}function ro(t,s){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function N4(t,s,e){var a=2;if(e){if(e.biff>=2&&e.biff<=5)return j4(t);e.biff==12&&(a=4)}var n=t.read_shift(a),i=t.read_shift(a),c=ro(t),l=ro(t);return{s:{r:n,c:c[0],cRel:c[1],rRel:c[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function j4(t){var s=ro(t),e=ro(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:s[0],c:a,cRel:s[1],rRel:s[2]},e:{r:e[0],c:n,cRel:e[1],rRel:e[2]}}}function PL(t,s,e){if(e.biff<8)return j4(t);var a=t.read_shift(e.biff==12?4:2),n=t.read_shift(e.biff==12?4:2),i=ro(t),c=ro(t);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:c[0],cRel:c[1],rRel:c[2]}}}function S4(t,s,e){if(e&&e.biff>=2&&e.biff<=5)return BL(t);var a=t.read_shift(e&&e.biff==12?4:2),n=ro(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function BL(t){var s=ro(t),e=t.read_shift(1);return{r:s[0],c:e,cRel:s[1],rRel:s[2]}}function DL(t){var s=t.read_shift(2),e=t.read_shift(2);return{r:s,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function UL(t,s,e){var a=e&&e.biff?e.biff:8;if(a>=2&&a<=5)return $L(t);var n=t.read_shift(a>=12?4:2),i=t.read_shift(2),c=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(c==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:c,rRel:l}}function $L(t){var s=t.read_shift(2),e=t.read_shift(1),a=(s&32768)>>15,n=(s&16384)>>14;return s&=16383,a==1&&s>=8192&&(s=s-16384),n==1&&e>=128&&(e=e-256),{r:s,c:e,cRel:n,rRel:a}}function zL(t,s,e){var a=(t[t.l++]&96)>>5,n=N4(t,e.biff>=2&&e.biff<=5?6:8,e);return[a,n]}function HL(t,s,e){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),i=8;if(e)switch(e.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var c=N4(t,i,e);return[a,n,c]}function VL(t,s,e){var a=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[a]}function qL(t,s,e){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),i=8;if(e)switch(e.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[a,n]}function GL(t,s,e){var a=(t[t.l++]&96)>>5,n=PL(t,s-1,e);return[a,n]}function YL(t,s,e){var a=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[a]}function m_(t){var s=t[t.l+1]&1,e=1;return t.l+=4,[s,e]}function WL(t,s,e){t.l+=2;for(var a=t.read_shift(e&&e.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(t.read_shift(e&&e.biff==2?1:2));return n}function XL(t,s,e){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(e&&e.biff==2?1:2)]}function KL(t,s,e){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(e&&e.biff==2?1:2)]}function ZL(t){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(2)]}function QL(t,s,e){var a=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[a]}function k4(t){var s=t.read_shift(1),e=t.read_shift(1);return[s,e]}function JL(t){return t.read_shift(2),k4(t)}function eP(t){return t.read_shift(2),k4(t)}function tP(t,s,e){var a=(t[t.l]&96)>>5;t.l+=1;var n=S4(t,0,e);return[a,n]}function rP(t,s,e){var a=(t[t.l]&96)>>5;t.l+=1;var n=UL(t,0,e);return[a,n]}function sP(t,s,e){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var i=S4(t,0,e);return[a,n,i]}function aP(t,s,e){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(e&&e.biff<=3?1:2);return[nB[n],T4[n],a]}function nP(t,s,e){var a=t[t.l++],n=t.read_shift(1),i=e&&e.biff<=3?[a==88?-1:0,t.read_shift(1)]:iP(t);return[n,(i[0]===0?T4:aB)[i[1]]]}function iP(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function oP(t,s,e){t.l+=e&&e.biff==2?3:4}function lP(t,s,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(e&&e.biff==2?1:2);return[a,n]}function cP(t){return t.l++,nl[t.read_shift(1)]}function uP(t){return t.l++,t.read_shift(2)}function dP(t){return t.l++,t.read_shift(1)!==0}function fP(t){return t.l++,Ds(t)}function hP(t,s,e){return t.l++,od(t,s-1,e)}function mP(t,s){var e=[t.read_shift(1)];if(s==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Xr(t,1)?"TRUE":"FALSE",s!=12&&(t.l+=7);break;case 37:case 16:e[1]=nl[t[t.l]],t.l+=s==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=Ds(t);break;case 2:e[1]=il(t,0,{biff:s>0&&s<8?2:s});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function pP(t,s,e){for(var a=t.read_shift(e.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((e.biff==12?al:K0)(t));return n}function gP(t,s,e){var a=0,n=0;e.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--a,--n==0&&(n=256));for(var i=0,c=[];i!=a&&(c[i]=[]);++i)for(var l=0;l!=n;++l)c[i][l]=mP(t,e.biff);return c}function xP(t,s,e){var a=t.read_shift(1)>>>5&3,n=!e||e.biff>=8?4:2,i=t.read_shift(n);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,i]}function bP(t,s,e){if(e.biff==5)return yP(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),i=t.read_shift(4);return[a,n,i]}function yP(t){var s=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[s,e,a]}function vP(t,s,e){var a=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var n=t.read_shift(e&&e.biff==2?1:2);return[a,n]}function _P(t,s,e){var a=t.read_shift(1)>>>5&3,n=t.read_shift(e&&e.biff==2?1:2);return[a,n]}function wP(t,s,e){var a=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[a]}function NP(t,s,e){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),i=4;if(e)switch(e.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[a,n]}var jP=Vs,SP=Vs,kP=Vs;function cd(t,s,e){return t.l+=2,[DL(t)]}function Tx(t){return t.l+=6,[]}var CP=cd,EP=Tx,TP=Tx,AP=cd;function C4(t){return t.l+=2,[is(t),t.read_shift(2)&1]}var OP=cd,RP=C4,MP=Tx,FP=cd,IP=cd,LP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function PP(t){t.l+=2;var s=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),i=t.read_shift(2),c=LP[e>>2&31];return{ixti:s,coltype:e&3,rt:c,idx:a,c:n,C:i}}function BP(t){return t.l+=2,[t.read_shift(4)]}function DP(t,s,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function UP(t,s,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function $P(t){var s=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[s,e]}function zP(t){var s=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[s,e]}function HP(t){return t.l+=4,[0,0]}var p_={1:{n:"PtgExp",f:lP},2:{n:"PtgTbl",f:kP},3:{n:"PtgAdd",f:as},4:{n:"PtgSub",f:as},5:{n:"PtgMul",f:as},6:{n:"PtgDiv",f:as},7:{n:"PtgPower",f:as},8:{n:"PtgConcat",f:as},9:{n:"PtgLt",f:as},10:{n:"PtgLe",f:as},11:{n:"PtgEq",f:as},12:{n:"PtgGe",f:as},13:{n:"PtgGt",f:as},14:{n:"PtgNe",f:as},15:{n:"PtgIsect",f:as},16:{n:"PtgUnion",f:as},17:{n:"PtgRange",f:as},18:{n:"PtgUplus",f:as},19:{n:"PtgUminus",f:as},20:{n:"PtgPercent",f:as},21:{n:"PtgParen",f:as},22:{n:"PtgMissArg",f:as},23:{n:"PtgStr",f:hP},26:{n:"PtgSheet",f:DP},27:{n:"PtgEndSheet",f:UP},28:{n:"PtgErr",f:cP},29:{n:"PtgBool",f:dP},30:{n:"PtgInt",f:uP},31:{n:"PtgNum",f:fP},32:{n:"PtgArray",f:YL},33:{n:"PtgFunc",f:aP},34:{n:"PtgFuncVar",f:nP},35:{n:"PtgName",f:xP},36:{n:"PtgRef",f:tP},37:{n:"PtgArea",f:zL},38:{n:"PtgMemArea",f:vP},39:{n:"PtgMemErr",f:jP},40:{n:"PtgMemNoMem",f:SP},41:{n:"PtgMemFunc",f:_P},42:{n:"PtgRefErr",f:wP},43:{n:"PtgAreaErr",f:VL},44:{n:"PtgRefN",f:rP},45:{n:"PtgAreaN",f:GL},46:{n:"PtgMemAreaN",f:$P},47:{n:"PtgMemNoMemN",f:zP},57:{n:"PtgNameX",f:bP},58:{n:"PtgRef3d",f:sP},59:{n:"PtgArea3d",f:HL},60:{n:"PtgRefErr3d",f:NP},61:{n:"PtgAreaErr3d",f:qL},255:{}},VP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},qP={1:{n:"PtgElfLel",f:C4},2:{n:"PtgElfRw",f:FP},3:{n:"PtgElfCol",f:CP},6:{n:"PtgElfRwV",f:IP},7:{n:"PtgElfColV",f:AP},10:{n:"PtgElfRadical",f:OP},11:{n:"PtgElfRadicalS",f:MP},13:{n:"PtgElfColS",f:EP},15:{n:"PtgElfColSV",f:TP},16:{n:"PtgElfRadicalLel",f:RP},25:{n:"PtgList",f:PP},29:{n:"PtgSxName",f:BP},255:{}},GP={0:{n:"PtgAttrNoop",f:HP},1:{n:"PtgAttrSemi",f:QL},2:{n:"PtgAttrIf",f:KL},4:{n:"PtgAttrChoose",f:WL},8:{n:"PtgAttrGoto",f:XL},16:{n:"PtgAttrSum",f:oP},32:{n:"PtgAttrBaxcel",f:m_},33:{n:"PtgAttrBaxcel",f:m_},64:{n:"PtgAttrSpace",f:JL},65:{n:"PtgAttrSpaceSemi",f:eP},128:{n:"PtgAttrIfError",f:ZL},255:{}};function ud(t,s,e,a){if(a.biff<8)return Vs(t,s);for(var n=t.l+s,i=[],c=0;c!==e.length;++c)switch(e[c][0]){case"PtgArray":e[c][1]=gP(t,0,a),i.push(e[c][1]);break;case"PtgMemArea":e[c][2]=pP(t,e[c][1],a),i.push(e[c][2]);break;case"PtgExp":a&&a.biff==12&&(e[c][1][1]=t.read_shift(4),i.push(e[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[c][0]}return s=n-t.l,s!==0&&i.push(Vs(t,s)),i}function dd(t,s,e){for(var a=t.l+s,n,i,c=[];a!=t.l;)s=a-t.l,i=t[t.l],n=p_[i]||p_[VP[i]],(i===24||i===25)&&(n=(i===24?qP:GP)[t[t.l+1]]),!n||!n.f?Vs(t,s):c.push([n.n,n.f(t,s,e)]);return c}function YP(t){for(var s=[],e=0;e<t.length;++e){for(var a=t[e],n=[],i=0;i<a.length;++i){var c=a[i];if(c)switch(c[0]){case 2:n.push('"'+c[1].replace(/"/g,'""')+'"');break;default:n.push(c[1])}else n.push("")}s.push(n.join(","))}return s.join(";")}var WP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XP(t,s){if(!t&&!(s&&s.biff<=5&&s.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function E4(t,s,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[s]))return t.SheetNames[s];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[s];if(e.biff<8)return s>1e4&&(s-=65536),s<0&&(s=-s),s==0?"":t.XTI[s-1];if(!a)return"SH33TJSERR1";var n="";if(e.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function g_(t,s,e){var a=E4(t,s,e);return a=="#REF"?a:XP(a,e)}function Ps(t,s,e,a,n){var i=n&&n.biff||8,c={s:{c:0,r:0}},l=[],u,o,d,g=0,p=0,h,f="";if(!t[0]||!t[0][0])return"";for(var x=-1,b="",v=0,_=t[0].length;v<_;++v){var N=t[0][v];switch(N[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),o=l.pop(),x>=0){switch(t[0][x][1][0]){case 0:b=Hr(" ",t[0][x][1][1]);break;case 1:b=Hr("\r",t[0][x][1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}o=o+b,x=-1}l.push(o+WP[N[0]]+u);break;case"PtgIsect":u=l.pop(),o=l.pop(),l.push(o+" "+u);break;case"PtgUnion":u=l.pop(),o=l.pop(),l.push(o+","+u);break;case"PtgRange":u=l.pop(),o=l.pop(),l.push(o+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Su(N[1][1],c,n),l.push(ku(d,i));break;case"PtgRefN":d=e?Su(N[1][1],e,n):N[1][1],l.push(ku(d,i));break;case"PtgRef3d":g=N[1][1],d=Su(N[1][2],c,n),f=g_(a,g,n),l.push(f+"!"+ku(d,i));break;case"PtgFunc":case"PtgFuncVar":var E=N[1][0],O=N[1][1];E||(E=0),E&=127;var F=E==0?[]:l.slice(-E);l.length-=E,O==="User"&&(O=F.shift()),l.push(O+"("+F.join(",")+")");break;case"PtgBool":l.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(N[1]);break;case"PtgNum":l.push(String(N[1]));break;case"PtgStr":l.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(N[1]);break;case"PtgAreaN":h=K2(N[1][1],e?{s:e}:c,n),l.push(jp(h,n));break;case"PtgArea":h=K2(N[1][1],c,n),l.push(jp(h,n));break;case"PtgArea3d":g=N[1][1],h=N[1][2],f=g_(a,g,n),l.push(f+"!"+jp(h,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=N[1][2];var z=(a.names||[])[p-1]||(a[0]||[])[p],P=z?z.Name:"SH33TJSNAME"+String(p);P&&P.slice(0,6)=="_xlfn."&&!n.xlfn&&(P=P.slice(6)),l.push(P);break;case"PtgNameX":var U=N[1][1];p=N[1][2];var W;if(n.biff<=5)U<0&&(U=-U),a[U]&&(W=a[U][p]);else{var Y="";if(((a[U]||[])[0]||[])[0]==14849||(((a[U]||[])[0]||[])[0]==1025?a[U][p]&&a[U][p].itab>0&&(Y=a.SheetNames[a[U][p].itab-1]+"!"):Y=a.SheetNames[p-1]+"!"),a[U]&&a[U][p])Y+=a[U][p].Name;else if(a[0]&&a[0][p])Y+=a[0][p].Name;else{var q=(E4(a,U,n)||"").split(";;");q[p-1]?Y=q[p-1]:Y+="SH33TJSERRX"}l.push(Y);break}W||(W={Name:"SH33TJSERRY"}),l.push(W.Name);break;case"PtgParen":var M="(",D=")";if(x>=0){switch(b="",t[0][x][1][0]){case 2:M=Hr(" ",t[0][x][1][1])+M;break;case 3:M=Hr("\r",t[0][x][1][1])+M;break;case 4:D=Hr(" ",t[0][x][1][1])+D;break;case 5:D=Hr("\r",t[0][x][1][1])+D;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}l.push(M+l.pop()+D);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:N[1][1],r:N[1][0]};var T={c:e.c,r:e.r};if(a.sharedf[Xt(d)]){var C=a.sharedf[Xt(d)];l.push(Ps(C,c,T,a,n))}else{var S=!1;for(u=0;u!=a.arrayf.length;++u)if(o=a.arrayf[u],!(d.c<o[0].s.c||d.c>o[0].e.c)&&!(d.r<o[0].s.r||d.r>o[0].e.r)){l.push(Ps(o[1],c,T,a,n)),S=!0;break}S||l.push(N[1])}break;case"PtgArray":l.push("{"+YP(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var w=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&w.indexOf(t[0][v][0])==-1){N=t[0][x];var j=!0;switch(N[1][0]){case 4:j=!1;case 0:b=Hr(" ",N[1][1]);break;case 5:j=!1;case 1:b=Hr("\r",N[1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}l.push((j?b:"")+l.pop()+(j?"":b)),x=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function KP(t,s,e){var a=t.l+s,n=e.biff==2?1:2,i,c=t.read_shift(n);if(c==65535)return[[],Vs(t,s-2)];var l=dd(t,c,e);return s!==c+n&&(i=ud(t,s-c-n,l,e)),t.l=a,[l,i]}function ZP(t,s,e){var a=t.l+s,n=e.biff==2?1:2,i,c=t.read_shift(n);if(c==65535)return[[],Vs(t,s-2)];var l=dd(t,c,e);return s!==c+n&&(i=ud(t,s-c-n,l,e)),t.l=a,[l,i]}function QP(t,s,e,a){var n=t.l+s,i=dd(t,a,e),c;return n!==t.l&&(c=ud(t,n-t.l,i,e)),[i,c]}function JP(t,s,e){var a=t.l+s,n,i=t.read_shift(2),c=dd(t,i,e);return i==65535?[[],Vs(t,s-2)]:(s!==i+2&&(n=ud(t,a-i-2,c,e)),[c,n])}function eB(t){var s;if(li(t,t.l+6)!==65535)return[Ds(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return s=t[t.l+2]===1,t.l+=8,[s,"b"];case 2:return s=t[t.l+2],t.l+=8,[s,"e"];case 3:return t.l+=8,["","s"]}return[]}function Cp(t,s,e){var a=t.l+s,n=Vn(t);e.biff==2&&++t.l;var i=eB(t),c=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var l=ZP(t,a-t.l,e);return{cell:n,val:i[0],formula:l,shared:c>>3&1,tt:i[1]}}function Z0(t,s,e){var a=t.read_shift(4),n=dd(t,a,e),i=t.read_shift(4),c=i>0?ud(t,i,n,e):null;return[n,c]}var tB=Z0,Q0=Z0,rB=Z0,sB=Z0,aB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},T4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function x_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(s,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Ep(t){var s=t.split(":"),e=s[0].split(".")[0];return[e,s[0].split(".")[1]+(s.length>1?":"+(s[1].split(".")[1]||s[1].split(".")[0]):"")]}var Au={},Hl={};function Ou(t,s){if(t){var e=[.7,.7,.75,.75,.3,.3];s=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function A4(t,s,e,a,n,i){try{a.cellNF&&(t.z=Kt[s])}catch(l){if(a.WTF)throw l}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=bs(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(Kt[s]==null&&Bo(iR[s]||"General",s),t.t==="e")t.w=t.w||nl[t.v];else if(s===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Pu(t.v);else if(t.t==="d"){var c=ta(t.v);(c|0)===c?t.w=c.toString(10):t.w=Pu(c)}else{if(t.v===void 0)return"";t.w=qo(t.v,Hl)}else t.t==="d"?t.w=Ja(s,ta(t.v),Hl):t.w=Ja(s,t.v,Hl)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&e!=null)try{t.s=i.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=v0(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=v0(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&i.Fills)throw l}}}function iB(t,s){var e=Gr(s);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=hr(e))}var oB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,lB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,cB=/<(?:\w:)?hyperlink [^>]*>/mg,uB=/"(\w*:\w*)"/,dB=/<(?:\w:)?col\b[^>]*[\/]?>/g,fB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,hB=/<(?:\w:)?pageMargins[^>]*\/>/g,O4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,mB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,pB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function gB(t,s,e,a,n,i,c){if(!t)return t;a||(a={"!id":{}});var l=s.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},o="",d="",g=t.match(lB);g?(o=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):o=d=t;var p=o.match(O4);p?Ax(p[0],l,n,e):(p=o.match(mB))&&xB(p[0],p[1]||"",l,n,e);var h=(o.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var f=o.slice(h,h+50).match(uB);f&&iB(l,f[1])}var x=o.match(pB);x&&x[1]&&NB(x[1],n);var b=[];if(s.cellStyles){var v=o.match(dB);v&&vB(b,v)}g&&jB(g[1],l,s,u,i,c);var _=d.match(fB);_&&(l["!autofilter"]=_B(_[0]));var N=[],E=d.match(oB);if(E)for(h=0;h!=E.length;++h)N[h]=Gr(E[h].slice(E[h].indexOf('"')+1));var O=d.match(cB);O&&bB(l,O,a);var F=d.match(hB);if(F&&(l["!margins"]=yB(qt(F[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=hr(u)),s.sheetRows>0&&l["!ref"]){var z=Gr(l["!ref"]);s.sheetRows<=+z.e.r&&(z.e.r=s.sheetRows-1,z.e.r>u.e.r&&(z.e.r=u.e.r),z.e.r<z.s.r&&(z.s.r=z.e.r),z.e.c>u.e.c&&(z.e.c=u.e.c),z.e.c<z.s.c&&(z.s.c=z.e.c),l["!fullref"]=l["!ref"],l["!ref"]=hr(z))}return b.length>0&&(l["!cols"]=b),N.length>0&&(l["!merges"]=N),l}function Ax(t,s,e,a){var n=qt(t);e.Sheets[a]||(e.Sheets[a]={}),n.codeName&&(e.Sheets[a].CodeName=pr(Or(n.codeName)))}function xB(t,s,e,a,n){Ax(t.slice(0,t.indexOf(">")),e,a,n)}function bB(t,s,e){for(var a=Array.isArray(t),n=0;n!=s.length;++n){var i=qt(Or(s[n]),!0);if(!i.ref)return;var c=((e||{})["!id"]||[])[i.id];c?(i.Target=c.Target,i.location&&(i.Target+="#"+pr(i.location))):(i.Target="#"+pr(i.location),c={Target:i.Target,TargetMode:"Internal"}),i.Rel=c,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=Gr(i.ref),u=l.s.r;u<=l.e.r;++u)for(var o=l.s.c;o<=l.e.c;++o){var d=Xt({c:o,r:u});a?(t[u]||(t[u]=[]),t[u][o]||(t[u][o]={t:"z",v:void 0}),t[u][o].l=i):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=i)}}}function yB(t){var s={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(s[e]=parseFloat(t[e]))}),s}function vB(t,s){for(var e=!1,a=0;a!=s.length;++a){var n=qt(s[a],!0);n.hidden&&(n.hidden=Fr(n.hidden));var i=parseInt(n.min,10)-1,c=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!e&&n.width&&(e=!0,Ex(n.width)),ec(n);i<=c;)t[i++]=Es(n)}}function _B(t){var s={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return s}var wB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function NB(t,s){s.Views||(s.Views=[{}]),(t.match(wB)||[]).forEach(function(e,a){var n=qt(e);s.Views[a]||(s.Views[a]={}),+n.zoomScale&&(s.Views[a].zoom=+n.zoomScale),Fr(n.rightToLeft)&&(s.Views[a].RTL=!0)})}var jB=function(){var t=/<(?:\w+:)?c[ \/>]/,s=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=Bu("v"),c=Bu("f");return function(u,o,d,g,p,h){for(var f=0,x="",b=[],v=[],_=0,N=0,E=0,O="",F,z,P=0,U=0,W,Y,q=0,M=0,D=Array.isArray(h.CellXf),T,C=[],S=[],w=Array.isArray(o),j=[],A={},L=!1,I=!!d.sheetStubs,Z=u.split(s),K=0,re=Z.length;K!=re;++K){x=Z[K].trim();var G=x.length;if(G!==0){var ae=0;e:for(f=0;f<G;++f)switch(x[f]){case">":if(x[f-1]!="/"){++f;break e}if(d&&d.cellStyles){if(z=qt(x.slice(ae,f),!0),P=z.r!=null?parseInt(z.r,10):P+1,U=-1,d.sheetRows&&d.sheetRows<P)continue;A={},L=!1,z.ht&&(L=!0,A.hpt=parseFloat(z.ht),A.hpx=zu(A.hpt)),z.hidden=="1"&&(L=!0,A.hidden=!0),z.outlineLevel!=null&&(L=!0,A.level=+z.outlineLevel),L&&(j[P-1]=A)}break;case"<":ae=f;break}if(ae>=f)break;if(z=qt(x.slice(ae,f),!0),P=z.r!=null?parseInt(z.r,10):P+1,U=-1,!(d.sheetRows&&d.sheetRows<P)){g.s.r>P-1&&(g.s.r=P-1),g.e.r<P-1&&(g.e.r=P-1),d&&d.cellStyles&&(A={},L=!1,z.ht&&(L=!0,A.hpt=parseFloat(z.ht),A.hpx=zu(A.hpt)),z.hidden=="1"&&(L=!0,A.hidden=!0),z.outlineLevel!=null&&(L=!0,A.level=+z.outlineLevel),L&&(j[P-1]=A)),b=x.slice(f).split(t);for(var V=0;V!=b.length&&b[V].trim().charAt(0)=="<";++V);for(b=b.slice(V),f=0;f!=b.length;++f)if(x=b[f].trim(),x.length!==0){if(v=x.match(e),_=f,N=0,E=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,v!=null&&v.length===2){for(_=0,O=v[1],N=0;N!=O.length&&!((E=O.charCodeAt(N)-64)<1||E>26);++N)_=26*_+E;--_,U=_}else++U;for(N=0;N!=x.length&&x.charCodeAt(N)!==62;++N);if(++N,z=qt(x.slice(0,N),!0),z.r||(z.r=Xt({r:P-1,c:U})),O=x.slice(N),F={t:""},(v=O.match(i))!=null&&v[1]!==""&&(F.v=pr(v[1])),d.cellFormula){if((v=O.match(c))!=null&&v[1]!==""){if(F.f=pr(Or(v[1])).replace(/\r\n/g,`
`),d.xlfn||(F.f=h_(F.f)),v[0].indexOf('t="array"')>-1)F.F=(O.match(n)||[])[1],F.F.indexOf(":")>-1&&C.push([Gr(F.F),F.F]);else if(v[0].indexOf('t="shared"')>-1){Y=qt(v[0]);var H=pr(Or(v[1]));d.xlfn||(H=h_(H)),S[parseInt(Y.si,10)]=[Y,H,z.r]}}else(v=O.match(/<f[^>]*\/>/))&&(Y=qt(v[0]),S[Y.si]&&(F.f=IL(S[Y.si][1],S[Y.si][2],z.r)));var Q=Qs(z.r);for(N=0;N<C.length;++N)Q.r>=C[N][0].s.r&&Q.r<=C[N][0].e.r&&Q.c>=C[N][0].s.c&&Q.c<=C[N][0].e.c&&(F.F=C[N][1])}if(z.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(I)F.t="z";else continue;else F.t=z.t||"n";switch(g.s.c>U&&(g.s.c=U),g.e.c<U&&(g.e.c=U),F.t){case"n":if(F.v==""||F.v==null){if(!I)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!I)continue;F.t="z"}else W=Au[parseInt(F.v,10)],F.v=W.t,F.r=W.r,d.cellHTML&&(F.h=W.h);break;case"str":F.t="s",F.v=F.v!=null?Or(F.v):"",d.cellHTML&&(F.h=xx(F.v));break;case"inlineStr":v=O.match(a),F.t="s",v!=null&&(W=Cx(v[1]))?(F.v=W.t,d.cellHTML&&(F.h=W.h)):F.v="";break;case"b":F.v=Fr(F.v);break;case"d":d.cellDates?F.v=bs(F.v,1):(F.v=ta(bs(F.v,1)),F.t="n");break;case"e":(!d||d.cellText!==!1)&&(F.w=F.v),F.v=Q5[F.v];break}if(q=M=0,T=null,D&&z.s!==void 0&&(T=h.CellXf[z.s],T!=null&&(T.numFmtId!=null&&(q=T.numFmtId),d.cellStyles&&T.fillId!=null&&(M=T.fillId))),A4(F,q,M,d,p,h),d.cellDates&&D&&F.t=="n"&&fc(Kt[q])&&(F.t="d",F.v=X0(F.v)),z.cm&&d.xlmeta){var oe=(d.xlmeta.Cell||[])[+z.cm-1];oe&&oe.type=="XLDAPR"&&(F.D=!0)}if(w){var se=Qs(z.r);o[se.r]||(o[se.r]=[]),o[se.r][se.c]=F}else o[z.r]=F}}}}j.length>0&&(o["!rows"]=j)}}();function SB(t,s){var e={},a=t.l+s;e.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=a,i&7&&(e.level=i&7),i&16&&(e.hidden=!0),i&32&&(e.hpt=n/20),e}var kB=al;function CB(){}function EB(t,s){var e={},a=t[t.l];return++t.l,e.above=!(a&64),e.left=!(a&128),t.l+=18,e.name=KR(t),e}function TB(t){var s=tn(t);return[s]}function AB(t){var s=sl(t);return[s]}function OB(t){var s=tn(t),e=t.read_shift(1);return[s,e,"b"]}function RB(t){var s=sl(t),e=t.read_shift(1);return[s,e,"b"]}function MB(t){var s=tn(t),e=t.read_shift(1);return[s,e,"e"]}function FB(t){var s=sl(t),e=t.read_shift(1);return[s,e,"e"]}function IB(t){var s=tn(t),e=t.read_shift(4);return[s,e,"s"]}function LB(t){var s=sl(t),e=t.read_shift(4);return[s,e,"s"]}function PB(t){var s=tn(t),e=Ds(t);return[s,e,"n"]}function R4(t){var s=sl(t),e=Ds(t);return[s,e,"n"]}function BB(t){var s=tn(t),e=jx(t);return[s,e,"n"]}function DB(t){var s=sl(t),e=jx(t);return[s,e,"n"]}function UB(t){var s=tn(t),e=wx(t);return[s,e,"is"]}function $B(t){var s=tn(t),e=zs(t);return[s,e,"str"]}function zB(t){var s=sl(t),e=zs(t);return[s,e,"str"]}function HB(t,s,e){var a=t.l+s,n=tn(t);n.r=e["!row"];var i=t.read_shift(1),c=[n,i,"b"];if(e.cellFormula){t.l+=2;var l=Q0(t,a-t.l,e);c[3]=Ps(l,null,n,e.supbooks,e)}else t.l=a;return c}function VB(t,s,e){var a=t.l+s,n=tn(t);n.r=e["!row"];var i=t.read_shift(1),c=[n,i,"e"];if(e.cellFormula){t.l+=2;var l=Q0(t,a-t.l,e);c[3]=Ps(l,null,n,e.supbooks,e)}else t.l=a;return c}function qB(t,s,e){var a=t.l+s,n=tn(t);n.r=e["!row"];var i=Ds(t),c=[n,i,"n"];if(e.cellFormula){t.l+=2;var l=Q0(t,a-t.l,e);c[3]=Ps(l,null,n,e.supbooks,e)}else t.l=a;return c}function GB(t,s,e){var a=t.l+s,n=tn(t);n.r=e["!row"];var i=zs(t),c=[n,i,"str"];if(e.cellFormula){t.l+=2;var l=Q0(t,a-t.l,e);c[3]=Ps(l,null,n,e.supbooks,e)}else t.l=a;return c}var YB=al;function WB(t,s){var e=t.l+s,a=al(t),n=Nx(t),i=zs(t),c=zs(t),l=zs(t);t.l=e;var u={rfx:a,relId:n,loc:i,display:l};return c&&(u.Tooltip=c),u}function XB(){}function KB(t,s,e){var a=t.l+s,n=X5(t),i=t.read_shift(1),c=[n];if(c[2]=i,e.cellFormula){var l=tB(t,a-t.l,e);c[1]=l}else t.l=a;return c}function ZB(t,s,e){var a=t.l+s,n=al(t),i=[n];if(e.cellFormula){var c=sB(t,a-t.l,e);i[1]=c,t.l=a}else t.l=a;return i}var QB=["left","right","top","bottom","header","footer"];function JB(t){var s={};return QB.forEach(function(e){s[e]=Ds(t)}),s}function eD(t){var s=t.read_shift(2);return t.l+=28,{RTL:s&32}}function tD(){}function rD(){}function sD(t,s,e,a,n,i,c){if(!t)return t;var l=s||{};a||(a={"!id":{}});var u=l.dense?[]:{},o,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,p=!1,h,f,x,b,v,_,N,E,O,F=[];l.biff=12,l["!row"]=0;var z=0,P=!1,U=[],W={},Y=l.supbooks||n.supbooks||[[]];if(Y.sharedf=W,Y.arrayf=U,Y.SheetNames=n.SheetNames||n.Sheets.map(function(w){return w.name}),!l.supbooks&&(l.supbooks=Y,n.Names))for(var q=0;q<n.Names.length;++q)Y[0][q+1]=n.Names[q];var M=[],D=[],T=!1;N0[16]={n:"BrtShortReal",f:R4};var C;if(yi(t,function(j,A,L){if(!p)switch(L){case 148:o=j;break;case 0:h=j,l.sheetRows&&l.sheetRows<=h.r&&(p=!0),E=Ts(b=h.r),l["!row"]=h.r,(j.hidden||j.hpt||j.level!=null)&&(j.hpt&&(j.hpx=zu(j.hpt)),D[j.r]=j);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(f={t:j[2]},j[2]){case"n":f.v=j[1];break;case"s":N=Au[j[1]],f.v=N.t,f.r=N.r;break;case"b":f.v=!!j[1];break;case"e":f.v=j[1],l.cellText!==!1&&(f.w=nl[f.v]);break;case"str":f.t="s",f.v=j[1];break;case"is":f.t="s",f.v=j[1].t;break}if((x=c.CellXf[j[0].iStyleRef])&&A4(f,x.numFmtId,null,l,i,c),v=j[0].c==-1?v+1:j[0].c,l.dense?(u[b]||(u[b]=[]),u[b][v]=f):u[fs(v)+E]=f,l.cellFormula){for(P=!1,z=0;z<U.length;++z){var I=U[z];h.r>=I[0].s.r&&h.r<=I[0].e.r&&v>=I[0].s.c&&v<=I[0].e.c&&(f.F=hr(I[0]),P=!0)}!P&&j.length>3&&(f.f=j[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),l.cellDates&&x&&f.t=="n"&&fc(Kt[x.numFmtId])){var Z=Fo(f.v);Z&&(f.t="d",f.v=new Date(Z.y,Z.m-1,Z.d,Z.H,Z.M,Z.S,Z.u))}C&&(C.type=="XLDAPR"&&(f.D=!0),C=void 0);break;case 1:case 12:if(!l.sheetStubs||g)break;f={t:"z",v:void 0},v=j[0].c==-1?v+1:j[0].c,l.dense?(u[b]||(u[b]=[]),u[b][v]=f):u[fs(v)+E]=f,d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),C&&(C.type=="XLDAPR"&&(f.D=!0),C=void 0);break;case 176:F.push(j);break;case 49:C=((l.xlmeta||{}).Cell||[])[j-1];break;case 494:var K=a["!id"][j.relId];for(K?(j.Target=K.Target,j.loc&&(j.Target+="#"+j.loc),j.Rel=K):j.relId==""&&(j.Target="#"+j.loc),b=j.rfx.s.r;b<=j.rfx.e.r;++b)for(v=j.rfx.s.c;v<=j.rfx.e.c;++v)l.dense?(u[b]||(u[b]=[]),u[b][v]||(u[b][v]={t:"z",v:void 0}),u[b][v].l=j):(_=Xt({c:v,r:b}),u[_]||(u[_]={t:"z",v:void 0}),u[_].l=j);break;case 426:if(!l.cellFormula)break;U.push(j),O=l.dense?u[b][v]:u[fs(v)+E],O.f=Ps(j[1],d,{r:h.r,c:v},Y,l),O.F=hr(j[0]);break;case 427:if(!l.cellFormula)break;W[Xt(j[0].s)]=j[1],O=l.dense?u[b][v]:u[fs(v)+E],O.f=Ps(j[1],d,{r:h.r,c:v},Y,l);break;case 60:if(!l.cellStyles)break;for(;j.e>=j.s;)M[j.e--]={width:j.w/256,hidden:!!(j.flags&1),level:j.level},T||(T=!0,Ex(j.w/256)),ec(M[j.e+1]);break;case 161:u["!autofilter"]={ref:hr(j)};break;case 476:u["!margins"]=j;break;case 147:n.Sheets[e]||(n.Sheets[e]={}),j.name&&(n.Sheets[e].CodeName=j.name),(j.above||j.left)&&(u["!outline"]={above:j.above,left:j.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),j.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!A.T){if(!g||l.WTF)throw new Error("Unexpected record 0x"+L.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(d.s.r<2e6||o&&(o.e.r>0||o.e.c>0||o.s.r>0||o.s.c>0))&&(u["!ref"]=hr(o||d)),l.sheetRows&&u["!ref"]){var S=Gr(u["!ref"]);l.sheetRows<=+S.e.r&&(S.e.r=l.sheetRows-1,S.e.r>d.e.r&&(S.e.r=d.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>d.e.c&&(S.e.c=d.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),u["!fullref"]=u["!ref"],u["!ref"]=hr(S))}return F.length>0&&(u["!merges"]=F),M.length>0&&(u["!cols"]=M),D.length>0&&(u["!rows"]=D),u}function aD(t){var s=[],e=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var c=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(s[+c[1]]=e?+c[2]:c[2])});var n=pr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[s,n,a]}function nD(t,s,e,a,n,i){var c=i||{"!type":"chart"};if(!t)return i;var l=0,u=0,o="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var p=aD(g);d.s.r=d.s.c=0,d.e.c=l,o=fs(l),p[0].forEach(function(h,f){c[o+Ts(f)]={t:"n",v:h,z:p[1]},u=f}),d.e.r<u&&(d.e.r=u),++l}),l>0&&(c["!ref"]=hr(d)),c}function iD(t,s,e,a,n){if(!t)return t;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},c,l=t.match(O4);return l&&Ax(l[0],i,n,e),(c=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=c[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function oD(t,s){t.l+=10;var e=zs(t);return{name:e}}function lD(t,s,e,a,n){if(!t)return t;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},c=!1;return yi(t,function(u,o,d){switch(d){case 550:i["!rel"]=u;break;case 651:n.Sheets[e]||(n.Sheets[e]={}),u.name&&(n.Sheets[e].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(o.T>0)){if(!(o.T<0)){if(!c||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},s),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var M4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],cD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uD=[],dD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function b_(t,s){for(var e=0;e!=t.length;++e)for(var a=t[e],n=0;n!=s.length;++n){var i=s[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=Fr(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function y_(t,s){for(var e=0;e!=s.length;++e){var a=s[e];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=Fr(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function F4(t){y_(t.WBProps,M4),y_(t.CalcPr,dD),b_(t.WBView,cD),b_(t.Sheets,uD),Hl.date1904=Fr(t.WBProps.date1904)}var fD="][*?/\\".split("");function hD(t,s){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return fD.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var mD=/<\w+:workbook/;function pD(t,s){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},c=0;if(t.replace(Ys,function(u,o){var d=qt(u);switch(Hn(d[0])){case"<?xml":break;case"<workbook":u.match(mD)&&(n="xmlns"+u.match(/<(\w+):/)[1]),e.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],e.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":M4.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":e.WBProps[g[0]]=Fr(d[g[0]]);break;case"int":e.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:e.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(e.WBProps.CodeName=Or(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],e.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=pr(Or(d.name)),delete d[0],e.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Or(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),Fr(d.hidden||"0")&&(i.Hidden=!0),c=o+u.length;break;case"</definedName>":i.Ref=pr(Or(t.slice(c,o))),e.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],e.CalcPr=d;break;case"<calcPr/>":delete d[0],e.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&s.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),MR.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return F4(e),e}function gD(t,s){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=ag(t),e.name=zs(t),e}function xD(t,s){var e={},a=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var n=s>8?zs(t):"";return n.length>0&&(e.CodeName=n),e.autoCompressPictures=!!(a&65536),e.backupFile=!!(a&64),e.checkCompatibility=!!(a&4096),e.date1904=!!(a&1),e.filterPrivacy=!!(a&8),e.hidePivotFieldList=!!(a&1024),e.promptedSolutions=!!(a&16),e.publishItems=!!(a&2048),e.refreshAllConnections=!!(a&262144),e.saveExternalLinkValues=!!(a&128),e.showBorderUnselectedTables=!!(a&4),e.showInkAnnotation=!!(a&32),e.showObjects=["all","placeholders","none"][a>>13&3],e.showPivotChartFilter=!!(a&32768),e.updateLinks=["userSet","never","always"][a>>8&3],e}function bD(t,s){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=s-8,e}function yD(t,s,e){var a=t.l+s;t.l+=4,t.l+=1;var n=t.read_shift(4),i=ZR(t),c=rB(t,0,e),l=Nx(t);t.l=a;var u={Name:i,Ptg:c};return n<268435455&&(u.Sheet=n),l&&(u.Comment=l),u}function vD(t,s){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;s||(s={}),s.biff=12;var i=[],c=[[]];return c.SheetNames=[],c.XTI=[],N0[16]={n:"BrtFRTArchID$",f:bD},yi(t,function(u,o,d){switch(d){case 156:c.SheetNames.push(u.name),e.Sheets.push(u);break;case 153:e.WBProps=u;break;case 39:u.Sheet!=null&&(s.SID=u.Sheet),u.Ref=Ps(u.Ptg,null,null,c,s),delete s.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([d,u]):c[0]=[d,u],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(u),c.XTI=c.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(d),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!o.T){if(!n||s.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},s),F4(e),e.Names=i,e.supbooks=c,e}function _D(t,s,e){return s.slice(-4)===".bin"?vD(t,e):pD(t,e)}function wD(t,s,e,a,n,i,c,l){return s.slice(-4)===".bin"?sD(t,a,e,n,i,c,l):gB(t,a,e,n,i,c,l)}function ND(t,s,e,a,n,i,c,l){return s.slice(-4)===".bin"?lD(t,a,e,n,i):iD(t,a,e,n,i)}function jD(t,s,e,a,n,i,c,l){return s.slice(-4)===".bin"?RL():ML()}function SD(t,s,e,a,n,i,c,l){return s.slice(-4)===".bin"?AL():OL()}function kD(t,s,e,a){return s.slice(-4)===".bin"?YI(t,e,a):$I(t,e,a)}function CD(t,s,e){return v4(t,e)}function ED(t,s,e){return s.slice(-4)===".bin"?cI(t,e):oI(t,e)}function TD(t,s,e){return s.slice(-4)===".bin"?CL(t,e):wL(t,e)}function AD(t,s,e){return s.slice(-4)===".bin"?yL(t):xL(t)}function OD(t,s,e,a){return e.slice(-4)===".bin"?vL(t,s,e,a):void 0}function RD(t,s,e){return s.slice(-4)===".bin"?pL(t,s,e):gL(t,s,e)}var I4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,L4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function cn(t,s){var e=t.split(/\s+/),a=[];if(a[0]=e[0],e.length===1)return a;var n=t.match(I4),i,c,l,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(L4),(c=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(c+1),a[l]=i[2].slice(1,i[2].length-1));return a}function MD(t){var s=t.split(/\s+/),e={};if(s.length===1)return e;var a=t.match(I4),n,i,c,l;if(a)for(l=0;l!=a.length;++l)n=a[l].match(L4),(i=n[1].indexOf(":"))===-1?e[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?c="xmlns"+n[1].slice(6):c=n[1].slice(i+1),e[c]=n[2].slice(1,n[2].length-1));return e}var Ru;function FD(t,s){var e=Ru[t]||pr(t);return e==="General"?qo(s):Ja(e,s)}function ID(t,s,e,a){var n=a;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Fr(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=bs(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[pr(s)]=n}function LD(t,s,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||nl[t.v]:s==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Pu(t.v):t.w=qo(t.v):t.w=FD(s||"General",t.v)}catch(i){if(e.WTF)throw i}try{var a=Ru[s]||s||"General";if(e.cellNF&&(t.z=a),e.cellDates&&t.t=="n"&&fc(a)){var n=Fo(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(e.WTF)throw i}}}function PD(t,s,e){if(e.cellStyles&&s.Interior){var a=s.Interior;a.Pattern&&(a.patternType=II[a.Pattern]||a.Pattern)}t[s.ID]=s}function BD(t,s,e,a,n,i,c,l,u,o){var d="General",g=a.StyleID,p={};o=o||{};var h=[],f=0;for(g===void 0&&l&&(g=l.StyleID),g===void 0&&c&&(g=c.StyleID);i[g]!==void 0&&(i[g].nf&&(d=i[g].nf),i[g].Interior&&h.push(i[g].Interior),!!i[g].Parent);)g=i[g].Parent;switch(e.Type){case"Boolean":a.t="b",a.v=Fr(t);break;case"String":a.t="s",a.r=$2(pr(t)),a.v=t.indexOf("<")>-1?pr(s||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(bs(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=pr(t):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Q5[t],o.cellText!==!1&&(a.w=t);break;default:t==""&&s==""?a.t="z":(a.t="s",a.v=$2(s||t));break}if(LD(a,d,o),o.cellFormula!==!1)if(a.Formula){var x=pr(a.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),a.f=zl(x,n),delete a.Formula,a.ArrayRange=="RC"?a.F=zl("RC:RC",n):a.ArrayRange&&(a.F=zl(a.ArrayRange,n),u.push([Gr(a.F),a.F]))}else for(f=0;f<u.length;++f)n.r>=u[f][0].s.r&&n.r<=u[f][0].e.r&&n.c>=u[f][0].s.c&&n.c<=u[f][0].e.c&&(a.F=u[f][1]);o.cellStyles&&(h.forEach(function(b){!p.patternType&&b.patternType&&(p.patternType=b.patternType)}),a.s=p),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function DD(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Tp(t,s){var e=s||{};j5();var a=xu(bx(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(a=Or(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var c=Es(e);return c.type="string",Uu.to_workbook(a,c)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Se){n.indexOf("<"+Se)>=0&&(i=!0)}),i)return WD(a,e);Ru={"General Number":"General","General Date":Kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Kt[15],"Short Date":Kt[14],"Long Time":Kt[19],"Medium Time":Kt[18],"Short Time":Kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Kt[2],Standard:Kt[4],Percent:Kt[10],Scientific:Kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],o,d={},g=[],p=e.dense?[]:{},h="",f={},x={},b=cn('<Data ss:Type="String">'),v=0,_=0,N=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},F={},z="",P=0,U=[],W={},Y={},q=0,M=[],D=[],T={},C=[],S,w=!1,j=[],A=[],L={},I=0,Z=0,K={Sheets:[],WBProps:{date1904:!1}},re={};Du.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var G="";l=Du.exec(a);)switch(l[3]=(G=l[3]).toLowerCase()){case"data":if(G=="data"){if(l[1]==="/"){if((o=u.pop())[0]!==l[3])throw new Error("Bad state: "+o.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?BD(a.slice(v,l.index),z,b,u[u.length-1][0]=="comment"?T:f,{c:_,r:N},O,C[_],x,j,e):(z="",b=cn(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(D.length>0&&(f.c=D),(!e.sheetRows||e.sheetRows>N)&&f.v!==void 0&&(e.dense?(p[N]||(p[N]=[]),p[N][_]=f):p[fs(_)+Ts(N)]=f),f.HRef&&(f.l={Target:pr(f.HRef)},f.HRefScreenTip&&(f.l.Tooltip=f.HRefScreenTip),delete f.HRef,delete f.HRefScreenTip),(f.MergeAcross||f.MergeDown)&&(I=_+(parseInt(f.MergeAcross,10)|0),Z=N+(parseInt(f.MergeDown,10)|0),U.push({s:{c:_,r:N},e:{c:I,r:Z}})),!e.sheetStubs)f.MergeAcross?_=I+1:++_;else if(f.MergeAcross||f.MergeDown){for(var ae=_;ae<=I;++ae)for(var V=N;V<=Z;++V)(ae>_||V>N)&&(e.dense?(p[V]||(p[V]=[]),p[V][ae]={t:"z"}):p[fs(ae)+Ts(V)]={t:"z"});_=I+1}else++_;else f=MD(l[0]),f.Index&&(_=+f.Index-1),_<E.s.c&&(E.s.c=_),_>E.e.c&&(E.e.c=_),l[0].slice(-2)==="/>"&&++_,D=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(N<E.s.r&&(E.s.r=N),N>E.e.r&&(E.e.r=N),l[0].slice(-2)==="/>"&&(x=cn(l[0]),x.Index&&(N=+x.Index-1)),_=0,++N):(x=cn(l[0]),x.Index&&(N=+x.Index-1),L={},(x.AutoFitHeight=="0"||x.Height)&&(L.hpx=parseInt(x.Height,10),L.hpt=y4(L.hpx),A[N]=L),x.Hidden=="1"&&(L.hidden=!0,A[N]=L));break;case"worksheet":if(l[1]==="/"){if((o=u.pop())[0]!==l[3])throw new Error("Bad state: "+o.join("|"));g.push(h),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(p["!ref"]=hr(E),e.sheetRows&&e.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=e.sheetRows-1,p["!ref"]=hr(E))),U.length&&(p["!merges"]=U),C.length>0&&(p["!cols"]=C),A.length>0&&(p["!rows"]=A),d[h]=p}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=_=0,u.push([l[3],!1]),o=cn(l[0]),h=pr(o.Name),p=e.dense?[]:{},U=[],j=[],A=[],re={name:h,Hidden:0},K.Sheets.push(re);break;case"table":if(l[1]==="/"){if((o=u.pop())[0]!==l[3])throw new Error("Bad state: "+o.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),C=[],w=!1}break;case"style":l[1]==="/"?PD(O,F,e):F=cn(l[0]);break;case"numberformat":F.nf=pr(cn(l[0]).Format||"General"),Ru[F.nf]&&(F.nf=Ru[F.nf]);for(var H=0;H!=392&&Kt[H]!=F.nf;++H);if(H==392){for(H=57;H!=392;++H)if(Kt[H]==null){Bo(F.nf,H);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(S=cn(l[0]),S.Hidden&&(S.hidden=!0,delete S.Hidden),S.Width&&(S.wpx=parseInt(S.Width,10)),!w&&S.wpx>10){w=!0,Zs=x4;for(var Q=0;Q<C.length;++Q)C[Q]&&ec(C[Q])}w&&ec(S),C[S.Index-1||C.length]=S;for(var oe=0;oe<+S.Span;++oe)C[C.length]=Es(S);break;case"namedrange":if(l[1]==="/")break;K.Names||(K.Names=[]);var se=qt(l[0]),le={Name:se.Name,Ref:zl(se.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(le.Sheet=K.Sheets.length-1),K.Names.push(le);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?z+=a.slice(P,l.index):P=l.index+l[0].length;break;case"interior":if(!e.cellStyles)break;F.Interior=cn(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?wM(W,G,a.slice(q,l.index)):q=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((o=u.pop())[0]!==l[3])throw new Error("Bad state: "+o.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((o=u.pop())[0]!==l[3])throw new Error("Bad state: "+o.join("|"));DD(T),D.push(T)}else u.push([l[3],!1]),o=cn(l[0]),T={a:o.Author};break;case"autofilter":if(l[1]==="/"){if((o=u.pop())[0]!==l[3])throw new Error("Bad state: "+o.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var he=cn(l[0]);p["!autofilter"]={ref:zl(he.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((o=u.pop())[0]!==l[3])throw new Error("Bad state: "+o.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((o=u.pop())[0]!==l[3])throw new Error("Bad state: "+o.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return S_(a,e);var Ne=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ne=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ne=!1}break;case"excelworkbook":switch(l[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ne=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ne=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(q,l.index)){case"SheetHidden":re.Hidden=1;break;case"SheetVeryHidden":re.Hidden=2;break}else q=l.index+l[0].length;break;case"header":p["!margins"]||Ou(p["!margins"]={},"xlml"),isNaN(+qt(l[0]).Margin)||(p["!margins"].header=+qt(l[0]).Margin);break;case"footer":p["!margins"]||Ou(p["!margins"]={},"xlml"),isNaN(+qt(l[0]).Margin)||(p["!margins"].footer=+qt(l[0]).Margin);break;case"pagemargins":var we=qt(l[0]);p["!margins"]||Ou(p["!margins"]={},"xlml"),isNaN(+we.Top)||(p["!margins"].top=+we.Top),isNaN(+we.Left)||(p["!margins"].left=+we.Left),isNaN(+we.Right)||(p["!margins"].right=+we.Right),isNaN(+we.Bottom)||(p["!margins"].bottom=+we.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ne=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ne=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ne=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ne=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ne=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ne=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ne=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ne=!1}break;case"smarttags":break;default:Ne=!1;break}if(Ne||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?ID(Y,G,M,a.slice(q,l.index)):(M=l,q=l.index+l[0].length);break}if(e.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var ue={};return!e.bookSheets&&!e.bookProps&&(ue.Sheets=d),ue.SheetNames=g,ue.Workbook=K,ue.SSF=Es(Kt),ue.Props=W,ue.Custprops=Y,ue}function lg(t,s){switch(Mx(s=s||{}),s.type||"base64"){case"base64":return Tp(Ta(t),s);case"binary":case"buffer":case"file":return Tp(t,s);case"array":return Tp(rl(t),s)}}function UD(t){var s={},e=t.content;if(e.l=28,s.AnsiUserType=e.read_shift(0,"lpstr-ansi"),s.AnsiClipboardFormat=eM(e),e.length-e.l<=4)return s;var a=e.read_shift(4);if(a==0||a>40||(e.l-=4,s.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(a=e.read_shift(4),a!==1907505652)||(s.UnicodeClipboardFormat=tM(e),a=e.read_shift(4),a==0||a>40))return s;e.l-=4,s.Reserved2=e.read_shift(0,"lpwstr")}var $D=[60,1084,2066,2165,2175];function zD(t,s,e,a,n){var i=a,c=[],l=e.slice(e.l,e.l+i);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}c.push(l),e.l+=i;for(var u=li(e,e.l),o=cg[u],d=0;o!=null&&$D.indexOf(u)>-1;)i=li(e,e.l+2),d=e.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),l=e.slice(d,e.l+4+i),c.push(l),e.l+=4+i,o=cg[u=li(e,e.l)];var g=Yi(c);ks(g,0);var p=0;g.lens=[];for(var h=0;h<c.length;++h)g.lens.push(p),p+=c[h].length;if(g.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+a;return s.f(g,g.length,n)}function Rn(t,s,e){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,s.cellNF&&(t.z=Kt[a])}catch(i){if(s.WTF)throw i}if(!s||s.cellText!==!1)try{t.t==="e"?t.w=t.w||nl[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Pu(t.v):t.w=qo(t.v):t.w=Ja(a,t.v,{date1904:!!e,dateNF:s&&s.dateNF})}catch(i){if(s.WTF)throw i}if(s.cellDates&&a&&t.t=="n"&&fc(Kt[a]||String(a))){var n=Fo(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Of(t,s,e){return{v:t,ixfe:s,t:e}}function HD(t,s){var e={opts:{}},a={},n=s.dense?[]:{},i={},c={},l=null,u=[],o="",d={},g,p="",h,f,x,b,v={},_=[],N,E,O=[],F=[],z={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},U=function(fe){return fe<8?Do[fe]:fe<64&&F[fe-8]||Do[fe]},W=function(fe,_e,Te){var Ae=_e.XF.data;if(!(!Ae||!Ae.patternType||!Te||!Te.cellStyles)){_e.s={},_e.s.patternType=Ae.patternType;var Fe;(Fe=$u(U(Ae.icvFore)))&&(_e.s.fgColor={rgb:Fe}),(Fe=$u(U(Ae.icvBack)))&&(_e.s.bgColor={rgb:Fe})}},Y=function(fe,_e,Te){if(!(L>1)&&!(Te.sheetRows&&fe.r>=Te.sheetRows)){if(Te.cellStyles&&_e.XF&&_e.XF.data&&W(fe,_e,Te),delete _e.ixfe,delete _e.XF,g=fe,p=Xt(fe),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),fe.r<c.s.r&&(c.s.r=fe.r),fe.c<c.s.c&&(c.s.c=fe.c),fe.r+1>c.e.r&&(c.e.r=fe.r+1),fe.c+1>c.e.c&&(c.e.c=fe.c+1),Te.cellFormula&&_e.f){for(var Ae=0;Ae<_.length;++Ae)if(!(_[Ae][0].s.c>fe.c||_[Ae][0].s.r>fe.r)&&!(_[Ae][0].e.c<fe.c||_[Ae][0].e.r<fe.r)){_e.F=hr(_[Ae][0]),(_[Ae][0].s.c!=fe.c||_[Ae][0].s.r!=fe.r)&&delete _e.f,_e.f&&(_e.f=""+Ps(_[Ae][1],c,fe,j,q));break}}Te.dense?(n[fe.r]||(n[fe.r]=[]),n[fe.r][fe.c]=_e):n[p]=_e}},q={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!s&&!!s.cellStyles,WTF:!!s&&!!s.wtf};s.password&&(q.password=s.password);var M,D=[],T=[],C=[],S=[],w=!1,j=[];j.SheetNames=q.snames,j.sharedf=q.sharedf,j.arrayf=q.arrayf,j.names=[],j.XTI=[];var A=0,L=0,I=0,Z=[],K=[],re;q.codepage=1200,fn(1200);for(var G=!1;t.l<t.length-1;){var ae=t.l,V=t.read_shift(2);if(V===0&&A===10)break;var H=t.l===t.length?0:t.read_shift(2),Q=cg[V];if(Q&&Q.f){if(s.bookSheets&&A===133&&V!==133)break;if(A=V,Q.r===2||Q.r==12){var oe=t.read_shift(2);if(H-=2,!q.enc&&oe!==V&&((oe&255)<<8|oe>>8)!==V)throw new Error("rt mismatch: "+oe+"!="+V);Q.r==12&&(t.l+=10,H-=10)}var se={};if(V===10?se=Q.f(t,H,q):se=zD(V,Q,t,H,q),L==0&&[9,521,1033,2057].indexOf(A)===-1)continue;switch(V){case 34:e.opts.Date1904=z.WBProps.date1904=se;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(q.enc||(t.l=0),q.enc=se,!s.password)throw new Error("File is password-protected");if(se.valid==null)throw new Error("Encryption scheme unsupported");if(!se.valid)throw new Error("Password is incorrect");break;case 92:q.lastuser=se;break;case 66:var le=Number(se);switch(le){case 21010:le=1200;break;case 32768:le=1e4;break;case 32769:le=1252;break}fn(q.codepage=le),G=!0;break;case 317:q.rrtabid=se;break;case 25:q.winlocked=se;break;case 439:e.opts.RefreshAll=se;break;case 12:e.opts.CalcCount=se;break;case 16:e.opts.CalcDelta=se;break;case 17:e.opts.CalcIter=se;break;case 13:e.opts.CalcMode=se;break;case 14:e.opts.CalcPrecision=se;break;case 95:e.opts.CalcSaveRecalc=se;break;case 15:q.CalcRefMode=se;break;case 2211:e.opts.FullCalc=se;break;case 129:se.fDialog&&(n["!type"]="dialog"),se.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),se.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:O.push(se);break;case 430:j.push([se]),j[j.length-1].XTI=[];break;case 35:case 547:j[j.length-1].push(se);break;case 24:case 536:re={Name:se.Name,Ref:Ps(se.rgce,c,null,j,q)},se.itab>0&&(re.Sheet=se.itab-1),j.names.push(re),j[0]||(j[0]=[],j[0].XTI=[]),j[j.length-1].push(se),se.Name=="_xlnm._FilterDatabase"&&se.itab>0&&se.rgce&&se.rgce[0]&&se.rgce[0][0]&&se.rgce[0][0][0]=="PtgArea3d"&&(K[se.itab-1]={ref:hr(se.rgce[0][0][1][2])});break;case 22:q.ExternCount=se;break;case 23:j.length==0&&(j[0]=[],j[0].XTI=[]),j[j.length-1].XTI=j[j.length-1].XTI.concat(se),j.XTI=j.XTI.concat(se);break;case 2196:if(q.biff<8)break;re!=null&&(re.Comment=se[1]);break;case 18:n["!protect"]=se;break;case 19:se!==0&&q.WTF&&console.error("Password verifier: "+se);break;case 133:i[se.pos]=se,q.snames.push(se.name);break;case 10:{if(--L)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,n["!ref"]=hr(c),s.sheetRows&&s.sheetRows<=c.e.r){var he=c.e.r;c.e.r=s.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=hr(c),c.e.r=he}c.e.r++,c.e.c++}D.length>0&&(n["!merges"]=D),T.length>0&&(n["!objects"]=T),C.length>0&&(n["!cols"]=C),S.length>0&&(n["!rows"]=S),z.Sheets.push(P)}o===""?d=n:a[o]=n,n=s.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(q.biff===8&&(q.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[se.BIFFVer]||8),q.biffguess=se.BIFFVer==0,se.BIFFVer==0&&se.dt==4096&&(q.biff=5,G=!0,fn(q.codepage=28591)),q.biff==8&&se.BIFFVer==0&&se.dt==16&&(q.biff=2),L++)break;if(n=s.dense?[]:{},q.biff<8&&!G&&(G=!0,fn(q.codepage=s.codepage||1252)),q.biff<5||se.BIFFVer==0&&se.dt==4096){o===""&&(o="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var Ne={pos:t.l-H,name:o};i[Ne.pos]=Ne,q.snames.push(o)}else o=(i[ae]||{name:""}).name;se.dt==32&&(n["!type"]="chart"),se.dt==64&&(n["!type"]="macro"),D=[],T=[],q.arrayf=_=[],C=[],S=[],w=!1,P={Hidden:(i[ae]||{hs:0}).hs,name:o}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(s.dense?(n[se.r]||[])[se.c]:n[Xt({c:se.c,r:se.r})])&&++se.c,N={ixfe:se.ixfe,XF:O[se.ixfe]||{},v:se.val,t:"n"},I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y({c:se.c,r:se.r},N,s);break;case 5:case 517:N={ixfe:se.ixfe,XF:O[se.ixfe],v:se.val,t:se.t},I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y({c:se.c,r:se.r},N,s);break;case 638:N={ixfe:se.ixfe,XF:O[se.ixfe],v:se.rknum,t:"n"},I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y({c:se.c,r:se.r},N,s);break;case 189:for(var we=se.c;we<=se.C;++we){var ue=se.rkrec[we-se.c][0];N={ixfe:ue,XF:O[ue],v:se.rkrec[we-se.c][1],t:"n"},I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y({c:we,r:se.r},N,s)}break;case 6:case 518:case 1030:{if(se.val=="String"){l=se;break}if(N=Of(se.val,se.cell.ixfe,se.tt),N.XF=O[N.ixfe],s.cellFormula){var Se=se.formula;if(Se&&Se[0]&&Se[0][0]&&Se[0][0][0]=="PtgExp"){var ke=Se[0][0][1][0],Me=Se[0][0][1][1],Oe=Xt({r:ke,c:Me});v[Oe]?N.f=""+Ps(se.formula,c,se.cell,j,q):N.F=((s.dense?(n[ke]||[])[Me]:n[Oe])||{}).F}else N.f=""+Ps(se.formula,c,se.cell,j,q)}I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y(se.cell,N,s),l=se}break;case 7:case 519:if(l)l.val=se,N=Of(se,l.cell.ixfe,"s"),N.XF=O[N.ixfe],s.cellFormula&&(N.f=""+Ps(l.formula,c,l.cell,j,q)),I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y(l.cell,N,s),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(se);var je=Xt(se[0].s);if(h=s.dense?(n[se[0].s.r]||[])[se[0].s.c]:n[je],s.cellFormula&&h){if(!l||!je||!h)break;h.f=""+Ps(se[1],c,se[0],j,q),h.F=hr(se[0])}}break;case 1212:{if(!s.cellFormula)break;if(p){if(!l)break;v[Xt(l.cell)]=se[0],h=s.dense?(n[l.cell.r]||[])[l.cell.c]:n[Xt(l.cell)],(h||{}).f=""+Ps(se[0],c,g,j,q)}}break;case 253:N=Of(u[se.isst].t,se.ixfe,"s"),u[se.isst].h&&(N.h=u[se.isst].h),N.XF=O[N.ixfe],I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y({c:se.c,r:se.r},N,s);break;case 513:s.sheetStubs&&(N={ixfe:se.ixfe,XF:O[se.ixfe],t:"z"},I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y({c:se.c,r:se.r},N,s));break;case 190:if(s.sheetStubs)for(var Ie=se.c;Ie<=se.C;++Ie){var Pe=se.ixfe[Ie-se.c];N={ixfe:Pe,XF:O[Pe],t:"z"},I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y({c:Ie,r:se.r},N,s)}break;case 214:case 516:case 4:N=Of(se.val,se.ixfe,"s"),N.XF=O[N.ixfe],I>0&&(N.z=Z[N.ixfe>>8&63]),Rn(N,s,e.opts.Date1904),Y({c:se.c,r:se.r},N,s);break;case 0:case 512:L===1&&(c=se);break;case 252:u=se;break;case 1054:if(q.biff==4){Z[I++]=se[1];for(var He=0;He<I+163&&Kt[He]!=se[1];++He);He>=163&&Bo(se[1],I+163)}else Bo(se[1],se[0]);break;case 30:{Z[I++]=se;for(var ct=0;ct<I+163&&Kt[ct]!=se;++ct);ct>=163&&Bo(se,I+163)}break;case 229:D=D.concat(se);break;case 93:T[se.cmo[0]]=q.lastobj=se;break;case 438:q.lastobj.TxO=se;break;case 127:q.lastobj.ImData=se;break;case 440:for(b=se[0].s.r;b<=se[0].e.r;++b)for(x=se[0].s.c;x<=se[0].e.c;++x)h=s.dense?(n[b]||[])[x]:n[Xt({c:x,r:b})],h&&(h.l=se[1]);break;case 2048:for(b=se[0].s.r;b<=se[0].e.r;++b)for(x=se[0].s.c;x<=se[0].e.c;++x)h=s.dense?(n[b]||[])[x]:n[Xt({c:x,r:b})],h&&h.l&&(h.l.Tooltip=se[1]);break;case 28:{if(q.biff<=5&&q.biff>=2)break;h=s.dense?(n[se[0].r]||[])[se[0].c]:n[Xt(se[0])];var ie=T[se[2]];h||(s.dense?(n[se[0].r]||(n[se[0].r]=[]),h=n[se[0].r][se[0].c]={t:"z"}):h=n[Xt(se[0])]={t:"z"},c.e.r=Math.max(c.e.r,se[0].r),c.s.r=Math.min(c.s.r,se[0].r),c.e.c=Math.max(c.e.c,se[0].c),c.s.c=Math.min(c.s.c,se[0].c)),h.c||(h.c=[]),f={a:se[1],t:ie.TxO.t},h.c.push(f)}break;case 2173:dL(O[se.ixfe],se.ext);break;case 125:{if(!q.cellStyles)break;for(;se.e>=se.s;)C[se.e--]={width:se.w/256,level:se.level||0,hidden:!!(se.flags&1)},w||(w=!0,Ex(se.w/256)),ec(C[se.e+1])}break;case 520:{var ee={};se.level!=null&&(S[se.r]=ee,ee.level=se.level),se.hidden&&(S[se.r]=ee,ee.hidden=!0),se.hpt&&(S[se.r]=ee,ee.hpt=se.hpt,ee.hpx=zu(se.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Ou(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[V]]=se;break;case 161:n["!margins"]||Ou(n["!margins"]={}),n["!margins"].header=se.header,n["!margins"].footer=se.footer;break;case 574:se.RTL&&(z.Views[0].RTL=!0);break;case 146:F=se;break;case 2198:M=se;break;case 140:E=se;break;case 442:o?P.CodeName=se||P.name:z.WBProps.CodeName=se||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+V.toString(16)),t.l+=H}return e.SheetNames=zn(i).sort(function(te,fe){return Number(te)-Number(fe)}).map(function(te){return i[te].name}),s.bookSheets||(e.Sheets=a),!e.SheetNames.length&&d["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=d)):e.Preamble=d,e.Sheets&&K.forEach(function(te,fe){e.Sheets[e.SheetNames[fe]]["!autofilter"]=te}),e.Strings=u,e.SSF=Es(Kt),q.enc&&(e.Encryption=q.enc),M&&(e.Themes=M),e.Metadata={},E!==void 0&&(e.Metadata.Country=E),j.names.length>0&&(z.Names=j.names),e.Workbook=z,e}var v_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function VD(t,s,e){var a=fr.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=s_(a,oM,v_.DSI);for(var i in n)s[i]=n[i]}catch(o){if(e.WTF)throw o}var c=fr.find(t,"/!SummaryInformation");if(c&&c.size>0)try{var l=s_(c,lM,v_.SI);for(var u in l)s[u]==null&&(s[u]=l[u])}catch(o){if(e.WTF)throw o}s.HeadingPairs&&s.TitlesOfParts&&(e4(s.HeadingPairs,s.TitlesOfParts,s,e),delete s.HeadingPairs,delete s.TitlesOfParts)}function P4(t,s){s||(s={}),Mx(s),f5(),s.codepage&&dx(s.codepage);var e,a;if(t.FullPaths){if(fr.find(t,"/encryption"))throw new Error("File is password-protected");e=fr.find(t,"!CompObj"),a=fr.find(t,"/Workbook")||fr.find(t,"/Book")}else{switch(s.type){case"base64":t=dn(Ta(t));break;case"binary":t=dn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ks(t,0),a={content:t}}var n,i;if(e&&UD(e),s.bookProps&&!s.bookSheets)n={};else{var c=cr?"buffer":"array";if(a&&a.content)n=HD(a.content,s);else if((i=fr.find(t,"PerfectOffice_MAIN"))&&i.content)n=Tu.to_workbook(i.content,(s.type=c,s));else if((i=fr.find(t,"NativeContent_MAIN"))&&i.content)n=Tu.to_workbook(i.content,(s.type=c,s));else throw(i=fr.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");s.bookVBA&&t.FullPaths&&fr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=TL(t))}var l={};return t.FullPaths&&VD(t,l,s),n.Props=n.Custprops=l,s.bookFiles&&(n.cfb=t),n}var N0={0:{f:SB},1:{f:TB},2:{f:BB},3:{f:MB},4:{f:OB},5:{f:PB},6:{f:$B},7:{f:IB},8:{f:GB},9:{f:qB},10:{f:HB},11:{f:VB},12:{f:AB},13:{f:DB},14:{f:FB},15:{f:RB},16:{f:R4},17:{f:zB},18:{f:LB},19:{f:wx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yD},40:{},42:{},43:{f:HI},44:{f:zI},45:{f:VI},46:{f:GI},47:{f:qI},48:{},49:{f:YR},50:{},51:{f:hL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:f4},62:{f:UB},63:{f:bL},64:{f:tD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:eD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:EB},148:{f:kB,p:16},151:{f:XB},152:{},153:{f:xD},154:{},155:{},156:{f:gD},157:{},158:{},159:{T:1,f:lI},160:{T:-1},161:{T:1,f:al},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:YB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fL},336:{T:-1},337:{f:mL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ag},357:{},358:{},359:{},360:{T:1},361:{},362:{f:d4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KB},427:{f:ZB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:CB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:WB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ag},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:kL},633:{T:1},634:{T:-1},635:{T:1,f:SL},636:{T:-1},637:{f:XR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},cg={6:{f:Cp},10:{f:Gi},12:{f:is},13:{f:is},14:{f:Xr},15:{f:Xr},16:{f:Ds},17:{f:Xr},18:{f:Xr},19:{f:is},20:{f:o_},21:{f:o_},23:{f:d4},24:{f:c_},25:{f:Xr},26:{},27:{},28:{f:NF},29:{},34:{f:Xr},35:{f:l_},38:{f:Ds},39:{f:Ds},40:{f:Ds},41:{f:Ds},42:{f:Xr},43:{f:Xr},47:{f:CI},49:{f:aF},51:{f:is},60:{},61:{f:tF},64:{f:Xr},65:{f:sF},66:{f:is},77:{},80:{},81:{},82:{},85:{f:is},89:{},90:{},91:{},92:{f:YM},93:{f:SF},94:{},95:{f:Xr},96:{},97:{},99:{f:Xr},125:{f:f4},128:{f:mF},129:{f:WM},130:{f:is},131:{f:Xr},132:{f:Xr},133:{f:XM},134:{},140:{f:OF},141:{f:is},144:{},146:{f:MF},151:{},152:{},153:{},154:{},155:{},156:{f:is},157:{},158:{},160:{f:BF},161:{f:IF},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:uF},190:{f:dF},193:{f:Gi},197:{},198:{},199:{},200:{},201:{},202:{f:Xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:is},220:{},221:{f:Xr},222:{},224:{f:hF},225:{f:GM},226:{f:Gi},227:{},229:{f:jF},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:KM},253:{f:nF},255:{f:ZM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:n4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Xr},353:{f:Gi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:gF},431:{f:Xr},432:{},433:{},434:{},437:{},438:{f:EF},439:{f:Xr},440:{f:TF},441:{},442:{f:ld},443:{},444:{f:is},445:{},446:{},448:{f:Gi},449:{f:eF,r:2},450:{f:Gi},512:{f:n_},513:{f:PF},515:{f:pF},516:{f:iF},517:{f:i_},519:{f:DF},520:{f:QM},523:{},545:{f:u_},549:{f:a_},566:{},574:{f:rF},638:{f:cF},659:{},1048:{},1054:{f:oF},1084:{},1212:{f:vF},2048:{f:AF},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ef},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Gi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:FF,r:12},2173:{f:uL,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yF,r:12},2197:{},2198:{f:aL,r:12},2199:{},2200:{},2201:{},2202:{f:_F,r:12},2203:{f:Gi},2204:{},2205:{},2206:{},2207:{},2211:{f:JM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:is},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:LF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:RF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:n_},1:{},2:{f:HF},3:{f:zF},4:{f:$F},5:{f:i_},7:{f:VF},8:{},9:{f:Ef},11:{},22:{f:is},30:{f:lF},31:{},32:{},33:{f:u_},36:{},37:{f:a_},50:{f:qF},62:{},52:{},67:{},68:{f:is},69:{},86:{},126:{},127:{f:UF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:GF},223:{},234:{},354:{},421:{},518:{f:Cp},521:{f:Ef},536:{f:c_},547:{f:l_},561:{},579:{},1030:{f:Cp},1033:{f:Ef},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function un(t,s,e,a){var n=s;if(!isNaN(n)){var i=(e||[]).length||0,c=t.next(4);c.write_shift(2,n),c.write_shift(2,i),i>0&&G5(e)&&t.push(e)}}function __(t,s){var e=s||{},a=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),c=n.index,l=i&&i.index||t.length,u=pR(t.slice(c,l),/(:?<tr[^>]*>)/i,"<tr>"),o=-1,d=0,g=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},f=[];for(c=0;c<u.length;++c){var x=u[c].trim(),b=x.slice(0,3).toLowerCase();if(b=="<tr"){if(++o,e.sheetRows&&e.sheetRows<=o){--o;break}d=0;continue}if(!(b!="<td"&&b!="<th")){var v=x.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var _=v[l].trim();if(_.match(/<t[dh]/i)){for(var N=_,E=0;N.charAt(0)=="<"&&(E=N.indexOf(">"))>-1;)N=N.slice(E+1);for(var O=0;O<f.length;++O){var F=f[O];F.s.c==d&&F.s.r<o&&o<=F.e.r&&(d=F.e.c+1,O=-1)}var z=qt(_.slice(0,_.indexOf(">")));p=z.colspan?+z.colspan:1,((g=+z.rowspan)>1||p>1)&&f.push({s:{r:o,c:d},e:{r:o+(g||1)-1,c:d+p-1}});var P=z.t||z["data-t"]||"";if(!N.length){d+=p;continue}if(N=M5(N),h.s.r>o&&(h.s.r=o),h.e.r<o&&(h.e.r=o),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!N.length){d+=p;continue}var U={t:"s",v:N};e.raw||!N.trim().length||P=="s"||(N==="TRUE"?U={t:"b",v:!0}:N==="FALSE"?U={t:"b",v:!1}:isNaN(mn(N))?isNaN(Jl(N).getDate())||(U={t:"d",v:bs(N)},e.cellDates||(U={t:"n",v:ta(U.v)}),U.z=e.dateNF||Kt[14]):U={t:"n",v:mn(N)}),e.dense?(a[o]||(a[o]=[]),a[o][d]=U):a[Xt({r:o,c:d})]=U,d+=p}}}}return a["!ref"]=hr(h),f.length&&(a["!merges"]=f),a}function qD(t,s,e,a){for(var n=t["!merges"]||[],i=[],c=s.s.c;c<=s.e.c;++c){for(var l=0,u=0,o=0;o<n.length;++o)if(!(n[o].s.r>e||n[o].s.c>c)&&!(n[o].e.r<e||n[o].e.c<c)){if(n[o].s.r<e||n[o].s.c<c){l=-1;break}l=n[o].e.r-n[o].s.r+1,u=n[o].e.c-n[o].s.c+1;break}if(!(l<0)){var d=Xt({r:e,c}),g=a.dense?(t[e]||[])[c]:t[d],p=g&&g.v!=null&&(g.h||xx(g.w||(xi(g),g.w)||""))||"",h={};l>1&&(h.rowspan=l),u>1&&(h.colspan=u),a.editable?p='<span contenteditable="true">'+p+"</span>":g&&(h["data-t"]=g&&g.t||"z",g.v!=null&&(h["data-v"]=g.v),g.z!=null&&(h["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+g.l.Target+'">'+p+"</a>")),h.id=(a.id||"sjs")+"-"+d,i.push(OR("td",p,h))}}var f="<tr>";return f+i.join("")+"</tr>"}var GD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',YD="</body></html>";function WD(t,s){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return io(__(e[0],s),s);var a=Ix();return e.forEach(function(n,i){Lx(a,__(n,s),"Sheet"+(i+1))}),a}function XD(t,s,e){var a=[];return a.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function KD(t,s){var e=s||{},a=e.header!=null?e.header:GD,n=e.footer!=null?e.footer:YD,i=[a],c=hc(t["!ref"]);e.dense=Array.isArray(t),i.push(XD(t,c,e));for(var l=c.s.r;l<=c.e.r;++l)i.push(qD(t,c,l,e));return i.push("</table>"+n),i.join("")}function B4(t,s,e){var a=e||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var c=typeof a.origin=="string"?Qs(a.origin):a.origin;n=c.r,i=c.c}var l=s.getElementsByTagName("tr"),u=Math.min(a.sheetRows||1e7,l.length),o={s:{r:0,c:0},e:{r:n,c:i}};if(t["!ref"]){var d=hc(t["!ref"]);o.s.r=Math.min(o.s.r,d.s.r),o.s.c=Math.min(o.s.c,d.s.c),o.e.r=Math.max(o.e.r,d.e.r),o.e.c=Math.max(o.e.c,d.e.c),n==-1&&(o.e.r=n=d.e.r+1)}var g=[],p=0,h=t["!rows"]||(t["!rows"]=[]),f=0,x=0,b=0,v=0,_=0,N=0;for(t["!cols"]||(t["!cols"]=[]);f<l.length&&x<u;++f){var E=l[f];if(w_(E)){if(a.display)continue;h[x]={hidden:!0}}var O=E.children;for(b=v=0;b<O.length;++b){var F=O[b];if(!(a.display&&w_(F))){var z=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):M5(F.innerHTML),P=F.getAttribute("data-z")||F.getAttribute("z");for(p=0;p<g.length;++p){var U=g[p];U.s.c==v+i&&U.s.r<x+n&&x+n<=U.e.r&&(v=U.e.c+1-i,p=-1)}N=+F.getAttribute("colspan")||1,((_=+F.getAttribute("rowspan")||1)>1||N>1)&&g.push({s:{r:x+n,c:v+i},e:{r:x+n+(_||1)-1,c:v+i+(N||1)-1}});var W={t:"s",v:z},Y=F.getAttribute("data-t")||F.getAttribute("t")||"";z!=null&&(z.length==0?W.t=Y||"z":a.raw||z.trim().length==0||Y=="s"||(z==="TRUE"?W={t:"b",v:!0}:z==="FALSE"?W={t:"b",v:!1}:isNaN(mn(z))?isNaN(Jl(z).getDate())||(W={t:"d",v:bs(z)},a.cellDates||(W={t:"n",v:ta(W.v)}),W.z=a.dateNF||Kt[14]):W={t:"n",v:mn(z)})),W.z===void 0&&P!=null&&(W.z=P);var q="",M=F.getElementsByTagName("A");if(M&&M.length)for(var D=0;D<M.length&&!(M[D].hasAttribute("href")&&(q=M[D].getAttribute("href"),q.charAt(0)!="#"));++D);q&&q.charAt(0)!="#"&&(W.l={Target:q}),a.dense?(t[x+n]||(t[x+n]=[]),t[x+n][v+i]=W):t[Xt({c:v+i,r:x+n})]=W,o.e.c<v+i&&(o.e.c=v+i),v+=N}}++x}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),o.e.r=Math.max(o.e.r,x-1+n),t["!ref"]=hr(o),x>=u&&(t["!fullref"]=hr((o.e.r=l.length-f+x-1+n,o))),t}function D4(t,s){var e=s||{},a=e.dense?[]:{};return B4(a,t,s)}function ZD(t,s){return io(D4(t,s),s)}function w_(t){var s="",e=QD(t);return e&&(s=e(t).getPropertyValue("display")),s||(s=t.style&&t.style.display),s==="none"}function QD(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function JD(t){var s=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=pr(s.replace(/<[^>]*>/g,""));return[e]}var N_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function U4(t,s){var e=s||{},a=bx(t),n=[],i,c,l={name:""},u="",o=0,d,g,p={},h=[],f=e.dense?[]:{},x,b,v={value:""},_="",N=0,E=[],O=-1,F=-1,z={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,U={},W=[],Y={},q=0,M=0,D=[],T=1,C=1,S=[],w={Names:[]},j={},A=["",""],L=[],I={},Z="",K=0,re=!1,G=!1,ae=0;for(Du.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Du.exec(a);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(z.e.c>=z.s.c&&z.e.r>=z.s.r?f["!ref"]=hr(z):f["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=z.e.r&&(f["!fullref"]=f["!ref"],z.e.r=e.sheetRows-1,f["!ref"]=hr(z)),W.length&&(f["!merges"]=W),D.length&&(f["!rows"]=D),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),p[d.name]=f,G=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=qt(x[0],!1),O=F=-1,z.s.r=z.s.c=1e7,z.e.r=z.e.c=0,f=e.dense?[]:{},W=[],D=[],G=!0);break;case"table-row-group":x[1]==="/"?--P:++P;break;case"table-row":case"":if(x[1]==="/"){O+=T,T=1;break}if(g=qt(x[0],!1),g.?O=g.-1:O==-1&&(O=0),T=+g["number-rows-repeated"]||1,T<10)for(ae=0;ae<T;++ae)P>0&&(D[O+ae]={level:P});F=-1;break;case"covered-table-cell":x[1]!=="/"&&++F,e.sheetStubs&&(e.dense?(f[O]||(f[O]=[]),f[O][F]={t:"z"}):f[Xt({r:O,c:F})]={t:"z"}),_="",E=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++F,v=qt(x[0],!1),C=parseInt(v["number-columns-repeated"]||"1",10),b={t:"z",v:null},v.formula&&e.cellFormula!=!1&&(b.f=x_(pr(v.formula))),(v.||v["value-type"])=="string"&&(b.t="s",b.v=pr(v["string-value"]||""),e.dense?(f[O]||(f[O]=[]),f[O][F]=b):f[Xt({r:O,c:F})]=b),F+=C-1;else if(x[1]!=="/"){++F,_="",N=0,E=[],C=1;var V=T?O+T-1:O;if(F>z.e.c&&(z.e.c=F),F<z.s.c&&(z.s.c=F),O<z.s.r&&(z.s.r=O),V>z.e.r&&(z.e.r=V),v=qt(x[0],!1),L=[],I={},b={t:v.||v["value-type"],v:null},e.cellFormula)if(v.formula&&(v.formula=pr(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(q=parseInt(v["number-matrix-rows-spanned"],10)||0,M=parseInt(v["number-matrix-columns-spanned"],10)||0,Y={s:{r:O,c:F},e:{r:O+q-1,c:F+M-1}},b.F=hr(Y),S.push([Y,b.F])),v.formula)b.f=x_(v.formula);else for(ae=0;ae<S.length;++ae)O>=S[ae][0].s.r&&O<=S[ae][0].e.r&&F>=S[ae][0].s.c&&F<=S[ae][0].e.c&&(b.F=S[ae][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(q=parseInt(v["number-rows-spanned"],10)||0,M=parseInt(v["number-columns-spanned"],10)||0,Y={s:{r:O,c:F},e:{r:O+q-1,c:F+M-1}},W.push(Y)),v["number-columns-repeated"]&&(C=parseInt(v["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=Fr(v["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(v.value);break;case"percentage":b.t="n",b.v=parseFloat(v.value);break;case"currency":b.t="n",b.v=parseFloat(v.value);break;case"date":b.t="d",b.v=bs(v["date-value"]),e.cellDates||(b.t="n",b.v=ta(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=fR(v["time-value"])/86400,e.cellDates&&(b.t="d",b.v=X0(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(v.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",v["string-value"]!=null&&(_=pr(v["string-value"]),E=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(re=!1,b.t==="s"&&(b.v=_||"",E.length&&(b.R=E),re=N==0),j.Target&&(b.l=j),L.length>0&&(b.c=L,L=[]),_&&e.cellText!==!1&&(b.w=_),re&&(b.t="z",delete b.v),(!re||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=O))for(var H=0;H<T;++H){if(C=parseInt(v["number-columns-repeated"]||"1",10),e.dense)for(f[O+H]||(f[O+H]=[]),f[O+H][F]=H==0?b:Es(b);--C>0;)f[O+H][F+C]=Es(b);else for(f[Xt({r:O+H,c:F})]=b;--C>0;)f[Xt({r:O+H,c:F+C})]=Es(b);z.e.c<=F&&(z.e.c=F)}C=parseInt(v["number-columns-repeated"]||"1",10),F+=C-1,C=0,b={},_="",E=[]}j={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i;I.t=_,E.length&&(I.R=E),I.a=Z,L.push(I)}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);Z="",K=0,_="",N=0,E=[];break;case"creator":x[1]==="/"?Z=a.slice(K,x.index):K=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);_="",N=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(U[l.name]=u,(i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(u="",l=qt(x[0],!1),n.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":c=qt(x[0],!1),u+=N_[x[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":c=qt(x[0],!1),u+=N_[x[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(o,x.index);break}else o=x.index+x[0].length;break;case"named-range":c=qt(x[0],!1),A=Ep(c["cell-range-address"]);var Q={Name:c.name,Ref:A[0]+"!"+A[1]};G&&(Q.Sheet=h.length),w.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(x[1]==="/"&&(!v||!v["string-value"])){var oe=JD(a.slice(N,x.index));_=(_.length>0?_+`
`:"")+oe[0]}else qt(x[0],!1),N=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{A=Ep(qt(x[0])["target-range-address"]),p[A[0]]["!autofilter"]={ref:A[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(j=qt(x[0],!1),!j.href)break;j.Target=pr(j.href),delete j.href,j.Target.charAt(0)=="#"&&j.Target.indexOf(".")>-1?(A=Ep(j.Target.slice(1)),j.Target="#"+A[0]+"!"+A[1]):j.Target.match(/^\.\.[\\\/]/)&&(j.Target=j.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(x)}}var se={Sheets:p,SheetNames:h,Workbook:w};return e.bookSheets&&delete se.Sheets,se}function j_(t,s){s=s||{},Ga(t,"META-INF/manifest.xml")&&pM(ns(t,"META-INF/manifest.xml"),s);var e=ja(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var a=U4(Or(e),s);return Ga(t,"meta.xml")&&(a.Props=J5(ns(t,"meta.xml"))),a}function S_(t,s){return U4(t,s)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ox(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ug(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Or(rl(t))}function dg(t){var s=t.reduce(function(n,i){return n+i.length},0),e=new Uint8Array(s),a=0;return t.forEach(function(n){e.set(n,a),a+=n.length}),e}function k_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function eU(t,s){for(var e=(t[s+15]&127)<<7|t[s+14]>>1,a=t[s+14]&1,n=s+13;n>=s;--n)a=a*256+t[n];return(t[s+15]&128?-a:a)*Math.pow(10,e-6176)}function Hu(t,s){var e=s?s[0]:0,a=t[e]&127;e:if(t[e++]>=128&&(a|=(t[e]&127)<<7,t[e++]<128||(a|=(t[e]&127)<<14,t[e++]<128)||(a|=(t[e]&127)<<21,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return s&&(s[0]=e),a}function hs(t){var s=0,e=t[s]&127;e:if(t[s++]>=128){if(e|=(t[s]&127)<<7,t[s++]<128||(e|=(t[s]&127)<<14,t[s++]<128)||(e|=(t[s]&127)<<21,t[s++]<128))break e;e|=(t[s]&127)<<28}return e}function Us(t){for(var s=[],e=[0];e[0]<t.length;){var a=e[0],n=Hu(t,e),i=n&7;n=Math.floor(n/8);var c=0,l;if(n==0)break;switch(i){case 0:{for(var u=e[0];t[e[0]++]>=128;);l=t.slice(u,e[0])}break;case 5:c=4,l=t.slice(e[0],e[0]+c),e[0]+=c;break;case 1:c=8,l=t.slice(e[0],e[0]+c),e[0]+=c;break;case 2:c=Hu(t,e),l=t.slice(e[0],e[0]+c),e[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var o={data:l,type:i};s[n]==null?s[n]=[o]:s[n].push(o)}return s}function Rx(t,s){return(t==null?void 0:t.map(function(e){return s(e.data)}))||[]}function tU(t){for(var s,e=[],a=[0];a[0]<t.length;){var n=Hu(t,a),i=Us(t.slice(a[0],a[0]+n));a[0]+=n;var c={id:hs(i[1][0].data),messages:[]};i[2].forEach(function(l){var u=Us(l.data),o=hs(u[3][0].data);c.messages.push({meta:u,data:t.slice(a[0],a[0]+o)}),a[0]+=o}),(s=i[3])!=null&&s[0]&&(c.merge=hs(i[3][0].data)>>>0>0),e.push(c)}return e}function rU(t,s){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],a=Hu(s,e),n=[];e[0]<s.length;){var i=s[e[0]]&3;if(i==0){var c=s[e[0]++]>>2;if(c<60)++c;else{var l=c-59;c=s[e[0]],l>1&&(c|=s[e[0]+1]<<8),l>2&&(c|=s[e[0]+2]<<16),l>3&&(c|=s[e[0]+3]<<24),c>>>=0,c++,e[0]+=l}n.push(s.slice(e[0],e[0]+c)),e[0]+=c;continue}else{var u=0,o=0;if(i==1?(o=(s[e[0]]>>2&7)+4,u=(s[e[0]++]&224)<<3,u|=s[e[0]++]):(o=(s[e[0]++]>>2)+1,i==2?(u=s[e[0]]|s[e[0]+1]<<8,e[0]+=2):(u=(s[e[0]]|s[e[0]+1]<<8|s[e[0]+2]<<16|s[e[0]+3]<<24)>>>0,e[0]+=4)),n=[dg(n)],u==0)throw new Error("Invalid offset 0");if(u>n[0].length)throw new Error("Invalid offset beyond length");if(o>=u)for(n.push(n[0].slice(-u)),o-=u;o>=n[n.length-1].length;)n.push(n[n.length-1]),o-=n[n.length-1].length;n.push(n[0].slice(-u,-u+o))}}var d=dg(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function sU(t){for(var s=[],e=0;e<t.length;){var a=t[e++],n=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,s.push(rU(a,t.slice(e,e+n))),e+=n}if(e!==t.length)throw new Error("data is not a valid framed stream!");return dg(s)}function aU(t,s,e,a){var n=Ox(t),i=n.getUint32(4,!0),c=(a>1?12:8)+k_(i&(a>1?3470:398))*4,l=-1,u=-1,o=NaN,d=new Date(2001,0,1);i&512&&(l=n.getUint32(c,!0),c+=4),c+=k_(i&(a>1?12288:4096))*4,i&16&&(u=n.getUint32(c,!0),c+=4),i&32&&(o=n.getFloat64(c,!0),c+=8),i&64&&(d.setTime(d.getTime()+n.getFloat64(c,!0)*1e3),c+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:o};break;case 3:g={t:"s",v:s[u]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:o>0};break;case 7:g={t:"n",v:o/86400};break;case 8:g={t:"e",v:0};break;case 9:if(l>-1)g={t:"s",v:e[l]};else if(u>-1)g={t:"s",v:s[u]};else if(!isNaN(o))g={t:"n",v:o};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function nU(t,s,e){var a=Ox(t),n=a.getUint32(8,!0),i=12,c=-1,l=-1,u=NaN,o=NaN,d=new Date(2001,0,1);n&1&&(u=eU(t,i),i+=16),n&2&&(o=a.getFloat64(i,!0),i+=8),n&4&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(l=a.getUint32(i,!0),i+=4),n&16&&(c=a.getUint32(i,!0),i+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:s[l]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:o>0};break;case 7:g={t:"n",v:o/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:e[c]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return g}function iU(t,s,e){switch(t[0]){case 0:case 1:case 2:case 3:return aU(t,s,e,t[0]);case 5:return nU(t,s,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Qi(t){var s=Us(t);return Hu(s[1][0].data)}function C_(t,s){var e=Us(s.data),a=hs(e[1][0].data),n=e[3],i=[];return(n||[]).forEach(function(c){var l=Us(c.data),u=hs(l[1][0].data)>>>0;switch(a){case 1:i[u]=ug(l[3][0].data);break;case 8:{var o=t[Qi(l[9][0].data)][0],d=Us(o.data),g=t[Qi(d[1][0].data)][0],p=hs(g.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=Us(g.data);i[u]=h[3].map(function(f){return ug(f.data)}).join("")}break}}),i}function oU(t,s){var e,a,n,i,c,l,u,o,d,g,p,h,f,x,b=Us(t),v=hs(b[1][0].data)>>>0,_=hs(b[2][0].data)>>>0,N=((a=(e=b[8])==null?void 0:e[0])==null?void 0:a.data)&&hs(b[8][0].data)>0||!1,E,O;if((i=(n=b[7])==null?void 0:n[0])!=null&&i.data&&s!=0)E=(l=(c=b[7])==null?void 0:c[0])==null?void 0:l.data,O=(o=(u=b[6])==null?void 0:u[0])==null?void 0:o.data;else if((g=(d=b[4])==null?void 0:d[0])!=null&&g.data&&s!=1)E=(h=(p=b[4])==null?void 0:p[0])==null?void 0:h.data,O=(x=(f=b[3])==null?void 0:f[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(s," cell storage");for(var F=N?4:1,z=Ox(E),P=[],U=0;U<E.length/2;++U){var W=z.getUint16(U*2,!0);W<65535&&P.push([U,W])}if(P.length!=_)throw"Expected ".concat(_," cells, found ").concat(P.length);var Y=[];for(U=0;U<P.length-1;++U)Y[P[U][0]]=O.subarray(P[U][1]*F,P[U+1][1]*F);return P.length>=1&&(Y[P[P.length-1][0]]=O.subarray(P[P.length-1][1]*F)),{R:v,cells:Y}}function lU(t,s){var e,a=Us(s.data),n=(e=a==null?void 0:a[7])!=null&&e[0]?hs(a[7][0].data)>>>0>0?1:0:-1,i=Rx(a[5],function(c){return oU(c,n)});return{nrows:hs(a[4][0].data)>>>0,data:i.reduce(function(c,l){return c[l.R]||(c[l.R]=[]),l.cells.forEach(function(u,o){if(c[l.R][o])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(o));c[l.R][o]=u}),c},[])}}function cU(t,s,e){var a,n=Us(s.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(hs(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(hs(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));e["!ref"]=hr(i);var c=Us(n[4][0].data),l=C_(t,t[Qi(c[4][0].data)][0]),u=(a=c[17])!=null&&a[0]?C_(t,t[Qi(c[17][0].data)][0]):[],o=Us(c[3][0].data),d=0;o[1].forEach(function(g){var p=Us(g.data),h=t[Qi(p[2][0].data)][0],f=hs(h.meta[1][0].data);if(f!=6002)throw new Error("6001 unexpected reference to ".concat(f));var x=lU(t,h);x.data.forEach(function(b,v){b.forEach(function(_,N){var E=Xt({r:d+v,c:N}),O=iU(_,l,u);O&&(e[E]=O)})}),d+=x.nrows})}function uU(t,s){var e=Us(s.data),a={"!ref":"A1"},n=t[Qi(e[2][0].data)],i=hs(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return cU(t,n[0],a),a}function dU(t,s){var e,a=Us(s.data),n={name:(e=a[1])!=null&&e[0]?ug(a[1][0].data):"",sheets:[]},i=Rx(a[2],Qi);return i.forEach(function(c){t[c].forEach(function(l){var u=hs(l.meta[1][0].data);u==6e3&&n.sheets.push(uU(t,l))})}),n}function fU(t,s){var e=Ix(),a=Us(s.data),n=Rx(a[1],Qi);if(n.forEach(function(i){t[i].forEach(function(c){var l=hs(c.meta[1][0].data);if(l==2){var u=dU(t,c);u.sheets.forEach(function(o,d){Lx(e,o,d==0?u.name:u.name+"_"+d,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function Ap(t){var s,e,a,n,i={},c=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var o;try{o=sU(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var d;try{d=tU(o)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){i[g.id]=g.messages,c.push(g.id)})}}),!c.length)throw new Error("File has no messages");var l=((n=(a=(e=(s=i==null?void 0:i[1])==null?void 0:s[0])==null?void 0:e.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&hs(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||c.forEach(function(u){i[u].forEach(function(o){var d=hs(o.meta[1][0].data)>>>0;if(d==1)if(!l)l=o;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return fU(i,l)}function hU(t){return function(e){for(var a=0;a!=t.length;++a){var n=t[a];e[n[0]]===void 0&&(e[n[0]]=n[1]),n[2]==="n"&&(e[n[0]]=Number(e[n[0]]))}}}function Mx(t){hU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function mU(t){return Pl.WS.indexOf(t)>-1?"sheet":t==Pl.CS?"chart":t==Pl.DS?"dialog":t==Pl.MS?"macro":t&&t.length?t:"sheet"}function pU(t,s){if(!t)return 0;try{t=s.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,mU(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function gU(t,s,e,a,n,i,c,l,u,o,d,g){try{i[a]=Cu(ja(t,e,!0),s);var p=ns(t,s),h;switch(l){case"sheet":h=wD(p,s,n,u,i[a],o,d,g);break;case"chart":if(h=ND(p,s,n,u,i[a],o,d,g),!h||!h["!drawel"])break;var f=yu(h["!drawel"].Target,s),x=ng(f),b=_L(ja(t,f,!0),Cu(ja(t,x,!0),f)),v=yu(b,f),_=ng(v);h=nD(ja(t,v,!0),v,u,Cu(ja(t,_,!0),v),o,h);break;case"macro":h=jD(p,s,n,u,i[a],o,d,g);break;case"dialog":h=SD(p,s,n,u,i[a],o,d,g);break;default:throw new Error("Unrecognized sheet type "+l)}c[a]=h;var N=[];i&&i[a]&&zn(i[a]).forEach(function(E){var O="";if(i[a][E].Type==Pl.CMNT){O=yu(i[a][E].Target,s);var F=TD(ns(t,O,!0),O,u);if(!F||!F.length)return;f_(h,F,!1)}i[a][E].Type==Pl.TCMNT&&(O=yu(i[a][E].Target,s),N=N.concat(NL(ns(t,O,!0),u)))}),N&&N.length&&f_(h,N,!0,u.people||[])}catch(E){if(u.WTF)throw E}}function Va(t){return t.charAt(0)=="/"?t.slice(1):t}function xU(t,s){if(j5(),s=s||{},Mx(s),Ga(t,"META-INF/manifest.xml")||Ga(t,"objectdata.xml"))return j_(t,s);if(Ga(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ap<"u"){if(t.FileIndex)return Ap(t);var e=fr.utils.cfb_new();return D2(t).forEach(function(D){bR(e,D,xR(t,D))}),Ap(e)}throw new Error("Unsupported NUMBERS file")}if(!Ga(t,"[Content_Types].xml"))throw Ga(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ga(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=D2(t),n=hM(ja(t,"[Content_Types].xml")),i=!1,c,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",ns(t,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!ns(t,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},o={};if(!s.bookSheets&&!s.bookProps){if(Au=[],n.sst)try{Au=ED(ns(t,Va(n.sst)),n.sst,s)}catch(D){if(s.WTF)throw D}s.cellStyles&&n.themes.length&&(u=CD(ja(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],s)),n.style&&(o=kD(ns(t,Va(n.style)),n.style,u,s))}n.links.map(function(D){try{var T=Cu(ja(t,ng(Va(D))),D);return OD(ns(t,Va(D)),T,D,s)}catch{}});var d=_D(ns(t,Va(n.workbooks[0])),n.workbooks[0],s),g={},p="";n.coreprops.length&&(p=ns(t,Va(n.coreprops[0]),!0),p&&(g=J5(p)),n.extprops.length!==0&&(p=ns(t,Va(n.extprops[0]),!0),p&&bM(p,g,s)));var h={};(!s.bookSheets||s.bookProps)&&n.custprops.length!==0&&(p=ja(t,Va(n.custprops[0]),!0),p&&(h=vM(p,s)));var f={};if((s.bookSheets||s.bookProps)&&(d.Sheets?c=d.Sheets.map(function(T){return T.name}):g.Worksheets&&g.SheetNames.length>0&&(c=g.SheetNames),s.bookProps&&(f.Props=g,f.Custprops=h),s.bookSheets&&typeof c<"u"&&(f.SheetNames=c),s.bookSheets?f.SheetNames:s.bookProps))return f;c={};var x={};s.bookDeps&&n.calcchain&&(x=AD(ns(t,Va(n.calcchain)),n.calcchain));var b=0,v={},_,N;{var E=d.Sheets;g.Worksheets=E.length,g.SheetNames=[];for(var O=0;O!=E.length;++O)g.SheetNames[O]=E[O].name}var F=i?"bin":"xml",z=n.workbooks[0].lastIndexOf("/"),P=(n.workbooks[0].slice(0,z+1)+"_rels/"+n.workbooks[0].slice(z+1)+".rels").replace(/^\//,"");Ga(t,P)||(P="xl/_rels/workbook."+F+".rels");var U=Cu(ja(t,P,!0),P.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(s.xlmeta=RD(ns(t,Va(n.metadata[0])),n.metadata[0],s)),(n.people||[]).length>=1&&(s.people=jL(ns(t,Va(n.people[0])),s)),U&&(U=pU(U,d.Sheets));var W=ns(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=g.Worksheets;++b){var Y="sheet";if(U&&U[b]?(_="xl/"+U[b][1].replace(/[\/]?xl\//,""),Ga(t,_)||(_=U[b][1]),Ga(t,_)||(_=P.replace(/_rels\/.*$/,"")+U[b][1]),Y=U[b][2]):(_="xl/worksheets/sheet"+(b+1-W)+"."+F,_=_.replace(/sheet0\./,"sheet.")),N=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),s&&s.sheets!=null)switch(typeof s.sheets){case"number":if(b!=s.sheets)continue e;break;case"string":if(g.SheetNames[b].toLowerCase()!=s.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(s.sheets)){for(var q=!1,M=0;M!=s.sheets.length;++M)typeof s.sheets[M]=="number"&&s.sheets[M]==b&&(q=1),typeof s.sheets[M]=="string"&&s.sheets[M].toLowerCase()==g.SheetNames[b].toLowerCase()&&(q=1);if(!q)continue e}}gU(t,_,N,g.SheetNames[b],b,v,c,Y,s,d,u,o)}return f={Directory:n,Workbook:d,Props:g,Custprops:h,Deps:x,Sheets:c,SheetNames:g.SheetNames,Strings:Au,Styles:o,Themes:u,SSF:Es(Kt)},s&&s.bookFiles&&(t.files?(f.keys=a,f.files=t.files):(f.keys=[],f.files={},t.FullPaths.forEach(function(D,T){D=D.replace(/^Root Entry[\/]/,""),f.keys.push(D),f.files[D]=t.FileIndex[T]}))),s&&s.bookVBA&&(n.vba.length>0?f.vbaraw=ns(t,Va(n.vba[0]),!0):n.defaults&&n.defaults.bin===EL&&(f.vbaraw=ns(t,"xl/vbaProject.bin",!0))),f}function bU(t,s){var e=s||{},a="Workbook",n=fr.find(t,a);try{if(a="/!DataSpaces/Version",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(uI(n.content),a="/!DataSpaces/DataSpaceMap",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=fI(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=hI(n.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);pI(n.content)}catch{}if(a="/EncryptionInfo",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=gI(n.content);if(a="/EncryptedPackage",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,e.password||"",e);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,e.password||"",e);throw new Error("File is password-protected")}function Fx(t,s){var e="";switch((s||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Ta(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(s&&s.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function yU(t,s){return fr.find(t,"EncryptedPackage")?bU(t,s):P4(t,s)}function vU(t,s){var e,a=t,n=s||{};return n.type||(n.type=cr&&Buffer.isBuffer(t)?"buffer":"base64"),e=A5(a,n),xU(e,n)}function $4(t,s){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return lg(t.slice(e),s);default:break e}return Uu.to_workbook(t,s)}function _U(t,s){var e="",a=Fx(t,s);switch(s.type){case"base64":e=Ta(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=Go(t);break;default:throw new Error("Unrecognized type "+s.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(e=Or(e)),s.type="binary",$4(e,s)}function wU(t,s){var e=t;return s.type=="base64"&&(e=Ta(e)),e=rg.utils.decode(1200,e.slice(2),"str"),s.type="binary",$4(e,s)}function NU(t){return t.match(/[^\x00-\x7F]/)?vu(t):t}function Op(t,s,e,a){return a?(e.type="string",Uu.to_workbook(t,e)):Uu.to_workbook(s,e)}function so(t,s){f5();var e=s||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return so(new Uint8Array(t),(e=Es(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],i=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Hl={},e.dateNF&&(Hl.dateNF=e.dateNF),e.type||(e.type=cr&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=cr?"buffer":"binary",a=uR(t),typeof Uint8Array<"u"&&!cr&&(e.type="array")),e.type=="string"&&(i=!0,e.type="binary",e.codepage=65001,a=NU(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),l=new Uint8Array(c);if(l.foo="bar",!l.foo)return e=Es(e),e.type="array",so(fx(a),e)}switch((n=Fx(a,e))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return yU(fr.read(a,e),e);break;case 9:if(n[1]<=8)return P4(a,e);break;case 60:return lg(a,e);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return ZF(a,e);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return XF.to_workbook(a,e);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?vU(a,e):Op(t,a,e,i);case 239:return n[3]===60?lg(a,e):Op(t,a,e,i);case 255:if(n[1]===254)return wU(a,e);if(n[1]===0&&n[2]===2&&n[3]===0)return Tu.to_workbook(a,e);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Tu.to_workbook(a,e);break;case 3:case 131:case 139:case 140:return d_.to_workbook(a,e);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return EI.to_workbook(a,e);break;case 10:case 13:case 32:return _U(a,e);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return YF.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?d_.to_workbook(a,e):Op(t,a,e,i)}function jU(t,s,e,a,n,i,c,l){var u=Ts(e),o=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),g=!0,p=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:e,enumerable:!1})}catch{p.__rowNum__=e}else p.__rowNum__=e;if(!c||t[e])for(var h=s.s.c;h<=s.e.c;++h){var f=c?t[e][h]:t[a[h]+u];if(f===void 0||f.t===void 0){if(o===void 0)continue;i[h]!=null&&(p[i[h]]=o);continue}var x=f.v;switch(f.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+f.t)}if(i[h]!=null){if(x==null)if(f.t=="e"&&x===null)p[i[h]]=null;else if(o!==void 0)p[i[h]]=o;else if(d&&x===null)p[i[h]]=null;else continue;else p[i[h]]=d&&(f.t!=="n"||f.t==="n"&&l.rawNumbers!==!1)?x:xi(f,x,l);x!=null&&(g=!1)}}return{row:p,isempty:g}}function fg(t,s){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},a=0,n=1,i=[],c=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},o=s||{},d=o.range!=null?o.range:t["!ref"];switch(o.header===1?a=1:o.header==="A"?a=2:Array.isArray(o.header)?a=3:o.header==null&&(a=0),typeof d){case"string":u=Gr(d);break;case"number":u=Gr(t["!ref"]),u.s.r=d;break;default:u=d}a>0&&(n=0);var g=Ts(u.s.r),p=[],h=[],f=0,x=0,b=Array.isArray(t),v=u.s.r,_=0,N={};b&&!t[v]&&(t[v]=[]);var E=o.skipHidden&&t["!cols"]||[],O=o.skipHidden&&t["!rows"]||[];for(_=u.s.c;_<=u.e.c;++_)if(!(E[_]||{}).hidden)switch(p[_]=fs(_),e=b?t[v][_]:t[p[_]+g],a){case 1:i[_]=_-u.s.c;break;case 2:i[_]=p[_];break;case 3:i[_]=o.header[_-u.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=c=xi(e,null,o),x=N[c]||0,!x)N[c]=1;else{do l=c+"_"+x++;while(N[l]);N[c]=x,N[l]=1}i[_]=l}for(v=u.s.r+n;v<=u.e.r;++v)if(!(O[v]||{}).hidden){var F=jU(t,u,v,p,a,i,b,o);(F.isempty===!1||(a===1?o.blankrows!==!1:o.blankrows))&&(h[f++]=F.row)}return h.length=f,h}var E_=/"/g;function SU(t,s,e,a,n,i,c,l){for(var u=!0,o=[],d="",g=Ts(e),p=s.s.c;p<=s.e.c;++p)if(a[p]){var h=l.dense?(t[e]||[])[p]:t[a[p]+g];if(h==null)d="";else if(h.v!=null){u=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:xi(h,null,l));for(var f=0,x=0;f!==d.length;++f)if((x=d.charCodeAt(f))===n||x===i||x===34||l.forceQuotes){d='"'+d.replace(E_,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(u=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(E_,'""')+'"')):d="";o.push(d)}return l.blankrows===!1&&u?null:o.join(c)}function z4(t,s){var e=[],a=s??{};if(t==null||t["!ref"]==null)return"";var n=Gr(t["!ref"]),i=a.FS!==void 0?a.FS:",",c=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,u=l.charCodeAt(0),o=new RegExp((i=="|"?"\\|":i)+"+$"),d="",g=[];a.dense=Array.isArray(t);for(var p=a.skipHidden&&t["!cols"]||[],h=a.skipHidden&&t["!rows"]||[],f=n.s.c;f<=n.e.c;++f)(p[f]||{}).hidden||(g[f]=fs(f));for(var x=0,b=n.s.r;b<=n.e.r;++b)(h[b]||{}).hidden||(d=SU(t,n,b,g,c,u,i,a),d!=null&&(a.strip&&(d=d.replace(o,"")),(d||a.blankrows!==!1)&&e.push((x++?l:"")+d)));return delete a.dense,e.join("")}function kU(t,s){s||(s={}),s.FS="	",s.RS=`
`;var e=z4(t,s);return e}function CU(t){var s="",e,a="";if(t==null||t["!ref"]==null)return[];var n=Gr(t["!ref"]),i="",c=[],l,u=[],o=Array.isArray(t);for(l=n.s.c;l<=n.e.c;++l)c[l]=fs(l);for(var d=n.s.r;d<=n.e.r;++d)for(i=Ts(d),l=n.s.c;l<=n.e.c;++l)if(s=c[l]+i,e=o?(t[d]||[])[l]:t[s],a="",e!==void 0){if(e.F!=null){if(s=e.F,!e.f)continue;a=e.f,s.indexOf(":")==-1&&(s=s+":"+s)}if(e.f!=null)a=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)a=""+e.v;else if(e.t=="b")a=e.v?"TRUE":"FALSE";else if(e.w!==void 0)a="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?a="'"+e.v:a=""+e.v}}u[u.length]=s+"="+a}return u}function H4(t,s,e){var a=e||{},n=+!a.skipHeader,i=t||{},c=0,l=0;if(i&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var u=typeof a.origin=="string"?Qs(a.origin):a.origin;c=u.r,l=u.c}var o,d={s:{c:0,r:0},e:{c:l,r:c+s.length-1+n}};if(i["!ref"]){var g=Gr(i["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),c==-1&&(c=g.e.r+1,d.e.r=c+s.length-1+n)}else c==-1&&(c=0,d.e.r=s.length-1+n);var p=a.header||[],h=0;s.forEach(function(x,b){zn(x).forEach(function(v){(h=p.indexOf(v))==-1&&(p[h=p.length]=v);var _=x[v],N="z",E="",O=Xt({c:l+h,r:c+b+n});o=Vu(i,O),_&&typeof _=="object"&&!(_ instanceof Date)?i[O]=_:(typeof _=="number"?N="n":typeof _=="boolean"?N="b":typeof _=="string"?N="s":_ instanceof Date?(N="d",a.cellDates||(N="n",_=ta(_)),E=a.dateNF||Kt[14]):_===null&&a.nullError&&(N="e",_=0),o?(o.t=N,o.v=_,delete o.w,delete o.R,E&&(o.z=E)):i[O]=o={t:N,v:_},E&&(o.z=E))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var f=Ts(c);if(n)for(h=0;h<p.length;++h)i[fs(h+l)+f]={t:"s",v:p[h]};return i["!ref"]=hr(d),i}function EU(t,s){return H4(null,t,s)}function Vu(t,s,e){if(typeof s=="string"){if(Array.isArray(t)){var a=Qs(s);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[s]||(t[s]={t:"z"})}return typeof s!="number"?Vu(t,Xt(s)):Vu(t,Xt({r:s,c:e||0}))}function TU(t,s){if(typeof s=="number"){if(s>=0&&t.SheetNames.length>s)return s;throw new Error("Cannot find sheet # "+s)}else if(typeof s=="string"){var e=t.SheetNames.indexOf(s);if(e>-1)return e;throw new Error("Cannot find sheet name |"+s+"|")}else throw new Error("Cannot find sheet |"+s+"|")}function Ix(){return{SheetNames:[],Sheets:{}}}function Lx(t,s,e,a){var n=1;if(!e)for(;n<=65535&&t.SheetNames.indexOf(e="Sheet"+n)!=-1;++n,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(e)>=0){var i=e.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var c=i&&i[1]||e;for(++n;n<=65535&&t.SheetNames.indexOf(e=c+n)!=-1;++n);}if(hD(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=s,e}function AU(t,s,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=TU(t,s);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[a].Hidden=e}function OU(t,s){return t.z=s,t}function V4(t,s,e){return s?(t.l={Target:s},e&&(t.l.Tooltip=e)):delete t.l,t}function RU(t,s,e){return V4(t,"#"+s,e)}function MU(t,s,e){t.c||(t.c=[]),t.c.push({t:s,a:e||"SheetJS"})}function FU(t,s,e,a){for(var n=typeof s!="string"?s:Gr(s),i=typeof s=="string"?s:hr(s),c=n.s.r;c<=n.e.r;++c)for(var l=n.s.c;l<=n.e.c;++l){var u=Vu(t,c,l);u.t="n",u.F=i,delete u.v,c==n.s.r&&l==n.s.c&&(u.f=e,a&&(u.D=!0))}return t}var Wo={encode_col:fs,encode_row:Ts,encode_cell:Xt,encode_range:hr,decode_col:_x,decode_row:vx,split_cell:GR,decode_cell:Qs,decode_range:hc,format_cell:xi,sheet_add_aoa:W5,sheet_add_json:H4,sheet_add_dom:B4,aoa_to_sheet:mc,json_to_sheet:EU,table_to_sheet:D4,table_to_book:ZD,sheet_to_csv:z4,sheet_to_txt:kU,sheet_to_json:fg,sheet_to_html:KD,sheet_to_formulae:CU,sheet_to_row_object_array:fg,sheet_get_cell:Vu,book_new:Ix,book_append_sheet:Lx,book_set_sheet_visibility:AU,cell_set_number_format:OU,cell_set_hyperlink:V4,cell_set_internal_link:RU,cell_add_comment:MU,sheet_set_array_formula:FU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const q4=({progress:t=0,mode:s="spinner",theme:e="ched",showPercentage:a=!0,isVisible:n=!0,onComplete:i=()=>{}})=>{const[c,l]=ne.useState(0),[u,o]=ne.useState(!1);if(ne.useEffect(()=>{if(s==="progress"&&!u){const v=(t-c)/10;if(Math.abs(t-c)<.5){l(t);return}const _=setTimeout(()=>{l(N=>{const E=N+v;return Math.round(E*10)/10})},30);return()=>clearTimeout(_)}},[t,c,s,u]),ne.useEffect(()=>{if(t>=100&&!u){o(!0);const f=setTimeout(()=>{i()},800);return()=>clearTimeout(f)}},[t,i,u]),!n)return null;const d={premium:{background:"from-gray-50 to-gray-100",progressBg:"bg-gray-200",progressFill:"from-blue-400 to-blue-600",textColor:"text-gray-600",headingColor:"text-gray-800",accentColor:"text-blue-600",circleColor:"border-blue-500",particles:"#4285F4",logoGlow:"0 0 15px rgba(66, 133, 244, 0.5)",secondaryColor:"from-blue-500 to-indigo-600"},executive:{background:"from-gray-50 to-gray-200",progressBg:"bg-gray-300",progressFill:"from-indigo-500 to-indigo-700",textColor:"text-gray-600",headingColor:"text-gray-800",accentColor:"text-indigo-700",circleColor:"border-indigo-600",particles:"#4B0082",logoGlow:"0 0 15px rgba(79, 70, 229, 0.5)",secondaryColor:"from-indigo-500 to-purple-600"},ched:{background:"from-blue-50 to-white",progressBg:"bg-gray-200",progressFill:"from-blue-600 to-blue-800",textColor:"text-gray-700",headingColor:"text-blue-800",accentColor:"text-blue-700",circleColor:"border-blue-700",particles:"#00274C",logoGlow:"0 0 20px rgba(30, 64, 175, 0.45)",secondaryColor:"from-blue-700 to-blue-900"},nightMode:{background:"from-gray-900 to-gray-800",progressBg:"bg-gray-700",progressFill:"from-blue-400 to-blue-600",textColor:"text-gray-300",headingColor:"text-white",accentColor:"text-blue-400",circleColor:"border-blue-500",particles:"#3B82F6",logoGlow:"0 0 20px rgba(59, 130, 246, 0.6)",secondaryColor:"from-blue-400 to-indigo-500"}},g=d[e]||d.ched,p=s==="progress",h=Math.round(c);return r.jsxs("div",{className:"fixed inset-0 w-screen h-screen flex flex-col justify-center items-center z-50 transition-all duration-300 overflow-hidden backdrop-blur-3xl",children:[r.jsxs("div",{className:"flex flex-col items-center justify-center z-10 px-4 transition-all duration-700",children:[r.jsxs("div",{className:"relative mb-10 w-44 h-44",children:[r.jsx("div",{className:`absolute inset-0 rounded-full bg-gradient-to-r ${g.secondaryColor} opacity-${h<30?"20":h<60?"30":"40"} blur-xl transition-all duration-700`,style:{transform:`scale(${1+h/200})`}}),r.jsx("div",{className:`absolute w-full h-full rounded-full border-2 ${g.circleColor} border-dashed opacity-40`,style:{animation:`spin ${15-h/20}s linear infinite`}}),r.jsx("div",{className:`absolute w-full h-full rounded-full border-2 ${g.circleColor} border-dotted opacity-30`,style:{animation:`spin-reverse ${12-h/20}s linear infinite`,transform:"scale(0.85)"}}),r.jsx("div",{className:"absolute inset-6 flex items-center justify-center bg-gradient-to-b from-blue-800 to-blue-900 rounded-full shadow-lg overflow-hidden transition-all duration-500",style:{boxShadow:g.logoGlow,transform:`scale(${u?1.05:1})`},children:r.jsxs("div",{className:"relative overflow-hidden rounded-full w-full h-full flex items-center justify-center",children:[r.jsx("div",{className:"absolute w-[200%] h-[200%] bg-white opacity-20 transform -rotate-45",style:{top:"-150%",left:"-150%",animation:"shine 3s ease-in-out infinite",animationDelay:"1s"}}),r.jsx("img",{src:z0,alt:"CHED Logo",className:"w-32 h-32 object-contain filter drop-shadow-lg z-10 transition-transform duration-500",style:{transform:`scale(${u?1.1:1})`},loading:"eager"})]})})]}),r.jsxs("div",{className:"text-center",children:[s==="progress"&&r.jsxs("p",{className:`text-sm mb-5 ${g.textColor} opacity-90`,children:["Please wait a moment",r.jsxs("span",{className:"typing-dots",children:[r.jsx("span",{className:"dot"}),r.jsx("span",{className:"dot"}),r.jsx("span",{className:"dot"})]})]}),s==="spinner"&&r.jsxs("p",{className:`text-sm mb-5 ${g.textColor} opacity-90`,children:["Please wait a moment",r.jsxs("span",{className:"typing-dots",children:[r.jsx("span",{className:"dot"}),r.jsx("span",{className:"dot"}),r.jsx("span",{className:"dot"})]})]})]}),p&&r.jsx("div",{className:"flex flex-col items-center w-full mt-1",children:r.jsxs("div",{className:"relative w-64 sm:w-96",children:[r.jsx("div",{className:`relative h-2 ${g.progressBg} rounded-full mb-3 overflow-hidden`,children:r.jsx("div",{className:`absolute top-0 left-0 h-full rounded-full transition-all duration-300 ease-out bg-gradient-to-r ${g.progressFill}`,style:{width:`${c}%`},children:r.jsx("div",{className:"absolute top-0 right-0 h-full w-24 bg-gradient-to-r from-transparent via-white/30 to-transparent",style:{animation:"sweep 2s ease-in-out infinite",animationPlayState:t<100?"running":"paused"}})})}),a&&r.jsxs("div",{className:"relative w-full flex justify-center",children:[r.jsxs("p",{className:`${g.accentColor} text-lg font-bold transition-all duration-300 ${h%25===0&&h>0?"scale-110":""}`,children:[h,"%"]}),h%25===0&&h>0&&r.jsx("div",{className:"absolute -top-1 w-full flex justify-center",children:r.jsx("div",{className:"absolute w-16 h-16 rounded-full bg-current opacity-0 animate-ping-once"})})]})]})})]}),r.jsx("style",{children:`
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }

                @keyframes spin-reverse {
                    0% { transform: rotate(0deg) scale(0.85); }
                    100% { transform: rotate(-360deg) scale(0.85); }
                }

                @keyframes float {
                    0%, 100% { transform: translateY(0) translateX(0); }
                    25% { transform: translateY(-20px) translateX(10px); }
                    50% { transform: translateY(-35px) translateX(-15px); }
                    75% { transform: translateY(-15px) translateX(5px); }
                }

                @keyframes sweep {
                    0% { transform: translateX(-100%); }
                    100% { transform: translateX(100%); }
                }

                @keyframes shine {
                    0% { transform: translateY(0%) translateX(0%) rotate(-45deg); }
                    15% { transform: translateY(100%) translateX(100%) rotate(-45deg); }
                    100% { transform: translateY(100%) translateX(100%) rotate(-45deg); }
                }

                @keyframes ping-once {
                    0% { transform: scale(0.2); opacity: 1; }
                    70%, 100% { transform: scale(2); opacity: 0; }
                }

                .animate-ping-once {
                    animation: ping-once 0.8s cubic-bezier(0, 0, 0.2, 1);
                }

                .typing-dots {
                    display: inline-flex;
                    align-items: center;
                    height: 1.5em;
                    margin-left: 4px;
                }

                .typing-dots .dot {
                    display: inline-block;
                    width: 4px;
                    height: 4px;
                    border-radius: 50%;
                    background-color: currentColor;
                    margin: 0 2px;
                    animation: dotPulse 1.5s infinite ease-in-out;
                }

                .typing-dots .dot:nth-child(2) {
                    animation-delay: 0.2s;
                }

                .typing-dots .dot:nth-child(3) {
                    animation-delay: 0.4s;
                }

                @keyframes dotPulse {
                    0%, 60%, 100% { transform: scale(0.7); opacity: 0.6; }
                    30% { transform: scale(1.2); opacity: 1; }
                }
            `})]})};q4.propTypes={progress:B.number,mode:B.oneOf(["spinner","progress"]),theme:B.oneOf(["premium","executive","ched","nightMode"]),message:B.string,showPercentage:B.bool,isVisible:B.bool,onComplete:B.func};const G4=ne.createContext(),Y4=({children:t})=>{const[s,e]=ne.useState(!1),[a,n]=ne.useState(0),[i,c]=ne.useState("spinner"),l=()=>{e(!0),n(0),c("spinner")},u=()=>{e(!1),n(0),c("spinner")},o=g=>{const p=Math.max(0,Math.min(100,g));s||e(!0),n(p),c("progress"),p>=100&&setTimeout(()=>{u()},500)},d=ne.useMemo(()=>({isLoading:s,progress:a,mode:i,showLoading:l,hideLoading:u,updateProgress:o}),[s,a,i]);return r.jsxs(G4.Provider,{value:d,children:[t,s&&r.jsx(q4,{progress:a,mode:i})]})};Y4.propTypes={children:B.node.isRequired};const J0=()=>{const t=ne.useContext(G4);if(!t)throw new Error("useLoading must be used within a LoadingProvider");return t};function W4({isOpen:t,onClose:s,onUploadSuccess:e,institutionId:a}){const{showLoading:n,hideLoading:i,updateProgress:c}=J0(),[l,u]=ne.useState(!1),[o,d]=ne.useState({}),[g,p]=ne.useState(new Date().getFullYear()),h=(W,Y)=>{o[W]&&d(q=>({...q,[W]:""})),p(Y)},f=()=>{const W={};return a||(W.institution="Institution ID is required"),g||(W.year="Please select a report year"),d(W),Object.keys(W).length===0},x=W=>{if(!W||W==="N/A"||W===""||W===null||W===void 0)return null;const Y=Number.parseInt(W,10);return isNaN(Y)?null:Y},b=(W,Y,q)=>{if(W===void 0||W===""||W===null||isNaN(W))return null;const M=Number.parseFloat(W);return M<Y?null:M},v=W=>{if(W===void 0||W===""||W===null)return null;const Y=String(W).trim();return Y.length>255?Y.substring(0,255):Y},_=W=>{if(W===void 0||W===""||W===null)return!1;const Y=String(W).toLowerCase().trim();return Y==="true"||Y==="1"||Y==="yes"||Y==="y"},N={1:"ACTIVE",2:"INACTIVE",3:"SUSPENDED",4:"PHASED_OUT",ACTIVE:"ACTIVE",INACTIVE:"INACTIVE",SUSPENDED:"SUSPENDED",PHASED_OUT:"PHASED_OUT"},E={1:"SEM",2:"TRI",3:"QTR",4:"ANN",5:"MOD",SEM:"SEM",TRI:"TRI",QTR:"QTR",ANN:"ANN",MOD:"MOD"},O={Doctoral:"Doctoral",Masters:"Masters","Post-Baccalaureate":"Post-Baccalaureate",Baccalaureate:"Baccalaureate","Pre-Baccalaureate":"Pre-Baccalaureate",VocTech:"VocTech",Basic:"Basic"},F=async W=>{const Y=W.target.files[0];if(!Y)return;if(!f()){Ft.showAlert("Please ensure institution and year are properly set before uploading.","error");return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(Y.type)&&!Y.name.match(/\.(xlsx|xls|csv)$/i)){Ft.showAlert("Please upload a valid Excel file (.xlsx, .xls) or CSV file.","error");return}u(!0),n(),c(10);try{const M=await Y.arrayBuffer();c(30);const D=so(M,{cellStyles:!0,cellFormulas:!0,cellDates:!0,cellNF:!0,sheetStubs:!0,type:"array"});c(50);const T=D.SheetNames.filter(C=>["Doctoral","Masters","Post-Baccalaureate","Baccalaureate","Pre-Baccalaureate","VocTech","Basic"].includes(C)).map(C=>({name:C,type:"PROGRAM",description:`${C} Programs Data`}));if(T.length===0)if(D.SheetNames.length>0)T.push({name:D.SheetNames[0],type:"PROGRAM",description:"Academic Programs Data (Default Sheet)"});else throw new Error("No valid sheets found in the Excel file.");c(70),await z(D,T),c(100)}catch(M){console.error("Excel upload error:",M),Ft.showAlert(M.message||"Failed to process Excel file. Please try again.","error")}finally{u(!1),i(),W.target.value=""}},z=async(W,Y)=>{var C,S;const q=[],M=[],D=Y.length;let T=0;for(const w of Y)try{const j=W.Sheets[w.name],A=await P(j,w.name);q.push(...A),T++;const L=70+T/D*20;c(Math.floor(L))}catch(j){console.error(`Error processing sheet ${w.name}:`,j),M.push(`Error in ${w.name}: ${((S=(C=j.response)==null?void 0:C.data)==null?void 0:S.error)||j.message}`)}q.length>0&&(e(),d({}))},P=async(W,Y)=>{var q,M;try{const D=Wo.sheet_to_json(W,{header:1,defval:"",raw:!1});console.log(`Parsed JSON data from ${Y} sheet:`,D);let T=-1;for(let A=0;A<D.length;A++){const L=D[A];if(Array.isArray(L)&&L.join(" ").toLowerCase().includes("start below this row")){T=A;break}}if(console.log(`Start row index fetched: ${T}`),T===-1)throw new Error(`Could not find "START BELOW THIS ROW" in the ${Y} sheet.`);const C=T+1;if(C>=D.length)throw new Error(`No data rows found in the ${Y} sheet after "START BELOW THIS ROW".`);const S=D.slice(C).filter(A=>{const L=v(A[0]||A[1]);return!L||!L.trim()?(console.log(`Skipping row in ${Y} sheet: missing or empty program name`),!1):A&&A.length>0&&A.some(I=>I!==void 0&&I!=="")}).map((A,L)=>{try{return{suc_details_id:parseInt(a),program_name:v(A[1]||null),program_code:x(A[2]||null),program_type:O[Y]||v(Y)||"Unknown",major_name:v(A[3]),major_code:x(A[4]),aop_category:v(A[5]),aop_serial:v(A[6]),aop_year:x(A[7]),is_thesis_dissertation_required:_(A[8]),program_status:N[A[9]]||v(A[9])||"ACTIVE",calendar_use_code:E[A[10]]||v(A[10])||"SEM",program_normal_length_in_years:x(A[11]),lab_units:x(A[12]),lecture_units:x(A[13]),total_units:x(A[14]),tuition_per_unit:b(A[15],0),program_fee:b(A[16],0),new_students_freshmen_male:x(A[17]),new_students_freshmen_female:x(A[18]),"1st_year_male":x(A[19]),"1st_year_female":x(A[20]),"2nd_year_male":x(A[21]),"2nd_year_female":x(A[22]),"3rd_year_male":x(A[23]),"3rd_year_female":x(A[24]),"4th_year_male":x(A[25]),"4th_year_female":x(A[26]),"5th_year_male":x(A[27]),"5th_year_female":x(A[28]),"6th_year_male":x(A[29]),"6th_year_female":x(A[30]),"7th_year_male":x(A[31]),"7th_year_female":x(A[32]),subtotal_male:x(A[33]),subtotal_female:x(A[34]),grand_total:x(A[35]),lecture_units_actual:x(A[36]),laboratory_units_actual:x(A[37]),total_units_actual:x(A[38]),graduates_males:x(A[39]),graduates_females:x(A[40]),graduates_total:x(A[41]),externally_funded_merit_scholars:x(A[42]),internally_funded_grantees:x(A[43]),funded_grantees:x(A[44]),report_year:parseInt(g)}}catch(I){return console.warn(`Error processing row ${L+1} in ${Y}:`,I),null}}).filter(A=>A!==null);if(S.length===0)throw new Error(`No valid program data found in the ${Y} sheet.`);console.log(`Processed programs from ${Y}:`,S);const w=localStorage.getItem("token"),j=await bt.post(`${Ct.API_URL}/suc-form-b/bulk`,{programs:S},{headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"}});return console.log(`Programs upload response from ${Y}:`,j.data),s(),S.map(A=>({program:A}))}catch(D){throw console.error(`Program sheet processing error in ${Y}:`,D),new Error(((M=(q=D.response)==null?void 0:q.data)==null?void 0:M.error)||`Failed to process programs in ${Y}: ${D.message}`)}},U=()=>{d({}),s()};return t?r.jsx(mr,{isOpen:t,onClose:U,title:"Upload Academic Programs",subtitle:"Import HEMIS Form B or academic program Excel files",icon:Qr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Upload Configuration"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution ID"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600",placeholder:"Institution ID will be auto-filled"}),o.institution&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.institution})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Report Year"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{value:g,onChange:W=>h("year",parseInt(W.target.value)),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${o.year?"border-red-300 bg-red-50":"border-gray-300"}`,children:Array.from({length:10},(W,Y)=>{const q=new Date().getFullYear()-Y;return r.jsx("option",{value:q,children:q},q)})}),o.year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.year})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(pi,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Excel Format Guidelines"})]}),r.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ys,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"HEMIS Form B Structure:"}),r.jsxs("ul",{className:"space-y-1 ml-2",children:[r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),'Data starts after "START BELOW THIS ROW"']}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Only rows with a valid Program Name are processed"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Column A: Program Name (Required)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Column B: Program Code"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Column C: Program Type (Doctoral, Masters, Post-Baccalaureate, Baccalaureate, Pre-Baccalaureate, VocTech, Basic)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns D-R: Academic details (major, AOP, units, fees)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns S-AR: Enrollment data by year and gender"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns AS-AU: Graduate statistics and scholarships"]})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ui,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"The system will automatically detect program data and map it to the appropriate database fields."})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(qr,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"Supported formats: .xlsx, .xls, and .csv files with program information"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($o,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"File Upload"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"file",id:"excel-upload",accept:".xlsx,.xls,.csv",onChange:F,disabled:l||!a,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),r.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200 ${!a||l?"border-gray-200 bg-gray-50/50":"border-slate-300 hover:border-slate-400 hover:bg-slate-50/50 bg-white"}`,children:[r.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${!a||l?"bg-gray-100":"bg-gradient-to-br from-slate-100 to-slate-200"}`,children:l?r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}):r.jsx(Qr,{className:`w-8 h-8 ${a?"text-slate-600":"text-gray-300"}`})}),r.jsx("p",{className:`text-lg font-semibold mb-2 ${!a||l?"text-gray-400":"text-gray-900"}`,children:l?"Processing File...":"Choose Excel File to Upload"}),r.jsx("p",{className:`text-sm mb-2 ${!a||l?"text-gray-400":"text-gray-600"}`,children:"Drag and drop or click to browse"}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-2",children:[r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:".xlsx"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:".xls"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:".csv"})]}),!a&&r.jsxs("div",{className:"flex items-center justify-center mt-3",children:[r.jsx(Ht,{className:"w-4 h-4 text-red-500 mr-1"}),r.jsx("span",{className:"text-sm text-red-500 font-medium",children:"Institution ID is required"})]})]})]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:r.jsx("button",{onClick:U,disabled:l,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:l?"Processing...":"Close"})})]})}):null}W4.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onUploadSuccess:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired};const pc=({currentPage:t,totalPages:s,onPageChange:e,pageSize:a,onPageSizeChange:n,pageSizeOptions:i=[10,20,50,100],showFirstLast:c=!0,showPageSize:l=!0,maxPageButtons:u=5,className:o=""})=>{const d=h=>{const f=parseInt(h.target.value,10);n&&!isNaN(f)&&n(f)},g=()=>{const h=[];let f,x;if(s<=u)f=1,x=s;else{const b=Math.floor(u/2);t<=b+1?(f=1,x=u):t+b>=s?(f=s-u+1,x=s):(f=t-b,x=t+b)}for(let b=f;b<=x;b++)h.push(r.jsxs("button",{onClick:()=>e(b),className:`relative min-w-10 h-10 flex items-center justify-center rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 ${t===b?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-200 z-10":"bg-white text-gray-700 hover:bg-gray-50 hover:text-gray-900 border border-gray-200 hover:border-gray-300 hover:shadow-md"}`,"aria-current":t===b?"page":void 0,children:[b,t===b&&r.jsx("div",{className:"absolute inset-0 rounded-lg bg-blue-400 opacity-20 animate-pulse"})]},b));return h},p=()=>{const h=g(),f=s,x=[];return c&&h.length>0&&parseInt(h[0].key)>1&&(x.push(r.jsx("button",{onClick:()=>e(1),className:"min-w-10 h-10 flex items-center justify-center rounded-lg text-sm font-medium bg-white text-gray-700 hover:bg-gray-50 hover:text-gray-900 border border-gray-200 hover:border-gray-300 transition-all duration-200 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",children:"1"},"first")),parseInt(h[0].key)>2&&x.push(r.jsx("span",{className:"px-2 text-gray-400 font-medium",children:""},"ellipsis1"))),x.push(...h),c&&h.length>0&&parseInt(h[h.length-1].key)<f&&(parseInt(h[h.length-1].key)<f-1&&x.push(r.jsx("span",{className:"px-2 text-gray-400 font-medium",children:""},"ellipsis2")),x.push(r.jsx("button",{onClick:()=>e(f),className:"min-w-10 h-10 flex items-center justify-center rounded-lg text-sm font-medium bg-white text-gray-700 hover:bg-gray-50 hover:text-gray-900 border border-gray-200 hover:border-gray-300 transition-all duration-200 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",children:f},"last"))),x};return r.jsxs("div",{className:`flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 p-4 ${o}`,role:"navigation","aria-label":"Pagination",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("button",{onClick:()=>e(1),disabled:t===1,className:"p-2.5 rounded-lg text-sm border border-gray-200 disabled:bg-gray-50 disabled:text-gray-300 disabled:border-gray-100 hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 flex items-center justify-center group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 disabled:cursor-not-allowed","aria-label":"Go to first page",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-200 group-hover:-translate-x-0.5",children:[r.jsx("polyline",{points:"11 17 6 12 11 7"}),r.jsx("polyline",{points:"18 17 13 12 18 7"})]})}),r.jsx("button",{onClick:()=>e(t-1),disabled:t===1,className:"p-2.5 rounded-lg text-sm border border-gray-200 disabled:bg-gray-50 disabled:text-gray-300 disabled:border-gray-100 hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 flex items-center justify-center group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 disabled:cursor-not-allowed","aria-label":"Go to previous page",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-200 group-hover:-translate-x-0.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("div",{className:"flex items-center gap-1 mx-2",children:p()}),r.jsx("button",{onClick:()=>e(t+1),disabled:t===s,className:"p-2.5 rounded-lg text-sm border border-gray-200 disabled:bg-gray-50 disabled:text-gray-300 disabled:border-gray-100 hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 flex items-center justify-center group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 disabled:cursor-not-allowed","aria-label":"Go to next page",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-200 group-hover:translate-x-0.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})}),r.jsx("button",{onClick:()=>e(s),disabled:t===s,className:"p-2.5 rounded-lg text-sm border border-gray-200 disabled:bg-gray-50 disabled:text-gray-300 disabled:border-gray-100 hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 flex items-center justify-center group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 disabled:cursor-not-allowed","aria-label":"Go to last page",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-200 group-hover:translate-x-0.5",children:[r.jsx("polyline",{points:"13 17 18 12 13 7"}),r.jsx("polyline",{points:"6 17 11 12 6 7"})]})})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 text-gray-600 bg-gray-50 px-3 py-1.5 rounded-lg border",children:[r.jsxs("span",{className:"font-medium text-gray-900",children:["Page ",t]}),r.jsx("span",{className:"text-gray-400",children:"of"}),r.jsx("span",{className:"font-medium text-gray-900",children:s})]}),l&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{htmlFor:"page-size",className:"text-gray-600 font-medium whitespace-nowrap",children:"Show:"}),r.jsx("select",{id:"page-size",value:a,onChange:d,className:"px-3 py-1.5 text-sm border border-gray-200 rounded-lg bg-white hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer","aria-label":"Items per page",children:i.map(h=>r.jsx("option",{value:h,children:h},h))}),r.jsx("span",{className:"text-gray-600 whitespace-nowrap",children:"per page"})]})]})]})};pc.propTypes={currentPage:B.number.isRequired,totalPages:B.number.isRequired,onPageChange:B.func.isRequired,pageSize:B.number,onPageSizeChange:B.func,pageSizeOptions:B.arrayOf(B.number),showFirstLast:B.bool,showPageSize:B.bool,maxPageButtons:B.number,className:B.string};function Rf(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Rp={exports:{}};/*! ExcelJS 19-10-2023 */var T_;function IU(){return T_||(T_=1,function(t,s){(function(e){t.exports=e()})(function(){return function e(a,n,i){function c(o,d){if(!n[o]){if(!a[o]){var g=typeof Rf=="function"&&Rf;if(!d&&g)return g(o,!0);if(l)return l(o,!0);var p=new Error("Cannot find module '"+o+"'");throw p.code="MODULE_NOT_FOUND",p}var h=n[o]={exports:{}};a[o][0].call(h.exports,function(f){return c(a[o][1][f]||f)},h,h.exports,e,a,n,i)}return n[o].exports}for(var l=typeof Rf=="function"&&Rf,u=0;u<i.length;u++)c(i[u]);return c}({1:[function(e,a,n){const i=e("fs"),c=e("fast-csv"),l=e("dayjs/plugin/customParseFormat"),u=e("dayjs/plugin/utc"),o=e("dayjs").extend(l).extend(u),d=e("../utils/stream-buf"),{fs:{exists:g}}=e("../utils/utils"),p={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};a.exports=class{constructor(h){this.workbook=h,this.worksheet=null}async readFile(h,f){if(f=f||{},!await g(h))throw new Error("File not found: "+h);const x=i.createReadStream(h),b=await this.read(x,f);return x.close(),b}read(h,f){return f=f||{},new Promise((x,b)=>{const v=this.workbook.addWorksheet(f.sheetName),_=f.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],N=f.map||function(O){if(O==="")return null;const F=Number(O);if(!Number.isNaN(F)&&F!==1/0)return F;const z=_.reduce((U,W)=>{if(U)return U;const Y=o(O,W,!0);return Y.isValid()?Y:null},null);if(z)return new Date(z.valueOf());const P=p[O];return P!==void 0?P:O},E=c.parse(f.parserOptions).on("data",O=>{v.addRow(O.map(N))}).on("end",()=>{E.emit("worksheet",v)});E.on("worksheet",x).on("error",b),h.pipe(E)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(h,f){return new Promise((x,b)=>{f=f||{};const v=this.workbook.getWorksheet(f.sheetName||f.sheetId),_=c.format(f.formatterOptions);h.on("finish",()=>{x()}),_.on("error",b),_.pipe(h);const{dateFormat:N,dateUTC:E}=f,O=f.map||(P=>{if(P){if(P.text||P.hyperlink)return P.hyperlink||P.text||"";if(P.formula||P.result)return P.result||"";if(P instanceof Date)return N?E?o.utc(P).format(N):o(P).format(N):E?o.utc(P).format():o(P).format();if(P.error)return P.error;if(typeof P=="object")return JSON.stringify(P)}return P}),F=f.includeEmptyRows===void 0||f.includeEmptyRows;let z=1;v&&v.eachRow((P,U)=>{if(F)for(;z++<U-1;)_.write([]);const{values:W}=P;W.shift(),_.write(W.map(O)),z=U}),_.end()})}writeFile(h,f){const x={encoding:(f=f||{}).encoding||"utf8"},b=i.createWriteStream(h,x);return this.write(b,f)}async writeBuffer(h){const f=new d;return await this.write(f,h),f.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(e,a,n){const i=e("../utils/col-cache");class c{constructor(u,o){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=u,o)if(typeof o=="string"){const g=i.decodeAddress(o);this.nativeCol=g.col+d,this.nativeColOff=0,this.nativeRow=g.row+d,this.nativeRowOff=0}else o.nativeCol!==void 0?(this.nativeCol=o.nativeCol||0,this.nativeColOff=o.nativeColOff||0,this.nativeRow=o.nativeRow||0,this.nativeRowOff=o.nativeRowOff||0):o.col!==void 0?(this.col=o.col+d,this.row=o.row+d):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(u){return u instanceof c||u==null?u:new c(u)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(u){this.nativeCol=Math.floor(u),this.nativeColOff=Math.floor((u-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(u){this.nativeRow=Math.floor(u),this.nativeRowOff=Math.floor((u-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(u){this.nativeCol=u.nativeCol,this.nativeColOff=u.nativeColOff,this.nativeRow=u.nativeRow,this.nativeRowOff=u.nativeRowOff}}a.exports=c},{"../utils/col-cache":19}],3:[function(e,a,n){const i=e("../utils/col-cache"),c=e("../utils/under-dash"),l=e("./enums"),{slideFormula:u}=e("../utils/shared-formula"),o=e("./note");class d{constructor(h,f,x){if(!h||!f)throw new Error("A Cell needs a Row");this._row=h,this._column=f,i.validateAddress(x),this._address=x,this._value=g.create(d.Types.Null,this),this.style=this._mergeStyle(h.style,f.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(h){this.style.numFmt=h}get font(){return this.style.font}set font(h){this.style.font=h}get alignment(){return this.style.alignment}set alignment(h){this.style.alignment=h}get border(){return this.style.border}set border(h){this.style.border=h}get fill(){return this.style.fill}set fill(h){this.style.fill=h}get protection(){return this.style.protection}set protection(h){this.style.protection=h}_mergeStyle(h,f,x){const b=h&&h.numFmt||f&&f.numFmt;b&&(x.numFmt=b);const v=h&&h.font||f&&f.font;v&&(x.font=v);const _=h&&h.alignment||f&&f.alignment;_&&(x.alignment=_);const N=h&&h.border||f&&f.border;N&&(x.border=N);const E=h&&h.fill||f&&f.fill;E&&(x.fill=E);const O=h&&h.protection||f&&f.protection;return O&&(x.protection=O),x}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===d.Types.Merge}merge(h,f){this._value.release(),this._value=g.create(d.Types.Merge,this,h),f||(this.style=h.style)}unmerge(){this.type===d.Types.Merge&&(this._value.release(),this._value=g.create(d.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(h){return this._value.type===d.Types.Merge&&this._value.isMergedTo(h)}get master(){return this.type===d.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===d.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(h){this.type!==d.Types.Merge?(this._value.release(),this._value=g.create(g.getType(h),this,h)):this._value.master.value=h}get note(){return this._comment&&this._comment.note}set note(h){this._comment=new o(h)}get text(){return this._value.toString()}get html(){return c.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(h){this.type===d.Types.String&&(this._value=g.create(d.Types.Hyperlink,this,{text:this._value.value,hyperlink:h}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:h}=this._row;return{sheetName:h.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(h){this.names=[h]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(h){const{definedNames:f}=this.workbook;f.removeAllNames(this.fullAddress),h.forEach(x=>{f.addEx(this.fullAddress,x)})}addName(h){this.workbook.definedNames.addEx(this.fullAddress,h)}removeName(h){this.workbook.definedNames.removeEx(this.fullAddress,h)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(h){this._dataValidations.add(this.address,h)}get model(){const{model:h}=this._value;return h.style=this.style,this._comment&&(h.comment=this._comment.model),h}set model(h){if(this._value.release(),this._value=g.create(h.type,this),this._value.model=h,h.comment)switch(h.comment.type){case"note":this._comment=o.fromModel(h.comment)}h.style?this.style=h.style:this.style={}}}d.Types=l.ValueType;const g={getType:p=>p==null?d.Types.Null:p instanceof String||typeof p=="string"?d.Types.String:typeof p=="number"?d.Types.Number:typeof p=="boolean"?d.Types.Boolean:p instanceof Date?d.Types.Date:p.text&&p.hyperlink?d.Types.Hyperlink:p.formula||p.sharedFormula?d.Types.Formula:p.richText?d.Types.RichText:p.sharedString?d.Types.SharedString:p.error?d.Types.Error:d.Types.JSON,types:[{t:d.Types.Null,f:class{constructor(p){this.model={address:p.address,type:d.Types.Null}}get value(){return null}set value(p){}get type(){return d.Types.Null}get effectiveType(){return d.Types.Null}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return""}release(){}toString(){return""}}},{t:d.Types.Number,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Number,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.Number}get effectiveType(){return d.Types.Number}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.String,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.String,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.String}get effectiveType(){return d.Types.String}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:d.Types.Date,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Date,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.Date}get effectiveType(){return d.Types.Date}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.Hyperlink,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Hyperlink,text:h?h.text:void 0,hyperlink:h?h.hyperlink:void 0},h&&h.tooltip&&(this.model.tooltip=h.tooltip)}get value(){const p={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(p.tooltip=this.model.tooltip),p}set value(p){this.model={text:p.text,hyperlink:p.hyperlink},p.tooltip&&(this.model.tooltip=p.tooltip)}get text(){return this.model.text}set text(p){this.model.text=p}get hyperlink(){return this.model.hyperlink}set hyperlink(p){this.model.hyperlink=p}get type(){return d.Types.Hyperlink}get effectiveType(){return d.Types.Hyperlink}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:d.Types.Formula,f:class{constructor(p,h){this.cell=p,this.model={address:p.address,type:d.Types.Formula,shareType:h?h.shareType:void 0,ref:h?h.ref:void 0,formula:h?h.formula:void 0,sharedFormula:h?h.sharedFormula:void 0,result:h?h.result:void 0}}_copyModel(p){const h={},f=x=>{const b=p[x];b&&(h[x]=b)};return f("formula"),f("result"),f("ref"),f("shareType"),f("sharedFormula"),h}get value(){return this._copyModel(this.model)}set value(p){this.model=this._copyModel(p)}validate(p){switch(g.getType(p)){case d.Types.Null:case d.Types.String:case d.Types.Number:case d.Types.Date:break;case d.Types.Hyperlink:case d.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(p){this.model.formula=p}get formulaType(){return this.model.formula?l.FormulaType.Master:this.model.sharedFormula?l.FormulaType.Shared:l.FormulaType.None}get result(){return this.model.result}set result(p){this.model.result=p}get type(){return d.Types.Formula}get effectiveType(){const p=this.model.result;return p==null?l.ValueType.Null:p instanceof String||typeof p=="string"?l.ValueType.String:typeof p=="number"?l.ValueType.Number:p instanceof Date?l.ValueType.Date:p.text&&p.hyperlink?l.ValueType.Hyperlink:p.formula?l.ValueType.Formula:l.ValueType.Null}get address(){return this.model.address}set address(p){this.model.address=p}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:p}=this.cell,h=p.findCell(this.model.sharedFormula);this._translatedFormula=h&&u(h.formula,h.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:d.Types.Merge,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Merge,master:h?h.address:void 0},this._master=h,h&&h.addMergeRef()}get value(){return this._master.value}set value(p){p instanceof d?(this._master&&this._master.releaseMergeRef(),p.addMergeRef(),this._master=p):this._master.value=p}isMergedTo(p){return p===this._master}get master(){return this._master}get type(){return d.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:d.Types.JSON,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.String,value:JSON.stringify(h),rawValue:h}}get value(){return this.model.rawValue}set value(p){this.model.rawValue=p,this.model.value=JSON.stringify(p)}get type(){return d.Types.String}get effectiveType(){return d.Types.String}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:d.Types.SharedString,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.SharedString,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.SharedString}get effectiveType(){return d.Types.SharedString}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.RichText,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.String,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}toString(){return this.model.value.richText.map(p=>p.text).join("")}get type(){return d.Types.RichText}get effectiveType(){return d.Types.RichText}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:d.Types.Boolean,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Boolean,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.Boolean}get effectiveType(){return d.Types.Boolean}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.Error,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Error,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.Error}get effectiveType(){return d.Types.Error}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((p,h)=>(p[h.t]=h.f,p),[]),create(p,h,f){const x=this.types[p];if(!x)throw new Error("Could not create Value of type "+p);return new x(h,f)}};a.exports=d},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(e,a,n){const i=e("../utils/under-dash"),c=e("./enums"),l=e("../utils/col-cache");class u{constructor(d,g,p){this._worksheet=d,this._number=g,p!==!1&&(this.defn=p)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return l.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(d){d?(this.key=d.key,this.width=d.width!==void 0?d.width:9,this.outlineLevel=d.outlineLevel,d.style?this.style=d.style:this.style={},this.header=d.header,this._hidden=!!d.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(d){d!==void 0?(this._header=d,this.headers.forEach((g,p)=>{this._worksheet.getCell(p+1,this.number).value=g})):this._header=void 0}get key(){return this._key}set key(d){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=d,d&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(d){this._hidden=d}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(d){this._outlineLevel=d}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(d){return this.width===d.width&&this.hidden===d.hidden&&this.outlineLevel===d.outlineLevel&&i.isEqual(this.style,d.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const d=this.style;return!d||!(d.font||d.numFmt||d.alignment||d.border||d.fill||d.protection)}get headerCount(){return this.headers.length}eachCell(d,g){const p=this.number;g||(g=d,d=null),this._worksheet.eachRow(d,(h,f)=>{g(h.getCell(p),f)})}get values(){const d=[];return this.eachCell((g,p)=>{g&&g.type!==c.ValueType.Null&&(d[p]=g.value)}),d}set values(d){if(!d)return;const g=this.number;let p=0;d.hasOwnProperty("0")&&(p=1),d.forEach((h,f)=>{this._worksheet.getCell(f+p,g).value=h})}_applyStyle(d,g){return this.style[d]=g,this.eachCell(p=>{p[d]=g}),g}get numFmt(){return this.style.numFmt}set numFmt(d){this._applyStyle("numFmt",d)}get font(){return this.style.font}set font(d){this._applyStyle("font",d)}get alignment(){return this.style.alignment}set alignment(d){this._applyStyle("alignment",d)}get protection(){return this.style.protection}set protection(d){this._applyStyle("protection",d)}get border(){return this.style.border}set border(d){this._applyStyle("border",d)}get fill(){return this.style.fill}set fill(d){this._applyStyle("fill",d)}static toModel(d){const g=[];let p=null;return d&&d.forEach((h,f)=>{h.isDefault?p&&(p=null):p&&h.equivalentTo(p)?p.max=f+1:(p={min:f+1,max:f+1,width:h.width!==void 0?h.width:9,style:h.style,isCustomWidth:h.isCustomWidth,hidden:h.hidden,outlineLevel:h.outlineLevel,collapsed:h.collapsed},g.push(p))}),g.length?g:void 0}static fromModel(d,g){const p=[];let h=1,f=0;for(g=(g=g||[]).sort(function(x,b){return x.min-b.min});f<g.length;){const x=g[f++];for(;h<x.min;)p.push(new u(d,h++));for(;h<=x.max;)p.push(new u(d,h++,x))}return p.length?p:null}}a.exports=u},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(e,a,n){a.exports=class{constructor(i){this.model=i||{}}add(i,c){return this.model[i]=c}find(i){return this.model[i]}remove(i){this.model[i]=void 0}}},{}],6:[function(e,a,n){const i=e("../utils/under-dash"),c=e("../utils/col-cache"),l=e("../utils/cell-matrix"),u=e("./range"),o=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;a.exports=class{constructor(){this.matrixMap={}}getMatrix(d){return this.matrixMap[d]||(this.matrixMap[d]=new l)}add(d,g){const p=c.decodeEx(d);this.addEx(p,g)}addEx(d,g){const p=this.getMatrix(g);if(d.top)for(let h=d.left;h<=d.right;h++)for(let f=d.top;f<=d.bottom;f++){const x={sheetName:d.sheetName,address:c.n2l(h)+f,row:f,col:h};p.addCellEx(x)}else p.addCellEx(d)}remove(d,g){const p=c.decodeEx(d);this.removeEx(p,g)}removeEx(d,g){this.getMatrix(g).removeCellEx(d)}removeAllNames(d){i.each(this.matrixMap,g=>{g.removeCellEx(d)})}forEach(d){i.each(this.matrixMap,(g,p)=>{g.forEach(h=>{d(p,h)})})}getNames(d){return this.getNamesEx(c.decodeEx(d))}getNamesEx(d){return i.map(this.matrixMap,(g,p)=>g.findCellEx(d)&&p).filter(Boolean)}_explore(d,g){g.mark=!1;const{sheetName:p}=g,h=new u(g.row,g.col,g.row,g.col,p);let f,x;function b(_,N){const E=d.findCellAt(p,_,g.col);return!(!E||!E.mark)&&(h[N]=_,E.mark=!1,!0)}for(x=g.row-1;b(x,"top");x--);for(x=g.row+1;b(x,"bottom");x++);function v(_,N){const E=[];for(x=h.top;x<=h.bottom;x++){const O=d.findCellAt(p,x,_);if(!O||!O.mark)return!1;E.push(O)}h[N]=_;for(let O=0;O<E.length;O++)E[O].mark=!1;return!0}for(f=g.col-1;v(f,"left");f--);for(f=g.col+1;v(f,"right");f++);return h}getRanges(d,g){return(g=g||this.matrixMap[d])?(g.forEach(p=>{p.mark=!0}),{name:d,ranges:g.map(p=>p.mark&&this._explore(g,p)).filter(Boolean).map(p=>p.$shortRange)}):{name:d,ranges:[]}}normaliseMatrix(d,g){d.forEachInSheet(g,(p,h,f)=>{p&&(p.row===h&&p.col===f||(p.row=h,p.col=f,p.address=c.n2l(f)+h))})}spliceRows(d,g,p,h){i.each(this.matrixMap,f=>{f.spliceRows(d,g,p,h),this.normaliseMatrix(f,d)})}spliceColumns(d,g,p,h){i.each(this.matrixMap,f=>{f.spliceColumns(d,g,p,h),this.normaliseMatrix(f,d)})}get model(){return i.map(this.matrixMap,(d,g)=>this.getRanges(g,d)).filter(d=>d.ranges.length)}set model(d){const g=this.matrixMap={};d.forEach(p=>{const h=g[p.name]=new l;p.ranges.forEach(f=>{o.test(f.split("!").pop()||"")&&h.addCell(f)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(e,a,n){a.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,a,n){const i=e("../utils/col-cache"),c=e("./anchor");a.exports=class{constructor(l,u){this.worksheet=l,this.model=u}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(l){let{type:u,imageId:o,range:d,hyperlinks:g}=l;if(this.type=u,this.imageId=o,u==="image")if(typeof d=="string"){const p=i.decode(d);this.range={tl:new c(this.worksheet,{col:p.left,row:p.top},-1),br:new c(this.worksheet,{col:p.right,row:p.bottom},0),editAs:"oneCell"}}else this.range={tl:new c(this.worksheet,d.tl,0),br:d.br&&new c(this.worksheet,d.br,0),ext:d.ext,editAs:d.editAs,hyperlinks:g||d.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,a,n){const i=e("../utils/under-dash");class c{constructor(u){this.note=u}get model(){let u=null;switch(typeof this.note){case"string":u={type:"note",note:{texts:[{text:this.note}]}};break;default:u={type:"note",note:this.note}}return i.deepMerge({},c.DEFAULT_CONFIGS,u)}set model(u){const{note:o}=u,{texts:d}=o;d.length===1&&Object.keys(d[0]).length===1?this.note=d[0].text:this.note=o}static fromModel(u){const o=new c;return o.model=u,o}}c.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},a.exports=c},{"../utils/under-dash":26}],10:[function(e,a,n){const i=e("../utils/col-cache");class c{constructor(){this.decode(arguments)}setTLBR(u,o,d,g,p){if(arguments.length<4){const h=i.decodeAddress(u),f=i.decodeAddress(o);this.model={top:Math.min(h.row,f.row),left:Math.min(h.col,f.col),bottom:Math.max(h.row,f.row),right:Math.max(h.col,f.col),sheetName:d},this.setTLBR(h.row,h.col,f.row,f.col,p)}else this.model={top:Math.min(u,d),left:Math.min(o,g),bottom:Math.max(u,d),right:Math.max(o,g),sheetName:p}}decode(u){switch(u.length){case 5:this.setTLBR(u[0],u[1],u[2],u[3],u[4]);break;case 4:this.setTLBR(u[0],u[1],u[2],u[3]);break;case 3:this.setTLBR(u[0],u[1],u[2]);break;case 2:this.setTLBR(u[0],u[1]);break;case 1:{const o=u[0];if(o instanceof c)this.model={top:o.model.top,left:o.model.left,bottom:o.model.bottom,right:o.model.right,sheetName:o.sheetName};else if(o instanceof Array)this.decode(o);else if(o.top&&o.left&&o.bottom&&o.right)this.model={top:o.top,left:o.left,bottom:o.bottom,right:o.right,sheetName:o.sheetName};else{const d=i.decodeEx(o);d.top?this.model={top:d.top,left:d.left,bottom:d.bottom,right:d.right,sheetName:d.sheetName}:this.model={top:d.row,left:d.col,bottom:d.row,right:d.col,sheetName:d.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+u.length)}}get top(){return this.model.top||1}set top(u){this.model.top=u}get left(){return this.model.left||1}set left(u){this.model.left=u}get bottom(){return this.model.bottom||1}set bottom(u){this.model.bottom=u}get right(){return this.model.right||1}set right(u){this.model.right=u}get sheetName(){return this.model.sheetName}set sheetName(u){this.model.sheetName=u}get _serialisedSheetName(){const{sheetName:u}=this.model;return u?/^[a-zA-Z0-9]*$/.test(u)?u+"!":`'${u}'!`:""}expand(u,o,d,g){(!this.model.top||u<this.top)&&(this.top=u),(!this.model.left||o<this.left)&&(this.left=o),(!this.model.bottom||d>this.bottom)&&(this.bottom=d),(!this.model.right||g>this.right)&&(this.right=g)}expandRow(u){if(u){const{dimensions:o,number:d}=u;o&&this.expand(d,o.min,d,o.max)}}expandToAddress(u){const o=i.decodeEx(u);this.expand(o.row,o.col,o.row,o.col)}get tl(){return i.n2l(this.left)+this.top}get $t$l(){return`$${i.n2l(this.left)}$${this.top}`}get br(){return i.n2l(this.right)+this.bottom}get $b$r(){return`$${i.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(u){return(!u.sheetName||!this.sheetName||u.sheetName===this.sheetName)&&!(u.bottom<this.top)&&!(u.top>this.bottom)&&!(u.right<this.left)&&!(u.left>this.right)}contains(u){const o=i.decodeEx(u);return this.containsEx(o)}containsEx(u){return(!u.sheetName||!this.sheetName||u.sheetName===this.sheetName)&&u.row>=this.top&&u.row<=this.bottom&&u.col>=this.left&&u.col<=this.right}forEachAddress(u){for(let o=this.left;o<=this.right;o++)for(let d=this.top;d<=this.bottom;d++)u(i.encodeAddress(d,o),d,o)}}a.exports=c},{"../utils/col-cache":19}],11:[function(e,a,n){const i=e("../utils/under-dash"),c=e("./enums"),l=e("../utils/col-cache"),u=e("./cell");a.exports=class{constructor(o,d){this._worksheet=o,this._number=d,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(o){return this._cells[o-1]}getCellEx(o){let d=this._cells[o.col-1];if(!d){const g=this._worksheet.getColumn(o.col);d=new u(this,g,o.address),this._cells[o.col-1]=d}return d}getCell(o){if(typeof o=="string"){const d=this._worksheet.getColumnKey(o);o=d?d.number:l.l2n(o)}return this._cells[o-1]||this.getCellEx({address:l.encodeAddress(this._number,o),row:this._number,col:o})}splice(o,d){const g=o+d;for(var p=arguments.length,h=new Array(p>2?p-2:0),f=2;f<p;f++)h[f-2]=arguments[f];const x=h.length-d,b=this._cells.length;let v,_,N;if(x<0)for(v=o+h.length;v<=b;v++)N=this._cells[v-1],_=this._cells[v-x-1],_?(N=this.getCell(v),N.value=_.value,N.style=_.style,N._comment=_._comment):N&&(N.value=null,N.style={},N._comment=void 0);else if(x>0)for(v=b;v>=g;v--)_=this._cells[v-1],_?(N=this.getCell(v+x),N.value=_.value,N.style=_.style,N._comment=_._comment):this._cells[v+x-1]=void 0;for(v=0;v<h.length;v++)N=this.getCell(o+v),N.value=h[v],N.style={},N._comment=void 0}eachCell(o,d){if(d||(d=o,o=null),o&&o.includeEmpty){const g=this._cells.length;for(let p=1;p<=g;p++)d(this.getCell(p),p)}else this._cells.forEach((g,p)=>{g&&g.type!==c.ValueType.Null&&d(g,p+1)})}addPageBreak(o,d){const g=this._worksheet,p=Math.max(0,o-1)||0,h=Math.max(0,d-1)||16838,f={id:this._number,max:h,man:1};p&&(f.min=p),g.rowBreaks.push(f)}get values(){const o=[];return this._cells.forEach(d=>{d&&d.type!==c.ValueType.Null&&(o[d.col]=d.value)}),o}set values(o){if(this._cells=[],o)if(o instanceof Array){let d=0;o.hasOwnProperty("0")&&(d=1),o.forEach((g,p)=>{g!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,p+d),row:this._number,col:p+d}).value=g)})}else this._worksheet.eachColumnKey((d,g)=>{o[g]!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,d.number),row:this._number,col:d.number}).value=o[g])})}get hasValues(){return i.some(this._cells,o=>o&&o.type!==c.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let o=0;return this.eachCell(()=>{o++}),o}get dimensions(){let o=0,d=0;return this._cells.forEach(g=>{g&&g.type!==c.ValueType.Null&&((!o||o>g.col)&&(o=g.col),d<g.col&&(d=g.col))}),o>0?{min:o,max:d}:null}_applyStyle(o,d){return this.style[o]=d,this._cells.forEach(g=>{g&&(g[o]=d)}),d}get numFmt(){return this.style.numFmt}set numFmt(o){this._applyStyle("numFmt",o)}get font(){return this.style.font}set font(o){this._applyStyle("font",o)}get alignment(){return this.style.alignment}set alignment(o){this._applyStyle("alignment",o)}get protection(){return this.style.protection}set protection(o){this._applyStyle("protection",o)}get border(){return this.style.border}set border(o){this._applyStyle("border",o)}get fill(){return this.style.fill}set fill(o){this._applyStyle("fill",o)}get hidden(){return!!this._hidden}set hidden(o){this._hidden=o}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(o){this._outlineLevel=o}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const o=[];let d=0,g=0;return this._cells.forEach(p=>{if(p){const h=p.model;h&&((!d||d>p.col)&&(d=p.col),g<p.col&&(g=p.col),o.push(h))}}),this.height||o.length?{cells:o,number:this.number,min:d,max:g,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(o){if(o.number!==this._number)throw new Error("Invalid row number in model");let d;this._cells=[],o.cells.forEach(g=>{switch(g.type){case u.Types.Merge:break;default:{let p;if(g.address)p=l.decodeAddress(g.address);else if(d){const{row:h}=d,f=d.col+1;p={row:h,col:f,address:l.encodeAddress(h,f),$col$row:`$${l.n2l(f)}$${h}`}}d=p,this.getCellEx(p).model=g;break}}}),o.height?this.height=o.height:delete this.height,this.hidden=o.hidden,this.outlineLevel=o.outlineLevel||0,this.style=o.style&&JSON.parse(JSON.stringify(o.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(e,a,n){const i=e("../utils/col-cache");class c{constructor(u,o,d){this.table=u,this.column=o,this.index=d}_set(u,o){this.table.cacheState(),this.column[u]=o}get name(){return this.column.name}set name(u){this._set("name",u)}get filterButton(){return this.column.filterButton}set filterButton(u){this.column.filterButton=u}get style(){return this.column.style}set style(u){this.column.style=u}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(u){this._set("totalsRowLabel",u)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(u){this._set("totalsRowFunction",u)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(u){this._set("totalsRowResult",u)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(u){this._set("totalsRowFormula",u)}}a.exports=class{constructor(l,u){this.worksheet=l,u&&(this.table=u,this.validate(),this.store())}getFormula(l){switch(l.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${l.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${l.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${l.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${l.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${l.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${l.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${l.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${l.name}])`;case"custom":return l.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+l.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:l}=this,u=(x,b,v)=>{x[b]===void 0&&(x[b]=v)};u(l,"headerRow",!0),u(l,"totalsRow",!1),u(l,"style",{}),u(l.style,"theme","TableStyleMedium2"),u(l.style,"showFirstColumn",!1),u(l.style,"showLastColumn",!1),u(l.style,"showRowStripes",!1),u(l.style,"showColumnStripes",!1);const o=(x,b)=>{if(!x)throw new Error(b)};o(l.ref,"Table must have ref"),o(l.columns,"Table must have column definitions"),o(l.rows,"Table must have row definitions"),l.tl=i.decodeAddress(l.ref);const{row:d,col:g}=l.tl;o(d>0,"Table must be on valid row"),o(g>0,"Table must be on valid col");const{width:p,filterHeight:h,tableHeight:f}=this;l.autoFilterRef=i.encode(d,g,d+h-1,g+p-1),l.tableRef=i.encode(d,g,d+f-1,g+p-1),l.columns.forEach((x,b)=>{o(x.name,`Column ${b} must have a name`),b===0?u(x,"totalsRowLabel","Total"):(u(x,"totalsRowFunction","none"),x.totalsRowFormula=this.getFormula(x))})}store(){const l=(h,f)=>{f&&Object.keys(f).forEach(x=>{h[x]=f[x]})},{worksheet:u,table:o}=this,{row:d,col:g}=o.tl;let p=0;if(o.headerRow){const h=u.getRow(d+p++);o.columns.forEach((f,x)=>{const{style:b,name:v}=f,_=h.getCell(g+x);_.value=v,l(_,b)})}if(o.rows.forEach(h=>{const f=u.getRow(d+p++);h.forEach((x,b)=>{const v=f.getCell(g+b);v.value=x,l(v,o.columns[b].style)})}),o.totalsRow){const h=u.getRow(d+p++);o.columns.forEach((f,x)=>{const b=h.getCell(g+x);if(x===0)b.value=f.totalsRowLabel;else{const v=this.getFormula(f);b.value=v?{formula:f.totalsRowFormula,result:f.totalsRowResult}:null}l(b,f.style)})}}load(l){const{table:u}=this,{row:o,col:d}=u.tl;let g=0;if(u.headerRow){const p=l.getRow(o+g++);u.columns.forEach((h,f)=>{p.getCell(d+f).value=h.name})}if(u.rows.forEach(p=>{const h=l.getRow(o+g++);p.forEach((f,x)=>{h.getCell(d+x).value=f})}),u.totalsRow){const p=l.getRow(o+g++);u.columns.forEach((h,f)=>{const x=p.getCell(d+f);f===0?x.value=h.totalsRowLabel:this.getFormula(h)&&(x.value={formula:h.totalsRowFormula,result:h.totalsRowResult})})}}get model(){return this.table}set model(l){this.table=l}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const l=i.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let u=0;u<this._cache.tableHeight;u++){const o=this.worksheet.getRow(l.row+u);for(let d=0;d<this._cache.width;d++)o.getCell(l.col+d).value=null}else{for(let u=this.tableHeight;u<this._cache.tableHeight;u++){const o=this.worksheet.getRow(l.row+u);for(let d=0;d<this._cache.width;d++)o.getCell(l.col+d).value=null}for(let u=0;u<this.tableHeight;u++){const o=this.worksheet.getRow(l.row+u);for(let d=this.width;d<this._cache.width;d++)o.getCell(l.col+d).value=null}}this.store()}addRow(l,u){this.cacheState(),u===void 0?this.table.rows.push(l):this.table.rows.splice(u,0,l)}removeRows(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(l,u)}getColumn(l){const u=this.table.columns[l];return new c(this,u,l)}addColumn(l,u,o){this.cacheState(),o===void 0?(this.table.columns.push(l),this.table.rows.forEach((d,g)=>{d.push(u[g])})):(this.table.columns.splice(o,0,l),this.table.rows.forEach((d,g)=>{d.splice(o,0,u[g])}))}removeColumns(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(l,u),this.table.rows.forEach(o=>{o.splice(l,u)})}_assign(l,u,o){this.cacheState(),l[u]=o}get ref(){return this.table.ref}set ref(l){this._assign(this.table,"ref",l)}get name(){return this.table.name}set name(l){this.table.name=l}get displayName(){return this.table.displyName||this.table.name}set displayNamename(l){this.table.displayName=l}get headerRow(){return this.table.headerRow}set headerRow(l){this._assign(this.table,"headerRow",l)}get totalsRow(){return this.table.totalsRow}set totalsRow(l){this._assign(this.table,"totalsRow",l)}get theme(){return this.table.style.name}set theme(l){this.table.style.name=l}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(l){this.table.style.showFirstColumn=l}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(l){this.table.style.showLastColumn=l}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(l){this.table.style.showRowStripes=l}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(l){this.table.style.showColumnStripes=l}}},{"../utils/col-cache":19}],13:[function(e,a,n){const i=e("./worksheet"),c=e("./defined-names"),l=e("../xlsx/xlsx"),u=e("../csv/csv");a.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new c}get xlsx(){return this._xlsx||(this._xlsx=new l(this)),this._xlsx}get csv(){return this._csv||(this._csv=new u(this)),this._csv}get nextId(){for(let o=1;o<this._worksheets.length;o++)if(!this._worksheets[o])return o;return this._worksheets.length||1}addWorksheet(o,d){const g=this.nextId;d&&(typeof d=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),d={properties:{tabColor:{argb:d}}}):(d.argb||d.theme||d.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),d={properties:{tabColor:d}}));const p=this._worksheets.reduce((x,b)=>(b&&b.orderNo)>x?b.orderNo:x,0),h=Object.assign({},d,{id:g,name:o,orderNo:p+1,workbook:this}),f=new i(h);return this._worksheets[g]=f,f}removeWorksheetEx(o){delete this._worksheets[o.id]}removeWorksheet(o){const d=this.getWorksheet(o);d&&d.destroy()}getWorksheet(o){return o===void 0?this._worksheets.find(Boolean):typeof o=="number"?this._worksheets[o]:typeof o=="string"?this._worksheets.find(d=>d&&d.name===o):void 0}get worksheets(){return this._worksheets.slice(1).sort((o,d)=>o.orderNo-d.orderNo).filter(Boolean)}eachSheet(o){this.worksheets.forEach(d=>{o(d,d.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(o){const d=this.media.length;return this.media.push(Object.assign({},o,{type:"image"})),d}getImage(o){return this.media[o]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(o=>o.model),sheets:this.worksheets.map(o=>o.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(o){this.creator=o.creator,this.lastModifiedBy=o.lastModifiedBy,this.lastPrinted=o.lastPrinted,this.created=o.created,this.modified=o.modified,this.company=o.company,this.manager=o.manager,this.title=o.title,this.subject=o.subject,this.keywords=o.keywords,this.category=o.category,this.description=o.description,this.language=o.language,this.revision=o.revision,this.contentStatus=o.contentStatus,this.properties=o.properties,this.calcProperties=o.calcProperties,this._worksheets=[],o.worksheets.forEach(d=>{const{id:g,name:p,state:h}=d,f=o.sheets&&o.sheets.findIndex(x=>x.id===g);(this._worksheets[g]=new i({id:g,name:p,orderNo:f,state:h,workbook:this})).model=d}),this._definedNames.model=o.definedNames,this.views=o.views,this._themes=o.themes,this.media=o.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(e,a,n){const i=e("../utils/under-dash"),c=e("../utils/col-cache"),l=e("./range"),u=e("./row"),o=e("./column"),d=e("./enums"),g=e("./image"),p=e("./table"),h=e("./data-validations"),f=e("../utils/encryptor"),{copyStyle:x}=e("../utils/copy-style");a.exports=class{constructor(b){b=b||{},this._workbook=b.workbook,this.id=b.id,this.orderNo=b.orderNo,this.name=b.name,this.state=b.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},b.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!b.pageSetup||!b.pageSetup.fitToWidth&&!b.pageSetup.fitToHeight||b.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},b.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},b.headerFooter),this.dataValidations=new h,this.views=b.views||[],this.autoFilter=b.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(b){if(b===void 0&&(b="sheet"+this.id),this._name!==b){if(typeof b!="string")throw new Error("The name has to be a string.");if(b==="")throw new Error("The name can't be empty.");if(b==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(b))throw new Error(`Worksheet name ${b} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(b))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+b);if(b&&b.length>31&&(console.warn(`Worksheet name ${b} exceeds 31 chars. This will be truncated`),b=b.substring(0,31)),this._workbook._worksheets.find(v=>v&&v.name.toLowerCase()===b.toLowerCase()))throw new Error("Worksheet name already exists: "+b);this._name=b}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const b=new l;return this._rows.forEach(v=>{if(v){const _=v.dimensions;_&&b.expand(v.number,_.min,v.number,_.max)}}),b}get columns(){return this._columns}set columns(b){this._headerRowCount=b.reduce((N,E)=>{const O=(E.header?1:E.headers&&E.headers.length)||0;return Math.max(N,O)},0);let v=1;const _=this._columns=[];b.forEach(N=>{const E=new o(this,v++,!1);_.push(E),E.defn=N})}getColumnKey(b){return this._keys[b]}setColumnKey(b,v){this._keys[b]=v}deleteColumnKey(b){delete this._keys[b]}eachColumnKey(b){i.each(this._keys,b)}getColumn(b){if(typeof b=="string"){const v=this._keys[b];if(v)return v;b=c.l2n(b)}if(this._columns||(this._columns=[]),b>this._columns.length){let v=this._columns.length+1;for(;v<=b;)this._columns.push(new o(this,v++))}return this._columns[b-1]}spliceColumns(b,v){const _=this._rows.length;for(var N=arguments.length,E=new Array(N>2?N-2:0),O=2;O<N;O++)E[O-2]=arguments[O];if(E.length>0)for(let U=0;U<_;U++){const W=[b,v];E.forEach(q=>{W.push(q[U]||null)});const Y=this.getRow(U+1);Y.splice.apply(Y,W)}else this._rows.forEach(U=>{U&&U.splice(b,v)});const F=E.length-v,z=b+v,P=this._columns.length;if(F<0)for(let U=b+E.length;U<=P;U++)this.getColumn(U).defn=this.getColumn(U-F).defn;else if(F>0)for(let U=P;U>=z;U--)this.getColumn(U+F).defn=this.getColumn(U).defn;for(let U=b;U<b+E.length;U++)this.getColumn(U).defn=null;this.workbook.definedNames.spliceColumns(this.name,b,v,E.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let b=0;return this.eachRow(v=>{b=Math.max(b,v.cellCount)}),b}get actualColumnCount(){const b=[];let v=0;return this.eachRow(_=>{_.eachCell(N=>{let{col:E}=N;b[E]||(b[E]=!0,v++)})}),v}_commitRow(){}get _lastRowNumber(){const b=this._rows;let v=b.length;for(;v>0&&b[v-1]===void 0;)v--;return v}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(b){return this._rows[b-1]}findRows(b,v){return this._rows.slice(b-1,b-1+v)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let b=0;return this.eachRow(()=>{b++}),b}getRow(b){let v=this._rows[b-1];return v||(v=this._rows[b-1]=new u(this,b)),v}getRows(b,v){if(v<1)return;const _=[];for(let N=b;N<b+v;N++)_.push(this.getRow(N));return _}addRow(b){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const _=this._nextRow,N=this.getRow(_);return N.values=b,this._setStyleOption(_,v[0]==="i"?v:"n"),N}addRows(b){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const _=[];return b.forEach(N=>{_.push(this.addRow(N,v))}),_}insertRow(b,v){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(b,0,v),this._setStyleOption(b,_),this.getRow(b)}insertRows(b,v){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(b,0,...v),_!=="n")for(let N=0;N<v.length;N++)_[0]==="o"&&this.findRow(v.length+b+N)!==void 0?this._copyStyle(v.length+b+N,b+N,_[1]==="+"):_[0]==="i"&&this.findRow(b-1)!==void 0&&this._copyStyle(b-1,b+N,_[1]==="+");return this.getRows(b,v.length)}_setStyleOption(b){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";v[0]==="o"&&this.findRow(b+1)!==void 0?this._copyStyle(b+1,b,v[1]==="+"):v[0]==="i"&&this.findRow(b-1)!==void 0&&this._copyStyle(b-1,b,v[1]==="+")}_copyStyle(b,v){let _=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const N=this.getRow(b),E=this.getRow(v);E.style=x(N.style),N.eachCell({includeEmpty:_},(O,F)=>{E.getCell(F).style=x(O.style)}),E.height=N.height}duplicateRow(b,v){let _=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const N=this._rows[b-1],E=new Array(v).fill(N.values);this.spliceRows(b+1,_?0:v,...E);for(let O=0;O<v;O++){const F=this._rows[b+O];F.style=N.style,F.height=N.height,N.eachCell({includeEmpty:!0},(z,P)=>{F.getCell(P).style=z.style})}}spliceRows(b,v){const _=b+v;for(var N=arguments.length,E=new Array(N>2?N-2:0),O=2;O<N;O++)E[O-2]=arguments[O];const F=E.length,z=F-v,P=this._rows.length;let U,W;if(z<0)for(b===P&&(this._rows[P-1]=void 0),U=_;U<=P;U++)if(W=this._rows[U-1],W){const Y=this.getRow(U+z);Y.values=W.values,Y.style=W.style,Y.height=W.height,W.eachCell({includeEmpty:!0},(q,M)=>{Y.getCell(M).style=q.style}),this._rows[U-1]=void 0}else this._rows[U+z-1]=void 0;else if(z>0)for(U=P;U>=_;U--)if(W=this._rows[U-1],W){const Y=this.getRow(U+z);Y.values=W.values,Y.style=W.style,Y.height=W.height,W.eachCell({includeEmpty:!0},(q,M)=>{if(Y.getCell(M).style=q.style,q._value.constructor.name==="MergeValue"){const D=this.getRow(q._row._number+F).getCell(M),T=q._value._master,C=this.getRow(T._row._number+F).getCell(T._column._number);D.merge(C)}})}else this._rows[U+z-1]=void 0;for(U=0;U<F;U++){const Y=this.getRow(b+U);Y.style={},Y.values=E[U]}this.workbook.definedNames.spliceRows(this.name,b,v,F)}eachRow(b,v){if(v||(v=b,b=void 0),b&&b.includeEmpty){const _=this._rows.length;for(let N=1;N<=_;N++)v(this.getRow(N),N)}else this._rows.forEach(_=>{_&&_.hasValues&&v(_,_.number)})}getSheetValues(){const b=[];return this._rows.forEach(v=>{v&&(b[v.number]=v.values)}),b}findCell(b,v){const _=c.getAddress(b,v),N=this._rows[_.row-1];return N?N.findCell(_.col):void 0}getCell(b,v){const _=c.getAddress(b,v);return this.getRow(_.row).getCellEx(_)}mergeCells(){for(var b=arguments.length,v=new Array(b),_=0;_<b;_++)v[_]=arguments[_];const N=new l(v);this._mergeCellsInternal(N)}mergeCellsWithoutStyle(){for(var b=arguments.length,v=new Array(b),_=0;_<b;_++)v[_]=arguments[_];const N=new l(v);this._mergeCellsInternal(N,!0)}_mergeCellsInternal(b,v){i.each(this._merges,N=>{if(N.intersects(b))throw new Error("Cannot merge already merged cells")});const _=this.getCell(b.top,b.left);for(let N=b.top;N<=b.bottom;N++)for(let E=b.left;E<=b.right;E++)(N>b.top||E>b.left)&&this.getCell(N,E).merge(_,v);this._merges[_.address]=b}_unMergeMaster(b){const v=this._merges[b.address];if(v){for(let _=v.top;_<=v.bottom;_++)for(let N=v.left;N<=v.right;N++)this.getCell(_,N).unmerge();delete this._merges[b.address]}}get hasMerges(){return i.some(this._merges,Boolean)}unMergeCells(){for(var b=arguments.length,v=new Array(b),_=0;_<b;_++)v[_]=arguments[_];const N=new l(v);for(let E=N.top;E<=N.bottom;E++)for(let O=N.left;O<=N.right;O++){const F=this.findCell(E,O);F&&(F.type===d.ValueType.Merge?this._unMergeMaster(F.master):this._merges[F.address]&&this._unMergeMaster(F))}}fillFormula(b,v,_){let N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const E=c.decode(b),{top:O,left:F,bottom:z,right:P}=E,U=P-F+1,W=c.encodeAddress(O,F),Y=N==="shared";let q;q=typeof _=="function"?_:Array.isArray(_)?Array.isArray(_[0])?(D,T)=>_[D-O][T-F]:(D,T)=>_[(D-O)*U+(T-F)]:()=>{};let M=!0;for(let D=O;D<=z;D++)for(let T=F;T<=P;T++)M?(this.getCell(D,T).value={shareType:N,formula:v,ref:b,result:q(D,T)},M=!1):this.getCell(D,T).value=Y?{sharedFormula:W,result:q(D,T)}:q(D,T)}addImage(b,v){const _={type:"image",imageId:b,range:v};this._media.push(new g(this,_))}getImages(){return this._media.filter(b=>b.type==="image")}addBackgroundImage(b){const v={type:"background",imageId:b};this._media.push(new g(this,v))}getBackgroundImageId(){const b=this._media.find(v=>v.type==="background");return b&&b.imageId}protect(b,v){return new Promise(_=>{this.sheetProtection={sheet:!0},v&&"spinCount"in v&&(v.spinCount=Number.isFinite(v.spinCount)?Math.round(Math.max(0,v.spinCount)):1e5),b&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=f.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=v&&"spinCount"in v?v.spinCount:1e5,this.sheetProtection.hashValue=f.convertPasswordToHash(b,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),v&&(this.sheetProtection=Object.assign(this.sheetProtection,v),!b&&"spinCount"in v&&delete this.sheetProtection.spinCount),_()})}unprotect(){this.sheetProtection=null}addTable(b){const v=new p(this,b);return this.tables[b.name]=v,v}getTable(b){return this.tables[b]}removeTable(b){delete this.tables[b]}getTables(){return Object.values(this.tables)}addConditionalFormatting(b){this.conditionalFormattings.push(b)}removeConditionalFormatting(b){typeof b=="number"?this.conditionalFormattings.splice(b,1):this.conditionalFormattings=b instanceof Function?this.conditionalFormattings.filter(b):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(b){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=b}get model(){const b={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(N=>N.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(N=>N.model),conditionalFormattings:this.conditionalFormattings};b.cols=o.toModel(this.columns);const v=b.rows=[],_=b.dimensions=new l;return this._rows.forEach(N=>{const E=N&&N.model;E&&(_.expand(E.number,E.min,E.number,E.max),v.push(E))}),b.merges=[],i.each(this._merges,N=>{b.merges.push(N.range)}),b}_parseRows(b){this._rows=[],b.rows.forEach(v=>{const _=new u(this,v.number);this._rows[_.number-1]=_,_.model=v})}_parseMergeCells(b){i.each(b.mergeCells,v=>{this.mergeCellsWithoutStyle(v)})}set model(b){this.name=b.name,this._columns=o.fromModel(this,b.cols),this._parseRows(b),this._parseMergeCells(b),this.dataValidations=new h(b.dataValidations),this.properties=b.properties,this.pageSetup=b.pageSetup,this.headerFooter=b.headerFooter,this.views=b.views,this.autoFilter=b.autoFilter,this._media=b.media.map(v=>new g(this,v)),this.sheetProtection=b.sheetProtection,this.tables=b.tables.reduce((v,_)=>{const N=new p;return N.model=_,v[_.name]=N,v},{}),this.conditionalFormattings=b.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,a,n){e("core-js/modules/es.promise"),e("core-js/modules/es.promise.finally"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");const i={Workbook:e("./doc/workbook")},c=e("./doc/enums");Object.keys(c).forEach(l=>{i[l]=c[l]}),a.exports=i},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(e,a,n){const i=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");n.bufferToString=function(c){return typeof c=="string"?c:i?i.decode(c):c.toString()}},{}],17:[function(e,a,n){const i=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:c}=e("buffer");n.stringToBuffer=function(l){return typeof l!="string"?l:i?c.from(i.encode(l).buffer):c.from(l)}},{buffer:220}],18:[function(e,a,n){const i=e("./under-dash"),c=e("./col-cache");a.exports=class{constructor(l){this.template=l,this.sheets={}}addCell(l){this.addCellEx(c.decodeEx(l))}getCell(l){return this.findCellEx(c.decodeEx(l),!0)}findCell(l){return this.findCellEx(c.decodeEx(l),!1)}findCellAt(l,u,o){const d=this.sheets[l],g=d&&d[u];return g&&g[o]}addCellEx(l){if(l.top)for(let u=l.top;u<=l.bottom;u++)for(let o=l.left;o<=l.right;o++)this.getCellAt(l.sheetName,u,o);else this.findCellEx(l,!0)}getCellEx(l){return this.findCellEx(l,!0)}findCellEx(l,u){const o=this.findSheet(l,u),d=this.findSheetRow(o,l,u);return this.findRowCell(d,l,u)}getCellAt(l,u,o){const d=this.sheets[l]||(this.sheets[l]=[]),g=d[u]||(d[u]=[]);return g[o]||(g[o]={sheetName:l,address:c.n2l(o)+u,row:u,col:o})}removeCellEx(l){const u=this.findSheet(l);if(!u)return;const o=this.findSheetRow(u,l);o&&delete o[l.col]}forEachInSheet(l,u){const o=this.sheets[l];o&&o.forEach((d,g)=>{d&&d.forEach((p,h)=>{p&&u(p,g,h)})})}forEach(l){i.each(this.sheets,(u,o)=>{this.forEachInSheet(o,l)})}map(l){const u=[];return this.forEach(o=>{u.push(l(o))}),u}findSheet(l,u){const o=l.sheetName;return this.sheets[o]?this.sheets[o]:u?this.sheets[o]=[]:void 0}findSheetRow(l,u,o){const{row:d}=u;return l&&l[d]?l[d]:o?l[d]=[]:void 0}findRowCell(l,u,o){const{col:d}=u;return l&&l[d]?l[d]:o?l[d]=this.template?Object.assign(u,JSON.parse(JSON.stringify(this.template))):u:void 0}spliceRows(l,u,o,d){const g=this.sheets[l];if(g){const p=[];for(let h=0;h<d;h++)p.push([]);g.splice(u,o,...p)}}spliceColumns(l,u,o,d){const g=this.sheets[l];if(g){const p=[];for(let h=0;h<d;h++)p.push(null);i.each(g,h=>{h.splice(u,o,...p)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(e,a,n){const i=/^[A-Z]+\d+$/,c={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:l=>l<=26?1:l<=676?2:3,_fill(l){let u,o,d,g,p,h=1;if(l>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&l>=1){for(;h<=26;)u=this._dictionary[h-1],this._n2l[h]=u,this._l2n[u]=h,h++;this._l2nFill=1}if(this._l2nFill<2&&l>=2){for(h=27;h<=702;)o=h-27,d=o%26,g=Math.floor(o/26),u=this._dictionary[g]+this._dictionary[d],this._n2l[h]=u,this._l2n[u]=h,h++;this._l2nFill=2}if(this._l2nFill<3&&l>=3){for(h=703;h<=16384;)o=h-703,d=o%26,g=Math.floor(o/26)%26,p=Math.floor(o/676),u=this._dictionary[p]+this._dictionary[g]+this._dictionary[d],this._n2l[h]=u,this._l2n[u]=h,h++;this._l2nFill=3}},l2n(l){if(this._l2n[l]||this._fill(l.length),!this._l2n[l])throw new Error("Out of bounds. Invalid column letter: "+l);return this._l2n[l]},n2l(l){if(l<1||l>16384)throw new Error(l+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[l]||this._fill(this._level(l)),this._n2l[l]},_hash:{},validateAddress(l){if(!i.test(l))throw new Error("Invalid Address: "+l);return!0},decodeAddress(l){const u=l.length<5&&this._hash[l];if(u)return u;let o=!1,d="",g=0,p=!1,h="",f=0;for(let b,v=0;v<l.length;v++)if(b=l.charCodeAt(v),!p&&b>=65&&b<=90)o=!0,d+=l[v],g=26*g+b-64;else if(b>=48&&b<=57)p=!0,h+=l[v],f=10*f+b-48;else if(p&&o&&b!==36)break;if(o){if(g>16384)throw new Error("Out of bounds. Invalid column letter: "+d)}else g=void 0;p||(f=void 0);const x={address:l=d+h,col:g,row:f,$col$row:`$${d}$${h}`};return g<=100&&f<=100&&(this._hash[l]=x,this._hash[x.$col$row]=x),x},getAddress(l,u){if(u){const o=this.n2l(u)+l;return this.decodeAddress(o)}return this.decodeAddress(l)},decode(l){const u=l.split(":");if(u.length===2){const o=this.decodeAddress(u[0]),d=this.decodeAddress(u[1]),g={top:Math.min(o.row,d.row),left:Math.min(o.col,d.col),bottom:Math.max(o.row,d.row),right:Math.max(o.col,d.col)};return g.tl=this.n2l(g.left)+g.top,g.br=this.n2l(g.right)+g.bottom,g.dimensions=`${g.tl}:${g.br}`,g}return this.decodeAddress(l)},decodeEx(l){const u=l.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),o=u[1]||u[2],d=u[3],g=d.split(":");if(g.length>1){let h=this.decodeAddress(g[0]),f=this.decodeAddress(g[1]);const x=Math.min(h.row,f.row),b=Math.min(h.col,f.col),v=Math.max(h.row,f.row),_=Math.max(h.col,f.col);return h=this.n2l(b)+x,f=this.n2l(_)+v,{top:x,left:b,bottom:v,right:_,sheetName:o,tl:{address:h,col:b,row:x,$col$row:`$${this.n2l(b)}$${x}`,sheetName:o},br:{address:f,col:_,row:v,$col$row:`$${this.n2l(_)}$${v}`,sheetName:o},dimensions:`${h}:${f}`}}if(d.startsWith("#"))return o?{sheetName:o,error:d}:{error:d};const p=this.decodeAddress(d);return o?{sheetName:o,...p}:p},encodeAddress:(l,u)=>c.n2l(u)+l,encode(){switch(arguments.length){case 2:return c.encodeAddress(arguments[0],arguments[1]);case 4:return`${c.encodeAddress(arguments[0],arguments[1])}:${c.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(l,u){const[o,d,,g,p]=l,[h,f]=u;return h>=o&&h<=g&&f>=d&&f<=p}};a.exports=c},{}],20:[function(e,a,n){const i=(l,u)=>({...l,...u.reduce((o,d)=>(l[d]&&(o[d]={...l[d]}),o),{})}),c=function(l,u,o){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];l[o]&&(u[o]=i(l[o],d))};n.copyStyle=l=>{if(!l)return l;if(u=l,Object.keys(u).length===0)return{};var u;const o={...l};return c(l,o,"font",["color"]),c(l,o,"alignment"),c(l,o,"protection"),l.border&&(c(l,o,"border"),c(l.border,o.border,"top",["color"]),c(l.border,o.border,"left",["color"]),c(l.border,o.border,"bottom",["color"]),c(l.border,o.border,"right",["color"]),c(l.border,o.border,"diagonal",["color"])),l.fill&&(c(l,o,"fill",["fgColor","bgColor","center"]),l.fill.stops&&(o.fill.stops=l.fill.stops.map(d=>i(d,["color"])))),o}},{}],21:[function(e,a,n){(function(i){(function(){const c=e("crypto"),l={hash(u){const o=c.createHash(u);for(var d=arguments.length,g=new Array(d>1?d-1:0),p=1;p<d;p++)g[p-1]=arguments[p];return o.update(i.concat(g)),o.digest()},convertPasswordToHash(u,o,d,g){if(o=o.toLowerCase(),c.getHashes().indexOf(o)<0)throw new Error(`Hash algorithm '${o}' not supported!`);const p=i.from(u,"utf16le");let h=this.hash(o,i.from(d,"base64"),p);for(let f=0;f<g;f++){const x=i.alloc(4);x.writeUInt32LE(f,0),h=this.hash(o,h,x)}return h.toString("base64")},randomBytes:u=>c.randomBytes(u)};a.exports=l}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(e,a,n){const{SaxesParser:i}=e("saxes"),{PassThrough:c}=e("readable-stream"),{bufferToString:l}=e("./browser-buffer-decode");a.exports=async function*(u){u.pipe&&!u[Symbol.asyncIterator]&&(u=u.pipe(new c));const o=new i;let d;o.on("error",p=>{d=p});let g=[];o.on("opentag",p=>g.push({eventType:"opentag",value:p})),o.on("text",p=>g.push({eventType:"text",value:p})),o.on("closetag",p=>g.push({eventType:"closetag",value:p}));for await(const p of u){if(o.write(l(p)),d)throw d;yield g,g=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(e,a,n){const i=e("./col-cache"),c=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,l=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;a.exports={slideFormula:function(u,o,d){const g=i.decode(o),p=i.decode(d);return u.replace(c,(h,f,x,b,v)=>{if(v)return h;const _=l.exec(b);if(_){const N=_[1],E=_[2].toUpperCase(),O=_[3],F=_[4];if(E.length>3||E.length===3&&E>"XFD")return h;let z=i.l2n(E),P=parseInt(F,10);return N||(z+=p.col-g.col),O||(P+=p.row-g.row),(f||"")+(N||"")+i.n2l(z)+(O||"")+P}return h})}}},{"./col-cache":19}],24:[function(e,a,n){(function(i,c){(function(){const l=e("readable-stream"),u=e("./utils"),o=e("./string-buf");class d{constructor(b,v){this._data=b,this._encoding=v}get length(){return this.toBuffer().length}copy(b,v,_,N){return this.toBuffer().copy(b,v,_,N)}toBuffer(){return this._buffer||(this._buffer=c.from(this._data,this._encoding)),this._buffer}}class g{constructor(b){this._data=b}get length(){return this._data.length}copy(b,v,_,N){return this._data._buf.copy(b,v,_,N)}toBuffer(){return this._data.toBuffer()}}class p{constructor(b){this._data=b}get length(){return this._data.length}copy(b,v,_,N){this._data.copy(b,v,_,N)}toBuffer(){return this._data}}class h{constructor(b){this.size=b,this.buffer=c.alloc(b),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const b=c.alloc(this.iWrite-this.iRead);return this.buffer.copy(b,0,this.iRead,this.iWrite),b}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(b){let v;return b===0?null:b===void 0||b>=this.length?(v=this.toBuffer(),this.iRead=this.iWrite,v):(v=c.alloc(b),this.buffer.copy(v,0,this.iRead,b),this.iRead+=b,v)}write(b,v,_){const N=Math.min(_,this.size-this.iWrite);return b.copy(this.buffer,this.iWrite,v,v+N),this.iWrite+=N,N}}const f=function(x){x=x||{},this.bufSize=x.bufSize||1048576,this.buffers=[],this.batch=x.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};u.inherits(f,l.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return c.concat(this.buffers.map(x=>x.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const b=this.buffers[this.buffers.length-1];if(!b.full)return b}const x=new h(this.bufSize);return this.buffers.push(x),x},async _pipe(x){await Promise.all(this.pipes.map(function(b){return new Promise(v=>{b.write(x.toBuffer(),()=>{v()})})}))},_writeToBuffers(x){let b=0;const v=x.length;for(;b<v;)b+=this._getWritableBuffer().write(x,b,v-b)},async write(x,b,v){let _;if(b instanceof Function&&(v=b,b="utf8"),v=v||u.nop,x instanceof o)_=new g(x);else if(x instanceof c)_=new p(x);else{if(!(typeof x=="string"||x instanceof String||x instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");_=new d(x,b)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(_);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(_),i.nextTick(v)):(await this._pipe(_),v());else this.paused||this.emit("data",_.toBuffer()),this._writeToBuffers(_),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(x,b,v){const _=N=>{N?v(N):(this._flush(),this.pipes.forEach(E=>{E.end()}),this.emit("finish"))};x?this.write(x,b,_):_()},read(x){let b;if(x){for(b=[];x&&this.buffers.length&&!this.buffers[0].eod;){const v=this.buffers[0],_=v.read(x);x-=_.length,b.push(_),v.eod&&v.full&&this.buffers.shift()}return c.concat(b)}return b=this.buffers.map(v=>v.toBuffer()).filter(Boolean),this.buffers=[],c.concat(b)},setEncoding(x){this.encoding=x},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(x){this.pipes.push(x),!this.paused&&this.buffers.length&&this.end()},unpipe(x){this.pipes=this.pipes.filter(b=>b!==x)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),a.exports=f}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(e,a,n){(function(i){(function(){a.exports=class{constructor(c){this._buf=i.alloc(c&&c.size||16384),this._encoding=c&&c.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=i.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(c){c=c||0,this._buffer=void 0,this._inPos=c}_grow(c){let l=2*this._buf.length;for(;l<c;)l*=2;const u=i.alloc(l);this._buf.copy(u,0),this._buf=u}addText(c){this._buffer=void 0;let l=this._inPos+this._buf.write(c,this._inPos,this._encoding);for(;l>=this._buf.length-4;)this._grow(this._inPos+c.length),l=this._inPos+this._buf.write(c,this._inPos,this._encoding);this._inPos=l}addStringBuf(c){c.length&&(this._buffer=void 0,this.length+c.length>this.capacity&&this._grow(this.length+c.length),c._buf.copy(this._buf,this._inPos,0,c.length),this._inPos+=c.length)}}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],26:[function(e,a,n){const{toString:i}=Object.prototype,c=/["&<>]/,l={each:function(u,o){u&&(Array.isArray(u)?u.forEach(o):Object.keys(u).forEach(d=>{o(u[d],d)}))},some:function(u,o){return!!u&&(Array.isArray(u)?u.some(o):Object.keys(u).some(d=>o(u[d],d)))},every:function(u,o){return!u||(Array.isArray(u)?u.every(o):Object.keys(u).every(d=>o(u[d],d)))},map:function(u,o){return u?Array.isArray(u)?u.map(o):Object.keys(u).map(d=>o(u[d],d)):[]},keyBy:(u,o)=>u.reduce((d,g)=>(d[g[o]]=g,d),{}),isEqual:function(u,o){const d=typeof u,g=typeof o,p=Array.isArray(u),h=Array.isArray(o);let f;if(d!==g)return!1;switch(typeof u){case"object":if(p||h)return!(!p||!h)&&u.length===o.length&&u.every((x,b)=>{const v=o[b];return l.isEqual(x,v)});if(u===null||o===null)return u===o;if(f=Object.keys(u),Object.keys(o).length!==f.length)return!1;for(const x of f)if(!o.hasOwnProperty(x))return!1;return l.every(u,(x,b)=>{const v=o[b];return l.isEqual(x,v)});default:return u===o}},escapeHtml(u){const o=c.exec(u);if(!o)return u;let d="",g="",p=0,h=o.index;for(;h<u.length;h++){switch(u.charAt(h)){case'"':g="&quot;";break;case"&":g="&amp;";break;case"'":g="&apos;";break;case"<":g="&lt;";break;case">":g="&gt;";break;default:continue}p!==h&&(d+=u.substring(p,h)),p=h+1,d+=g}return p!==h?d+u.substring(p,h):d},strcmp:(u,o)=>u<o?-1:u>o?1:0,isUndefined:u=>i.call(u)==="[object Undefined]",isObject:u=>i.call(u)==="[object Object]",deepMerge(){const u=arguments[0]||{},{length:o}=arguments;let d,g,p;function h(f,x){d=u[x],p=Array.isArray(f),l.isObject(f)||p?(p?(p=!1,g=d&&Array.isArray(d)?d:[]):g=d&&l.isObject(d)?d:{},u[x]=l.deepMerge(g,f)):l.isUndefined(f)||(u[x]=f)}for(let f=0;f<o;f++)l.each(arguments[f],h);return u}};a.exports=l},{}],27:[function(e,a,n){(function(i,c){(function(){const l=e("fs"),u=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,o={nop(){},promiseImmediate:d=>new Promise(g=>{i.setImmediate?c(()=>{g(d)}):setTimeout(()=>{g(d)},1)}),inherits:function(d,g,p,h){d.super_=g,h||(h=p,p=null),p&&Object.keys(p).forEach(x=>{Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(p,x))});const f={constructor:{value:d,enumerable:!1,writable:!1,configurable:!0}};h&&Object.keys(h).forEach(x=>{f[x]=Object.getOwnPropertyDescriptor(h,x)}),d.prototype=Object.create(g.prototype,f)},dateToExcel:(d,g)=>25569+d.getTime()/864e5-(g?1462:0),excelToDate(d,g){const p=Math.round(24*(d-25569+(g?1462:0))*3600*1e3);return new Date(p)},parsePath(d){const g=d.lastIndexOf("/");return{path:d.substring(0,g),name:d.substring(g+1)}},getRelsPath(d){const g=o.parsePath(d);return`${g.path}/_rels/${g.name}.rels`},xmlEncode(d){const g=u.exec(d);if(!g)return d;let p="",h="",f=0,x=g.index;for(;x<d.length;x++){const b=d.charCodeAt(x);switch(b){case 34:h="&quot;";break;case 38:h="&amp;";break;case 39:h="&apos;";break;case 60:h="&lt;";break;case 62:h="&gt;";break;case 127:h="";break;default:if(b<=31&&(b<=8||b>=11&&b!==13)){h="";break}continue}f!==x&&(p+=d.substring(f,x)),f=x+1,h&&(p+=h)}return f!==x?p+d.substring(f,x):p},xmlDecode:d=>d.replace(/&([a-z]*);/g,g=>{switch(g){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return g}}),validInt(d){const g=parseInt(d,10);return Number.isNaN(g)?0:g},isDateFmt(d){return d?(d=(d=d.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:d=>new Promise(g=>{l.access(d,l.constants.F_OK,p=>{g(!p)})})},toIsoDateString:d=>d.toIsoString().subsstr(0,10),parseBoolean:d=>d===!0||d==="true"||d===1||d==="1"};a.exports=o}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{fs:216,timers:523}],28:[function(e,a,n){const i=e("./under-dash"),c=e("./utils");function l(d,g,p){d.push(` ${g}="${c.xmlEncode(p.toString())}"`)}function u(d,g){if(g){const p=[];i.each(g,(h,f)=>{h!==void 0&&l(p,f,h)}),d.push(p.join(""))}}class o{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(g){const p=this._xml;p.push("<?xml"),u(p,g),p.push(`?>
`)}openNode(g,p){const h=this.tos,f=this._xml;h&&this.open&&f.push(">"),this._stack.push(g),f.push("<"),f.push(g),u(f,p),this.leaf=!0,this.open=!0}addAttribute(g,p){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");p!==void 0&&l(this._xml,g,p)}addAttributes(g){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");u(this._xml,g)}writeText(g){const p=this._xml;this.open&&(p.push(">"),this.open=!1),this.leaf=!1,p.push(c.xmlEncode(g.toString()))}writeXml(g){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(g)}closeNode(){const g=this._stack.pop(),p=this._xml;this.leaf?p.push("/>"):(p.push("</"),p.push(g),p.push(">")),this.open=!1,this.leaf=!1}leafNode(g,p,h){this.openNode(g,p),h!==void 0&&this.writeText(h),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const g=this._rollbacks.pop();this._xml.length>g.xml&&this._xml.splice(g.xml,this._xml.length-g.xml),this._stack.length>g.stack&&this._stack.splice(g.stack,this._stack.length-g.stack),this.leaf=g.leaf,this.open=g.open}get xml(){return this.closeAll(),this._xml.join("")}}o.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},a.exports=o},{"./under-dash":26,"./utils":27}],29:[function(e,a,n){(function(i){(function(){const c=e("events"),l=e("jszip"),u=e("./stream-buf"),{stringToBuffer:o}=e("./browser-buffer-encode");class d extends c.EventEmitter{constructor(p){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},p),this.zip=new l,this.stream=new u}append(p,h){h.hasOwnProperty("base64")&&h.base64?this.zip.file(h.name,p,{base64:!0}):(i.browser&&typeof p=="string"&&(p=o(p)),this.zip.file(h.name,p))}async finalize(){const p=await this.zip.generateAsync(this.options);this.stream.end(p),this.emit("finish")}read(p){return this.stream.read(p)}setEncoding(p){return this.stream.setEncoding(p)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(p,h){return this.stream.pipe(p,h)}unpipe(p){return this.stream.unpipe(p)}unshift(p){return this.stream.unshift(p)}wrap(p){return this.stream.wrap(p)}}a.exports={ZipWriter:d}}).call(this)}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(e,a,n){a.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(e,a,n){a.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(e,a,n){const i=e("../../utils/parse-sax"),c=e("../../utils/xml-stream");class l{prepare(){}render(){}parseOpen(o){}parseText(o){}parseClose(o){}reconcile(o,d){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(o=>{o instanceof l?o.reset():o.xform&&o.xform.reset()})}mergeModel(o){this.model=Object.assign(this.model||{},o)}async parse(o){for await(const d of o)for(const{eventType:g,value:p}of d)if(g==="opentag")this.parseOpen(p);else if(g==="text")this.parseText(p);else if(g==="closetag"&&!this.parseClose(p.name))return this.model;return this.model}async parseStream(o){return this.parse(i(o))}get xml(){return this.toXml(this.model)}toXml(o){const d=new c;return this.render(d,o),d.xml}static toAttribute(o,d){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(o===void 0){if(g)return d}else if(g||o!==d)return o.toString()}static toStringAttribute(o,d){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(o,d,g)}static toStringValue(o,d){return o===void 0?d:o}static toBoolAttribute(o,d){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(o===void 0){if(g)return d}else if(g||o!==d)return o?"1":"0"}static toBoolValue(o,d){return o===void 0?d:o==="1"}static toIntAttribute(o,d){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(o,d,g)}static toIntValue(o,d){return o===void 0?d:parseInt(o,10)}static toFloatAttribute(o,d){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(o,d,g)}static toFloatValue(o,d){return o===void 0?d:parseFloat(o)}}a.exports=l},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(e,a,n){const i=e("../base-xform"),c=e("../../../utils/col-cache");function l(o){try{return c.decodeEx(o),!0}catch{return!1}}function u(o){const d=[];let g=!1,p="";return o.split(",").forEach(h=>{if(!h)return;const f=(h.match(/'/g)||[]).length;if(!f)return void(g?p+=h+",":l(h)&&d.push(h));const x=f%2==0;!g&&x&&l(h)?d.push(h):g&&!x?(g=!1,l(p+h)&&d.push(p+h),p=""):(g=!0,p+=h+",")}),d}a.exports=class extends i{render(o,d){o.openNode("definedName",{name:d.name,localSheetId:d.localSheetId}),o.writeText(d.ranges.join(",")),o.closeNode()}parseOpen(o){switch(o.name){case"definedName":return this._parsedName=o.attributes.name,this._parsedLocalSheetId=o.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(o){this._parsedText.push(o)}parseClose(){return this.model={name:this._parsedName,ranges:u(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(e,a,n){const i=e("../../../utils/utils"),c=e("../base-xform");a.exports=class extends c{render(l,u){l.leafNode("sheet",{sheetId:u.id,name:u.name,state:u.state,"r:id":u.rId})}parseOpen(l){return l.name==="sheet"&&(this.model={name:i.xmlDecode(l.attributes.name),id:parseInt(l.attributes.sheetId,10),state:l.attributes.state,rId:l.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{render(c,l){c.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:l.fullCalcOnLoad?1:void 0})}parseOpen(c){return c.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{render(c,l){c.leafNode("workbookPr",{date1904:l.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(c){return c.name==="workbookPr"&&(this.model={date1904:c.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{render(c,l){const u={xWindow:l.x||0,yWindow:l.y||0,windowWidth:l.width||12e3,windowHeight:l.height||24e3,firstSheet:l.firstSheet,activeTab:l.activeTab};l.visibility&&l.visibility!=="visible"&&(u.visibility=l.visibility),c.leafNode("workbookView",u)}parseOpen(c){if(c.name==="workbookView"){const l=this.model={},u=function(d,g,p){const h=g!==void 0?l[d]=g:p;h!==void 0&&(l[d]=h)},o=function(d,g,p){const h=g!==void 0?l[d]=parseInt(g,10):p;h!==void 0&&(l[d]=h)};return o("x",c.attributes.xWindow,0),o("y",c.attributes.yWindow,0),o("width",c.attributes.windowWidth,25e3),o("height",c.attributes.windowHeight,1e4),u("visibility",c.attributes.visibility,"visible"),o("activeTab",c.attributes.activeTab,void 0),o("firstSheet",c.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../../../utils/col-cache"),l=e("../../../utils/xml-stream"),u=e("../base-xform"),o=e("../static-xform"),d=e("../list-xform"),g=e("./defined-name-xform"),p=e("./sheet-xform"),h=e("./workbook-view-xform"),f=e("./workbook-properties-xform"),x=e("./workbook-calc-properties-xform");class b extends u{constructor(){super(),this.map={fileVersion:b.STATIC_XFORMS.fileVersion,workbookPr:new f,bookViews:new d({tag:"bookViews",count:!1,childXform:new h}),sheets:new d({tag:"sheets",count:!1,childXform:new p}),definedNames:new d({tag:"definedNames",count:!1,childXform:new g}),calcPr:new x}}prepare(_){_.sheets=_.worksheets;const N=[];let E=0;_.sheets.forEach(O=>{if(O.pageSetup&&O.pageSetup.printArea&&O.pageSetup.printArea.split("&&").forEach(F=>{const z=F.split(":"),P={name:"_xlnm.Print_Area",ranges:[`'${O.name}'!$${z[0]}:$${z[1]}`],localSheetId:E};N.push(P)}),O.pageSetup&&(O.pageSetup.printTitlesRow||O.pageSetup.printTitlesColumn)){const F=[];if(O.pageSetup.printTitlesColumn){const P=O.pageSetup.printTitlesColumn.split(":");F.push(`'${O.name}'!$${P[0]}:$${P[1]}`)}if(O.pageSetup.printTitlesRow){const P=O.pageSetup.printTitlesRow.split(":");F.push(`'${O.name}'!$${P[0]}:$${P[1]}`)}const z={name:"_xlnm.Print_Titles",ranges:F,localSheetId:E};N.push(z)}E++}),N.length&&(_.definedNames=_.definedNames.concat(N)),(_.media||[]).forEach((O,F)=>{O.name=O.type+(F+1)})}render(_,N){_.openXml(l.StdDocAttributes),_.openNode("workbook",b.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(_),this.map.workbookPr.render(_,N.properties),this.map.bookViews.render(_,N.views),this.map.sheets.render(_,N.sheets),this.map.definedNames.render(_,N.definedNames),this.map.calcPr.render(_,N.calcProperties),_.closeNode()}parseOpen(_){if(this.parser)return this.parser.parseOpen(_),!0;switch(_.name){case"workbook":return!0;default:return this.parser=this.map[_.name],this.parser&&this.parser.parseOpen(_),!0}}parseText(_){this.parser&&this.parser.parseText(_)}parseClose(_){if(this.parser)return this.parser.parseClose(_)||(this.parser=void 0),!0;switch(_){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(_){const N=(_.workbookRels||[]).reduce((P,U)=>(P[U.Id]=U,P),{}),E=[];let O,F=0;(_.sheets||[]).forEach(P=>{const U=N[P.rId];U&&(O=_.worksheetHash["xl/"+U.Target.replace(/^(\s|\/xl\/)+/,"")],O&&(O.name=P.name,O.id=P.id,O.state=P.state,E[F++]=O))});const z=[];i.each(_.definedNames,P=>{if(P.name==="_xlnm.Print_Area"){if(O=E[P.localSheetId],O){O.pageSetup||(O.pageSetup={});const U=c.decodeEx(P.ranges[0]);O.pageSetup.printArea=O.pageSetup.printArea?`${O.pageSetup.printArea}&&${U.dimensions}`:U.dimensions}}else if(P.name==="_xlnm.Print_Titles"){if(O=E[P.localSheetId],O){O.pageSetup||(O.pageSetup={});const U=P.ranges.join(","),W=/\$/g,Y=/\$\d+:\$\d+/,q=U.match(Y);if(q&&q.length){const T=q[0];O.pageSetup.printTitlesRow=T.replace(W,"")}const M=/\$[A-Z]+:\$[A-Z]+/,D=U.match(M);if(D&&D.length){const T=D[0];O.pageSetup.printTitlesColumn=T.replace(W,"")}}}else z.push(P)}),_.definedNames=z,_.media.forEach((P,U)=>{P.index=U})}}b.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},b.STATIC_XFORMS={fileVersion:new o({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},a.exports=b},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(e,a,n){const i=e("../strings/rich-text-xform"),c=e("../../../utils/utils"),l=e("../base-xform"),u=a.exports=function(o){this.model=o};c.inherits(u,l,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new i),this._richTextXform},render(o,d){d=d||this.model,o.openNode("comment",{ref:d.ref,authorId:0}),o.openNode("text"),d&&d.note&&d.note.texts&&d.note.texts.forEach(g=>{this.richTextXform.render(o,g)}),o.closeNode(),o.closeNode()},parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case"comment":return this.model={type:"note",note:{texts:[]},...o.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(o),!0;default:return!1}},parseText(o){this.parser&&this.parser.parseText(o)},parseClose(o){switch(o){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(o),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(e,a,n){const i=e("../../../utils/xml-stream"),c=e("../../../utils/utils"),l=e("../base-xform"),u=e("./comment-xform"),o=a.exports=function(){this.map={comment:new u}};c.inherits(o,l,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(d,g){g=g||this.model,d.openXml(i.StdDocAttributes),d.openNode("comments",o.COMMENTS_ATTRIBUTES),d.openNode("authors"),d.leafNode("author",null,"Author"),d.closeNode(),d.openNode("commentList"),g.comments.forEach(p=>{this.map.comment.render(d,p)}),d.closeNode(),d.closeNode()},parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(d),!0;default:return!1}},parseText(d){this.parser&&this.parser.parseText(d)},parseClose(d){switch(d){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(d),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(e,a,n){const i=e("../../base-xform");a.exports=class extends i{constructor(c){super(),this._model=c}get tag(){return this._model&&this._model.tag}render(c,l,u){(l===u[2]||this.tag==="x:SizeWithCells"&&l===u[1])&&c.leafNode(this.tag)}parseOpen(c){switch(c.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(e,a,n){const i=e("../../base-xform");a.exports=class extends i{constructor(c){super(),this._model=c}get tag(){return this._model&&this._model.tag}render(c,l){c.leafNode(this.tag,null,l)}parseOpen(c){switch(c.name){case this.tag:return this.text="",!0;default:return!1}}parseText(c){this.text=c}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"x:Anchor"}getAnchorRect(c){const l=Math.floor(c.left),u=Math.floor(68*(c.left-l)),o=Math.floor(c.top),d=Math.floor(18*(c.top-o)),g=Math.floor(c.right),p=Math.floor(68*(c.right-g)),h=Math.floor(c.bottom);return[l,u,o,d,g,p,h,Math.floor(18*(c.bottom-h))]}getDefaultRect(c){const l=c.col,u=Math.max(c.row-2,0);return[l,6,u,14,l+2,2,u+4,16]}render(c,l){const u=l.anchor?this.getAnchorRect(l.anchor):this.getDefaultRect(l.refAddress);c.leafNode("x:Anchor",null,u.join(", "))}parseOpen(c){switch(c.name){case this.tag:return this.text="",!0;default:return!1}}parseText(c){this.text=c}parseClose(){return!1}}},{"../base-xform":32}],44:[function(e,a,n){const i=e("../base-xform"),c=e("./vml-anchor-xform"),l=e("./style/vml-protection-xform"),u=e("./style/vml-position-xform"),o=["twoCells","oneCells","absolute"];a.exports=class extends i{constructor(){super(),this.map={"x:Anchor":new c,"x:Locked":new l({tag:"x:Locked"}),"x:LockText":new l({tag:"x:LockText"}),"x:SizeWithCells":new u({tag:"x:SizeWithCells"}),"x:MoveWithCells":new u({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(d,g){const{protection:p,editAs:h}=g.note;d.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(d,h,o),this.map["x:SizeWithCells"].render(d,h,o),this.map["x:Anchor"].render(d,g),this.map["x:Locked"].render(d,p.locked),d.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(d,p.lockText),d.leafNode("x:Row",null,g.refAddress.row-1),d.leafNode("x:Column",null,g.refAddress.col-1),d.closeNode()}parseOpen(d){switch(d.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const d=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),g=Object.keys(d).length;this.model.editAs=o[g],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(e,a,n){const i=e("../../../utils/xml-stream"),c=e("../base-xform"),l=e("./vml-shape-xform");class u extends c{constructor(){super(),this.map={"v:shape":new l}}get tag(){return"xml"}render(d,g){d.openXml(i.StdDocAttributes),d.openNode(this.tag,u.DRAWING_ATTRIBUTES),d.openNode("o:shapelayout",{"v:ext":"edit"}),d.leafNode("o:idmap",{"v:ext":"edit",data:1}),d.closeNode(),d.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),d.leafNode("v:stroke",{joinstyle:"miter"}),d.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),d.closeNode(),g.comments.forEach((p,h)=>{this.map["v:shape"].render(d,p,h)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(d){case this.tag:return!1;default:return!0}}reconcile(d,g){d.anchors.forEach(p=>{p.br?this.map["xdr:twoCellAnchor"].reconcile(p,g):this.map["xdr:oneCellAnchor"].reconcile(p,g)})}}u.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},a.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(e,a,n){const i=e("../base-xform"),c=e("./vml-textbox-xform"),l=e("./vml-client-data-xform");class u extends i{constructor(){super(),this.map={"v:textbox":new c,"x:ClientData":new l}}get tag(){return"v:shape"}render(d,g,p){d.openNode("v:shape",u.V_SHAPE_ATTRIBUTES(g,p)),d.leafNode("v:fill",{color2:"infoBackground [80]"}),d.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),d.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(d,g),this.map["x:ClientData"].render(d,g),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset(),this.model={margins:{insetmode:d.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}u.V_SHAPE_ATTRIBUTES=(o,d)=>({id:"_x0000_s"+(1025+d),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":o.note.margins&&o.note.margins.insetmode}),a.exports=u},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"v:textbox"}conversionUnit(c,l,u){return`${parseFloat(c)*l.toFixed(2)}${u}`}reverseConversionUnit(c){return(c||"").split(",").map(l=>Number(parseFloat(this.conversionUnit(parseFloat(l),.1,"")).toFixed(2)))}render(c,l){const u={style:"mso-direction-alt:auto"};if(l&&l.note){let{inset:o}=l.note&&l.note.margins;Array.isArray(o)&&(o=o.map(d=>this.conversionUnit(d,10,"mm")).join(",")),o&&(u.inset=o)}c.openNode("v:textbox",u),c.leafNode("div",{style:"text-align:left"}),c.closeNode()}parseOpen(c){switch(c.name){case this.tag:return this.model={inset:this.reverseConversionUnit(c.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(c){switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(e,a,n){const i=e("./base-xform");a.exports=class extends i{createNewModel(c){return{}}parseOpen(c){return this.parser=this.parser||this.map[c.name],this.parser?(this.parser.parseOpen(c),!0):c.name===this.tag&&(this.model=this.createNewModel(c),!0)}parseText(c){this.parser&&this.parser.parseText(c)}onParserClose(c,l){this.model[c]=l.model}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.onParserClose(c,this.parser),this.parser=void 0),!0):c!==this.tag}}},{"./base-xform":32}],49:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{render(c,l){c.openNode("HeadingPairs"),c.openNode("vt:vector",{size:2,baseType:"variant"}),c.openNode("vt:variant"),c.leafNode("vt:lpstr",void 0,"Worksheets"),c.closeNode(),c.openNode("vt:variant"),c.leafNode("vt:i4",void 0,l.length),c.closeNode(),c.closeNode(),c.closeNode()}parseOpen(c){return c.name==="HeadingPairs"}parseText(){}parseClose(c){return c!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{render(c,l){c.openNode("TitlesOfParts"),c.openNode("vt:vector",{size:l.length,baseType:"lpstr"}),l.forEach(u=>{c.leafNode("vt:lpstr",void 0,u.name)}),c.closeNode(),c.closeNode()}parseOpen(c){return c.name==="TitlesOfParts"}parseText(){}parseClose(c){return c!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(e,a,n){const i=e("../../../utils/xml-stream"),c=e("../base-xform"),l=e("../simple/string-xform"),u=e("./app-heading-pairs-xform"),o=e("./app-titles-of-parts-xform");class d extends c{constructor(){super(),this.map={Company:new l({tag:"Company"}),Manager:new l({tag:"Manager"}),HeadingPairs:new u,TitleOfParts:new o}}render(p,h){p.openXml(i.StdDocAttributes),p.openNode("Properties",d.PROPERTY_ATTRIBUTES),p.leafNode("Application",void 0,"Microsoft Excel"),p.leafNode("DocSecurity",void 0,"0"),p.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(p,h.worksheets),this.map.TitleOfParts.render(p,h.worksheets),this.map.Company.render(p,h.company||""),this.map.Manager.render(p,h.manager),p.leafNode("LinksUpToDate",void 0,"false"),p.leafNode("SharedDoc",void 0,"false"),p.leafNode("HyperlinksChanged",void 0,"false"),p.leafNode("AppVersion",void 0,"16.0300"),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"Properties":return!0;default:return this.parser=this.map[p.name],!!this.parser&&(this.parser.parseOpen(p),!0)}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){if(this.parser)return this.parser.parseClose(p)||(this.parser=void 0),!0;switch(p){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}d.DateFormat=function(g){return g.toISOString().replace(/[.]\d{3,6}/,"")},d.DateAttrs={"xsi:type":"dcterms:W3CDTF"},d.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},a.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(e,a,n){const i=e("../../../utils/xml-stream"),c=e("../base-xform");class l extends c{render(o,d){o.openXml(i.StdDocAttributes),o.openNode("Types",l.PROPERTY_ATTRIBUTES);const g={};(d.media||[]).forEach(p=>{if(p.type==="image"){const h=p.extension;g[h]||(g[h]=!0,o.leafNode("Default",{Extension:h,ContentType:"image/"+h}))}}),o.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),o.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),o.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),d.worksheets.forEach(p=>{const h=`/xl/worksheets/sheet${p.id}.xml`;o.leafNode("Override",{PartName:h,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),o.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),o.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),d.sharedStrings&&d.sharedStrings.count&&o.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),d.tables&&d.tables.forEach(p=>{o.leafNode("Override",{PartName:"/xl/tables/"+p.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),d.drawings&&d.drawings.forEach(p=>{o.leafNode("Override",{PartName:`/xl/drawings/${p.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),d.commentRefs&&(o.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),d.commentRefs.forEach(p=>{let{commentName:h}=p;o.leafNode("Override",{PartName:`/xl/${h}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),o.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),o.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),o.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}l.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},a.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(e,a,n){const i=e("../../../utils/xml-stream"),c=e("../base-xform"),l=e("../simple/date-xform"),u=e("../simple/string-xform"),o=e("../simple/integer-xform");class d extends c{constructor(){super(),this.map={"dc:creator":new u({tag:"dc:creator"}),"dc:title":new u({tag:"dc:title"}),"dc:subject":new u({tag:"dc:subject"}),"dc:description":new u({tag:"dc:description"}),"dc:identifier":new u({tag:"dc:identifier"}),"dc:language":new u({tag:"dc:language"}),"cp:keywords":new u({tag:"cp:keywords"}),"cp:category":new u({tag:"cp:category"}),"cp:lastModifiedBy":new u({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new l({tag:"cp:lastPrinted",format:d.DateFormat}),"cp:revision":new o({tag:"cp:revision"}),"cp:version":new u({tag:"cp:version"}),"cp:contentStatus":new u({tag:"cp:contentStatus"}),"cp:contentType":new u({tag:"cp:contentType"}),"dcterms:created":new l({tag:"dcterms:created",attrs:d.DateAttrs,format:d.DateFormat}),"dcterms:modified":new l({tag:"dcterms:modified",attrs:d.DateAttrs,format:d.DateFormat})}}render(p,h){p.openXml(i.StdDocAttributes),p.openNode("cp:coreProperties",d.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(p,h.creator),this.map["dc:title"].render(p,h.title),this.map["dc:subject"].render(p,h.subject),this.map["dc:description"].render(p,h.description),this.map["dc:identifier"].render(p,h.identifier),this.map["dc:language"].render(p,h.language),this.map["cp:keywords"].render(p,h.keywords),this.map["cp:category"].render(p,h.category),this.map["cp:lastModifiedBy"].render(p,h.lastModifiedBy),this.map["cp:lastPrinted"].render(p,h.lastPrinted),this.map["cp:revision"].render(p,h.revision),this.map["cp:version"].render(p,h.version),this.map["cp:contentStatus"].render(p,h.contentStatus),this.map["cp:contentType"].render(p,h.contentType),this.map["dcterms:created"].render(p,h.created),this.map["dcterms:modified"].render(p,h.modified),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[p.name],this.parser)return this.parser.parseOpen(p),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(p))}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){if(this.parser)return this.parser.parseClose(p)||(this.parser=void 0),!0;switch(p){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+p)}}}d.DateFormat=function(g){return g.toISOString().replace(/[.]\d{3}/,"")},d.DateAttrs={"xsi:type":"dcterms:W3CDTF"},d.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},a.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{render(c,l){c.leafNode("Relationship",l)}parseOpen(c){switch(c.name){case"Relationship":return this.model=c.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(e,a,n){const i=e("../../../utils/xml-stream"),c=e("../base-xform"),l=e("./relationship-xform");class u extends c{constructor(){super(),this.map={Relationship:new l}}render(d,g){g=g||this._values,d.openXml(i.StdDocAttributes),d.openNode("Relationships",u.RELATIONSHIPS_ATTRIBUTES),g.forEach(p=>{this.map.Relationship.render(d,p)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[d.name],this.parser)return this.parser.parseOpen(d),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(d))}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(d){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+d)}}}u.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},a.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset(),this.model={range:{editAs:c.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(c){this.parser&&this.parser.parseText(c)}reconcilePicture(c,l){if(c&&c.rId){const u=l.rels[c.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(u){const o=u[1],d=l.mediaIndex[o];return l.media[d]}}}}},{"../base-xform":32}],57:[function(e,a,n){const i=e("../base-xform"),c=e("./blip-xform");a.exports=class extends i{constructor(){super(),this.map={"a:blip":new c}}get tag(){return"xdr:blipFill"}render(l,u){l.openNode(this.tag),this.map["a:blip"].render(l,u),l.openNode("a:stretch"),l.leafNode("a:fillRect"),l.closeNode(),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"a:blip"}render(c,l){c.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":l.rId,cstate:"print"})}parseOpen(c){switch(c.name){case this.tag:return this.model={rId:c.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(c){switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"xdr:cNvPicPr"}render(c){c.openNode(this.tag),c.leafNode("a:picLocks",{noChangeAspect:"1"}),c.closeNode()}parseOpen(c){switch(c.name){case this.tag:default:return!0}}parseText(){}parseClose(c){switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(e,a,n){const i=e("../base-xform"),c=e("./hlink-click-xform"),l=e("./ext-lst-xform");a.exports=class extends i{constructor(){super(),this.map={"a:hlinkClick":new c,"a:extLst":new l}}get tag(){return"xdr:cNvPr"}render(u,o){u.openNode(this.tag,{id:o.index,name:"Picture "+o.index}),this.map["a:hlinkClick"].render(u,o),this.map["a:extLst"].render(u,o),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(e,a,n){const i=e("../base-xform"),c=e("../simple/integer-xform");a.exports=class extends i{constructor(l){super(),this.tag=l.tag,this.map={"xdr:col":new c({tag:"xdr:col",zero:!0}),"xdr:colOff":new c({tag:"xdr:colOff",zero:!0}),"xdr:row":new c({tag:"xdr:row",zero:!0}),"xdr:rowOff":new c({tag:"xdr:rowOff",zero:!0})}}render(l,u){l.openNode(this.tag),this.map["xdr:col"].render(l,u.nativeCol),this.map["xdr:colOff"].render(l,u.nativeColOff),this.map["xdr:row"].render(l,u.nativeRow),this.map["xdr:rowOff"].render(l,u.nativeRowOff),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(e,a,n){const i=e("../../../utils/col-cache"),c=e("../../../utils/xml-stream"),l=e("../base-xform"),u=e("./two-cell-anchor-xform"),o=e("./one-cell-anchor-xform");class d extends l{constructor(){super(),this.map={"xdr:twoCellAnchor":new u,"xdr:oneCellAnchor":new o}}prepare(p){p.anchors.forEach((h,f)=>{h.anchorType=function(x){return(typeof x.range=="string"?i.decode(x.range):x.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(h),this.map[h.anchorType].prepare(h,{index:f})})}get tag(){return"xdr:wsDr"}render(p,h){p.openXml(c.StdDocAttributes),p.openNode(this.tag,d.DRAWING_ATTRIBUTES),h.anchors.forEach(f=>{this.map[f.anchorType].render(p,f)}),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[p.name],this.parser&&this.parser.parseOpen(p)}return!0}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){if(this.parser)return this.parser.parseClose(p)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(p){case this.tag:return!1;default:return!0}}reconcile(p,h){p.anchors.forEach(f=>{f.br?this.map["xdr:twoCellAnchor"].reconcile(f,h):this.map["xdr:oneCellAnchor"].reconcile(f,h)})}}d.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},a.exports=d},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"a:extLst"}render(c){c.openNode(this.tag),c.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),c.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),c.closeNode(),c.closeNode()}parseOpen(c){switch(c.name){case this.tag:default:return!0}}parseText(){}parseClose(c){switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{constructor(c){super(),this.tag=c.tag,this.map={}}render(c,l){c.openNode(this.tag);const u=Math.floor(9525*l.width),o=Math.floor(9525*l.height);c.addAttribute("cx",u),c.addAttribute("cy",o),c.closeNode()}parseOpen(c){return c.name===this.tag&&(this.model={width:parseInt(c.attributes.cx||"0",10)/9525,height:parseInt(c.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"a:hlinkClick"}render(c,l){l.hyperlinks&&l.hyperlinks.rId&&c.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":l.hyperlinks.rId,tooltip:l.hyperlinks.tooltip})}parseOpen(c){switch(c.name){case this.tag:return this.model={hyperlinks:{rId:c.attributes["r:id"],tooltip:c.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(e,a,n){const i=e("../base-xform"),c=e("./c-nv-pr-xform"),l=e("./c-nv-pic-pr-xform");a.exports=class extends i{constructor(){super(),this.map={"xdr:cNvPr":new c,"xdr:cNvPicPr":new l}}get tag(){return"xdr:nvPicPr"}render(u,o){u.openNode(this.tag),this.map["xdr:cNvPr"].render(u,o),this.map["xdr:cNvPicPr"].render(u,o),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(e,a,n){const i=e("./base-cell-anchor-xform"),c=e("../static-xform"),l=e("./cell-position-xform"),u=e("./ext-xform"),o=e("./pic-xform");a.exports=class extends i{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:ext":new u({tag:"xdr:ext"}),"xdr:pic":new o,"xdr:clientData":new c({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(d,g){this.map["xdr:pic"].prepare(d.picture,g)}render(d,g){d.openNode(this.tag,{editAs:g.range.editAs||"oneCell"}),this.map["xdr:from"].render(d,g.range.tl),this.map["xdr:ext"].render(d,g.range.ext),this.map["xdr:pic"].render(d,g.picture),this.map["xdr:clientData"].render(d,{}),d.closeNode()}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(d,g){d.medium=this.reconcilePicture(d.picture,g)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(e,a,n){const i=e("../base-xform"),c=e("../static-xform"),l=e("./blip-fill-xform"),u=e("./nv-pic-pr-xform"),o=e("./sp-pr");a.exports=class extends i{constructor(){super(),this.map={"xdr:nvPicPr":new u,"xdr:blipFill":new l,"xdr:spPr":new c(o)}}get tag(){return"xdr:pic"}prepare(d,g){d.index=g.index+1}render(d,g){d.openNode(this.tag),this.map["xdr:nvPicPr"].render(d,g),this.map["xdr:blipFill"].render(d,g),this.map["xdr:spPr"].render(d,g),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset();break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(){}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(d){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(e,a,n){a.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(e,a,n){const i=e("./base-cell-anchor-xform"),c=e("../static-xform"),l=e("./cell-position-xform"),u=e("./pic-xform");a.exports=class extends i{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:to":new l({tag:"xdr:to"}),"xdr:pic":new u,"xdr:clientData":new c({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(o,d){this.map["xdr:pic"].prepare(o.picture,d)}render(o,d){o.openNode(this.tag,{editAs:d.range.editAs||"oneCell"}),this.map["xdr:from"].render(o,d.range.tl),this.map["xdr:to"].render(o,d.range.br),this.map["xdr:pic"].render(o,d.picture),this.map["xdr:clientData"].render(o,{}),o.closeNode()}parseClose(o){if(this.parser)return this.parser.parseClose(o)||(this.parser=void 0),!0;switch(o){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(o,d){o.medium=this.reconcilePicture(o.picture,d)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(e,a,n){const i=e("./base-xform");a.exports=class extends i{constructor(c){super(),this.tag=c.tag,this.always=!!c.always,this.count=c.count,this.empty=c.empty,this.$count=c.$count||"count",this.$=c.$,this.childXform=c.childXform,this.maxItems=c.maxItems}prepare(c,l){const{childXform:u}=this;c&&c.forEach((o,d)=>{l.index=d,u.prepare(o,l)})}render(c,l){if(this.always||l&&l.length){c.openNode(this.tag,this.$),this.count&&c.addAttribute(this.$count,l&&l.length||0);const{childXform:u}=this;(l||[]).forEach((o,d)=>{u.render(c,o,d)}),c.closeNode()}else this.empty&&c.leafNode(this.tag)}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(c)&&(this.parser=this.childXform,!0)}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(c,l){if(c){const{childXform:u}=this;c.forEach(o=>{u.reconcile(o,l)})}}}},{"./base-xform":32}],72:[function(e,a,n){const i=e("../../../utils/col-cache"),c=e("../base-xform");a.exports=class extends c{get tag(){return"autoFilter"}render(l,u){if(u)if(typeof u=="string")l.leafNode("autoFilter",{ref:u});else{const o=function(p){return typeof p=="string"?p:i.getAddress(p.row,p.column).address},d=o(u.from),g=o(u.to);d&&g&&l.leafNode("autoFilter",{ref:`${d}:${g}`})}}parseOpen(l){l.name==="autoFilter"&&(this.model=l.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(e,a,n){const i=e("../../../utils/utils"),c=e("../base-xform"),l=e("../../../doc/range"),u=e("../../../doc/enums"),o=e("../strings/rich-text-xform");function d(g){if(g==null)return u.ValueType.Null;if(g instanceof String||typeof g=="string")return u.ValueType.String;if(typeof g=="number")return u.ValueType.Number;if(typeof g=="boolean")return u.ValueType.Boolean;if(g instanceof Date)return u.ValueType.Date;if(g.text&&g.hyperlink)return u.ValueType.Hyperlink;if(g.formula)return u.ValueType.Formula;if(g.error)return u.ValueType.Error;throw new Error("I could not understand type of value")}a.exports=class extends c{constructor(){super(),this.richTextXForm=new o}get tag(){return"c"}prepare(g,p){const h=p.styles.addStyleModel(g.style||{},function(f){switch(f.type){case u.ValueType.Formula:return d(f.result);default:return f.type}}(g));switch(h&&(g.styleId=h),g.comment&&p.comments.push({...g.comment,ref:g.address}),g.type){case u.ValueType.String:case u.ValueType.RichText:p.sharedStrings&&(g.ssId=p.sharedStrings.add(g.value));break;case u.ValueType.Date:p.date1904&&(g.date1904=!0);break;case u.ValueType.Hyperlink:p.sharedStrings&&g.text!==void 0&&g.text!==null&&(g.ssId=p.sharedStrings.add(g.text)),p.hyperlinks.push({address:g.address,target:g.hyperlink,tooltip:g.tooltip});break;case u.ValueType.Merge:p.merges.add(g);break;case u.ValueType.Formula:if(p.date1904&&(g.date1904=!0),g.shareType==="shared"&&(g.si=p.siFormulae++),g.formula)p.formulae[g.address]=g;else if(g.sharedFormula){const f=p.formulae[g.sharedFormula];if(!f)throw new Error("Shared Formula master must exist above and or left of clone for cell "+g.address);f.si===void 0?(f.shareType="shared",f.si=p.siFormulae++,f.range=new l(f.address,g.address)):f.range&&f.range.expandToAddress(g.address),g.si=f.si}}}renderFormula(g,p){let h=null;switch(p.shareType){case"shared":h={t:"shared",ref:p.ref||p.range.range,si:p.si};break;case"array":h={t:"array",ref:p.ref};break;default:p.si!==void 0&&(h={t:"shared",si:p.si})}switch(d(p.result)){case u.ValueType.Null:g.leafNode("f",h,p.formula);break;case u.ValueType.String:g.addAttribute("t","str"),g.leafNode("f",h,p.formula),g.leafNode("v",null,p.result);break;case u.ValueType.Number:g.leafNode("f",h,p.formula),g.leafNode("v",null,p.result);break;case u.ValueType.Boolean:g.addAttribute("t","b"),g.leafNode("f",h,p.formula),g.leafNode("v",null,p.result?1:0);break;case u.ValueType.Error:g.addAttribute("t","e"),g.leafNode("f",h,p.formula),g.leafNode("v",null,p.result.error);break;case u.ValueType.Date:g.leafNode("f",h,p.formula),g.leafNode("v",null,i.dateToExcel(p.result,p.date1904));break;default:throw new Error("I could not understand type of value")}}render(g,p){if(p.type!==u.ValueType.Null||p.styleId){switch(g.openNode("c"),g.addAttribute("r",p.address),p.styleId&&g.addAttribute("s",p.styleId),p.type){case u.ValueType.Null:break;case u.ValueType.Number:g.leafNode("v",null,p.value);break;case u.ValueType.Boolean:g.addAttribute("t","b"),g.leafNode("v",null,p.value?"1":"0");break;case u.ValueType.Error:g.addAttribute("t","e"),g.leafNode("v",null,p.value.error);break;case u.ValueType.String:case u.ValueType.RichText:p.ssId!==void 0?(g.addAttribute("t","s"),g.leafNode("v",null,p.ssId)):p.value&&p.value.richText?(g.addAttribute("t","inlineStr"),g.openNode("is"),p.value.richText.forEach(h=>{this.richTextXForm.render(g,h)}),g.closeNode("is")):(g.addAttribute("t","str"),g.leafNode("v",null,p.value));break;case u.ValueType.Date:g.leafNode("v",null,i.dateToExcel(p.value,p.date1904));break;case u.ValueType.Hyperlink:p.ssId!==void 0?(g.addAttribute("t","s"),g.leafNode("v",null,p.ssId)):(g.addAttribute("t","str"),g.leafNode("v",null,p.text));break;case u.ValueType.Formula:this.renderFormula(g,p);break;case u.ValueType.Merge:}g.closeNode()}}parseOpen(g){if(this.parser)return this.parser.parseOpen(g),!0;switch(g.name){case"c":return this.model={address:g.attributes.r},this.t=g.attributes.t,g.attributes.s&&(this.model.styleId=parseInt(g.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=g.attributes.si,this.model.shareType=g.attributes.t,this.model.ref=g.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(g),!0;default:return!1}}parseText(g){if(this.parser)this.parser.parseText(g);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+g:g;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+g:g:this.model.value=this.model.value?this.model.value+g:g}}parseClose(g){switch(g){case"c":{const{model:p}=this;if(p.formula||p.shareType)p.type=u.ValueType.Formula,p.value&&(this.t==="str"?p.result=i.xmlDecode(p.value):this.t==="b"?p.result=parseInt(p.value,10)!==0:this.t==="e"?p.result={error:p.value}:p.result=parseFloat(p.value),p.value=void 0);else if(p.value!==void 0)switch(this.t){case"s":p.type=u.ValueType.String,p.value=parseInt(p.value,10);break;case"str":p.type=u.ValueType.String,p.value=i.xmlDecode(p.value);break;case"inlineStr":p.type=u.ValueType.String;break;case"b":p.type=u.ValueType.Boolean,p.value=parseInt(p.value,10)!==0;break;case"e":p.type=u.ValueType.Error,p.value={error:p.value};break;default:p.type=u.ValueType.Number,p.value=parseFloat(p.value)}else p.styleId?p.type=u.ValueType.Null:p.type=u.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(g),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(g),!0)}}reconcile(g,p){const h=g.styleId&&p.styles&&p.styles.getStyleModel(g.styleId);switch(h&&(g.style=h),g.styleId!==void 0&&(g.styleId=void 0),g.type){case u.ValueType.String:typeof g.value=="number"&&p.sharedStrings&&(g.value=p.sharedStrings.getString(g.value)),g.value.richText&&(g.type=u.ValueType.RichText);break;case u.ValueType.Number:h&&i.isDateFmt(h.numFmt)&&(g.type=u.ValueType.Date,g.value=i.excelToDate(g.value,p.date1904));break;case u.ValueType.Formula:g.result!==void 0&&h&&i.isDateFmt(h.numFmt)&&(g.result=i.excelToDate(g.result,p.date1904)),g.shareType==="shared"&&(g.ref?p.formulae[g.si]=g.address:(g.sharedFormula=p.formulae[g.si],delete g.shareType),delete g.si)}const f=p.hyperlinkMap[g.address];f&&(g.type===u.ValueType.Formula?(g.text=g.result,g.result=void 0):(g.text=g.value,g.value=void 0),g.type=u.ValueType.Hyperlink,g.hyperlink=f);const x=p.commentsMap&&p.commentsMap[g.address];x&&(g.comment=x)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(e,a,n){const i=e("../../base-xform");a.exports=class extends i{get tag(){return"x14:cfIcon"}render(c,l){c.leafNode(this.tag,{iconSet:l.iconSet,iconId:l.iconId})}parseOpen(c){let{attributes:l}=c;this.model={iconSet:l.iconSet,iconId:i.toIntValue(l.iconId)}}parseClose(c){return c!==this.tag}}},{"../../base-xform":32}],75:[function(e,a,n){const{v4:i}=e("uuid"),c=e("../../base-xform"),l=e("../../composite-xform"),u=e("./databar-ext-xform"),o=e("./icon-set-ext-xform"),d={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class g extends l{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new u,"x14:iconSet":this.iconSetXform=new o}}get tag(){return"x14:cfRule"}static isExt(h){return h.type==="dataBar"?u.isExt(h):!(h.type!=="iconSet"||!h.custom&&!d[h.iconSet])}prepare(h){g.isExt(h)&&(h.x14Id=`{${i()}}`.toUpperCase())}render(h,f){if(g.isExt(f))switch(f.type){case"dataBar":this.renderDataBar(h,f);break;case"iconSet":this.renderIconSet(h,f)}}renderDataBar(h,f){h.openNode(this.tag,{type:"dataBar",id:f.x14Id}),this.databarXform.render(h,f),h.closeNode()}renderIconSet(h,f){h.openNode(this.tag,{type:"iconSet",priority:f.priority,id:f.x14Id||`{${i()}}`}),this.iconSetXform.render(h,f),h.closeNode()}createNewModel(h){let{attributes:f}=h;return{type:f.type,x14Id:f.id,priority:c.toIntValue(f.priority)}}onParserClose(h,f){Object.assign(this.model,f.model)}}a.exports=g},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(e,a,n){const i=e("../../composite-xform"),c=e("./f-ext-xform");a.exports=class extends i{constructor(){super(),this.map={"xm:f":this.fExtXform=new c}}get tag(){return"x14:cfvo"}render(l,u){l.openNode(this.tag,{type:u.type}),u.value!==void 0&&this.fExtXform.render(l,u.value),l.closeNode()}createNewModel(l){return{type:l.attributes.type}}onParserClose(l,u){switch(l){case"xm:f":this.model.value=u.model?parseFloat(u.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(e,a,n){const i=e("../../composite-xform"),c=e("./sqref-ext-xform"),l=e("./cf-rule-ext-xform");a.exports=class extends i{constructor(){super(),this.map={"xm:sqref":this.sqRef=new c,"x14:cfRule":this.cfRule=new l}}get tag(){return"x14:conditionalFormatting"}prepare(u,o){u.rules.forEach(d=>{this.cfRule.prepare(d,o)})}render(u,o){o.rules.some(l.isExt)&&(u.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),o.rules.filter(l.isExt).forEach(d=>this.cfRule.render(u,d)),this.sqRef.render(u,o.ref),u.closeNode())}createNewModel(){return{rules:[]}}onParserClose(u,o){switch(u){case"xm:sqref":this.model.ref=o.model;break;case"x14:cfRule":this.model.rules.push(o.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(e,a,n){const i=e("../../composite-xform"),c=e("./cf-rule-ext-xform"),l=e("./conditional-formatting-ext-xform");a.exports=class extends i{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new l}}get tag(){return"x14:conditionalFormattings"}hasContent(u){return u.hasExtContent===void 0&&(u.hasExtContent=u.some(o=>o.rules.some(c.isExt))),u.hasExtContent}prepare(u,o){u.forEach(d=>{this.cfXform.prepare(d,o)})}render(u,o){this.hasContent(o)&&(u.openNode(this.tag),o.forEach(d=>this.cfXform.render(u,d)),u.closeNode())}createNewModel(){return[]}onParserClose(u,o){this.model.push(o.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(e,a,n){const i=e("../../base-xform"),c=e("../../composite-xform"),l=e("../../style/color-xform"),u=e("./cfvo-ext-xform");a.exports=class extends c{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new u,"x14:borderColor":this.borderColorXform=new l("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new l("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new l("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new l("x14:axisColor")}}static isExt(o){return!o.gradient}get tag(){return"x14:dataBar"}render(o,d){o.openNode(this.tag,{minLength:i.toIntAttribute(d.minLength,0,!0),maxLength:i.toIntAttribute(d.maxLength,100,!0),border:i.toBoolAttribute(d.border,!1),gradient:i.toBoolAttribute(d.gradient,!0),negativeBarColorSameAsPositive:i.toBoolAttribute(d.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolAttribute(d.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toAttribute(d.axisPosition,"auto"),direction:i.toAttribute(d.direction,"leftToRight")}),d.cfvo.forEach(g=>{this.cfvoXform.render(o,g)}),this.borderColorXform.render(o,d.borderColor),this.negativeBorderColorXform.render(o,d.negativeBorderColor),this.negativeFillColorXform.render(o,d.negativeFillColor),this.axisColorXform.render(o,d.axisColor),o.closeNode()}createNewModel(o){let{attributes:d}=o;return{cfvo:[],minLength:i.toIntValue(d.minLength,0),maxLength:i.toIntValue(d.maxLength,100),border:i.toBoolValue(d.border,!1),gradient:i.toBoolValue(d.gradient,!0),negativeBarColorSameAsPositive:i.toBoolValue(d.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolValue(d.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toStringValue(d.axisPosition,"auto"),direction:i.toStringValue(d.direction,"leftToRight")}}onParserClose(o,d){const[,g]=o.split(":");switch(g){case"cfvo":this.model.cfvo.push(d.model);break;default:this.model[g]=d.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(e,a,n){const i=e("../../base-xform");a.exports=class extends i{get tag(){return"xm:f"}render(c,l){c.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(c){this.model+=c}parseClose(c){return c!==this.tag}}},{"../../base-xform":32}],81:[function(e,a,n){const i=e("../../base-xform"),c=e("../../composite-xform"),l=e("./cfvo-ext-xform"),u=e("./cf-icon-ext-xform");a.exports=class extends c{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:cfIcon":this.cfIconXform=new u}}get tag(){return"x14:iconSet"}render(o,d){o.openNode(this.tag,{iconSet:i.toStringAttribute(d.iconSet),reverse:i.toBoolAttribute(d.reverse,!1),showValue:i.toBoolAttribute(d.showValue,!0),custom:i.toBoolAttribute(d.icons,!1)}),d.cfvo.forEach(g=>{this.cfvoXform.render(o,g)}),d.icons&&d.icons.forEach((g,p)=>{g.iconId=p,this.cfIconXform.render(o,g)}),o.closeNode()}createNewModel(o){let{attributes:d}=o;return{cfvo:[],iconSet:i.toStringValue(d.iconSet,"3TrafficLights"),reverse:i.toBoolValue(d.reverse,!1),showValue:i.toBoolValue(d.showValue,!0)}}onParserClose(o,d){const[,g]=o.split(":");switch(g){case"cfvo":this.model.cfvo.push(d.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(d.model);break;default:this.model[g]=d.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(e,a,n){const i=e("../../base-xform");a.exports=class extends i{get tag(){return"xm:sqref"}render(c,l){c.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(c){this.model+=c}parseClose(c){return c!==this.tag}}},{"../../base-xform":32}],83:[function(e,a,n){const i=e("../../base-xform"),c=e("../../composite-xform"),l=e("../../../../doc/range"),u=e("./databar-xform"),o=e("./ext-lst-ref-xform"),d=e("./formula-xform"),g=e("./color-scale-xform"),p=e("./icon-set-xform"),h={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},f=b=>{const{type:v,operator:_}=b;switch(v){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:v};default:return{type:v,operator:_}}};class x extends c{constructor(){super(),this.map={dataBar:this.databarXform=new u,extLst:this.extLstRefXform=new o,formula:this.formulaXform=new d,colorScale:this.colorScaleXform=new g,iconSet:this.iconSetXform=new p}}get tag(){return"cfRule"}static isPrimitive(v){return v.type!=="iconSet"||!v.custom&&!h[v.iconSet]}render(v,_){switch(_.type){case"expression":this.renderExpression(v,_);break;case"cellIs":this.renderCellIs(v,_);break;case"top10":this.renderTop10(v,_);break;case"aboveAverage":this.renderAboveAverage(v,_);break;case"dataBar":this.renderDataBar(v,_);break;case"colorScale":this.renderColorScale(v,_);break;case"iconSet":this.renderIconSet(v,_);break;case"containsText":this.renderText(v,_);break;case"timePeriod":this.renderTimePeriod(v,_)}}renderExpression(v,_){v.openNode(this.tag,{type:"expression",dxfId:_.dxfId,priority:_.priority}),this.formulaXform.render(v,_.formulae[0]),v.closeNode()}renderCellIs(v,_){v.openNode(this.tag,{type:"cellIs",dxfId:_.dxfId,priority:_.priority,operator:_.operator}),_.formulae.forEach(N=>{this.formulaXform.render(v,N)}),v.closeNode()}renderTop10(v,_){v.leafNode(this.tag,{type:"top10",dxfId:_.dxfId,priority:_.priority,percent:i.toBoolAttribute(_.percent,!1),bottom:i.toBoolAttribute(_.bottom,!1),rank:i.toIntValue(_.rank,10,!0)})}renderAboveAverage(v,_){v.leafNode(this.tag,{type:"aboveAverage",dxfId:_.dxfId,priority:_.priority,aboveAverage:i.toBoolAttribute(_.aboveAverage,!0)})}renderDataBar(v,_){v.openNode(this.tag,{type:"dataBar",priority:_.priority}),this.databarXform.render(v,_),this.extLstRefXform.render(v,_),v.closeNode()}renderColorScale(v,_){v.openNode(this.tag,{type:"colorScale",priority:_.priority}),this.colorScaleXform.render(v,_),v.closeNode()}renderIconSet(v,_){x.isPrimitive(_)&&(v.openNode(this.tag,{type:"iconSet",priority:_.priority}),this.iconSetXform.render(v,_),v.closeNode())}renderText(v,_){v.openNode(this.tag,{type:_.operator,dxfId:_.dxfId,priority:_.priority,operator:i.toStringAttribute(_.operator,"containsText")});const N=(E=>{if(E.formulae&&E.formulae[0])return E.formulae[0];const O=new l(E.ref),{tl:F}=O;switch(E.operator){case"containsText":return`NOT(ISERROR(SEARCH("${E.text}",${F})))`;case"containsBlanks":return`LEN(TRIM(${F}))=0`;case"notContainsBlanks":return`LEN(TRIM(${F}))>0`;case"containsErrors":return`ISERROR(${F})`;case"notContainsErrors":return`NOT(ISERROR(${F}))`;default:return}})(_);N&&this.formulaXform.render(v,N),v.closeNode()}renderTimePeriod(v,_){v.openNode(this.tag,{type:"timePeriod",dxfId:_.dxfId,priority:_.priority,timePeriod:_.timePeriod});const N=(E=>{if(E.formulae&&E.formulae[0])return E.formulae[0];const O=new l(E.ref),{tl:F}=O;switch(E.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${F},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${F},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${F},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${F},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${F},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${F},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${F},1)=TODAY()-1`;case"today":return`FLOOR(${F},1)=TODAY()`;case"tomorrow":return`FLOOR(${F},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${F},1)<=6,FLOOR(${F},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${F})=MONTH(EDATE(TODAY(),0-1)),YEAR(${F})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${F})=MONTH(TODAY()),YEAR(${F})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${F})=MONTH(EDATE(TODAY(),0+1)),YEAR(${F})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(_);N&&this.formulaXform.render(v,N),v.closeNode()}createNewModel(v){let{attributes:_}=v;return{...f(_),dxfId:i.toIntValue(_.dxfId),priority:i.toIntValue(_.priority),timePeriod:_.timePeriod,percent:i.toBoolValue(_.percent),bottom:i.toBoolValue(_.bottom),rank:i.toIntValue(_.rank),aboveAverage:i.toBoolValue(_.aboveAverage)}}onParserClose(v,_){switch(v){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,_.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(_.model)}}}a.exports=x},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(e,a,n){const i=e("../../base-xform");a.exports=class extends i{get tag(){return"cfvo"}render(c,l){c.leafNode(this.tag,{type:l.type,val:l.value})}parseOpen(c){this.model={type:c.attributes.type,value:i.toFloatValue(c.attributes.val)}}parseClose(c){return c!==this.tag}}},{"../../base-xform":32}],85:[function(e,a,n){const i=e("../../composite-xform"),c=e("../../style/color-xform"),l=e("./cfvo-xform");a.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new c}}get tag(){return"colorScale"}render(u,o){u.openNode(this.tag),o.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),o.color.forEach(d=>{this.colorXform.render(u,d)}),u.closeNode()}createNewModel(u){return{cfvo:[],color:[]}}onParserClose(u,o){this.model[u].push(o.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(e,a,n){const i=e("../../composite-xform"),c=e("./cf-rule-xform");a.exports=class extends i{constructor(){super(),this.map={cfRule:new c}}get tag(){return"conditionalFormatting"}render(l,u){u.rules.some(c.isPrimitive)&&(l.openNode(this.tag,{sqref:u.ref}),u.rules.forEach(o=>{c.isPrimitive(o)&&(o.ref=u.ref,this.map.cfRule.render(l,o))}),l.closeNode())}createNewModel(l){let{attributes:u}=l;return{ref:u.sqref,rules:[]}}onParserClose(l,u){this.model.rules.push(u.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(e,a,n){const i=e("../../base-xform"),c=e("./conditional-formatting-xform");a.exports=class extends i{constructor(){super(),this.cfXform=new c}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(l,u){let o=l.reduce((d,g)=>Math.max(d,...g.rules.map(p=>p.priority||0)),1);l.forEach(d=>{d.rules.forEach(g=>{g.priority||(g.priority=o++),g.style&&(g.dxfId=u.styles.addDxfStyle(g.style))})})}render(l,u){u.forEach(o=>{this.cfXform.render(l,o)})}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return!!this.parser&&(!!this.parser.parseClose(l)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(l,u){l.forEach(o=>{o.rules.forEach(d=>{d.dxfId!==void 0&&(d.style=u.styles.getDxfStyle(d.dxfId),delete d.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(e,a,n){const i=e("../../composite-xform"),c=e("../../style/color-xform"),l=e("./cfvo-xform");a.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new c}}get tag(){return"dataBar"}render(u,o){u.openNode(this.tag),o.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),this.colorXform.render(u,o.color),u.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(u,o){switch(u){case"cfvo":this.model.cfvo.push(o.model);break;case"color":this.model.color=o.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(e,a,n){const i=e("../../base-xform"),c=e("../../composite-xform");class l extends i{get tag(){return"x14:id"}render(d,g){d.leafNode(this.tag,null,g)}parseOpen(){this.model=""}parseText(d){this.model+=d}parseClose(d){return d!==this.tag}}class u extends c{constructor(){super(),this.map={"x14:id":this.idXform=new l}}get tag(){return"ext"}render(d,g){d.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(d,g.x14Id),d.closeNode()}createNewModel(){return{}}onParserClose(d,g){this.model.x14Id=g.model}}a.exports=class extends c{constructor(){super(),this.map={ext:new u}}get tag(){return"extLst"}render(o,d){o.openNode(this.tag),this.map.ext.render(o,d),o.closeNode()}createNewModel(){return{}}onParserClose(o,d){Object.assign(this.model,d.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(e,a,n){const i=e("../../base-xform");a.exports=class extends i{get tag(){return"formula"}render(c,l){c.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(c){this.model+=c}parseClose(c){return c!==this.tag}}},{"../../base-xform":32}],91:[function(e,a,n){const i=e("../../base-xform"),c=e("../../composite-xform"),l=e("./cfvo-xform");a.exports=class extends c{constructor(){super(),this.map={cfvo:this.cfvoXform=new l}}get tag(){return"iconSet"}render(u,o){u.openNode(this.tag,{iconSet:i.toStringAttribute(o.iconSet,"3TrafficLights"),reverse:i.toBoolAttribute(o.reverse,!1),showValue:i.toBoolAttribute(o.showValue,!0)}),o.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),u.closeNode()}createNewModel(u){let{attributes:o}=u;return{iconSet:i.toStringValue(o.iconSet,"3TrafficLights"),reverse:i.toBoolValue(o.reverse),showValue:i.toBoolValue(o.showValue),cfvo:[]}}onParserClose(u,o){this.model[u].push(o.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(e,a,n){const i=e("../../../utils/utils"),c=e("../base-xform");a.exports=class extends c{get tag(){return"col"}prepare(l,u){const o=u.styles.addStyleModel(l.style||{});o&&(l.styleId=o)}render(l,u){l.openNode("col"),l.addAttribute("min",u.min),l.addAttribute("max",u.max),u.width&&l.addAttribute("width",u.width),u.styleId&&l.addAttribute("style",u.styleId),u.hidden&&l.addAttribute("hidden","1"),u.bestFit&&l.addAttribute("bestFit","1"),u.outlineLevel&&l.addAttribute("outlineLevel",u.outlineLevel),u.collapsed&&l.addAttribute("collapsed","1"),l.addAttribute("customWidth","1"),l.closeNode()}parseOpen(l){if(l.name==="col"){const u=this.model={min:parseInt(l.attributes.min||"0",10),max:parseInt(l.attributes.max||"0",10),width:l.attributes.width===void 0?void 0:parseFloat(l.attributes.width||"0")};return l.attributes.style&&(u.styleId=parseInt(l.attributes.style,10)),i.parseBoolean(l.attributes.hidden)&&(u.hidden=!0),i.parseBoolean(l.attributes.bestFit)&&(u.bestFit=!0),l.attributes.outlineLevel&&(u.outlineLevel=parseInt(l.attributes.outlineLevel,10)),i.parseBoolean(l.attributes.collapsed)&&(u.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(l,u){l.styleId&&(l.style=u.styles.getStyleModel(l.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../../../utils/utils"),l=e("../../../utils/col-cache"),u=e("../base-xform"),o=e("../../../doc/range");function d(p,h,f,x){const b=h[f];b!==void 0?p[f]=b:x!==void 0&&(p[f]=x)}function g(p,h,f,x){const b=h[f];b!==void 0&&(p[f]=c.parseBoolean(b))}a.exports=class extends u{get tag(){return"dataValidations"}render(p,h){const f=function(x){const b=i.map(x,(N,E)=>({address:E,dataValidation:N,marked:!1})).sort((N,E)=>i.strcmp(N.address,E.address)),v=i.keyBy(b,"address"),_=(N,E,O)=>{for(let F=0;F<E;F++){const z=l.encodeAddress(N.row+F,O);if(!x[z]||!i.isEqual(x[N.address],x[z]))return!1}return!0};return b.map(N=>{if(!N.marked){const E=l.decodeEx(N.address);if(E.dimensions)return v[E.dimensions].marked=!0,{...N.dataValidation,sqref:N.address};let O=1,F=l.encodeAddress(E.row+O,E.col);for(;x[F]&&i.isEqual(N.dataValidation,x[F]);)O++,F=l.encodeAddress(E.row+O,E.col);let z=1;for(;_(E,O,E.col+z);)z++;for(let P=0;P<O;P++)for(let U=0;U<z;U++)F=l.encodeAddress(E.row+P,E.col+U),v[F].marked=!0;if(O>1||z>1){const P=E.row+(O-1),U=E.col+(z-1);return{...N.dataValidation,sqref:`${N.address}:${l.encodeAddress(P,U)}`}}return{...N.dataValidation,sqref:N.address}}return null}).filter(Boolean)}(h);f.length&&(p.openNode("dataValidations",{count:f.length}),f.forEach(x=>{p.openNode("dataValidation"),x.type!=="any"&&(p.addAttribute("type",x.type),x.operator&&x.type!=="list"&&x.operator!=="between"&&p.addAttribute("operator",x.operator),x.allowBlank&&p.addAttribute("allowBlank","1")),x.showInputMessage&&p.addAttribute("showInputMessage","1"),x.promptTitle&&p.addAttribute("promptTitle",x.promptTitle),x.prompt&&p.addAttribute("prompt",x.prompt),x.showErrorMessage&&p.addAttribute("showErrorMessage","1"),x.errorStyle&&p.addAttribute("errorStyle",x.errorStyle),x.errorTitle&&p.addAttribute("errorTitle",x.errorTitle),x.error&&p.addAttribute("error",x.error),p.addAttribute("sqref",x.sqref),(x.formulae||[]).forEach((b,v)=>{p.openNode("formula"+(v+1)),x.type==="date"?p.writeText(c.dateToExcel(new Date(b))):p.writeText(b),p.closeNode()}),p.closeNode()}),p.closeNode())}parseOpen(p){switch(p.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=p.attributes.sqref;const h={type:p.attributes.type||"any",formulae:[]};switch(p.attributes.type&&g(h,p.attributes,"allowBlank"),g(h,p.attributes,"showInputMessage"),g(h,p.attributes,"showErrorMessage"),h.type){case"any":case"list":case"custom":break;default:d(h,p.attributes,"operator","between")}return d(h,p.attributes,"promptTitle"),d(h,p.attributes,"prompt"),d(h,p.attributes,"errorStyle"),d(h,p.attributes,"errorTitle"),d(h,p.attributes,"error"),this._dataValidation=h,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(p){this._formula&&this._formula.push(p)}parseClose(p){switch(p){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(h=>{h.includes(":")?new o(h).forEachAddress(f=>{this.model[f]=this._dataValidation}):this.model[h]=this._dataValidation}),!0;case"formula1":case"formula2":{let h=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":h=parseInt(h,10);break;case"decimal":h=parseFloat(h);break;case"date":h=c.excelToDate(parseFloat(h))}return this._dataValidation.formulae.push(h),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"dimension"}render(c,l){l&&c.leafNode("dimension",{ref:l})}parseOpen(c){return c.name==="dimension"&&(this.model=c.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"drawing"}render(c,l){l&&c.leafNode(this.tag,{"r:id":l.rId})}parseOpen(c){switch(c.name){case this.tag:return this.model={rId:c.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(e,a,n){const i=e("../composite-xform"),c=e("./cf-ext/conditional-formattings-ext-xform");class l extends i{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new c}}get tag(){return"ext"}hasContent(o){return this.conditionalFormattings.hasContent(o.conditionalFormattings)}prepare(o,d){this.conditionalFormattings.prepare(o.conditionalFormattings,d)}render(o,d){o.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(o,d.conditionalFormattings),o.closeNode()}createNewModel(){return{}}onParserClose(o,d){this.model[o]=d.model}}a.exports=class extends i{constructor(){super(),this.map={ext:this.ext=new l}}get tag(){return"extLst"}prepare(u,o){this.ext.prepare(u,o)}hasContent(u){return this.ext.hasContent(u)}render(u,o){this.hasContent(o)&&(u.openNode("extLst"),this.ext.render(u,o),u.closeNode())}createNewModel(){return{}}onParserClose(u,o){Object.assign(this.model,o.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"headerFooter"}render(c,l){if(l){c.addRollback();let u=!1;c.openNode("headerFooter"),l.differentFirst&&(c.addAttribute("differentFirst","1"),u=!0),l.differentOddEven&&(c.addAttribute("differentOddEven","1"),u=!0),l.oddHeader&&typeof l.oddHeader=="string"&&(c.leafNode("oddHeader",null,l.oddHeader),u=!0),l.oddFooter&&typeof l.oddFooter=="string"&&(c.leafNode("oddFooter",null,l.oddFooter),u=!0),l.evenHeader&&typeof l.evenHeader=="string"&&(c.leafNode("evenHeader",null,l.evenHeader),u=!0),l.evenFooter&&typeof l.evenFooter=="string"&&(c.leafNode("evenFooter",null,l.evenFooter),u=!0),l.firstHeader&&typeof l.firstHeader=="string"&&(c.leafNode("firstHeader",null,l.firstHeader),u=!0),l.firstFooter&&typeof l.firstFooter=="string"&&(c.leafNode("firstFooter",null,l.firstFooter),u=!0),u?(c.closeNode(),c.commit()):c.rollback()}}parseOpen(c){switch(c.name){case"headerFooter":return this.model={},c.attributes.differentFirst&&(this.model.differentFirst=parseInt(c.attributes.differentFirst,0)===1),c.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(c.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(c){switch(this.currentNode){case"oddHeader":this.model.oddHeader=c;break;case"oddFooter":this.model.oddFooter=c;break;case"evenHeader":this.model.evenHeader=c;break;case"evenFooter":this.model.evenFooter=c;break;case"firstHeader":this.model.firstHeader=c;break;case"firstFooter":this.model.firstFooter=c}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"hyperlink"}render(c,l){this.isInternalLink(l)?c.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip,location:l.target}):c.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip})}parseOpen(c){return c.name==="hyperlink"&&(this.model={address:c.attributes.ref,rId:c.attributes["r:id"],tooltip:c.attributes.tooltip},c.attributes.location&&(this.model.target=c.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(c){return c.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(c.target)}}},{"../base-xform":32}],99:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"mergeCell"}render(c,l){c.leafNode("mergeCell",{ref:l})}parseOpen(c){return c.name==="mergeCell"&&(this.model=c.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../../../doc/range"),l=e("../../../utils/col-cache"),u=e("../../../doc/enums");a.exports=class{constructor(){this.merges={}}add(o){if(this.merges[o.master])this.merges[o.master].expandToAddress(o.address);else{const d=`${o.master}:${o.address}`;this.merges[o.master]=new c(d)}}get mergeCells(){return i.map(this.merges,o=>o.range)}reconcile(o,d){i.each(o,g=>{const p=l.decode(g);for(let h=p.top;h<=p.bottom;h++){const f=d[h-1];for(let x=p.left;x<=p.right;x++){const b=f.cells[x-1];b?b.type===u.ValueType.Merge&&(b.master=p.tl):f.cells[x]={type:u.ValueType.Null,address:l.encodeAddress(h,x)}}}})}getMasterAddress(o){const d=this.hash[o];return d&&d.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(e,a,n){const i=e("../base-xform"),c=l=>l!==void 0;a.exports=class extends i{get tag(){return"outlinePr"}render(l,u){return!(!u||!c(u.summaryBelow)&&!c(u.summaryRight))&&(l.leafNode(this.tag,{summaryBelow:c(u.summaryBelow)?Number(u.summaryBelow):void 0,summaryRight:c(u.summaryRight)?Number(u.summaryRight):void 0}),!0)}parseOpen(l){return l.name===this.tag&&(this.model={summaryBelow:c(l.attributes.summaryBelow)?!!Number(l.attributes.summaryBelow):void 0,summaryRight:c(l.attributes.summaryRight)?!!Number(l.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"brk"}render(c,l){c.leafNode("brk",l)}parseOpen(c){return c.name==="brk"&&(this.model=c.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../base-xform");a.exports=class extends c{get tag(){return"pageMargins"}render(l,u){if(u){const o={left:u.left,right:u.right,top:u.top,bottom:u.bottom,header:u.header,footer:u.footer};i.some(o,d=>d!==void 0)&&l.leafNode(this.tag,o)}}parseOpen(l){switch(l.name){case this.tag:return this.model={left:parseFloat(l.attributes.left||.7),right:parseFloat(l.attributes.right||.7),top:parseFloat(l.attributes.top||.75),bottom:parseFloat(l.attributes.bottom||.75),header:parseFloat(l.attributes.header||.3),footer:parseFloat(l.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"pageSetUpPr"}render(c,l){return!(!l||!l.fitToPage)&&(c.leafNode(this.tag,{fitToPage:l.fitToPage?"1":void 0}),!0)}parseOpen(c){return c.name===this.tag&&(this.model={fitToPage:c.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../base-xform");function l(g){return g?"1":void 0}function u(g){switch(g){case"overThenDown":return g;default:return}}function o(g){switch(g){case"atEnd":case"asDisplyed":return g;default:return}}function d(g){switch(g){case"dash":case"blank":case"NA":return g;default:return}}a.exports=class extends c{get tag(){return"pageSetup"}render(g,p){if(p){const h={paperSize:p.paperSize,orientation:p.orientation,horizontalDpi:p.horizontalDpi,verticalDpi:p.verticalDpi,pageOrder:u(p.pageOrder),blackAndWhite:l(p.blackAndWhite),draft:l(p.draft),cellComments:o(p.cellComments),errors:d(p.errors),scale:p.scale,fitToWidth:p.fitToWidth,fitToHeight:p.fitToHeight,firstPageNumber:p.firstPageNumber,useFirstPageNumber:l(p.firstPageNumber),usePrinterDefaults:l(p.usePrinterDefaults),copies:p.copies};i.some(h,f=>f!==void 0)&&g.leafNode(this.tag,h)}}parseOpen(g){switch(g.name){case this.tag:return this.model={paperSize:(p=g.attributes.paperSize,p!==void 0?parseInt(p,10):void 0),orientation:g.attributes.orientation||"portrait",horizontalDpi:parseInt(g.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(g.attributes.verticalDpi||"4294967295",10),pageOrder:g.attributes.pageOrder||"downThenOver",blackAndWhite:g.attributes.blackAndWhite==="1",draft:g.attributes.draft==="1",cellComments:g.attributes.cellComments||"None",errors:g.attributes.errors||"displayed",scale:parseInt(g.attributes.scale||"100",10),fitToWidth:parseInt(g.attributes.fitToWidth||"1",10),fitToHeight:parseInt(g.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(g.attributes.firstPageNumber||"1",10),useFirstPageNumber:g.attributes.useFirstPageNumber==="1",usePrinterDefaults:g.attributes.usePrinterDefaults==="1",copies:parseInt(g.attributes.copies||"1",10)},!0;default:return!1}var p}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"picture"}render(c,l){l&&c.leafNode(this.tag,{"r:id":l.rId})}parseOpen(c){switch(c.name){case this.tag:return this.model={rId:c.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../base-xform");function l(u){return u?"1":void 0}a.exports=class extends c{get tag(){return"printOptions"}render(u,o){if(o){const d={headings:l(o.showRowColHeaders),gridLines:l(o.showGridLines),horizontalCentered:l(o.horizontalCentered),verticalCentered:l(o.verticalCentered)};i.some(d,g=>g!==void 0)&&u.leafNode(this.tag,d)}}parseOpen(u){switch(u.name){case this.tag:return this.model={showRowColHeaders:u.attributes.headings==="1",showGridLines:u.attributes.gridLines==="1",horizontalCentered:u.attributes.horizontalCentered==="1",verticalCentered:u.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(e,a,n){const i=e("./page-breaks-xform"),c=e("../list-xform");a.exports=class extends c{constructor(){super({tag:"rowBreaks",count:!0,childXform:new i})}render(l,u){if(u&&u.length){l.openNode(this.tag,this.$),this.count&&(l.addAttribute(this.$count,u.length),l.addAttribute("manualBreakCount",u.length));const{childXform:o}=this;u.forEach(d=>{o.render(l,d)}),l.closeNode()}else this.empty&&l.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(e,a,n){const i=e("../base-xform"),c=e("../../../utils/utils"),l=e("./cell-xform");a.exports=class extends i{constructor(u){super(),this.maxItems=u&&u.maxItems,this.map={c:new l}}get tag(){return"row"}prepare(u,o){const d=o.styles.addStyleModel(u.style);d&&(u.styleId=d);const g=this.map.c;u.cells.forEach(p=>{g.prepare(p,o)})}render(u,o,d){u.openNode("row"),u.addAttribute("r",o.number),o.height&&(u.addAttribute("ht",o.height),u.addAttribute("customHeight","1")),o.hidden&&u.addAttribute("hidden","1"),o.min>0&&o.max>0&&o.min<=o.max&&u.addAttribute("spans",`${o.min}:${o.max}`),o.styleId&&(u.addAttribute("s",o.styleId),u.addAttribute("customFormat","1")),u.addAttribute("x14ac:dyDescent","0.25"),o.outlineLevel&&u.addAttribute("outlineLevel",o.outlineLevel),o.collapsed&&u.addAttribute("collapsed","1");const g=this.map.c;o.cells.forEach(p=>{g.render(u,p,d)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;if(u.name==="row"){this.numRowsSeen+=1;const o=u.attributes.spans?u.attributes.spans.split(":").map(g=>parseInt(g,10)):[void 0,void 0],d=this.model={number:parseInt(u.attributes.r,10),min:o[0],max:o[1],cells:[]};return u.attributes.s&&(d.styleId=parseInt(u.attributes.s,10)),c.parseBoolean(u.attributes.hidden)&&(d.hidden=!0),c.parseBoolean(u.attributes.bestFit)&&(d.bestFit=!0),u.attributes.ht&&(d.height=parseFloat(u.attributes.ht)),u.attributes.outlineLevel&&(d.outlineLevel=parseInt(u.attributes.outlineLevel,10)),c.parseBoolean(u.attributes.collapsed)&&(d.collapsed=!0),!0}return this.parser=this.map[u.name],!!this.parser&&(this.parser.parseOpen(u),!0)}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(u,o){u.style=u.styleId?o.styles.getStyleModel(u.styleId):{},u.styleId!==void 0&&(u.styleId=void 0);const d=this.map.c;u.cells.forEach(g=>{d.reconcile(g,o)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../base-xform");a.exports=class extends c{get tag(){return"sheetFormatPr"}render(l,u){if(u){const o={defaultRowHeight:u.defaultRowHeight,outlineLevelRow:u.outlineLevelRow,outlineLevelCol:u.outlineLevelCol,"x14ac:dyDescent":u.dyDescent};u.defaultColWidth&&(o.defaultColWidth=u.defaultColWidth),u.defaultRowHeight&&u.defaultRowHeight===15||(o.customHeight="1"),i.some(o,d=>d!==void 0)&&l.leafNode("sheetFormatPr",o)}}parseOpen(l){return l.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(l.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(l.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(l.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(l.attributes.outlineLevelCol||"0",10)},l.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(l.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(e,a,n){const i=e("../base-xform"),c=e("../style/color-xform"),l=e("./page-setup-properties-xform"),u=e("./outline-properties-xform");a.exports=class extends i{constructor(){super(),this.map={tabColor:new c("tabColor"),pageSetUpPr:new l,outlinePr:new u}}get tag(){return"sheetPr"}render(o,d){if(d){o.addRollback(),o.openNode("sheetPr");let g=!1;g=this.map.tabColor.render(o,d.tabColor)||g,g=this.map.pageSetUpPr.render(o,d.pageSetup)||g,g=this.map.outlinePr.render(o,d.outlineProperties)||g,g?(o.closeNode(),o.commit()):o.rollback()}}parseOpen(o){return this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag?(this.reset(),!0):!!this.map[o.name]&&(this.parser=this.map[o.name],this.parser.parseOpen(o),!0)}parseText(o){return!!this.parser&&(this.parser.parseText(o),!0)}parseClose(o){return this.parser?(this.parser.parseClose(o)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../base-xform");function l(o,d){return o?d:void 0}function u(o,d){return o===d||void 0}a.exports=class extends c{get tag(){return"sheetProtection"}render(o,d){if(d){const g={sheet:l(d.sheet,"1"),selectLockedCells:d.selectLockedCells===!1?"1":void 0,selectUnlockedCells:d.selectUnlockedCells===!1?"1":void 0,formatCells:l(d.formatCells,"0"),formatColumns:l(d.formatColumns,"0"),formatRows:l(d.formatRows,"0"),insertColumns:l(d.insertColumns,"0"),insertRows:l(d.insertRows,"0"),insertHyperlinks:l(d.insertHyperlinks,"0"),deleteColumns:l(d.deleteColumns,"0"),deleteRows:l(d.deleteRows,"0"),sort:l(d.sort,"0"),autoFilter:l(d.autoFilter,"0"),pivotTables:l(d.pivotTables,"0")};d.sheet&&(g.algorithmName=d.algorithmName,g.hashValue=d.hashValue,g.saltValue=d.saltValue,g.spinCount=d.spinCount,g.objects=l(d.objects===!1,"1"),g.scenarios=l(d.scenarios===!1,"1")),i.some(g,p=>p!==void 0)&&o.leafNode(this.tag,g)}}parseOpen(o){switch(o.name){case this.tag:return this.model={sheet:u(o.attributes.sheet,"1"),objects:o.attributes.objects!=="1"&&void 0,scenarios:o.attributes.scenarios!=="1"&&void 0,selectLockedCells:o.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:o.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:u(o.attributes.formatCells,"0"),formatColumns:u(o.attributes.formatColumns,"0"),formatRows:u(o.attributes.formatRows,"0"),insertColumns:u(o.attributes.insertColumns,"0"),insertRows:u(o.attributes.insertRows,"0"),insertHyperlinks:u(o.attributes.insertHyperlinks,"0"),deleteColumns:u(o.attributes.deleteColumns,"0"),deleteRows:u(o.attributes.deleteRows,"0"),sort:u(o.attributes.sort,"0"),autoFilter:u(o.attributes.autoFilter,"0"),pivotTables:u(o.attributes.pivotTables,"0")},o.attributes.algorithmName&&(this.model.algorithmName=o.attributes.algorithmName,this.model.hashValue=o.attributes.hashValue,this.model.saltValue=o.attributes.saltValue,this.model.spinCount=parseInt(o.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(e,a,n){const i=e("../../../utils/col-cache"),c=e("../base-xform"),l={frozen:"frozen",frozenSplit:"frozen",split:"split"};a.exports=class extends c{get tag(){return"sheetView"}prepare(u){switch(u.state){case"frozen":case"split":break;default:u.state="normal"}}render(u,o){u.openNode("sheetView",{workbookViewId:o.workbookViewId||0});const d=function(x,b,v){v&&u.addAttribute(x,b)};let g,p,h,f;switch(d("rightToLeft","1",o.rightToLeft===!0),d("tabSelected","1",o.tabSelected),d("showRuler","0",o.showRuler===!1),d("showRowColHeaders","0",o.showRowColHeaders===!1),d("showGridLines","0",o.showGridLines===!1),d("zoomScale",o.zoomScale,o.zoomScale),d("zoomScaleNormal",o.zoomScaleNormal,o.zoomScaleNormal),d("view",o.style,o.style),o.state){case"frozen":p=o.xSplit||0,h=o.ySplit||0,g=o.topLeftCell||i.getAddress(h+1,p+1).address,f=(o.xSplit&&o.ySplit?"bottomRight":o.xSplit&&"topRight")||"bottomLeft",u.leafNode("pane",{xSplit:o.xSplit||void 0,ySplit:o.ySplit||void 0,topLeftCell:g,activePane:f,state:"frozen"}),u.leafNode("selection",{pane:f,activeCell:o.activeCell,sqref:o.activeCell});break;case"split":o.activePane==="topLeft"&&(o.activePane=void 0),u.leafNode("pane",{xSplit:o.xSplit||void 0,ySplit:o.ySplit||void 0,topLeftCell:o.topLeftCell,activePane:o.activePane}),u.leafNode("selection",{pane:o.activePane,activeCell:o.activeCell,sqref:o.activeCell});break;case"normal":o.activeCell&&u.leafNode("selection",{activeCell:o.activeCell,sqref:o.activeCell})}u.closeNode()}parseOpen(u){switch(u.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(u.attributes.workbookViewId,10),rightToLeft:u.attributes.rightToLeft==="1",tabSelected:u.attributes.tabSelected==="1",showRuler:u.attributes.showRuler!=="0",showRowColHeaders:u.attributes.showRowColHeaders!=="0",showGridLines:u.attributes.showGridLines!=="0",zoomScale:parseInt(u.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(u.attributes.zoomScaleNormal||"100",10),style:u.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(u.attributes.xSplit||"0",10),ySplit:parseInt(u.attributes.ySplit||"0",10),topLeftCell:u.attributes.topLeftCell,activePane:u.attributes.activePane||"topLeft",state:u.attributes.state},!0;case"selection":{const o=u.attributes.pane||"topLeft";return this.selections[o]={pane:o,activeCell:u.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(u){let o,d;switch(u){case"sheetView":return this.sheetView&&this.pane?(o=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:l[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(o.activePane=this.pane.activePane),d=this.selections[this.pane.activePane],d&&d.activeCell&&(o.activeCell=d.activeCell),this.sheetView.style&&(o.style=this.sheetView.style)):(o=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},d=this.selections.topLeft,d&&d.activeCell&&(o.activeCell=d.activeCell),this.sheetView.style&&(o.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"tablePart"}render(c,l){l&&c.leafNode(this.tag,{"r:id":l.rId})}parseOpen(c){switch(c.name){case this.tag:return this.model={rId:c.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../../../utils/col-cache"),l=e("../../../utils/xml-stream"),u=e("../../rel-type"),o=e("./merges"),d=e("../base-xform"),g=e("../list-xform"),p=e("./row-xform"),h=e("./col-xform"),f=e("./dimension-xform"),x=e("./hyperlink-xform"),b=e("./merge-cell-xform"),v=e("./data-validations-xform"),_=e("./sheet-properties-xform"),N=e("./sheet-format-properties-xform"),E=e("./sheet-view-xform"),O=e("./sheet-protection-xform"),F=e("./page-margins-xform"),z=e("./page-setup-xform"),P=e("./print-options-xform"),U=e("./auto-filter-xform"),W=e("./picture-xform"),Y=e("./drawing-xform"),q=e("./table-part-xform"),M=e("./row-breaks-xform"),D=e("./header-footer-xform"),T=e("./cf/conditional-formattings-xform"),C=e("./ext-lst-xform"),S=(j,A)=>{if(!A||!A.length)return j;if(!j||!j.length)return A;const L={},I={};return j.forEach(Z=>{L[Z.ref]=Z,Z.rules.forEach(K=>{const{x14Id:re}=K;re&&(I[re]=K)})}),A.forEach(Z=>{Z.rules.forEach(K=>{const re=I[K.x14Id];re?((G,ae)=>{Object.keys(ae).forEach(V=>{const H=G[V],Q=ae[V];H===void 0&&Q!==void 0&&(G[V]=Q)})})(re,K):L[Z.ref]?L[Z.ref].rules.push(K):j.push({ref:Z.ref,rules:[K]})})}),j};class w extends d{constructor(A){super();const{maxRows:L,maxCols:I,ignoreNodes:Z}=A||{};this.ignoreNodes=Z||[],this.map={sheetPr:new _,dimension:new f,sheetViews:new g({tag:"sheetViews",count:!1,childXform:new E}),sheetFormatPr:new N,cols:new g({tag:"cols",count:!1,childXform:new h}),sheetData:new g({tag:"sheetData",count:!1,empty:!0,childXform:new p({maxItems:I}),maxItems:L}),autoFilter:new U,mergeCells:new g({tag:"mergeCells",count:!0,childXform:new b}),rowBreaks:new M,hyperlinks:new g({tag:"hyperlinks",count:!1,childXform:new x}),pageMargins:new F,dataValidations:new v,pageSetup:new z,headerFooter:new D,printOptions:new P,picture:new W,drawing:new Y,sheetProtection:new O,tableParts:new g({tag:"tableParts",count:!0,childXform:new q}),conditionalFormatting:new T,extLst:new C}}prepare(A,L){L.merges=new o,A.hyperlinks=L.hyperlinks=[],A.comments=L.comments=[],L.formulae={},L.siFormulae=0,this.map.cols.prepare(A.cols,L),this.map.sheetData.prepare(A.rows,L),this.map.conditionalFormatting.prepare(A.conditionalFormattings,L),A.mergeCells=L.merges.mergeCells;const I=A.rels=[];function Z(G){return"rId"+(G.length+1)}if(A.hyperlinks.forEach(G=>{const ae=Z(I);G.rId=ae,I.push({Id:ae,Type:u.Hyperlink,Target:G.target,TargetMode:"External"})}),A.comments.length>0){const G={Id:Z(I),Type:u.Comments,Target:`../comments${A.id}.xml`};I.push(G);const ae={Id:Z(I),Type:u.VmlDrawing,Target:`../drawings/vmlDrawing${A.id}.vml`};I.push(ae),A.comments.forEach(V=>{V.refAddress=c.decodeAddress(V.ref)}),L.commentRefs.push({commentName:"comments"+A.id,vmlDrawing:"vmlDrawing"+A.id})}const K=[];let re;A.media.forEach(G=>{if(G.type==="background"){const ae=Z(I);re=L.media[G.imageId],I.push({Id:ae,Type:u.Image,Target:`../media/${re.name}.${re.extension}`}),A.background={rId:ae},A.image=L.media[G.imageId]}else if(G.type==="image"){let{drawing:ae}=A;re=L.media[G.imageId],ae||(ae=A.drawing={rId:Z(I),name:"drawing"+ ++L.drawingsCount,anchors:[],rels:[]},L.drawings.push(ae),I.push({Id:ae.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${ae.name}.xml`}));let V=this.preImageId===G.imageId?K[G.imageId]:K[ae.rels.length];V||(V=Z(ae.rels),K[ae.rels.length]=V,ae.rels.push({Id:V,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${re.name}.${re.extension}`}));const H={picture:{rId:V},range:G.range};if(G.hyperlinks&&G.hyperlinks.hyperlink){const Q=Z(ae.rels);K[ae.rels.length]=Q,H.picture.hyperlinks={tooltip:G.hyperlinks.tooltip,rId:Q},ae.rels.push({Id:Q,Type:u.Hyperlink,Target:G.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=G.imageId,ae.anchors.push(H)}}),A.tables.forEach(G=>{const ae=Z(I);G.rId=ae,I.push({Id:ae,Type:u.Table,Target:"../tables/"+G.target}),G.columns.forEach(V=>{const{style:H}=V;H&&(V.dxfId=L.styles.addDxfStyle(H))})}),this.map.extLst.prepare(A,L)}render(A,L){A.openXml(l.StdDocAttributes),A.openNode("worksheet",w.WORKSHEET_ATTRIBUTES);const I=L.properties?{defaultRowHeight:L.properties.defaultRowHeight,dyDescent:L.properties.dyDescent,outlineLevelCol:L.properties.outlineLevelCol,outlineLevelRow:L.properties.outlineLevelRow}:void 0;L.properties&&L.properties.defaultColWidth&&(I.defaultColWidth=L.properties.defaultColWidth);const Z={outlineProperties:L.properties&&L.properties.outlineProperties,tabColor:L.properties&&L.properties.tabColor,pageSetup:L.pageSetup&&L.pageSetup.fitToPage?{fitToPage:L.pageSetup.fitToPage}:void 0},K=L.pageSetup&&L.pageSetup.margins,re={showRowColHeaders:L.pageSetup&&L.pageSetup.showRowColHeaders,showGridLines:L.pageSetup&&L.pageSetup.showGridLines,horizontalCentered:L.pageSetup&&L.pageSetup.horizontalCentered,verticalCentered:L.pageSetup&&L.pageSetup.verticalCentered},G=L.sheetProtection;this.map.sheetPr.render(A,Z),this.map.dimension.render(A,L.dimensions),this.map.sheetViews.render(A,L.views),this.map.sheetFormatPr.render(A,I),this.map.cols.render(A,L.cols),this.map.sheetData.render(A,L.rows),this.map.sheetProtection.render(A,G),this.map.autoFilter.render(A,L.autoFilter),this.map.mergeCells.render(A,L.mergeCells),this.map.conditionalFormatting.render(A,L.conditionalFormattings),this.map.dataValidations.render(A,L.dataValidations),this.map.hyperlinks.render(A,L.hyperlinks),this.map.printOptions.render(A,re),this.map.pageMargins.render(A,K),this.map.pageSetup.render(A,L.pageSetup),this.map.headerFooter.render(A,L.headerFooter),this.map.rowBreaks.render(A,L.rowBreaks),this.map.drawing.render(A,L.drawing),this.map.picture.render(A,L.background),this.map.tableParts.render(A,L.tables),this.map.extLst.render(A,L),L.rels&&L.rels.forEach(ae=>{ae.Type===u.VmlDrawing&&A.leafNode("legacyDrawing",{"r:id":ae.Id})}),A.closeNode()}parseOpen(A){return this.parser?(this.parser.parseOpen(A),!0):A.name==="worksheet"?(i.each(this.map,L=>{L.reset()}),!0):(this.map[A.name]&&!this.ignoreNodes.includes(A.name)&&(this.parser=this.map[A.name],this.parser.parseOpen(A)),!0)}parseText(A){this.parser&&this.parser.parseText(A)}parseClose(A){if(this.parser)return this.parser.parseClose(A)||(this.parser=void 0),!0;switch(A){case"worksheet":{const L=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(L.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(L.outlineProperties=this.map.sheetPr.model.outlineProperties);const I={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},Z=Object.assign(I,this.map.pageSetup.model,this.map.printOptions.model),K=S(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:L,views:this.map.sheetViews.model,pageSetup:Z,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:K},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(A,L){const I=(A.relationships||[]).reduce((K,re)=>{if(K[re.Id]=re,re.Type===u.Comments&&(A.comments=L.comments[re.Target].comments),re.Type===u.VmlDrawing&&A.comments&&A.comments.length){const G=L.vmlDrawings[re.Target].comments;A.comments.forEach((ae,V)=>{ae.note=Object.assign({},ae.note,G[V])})}return K},{});if(L.commentsMap=(A.comments||[]).reduce((K,re)=>(re.ref&&(K[re.ref]=re),K),{}),L.hyperlinkMap=(A.hyperlinks||[]).reduce((K,re)=>(re.rId&&(K[re.address]=I[re.rId].Target),K),{}),L.formulae={},A.rows=A.rows&&A.rows.filter(Boolean)||[],A.rows.forEach(K=>{K.cells=K.cells&&K.cells.filter(Boolean)||[]}),this.map.cols.reconcile(A.cols,L),this.map.sheetData.reconcile(A.rows,L),this.map.conditionalFormatting.reconcile(A.conditionalFormattings,L),A.media=[],A.drawing){const K=I[A.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(K){const re=K[1];L.drawings[re].anchors.forEach(G=>{if(G.medium){const ae={type:"image",imageId:G.medium.index,range:G.range,hyperlinks:G.picture.hyperlinks};A.media.push(ae)}})}}const Z=A.background&&I[A.background.rId];if(Z){const K=Z.Target.split("/media/")[1],re=L.mediaIndex&&L.mediaIndex[K];re!==void 0&&A.media.push({type:"background",imageId:re})}A.tables=(A.tables||[]).map(K=>{const re=I[K.rId];return L.tables[re.Target]}),delete A.relationships,delete A.hyperlinks,delete A.comments}}w.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},a.exports=w},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{constructor(c){super(),this.tag=c.tag,this.attr=c.attr}render(c,l){l&&(c.openNode(this.tag),c.closeNode())}parseOpen(c){c.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{constructor(c){super(),this.tag=c.tag,this.attr=c.attr,this.attrs=c.attrs,this._format=c.format||function(l){try{return Number.isNaN(l.getTime())?"":l.toISOString()}catch{return""}},this._parse=c.parse||function(l){return new Date(l)}}render(c,l){l&&(c.openNode(this.tag),this.attrs&&c.addAttributes(this.attrs),this.attr?c.addAttribute(this.attr,this._format(l)):c.writeText(this._format(l)),c.closeNode())}parseOpen(c){c.name===this.tag&&(this.attr?this.model=this._parse(c.attributes[this.attr]):this.text=[])}parseText(c){this.attr||this.text.push(c)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{constructor(c){super(),this.tag=c.tag,this.attr=c.attr,this.attrs=c.attrs,this.zero=c.zero}render(c,l){(l||this.zero)&&(c.openNode(this.tag),this.attrs&&c.addAttributes(this.attrs),this.attr?c.addAttribute(this.attr,l):c.writeText(l),c.closeNode())}parseOpen(c){return c.name===this.tag&&(this.attr?this.model=parseInt(c.attributes[this.attr],10):this.text=[],!0)}parseText(c){this.attr||this.text.push(c)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{constructor(c){super(),this.tag=c.tag,this.attr=c.attr,this.attrs=c.attrs}render(c,l){l!==void 0&&(c.openNode(this.tag),this.attrs&&c.addAttributes(this.attrs),this.attr?c.addAttribute(this.attr,l):c.writeText(l),c.closeNode())}parseOpen(c){c.name===this.tag&&(this.attr?this.model=c.attributes[this.attr]:this.text=[])}parseText(c){this.attr||this.text.push(c)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(e,a,n){const i=e("./base-xform"),c=e("../../utils/xml-stream");a.exports=class extends i{constructor(l){super(),this._model=l}render(l){if(!this._xml){const u=new c;(function o(d,g){d.openNode(g.tag,g.$),g.c&&g.c.forEach(p=>{o(d,p)}),g.t&&d.writeText(g.t),d.closeNode()})(u,this._model),this._xml=u.xml}l.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(l){switch(l){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(e,a,n){const i=e("./text-xform"),c=e("./rich-text-xform"),l=e("../base-xform");a.exports=class extends l{constructor(){super(),this.map={r:new c,t:new i}}get tag(){return"rPh"}render(u,o){if(u.openNode(this.tag,{sb:o.sb||0,eb:o.eb||0}),o&&o.hasOwnProperty("richText")&&o.richText){const{r:d}=this.map;o.richText.forEach(g=>{d.render(u,g)})}else o&&this.map.t.render(u,o.text);u.closeNode()}parseOpen(u){const{name:o}=u;return this.parser?(this.parser.parseOpen(u),!0):o===this.tag?(this.model={sb:parseInt(u.attributes.sb,10),eb:parseInt(u.attributes.eb,10)},!0):(this.parser=this.map[o],!!this.parser&&(this.parser.parseOpen(u),!0))}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){switch(u){case"r":{let o=this.model.richText;o||(o=this.model.richText=[]),o.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(e,a,n){const i=e("./text-xform"),c=e("../style/font-xform"),l=e("../base-xform");class u extends l{constructor(d){super(),this.model=d}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new i)}get fontXform(){return this._fontXform||(this._fontXform=new c(u.FONT_OPTIONS))}render(d,g){g=g||this.model,d.openNode("r"),g.font&&this.fontXform.render(d,g.font),this.textXform.render(d,g.text),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(d),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){switch(d){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(d),!0}}}u.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},a.exports=u},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(e,a,n){const i=e("./text-xform"),c=e("./rich-text-xform"),l=e("./phonetic-text-xform"),u=e("../base-xform");a.exports=class extends u{constructor(o){super(),this.model=o,this.map={r:new c,t:new i,rPh:new l}}get tag(){return"si"}render(o,d){o.openNode(this.tag),d&&d.hasOwnProperty("richText")&&d.richText?d.richText.length?d.richText.forEach(g=>{this.map.r.render(o,g)}):this.map.t.render(o,""):d!=null&&this.map.t.render(o,d),o.closeNode()}parseOpen(o){const{name:d}=o;return this.parser?(this.parser.parseOpen(o),!0):d===this.tag?(this.model={},!0):(this.parser=this.map[d],!!this.parser&&(this.parser.parseOpen(o),!0))}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser){if(!this.parser.parseClose(o)){switch(o){case"r":{let d=this.model.richText;d||(d=this.model.richText=[]),d.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(e,a,n){const i=e("../../../utils/xml-stream"),c=e("../base-xform"),l=e("./shared-string-xform");a.exports=class extends c{constructor(u){super(),this.model=u||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new l)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(u){return this.model.values[u]}add(u){return u.richText?this.addRichText(u):this.addText(u)}addText(u){let o=this.hash[u];return o===void 0&&(o=this.hash[u]=this.model.values.length,this.model.values.push(u)),this.model.count++,o}addRichText(u){const o=this.sharedStringXform.toXml(u);let d=this.rich[o];return d===void 0&&(d=this.rich[o]=this.model.values.length,this.model.values.push(u)),this.model.count++,d}render(u,o){o=o||this._values,u.openXml(i.StdDocAttributes),u.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:o.count,uniqueCount:o.values.length});const d=this.sharedStringXform;o.values.forEach(g=>{d.render(u,g)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(u),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(u){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"t"}render(c,l){c.openNode("t"),/^\s|\n|\s$/.test(l)&&c.addAttribute("xml:space","preserve"),c.writeText(l),c.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(c,l)=>String.fromCharCode(parseInt(l,16)))}parseOpen(c){switch(c.name){case"t":return this._text=[],!0;default:return!1}}parseText(c){this._text.push(c)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(e,a,n){const i=e("../../../doc/enums"),c=e("../../../utils/utils"),l=e("../base-xform"),u={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((d,g)=>(d[g]=!0,d),{}),horizontal(d){return this.horizontalValues[d]?d:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((d,g)=>(d[g]=!0,d),{}),vertical(d){return d==="middle"?"center":this.verticalValues[d]?d:void 0},wrapText:d=>!!d||void 0,shrinkToFit:d=>!!d||void 0,textRotation(d){switch(d){case"vertical":return d;default:return(d=c.validInt(d))>=-90&&d<=90?d:void 0}},indent:d=>(d=c.validInt(d),Math.max(0,d)),readingOrder(d){switch(d){case"ltr":return i.ReadingOrder.LeftToRight;case"rtl":return i.ReadingOrder.RightToLeft;default:return}}},o={toXml(d){if(d=u.textRotation(d)){if(d==="vertical")return 255;const g=Math.round(d);if(g>=0&&g<=90)return g;if(g<0&&g>=-90)return 90-g}},toModel(d){const g=c.validInt(d);if(g!==void 0){if(g===255)return"vertical";if(g>=0&&g<=90)return g;if(g>90&&g<=180)return 90-g}}};a.exports=class extends l{get tag(){return"alignment"}render(d,g){d.addRollback(),d.openNode("alignment");let p=!1;function h(f,x){x&&(d.addAttribute(f,x),p=!0)}h("horizontal",u.horizontal(g.horizontal)),h("vertical",u.vertical(g.vertical)),h("wrapText",!!u.wrapText(g.wrapText)&&"1"),h("shrinkToFit",!!u.shrinkToFit(g.shrinkToFit)&&"1"),h("indent",u.indent(g.indent)),h("textRotation",o.toXml(g.textRotation)),h("readingOrder",u.readingOrder(g.readingOrder)),d.closeNode(),p?d.commit():d.rollback()}parseOpen(d){const g={};let p=!1;function h(f,x,b){f&&(g[x]=b,p=!0)}h(d.attributes.horizontal,"horizontal",d.attributes.horizontal),h(d.attributes.vertical,"vertical",d.attributes.vertical==="center"?"middle":d.attributes.vertical),h(d.attributes.wrapText,"wrapText",c.parseBoolean(d.attributes.wrapText)),h(d.attributes.shrinkToFit,"shrinkToFit",c.parseBoolean(d.attributes.shrinkToFit)),h(d.attributes.indent,"indent",parseInt(d.attributes.indent,10)),h(d.attributes.textRotation,"textRotation",o.toModel(d.attributes.textRotation)),h(d.attributes.readingOrder,"readingOrder",d.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=p?g:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(e,a,n){const i=e("../base-xform"),c=e("../../../utils/utils"),l=e("./color-xform");class u extends i{constructor(d){super(),this.name=d,this.map={color:new l}}get tag(){return this.name}render(d,g,p){const h=g&&g.color||p||this.defaultColor;d.openNode(this.name),g&&g.style&&(d.addAttribute("style",g.style),h&&this.map.color.render(d,h)),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.name:{const{style:g}=d.attributes;return this.model=g?{style:g}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):(d===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(d){return u.validStyleValues[d]}}u.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((o,d)=>(o[d]=!0,o),{}),a.exports=class extends i{constructor(){super(),this.map={top:new u("top"),left:new u("left"),bottom:new u("bottom"),right:new u("right"),diagonal:new u("diagonal")}}render(o,d){const{color:g}=d;function p(h,f){h&&!h.color&&d.color&&(h={...h,color:d.color}),f.render(o,h,g)}o.openNode("border"),d.diagonal&&d.diagonal.style&&(d.diagonal.up&&o.addAttribute("diagonalUp","1"),d.diagonal.down&&o.addAttribute("diagonalDown","1")),p(d.left,this.map.left),p(d.right,this.map.right),p(d.top,this.map.top),p(d.bottom,this.map.bottom),p(d.diagonal,this.map.diagonal),o.closeNode()}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case"border":return this.reset(),this.diagonalUp=c.parseBoolean(o.attributes.diagonalUp),this.diagonalDown=c.parseBoolean(o.attributes.diagonalDown),!0;default:return this.parser=this.map[o.name],!!this.parser&&(this.parser.parseOpen(o),!0)}}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser)return this.parser.parseClose(o)||(this.parser=void 0),!0;if(o==="border"){const d=this.model={},g=function(p,h,f){h&&(f&&Object.assign(h,f),d[p]=h)};g("left",this.map.left.model),g("right",this.map.right.model),g("top",this.map.top.model),g("bottom",this.map.bottom.model),g("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{constructor(c){super(),this.name=c||"color"}get tag(){return this.name}render(c,l){return!!l&&(c.openNode(this.name),l.argb?c.addAttribute("rgb",l.argb):l.theme!==void 0?(c.addAttribute("theme",l.theme),l.tint!==void 0&&c.addAttribute("tint",l.tint)):l.indexed!==void 0?c.addAttribute("indexed",l.indexed):c.addAttribute("auto","1"),c.closeNode(),!0)}parseOpen(c){return c.name===this.name&&(c.attributes.rgb?this.model={argb:c.attributes.rgb}:c.attributes.theme?(this.model={theme:parseInt(c.attributes.theme,10)},c.attributes.tint&&(this.model.tint=parseFloat(c.attributes.tint))):c.attributes.indexed?this.model={indexed:parseInt(c.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(e,a,n){const i=e("../base-xform"),c=e("./alignment-xform"),l=e("./border-xform"),u=e("./fill-xform"),o=e("./font-xform"),d=e("./numfmt-xform"),g=e("./protection-xform");a.exports=class extends i{constructor(){super(),this.map={alignment:new c,border:new l,fill:new u,font:new o,numFmt:new d,protection:new g}}get tag(){return"dxf"}render(p,h){if(p.openNode(this.tag),h.font&&this.map.font.render(p,h.font),h.numFmt&&h.numFmtId){const f={id:h.numFmtId,formatCode:h.numFmt};this.map.numFmt.render(p,f)}h.fill&&this.map.fill.render(p,h.fill),h.alignment&&this.map.alignment.render(p,h.alignment),h.border&&this.map.border.render(p,h.border),h.protection&&this.map.protection.render(p,h.protection),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[p.name],this.parser&&this.parser.parseOpen(p),!0}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return this.parser?(this.parser.parseClose(p)||(this.parser=void 0),!0):p!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(e,a,n){const i=e("../base-xform"),c=e("./color-xform");class l extends i{constructor(){super(),this.map={color:new c}}get tag(){return"stop"}render(p,h){p.openNode("stop"),p.addAttribute("position",h.position),this.map.color.render(p,h.color),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"stop":return this.model={position:parseFloat(p.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(p),!0;default:return!1}}parseText(){}parseClose(p){return!!this.parser&&(this.parser.parseClose(p)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class u extends i{constructor(){super(),this.map={fgColor:new c("fgColor"),bgColor:new c("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(p,h){p.openNode("patternFill"),p.addAttribute("patternType",h.pattern),h.fgColor&&this.map.fgColor.render(p,h.fgColor),h.bgColor&&this.map.bgColor.render(p,h.bgColor),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"patternFill":return this.model={type:"pattern",pattern:p.attributes.patternType},!0;default:return this.parser=this.map[p.name],!!this.parser&&(this.parser.parseOpen(p),!0)}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return!!this.parser&&(this.parser.parseClose(p)||(this.parser.model&&(this.model[p]=this.parser.model),this.parser=void 0),!0)}}class o extends i{constructor(){super(),this.map={stop:new l}}get name(){return"gradient"}get tag(){return"gradientFill"}render(p,h){switch(p.openNode("gradientFill"),h.gradient){case"angle":p.addAttribute("degree",h.degree);break;case"path":p.addAttribute("type","path"),h.center.left&&(p.addAttribute("left",h.center.left),h.center.right===void 0&&p.addAttribute("right",h.center.left)),h.center.right&&p.addAttribute("right",h.center.right),h.center.top&&(p.addAttribute("top",h.center.top),h.center.bottom===void 0&&p.addAttribute("bottom",h.center.top)),h.center.bottom&&p.addAttribute("bottom",h.center.bottom)}const f=this.map.stop;h.stops.forEach(x=>{f.render(p,x)}),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"gradientFill":{const h=this.model={stops:[]};return p.attributes.degree?(h.gradient="angle",h.degree=parseInt(p.attributes.degree,10)):p.attributes.type==="path"&&(h.gradient="path",h.center={left:p.attributes.left?parseFloat(p.attributes.left):0,top:p.attributes.top?parseFloat(p.attributes.top):0},p.attributes.right!==p.attributes.left&&(h.center.right=p.attributes.right?parseFloat(p.attributes.right):0),p.attributes.bottom!==p.attributes.top&&(h.center.bottom=p.attributes.bottom?parseFloat(p.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(p),!0;default:return!1}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return!!this.parser&&(this.parser.parseClose(p)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class d extends i{constructor(){super(),this.map={patternFill:new u,gradientFill:new o}}get tag(){return"fill"}render(p,h){switch(p.addRollback(),p.openNode("fill"),h.type){case"pattern":this.map.patternFill.render(p,h);break;case"gradient":this.map.gradientFill.render(p,h);break;default:return void p.rollback()}p.closeNode(),p.commit()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"fill":return this.model={},!0;default:return this.parser=this.map[p.name],!!this.parser&&(this.parser.parseOpen(p),!0)}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return!!this.parser&&(this.parser.parseClose(p)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(p){return d.validPatternValues[p]}}d.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((g,p)=>(g[p]=!0,g),{}),d.StopXform=l,d.PatternFillXform=u,d.GradientFillXform=o,a.exports=d},{"../base-xform":32,"./color-xform":128}],131:[function(e,a,n){const i=e("./color-xform"),c=e("../simple/boolean-xform"),l=e("../simple/integer-xform"),u=e("../simple/string-xform"),o=e("./underline-xform"),d=e("../../../utils/under-dash"),g=e("../base-xform");class p extends g{constructor(f){super(),this.options=f||p.OPTIONS,this.map={b:{prop:"bold",xform:new c({tag:"b",attr:"val"})},i:{prop:"italic",xform:new c({tag:"i",attr:"val"})},u:{prop:"underline",xform:new o},charset:{prop:"charset",xform:new l({tag:"charset",attr:"val"})},color:{prop:"color",xform:new i},condense:{prop:"condense",xform:new c({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new c({tag:"extend",attr:"val"})},family:{prop:"family",xform:new l({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new c({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new u({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new u({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new c({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new c({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new l({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new u({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(f,x){const{map:b}=this;f.openNode(this.options.tagName),d.each(this.map,(v,_)=>{b[_].xform.render(f,x[v.prop])}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;if(this.map[f.name])return this.parser=this.map[f.name].xform,this.parser.parseOpen(f);switch(f.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser&&!this.parser.parseClose(f)){const x=this.map[f];return this.parser.model&&(this.model[x.prop]=this.parser.model),this.parser=void 0,!0}switch(f){case this.options.tagName:return!1;default:return!0}}}p.OPTIONS={tagName:"font",fontNameTag:"name"},a.exports=p},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(e,a,n){const i=e("../../../utils/under-dash"),c=e("../../defaultnumformats"),l=e("../base-xform"),u=function(){const d={};return i.each(c,(g,p)=>{g.f&&(d[g.f]=parseInt(p,10))}),d}();class o extends l{constructor(g,p){super(),this.id=g,this.formatCode=p}get tag(){return"numFmt"}render(g,p){g.leafNode("numFmt",{numFmtId:p.id,formatCode:p.formatCode})}parseOpen(g){switch(g.name){case"numFmt":return this.model={id:parseInt(g.attributes.numFmtId,10),formatCode:g.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}o.getDefaultFmtId=function(d){return u[d]},o.getDefaultFmtCode=function(d){return c[d]&&c[d].f},a.exports=o},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(e,a,n){const i=e("../base-xform"),c={boolean:(l,u)=>l===void 0?u:l};a.exports=class extends i{get tag(){return"protection"}render(l,u){l.addRollback(),l.openNode("protection");let o=!1;function d(g,p){p!==void 0&&(l.addAttribute(g,p),o=!0)}d("locked",c.boolean(u.locked,!0)?void 0:"0"),d("hidden",c.boolean(u.hidden,!1)?"1":void 0),l.closeNode(),o?l.commit():l.rollback()}parseOpen(l){const u={locked:l.attributes.locked!=="0",hidden:l.attributes.hidden==="1"},o=!u.locked||u.hidden;this.model=o?u:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(e,a,n){const i=e("../base-xform"),c=e("./alignment-xform"),l=e("./protection-xform");a.exports=class extends i{constructor(u){super(),this.xfId=!(!u||!u.xfId),this.map={alignment:new c,protection:new l}}get tag(){return"xf"}render(u,o){u.openNode("xf",{numFmtId:o.numFmtId||0,fontId:o.fontId||0,fillId:o.fillId||0,borderId:o.borderId||0}),this.xfId&&u.addAttribute("xfId",o.xfId||0),o.numFmtId&&u.addAttribute("applyNumberFormat","1"),o.fontId&&u.addAttribute("applyFont","1"),o.fillId&&u.addAttribute("applyFill","1"),o.borderId&&u.addAttribute("applyBorder","1"),o.alignment&&u.addAttribute("applyAlignment","1"),o.protection&&u.addAttribute("applyProtection","1"),o.alignment&&this.map.alignment.render(u,o.alignment),o.protection&&this.map.protection.render(u,o.protection),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"xf":return this.model={numFmtId:parseInt(u.attributes.numFmtId,10),fontId:parseInt(u.attributes.fontId,10),fillId:parseInt(u.attributes.fillId,10),borderId:parseInt(u.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(u.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(u),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):u!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(e,a,n){const i=e("../../../doc/enums"),c=e("../../../utils/xml-stream"),l=e("../base-xform"),u=e("../static-xform"),o=e("../list-xform"),d=e("./font-xform"),g=e("./fill-xform"),p=e("./border-xform"),h=e("./numfmt-xform"),f=e("./style-xform"),x=e("./dxf-xform");class b extends l{constructor(_){super(),this.map={numFmts:new o({tag:"numFmts",count:!0,childXform:new h}),fonts:new o({tag:"fonts",count:!0,childXform:new d,$:{"x14ac:knownFonts":1}}),fills:new o({tag:"fills",count:!0,childXform:new g}),borders:new o({tag:"borders",count:!0,childXform:new p}),cellStyleXfs:new o({tag:"cellStyleXfs",count:!0,childXform:new f}),cellXfs:new o({tag:"cellXfs",count:!0,childXform:new f({xfId:!0})}),dxfs:new o({tag:"dxfs",always:!0,count:!0,childXform:new x}),numFmt:new h,font:new d,fill:new g,border:new p,style:new f({xfId:!0}),cellStyles:b.STATIC_XFORMS.cellStyles,tableStyles:b.STATIC_XFORMS.tableStyles,extLst:b.STATIC_XFORMS.extLst},_&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(_,N){N=N||this.model,_.openXml(c.StdDocAttributes),_.openNode("styleSheet",b.STYLESHEET_ATTRIBUTES),this.index?(N.numFmts&&N.numFmts.length&&(_.openNode("numFmts",{count:N.numFmts.length}),N.numFmts.forEach(E=>{_.writeXml(E)}),_.closeNode()),N.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),_.openNode("fonts",{count:N.fonts.length,"x14ac:knownFonts":1}),N.fonts.forEach(E=>{_.writeXml(E)}),_.closeNode(),_.openNode("fills",{count:N.fills.length}),N.fills.forEach(E=>{_.writeXml(E)}),_.closeNode(),_.openNode("borders",{count:N.borders.length}),N.borders.forEach(E=>{_.writeXml(E)}),_.closeNode(),this.map.cellStyleXfs.render(_,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),_.openNode("cellXfs",{count:N.styles.length}),N.styles.forEach(E=>{_.writeXml(E)}),_.closeNode()):(this.map.numFmts.render(_,N.numFmts),this.map.fonts.render(_,N.fonts),this.map.fills.render(_,N.fills),this.map.borders.render(_,N.borders),this.map.cellStyleXfs.render(_,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(_,N.styles)),b.STATIC_XFORMS.cellStyles.render(_),this.map.dxfs.render(_,N.dxfs),b.STATIC_XFORMS.tableStyles.render(_),b.STATIC_XFORMS.extLst.render(_),_.closeNode()}parseOpen(_){if(this.parser)return this.parser.parseOpen(_),!0;switch(_.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[_.name],this.parser&&this.parser.parseOpen(_),!0}}parseText(_){this.parser&&this.parser.parseText(_)}parseClose(_){if(this.parser)return this.parser.parseClose(_)||(this.parser=void 0),!0;switch(_){case"styleSheet":{this.model={};const N=(E,O)=>{O.model&&O.model.length&&(this.model[E]=O.model)};if(N("numFmts",this.map.numFmts),N("fonts",this.map.fonts),N("fills",this.map.fills),N("borders",this.map.borders),N("styles",this.map.cellXfs),N("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const E=this.index.numFmt;this.model.numFmts.forEach(O=>{E[O.id]=O.formatCode})}return!1}default:return!0}}addStyleModel(_,N){if(!_)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(_))return this.weakMap.get(_);const E={};if(N=N||i.ValueType.Number,_.numFmt)E.numFmtId=this._addNumFmtStr(_.numFmt);else switch(N){case i.ValueType.Number:E.numFmtId=this._addNumFmtStr("General");break;case i.ValueType.Date:E.numFmtId=this._addNumFmtStr("mm-dd-yy")}_.font&&(E.fontId=this._addFont(_.font)),_.border&&(E.borderId=this._addBorder(_.border)),_.fill&&(E.fillId=this._addFill(_.fill)),_.alignment&&(E.alignment=_.alignment),_.protection&&(E.protection=_.protection);const O=this._addStyle(E);return this.weakMap&&this.weakMap.set(_,O),O}getStyleModel(_){const N=this.model.styles[_];if(!N)return null;let E=this.index.model[_];if(E)return E;if(E=this.index.model[_]={},N.numFmtId){const F=this.index.numFmt[N.numFmtId]||h.getDefaultFmtCode(N.numFmtId);F&&(E.numFmt=F)}function O(F,z,P){if(P||P===0){const U=z[P];U&&(E[F]=U)}}return O("font",this.model.fonts,N.fontId),O("border",this.model.borders,N.borderId),O("fill",this.model.fills,N.fillId),N.alignment&&(E.alignment=N.alignment),N.protection&&(E.protection=N.protection),E}addDxfStyle(_){return _.numFmt&&(_.numFmtId=this._addNumFmtStr(_.numFmt)),this.model.dxfs.push(_),this.model.dxfs.length-1}getDxfStyle(_){return this.model.dxfs[_]}_addStyle(_){const N=this.map.style.toXml(_);let E=this.index.style[N];return E===void 0&&(E=this.index.style[N]=this.model.styles.length,this.model.styles.push(N)),E}_addNumFmtStr(_){let N=h.getDefaultFmtId(_);if(N!==void 0||(N=this.index.numFmt[_],N!==void 0))return N;N=this.index.numFmt[_]=164+this.model.numFmts.length;const E=this.map.numFmt.toXml({id:N,formatCode:_});return this.model.numFmts.push(E),N}_addFont(_){const N=this.map.font.toXml(_);let E=this.index.font[N];return E===void 0&&(E=this.index.font[N]=this.model.fonts.length,this.model.fonts.push(N)),E}_addBorder(_){const N=this.map.border.toXml(_);let E=this.index.border[N];return E===void 0&&(E=this.index.border[N]=this.model.borders.length,this.model.borders.push(N)),E}_addFill(_){const N=this.map.fill.toXml(_);let E=this.index.fill[N];return E===void 0&&(E=this.index.fill[N]=this.model.fills.length,this.model.fills.push(N)),E}}b.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},b.STATIC_XFORMS={cellStyles:new u({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new u({tag:"dxfs",$:{count:0}}),tableStyles:new u({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new u({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},b.Mock=class extends b{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(v){return v.autodrain(),Promise.resolve()}addStyleModel(v,_){switch(_){case i.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const v={numFmtId:h.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(v)}return this._dateStyleId}getStyleModel(){return{}}},a.exports=b},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(e,a,n){const i=e("../base-xform");class c extends i{constructor(u){super(),this.model=u}get tag(){return"u"}render(u,o){if((o=o||this.model)===!0)u.leafNode("u");else{const d=c.Attributes[o];d&&u.leafNode("u",d)}}parseOpen(u){u.name==="u"&&(this.model=u.attributes.val||!0)}parseText(){}parseClose(){return!1}}c.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},a.exports=c},{"../base-xform":32}],137:[function(e,a,n){const i=e("../base-xform"),c=e("./filter-column-xform");a.exports=class extends i{constructor(){super(),this.map={filterColumn:new c}}get tag(){return"autoFilter"}prepare(l){l.columns.forEach((u,o)=>{this.map.filterColumn.prepare(u,{index:o})})}render(l,u){return l.openNode(this.tag,{ref:u.autoFilterRef}),u.columns.forEach(o=>{this.map.filterColumn.render(l,o)}),l.closeNode(),!0}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:return this.model={autoFilterRef:l.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(l){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+l)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"customFilter"}render(c,l){c.leafNode(this.tag,{val:l.val,operator:l.operator})}parseOpen(c){return c.name===this.tag&&(this.model={val:c.attributes.val,operator:c.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(e,a,n){const i=e("../base-xform"),c=e("../list-xform"),l=e("./custom-filter-xform"),u=e("./filter-xform");a.exports=class extends i{constructor(){super(),this.map={customFilters:new c({tag:"customFilters",count:!1,empty:!0,childXform:new l}),filters:new c({tag:"filters",count:!1,empty:!0,childXform:new u})}}get tag(){return"filterColumn"}prepare(o,d){o.colId=d.index.toString()}render(o,d){return d.customFilters?(o.openNode(this.tag,{colId:d.colId,hiddenButton:d.filterButton?"0":"1"}),this.map.customFilters.render(o,d.customFilters),o.closeNode(),!0):(o.leafNode(this.tag,{colId:d.colId,hiddenButton:d.filterButton?"0":"1"}),!0)}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;const{attributes:d}=o;switch(o.name){case this.tag:return this.model={filterButton:d.hiddenButton==="0"},!0;default:if(this.parser=this.map[o.name],this.parser)return this.parseOpen(o),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(o))}}parseText(){}parseClose(o){if(this.parser)return this.parser.parseClose(o)||(this.parser=void 0),!0;switch(o){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"filter"}render(c,l){c.leafNode(this.tag,{val:l.val})}parseOpen(c){return c.name===this.tag&&(this.model={val:c.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"tableColumn"}prepare(c,l){c.id=l.index+1}render(c,l){return c.leafNode(this.tag,{id:l.id.toString(),name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId}),!0}parseOpen(c){if(c.name===this.tag){const{attributes:l}=c;return this.model={name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(e,a,n){const i=e("../base-xform");a.exports=class extends i{get tag(){return"tableStyleInfo"}render(c,l){return c.leafNode(this.tag,{name:l.theme?l.theme:void 0,showFirstColumn:l.showFirstColumn?"1":"0",showLastColumn:l.showLastColumn?"1":"0",showRowStripes:l.showRowStripes?"1":"0",showColumnStripes:l.showColumnStripes?"1":"0"}),!0}parseOpen(c){if(c.name===this.tag){const{attributes:l}=c;return this.model={theme:l.name?l.name:null,showFirstColumn:l.showFirstColumn==="1",showLastColumn:l.showLastColumn==="1",showRowStripes:l.showRowStripes==="1",showColumnStripes:l.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(e,a,n){const i=e("../../../utils/xml-stream"),c=e("../base-xform"),l=e("../list-xform"),u=e("./auto-filter-xform"),o=e("./table-column-xform"),d=e("./table-style-info-xform");class g extends c{constructor(){super(),this.map={autoFilter:new u,tableColumns:new l({tag:"tableColumns",count:!0,empty:!0,childXform:new o}),tableStyleInfo:new d}}prepare(h,f){this.map.autoFilter.prepare(h),this.map.tableColumns.prepare(h.columns,f)}get tag(){return"table"}render(h,f){h.openXml(i.StdDocAttributes),h.openNode(this.tag,{...g.TABLE_ATTRIBUTES,id:f.id,name:f.name,displayName:f.displayName||f.name,ref:f.tableRef,totalsRowCount:f.totalsRow?"1":void 0,totalsRowShown:f.totalsRow?void 0:"1",headerRowCount:f.headerRow?"1":"0"}),this.map.autoFilter.render(h,f),this.map.tableColumns.render(h,f.columns),this.map.tableStyleInfo.render(h,f.style),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;const{name:f,attributes:x}=h;switch(f){case this.tag:this.reset(),this.model={name:x.name,displayName:x.displayName||x.name,tableRef:x.ref,totalsRow:x.totalsRowCount==="1",headerRow:x.headerRowCount==="1"};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((f,x)=>{this.model.columns[x].filterButton=f.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(h,f){h.columns.forEach(x=>{x.dxfId!==void 0&&(x.style=f.styles.getDxfStyle(x.dxfId))})}}g.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},a.exports=g},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(e,a,n){(function(i,c){(function(){const l=e("fs"),u=e("jszip"),{PassThrough:o}=e("readable-stream"),d=e("../utils/zip-stream"),g=e("../utils/stream-buf"),p=e("../utils/utils"),h=e("../utils/xml-stream"),{bufferToString:f}=e("../utils/browser-buffer-decode"),x=e("./xform/style/styles-xform"),b=e("./xform/core/core-xform"),v=e("./xform/strings/shared-strings-xform"),_=e("./xform/core/relationships-xform"),N=e("./xform/core/content-types-xform"),E=e("./xform/core/app-xform"),O=e("./xform/book/workbook-xform"),F=e("./xform/sheet/worksheet-xform"),z=e("./xform/drawing/drawing-xform"),P=e("./xform/table/table-xform"),U=e("./xform/comment/comments-xform"),W=e("./xform/comment/vml-notes-xform"),Y=e("./xml/theme1");class q{constructor(D){this.workbook=D}async readFile(D,T){if(!await p.fs.exists(D))throw new Error("File not found: "+D);const C=l.createReadStream(D);try{const S=await this.read(C,T);return C.close(),S}catch(S){throw C.close(),S}}parseRels(D){return new _().parseStream(D)}parseWorkbook(D){return new O().parseStream(D)}parseSharedStrings(D){return new v().parseStream(D)}reconcile(D,T){const C=new O,S=new F(T),w=new z,j=new P;C.reconcile(D);const A={media:D.media,mediaIndex:D.mediaIndex};Object.keys(D.drawings).forEach(Z=>{const K=D.drawings[Z],re=D.drawingRels[Z];re&&(A.rels=re.reduce((G,ae)=>(G[ae.Id]=ae,G),{}),(K.anchors||[]).forEach(G=>{const ae=G.picture&&G.picture.hyperlinks;ae&&A.rels[ae.rId]&&(ae.hyperlink=A.rels[ae.rId].Target,delete ae.rId)}),w.reconcile(K,A))});const L={styles:D.styles};Object.values(D.tables).forEach(Z=>{j.reconcile(Z,L)});const I={styles:D.styles,sharedStrings:D.sharedStrings,media:D.media,mediaIndex:D.mediaIndex,date1904:D.properties&&D.properties.date1904,drawings:D.drawings,comments:D.comments,tables:D.tables,vmlDrawings:D.vmlDrawings};D.worksheets.forEach(Z=>{Z.relationships=D.worksheetRels[Z.sheetNo],S.reconcile(Z,I)}),delete D.worksheetHash,delete D.worksheetRels,delete D.globalRels,delete D.sharedStrings,delete D.workbookRels,delete D.sheetDefs,delete D.styles,delete D.mediaIndex,delete D.drawings,delete D.drawingRels,delete D.vmlDrawings}async _processWorksheetEntry(D,T,C,S,w){const j=new F(S),A=await j.parseStream(D);A.sheetNo=C,T.worksheetHash[w]=A,T.worksheets.push(A)}async _processCommentEntry(D,T,C){const S=new U,w=await S.parseStream(D);T.comments[`../${C}.xml`]=w}async _processTableEntry(D,T,C){const S=new P,w=await S.parseStream(D);T.tables[`../tables/${C}.xml`]=w}async _processWorksheetRelsEntry(D,T,C){const S=new _,w=await S.parseStream(D);T.worksheetRels[C]=w}async _processMediaEntry(D,T,C){const S=C.lastIndexOf(".");if(S>=1){const w=C.substr(S+1),j=C.substr(0,S);await new Promise((A,L)=>{const I=new g;I.on("finish",()=>{T.mediaIndex[C]=T.media.length,T.mediaIndex[j]=T.media.length;const Z={type:"image",name:j,extension:w,buffer:I.toBuffer()};T.media.push(Z),A()}),D.on("error",Z=>{L(Z)}),D.pipe(I)})}}async _processDrawingEntry(D,T,C){const S=new z,w=await S.parseStream(D);T.drawings[C]=w}async _processDrawingRelsEntry(D,T,C){const S=new _,w=await S.parseStream(D);T.drawingRels[C]=w}async _processVmlDrawingEntry(D,T,C){const S=new W,w=await S.parseStream(D);T.vmlDrawings[`../drawings/${C}.vml`]=w}async _processThemeEntry(D,T,C){await new Promise((S,w)=>{const j=new g;D.on("error",w),j.on("error",w),j.on("finish",()=>{T.themes[C]=j.read().toString(),S()}),D.pipe(j)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(D,T){!D[Symbol.asyncIterator]&&D.pipe&&(D=D.pipe(new o));const C=[];for await(const S of D)C.push(S);return this.load(c.concat(C),T)}async load(D,T){let C;C=T&&T.base64?c.from(D.toString(),"base64"):D;const S={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},w=await u.loadAsync(C);for(const j of Object.values(w.files))if(!j.dir){let A,L=j.name;if(L[0]==="/"&&(L=L.substr(1)),L.match(/xl\/media\//)||L.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))A=new o,A.write(await j.async("nodebuffer"));else{let I;A=new o({writableObjectMode:!0,readableObjectMode:!0}),I=i.browser?f(await j.async("nodebuffer")):await j.async("string");const Z=16384;for(let K=0;K<I.length;K+=Z)A.write(I.substring(K,K+Z))}switch(A.end(),L){case"_rels/.rels":S.globalRels=await this.parseRels(A);break;case"xl/workbook.xml":{const I=await this.parseWorkbook(A);S.sheets=I.sheets,S.definedNames=I.definedNames,S.views=I.views,S.properties=I.properties,S.calcProperties=I.calcProperties;break}case"xl/_rels/workbook.xml.rels":S.workbookRels=await this.parseRels(A);break;case"xl/sharedStrings.xml":S.sharedStrings=new v,await S.sharedStrings.parseStream(A);break;case"xl/styles.xml":S.styles=new x,await S.styles.parseStream(A);break;case"docProps/app.xml":{const I=new E,Z=await I.parseStream(A);S.company=Z.company,S.manager=Z.manager;break}case"docProps/core.xml":{const I=new b,Z=await I.parseStream(A);Object.assign(S,Z);break}default:{let I=L.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(I){await this._processWorksheetEntry(A,S,I[1],T,L);break}if(I=L.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),I){await this._processWorksheetRelsEntry(A,S,I[1]);break}if(I=L.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),I){await this._processThemeEntry(A,S,I[1]);break}if(I=L.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),I){await this._processMediaEntry(A,S,I[1]);break}if(I=L.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),I){await this._processDrawingEntry(A,S,I[1]);break}if(I=L.match(/xl\/(comments\d+)[.]xml/),I){await this._processCommentEntry(A,S,I[1]);break}if(I=L.match(/xl\/tables\/(table\d+)[.]xml/),I){await this._processTableEntry(A,S,I[1]);break}if(I=L.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),I){await this._processDrawingRelsEntry(A,S,I[1]);break}if(I=L.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),I){await this._processVmlDrawingEntry(A,S,I[1]);break}}}}return this.reconcile(S,T),this.workbook.model=S,this.workbook}async addMedia(D,T){await Promise.all(T.media.map(async C=>{if(C.type==="image"){const S=`xl/media/${C.name}.${C.extension}`;if(C.filename){const w=await function(j,A){return new Promise((L,I)=>{l.readFile(j,A,(Z,K)=>{Z?I(Z):L(K)})})}(C.filename);return D.append(w,{name:S})}if(C.buffer)return D.append(C.buffer,{name:S});if(C.base64){const w=C.base64,j=w.substring(w.indexOf(",")+1);return D.append(j,{name:S,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(D,T){const C=new z,S=new _;T.worksheets.forEach(w=>{const{drawing:j}=w;if(j){C.prepare(j,{});let A=C.toXml(j);D.append(A,{name:`xl/drawings/${j.name}.xml`}),A=S.toXml(j.rels),D.append(A,{name:`xl/drawings/_rels/${j.name}.xml.rels`})}})}addTables(D,T){const C=new P;T.worksheets.forEach(S=>{const{tables:w}=S;w.forEach(j=>{C.prepare(j,{});const A=C.toXml(j);D.append(A,{name:"xl/tables/"+j.target})})})}async addContentTypes(D,T){const C=new N().toXml(T);D.append(C,{name:"[Content_Types].xml"})}async addApp(D,T){const C=new E().toXml(T);D.append(C,{name:"docProps/app.xml"})}async addCore(D,T){const C=new b;D.append(C.toXml(T),{name:"docProps/core.xml"})}async addThemes(D,T){const C=T.themes||{theme1:Y};Object.keys(C).forEach(S=>{const w=C[S],j=`xl/theme/${S}.xml`;D.append(w,{name:j})})}async addOfficeRels(D){const T=new _().toXml([{Id:"rId1",Type:q.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:q.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:q.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);D.append(T,{name:"_rels/.rels"})}async addWorkbookRels(D,T){let C=1;const S=[{Id:"rId"+C++,Type:q.RelType.Styles,Target:"styles.xml"},{Id:"rId"+C++,Type:q.RelType.Theme,Target:"theme/theme1.xml"}];T.sharedStrings.count&&S.push({Id:"rId"+C++,Type:q.RelType.SharedStrings,Target:"sharedStrings.xml"}),T.worksheets.forEach(j=>{j.rId="rId"+C++,S.push({Id:j.rId,Type:q.RelType.Worksheet,Target:`worksheets/sheet${j.id}.xml`})});const w=new _().toXml(S);D.append(w,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(D,T){T.sharedStrings&&T.sharedStrings.count&&D.append(T.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(D,T){const{xml:C}=T.styles;C&&D.append(C,{name:"xl/styles.xml"})}async addWorkbook(D,T){const C=new O;D.append(C.toXml(T),{name:"xl/workbook.xml"})}async addWorksheets(D,T){const C=new F,S=new _,w=new U,j=new W;T.worksheets.forEach(A=>{let L=new h;C.render(L,A),D.append(L.xml,{name:`xl/worksheets/sheet${A.id}.xml`}),A.rels&&A.rels.length&&(L=new h,S.render(L,A.rels),D.append(L.xml,{name:`xl/worksheets/_rels/sheet${A.id}.xml.rels`})),A.comments.length>0&&(L=new h,w.render(L,A),D.append(L.xml,{name:`xl/comments${A.id}.xml`}),L=new h,j.render(L,A),D.append(L.xml,{name:`xl/drawings/vmlDrawing${A.id}.vml`}))})}_finalize(D){return new Promise((T,C)=>{D.on("finish",()=>{T(this)}),D.on("error",C),D.finalize()})}prepareModel(D,T){D.creator=D.creator||"ExcelJS",D.lastModifiedBy=D.lastModifiedBy||"ExcelJS",D.created=D.created||new Date,D.modified=D.modified||new Date,D.useSharedStrings=T.useSharedStrings===void 0||T.useSharedStrings,D.useStyles=T.useStyles===void 0||T.useStyles,D.sharedStrings=new v,D.styles=D.useStyles?new x(!0):new x.Mock;const C=new O,S=new F;C.prepare(D);const w={sharedStrings:D.sharedStrings,styles:D.styles,date1904:D.properties.date1904,drawingsCount:0,media:D.media};w.drawings=D.drawings=[],w.commentRefs=D.commentRefs=[];let j=0;D.tables=[],D.worksheets.forEach(A=>{A.tables.forEach(L=>{j++,L.target=`table${j}.xml`,L.id=j,D.tables.push(L)}),S.prepare(A,w)})}async write(D,T){T=T||{};const{model:C}=this.workbook,S=new d.ZipWriter(T.zip);return S.pipe(D),this.prepareModel(C,T),await this.addContentTypes(S,C),await this.addOfficeRels(S,C),await this.addWorkbookRels(S,C),await this.addWorksheets(S,C),await this.addSharedStrings(S,C),await this.addDrawings(S,C),await this.addTables(S,C),await Promise.all([this.addThemes(S,C),this.addStyles(S,C)]),await this.addMedia(S,C),await Promise.all([this.addApp(S,C),this.addCore(S,C)]),await this.addWorkbook(S,C),this._finalize(S)}writeFile(D,T){const C=l.createWriteStream(D);return new Promise((S,w)=>{C.on("finish",()=>{S()}),C.on("error",j=>{w(j)}),this.write(C,T).then(()=>{C.end()}).catch(j=>{w(j)})})}async writeBuffer(D){const T=new g;return await this.write(T,D),T.read()}}q.RelType=e("./rel-type"),a.exports=q}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(e,a,n){a.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(e,a,n){(function(i){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.CsvFormatterStream=void 0;const c=e("stream"),l=e("./formatter");class u extends c.Transform{constructor(d){super({writableObjectMode:d.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=d,this.rowFormatter=new l.RowFormatter(d),this.hasWrittenBOM=!d.writeBOM}transform(d){return this.rowFormatter.rowTransform=d,this}_transform(d,g,p){let h=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(d,(f,x)=>f?(h=!0,p(f)):(x&&x.forEach(b=>{this.push(i.from(b,"utf8"))}),h=!0,p()))}catch(f){if(h)throw f;p(f)}}_flush(d){this.rowFormatter.finish((g,p)=>g?d(g):(p&&p.forEach(h=>{this.push(i.from(h,"utf8"))}),d()))}}n.CsvFormatterStream=u}).call(this)}).call(this,e("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FormatterOptions=void 0,n.FormatterOptions=class{constructor(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var c;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,i||{}),(i==null?void 0:i.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(i==null?void 0:i.quote)===!0?this.quote='"':(i==null?void 0:i.quote)===!1&&(this.quote=""),typeof(i==null?void 0:i.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((c=i.writeHeaders)===null||c===void 0||c),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(e,a,n){var i=function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(n,"__esModule",{value:!0}),n.FieldFormatter=void 0;const c=i(e("lodash.isboolean")),l=i(e("lodash.isnil")),u=i(e("lodash.escaperegexp"));n.FieldFormatter=class{constructor(o){this._headers=null,this.formatterOptions=o,o.headers!==null&&(this.headers=o.headers),this.REPLACE_REGEXP=new RegExp(o.quote,"g");const d=`[${o.delimiter}${u.default(o.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(d)}set headers(o){this._headers=o}shouldQuote(o,d){const g=d?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return c.default(g)?g:Array.isArray(g)?g[o]:this._headers!==null&&g[this._headers[o]]}format(o,d,g){const p=(""+(l.default(o)?"":o)).replace(/\0/g,""),{formatterOptions:h}=this;return h.quote!==""&&p.indexOf(h.quote)!==-1?this.quoteField(p.replace(this.REPLACE_REGEXP,h.escapedQuote)):p.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(d,g)?this.quoteField(p):p}quoteField(o){const{quote:d}=this.formatterOptions;return`${d}${o}${d}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(e,a,n){var i=function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(n,"__esModule",{value:!0}),n.RowFormatter=void 0;const c=i(e("lodash.isfunction")),l=i(e("lodash.isequal")),u=e("./FieldFormatter"),o=e("../types");class d{constructor(p){this.rowCount=0,this.formatterOptions=p,this.fieldFormatter=new u.FieldFormatter(p),this.headers=p.headers,this.shouldWriteHeaders=p.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),p.transform&&(this.rowTransform=p.transform)}static isRowHashArray(p){return!!Array.isArray(p)&&Array.isArray(p[0])&&p[0].length===2}static isRowArray(p){return Array.isArray(p)&&!this.isRowHashArray(p)}static gatherHeaders(p){return d.isRowHashArray(p)?p.map(h=>h[0]):Array.isArray(p)?p:Object.keys(p)}static createTransform(p){return o.isSyncTransform(p)?(h,f)=>{let x=null;try{x=p(h)}catch(b){return f(b)}return f(null,x)}:(h,f)=>{p(h,f)}}set rowTransform(p){if(!c.default(p))throw new TypeError("The transform should be a function");this._rowTransform=d.createTransform(p)}format(p,h){this.callTransformer(p,(f,x)=>{if(f)return h(f);if(!p)return h(null);const b=[];if(x){const{shouldFormatColumns:v,headers:_}=this.checkHeaders(x);if(this.shouldWriteHeaders&&_&&!this.hasWrittenHeaders&&(b.push(this.formatColumns(_,!0)),this.hasWrittenHeaders=!0),v){const N=this.gatherColumns(x);b.push(this.formatColumns(N,!1))}}return h(null,b)})}finish(p){const h=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return p(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));h.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&h.push(this.formatterOptions.rowDelimiter),p(null,h)}checkHeaders(p){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const h=d.gatherHeaders(p);return this.headers=h,this.fieldFormatter.headers=h,this.shouldWriteHeaders?{shouldFormatColumns:!l.default(h,p),headers:h}:{shouldFormatColumns:!0,headers:null}}gatherColumns(p){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(p)?d.isRowHashArray(p)?this.headers.map((h,f)=>{const x=p[f];return x?x[1]:""}):d.isRowArray(p)&&!this.shouldWriteHeaders?p:this.headers.map((h,f)=>p[f]):this.headers.map(h=>p[h])}callTransformer(p,h){return this._rowTransform?this._rowTransform(p,h):h(null,p)}formatColumns(p,h){const f=p.map((b,v)=>this.fieldFormatter.format(b,v,h)).join(this.formatterOptions.delimiter),{rowCount:x}=this;return this.rowCount+=1,x?[this.formatterOptions.rowDelimiter,f].join(""):f}}n.RowFormatter=d},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldFormatter=n.RowFormatter=void 0;var i=e("./RowFormatter");Object.defineProperty(n,"RowFormatter",{enumerable:!0,get:function(){return i.RowFormatter}});var c=e("./FieldFormatter");Object.defineProperty(n,"FieldFormatter",{enumerable:!0,get:function(){return c.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(e,a,n){(function(i){(function(){var c=Object.create?function(v,_,N,E){E===void 0&&(E=N),Object.defineProperty(v,E,{enumerable:!0,get:function(){return _[N]}})}:function(v,_,N,E){E===void 0&&(E=N),v[E]=_[N]},l=Object.create?function(v,_){Object.defineProperty(v,"default",{enumerable:!0,value:_})}:function(v,_){v.default=_},u=function(v){if(v&&v.__esModule)return v;var _={};if(v!=null)for(var N in v)N!=="default"&&Object.prototype.hasOwnProperty.call(v,N)&&c(_,v,N);return l(_,v),_},o=function(v,_){for(var N in v)N==="default"||Object.prototype.hasOwnProperty.call(_,N)||c(_,v,N)};Object.defineProperty(n,"__esModule",{value:!0}),n.writeToPath=n.writeToString=n.writeToBuffer=n.writeToStream=n.write=n.format=n.FormatterOptions=n.CsvFormatterStream=void 0;const d=e("util"),g=e("stream"),p=u(e("fs")),h=e("./FormatterOptions"),f=e("./CsvFormatterStream");o(e("./types"),n);var x=e("./CsvFormatterStream");Object.defineProperty(n,"CsvFormatterStream",{enumerable:!0,get:function(){return x.CsvFormatterStream}});var b=e("./FormatterOptions");Object.defineProperty(n,"FormatterOptions",{enumerable:!0,get:function(){return b.FormatterOptions}}),n.format=v=>new f.CsvFormatterStream(new h.FormatterOptions(v)),n.write=(v,_)=>{const N=n.format(_),E=d.promisify((O,F)=>{N.write(O,void 0,F)});return v.reduce((O,F)=>O.then(()=>E(F)),Promise.resolve()).then(()=>N.end()).catch(O=>{N.emit("error",O)}),N},n.writeToStream=(v,_,N)=>n.write(_,N).pipe(v),n.writeToBuffer=function(v){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const N=[],E=new g.Writable({write(O,F,z){N.push(O),z()}});return new Promise((O,F)=>{E.on("error",F).on("finish",()=>O(i.concat(N))),n.write(v,_).pipe(E)})},n.writeToString=(v,_)=>n.writeToBuffer(v,_).then(N=>N.toString()),n.writeToPath=(v,_,N)=>{const E=p.createWriteStream(v,{encoding:"utf8"});return n.write(_,N).pipe(E)}}).call(this)}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSyncTransform=void 0,n.isSyncTransform=i=>i.length===1},{}],153:[function(e,a,n){(function(i){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.CsvParserStream=void 0;const c=e("string_decoder"),l=e("stream"),u=e("./transforms"),o=e("./parser");class d extends l.Transform{constructor(p){super({objectMode:p.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=p,this.parser=new o.Parser(p),this.headerTransformer=new u.HeaderTransformer(p),this.decoder=new c.StringDecoder(p.encoding),this.rowTransformerValidator=new u.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(p){return this.rowTransformerValidator.rowTransform=p,this}validate(p){return this.rowTransformerValidator.rowValidator=p,this}emit(p){if(p==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var h=arguments.length,f=new Array(h>1?h-1:0),x=1;x<h;x++)f[x-1]=arguments[x];return super.emit(p,...f)}_transform(p,h,f){if(this.hasHitRowLimit)return f();const x=d.wrapDoneCallback(f);try{const{lines:b}=this,v=b+this.decoder.write(p),_=this.parse(v,!0);return this.processRows(_,x)}catch(b){return x(b)}}_flush(p){const h=d.wrapDoneCallback(p);if(this.hasHitRowLimit)return h();try{const f=this.lines+this.decoder.end(),x=this.parse(f,!1);return this.processRows(x,h)}catch(f){return h(f)}}parse(p,h){if(!p)return[];const{line:f,rows:x}=this.parser.parse(p,h);return this.lines=f,x}processRows(p,h){const f=p.length,x=b=>{const v=E=>E?h(E):b%100!=0?x(b+1):void i(()=>x(b+1));if(this.checkAndEmitHeaders(),b>=f||this.hasHitRowLimit)return h();if(this.parsedLineCount+=1,this.shouldSkipLine)return v();const _=p[b];this.rowCount+=1,this.parsedRowCount+=1;const N=this.rowCount;return this.transformRow(_,(E,O)=>{if(E)return this.rowCount-=1,v(E);if(!O)return v(new Error("expected transform result"));if(O.isValid){if(O.row)return this.pushRow(O.row,v)}else this.emit("data-invalid",O.row,N,O.reason);return v()})};x(0)}transformRow(p,h){try{this.headerTransformer.transform(p,(f,x)=>f?h(f):x?x.isValid?x.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(x.row,h):this.skipRow(h):(this.rowCount-=1,this.parsedRowCount-=1,h(null,{row:null,isValid:!0})):this.shouldEmitRows?h(null,{isValid:!1,row:p}):this.skipRow(h):h(new Error("Expected result from header transform")))}catch(f){h(f)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(p){return this.rowCount-=1,p(null,{row:null,isValid:!0})}pushRow(p,h){try{this.parserOptions.objectMode?this.push(p):this.push(JSON.stringify(p)),h()}catch(f){h(f)}}static wrapDoneCallback(p){let h=!1;return function(f){if(f){if(h)throw f;return h=!0,void p(f)}for(var x=arguments.length,b=new Array(x>1?x-1:0),v=1;v<x;v++)b[v-1]=arguments[v];p(...b)}}}n.CsvParserStream=d}).call(this)}).call(this,e("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(e,a,n){var i=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(n,"__esModule",{value:!0}),n.ParserOptions=void 0;const c=i(e("lodash.escaperegexp")),l=i(e("lodash.isnil"));n.ParserOptions=class{constructor(u){var o;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,u||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=c.default(this.delimiter),this.escapeChar=(o=this.escape)!==null&&o!==void 0?o:this.quote,this.supportsComments=!l.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(e,a,n){var i=Object.create?function(x,b,v,_){_===void 0&&(_=v),Object.defineProperty(x,_,{enumerable:!0,get:function(){return b[v]}})}:function(x,b,v,_){_===void 0&&(_=v),x[_]=b[v]},c=Object.create?function(x,b){Object.defineProperty(x,"default",{enumerable:!0,value:b})}:function(x,b){x.default=b},l=function(x){if(x&&x.__esModule)return x;var b={};if(x!=null)for(var v in x)v!=="default"&&Object.prototype.hasOwnProperty.call(x,v)&&i(b,x,v);return c(b,x),b},u=function(x,b){for(var v in x)v==="default"||Object.prototype.hasOwnProperty.call(b,v)||i(b,x,v)};Object.defineProperty(n,"__esModule",{value:!0}),n.parseString=n.parseFile=n.parseStream=n.parse=n.ParserOptions=n.CsvParserStream=void 0;const o=l(e("fs")),d=e("stream"),g=e("./ParserOptions"),p=e("./CsvParserStream");u(e("./types"),n);var h=e("./CsvParserStream");Object.defineProperty(n,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var f=e("./ParserOptions");Object.defineProperty(n,"ParserOptions",{enumerable:!0,get:function(){return f.ParserOptions}}),n.parse=x=>new p.CsvParserStream(new g.ParserOptions(x)),n.parseStream=(x,b)=>x.pipe(new p.CsvParserStream(new g.ParserOptions(b))),n.parseFile=function(x){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return o.createReadStream(x).pipe(new p.CsvParserStream(new g.ParserOptions(b)))},n.parseString=(x,b)=>{const v=new d.Readable;return v.push(x),v.push(null),v.pipe(new p.CsvParserStream(new g.ParserOptions(b)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Parser=void 0;const i=e("./Scanner"),c=e("./RowParser"),l=e("./Token");class u{constructor(d){this.parserOptions=d,this.rowParser=new c.RowParser(this.parserOptions)}static removeBOM(d){return d&&d.charCodeAt(0)===65279?d.slice(1):d}parse(d,g){const p=new i.Scanner({line:u.removeBOM(d),parserOptions:this.parserOptions,hasMoreData:g});return this.parserOptions.supportsComments?this.parseWithComments(p):this.parseWithoutComments(p)}parseWithoutComments(d){const g=[];let p=!0;for(;p;)p=this.parseRow(d,g);return{line:d.line,rows:g}}parseWithComments(d){const{parserOptions:g}=this,p=[];for(let h=d.nextCharacterToken;h!==null;h=d.nextCharacterToken)if(l.Token.isTokenComment(h,g)){if(d.advancePastLine()===null)return{line:d.lineFromCursor,rows:p};if(!d.hasMoreCharacters)return{line:d.lineFromCursor,rows:p};d.truncateToCursor()}else if(!this.parseRow(d,p))break;return{line:d.line,rows:p}}parseRow(d,g){if(!d.nextNonSpaceToken)return!1;const p=this.rowParser.parse(d);return p!==null&&(this.parserOptions.ignoreEmpty&&c.RowParser.isEmptyRow(p)||g.push(p),!0)}}n.Parser=u},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RowParser=void 0;const i=e("./column"),c=e("./Token");n.RowParser=class{constructor(l){this.parserOptions=l,this.columnParser=new i.ColumnParser(l)}static isEmptyRow(l){return l.join("").replace(/\s+/g,"")===""}parse(l){const{parserOptions:u}=this,{hasMoreData:o}=l,d=l,g=[];let p=this.getStartToken(d,g);for(;p;){if(c.Token.isTokenRowDelimiter(p))return d.advancePastToken(p),!d.hasMoreCharacters&&c.Token.isTokenCarriageReturn(p,u)&&o?null:(d.truncateToCursor(),g);if(!this.shouldSkipColumnParse(d,p,g)){const h=this.columnParser.parse(d);if(h===null)return null;g.push(h)}p=d.nextNonSpaceToken}return o?null:(d.truncateToCursor(),g)}getStartToken(l,u){const o=l.nextNonSpaceToken;return o!==null&&c.Token.isTokenDelimiter(o,this.parserOptions)?(u.push(""),l.nextNonSpaceToken):o}shouldSkipColumnParse(l,u,o){const{parserOptions:d}=this;if(c.Token.isTokenDelimiter(u,d)){l.advancePastToken(u);const g=l.nextCharacterToken;if(!l.hasMoreCharacters||g!==null&&c.Token.isTokenRowDelimiter(g)||g!==null&&c.Token.isTokenDelimiter(g,d))return o.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Scanner=void 0;const i=e("./Token"),c=/((?:\r\n)|\n|\r)/;n.Scanner=class{constructor(l){this.cursor=0,this.line=l.line,this.lineLength=this.line.length,this.parserOptions=l.parserOptions,this.hasMoreData=l.hasMoreData,this.cursor=l.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:l}=this,u=this.parserOptions.NEXT_TOKEN_REGEXP;if(l.search(u)===-1)return null;const o=u.exec(l);if(o==null)return null;const d=o[1],g=this.cursor+(o.index||0);return new i.Token({token:d,startCursor:g,endCursor:g+d.length-1})}get nextCharacterToken(){const{cursor:l,lineLength:u}=this;return u<=l?null:new i.Token({token:this.line[l],startCursor:l,endCursor:l})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const l=c.exec(this.lineFromCursor);return l?(this.cursor+=(l.index||0)+l[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(l){return this.cursor=l,this}advanceToToken(l){return this.cursor=l.startCursor,this}advancePastToken(l){return this.cursor=l.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Token=void 0,n.Token=class{constructor(i){this.token=i.token,this.startCursor=i.startCursor,this.endCursor=i.endCursor}static isTokenRowDelimiter(i){const c=i.token;return c==="\r"||c===`
`||c===`\r
`}static isTokenCarriageReturn(i,c){return i.token===c.carriageReturn}static isTokenComment(i,c){return c.supportsComments&&!!i&&i.token===c.comment}static isTokenEscapeCharacter(i,c){return i.token===c.escapeChar}static isTokenQuote(i,c){return i.token===c.quote}static isTokenDelimiter(i,c){return i.token===c.delimiter}}},{}],160:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnFormatter=void 0,n.ColumnFormatter=class{constructor(i){i.trim?this.format=c=>c.trim():i.ltrim?this.format=c=>c.trimLeft():i.rtrim?this.format=c=>c.trimRight():this.format=c=>c}}},{}],161:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnParser=void 0;const i=e("./NonQuotedColumnParser"),c=e("./QuotedColumnParser"),l=e("../Token");n.ColumnParser=class{constructor(u){this.parserOptions=u,this.quotedColumnParser=new c.QuotedColumnParser(u),this.nonQuotedColumnParser=new i.NonQuotedColumnParser(u)}parse(u){const{nextNonSpaceToken:o}=u;return o!==null&&l.Token.isTokenQuote(o,this.parserOptions)?(u.advanceToToken(o),this.quotedColumnParser.parse(u)):this.nonQuotedColumnParser.parse(u)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NonQuotedColumnParser=void 0;const i=e("./ColumnFormatter"),c=e("../Token");n.NonQuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new i.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const{parserOptions:u}=this,o=[];let d=l.nextCharacterToken;for(;d&&!c.Token.isTokenDelimiter(d,u)&&!c.Token.isTokenRowDelimiter(d);d=l.nextCharacterToken)o.push(d.token),l.advancePastToken(d);return this.columnFormatter.format(o.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.QuotedColumnParser=void 0;const i=e("./ColumnFormatter"),c=e("../Token");n.QuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new i.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const u=l.cursor,{foundClosingQuote:o,col:d}=this.gatherDataBetweenQuotes(l);if(!o){if(l.advanceTo(u),!l.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${l.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(l),d}gatherDataBetweenQuotes(l){const{parserOptions:u}=this;let o=!1,d=!1;const g=[];let p=l.nextCharacterToken;for(;!d&&p!==null;p=l.nextCharacterToken){const h=c.Token.isTokenQuote(p,u);if(!o&&h)o=!0;else if(o)if(c.Token.isTokenEscapeCharacter(p,u)){l.advancePastToken(p);const f=l.nextCharacterToken;f!==null&&(c.Token.isTokenQuote(f,u)||c.Token.isTokenEscapeCharacter(f,u))?(g.push(f.token),p=f):h?d=!0:g.push(p.token)}else h?d=!0:g.push(p.token);l.advancePastToken(p)}return{col:this.columnFormatter.format(g.join("")),foundClosingQuote:d}}checkForMalformedColumn(l){const{parserOptions:u}=this,{nextNonSpaceToken:o}=l;if(o){const d=c.Token.isTokenDelimiter(o,u),g=c.Token.isTokenRowDelimiter(o);if(!d&&!g){const p=l.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${u.escapedDelimiter}' OR new line got: '${o.token}'. at '${p}`)}l.advanceToToken(o)}else l.hasMoreData||l.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnFormatter=n.QuotedColumnParser=n.NonQuotedColumnParser=n.ColumnParser=void 0;var i=e("./ColumnParser");Object.defineProperty(n,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}});var c=e("./NonQuotedColumnParser");Object.defineProperty(n,"NonQuotedColumnParser",{enumerable:!0,get:function(){return c.NonQuotedColumnParser}});var l=e("./QuotedColumnParser");Object.defineProperty(n,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}});var u=e("./ColumnFormatter");Object.defineProperty(n,"ColumnFormatter",{enumerable:!0,get:function(){return u.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.QuotedColumnParser=n.NonQuotedColumnParser=n.ColumnParser=n.Token=n.Scanner=n.RowParser=n.Parser=void 0;var i=e("./Parser");Object.defineProperty(n,"Parser",{enumerable:!0,get:function(){return i.Parser}});var c=e("./RowParser");Object.defineProperty(n,"RowParser",{enumerable:!0,get:function(){return c.RowParser}});var l=e("./Scanner");Object.defineProperty(n,"Scanner",{enumerable:!0,get:function(){return l.Scanner}});var u=e("./Token");Object.defineProperty(n,"Token",{enumerable:!0,get:function(){return u.Token}});var o=e("./column");Object.defineProperty(n,"ColumnParser",{enumerable:!0,get:function(){return o.ColumnParser}}),Object.defineProperty(n,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}}),Object.defineProperty(n,"QuotedColumnParser",{enumerable:!0,get:function(){return o.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(e,a,n){var i=function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(n,"__esModule",{value:!0}),n.HeaderTransformer=void 0;const c=i(e("lodash.isundefined")),l=i(e("lodash.isfunction")),u=i(e("lodash.uniq")),o=i(e("lodash.groupby"));n.HeaderTransformer=class{constructor(d){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=d,d.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(d.headers)?this.setHeaders(d.headers):l.default(d.headers)&&(this.headersTransform=d.headers)}transform(d,g){return this.shouldMapRow(d)?g(null,this.processRow(d)):g(null,{row:null,isValid:!0})}shouldMapRow(d){const{parserOptions:g}=this;if(!this.headersTransform&&g.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(d)){if(this.headersTransform)this.setHeaders(this.headersTransform(d));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(d)}return!1}return!0}processRow(d){if(!this.headers)return{row:d,isValid:!0};const{parserOptions:g}=this;if(!g.discardUnmappedColumns&&d.length>this.headersLength){if(!g.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${d.length}`);return{row:d,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${d.length}`}}return g.strictColumnHandling&&d.length<this.headersLength?{row:d,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${d.length}`}:{row:this.mapHeaders(d),isValid:!0}}mapHeaders(d){const g={},{headers:p,headersLength:h}=this;for(let f=0;f<h;f+=1){const x=p[f];if(!c.default(x)){const b=d[f];c.default(b)?g[x]="":g[x]=b}}return g}setHeaders(d){var g;const p=d.filter(h=>!!h);if(u.default(p).length!==p.length){const h=o.default(p),f=Object.keys(h).filter(x=>h[x].length>1);throw new Error("Duplicate headers found "+JSON.stringify(f))}this.headers=d,this.receivedHeaders=!0,this.headersLength=((g=this.headers)===null||g===void 0?void 0:g.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(e,a,n){var i=function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(n,"__esModule",{value:!0}),n.RowTransformerValidator=void 0;const c=i(e("lodash.isfunction")),l=e("../types");class u{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(d){return l.isSyncTransform(d)?(g,p)=>{let h=null;try{h=d(g)}catch(f){return p(f)}return p(null,h)}:d}static createValidator(d){return l.isSyncValidate(d)?(g,p)=>{p(null,{row:g,isValid:d(g)})}:(g,p)=>{d(g,(h,f,x)=>h?p(h):p(null,f?{row:g,isValid:f,reason:x}:{row:g,isValid:!1,reason:x}))}}set rowTransform(d){if(!c.default(d))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(d)}set rowValidator(d){if(!c.default(d))throw new TypeError("The validate should be a function");this._rowValidator=u.createValidator(d)}transformAndValidate(d,g){return this.callTransformer(d,(p,h)=>p?g(p):h?this.callValidator(h,(f,x)=>f?g(f):x&&!x.isValid?g(null,{row:h,isValid:!1,reason:x.reason}):g(null,{row:h,isValid:!0})):g(null,{row:null,isValid:!0}))}callTransformer(d,g){return this._rowTransform?this._rowTransform(d,g):g(null,d)}callValidator(d,g){return this._rowValidator?this._rowValidator(d,g):g(null,{row:d,isValid:!0})}}n.RowTransformerValidator=u},{"../types":169,"lodash.isfunction":446}],168:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.HeaderTransformer=n.RowTransformerValidator=void 0;var i=e("./RowTransformerValidator");Object.defineProperty(n,"RowTransformerValidator",{enumerable:!0,get:function(){return i.RowTransformerValidator}});var c=e("./HeaderTransformer");Object.defineProperty(n,"HeaderTransformer",{enumerable:!0,get:function(){return c.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSyncValidate=n.isSyncTransform=void 0,n.isSyncTransform=i=>i.length===1,n.isSyncValidate=i=>i.length===1},{}],170:[function(e,a,n){const i=n;i.bignum=e("bn.js"),i.define=e("./asn1/api").define,i.base=e("./asn1/base"),i.constants=e("./asn1/constants"),i.decoders=e("./asn1/decoders"),i.encoders=e("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(e,a,n){const i=e("./encoders"),c=e("./decoders"),l=e("inherits");function u(o,d){this.name=o,this.body=d,this.decoders={},this.encoders={}}n.define=function(o,d){return new u(o,d)},u.prototype._createNamed=function(o){const d=this.name;function g(p){this._initNamed(p,d)}return l(g,o),g.prototype._initNamed=function(p,h){o.call(this,p,h)},new g(this)},u.prototype._getDecoder=function(o){return o=o||"der",this.decoders.hasOwnProperty(o)||(this.decoders[o]=this._createNamed(c[o])),this.decoders[o]},u.prototype.decode=function(o,d,g){return this._getDecoder(d).decode(o,g)},u.prototype._getEncoder=function(o){return o=o||"der",this.encoders.hasOwnProperty(o)||(this.encoders[o]=this._createNamed(i[o])),this.encoders[o]},u.prototype.encode=function(o,d,g){return this._getEncoder(d).encode(o,g)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(e,a,n){const i=e("inherits"),c=e("../base/reporter").Reporter,l=e("safer-buffer").Buffer;function u(d,g){c.call(this,g),l.isBuffer(d)?(this.base=d,this.offset=0,this.length=d.length):this.error("Input not Buffer")}function o(d,g){if(Array.isArray(d))this.length=0,this.value=d.map(function(p){return o.isEncoderBuffer(p)||(p=new o(p,g)),this.length+=p.length,p},this);else if(typeof d=="number"){if(!(0<=d&&d<=255))return g.error("non-byte EncoderBuffer value");this.value=d,this.length=1}else if(typeof d=="string")this.value=d,this.length=l.byteLength(d);else{if(!l.isBuffer(d))return g.error("Unsupported type: "+typeof d);this.value=d,this.length=d.length}}i(u,c),n.DecoderBuffer=u,u.isDecoderBuffer=function(d){return d instanceof u?!0:typeof d=="object"&&l.isBuffer(d.base)&&d.constructor.name==="DecoderBuffer"&&typeof d.offset=="number"&&typeof d.length=="number"&&typeof d.save=="function"&&typeof d.restore=="function"&&typeof d.isEmpty=="function"&&typeof d.readUInt8=="function"&&typeof d.skip=="function"&&typeof d.raw=="function"},u.prototype.save=function(){return{offset:this.offset,reporter:c.prototype.save.call(this)}},u.prototype.restore=function(d){const g=new u(this.base);return g.offset=d.offset,g.length=this.offset,this.offset=d.offset,c.prototype.restore.call(this,d.reporter),g},u.prototype.isEmpty=function(){return this.offset===this.length},u.prototype.readUInt8=function(d){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(d||"DecoderBuffer overrun")},u.prototype.skip=function(d,g){if(!(this.offset+d<=this.length))return this.error(g||"DecoderBuffer overrun");const p=new u(this.base);return p._reporterState=this._reporterState,p.offset=this.offset,p.length=this.offset+d,this.offset+=d,p},u.prototype.raw=function(d){return this.base.slice(d?d.offset:this.offset,this.length)},n.EncoderBuffer=o,o.isEncoderBuffer=function(d){return d instanceof o?!0:typeof d=="object"&&d.constructor.name==="EncoderBuffer"&&typeof d.length=="number"&&typeof d.join=="function"},o.prototype.join=function(d,g){return d||(d=l.alloc(this.length)),g||(g=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(p){p.join(d,g),g+=p.length}):(typeof this.value=="number"?d[g]=this.value:typeof this.value=="string"?d.write(this.value,g):l.isBuffer(this.value)&&this.value.copy(d,g),g+=this.length)),d}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(e,a,n){const i=n;i.Reporter=e("./reporter").Reporter,i.DecoderBuffer=e("./buffer").DecoderBuffer,i.EncoderBuffer=e("./buffer").EncoderBuffer,i.Node=e("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(e,a,n){const i=e("../base/reporter").Reporter,c=e("../base/buffer").EncoderBuffer,l=e("../base/buffer").DecoderBuffer,u=e("minimalistic-assert"),o=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],d=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(o);function g(h,f,x){const b={};this._baseState=b,b.name=x,b.enc=h,b.parent=f||null,b.children=null,b.tag=null,b.args=null,b.reverseArgs=null,b.choice=null,b.optional=!1,b.any=!1,b.obj=!1,b.use=null,b.useDecoder=null,b.key=null,b.default=null,b.explicit=null,b.implicit=null,b.contains=null,b.parent||(b.children=[],this._wrap())}a.exports=g;const p=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];g.prototype.clone=function(){const h=this._baseState,f={};p.forEach(function(b){f[b]=h[b]});const x=new this.constructor(f.parent);return x._baseState=f,x},g.prototype._wrap=function(){const h=this._baseState;d.forEach(function(f){this[f]=function(){const x=new this.constructor(this);return h.children.push(x),x[f].apply(x,arguments)}},this)},g.prototype._init=function(h){const f=this._baseState;u(f.parent===null),h.call(this),f.children=f.children.filter(function(x){return x._baseState.parent===this},this),u.equal(f.children.length,1,"Root node can have only one child")},g.prototype._useArgs=function(h){const f=this._baseState,x=h.filter(function(b){return b instanceof this.constructor},this);h=h.filter(function(b){return!(b instanceof this.constructor)},this),x.length!==0&&(u(f.children===null),f.children=x,x.forEach(function(b){b._baseState.parent=this},this)),h.length!==0&&(u(f.args===null),f.args=h,f.reverseArgs=h.map(function(b){if(typeof b!="object"||b.constructor!==Object)return b;const v={};return Object.keys(b).forEach(function(_){_==(0|_)&&(_|=0);const N=b[_];v[N]=_}),v}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(h){g.prototype[h]=function(){const f=this._baseState;throw new Error(h+" not implemented for encoding: "+f.enc)}}),o.forEach(function(h){g.prototype[h]=function(){const f=this._baseState,x=Array.prototype.slice.call(arguments);return u(f.tag===null),f.tag=h,this._useArgs(x),this}}),g.prototype.use=function(h){u(h);const f=this._baseState;return u(f.use===null),f.use=h,this},g.prototype.optional=function(){return this._baseState.optional=!0,this},g.prototype.def=function(h){const f=this._baseState;return u(f.default===null),f.default=h,f.optional=!0,this},g.prototype.explicit=function(h){const f=this._baseState;return u(f.explicit===null&&f.implicit===null),f.explicit=h,this},g.prototype.implicit=function(h){const f=this._baseState;return u(f.explicit===null&&f.implicit===null),f.implicit=h,this},g.prototype.obj=function(){const h=this._baseState,f=Array.prototype.slice.call(arguments);return h.obj=!0,f.length!==0&&this._useArgs(f),this},g.prototype.key=function(h){const f=this._baseState;return u(f.key===null),f.key=h,this},g.prototype.any=function(){return this._baseState.any=!0,this},g.prototype.choice=function(h){const f=this._baseState;return u(f.choice===null),f.choice=h,this._useArgs(Object.keys(h).map(function(x){return h[x]})),this},g.prototype.contains=function(h){const f=this._baseState;return u(f.use===null),f.contains=h,this},g.prototype._decode=function(h,f){const x=this._baseState;if(x.parent===null)return h.wrapResult(x.children[0]._decode(h,f));let b,v=x.default,_=!0,N=null;if(x.key!==null&&(N=h.enterKey(x.key)),x.optional){let E=null;if(x.explicit!==null?E=x.explicit:x.implicit!==null?E=x.implicit:x.tag!==null&&(E=x.tag),E!==null||x.any){if(_=this._peekTag(h,E,x.any),h.isError(_))return _}else{const O=h.save();try{x.choice===null?this._decodeGeneric(x.tag,h,f):this._decodeChoice(h,f),_=!0}catch{_=!1}h.restore(O)}}if(x.obj&&_&&(b=h.enterObject()),_){if(x.explicit!==null){const O=this._decodeTag(h,x.explicit);if(h.isError(O))return O;h=O}const E=h.offset;if(x.use===null&&x.choice===null){let O;x.any&&(O=h.save());const F=this._decodeTag(h,x.implicit!==null?x.implicit:x.tag,x.any);if(h.isError(F))return F;x.any?v=h.raw(O):h=F}if(f&&f.track&&x.tag!==null&&f.track(h.path(),E,h.length,"tagged"),f&&f.track&&x.tag!==null&&f.track(h.path(),h.offset,h.length,"content"),x.any||(v=x.choice===null?this._decodeGeneric(x.tag,h,f):this._decodeChoice(h,f)),h.isError(v))return v;if(x.any||x.choice!==null||x.children===null||x.children.forEach(function(O){O._decode(h,f)}),x.contains&&(x.tag==="octstr"||x.tag==="bitstr")){const O=new l(v);v=this._getUse(x.contains,h._reporterState.obj)._decode(O,f)}}return x.obj&&_&&(v=h.leaveObject(b)),x.key===null||v===null&&_!==!0?N!==null&&h.exitKey(N):h.leaveKey(N,x.key,v),v},g.prototype._decodeGeneric=function(h,f,x){const b=this._baseState;return h==="seq"||h==="set"?null:h==="seqof"||h==="setof"?this._decodeList(f,h,b.args[0],x):/str$/.test(h)?this._decodeStr(f,h,x):h==="objid"&&b.args?this._decodeObjid(f,b.args[0],b.args[1],x):h==="objid"?this._decodeObjid(f,null,null,x):h==="gentime"||h==="utctime"?this._decodeTime(f,h,x):h==="null_"?this._decodeNull(f,x):h==="bool"?this._decodeBool(f,x):h==="objDesc"?this._decodeStr(f,h,x):h==="int"||h==="enum"?this._decodeInt(f,b.args&&b.args[0],x):b.use!==null?this._getUse(b.use,f._reporterState.obj)._decode(f,x):f.error("unknown tag: "+h)},g.prototype._getUse=function(h,f){const x=this._baseState;return x.useDecoder=this._use(h,f),u(x.useDecoder._baseState.parent===null),x.useDecoder=x.useDecoder._baseState.children[0],x.implicit!==x.useDecoder._baseState.implicit&&(x.useDecoder=x.useDecoder.clone(),x.useDecoder._baseState.implicit=x.implicit),x.useDecoder},g.prototype._decodeChoice=function(h,f){const x=this._baseState;let b=null,v=!1;return Object.keys(x.choice).some(function(_){const N=h.save(),E=x.choice[_];try{const O=E._decode(h,f);if(h.isError(O))return!1;b={type:_,value:O},v=!0}catch{return h.restore(N),!1}return!0},this),v?b:h.error("Choice not matched")},g.prototype._createEncoderBuffer=function(h){return new c(h,this.reporter)},g.prototype._encode=function(h,f,x){const b=this._baseState;if(b.default!==null&&b.default===h)return;const v=this._encodeValue(h,f,x);return v===void 0||this._skipDefault(v,f,x)?void 0:v},g.prototype._encodeValue=function(h,f,x){const b=this._baseState;if(b.parent===null)return b.children[0]._encode(h,f||new i);let v=null;if(this.reporter=f,b.optional&&h===void 0){if(b.default===null)return;h=b.default}let _=null,N=!1;if(b.any)v=this._createEncoderBuffer(h);else if(b.choice)v=this._encodeChoice(h,f);else if(b.contains)_=this._getUse(b.contains,x)._encode(h,f),N=!0;else if(b.children)_=b.children.map(function(E){if(E._baseState.tag==="null_")return E._encode(null,f,h);if(E._baseState.key===null)return f.error("Child should have a key");const O=f.enterKey(E._baseState.key);if(typeof h!="object")return f.error("Child expected, but input is not object");const F=E._encode(h[E._baseState.key],f,h);return f.leaveKey(O),F},this).filter(function(E){return E}),_=this._createEncoderBuffer(_);else if(b.tag==="seqof"||b.tag==="setof"){if(!b.args||b.args.length!==1)return f.error("Too many args for : "+b.tag);if(!Array.isArray(h))return f.error("seqof/setof, but data is not Array");const E=this.clone();E._baseState.implicit=null,_=this._createEncoderBuffer(h.map(function(O){const F=this._baseState;return this._getUse(F.args[0],h)._encode(O,f)},E))}else b.use!==null?v=this._getUse(b.use,x)._encode(h,f):(_=this._encodePrimitive(b.tag,h),N=!0);if(!b.any&&b.choice===null){const E=b.implicit!==null?b.implicit:b.tag,O=b.implicit===null?"universal":"context";E===null?b.use===null&&f.error("Tag could be omitted only for .use()"):b.use===null&&(v=this._encodeComposite(E,N,O,_))}return b.explicit!==null&&(v=this._encodeComposite(b.explicit,!1,"context",v)),v},g.prototype._encodeChoice=function(h,f){const x=this._baseState,b=x.choice[h.type];return b||u(!1,h.type+" not found in "+JSON.stringify(Object.keys(x.choice))),b._encode(h.value,f)},g.prototype._encodePrimitive=function(h,f){const x=this._baseState;if(/str$/.test(h))return this._encodeStr(f,h);if(h==="objid"&&x.args)return this._encodeObjid(f,x.reverseArgs[0],x.args[1]);if(h==="objid")return this._encodeObjid(f,null,null);if(h==="gentime"||h==="utctime")return this._encodeTime(f,h);if(h==="null_")return this._encodeNull();if(h==="int"||h==="enum")return this._encodeInt(f,x.args&&x.reverseArgs[0]);if(h==="bool")return this._encodeBool(f);if(h==="objDesc")return this._encodeStr(f,h);throw new Error("Unsupported tag: "+h)},g.prototype._isNumstr=function(h){return/^[0-9 ]*$/.test(h)},g.prototype._isPrintstr=function(h){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(h)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(e,a,n){const i=e("inherits");function c(u){this._reporterState={obj:null,path:[],options:u||{},errors:[]}}function l(u,o){this.path=u,this.rethrow(o)}n.Reporter=c,c.prototype.isError=function(u){return u instanceof l},c.prototype.save=function(){const u=this._reporterState;return{obj:u.obj,pathLen:u.path.length}},c.prototype.restore=function(u){const o=this._reporterState;o.obj=u.obj,o.path=o.path.slice(0,u.pathLen)},c.prototype.enterKey=function(u){return this._reporterState.path.push(u)},c.prototype.exitKey=function(u){const o=this._reporterState;o.path=o.path.slice(0,u-1)},c.prototype.leaveKey=function(u,o,d){const g=this._reporterState;this.exitKey(u),g.obj!==null&&(g.obj[o]=d)},c.prototype.path=function(){return this._reporterState.path.join("/")},c.prototype.enterObject=function(){const u=this._reporterState,o=u.obj;return u.obj={},o},c.prototype.leaveObject=function(u){const o=this._reporterState,d=o.obj;return o.obj=u,d},c.prototype.error=function(u){let o;const d=this._reporterState,g=u instanceof l;if(o=g?u:new l(d.path.map(function(p){return"["+JSON.stringify(p)+"]"}).join(""),u.message||u,u.stack),!d.options.partial)throw o;return g||d.errors.push(o),o},c.prototype.wrapResult=function(u){const o=this._reporterState;return o.options.partial?{result:this.isError(u)?null:u,errors:o.errors}:u},i(l,Error),l.prototype.rethrow=function(u){if(this.message=u+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,l),!this.stack)try{throw new Error(this.message)}catch(o){this.stack=o.stack}return this}},{inherits:440}],176:[function(e,a,n){function i(c){const l={};return Object.keys(c).forEach(function(u){(0|u)==u&&(u|=0);const o=c[u];l[o]=u}),l}n.tagClass={0:"universal",1:"application",2:"context",3:"private"},n.tagClassByName=i(n.tagClass),n.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},n.tagByName=i(n.tag)},{}],177:[function(e,a,n){const i=n;i._reverse=function(c){const l={};return Object.keys(c).forEach(function(u){(0|u)==u&&(u|=0);const o=c[u];l[o]=u}),l},i.der=e("./der")},{"./der":176}],178:[function(e,a,n){const i=e("inherits"),c=e("bn.js"),l=e("../base/buffer").DecoderBuffer,u=e("../base/node"),o=e("../constants/der");function d(f){this.enc="der",this.name=f.name,this.entity=f,this.tree=new g,this.tree._init(f.body)}function g(f){u.call(this,"der",f)}function p(f,x){let b=f.readUInt8(x);if(f.isError(b))return b;const v=o.tagClass[b>>6],_=(32&b)==0;if((31&b)==31){let N=b;for(b=0;(128&N)==128;){if(N=f.readUInt8(x),f.isError(N))return N;b<<=7,b|=127&N}}else b&=31;return{cls:v,primitive:_,tag:b,tagStr:o.tag[b]}}function h(f,x,b){let v=f.readUInt8(b);if(f.isError(v))return v;if(!x&&v===128)return null;if(!(128&v))return v;const _=127&v;if(_>4)return f.error("length octect is too long");v=0;for(let N=0;N<_;N++){v<<=8;const E=f.readUInt8(b);if(f.isError(E))return E;v|=E}return v}a.exports=d,d.prototype.decode=function(f,x){return l.isDecoderBuffer(f)||(f=new l(f,x)),this.tree._decode(f,x)},i(g,u),g.prototype._peekTag=function(f,x,b){if(f.isEmpty())return!1;const v=f.save(),_=p(f,'Failed to peek tag: "'+x+'"');return f.isError(_)?_:(f.restore(v),_.tag===x||_.tagStr===x||_.tagStr+"of"===x||b)},g.prototype._decodeTag=function(f,x,b){const v=p(f,'Failed to decode tag of "'+x+'"');if(f.isError(v))return v;let _=h(f,v.primitive,'Failed to get length of "'+x+'"');if(f.isError(_))return _;if(!b&&v.tag!==x&&v.tagStr!==x&&v.tagStr+"of"!==x)return f.error('Failed to match tag: "'+x+'"');if(v.primitive||_!==null)return f.skip(_,'Failed to match body of: "'+x+'"');const N=f.save(),E=this._skipUntilEnd(f,'Failed to skip indefinite length body: "'+this.tag+'"');return f.isError(E)?E:(_=f.offset-N.offset,f.restore(N),f.skip(_,'Failed to match body of: "'+x+'"'))},g.prototype._skipUntilEnd=function(f,x){for(;;){const b=p(f,x);if(f.isError(b))return b;const v=h(f,b.primitive,x);if(f.isError(v))return v;let _;if(_=b.primitive||v!==null?f.skip(v):this._skipUntilEnd(f,x),f.isError(_))return _;if(b.tagStr==="end")break}},g.prototype._decodeList=function(f,x,b,v){const _=[];for(;!f.isEmpty();){const N=this._peekTag(f,"end");if(f.isError(N))return N;const E=b.decode(f,"der",v);if(f.isError(E)&&N)break;_.push(E)}return _},g.prototype._decodeStr=function(f,x){if(x==="bitstr"){const b=f.readUInt8();return f.isError(b)?b:{unused:b,data:f.raw()}}if(x==="bmpstr"){const b=f.raw();if(b.length%2==1)return f.error("Decoding of string type: bmpstr length mismatch");let v="";for(let _=0;_<b.length/2;_++)v+=String.fromCharCode(b.readUInt16BE(2*_));return v}if(x==="numstr"){const b=f.raw().toString("ascii");return this._isNumstr(b)?b:f.error("Decoding of string type: numstr unsupported characters")}if(x==="octstr"||x==="objDesc")return f.raw();if(x==="printstr"){const b=f.raw().toString("ascii");return this._isPrintstr(b)?b:f.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(x)?f.raw().toString():f.error("Decoding of string type: "+x+" unsupported")},g.prototype._decodeObjid=function(f,x,b){let v;const _=[];let N=0,E=0;for(;!f.isEmpty();)E=f.readUInt8(),N<<=7,N|=127&E,!(128&E)&&(_.push(N),N=0);128&E&&_.push(N);const O=_[0]/40|0,F=_[0]%40;if(v=b?_:[O,F].concat(_.slice(1)),x){let z=x[v.join(" ")];z===void 0&&(z=x[v.join(".")]),z!==void 0&&(v=z)}return v},g.prototype._decodeTime=function(f,x){const b=f.raw().toString();let v,_,N,E,O,F;if(x==="gentime")v=0|b.slice(0,4),_=0|b.slice(4,6),N=0|b.slice(6,8),E=0|b.slice(8,10),O=0|b.slice(10,12),F=0|b.slice(12,14);else{if(x!=="utctime")return f.error("Decoding "+x+" time is not supported yet");v=0|b.slice(0,2),_=0|b.slice(2,4),N=0|b.slice(4,6),E=0|b.slice(6,8),O=0|b.slice(8,10),F=0|b.slice(10,12),v=v<70?2e3+v:1900+v}return Date.UTC(v,_-1,N,E,O,F,0)},g.prototype._decodeNull=function(){return null},g.prototype._decodeBool=function(f){const x=f.readUInt8();return f.isError(x)?x:x!==0},g.prototype._decodeInt=function(f,x){const b=f.raw();let v=new c(b);return x&&(v=x[v.toString(10)]||v),v},g.prototype._use=function(f,x){return typeof f=="function"&&(f=f(x)),f._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(e,a,n){const i=n;i.der=e("./der"),i.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,a,n){const i=e("inherits"),c=e("safer-buffer").Buffer,l=e("./der");function u(o){l.call(this,o),this.enc="pem"}i(u,l),a.exports=u,u.prototype.decode=function(o,d){const g=o.toString().split(/[\r\n]+/g),p=d.label.toUpperCase(),h=/^-----(BEGIN|END) ([^-]+)-----$/;let f=-1,x=-1;for(let _=0;_<g.length;_++){const N=g[_].match(h);if(N!==null&&N[2]===p){if(f!==-1){if(N[1]!=="END")break;x=_;break}if(N[1]!=="BEGIN")break;f=_}}if(f===-1||x===-1)throw new Error("PEM section not found for: "+p);const b=g.slice(f+1,x).join("");b.replace(/[^a-z0-9+/=]+/gi,"");const v=c.from(b,"base64");return l.prototype.decode.call(this,v,d)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(e,a,n){const i=e("inherits"),c=e("safer-buffer").Buffer,l=e("../base/node"),u=e("../constants/der");function o(p){this.enc="der",this.name=p.name,this.entity=p,this.tree=new d,this.tree._init(p.body)}function d(p){l.call(this,"der",p)}function g(p){return p<10?"0"+p:p}a.exports=o,o.prototype.encode=function(p,h){return this.tree._encode(p,h).join()},i(d,l),d.prototype._encodeComposite=function(p,h,f,x){const b=function(N,E,O,F){let z;if(N==="seqof"?N="seq":N==="setof"&&(N="set"),u.tagByName.hasOwnProperty(N))z=u.tagByName[N];else{if(typeof N!="number"||(0|N)!==N)return F.error("Unknown tag: "+N);z=N}return z>=31?F.error("Multi-octet tag encoding unsupported"):(E||(z|=32),z|=u.tagClassByName[O||"universal"]<<6,z)}(p,h,f,this.reporter);if(x.length<128){const N=c.alloc(2);return N[0]=b,N[1]=x.length,this._createEncoderBuffer([N,x])}let v=1;for(let N=x.length;N>=256;N>>=8)v++;const _=c.alloc(2+v);_[0]=b,_[1]=128|v;for(let N=1+v,E=x.length;E>0;N--,E>>=8)_[N]=255&E;return this._createEncoderBuffer([_,x])},d.prototype._encodeStr=function(p,h){if(h==="bitstr")return this._createEncoderBuffer([0|p.unused,p.data]);if(h==="bmpstr"){const f=c.alloc(2*p.length);for(let x=0;x<p.length;x++)f.writeUInt16BE(p.charCodeAt(x),2*x);return this._createEncoderBuffer(f)}return h==="numstr"?this._isNumstr(p)?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: numstr supports only digits and space"):h==="printstr"?this._isPrintstr(p)?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(h)||h==="objDesc"?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: "+h+" unsupported")},d.prototype._encodeObjid=function(p,h,f){if(typeof p=="string"){if(!h)return this.reporter.error("string objid given, but no values map found");if(!h.hasOwnProperty(p))return this.reporter.error("objid not found in values map");p=h[p].split(/[\s.]+/g);for(let _=0;_<p.length;_++)p[_]|=0}else if(Array.isArray(p)){p=p.slice();for(let _=0;_<p.length;_++)p[_]|=0}if(!Array.isArray(p))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(p));if(!f){if(p[1]>=40)return this.reporter.error("Second objid identifier OOB");p.splice(0,2,40*p[0]+p[1])}let x=0;for(let _=0;_<p.length;_++){let N=p[_];for(x++;N>=128;N>>=7)x++}const b=c.alloc(x);let v=b.length-1;for(let _=p.length-1;_>=0;_--){let N=p[_];for(b[v--]=127&N;(N>>=7)>0;)b[v--]=128|127&N}return this._createEncoderBuffer(b)},d.prototype._encodeTime=function(p,h){let f;const x=new Date(p);return h==="gentime"?f=[g(x.getUTCFullYear()),g(x.getUTCMonth()+1),g(x.getUTCDate()),g(x.getUTCHours()),g(x.getUTCMinutes()),g(x.getUTCSeconds()),"Z"].join(""):h==="utctime"?f=[g(x.getUTCFullYear()%100),g(x.getUTCMonth()+1),g(x.getUTCDate()),g(x.getUTCHours()),g(x.getUTCMinutes()),g(x.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+h+" time is not supported yet"),this._encodeStr(f,"octstr")},d.prototype._encodeNull=function(){return this._createEncoderBuffer("")},d.prototype._encodeInt=function(p,h){if(typeof p=="string"){if(!h)return this.reporter.error("String int or enum given, but no values map");if(!h.hasOwnProperty(p))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(p));p=h[p]}if(typeof p!="number"&&!c.isBuffer(p)){const b=p.toArray();!p.sign&&128&b[0]&&b.unshift(0),p=c.from(b)}if(c.isBuffer(p)){let b=p.length;p.length===0&&b++;const v=c.alloc(b);return p.copy(v),p.length===0&&(v[0]=0),this._createEncoderBuffer(v)}if(p<128)return this._createEncoderBuffer(p);if(p<256)return this._createEncoderBuffer([0,p]);let f=1;for(let b=p;b>=256;b>>=8)f++;const x=new Array(f);for(let b=x.length-1;b>=0;b--)x[b]=255&p,p>>=8;return 128&x[0]&&x.unshift(0),this._createEncoderBuffer(c.from(x))},d.prototype._encodeBool=function(p){return this._createEncoderBuffer(p?255:0)},d.prototype._use=function(p,h){return typeof p=="function"&&(p=p(h)),p._getEncoder("der").tree},d.prototype._skipDefault=function(p,h,f){const x=this._baseState;let b;if(x.default===null)return!1;const v=p.join();if(x.defaultBuffer===void 0&&(x.defaultBuffer=this._encodeValue(x.default,h,f).join()),v.length!==x.defaultBuffer.length)return!1;for(b=0;b<v.length;b++)if(v[b]!==x.defaultBuffer[b])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(e,a,n){const i=n;i.der=e("./der"),i.pem=e("./pem")},{"./der":181,"./pem":183}],183:[function(e,a,n){const i=e("inherits"),c=e("./der");function l(u){c.call(this,u),this.enc="pem"}i(l,c),a.exports=l,l.prototype.encode=function(u,o){const d=c.prototype.encode.call(this,u).toString("base64"),g=["-----BEGIN "+o.label+"-----"];for(let p=0;p<d.length;p+=64)g.push(d.slice(p,p+64));return g.push("-----END "+o.label+"-----"),g.join(`
`)}},{"./der":181,inherits:440}],184:[function(e,a,n){(function(i,c){function l(M,D){if(!M)throw new Error(D||"Assertion failed")}function u(M,D){M.super_=D;var T=function(){};T.prototype=D.prototype,M.prototype=new T,M.prototype.constructor=M}function o(M,D,T){if(o.isBN(M))return M;this.negative=0,this.words=null,this.length=0,this.red=null,M!==null&&(D!=="le"&&D!=="be"||(T=D,D=10),this._init(M||0,D||10,T||"be"))}var d;typeof i=="object"?i.exports=o:(void 0).BN=o,o.BN=o,o.wordSize=26;try{d=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function g(M,D){var T=M.charCodeAt(D);return T>=65&&T<=70?T-55:T>=97&&T<=102?T-87:T-48&15}function p(M,D,T){var C=g(M,T);return T-1>=D&&(C|=g(M,T-1)<<4),C}function h(M,D,T,C){for(var S=0,w=Math.min(M.length,T),j=D;j<w;j++){var A=M.charCodeAt(j)-48;S*=C,S+=A>=49?A-49+10:A>=17?A-17+10:A}return S}o.isBN=function(M){return M instanceof o||M!==null&&typeof M=="object"&&M.constructor.wordSize===o.wordSize&&Array.isArray(M.words)},o.max=function(M,D){return M.cmp(D)>0?M:D},o.min=function(M,D){return M.cmp(D)<0?M:D},o.prototype._init=function(M,D,T){if(typeof M=="number")return this._initNumber(M,D,T);if(typeof M=="object")return this._initArray(M,D,T);D==="hex"&&(D=16),l(D===(0|D)&&D>=2&&D<=36);var C=0;(M=M.toString().replace(/\s+/g,""))[0]==="-"&&(C++,this.negative=1),C<M.length&&(D===16?this._parseHex(M,C,T):(this._parseBase(M,D,C),T==="le"&&this._initArray(this.toArray(),D,T)))},o.prototype._initNumber=function(M,D,T){M<0&&(this.negative=1,M=-M),M<67108864?(this.words=[67108863&M],this.length=1):M<4503599627370496?(this.words=[67108863&M,M/67108864&67108863],this.length=2):(l(M<9007199254740992),this.words=[67108863&M,M/67108864&67108863,1],this.length=3),T==="le"&&this._initArray(this.toArray(),D,T)},o.prototype._initArray=function(M,D,T){if(l(typeof M.length=="number"),M.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(M.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var S,w,j=0;if(T==="be")for(C=M.length-1,S=0;C>=0;C-=3)w=M[C]|M[C-1]<<8|M[C-2]<<16,this.words[S]|=w<<j&67108863,this.words[S+1]=w>>>26-j&67108863,(j+=24)>=26&&(j-=26,S++);else if(T==="le")for(C=0,S=0;C<M.length;C+=3)w=M[C]|M[C+1]<<8|M[C+2]<<16,this.words[S]|=w<<j&67108863,this.words[S+1]=w>>>26-j&67108863,(j+=24)>=26&&(j-=26,S++);return this.strip()},o.prototype._parseHex=function(M,D,T){this.length=Math.ceil((M.length-D)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var S,w=0,j=0;if(T==="be")for(C=M.length-1;C>=D;C-=2)S=p(M,D,C)<<w,this.words[j]|=67108863&S,w>=18?(w-=18,j+=1,this.words[j]|=S>>>26):w+=8;else for(C=(M.length-D)%2==0?D+1:D;C<M.length;C+=2)S=p(M,D,C)<<w,this.words[j]|=67108863&S,w>=18?(w-=18,j+=1,this.words[j]|=S>>>26):w+=8;this.strip()},o.prototype._parseBase=function(M,D,T){this.words=[0],this.length=1;for(var C=0,S=1;S<=67108863;S*=D)C++;C--,S=S/D|0;for(var w=M.length-T,j=w%C,A=Math.min(w,w-j)+T,L=0,I=T;I<A;I+=C)L=h(M,I,I+C,D),this.imuln(S),this.words[0]+L<67108864?this.words[0]+=L:this._iaddn(L);if(j!==0){var Z=1;for(L=h(M,I,M.length,D),I=0;I<j;I++)Z*=D;this.imuln(Z),this.words[0]+L<67108864?this.words[0]+=L:this._iaddn(L)}this.strip()},o.prototype.copy=function(M){M.words=new Array(this.length);for(var D=0;D<this.length;D++)M.words[D]=this.words[D];M.length=this.length,M.negative=this.negative,M.red=this.red},o.prototype.clone=function(){var M=new o(null);return this.copy(M),M},o.prototype._expand=function(M){for(;this.length<M;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},o.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function v(M,D,T){T.negative=D.negative^M.negative;var C=M.length+D.length|0;T.length=C,C=C-1|0;var S=0|M.words[0],w=0|D.words[0],j=S*w,A=67108863&j,L=j/67108864|0;T.words[0]=A;for(var I=1;I<C;I++){for(var Z=L>>>26,K=67108863&L,re=Math.min(I,D.length-1),G=Math.max(0,I-M.length+1);G<=re;G++){var ae=I-G|0;Z+=(j=(S=0|M.words[ae])*(w=0|D.words[G])+K)/67108864|0,K=67108863&j}T.words[I]=0|K,L=0|Z}return L!==0?T.words[I]=0|L:T.length--,T.strip()}o.prototype.toString=function(M,D){var T;if(D=0|D||1,(M=M||10)===16||M==="hex"){T="";for(var C=0,S=0,w=0;w<this.length;w++){var j=this.words[w],A=(16777215&(j<<C|S)).toString(16);T=(S=j>>>24-C&16777215)!==0||w!==this.length-1?f[6-A.length]+A+T:A+T,(C+=2)>=26&&(C-=26,w--)}for(S!==0&&(T=S.toString(16)+T);T.length%D!=0;)T="0"+T;return this.negative!==0&&(T="-"+T),T}if(M===(0|M)&&M>=2&&M<=36){var L=x[M],I=b[M];T="";var Z=this.clone();for(Z.negative=0;!Z.isZero();){var K=Z.modn(I).toString(M);T=(Z=Z.idivn(I)).isZero()?K+T:f[L-K.length]+K+T}for(this.isZero()&&(T="0"+T);T.length%D!=0;)T="0"+T;return this.negative!==0&&(T="-"+T),T}l(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var M=this.words[0];return this.length===2?M+=67108864*this.words[1]:this.length===3&&this.words[2]===1?M+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-M:M},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(M,D){return l(d!==void 0),this.toArrayLike(d,M,D)},o.prototype.toArray=function(M,D){return this.toArrayLike(Array,M,D)},o.prototype.toArrayLike=function(M,D,T){var C=this.byteLength(),S=T||Math.max(1,C);l(C<=S,"byte array longer than desired length"),l(S>0,"Requested array length <= 0"),this.strip();var w,j,A=D==="le",L=new M(S),I=this.clone();if(A){for(j=0;!I.isZero();j++)w=I.andln(255),I.iushrn(8),L[j]=w;for(;j<S;j++)L[j]=0}else{for(j=0;j<S-C;j++)L[j]=0;for(j=0;!I.isZero();j++)w=I.andln(255),I.iushrn(8),L[S-j-1]=w}return L},Math.clz32?o.prototype._countBits=function(M){return 32-Math.clz32(M)}:o.prototype._countBits=function(M){var D=M,T=0;return D>=4096&&(T+=13,D>>>=13),D>=64&&(T+=7,D>>>=7),D>=8&&(T+=4,D>>>=4),D>=2&&(T+=2,D>>>=2),T+D},o.prototype._zeroBits=function(M){if(M===0)return 26;var D=M,T=0;return!(8191&D)&&(T+=13,D>>>=13),!(127&D)&&(T+=7,D>>>=7),!(15&D)&&(T+=4,D>>>=4),!(3&D)&&(T+=2,D>>>=2),!(1&D)&&T++,T},o.prototype.bitLength=function(){var M=this.words[this.length-1],D=this._countBits(M);return 26*(this.length-1)+D},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var M=0,D=0;D<this.length;D++){var T=this._zeroBits(this.words[D]);if(M+=T,T!==26)break}return M},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(M){return this.negative!==0?this.abs().inotn(M).iaddn(1):this.clone()},o.prototype.fromTwos=function(M){return this.testn(M-1)?this.notn(M).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return this.negative!==0},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(M){for(;this.length<M.length;)this.words[this.length++]=0;for(var D=0;D<M.length;D++)this.words[D]=this.words[D]|M.words[D];return this.strip()},o.prototype.ior=function(M){return l((this.negative|M.negative)==0),this.iuor(M)},o.prototype.or=function(M){return this.length>M.length?this.clone().ior(M):M.clone().ior(this)},o.prototype.uor=function(M){return this.length>M.length?this.clone().iuor(M):M.clone().iuor(this)},o.prototype.iuand=function(M){var D;D=this.length>M.length?M:this;for(var T=0;T<D.length;T++)this.words[T]=this.words[T]&M.words[T];return this.length=D.length,this.strip()},o.prototype.iand=function(M){return l((this.negative|M.negative)==0),this.iuand(M)},o.prototype.and=function(M){return this.length>M.length?this.clone().iand(M):M.clone().iand(this)},o.prototype.uand=function(M){return this.length>M.length?this.clone().iuand(M):M.clone().iuand(this)},o.prototype.iuxor=function(M){var D,T;this.length>M.length?(D=this,T=M):(D=M,T=this);for(var C=0;C<T.length;C++)this.words[C]=D.words[C]^T.words[C];if(this!==D)for(;C<D.length;C++)this.words[C]=D.words[C];return this.length=D.length,this.strip()},o.prototype.ixor=function(M){return l((this.negative|M.negative)==0),this.iuxor(M)},o.prototype.xor=function(M){return this.length>M.length?this.clone().ixor(M):M.clone().ixor(this)},o.prototype.uxor=function(M){return this.length>M.length?this.clone().iuxor(M):M.clone().iuxor(this)},o.prototype.inotn=function(M){l(typeof M=="number"&&M>=0);var D=0|Math.ceil(M/26),T=M%26;this._expand(D),T>0&&D--;for(var C=0;C<D;C++)this.words[C]=67108863&~this.words[C];return T>0&&(this.words[C]=~this.words[C]&67108863>>26-T),this.strip()},o.prototype.notn=function(M){return this.clone().inotn(M)},o.prototype.setn=function(M,D){l(typeof M=="number"&&M>=0);var T=M/26|0,C=M%26;return this._expand(T+1),this.words[T]=D?this.words[T]|1<<C:this.words[T]&~(1<<C),this.strip()},o.prototype.iadd=function(M){var D,T,C;if(this.negative!==0&&M.negative===0)return this.negative=0,D=this.isub(M),this.negative^=1,this._normSign();if(this.negative===0&&M.negative!==0)return M.negative=0,D=this.isub(M),M.negative=1,D._normSign();this.length>M.length?(T=this,C=M):(T=M,C=this);for(var S=0,w=0;w<C.length;w++)D=(0|T.words[w])+(0|C.words[w])+S,this.words[w]=67108863&D,S=D>>>26;for(;S!==0&&w<T.length;w++)D=(0|T.words[w])+S,this.words[w]=67108863&D,S=D>>>26;if(this.length=T.length,S!==0)this.words[this.length]=S,this.length++;else if(T!==this)for(;w<T.length;w++)this.words[w]=T.words[w];return this},o.prototype.add=function(M){var D;return M.negative!==0&&this.negative===0?(M.negative=0,D=this.sub(M),M.negative^=1,D):M.negative===0&&this.negative!==0?(this.negative=0,D=M.sub(this),this.negative=1,D):this.length>M.length?this.clone().iadd(M):M.clone().iadd(this)},o.prototype.isub=function(M){if(M.negative!==0){M.negative=0;var D=this.iadd(M);return M.negative=1,D._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(M),this.negative=1,this._normSign();var T,C,S=this.cmp(M);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;S>0?(T=this,C=M):(T=M,C=this);for(var w=0,j=0;j<C.length;j++)w=(D=(0|T.words[j])-(0|C.words[j])+w)>>26,this.words[j]=67108863&D;for(;w!==0&&j<T.length;j++)w=(D=(0|T.words[j])+w)>>26,this.words[j]=67108863&D;if(w===0&&j<T.length&&T!==this)for(;j<T.length;j++)this.words[j]=T.words[j];return this.length=Math.max(this.length,j),T!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(M){return this.clone().isub(M)};var _=function(M,D,T){var C,S,w,j=M.words,A=D.words,L=T.words,I=0,Z=0|j[0],K=8191&Z,re=Z>>>13,G=0|j[1],ae=8191&G,V=G>>>13,H=0|j[2],Q=8191&H,oe=H>>>13,se=0|j[3],le=8191&se,he=se>>>13,Ne=0|j[4],we=8191&Ne,ue=Ne>>>13,Se=0|j[5],ke=8191&Se,Me=Se>>>13,Oe=0|j[6],je=8191&Oe,Ie=Oe>>>13,Pe=0|j[7],He=8191&Pe,ct=Pe>>>13,ie=0|j[8],ee=8191&ie,te=ie>>>13,fe=0|j[9],_e=8191&fe,Te=fe>>>13,Ae=0|A[0],Fe=8191&Ae,st=Ae>>>13,it=0|A[1],lt=8191&it,yt=it>>>13,vt=0|A[2],Nt=8191&vt,Mt=vt>>>13,Et=0|A[3],_t=8191&Et,Tt=Et>>>13,ut=0|A[4],jt=8191&ut,Ke=ut>>>13,Vt=0|A[5],St=8191&Vt,et=Vt>>>13,ot=0|A[6],At=8191&ot,Re=ot>>>13,Ve=0|A[7],Qe=8191&Ve,de=Ve>>>13,be=0|A[8],me=8191&be,ge=be>>>13,ye=0|A[9],ve=8191&ye,Le=ye>>>13;T.negative=M.negative^D.negative,T.length=19;var qe=(I+(C=Math.imul(K,Fe))|0)+((8191&(S=(S=Math.imul(K,st))+Math.imul(re,Fe)|0))<<13)|0;I=((w=Math.imul(re,st))+(S>>>13)|0)+(qe>>>26)|0,qe&=67108863,C=Math.imul(ae,Fe),S=(S=Math.imul(ae,st))+Math.imul(V,Fe)|0,w=Math.imul(V,st);var Be=(I+(C=C+Math.imul(K,lt)|0)|0)+((8191&(S=(S=S+Math.imul(K,yt)|0)+Math.imul(re,lt)|0))<<13)|0;I=((w=w+Math.imul(re,yt)|0)+(S>>>13)|0)+(Be>>>26)|0,Be&=67108863,C=Math.imul(Q,Fe),S=(S=Math.imul(Q,st))+Math.imul(oe,Fe)|0,w=Math.imul(oe,st),C=C+Math.imul(ae,lt)|0,S=(S=S+Math.imul(ae,yt)|0)+Math.imul(V,lt)|0,w=w+Math.imul(V,yt)|0;var $e=(I+(C=C+Math.imul(K,Nt)|0)|0)+((8191&(S=(S=S+Math.imul(K,Mt)|0)+Math.imul(re,Nt)|0))<<13)|0;I=((w=w+Math.imul(re,Mt)|0)+(S>>>13)|0)+($e>>>26)|0,$e&=67108863,C=Math.imul(le,Fe),S=(S=Math.imul(le,st))+Math.imul(he,Fe)|0,w=Math.imul(he,st),C=C+Math.imul(Q,lt)|0,S=(S=S+Math.imul(Q,yt)|0)+Math.imul(oe,lt)|0,w=w+Math.imul(oe,yt)|0,C=C+Math.imul(ae,Nt)|0,S=(S=S+Math.imul(ae,Mt)|0)+Math.imul(V,Nt)|0,w=w+Math.imul(V,Mt)|0;var ze=(I+(C=C+Math.imul(K,_t)|0)|0)+((8191&(S=(S=S+Math.imul(K,Tt)|0)+Math.imul(re,_t)|0))<<13)|0;I=((w=w+Math.imul(re,Tt)|0)+(S>>>13)|0)+(ze>>>26)|0,ze&=67108863,C=Math.imul(we,Fe),S=(S=Math.imul(we,st))+Math.imul(ue,Fe)|0,w=Math.imul(ue,st),C=C+Math.imul(le,lt)|0,S=(S=S+Math.imul(le,yt)|0)+Math.imul(he,lt)|0,w=w+Math.imul(he,yt)|0,C=C+Math.imul(Q,Nt)|0,S=(S=S+Math.imul(Q,Mt)|0)+Math.imul(oe,Nt)|0,w=w+Math.imul(oe,Mt)|0,C=C+Math.imul(ae,_t)|0,S=(S=S+Math.imul(ae,Tt)|0)+Math.imul(V,_t)|0,w=w+Math.imul(V,Tt)|0;var nt=(I+(C=C+Math.imul(K,jt)|0)|0)+((8191&(S=(S=S+Math.imul(K,Ke)|0)+Math.imul(re,jt)|0))<<13)|0;I=((w=w+Math.imul(re,Ke)|0)+(S>>>13)|0)+(nt>>>26)|0,nt&=67108863,C=Math.imul(ke,Fe),S=(S=Math.imul(ke,st))+Math.imul(Me,Fe)|0,w=Math.imul(Me,st),C=C+Math.imul(we,lt)|0,S=(S=S+Math.imul(we,yt)|0)+Math.imul(ue,lt)|0,w=w+Math.imul(ue,yt)|0,C=C+Math.imul(le,Nt)|0,S=(S=S+Math.imul(le,Mt)|0)+Math.imul(he,Nt)|0,w=w+Math.imul(he,Mt)|0,C=C+Math.imul(Q,_t)|0,S=(S=S+Math.imul(Q,Tt)|0)+Math.imul(oe,_t)|0,w=w+Math.imul(oe,Tt)|0,C=C+Math.imul(ae,jt)|0,S=(S=S+Math.imul(ae,Ke)|0)+Math.imul(V,jt)|0,w=w+Math.imul(V,Ke)|0;var ht=(I+(C=C+Math.imul(K,St)|0)|0)+((8191&(S=(S=S+Math.imul(K,et)|0)+Math.imul(re,St)|0))<<13)|0;I=((w=w+Math.imul(re,et)|0)+(S>>>13)|0)+(ht>>>26)|0,ht&=67108863,C=Math.imul(je,Fe),S=(S=Math.imul(je,st))+Math.imul(Ie,Fe)|0,w=Math.imul(Ie,st),C=C+Math.imul(ke,lt)|0,S=(S=S+Math.imul(ke,yt)|0)+Math.imul(Me,lt)|0,w=w+Math.imul(Me,yt)|0,C=C+Math.imul(we,Nt)|0,S=(S=S+Math.imul(we,Mt)|0)+Math.imul(ue,Nt)|0,w=w+Math.imul(ue,Mt)|0,C=C+Math.imul(le,_t)|0,S=(S=S+Math.imul(le,Tt)|0)+Math.imul(he,_t)|0,w=w+Math.imul(he,Tt)|0,C=C+Math.imul(Q,jt)|0,S=(S=S+Math.imul(Q,Ke)|0)+Math.imul(oe,jt)|0,w=w+Math.imul(oe,Ke)|0,C=C+Math.imul(ae,St)|0,S=(S=S+Math.imul(ae,et)|0)+Math.imul(V,St)|0,w=w+Math.imul(V,et)|0;var xt=(I+(C=C+Math.imul(K,At)|0)|0)+((8191&(S=(S=S+Math.imul(K,Re)|0)+Math.imul(re,At)|0))<<13)|0;I=((w=w+Math.imul(re,Re)|0)+(S>>>13)|0)+(xt>>>26)|0,xt&=67108863,C=Math.imul(He,Fe),S=(S=Math.imul(He,st))+Math.imul(ct,Fe)|0,w=Math.imul(ct,st),C=C+Math.imul(je,lt)|0,S=(S=S+Math.imul(je,yt)|0)+Math.imul(Ie,lt)|0,w=w+Math.imul(Ie,yt)|0,C=C+Math.imul(ke,Nt)|0,S=(S=S+Math.imul(ke,Mt)|0)+Math.imul(Me,Nt)|0,w=w+Math.imul(Me,Mt)|0,C=C+Math.imul(we,_t)|0,S=(S=S+Math.imul(we,Tt)|0)+Math.imul(ue,_t)|0,w=w+Math.imul(ue,Tt)|0,C=C+Math.imul(le,jt)|0,S=(S=S+Math.imul(le,Ke)|0)+Math.imul(he,jt)|0,w=w+Math.imul(he,Ke)|0,C=C+Math.imul(Q,St)|0,S=(S=S+Math.imul(Q,et)|0)+Math.imul(oe,St)|0,w=w+Math.imul(oe,et)|0,C=C+Math.imul(ae,At)|0,S=(S=S+Math.imul(ae,Re)|0)+Math.imul(V,At)|0,w=w+Math.imul(V,Re)|0;var pe=(I+(C=C+Math.imul(K,Qe)|0)|0)+((8191&(S=(S=S+Math.imul(K,de)|0)+Math.imul(re,Qe)|0))<<13)|0;I=((w=w+Math.imul(re,de)|0)+(S>>>13)|0)+(pe>>>26)|0,pe&=67108863,C=Math.imul(ee,Fe),S=(S=Math.imul(ee,st))+Math.imul(te,Fe)|0,w=Math.imul(te,st),C=C+Math.imul(He,lt)|0,S=(S=S+Math.imul(He,yt)|0)+Math.imul(ct,lt)|0,w=w+Math.imul(ct,yt)|0,C=C+Math.imul(je,Nt)|0,S=(S=S+Math.imul(je,Mt)|0)+Math.imul(Ie,Nt)|0,w=w+Math.imul(Ie,Mt)|0,C=C+Math.imul(ke,_t)|0,S=(S=S+Math.imul(ke,Tt)|0)+Math.imul(Me,_t)|0,w=w+Math.imul(Me,Tt)|0,C=C+Math.imul(we,jt)|0,S=(S=S+Math.imul(we,Ke)|0)+Math.imul(ue,jt)|0,w=w+Math.imul(ue,Ke)|0,C=C+Math.imul(le,St)|0,S=(S=S+Math.imul(le,et)|0)+Math.imul(he,St)|0,w=w+Math.imul(he,et)|0,C=C+Math.imul(Q,At)|0,S=(S=S+Math.imul(Q,Re)|0)+Math.imul(oe,At)|0,w=w+Math.imul(oe,Re)|0,C=C+Math.imul(ae,Qe)|0,S=(S=S+Math.imul(ae,de)|0)+Math.imul(V,Qe)|0,w=w+Math.imul(V,de)|0;var Ce=(I+(C=C+Math.imul(K,me)|0)|0)+((8191&(S=(S=S+Math.imul(K,ge)|0)+Math.imul(re,me)|0))<<13)|0;I=((w=w+Math.imul(re,ge)|0)+(S>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,C=Math.imul(_e,Fe),S=(S=Math.imul(_e,st))+Math.imul(Te,Fe)|0,w=Math.imul(Te,st),C=C+Math.imul(ee,lt)|0,S=(S=S+Math.imul(ee,yt)|0)+Math.imul(te,lt)|0,w=w+Math.imul(te,yt)|0,C=C+Math.imul(He,Nt)|0,S=(S=S+Math.imul(He,Mt)|0)+Math.imul(ct,Nt)|0,w=w+Math.imul(ct,Mt)|0,C=C+Math.imul(je,_t)|0,S=(S=S+Math.imul(je,Tt)|0)+Math.imul(Ie,_t)|0,w=w+Math.imul(Ie,Tt)|0,C=C+Math.imul(ke,jt)|0,S=(S=S+Math.imul(ke,Ke)|0)+Math.imul(Me,jt)|0,w=w+Math.imul(Me,Ke)|0,C=C+Math.imul(we,St)|0,S=(S=S+Math.imul(we,et)|0)+Math.imul(ue,St)|0,w=w+Math.imul(ue,et)|0,C=C+Math.imul(le,At)|0,S=(S=S+Math.imul(le,Re)|0)+Math.imul(he,At)|0,w=w+Math.imul(he,Re)|0,C=C+Math.imul(Q,Qe)|0,S=(S=S+Math.imul(Q,de)|0)+Math.imul(oe,Qe)|0,w=w+Math.imul(oe,de)|0,C=C+Math.imul(ae,me)|0,S=(S=S+Math.imul(ae,ge)|0)+Math.imul(V,me)|0,w=w+Math.imul(V,ge)|0;var Ye=(I+(C=C+Math.imul(K,ve)|0)|0)+((8191&(S=(S=S+Math.imul(K,Le)|0)+Math.imul(re,ve)|0))<<13)|0;I=((w=w+Math.imul(re,Le)|0)+(S>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,C=Math.imul(_e,lt),S=(S=Math.imul(_e,yt))+Math.imul(Te,lt)|0,w=Math.imul(Te,yt),C=C+Math.imul(ee,Nt)|0,S=(S=S+Math.imul(ee,Mt)|0)+Math.imul(te,Nt)|0,w=w+Math.imul(te,Mt)|0,C=C+Math.imul(He,_t)|0,S=(S=S+Math.imul(He,Tt)|0)+Math.imul(ct,_t)|0,w=w+Math.imul(ct,Tt)|0,C=C+Math.imul(je,jt)|0,S=(S=S+Math.imul(je,Ke)|0)+Math.imul(Ie,jt)|0,w=w+Math.imul(Ie,Ke)|0,C=C+Math.imul(ke,St)|0,S=(S=S+Math.imul(ke,et)|0)+Math.imul(Me,St)|0,w=w+Math.imul(Me,et)|0,C=C+Math.imul(we,At)|0,S=(S=S+Math.imul(we,Re)|0)+Math.imul(ue,At)|0,w=w+Math.imul(ue,Re)|0,C=C+Math.imul(le,Qe)|0,S=(S=S+Math.imul(le,de)|0)+Math.imul(he,Qe)|0,w=w+Math.imul(he,de)|0,C=C+Math.imul(Q,me)|0,S=(S=S+Math.imul(Q,ge)|0)+Math.imul(oe,me)|0,w=w+Math.imul(oe,ge)|0;var tt=(I+(C=C+Math.imul(ae,ve)|0)|0)+((8191&(S=(S=S+Math.imul(ae,Le)|0)+Math.imul(V,ve)|0))<<13)|0;I=((w=w+Math.imul(V,Le)|0)+(S>>>13)|0)+(tt>>>26)|0,tt&=67108863,C=Math.imul(_e,Nt),S=(S=Math.imul(_e,Mt))+Math.imul(Te,Nt)|0,w=Math.imul(Te,Mt),C=C+Math.imul(ee,_t)|0,S=(S=S+Math.imul(ee,Tt)|0)+Math.imul(te,_t)|0,w=w+Math.imul(te,Tt)|0,C=C+Math.imul(He,jt)|0,S=(S=S+Math.imul(He,Ke)|0)+Math.imul(ct,jt)|0,w=w+Math.imul(ct,Ke)|0,C=C+Math.imul(je,St)|0,S=(S=S+Math.imul(je,et)|0)+Math.imul(Ie,St)|0,w=w+Math.imul(Ie,et)|0,C=C+Math.imul(ke,At)|0,S=(S=S+Math.imul(ke,Re)|0)+Math.imul(Me,At)|0,w=w+Math.imul(Me,Re)|0,C=C+Math.imul(we,Qe)|0,S=(S=S+Math.imul(we,de)|0)+Math.imul(ue,Qe)|0,w=w+Math.imul(ue,de)|0,C=C+Math.imul(le,me)|0,S=(S=S+Math.imul(le,ge)|0)+Math.imul(he,me)|0,w=w+Math.imul(he,ge)|0;var gt=(I+(C=C+Math.imul(Q,ve)|0)|0)+((8191&(S=(S=S+Math.imul(Q,Le)|0)+Math.imul(oe,ve)|0))<<13)|0;I=((w=w+Math.imul(oe,Le)|0)+(S>>>13)|0)+(gt>>>26)|0,gt&=67108863,C=Math.imul(_e,_t),S=(S=Math.imul(_e,Tt))+Math.imul(Te,_t)|0,w=Math.imul(Te,Tt),C=C+Math.imul(ee,jt)|0,S=(S=S+Math.imul(ee,Ke)|0)+Math.imul(te,jt)|0,w=w+Math.imul(te,Ke)|0,C=C+Math.imul(He,St)|0,S=(S=S+Math.imul(He,et)|0)+Math.imul(ct,St)|0,w=w+Math.imul(ct,et)|0,C=C+Math.imul(je,At)|0,S=(S=S+Math.imul(je,Re)|0)+Math.imul(Ie,At)|0,w=w+Math.imul(Ie,Re)|0,C=C+Math.imul(ke,Qe)|0,S=(S=S+Math.imul(ke,de)|0)+Math.imul(Me,Qe)|0,w=w+Math.imul(Me,de)|0,C=C+Math.imul(we,me)|0,S=(S=S+Math.imul(we,ge)|0)+Math.imul(ue,me)|0,w=w+Math.imul(ue,ge)|0;var ft=(I+(C=C+Math.imul(le,ve)|0)|0)+((8191&(S=(S=S+Math.imul(le,Le)|0)+Math.imul(he,ve)|0))<<13)|0;I=((w=w+Math.imul(he,Le)|0)+(S>>>13)|0)+(ft>>>26)|0,ft&=67108863,C=Math.imul(_e,jt),S=(S=Math.imul(_e,Ke))+Math.imul(Te,jt)|0,w=Math.imul(Te,Ke),C=C+Math.imul(ee,St)|0,S=(S=S+Math.imul(ee,et)|0)+Math.imul(te,St)|0,w=w+Math.imul(te,et)|0,C=C+Math.imul(He,At)|0,S=(S=S+Math.imul(He,Re)|0)+Math.imul(ct,At)|0,w=w+Math.imul(ct,Re)|0,C=C+Math.imul(je,Qe)|0,S=(S=S+Math.imul(je,de)|0)+Math.imul(Ie,Qe)|0,w=w+Math.imul(Ie,de)|0,C=C+Math.imul(ke,me)|0,S=(S=S+Math.imul(ke,ge)|0)+Math.imul(Me,me)|0,w=w+Math.imul(Me,ge)|0;var pt=(I+(C=C+Math.imul(we,ve)|0)|0)+((8191&(S=(S=S+Math.imul(we,Le)|0)+Math.imul(ue,ve)|0))<<13)|0;I=((w=w+Math.imul(ue,Le)|0)+(S>>>13)|0)+(pt>>>26)|0,pt&=67108863,C=Math.imul(_e,St),S=(S=Math.imul(_e,et))+Math.imul(Te,St)|0,w=Math.imul(Te,et),C=C+Math.imul(ee,At)|0,S=(S=S+Math.imul(ee,Re)|0)+Math.imul(te,At)|0,w=w+Math.imul(te,Re)|0,C=C+Math.imul(He,Qe)|0,S=(S=S+Math.imul(He,de)|0)+Math.imul(ct,Qe)|0,w=w+Math.imul(ct,de)|0,C=C+Math.imul(je,me)|0,S=(S=S+Math.imul(je,ge)|0)+Math.imul(Ie,me)|0,w=w+Math.imul(Ie,ge)|0;var Yt=(I+(C=C+Math.imul(ke,ve)|0)|0)+((8191&(S=(S=S+Math.imul(ke,Le)|0)+Math.imul(Me,ve)|0))<<13)|0;I=((w=w+Math.imul(Me,Le)|0)+(S>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,C=Math.imul(_e,At),S=(S=Math.imul(_e,Re))+Math.imul(Te,At)|0,w=Math.imul(Te,Re),C=C+Math.imul(ee,Qe)|0,S=(S=S+Math.imul(ee,de)|0)+Math.imul(te,Qe)|0,w=w+Math.imul(te,de)|0,C=C+Math.imul(He,me)|0,S=(S=S+Math.imul(He,ge)|0)+Math.imul(ct,me)|0,w=w+Math.imul(ct,ge)|0;var Dt=(I+(C=C+Math.imul(je,ve)|0)|0)+((8191&(S=(S=S+Math.imul(je,Le)|0)+Math.imul(Ie,ve)|0))<<13)|0;I=((w=w+Math.imul(Ie,Le)|0)+(S>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,C=Math.imul(_e,Qe),S=(S=Math.imul(_e,de))+Math.imul(Te,Qe)|0,w=Math.imul(Te,de),C=C+Math.imul(ee,me)|0,S=(S=S+Math.imul(ee,ge)|0)+Math.imul(te,me)|0,w=w+Math.imul(te,ge)|0;var Ut=(I+(C=C+Math.imul(He,ve)|0)|0)+((8191&(S=(S=S+Math.imul(He,Le)|0)+Math.imul(ct,ve)|0))<<13)|0;I=((w=w+Math.imul(ct,Le)|0)+(S>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,C=Math.imul(_e,me),S=(S=Math.imul(_e,ge))+Math.imul(Te,me)|0,w=Math.imul(Te,ge);var Ot=(I+(C=C+Math.imul(ee,ve)|0)|0)+((8191&(S=(S=S+Math.imul(ee,Le)|0)+Math.imul(te,ve)|0))<<13)|0;I=((w=w+Math.imul(te,Le)|0)+(S>>>13)|0)+(Ot>>>26)|0,Ot&=67108863;var Gt=(I+(C=Math.imul(_e,ve))|0)+((8191&(S=(S=Math.imul(_e,Le))+Math.imul(Te,ve)|0))<<13)|0;return I=((w=Math.imul(Te,Le))+(S>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,L[0]=qe,L[1]=Be,L[2]=$e,L[3]=ze,L[4]=nt,L[5]=ht,L[6]=xt,L[7]=pe,L[8]=Ce,L[9]=Ye,L[10]=tt,L[11]=gt,L[12]=ft,L[13]=pt,L[14]=Yt,L[15]=Dt,L[16]=Ut,L[17]=Ot,L[18]=Gt,I!==0&&(L[19]=I,T.length++),T};function N(M,D,T){return new E().mulp(M,D,T)}function E(M,D){this.x=M,this.y=D}Math.imul||(_=v),o.prototype.mulTo=function(M,D){var T=this.length+M.length;return this.length===10&&M.length===10?_(this,M,D):T<63?v(this,M,D):T<1024?function(C,S,w){w.negative=S.negative^C.negative,w.length=C.length+S.length;for(var j=0,A=0,L=0;L<w.length-1;L++){var I=A;A=0;for(var Z=67108863&j,K=Math.min(L,S.length-1),re=Math.max(0,L-C.length+1);re<=K;re++){var G=L-re,ae=(0|C.words[G])*(0|S.words[re]),V=67108863&ae;Z=67108863&(V=V+Z|0),A+=(I=(I=I+(ae/67108864|0)|0)+(V>>>26)|0)>>>26,I&=67108863}w.words[L]=Z,j=I,I=A}return j!==0?w.words[L]=j:w.length--,w.strip()}(this,M,D):N(this,M,D)},E.prototype.makeRBT=function(M){for(var D=new Array(M),T=o.prototype._countBits(M)-1,C=0;C<M;C++)D[C]=this.revBin(C,T,M);return D},E.prototype.revBin=function(M,D,T){if(M===0||M===T-1)return M;for(var C=0,S=0;S<D;S++)C|=(1&M)<<D-S-1,M>>=1;return C},E.prototype.permute=function(M,D,T,C,S,w){for(var j=0;j<w;j++)C[j]=D[M[j]],S[j]=T[M[j]]},E.prototype.transform=function(M,D,T,C,S,w){this.permute(w,M,D,T,C,S);for(var j=1;j<S;j<<=1)for(var A=j<<1,L=Math.cos(2*Math.PI/A),I=Math.sin(2*Math.PI/A),Z=0;Z<S;Z+=A)for(var K=L,re=I,G=0;G<j;G++){var ae=T[Z+G],V=C[Z+G],H=T[Z+G+j],Q=C[Z+G+j],oe=K*H-re*Q;Q=K*Q+re*H,H=oe,T[Z+G]=ae+H,C[Z+G]=V+Q,T[Z+G+j]=ae-H,C[Z+G+j]=V-Q,G!==A&&(oe=L*K-I*re,re=L*re+I*K,K=oe)}},E.prototype.guessLen13b=function(M,D){var T=1|Math.max(D,M),C=1&T,S=0;for(T=T/2|0;T;T>>>=1)S++;return 1<<S+1+C},E.prototype.conjugate=function(M,D,T){if(!(T<=1))for(var C=0;C<T/2;C++){var S=M[C];M[C]=M[T-C-1],M[T-C-1]=S,S=D[C],D[C]=-D[T-C-1],D[T-C-1]=-S}},E.prototype.normalize13b=function(M,D){for(var T=0,C=0;C<D/2;C++){var S=8192*Math.round(M[2*C+1]/D)+Math.round(M[2*C]/D)+T;M[C]=67108863&S,T=S<67108864?0:S/67108864|0}return M},E.prototype.convert13b=function(M,D,T,C){for(var S=0,w=0;w<D;w++)S+=0|M[w],T[2*w]=8191&S,S>>>=13,T[2*w+1]=8191&S,S>>>=13;for(w=2*D;w<C;++w)T[w]=0;l(S===0),l((-8192&S)==0)},E.prototype.stub=function(M){for(var D=new Array(M),T=0;T<M;T++)D[T]=0;return D},E.prototype.mulp=function(M,D,T){var C=2*this.guessLen13b(M.length,D.length),S=this.makeRBT(C),w=this.stub(C),j=new Array(C),A=new Array(C),L=new Array(C),I=new Array(C),Z=new Array(C),K=new Array(C),re=T.words;re.length=C,this.convert13b(M.words,M.length,j,C),this.convert13b(D.words,D.length,I,C),this.transform(j,w,A,L,C,S),this.transform(I,w,Z,K,C,S);for(var G=0;G<C;G++){var ae=A[G]*Z[G]-L[G]*K[G];L[G]=A[G]*K[G]+L[G]*Z[G],A[G]=ae}return this.conjugate(A,L,C),this.transform(A,L,re,w,C,S),this.conjugate(re,w,C),this.normalize13b(re,C),T.negative=M.negative^D.negative,T.length=M.length+D.length,T.strip()},o.prototype.mul=function(M){var D=new o(null);return D.words=new Array(this.length+M.length),this.mulTo(M,D)},o.prototype.mulf=function(M){var D=new o(null);return D.words=new Array(this.length+M.length),N(this,M,D)},o.prototype.imul=function(M){return this.clone().mulTo(M,this)},o.prototype.imuln=function(M){l(typeof M=="number"),l(M<67108864);for(var D=0,T=0;T<this.length;T++){var C=(0|this.words[T])*M,S=(67108863&C)+(67108863&D);D>>=26,D+=C/67108864|0,D+=S>>>26,this.words[T]=67108863&S}return D!==0&&(this.words[T]=D,this.length++),this},o.prototype.muln=function(M){return this.clone().imuln(M)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(M){var D=function(w){for(var j=new Array(w.bitLength()),A=0;A<j.length;A++){var L=A/26|0,I=A%26;j[A]=(w.words[L]&1<<I)>>>I}return j}(M);if(D.length===0)return new o(1);for(var T=this,C=0;C<D.length&&D[C]===0;C++,T=T.sqr());if(++C<D.length)for(var S=T.sqr();C<D.length;C++,S=S.sqr())D[C]!==0&&(T=T.mul(S));return T},o.prototype.iushln=function(M){l(typeof M=="number"&&M>=0);var D,T=M%26,C=(M-T)/26,S=67108863>>>26-T<<26-T;if(T!==0){var w=0;for(D=0;D<this.length;D++){var j=this.words[D]&S,A=(0|this.words[D])-j<<T;this.words[D]=A|w,w=j>>>26-T}w&&(this.words[D]=w,this.length++)}if(C!==0){for(D=this.length-1;D>=0;D--)this.words[D+C]=this.words[D];for(D=0;D<C;D++)this.words[D]=0;this.length+=C}return this.strip()},o.prototype.ishln=function(M){return l(this.negative===0),this.iushln(M)},o.prototype.iushrn=function(M,D,T){var C;l(typeof M=="number"&&M>=0),C=D?(D-D%26)/26:0;var S=M%26,w=Math.min((M-S)/26,this.length),j=67108863^67108863>>>S<<S,A=T;if(C-=w,C=Math.max(0,C),A){for(var L=0;L<w;L++)A.words[L]=this.words[L];A.length=w}if(w!==0)if(this.length>w)for(this.length-=w,L=0;L<this.length;L++)this.words[L]=this.words[L+w];else this.words[0]=0,this.length=1;var I=0;for(L=this.length-1;L>=0&&(I!==0||L>=C);L--){var Z=0|this.words[L];this.words[L]=I<<26-S|Z>>>S,I=Z&j}return A&&I!==0&&(A.words[A.length++]=I),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(M,D,T){return l(this.negative===0),this.iushrn(M,D,T)},o.prototype.shln=function(M){return this.clone().ishln(M)},o.prototype.ushln=function(M){return this.clone().iushln(M)},o.prototype.shrn=function(M){return this.clone().ishrn(M)},o.prototype.ushrn=function(M){return this.clone().iushrn(M)},o.prototype.testn=function(M){l(typeof M=="number"&&M>=0);var D=M%26,T=(M-D)/26,C=1<<D;return!(this.length<=T)&&!!(this.words[T]&C)},o.prototype.imaskn=function(M){l(typeof M=="number"&&M>=0);var D=M%26,T=(M-D)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=T)return this;if(D!==0&&T++,this.length=Math.min(T,this.length),D!==0){var C=67108863^67108863>>>D<<D;this.words[this.length-1]&=C}return this.strip()},o.prototype.maskn=function(M){return this.clone().imaskn(M)},o.prototype.iaddn=function(M){return l(typeof M=="number"),l(M<67108864),M<0?this.isubn(-M):this.negative!==0?this.length===1&&(0|this.words[0])<M?(this.words[0]=M-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(M),this.negative=1,this):this._iaddn(M)},o.prototype._iaddn=function(M){this.words[0]+=M;for(var D=0;D<this.length&&this.words[D]>=67108864;D++)this.words[D]-=67108864,D===this.length-1?this.words[D+1]=1:this.words[D+1]++;return this.length=Math.max(this.length,D+1),this},o.prototype.isubn=function(M){if(l(typeof M=="number"),l(M<67108864),M<0)return this.iaddn(-M);if(this.negative!==0)return this.negative=0,this.iaddn(M),this.negative=1,this;if(this.words[0]-=M,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var D=0;D<this.length&&this.words[D]<0;D++)this.words[D]+=67108864,this.words[D+1]-=1;return this.strip()},o.prototype.addn=function(M){return this.clone().iaddn(M)},o.prototype.subn=function(M){return this.clone().isubn(M)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(M,D,T){var C,S,w=M.length+T;this._expand(w);var j=0;for(C=0;C<M.length;C++){S=(0|this.words[C+T])+j;var A=(0|M.words[C])*D;j=((S-=67108863&A)>>26)-(A/67108864|0),this.words[C+T]=67108863&S}for(;C<this.length-T;C++)j=(S=(0|this.words[C+T])+j)>>26,this.words[C+T]=67108863&S;if(j===0)return this.strip();for(l(j===-1),j=0,C=0;C<this.length;C++)j=(S=-(0|this.words[C])+j)>>26,this.words[C]=67108863&S;return this.negative=1,this.strip()},o.prototype._wordDiv=function(M,D){var T=(this.length,M.length),C=this.clone(),S=M,w=0|S.words[S.length-1];(T=26-this._countBits(w))!==0&&(S=S.ushln(T),C.iushln(T),w=0|S.words[S.length-1]);var j,A=C.length-S.length;if(D!=="mod"){(j=new o(null)).length=A+1,j.words=new Array(j.length);for(var L=0;L<j.length;L++)j.words[L]=0}var I=C.clone()._ishlnsubmul(S,1,A);I.negative===0&&(C=I,j&&(j.words[A]=1));for(var Z=A-1;Z>=0;Z--){var K=67108864*(0|C.words[S.length+Z])+(0|C.words[S.length+Z-1]);for(K=Math.min(K/w|0,67108863),C._ishlnsubmul(S,K,Z);C.negative!==0;)K--,C.negative=0,C._ishlnsubmul(S,1,Z),C.isZero()||(C.negative^=1);j&&(j.words[Z]=K)}return j&&j.strip(),C.strip(),D!=="div"&&T!==0&&C.iushrn(T),{div:j||null,mod:C}},o.prototype.divmod=function(M,D,T){return l(!M.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:this.negative!==0&&M.negative===0?(w=this.neg().divmod(M,D),D!=="mod"&&(C=w.div.neg()),D!=="div"&&(S=w.mod.neg(),T&&S.negative!==0&&S.iadd(M)),{div:C,mod:S}):this.negative===0&&M.negative!==0?(w=this.divmod(M.neg(),D),D!=="mod"&&(C=w.div.neg()),{div:C,mod:w.mod}):this.negative&M.negative?(w=this.neg().divmod(M.neg(),D),D!=="div"&&(S=w.mod.neg(),T&&S.negative!==0&&S.isub(M)),{div:w.div,mod:S}):M.length>this.length||this.cmp(M)<0?{div:new o(0),mod:this}:M.length===1?D==="div"?{div:this.divn(M.words[0]),mod:null}:D==="mod"?{div:null,mod:new o(this.modn(M.words[0]))}:{div:this.divn(M.words[0]),mod:new o(this.modn(M.words[0]))}:this._wordDiv(M,D);var C,S,w},o.prototype.div=function(M){return this.divmod(M,"div",!1).div},o.prototype.mod=function(M){return this.divmod(M,"mod",!1).mod},o.prototype.umod=function(M){return this.divmod(M,"mod",!0).mod},o.prototype.divRound=function(M){var D=this.divmod(M);if(D.mod.isZero())return D.div;var T=D.div.negative!==0?D.mod.isub(M):D.mod,C=M.ushrn(1),S=M.andln(1),w=T.cmp(C);return w<0||S===1&&w===0?D.div:D.div.negative!==0?D.div.isubn(1):D.div.iaddn(1)},o.prototype.modn=function(M){l(M<=67108863);for(var D=(1<<26)%M,T=0,C=this.length-1;C>=0;C--)T=(D*T+(0|this.words[C]))%M;return T},o.prototype.idivn=function(M){l(M<=67108863);for(var D=0,T=this.length-1;T>=0;T--){var C=(0|this.words[T])+67108864*D;this.words[T]=C/M|0,D=C%M}return this.strip()},o.prototype.divn=function(M){return this.clone().idivn(M)},o.prototype.egcd=function(M){l(M.negative===0),l(!M.isZero());var D=this,T=M.clone();D=D.negative!==0?D.umod(M):D.clone();for(var C=new o(1),S=new o(0),w=new o(0),j=new o(1),A=0;D.isEven()&&T.isEven();)D.iushrn(1),T.iushrn(1),++A;for(var L=T.clone(),I=D.clone();!D.isZero();){for(var Z=0,K=1;!(D.words[0]&K)&&Z<26;++Z,K<<=1);if(Z>0)for(D.iushrn(Z);Z-- >0;)(C.isOdd()||S.isOdd())&&(C.iadd(L),S.isub(I)),C.iushrn(1),S.iushrn(1);for(var re=0,G=1;!(T.words[0]&G)&&re<26;++re,G<<=1);if(re>0)for(T.iushrn(re);re-- >0;)(w.isOdd()||j.isOdd())&&(w.iadd(L),j.isub(I)),w.iushrn(1),j.iushrn(1);D.cmp(T)>=0?(D.isub(T),C.isub(w),S.isub(j)):(T.isub(D),w.isub(C),j.isub(S))}return{a:w,b:j,gcd:T.iushln(A)}},o.prototype._invmp=function(M){l(M.negative===0),l(!M.isZero());var D=this,T=M.clone();D=D.negative!==0?D.umod(M):D.clone();for(var C,S=new o(1),w=new o(0),j=T.clone();D.cmpn(1)>0&&T.cmpn(1)>0;){for(var A=0,L=1;!(D.words[0]&L)&&A<26;++A,L<<=1);if(A>0)for(D.iushrn(A);A-- >0;)S.isOdd()&&S.iadd(j),S.iushrn(1);for(var I=0,Z=1;!(T.words[0]&Z)&&I<26;++I,Z<<=1);if(I>0)for(T.iushrn(I);I-- >0;)w.isOdd()&&w.iadd(j),w.iushrn(1);D.cmp(T)>=0?(D.isub(T),S.isub(w)):(T.isub(D),w.isub(S))}return(C=D.cmpn(1)===0?S:w).cmpn(0)<0&&C.iadd(M),C},o.prototype.gcd=function(M){if(this.isZero())return M.abs();if(M.isZero())return this.abs();var D=this.clone(),T=M.clone();D.negative=0,T.negative=0;for(var C=0;D.isEven()&&T.isEven();C++)D.iushrn(1),T.iushrn(1);for(;;){for(;D.isEven();)D.iushrn(1);for(;T.isEven();)T.iushrn(1);var S=D.cmp(T);if(S<0){var w=D;D=T,T=w}else if(S===0||T.cmpn(1)===0)break;D.isub(T)}return T.iushln(C)},o.prototype.invm=function(M){return this.egcd(M).a.umod(M)},o.prototype.isEven=function(){return(1&this.words[0])==0},o.prototype.isOdd=function(){return(1&this.words[0])==1},o.prototype.andln=function(M){return this.words[0]&M},o.prototype.bincn=function(M){l(typeof M=="number");var D=M%26,T=(M-D)/26,C=1<<D;if(this.length<=T)return this._expand(T+1),this.words[T]|=C,this;for(var S=C,w=T;S!==0&&w<this.length;w++){var j=0|this.words[w];S=(j+=S)>>>26,j&=67108863,this.words[w]=j}return S!==0&&(this.words[w]=S,this.length++),this},o.prototype.isZero=function(){return this.length===1&&this.words[0]===0},o.prototype.cmpn=function(M){var D,T=M<0;if(this.negative!==0&&!T)return-1;if(this.negative===0&&T)return 1;if(this.strip(),this.length>1)D=1;else{T&&(M=-M),l(M<=67108863,"Number is too big");var C=0|this.words[0];D=C===M?0:C<M?-1:1}return this.negative!==0?0|-D:D},o.prototype.cmp=function(M){if(this.negative!==0&&M.negative===0)return-1;if(this.negative===0&&M.negative!==0)return 1;var D=this.ucmp(M);return this.negative!==0?0|-D:D},o.prototype.ucmp=function(M){if(this.length>M.length)return 1;if(this.length<M.length)return-1;for(var D=0,T=this.length-1;T>=0;T--){var C=0|this.words[T],S=0|M.words[T];if(C!==S){C<S?D=-1:C>S&&(D=1);break}}return D},o.prototype.gtn=function(M){return this.cmpn(M)===1},o.prototype.gt=function(M){return this.cmp(M)===1},o.prototype.gten=function(M){return this.cmpn(M)>=0},o.prototype.gte=function(M){return this.cmp(M)>=0},o.prototype.ltn=function(M){return this.cmpn(M)===-1},o.prototype.lt=function(M){return this.cmp(M)===-1},o.prototype.lten=function(M){return this.cmpn(M)<=0},o.prototype.lte=function(M){return this.cmp(M)<=0},o.prototype.eqn=function(M){return this.cmpn(M)===0},o.prototype.eq=function(M){return this.cmp(M)===0},o.red=function(M){return new Y(M)},o.prototype.toRed=function(M){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),M.convertTo(this)._forceRed(M)},o.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(M){return this.red=M,this},o.prototype.forceRed=function(M){return l(!this.red,"Already a number in reduction context"),this._forceRed(M)},o.prototype.redAdd=function(M){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,M)},o.prototype.redIAdd=function(M){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,M)},o.prototype.redSub=function(M){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,M)},o.prototype.redISub=function(M){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,M)},o.prototype.redShl=function(M){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,M)},o.prototype.redMul=function(M){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,M),this.red.mul(this,M)},o.prototype.redIMul=function(M){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,M),this.red.imul(this,M)},o.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(M){return l(this.red&&!M.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,M)};var O={k256:null,p224:null,p192:null,p25519:null};function F(M,D){this.name=M,this.p=new o(D,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function z(){F.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P(){F.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function U(){F.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function W(){F.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Y(M){if(typeof M=="string"){var D=o._prime(M);this.m=D.p,this.prime=D}else l(M.gtn(1),"modulus must be greater than 1"),this.m=M,this.prime=null}function q(M){Y.call(this,M),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}F.prototype._tmp=function(){var M=new o(null);return M.words=new Array(Math.ceil(this.n/13)),M},F.prototype.ireduce=function(M){var D,T=M;do this.split(T,this.tmp),D=(T=(T=this.imulK(T)).iadd(this.tmp)).bitLength();while(D>this.n);var C=D<this.n?-1:T.ucmp(this.p);return C===0?(T.words[0]=0,T.length=1):C>0?T.isub(this.p):T.strip!==void 0?T.strip():T._strip(),T},F.prototype.split=function(M,D){M.iushrn(this.n,0,D)},F.prototype.imulK=function(M){return M.imul(this.k)},u(z,F),z.prototype.split=function(M,D){for(var T=Math.min(M.length,9),C=0;C<T;C++)D.words[C]=M.words[C];if(D.length=T,M.length<=9)return M.words[0]=0,void(M.length=1);var S=M.words[9];for(D.words[D.length++]=4194303&S,C=10;C<M.length;C++){var w=0|M.words[C];M.words[C-10]=(4194303&w)<<4|S>>>22,S=w}S>>>=22,M.words[C-10]=S,S===0&&M.length>10?M.length-=10:M.length-=9},z.prototype.imulK=function(M){M.words[M.length]=0,M.words[M.length+1]=0,M.length+=2;for(var D=0,T=0;T<M.length;T++){var C=0|M.words[T];D+=977*C,M.words[T]=67108863&D,D=64*C+(D/67108864|0)}return M.words[M.length-1]===0&&(M.length--,M.words[M.length-1]===0&&M.length--),M},u(P,F),u(U,F),u(W,F),W.prototype.imulK=function(M){for(var D=0,T=0;T<M.length;T++){var C=19*(0|M.words[T])+D,S=67108863&C;C>>>=26,M.words[T]=S,D=C}return D!==0&&(M.words[M.length++]=D),M},o._prime=function(M){if(O[M])return O[M];var D;if(M==="k256")D=new z;else if(M==="p224")D=new P;else if(M==="p192")D=new U;else{if(M!=="p25519")throw new Error("Unknown prime "+M);D=new W}return O[M]=D,D},Y.prototype._verify1=function(M){l(M.negative===0,"red works only with positives"),l(M.red,"red works only with red numbers")},Y.prototype._verify2=function(M,D){l((M.negative|D.negative)==0,"red works only with positives"),l(M.red&&M.red===D.red,"red works only with red numbers")},Y.prototype.imod=function(M){return this.prime?this.prime.ireduce(M)._forceRed(this):M.umod(this.m)._forceRed(this)},Y.prototype.neg=function(M){return M.isZero()?M.clone():this.m.sub(M)._forceRed(this)},Y.prototype.add=function(M,D){this._verify2(M,D);var T=M.add(D);return T.cmp(this.m)>=0&&T.isub(this.m),T._forceRed(this)},Y.prototype.iadd=function(M,D){this._verify2(M,D);var T=M.iadd(D);return T.cmp(this.m)>=0&&T.isub(this.m),T},Y.prototype.sub=function(M,D){this._verify2(M,D);var T=M.sub(D);return T.cmpn(0)<0&&T.iadd(this.m),T._forceRed(this)},Y.prototype.isub=function(M,D){this._verify2(M,D);var T=M.isub(D);return T.cmpn(0)<0&&T.iadd(this.m),T},Y.prototype.shl=function(M,D){return this._verify1(M),this.imod(M.ushln(D))},Y.prototype.imul=function(M,D){return this._verify2(M,D),this.imod(M.imul(D))},Y.prototype.mul=function(M,D){return this._verify2(M,D),this.imod(M.mul(D))},Y.prototype.isqr=function(M){return this.imul(M,M.clone())},Y.prototype.sqr=function(M){return this.mul(M,M)},Y.prototype.sqrt=function(M){if(M.isZero())return M.clone();var D=this.m.andln(3);if(l(D%2==1),D===3){var T=this.m.add(new o(1)).iushrn(2);return this.pow(M,T)}for(var C=this.m.subn(1),S=0;!C.isZero()&&C.andln(1)===0;)S++,C.iushrn(1);l(!C.isZero());var w=new o(1).toRed(this),j=w.redNeg(),A=this.m.subn(1).iushrn(1),L=this.m.bitLength();for(L=new o(2*L*L).toRed(this);this.pow(L,A).cmp(j)!==0;)L.redIAdd(j);for(var I=this.pow(L,C),Z=this.pow(M,C.addn(1).iushrn(1)),K=this.pow(M,C),re=S;K.cmp(w)!==0;){for(var G=K,ae=0;G.cmp(w)!==0;ae++)G=G.redSqr();l(ae<re);var V=this.pow(I,new o(1).iushln(re-ae-1));Z=Z.redMul(V),I=V.redSqr(),K=K.redMul(I),re=ae}return Z},Y.prototype.invm=function(M){var D=M._invmp(this.m);return D.negative!==0?(D.negative=0,this.imod(D).redNeg()):this.imod(D)},Y.prototype.pow=function(M,D){if(D.isZero())return new o(1).toRed(this);if(D.cmpn(1)===0)return M.clone();var T=new Array(16);T[0]=new o(1).toRed(this),T[1]=M;for(var C=2;C<T.length;C++)T[C]=this.mul(T[C-1],M);var S=T[0],w=0,j=0,A=D.bitLength()%26;for(A===0&&(A=26),C=D.length-1;C>=0;C--){for(var L=D.words[C],I=A-1;I>=0;I--){var Z=L>>I&1;S!==T[0]&&(S=this.sqr(S)),Z!==0||w!==0?(w<<=1,w|=Z,(++j===4||C===0&&I===0)&&(S=this.mul(S,T[w]),j=0,w=0)):j=0}A=26}return S},Y.prototype.convertTo=function(M){var D=M.umod(this.m);return D===M?D.clone():D},Y.prototype.convertFrom=function(M){var D=M.clone();return D.red=null,D},o.mont=function(M){return new q(M)},u(q,Y),q.prototype.convertTo=function(M){return this.imod(M.ushln(this.shift))},q.prototype.convertFrom=function(M){var D=this.imod(M.mul(this.rinv));return D.red=null,D},q.prototype.imul=function(M,D){if(M.isZero()||D.isZero())return M.words[0]=0,M.length=1,M;var T=M.imul(D),C=T.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=T.isub(C).iushrn(this.shift),w=S;return S.cmp(this.m)>=0?w=S.isub(this.m):S.cmpn(0)<0&&(w=S.iadd(this.m)),w._forceRed(this)},q.prototype.mul=function(M,D){if(M.isZero()||D.isZero())return new o(0)._forceRed(this);var T=M.mul(D),C=T.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=T.isub(C).iushrn(this.shift),w=S;return S.cmp(this.m)>=0?w=S.isub(this.m):S.cmpn(0)<0&&(w=S.iadd(this.m)),w._forceRed(this)},q.prototype.invm=function(M){return this.imod(M._invmp(this.m).mul(this.r2))._forceRed(this)}})(a===void 0||a)},{buffer:188}],185:[function(e,a,n){n.byteLength=function(h){var f=g(h),x=f[0],b=f[1];return 3*(x+b)/4-b},n.toByteArray=function(h){var f,x,b=g(h),v=b[0],_=b[1],N=new l(function(F,z,P){return 3*(z+P)/4-P}(0,v,_)),E=0,O=_>0?v-4:v;for(x=0;x<O;x+=4)f=c[h.charCodeAt(x)]<<18|c[h.charCodeAt(x+1)]<<12|c[h.charCodeAt(x+2)]<<6|c[h.charCodeAt(x+3)],N[E++]=f>>16&255,N[E++]=f>>8&255,N[E++]=255&f;return _===2&&(f=c[h.charCodeAt(x)]<<2|c[h.charCodeAt(x+1)]>>4,N[E++]=255&f),_===1&&(f=c[h.charCodeAt(x)]<<10|c[h.charCodeAt(x+1)]<<4|c[h.charCodeAt(x+2)]>>2,N[E++]=f>>8&255,N[E++]=255&f),N},n.fromByteArray=function(h){for(var f,x=h.length,b=x%3,v=[],_=0,N=x-b;_<N;_+=16383)v.push(p(h,_,_+16383>N?N:_+16383));return b===1?(f=h[x-1],v.push(i[f>>2]+i[f<<4&63]+"==")):b===2&&(f=(h[x-2]<<8)+h[x-1],v.push(i[f>>10]+i[f>>4&63]+i[f<<2&63]+"=")),v.join("")};for(var i=[],c=[],l=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,d=u.length;o<d;++o)i[o]=u[o],c[u.charCodeAt(o)]=o;function g(h){var f=h.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=h.indexOf("=");return x===-1&&(x=f),[x,x===f?0:4-x%4]}function p(h,f,x){for(var b,v,_=[],N=f;N<x;N+=3)b=(h[N]<<16&16711680)+(h[N+1]<<8&65280)+(255&h[N+2]),_.push(i[(v=b)>>18&63]+i[v>>12&63]+i[v>>6&63]+i[63&v]);return _.join("")}c[45]=62,c[95]=63},{}],186:[function(e,a,n){(function(i,c){function l(T,C){if(!T)throw new Error(C||"Assertion failed")}function u(T,C){T.super_=C;var S=function(){};S.prototype=C.prototype,T.prototype=new S,T.prototype.constructor=T}function o(T,C,S){if(o.isBN(T))return T;this.negative=0,this.words=null,this.length=0,this.red=null,T!==null&&(C!=="le"&&C!=="be"||(S=C,C=10),this._init(T||0,C||10,S||"be"))}var d;typeof i=="object"?i.exports=o:(void 0).BN=o,o.BN=o,o.wordSize=26;try{d=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function g(T,C){var S=T.charCodeAt(C);return S>=48&&S<=57?S-48:S>=65&&S<=70?S-55:S>=97&&S<=102?S-87:void l(!1,"Invalid character in "+T)}function p(T,C,S){var w=g(T,S);return S-1>=C&&(w|=g(T,S-1)<<4),w}function h(T,C,S,w){for(var j=0,A=0,L=Math.min(T.length,S),I=C;I<L;I++){var Z=T.charCodeAt(I)-48;j*=w,A=Z>=49?Z-49+10:Z>=17?Z-17+10:Z,l(Z>=0&&A<w,"Invalid character"),j+=A}return j}function f(T,C){T.words=C.words,T.length=C.length,T.negative=C.negative,T.red=C.red}if(o.isBN=function(T){return T instanceof o||T!==null&&typeof T=="object"&&T.constructor.wordSize===o.wordSize&&Array.isArray(T.words)},o.max=function(T,C){return T.cmp(C)>0?T:C},o.min=function(T,C){return T.cmp(C)<0?T:C},o.prototype._init=function(T,C,S){if(typeof T=="number")return this._initNumber(T,C,S);if(typeof T=="object")return this._initArray(T,C,S);C==="hex"&&(C=16),l(C===(0|C)&&C>=2&&C<=36);var w=0;(T=T.toString().replace(/\s+/g,""))[0]==="-"&&(w++,this.negative=1),w<T.length&&(C===16?this._parseHex(T,w,S):(this._parseBase(T,C,w),S==="le"&&this._initArray(this.toArray(),C,S)))},o.prototype._initNumber=function(T,C,S){T<0&&(this.negative=1,T=-T),T<67108864?(this.words=[67108863&T],this.length=1):T<4503599627370496?(this.words=[67108863&T,T/67108864&67108863],this.length=2):(l(T<9007199254740992),this.words=[67108863&T,T/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),C,S)},o.prototype._initArray=function(T,C,S){if(l(typeof T.length=="number"),T.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(T.length/3),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var j,A,L=0;if(S==="be")for(w=T.length-1,j=0;w>=0;w-=3)A=T[w]|T[w-1]<<8|T[w-2]<<16,this.words[j]|=A<<L&67108863,this.words[j+1]=A>>>26-L&67108863,(L+=24)>=26&&(L-=26,j++);else if(S==="le")for(w=0,j=0;w<T.length;w+=3)A=T[w]|T[w+1]<<8|T[w+2]<<16,this.words[j]|=A<<L&67108863,this.words[j+1]=A>>>26-L&67108863,(L+=24)>=26&&(L-=26,j++);return this._strip()},o.prototype._parseHex=function(T,C,S){this.length=Math.ceil((T.length-C)/6),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var j,A=0,L=0;if(S==="be")for(w=T.length-1;w>=C;w-=2)j=p(T,C,w)<<A,this.words[L]|=67108863&j,A>=18?(A-=18,L+=1,this.words[L]|=j>>>26):A+=8;else for(w=(T.length-C)%2==0?C+1:C;w<T.length;w+=2)j=p(T,C,w)<<A,this.words[L]|=67108863&j,A>=18?(A-=18,L+=1,this.words[L]|=j>>>26):A+=8;this._strip()},o.prototype._parseBase=function(T,C,S){this.words=[0],this.length=1;for(var w=0,j=1;j<=67108863;j*=C)w++;w--,j=j/C|0;for(var A=T.length-S,L=A%w,I=Math.min(A,A-L)+S,Z=0,K=S;K<I;K+=w)Z=h(T,K,K+w,C),this.imuln(j),this.words[0]+Z<67108864?this.words[0]+=Z:this._iaddn(Z);if(L!==0){var re=1;for(Z=h(T,K,T.length,C),K=0;K<L;K++)re*=C;this.imuln(re),this.words[0]+Z<67108864?this.words[0]+=Z:this._iaddn(Z)}this._strip()},o.prototype.copy=function(T){T.words=new Array(this.length);for(var C=0;C<this.length;C++)T.words[C]=this.words[C];T.length=this.length,T.negative=this.negative,T.red=this.red},o.prototype._move=function(T){f(T,this)},o.prototype.clone=function(){var T=new o(null);return this.copy(T),T},o.prototype._expand=function(T){for(;this.length<T;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},o.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=x}catch{o.prototype.inspect=x}else o.prototype.inspect=x;function x(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var b=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],_=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function(T,C){var S;if(C=0|C||1,(T=T||10)===16||T==="hex"){S="";for(var w=0,j=0,A=0;A<this.length;A++){var L=this.words[A],I=(16777215&(L<<w|j)).toString(16);j=L>>>24-w&16777215,(w+=2)>=26&&(w-=26,A--),S=j!==0||A!==this.length-1?b[6-I.length]+I+S:I+S}for(j!==0&&(S=j.toString(16)+S);S.length%C!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(T===(0|T)&&T>=2&&T<=36){var Z=v[T],K=_[T];S="";var re=this.clone();for(re.negative=0;!re.isZero();){var G=re.modrn(K).toString(T);S=(re=re.idivn(K)).isZero()?G+S:b[Z-G.length]+G+S}for(this.isZero()&&(S="0"+S);S.length%C!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}l(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var T=this.words[0];return this.length===2?T+=67108864*this.words[1]:this.length===3&&this.words[2]===1?T+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-T:T},o.prototype.toJSON=function(){return this.toString(16,2)},d&&(o.prototype.toBuffer=function(T,C){return this.toArrayLike(d,T,C)}),o.prototype.toArray=function(T,C){return this.toArrayLike(Array,T,C)};function N(T,C,S){S.negative=C.negative^T.negative;var w=T.length+C.length|0;S.length=w,w=w-1|0;var j=0|T.words[0],A=0|C.words[0],L=j*A,I=67108863&L,Z=L/67108864|0;S.words[0]=I;for(var K=1;K<w;K++){for(var re=Z>>>26,G=67108863&Z,ae=Math.min(K,C.length-1),V=Math.max(0,K-T.length+1);V<=ae;V++){var H=K-V|0;re+=(L=(j=0|T.words[H])*(A=0|C.words[V])+G)/67108864|0,G=67108863&L}S.words[K]=0|G,Z=0|re}return Z!==0?S.words[K]=0|Z:S.length--,S._strip()}o.prototype.toArrayLike=function(T,C,S){this._strip();var w=this.byteLength(),j=S||Math.max(1,w);l(w<=j,"byte array longer than desired length"),l(j>0,"Requested array length <= 0");var A=function(L,I){return L.allocUnsafe?L.allocUnsafe(I):new L(I)}(T,j);return this["_toArrayLike"+(C==="le"?"LE":"BE")](A,w),A},o.prototype._toArrayLikeLE=function(T,C){for(var S=0,w=0,j=0,A=0;j<this.length;j++){var L=this.words[j]<<A|w;T[S++]=255&L,S<T.length&&(T[S++]=L>>8&255),S<T.length&&(T[S++]=L>>16&255),A===6?(S<T.length&&(T[S++]=L>>24&255),w=0,A=0):(w=L>>>24,A+=2)}if(S<T.length)for(T[S++]=w;S<T.length;)T[S++]=0},o.prototype._toArrayLikeBE=function(T,C){for(var S=T.length-1,w=0,j=0,A=0;j<this.length;j++){var L=this.words[j]<<A|w;T[S--]=255&L,S>=0&&(T[S--]=L>>8&255),S>=0&&(T[S--]=L>>16&255),A===6?(S>=0&&(T[S--]=L>>24&255),w=0,A=0):(w=L>>>24,A+=2)}if(S>=0)for(T[S--]=w;S>=0;)T[S--]=0},Math.clz32?o.prototype._countBits=function(T){return 32-Math.clz32(T)}:o.prototype._countBits=function(T){var C=T,S=0;return C>=4096&&(S+=13,C>>>=13),C>=64&&(S+=7,C>>>=7),C>=8&&(S+=4,C>>>=4),C>=2&&(S+=2,C>>>=2),S+C},o.prototype._zeroBits=function(T){if(T===0)return 26;var C=T,S=0;return!(8191&C)&&(S+=13,C>>>=13),!(127&C)&&(S+=7,C>>>=7),!(15&C)&&(S+=4,C>>>=4),!(3&C)&&(S+=2,C>>>=2),!(1&C)&&S++,S},o.prototype.bitLength=function(){var T=this.words[this.length-1],C=this._countBits(T);return 26*(this.length-1)+C},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var T=0,C=0;C<this.length;C++){var S=this._zeroBits(this.words[C]);if(T+=S,S!==26)break}return T},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(T){return this.negative!==0?this.abs().inotn(T).iaddn(1):this.clone()},o.prototype.fromTwos=function(T){return this.testn(T-1)?this.notn(T).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return this.negative!==0},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(T){for(;this.length<T.length;)this.words[this.length++]=0;for(var C=0;C<T.length;C++)this.words[C]=this.words[C]|T.words[C];return this._strip()},o.prototype.ior=function(T){return l((this.negative|T.negative)==0),this.iuor(T)},o.prototype.or=function(T){return this.length>T.length?this.clone().ior(T):T.clone().ior(this)},o.prototype.uor=function(T){return this.length>T.length?this.clone().iuor(T):T.clone().iuor(this)},o.prototype.iuand=function(T){var C;C=this.length>T.length?T:this;for(var S=0;S<C.length;S++)this.words[S]=this.words[S]&T.words[S];return this.length=C.length,this._strip()},o.prototype.iand=function(T){return l((this.negative|T.negative)==0),this.iuand(T)},o.prototype.and=function(T){return this.length>T.length?this.clone().iand(T):T.clone().iand(this)},o.prototype.uand=function(T){return this.length>T.length?this.clone().iuand(T):T.clone().iuand(this)},o.prototype.iuxor=function(T){var C,S;this.length>T.length?(C=this,S=T):(C=T,S=this);for(var w=0;w<S.length;w++)this.words[w]=C.words[w]^S.words[w];if(this!==C)for(;w<C.length;w++)this.words[w]=C.words[w];return this.length=C.length,this._strip()},o.prototype.ixor=function(T){return l((this.negative|T.negative)==0),this.iuxor(T)},o.prototype.xor=function(T){return this.length>T.length?this.clone().ixor(T):T.clone().ixor(this)},o.prototype.uxor=function(T){return this.length>T.length?this.clone().iuxor(T):T.clone().iuxor(this)},o.prototype.inotn=function(T){l(typeof T=="number"&&T>=0);var C=0|Math.ceil(T/26),S=T%26;this._expand(C),S>0&&C--;for(var w=0;w<C;w++)this.words[w]=67108863&~this.words[w];return S>0&&(this.words[w]=~this.words[w]&67108863>>26-S),this._strip()},o.prototype.notn=function(T){return this.clone().inotn(T)},o.prototype.setn=function(T,C){l(typeof T=="number"&&T>=0);var S=T/26|0,w=T%26;return this._expand(S+1),this.words[S]=C?this.words[S]|1<<w:this.words[S]&~(1<<w),this._strip()},o.prototype.iadd=function(T){var C,S,w;if(this.negative!==0&&T.negative===0)return this.negative=0,C=this.isub(T),this.negative^=1,this._normSign();if(this.negative===0&&T.negative!==0)return T.negative=0,C=this.isub(T),T.negative=1,C._normSign();this.length>T.length?(S=this,w=T):(S=T,w=this);for(var j=0,A=0;A<w.length;A++)C=(0|S.words[A])+(0|w.words[A])+j,this.words[A]=67108863&C,j=C>>>26;for(;j!==0&&A<S.length;A++)C=(0|S.words[A])+j,this.words[A]=67108863&C,j=C>>>26;if(this.length=S.length,j!==0)this.words[this.length]=j,this.length++;else if(S!==this)for(;A<S.length;A++)this.words[A]=S.words[A];return this},o.prototype.add=function(T){var C;return T.negative!==0&&this.negative===0?(T.negative=0,C=this.sub(T),T.negative^=1,C):T.negative===0&&this.negative!==0?(this.negative=0,C=T.sub(this),this.negative=1,C):this.length>T.length?this.clone().iadd(T):T.clone().iadd(this)},o.prototype.isub=function(T){if(T.negative!==0){T.negative=0;var C=this.iadd(T);return T.negative=1,C._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(T),this.negative=1,this._normSign();var S,w,j=this.cmp(T);if(j===0)return this.negative=0,this.length=1,this.words[0]=0,this;j>0?(S=this,w=T):(S=T,w=this);for(var A=0,L=0;L<w.length;L++)A=(C=(0|S.words[L])-(0|w.words[L])+A)>>26,this.words[L]=67108863&C;for(;A!==0&&L<S.length;L++)A=(C=(0|S.words[L])+A)>>26,this.words[L]=67108863&C;if(A===0&&L<S.length&&S!==this)for(;L<S.length;L++)this.words[L]=S.words[L];return this.length=Math.max(this.length,L),S!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(T){return this.clone().isub(T)};var E=function(T,C,S){var w,j,A,L=T.words,I=C.words,Z=S.words,K=0,re=0|L[0],G=8191&re,ae=re>>>13,V=0|L[1],H=8191&V,Q=V>>>13,oe=0|L[2],se=8191&oe,le=oe>>>13,he=0|L[3],Ne=8191&he,we=he>>>13,ue=0|L[4],Se=8191&ue,ke=ue>>>13,Me=0|L[5],Oe=8191&Me,je=Me>>>13,Ie=0|L[6],Pe=8191&Ie,He=Ie>>>13,ct=0|L[7],ie=8191&ct,ee=ct>>>13,te=0|L[8],fe=8191&te,_e=te>>>13,Te=0|L[9],Ae=8191&Te,Fe=Te>>>13,st=0|I[0],it=8191&st,lt=st>>>13,yt=0|I[1],vt=8191&yt,Nt=yt>>>13,Mt=0|I[2],Et=8191&Mt,_t=Mt>>>13,Tt=0|I[3],ut=8191&Tt,jt=Tt>>>13,Ke=0|I[4],Vt=8191&Ke,St=Ke>>>13,et=0|I[5],ot=8191&et,At=et>>>13,Re=0|I[6],Ve=8191&Re,Qe=Re>>>13,de=0|I[7],be=8191&de,me=de>>>13,ge=0|I[8],ye=8191&ge,ve=ge>>>13,Le=0|I[9],qe=8191&Le,Be=Le>>>13;S.negative=T.negative^C.negative,S.length=19;var $e=(K+(w=Math.imul(G,it))|0)+((8191&(j=(j=Math.imul(G,lt))+Math.imul(ae,it)|0))<<13)|0;K=((A=Math.imul(ae,lt))+(j>>>13)|0)+($e>>>26)|0,$e&=67108863,w=Math.imul(H,it),j=(j=Math.imul(H,lt))+Math.imul(Q,it)|0,A=Math.imul(Q,lt);var ze=(K+(w=w+Math.imul(G,vt)|0)|0)+((8191&(j=(j=j+Math.imul(G,Nt)|0)+Math.imul(ae,vt)|0))<<13)|0;K=((A=A+Math.imul(ae,Nt)|0)+(j>>>13)|0)+(ze>>>26)|0,ze&=67108863,w=Math.imul(se,it),j=(j=Math.imul(se,lt))+Math.imul(le,it)|0,A=Math.imul(le,lt),w=w+Math.imul(H,vt)|0,j=(j=j+Math.imul(H,Nt)|0)+Math.imul(Q,vt)|0,A=A+Math.imul(Q,Nt)|0;var nt=(K+(w=w+Math.imul(G,Et)|0)|0)+((8191&(j=(j=j+Math.imul(G,_t)|0)+Math.imul(ae,Et)|0))<<13)|0;K=((A=A+Math.imul(ae,_t)|0)+(j>>>13)|0)+(nt>>>26)|0,nt&=67108863,w=Math.imul(Ne,it),j=(j=Math.imul(Ne,lt))+Math.imul(we,it)|0,A=Math.imul(we,lt),w=w+Math.imul(se,vt)|0,j=(j=j+Math.imul(se,Nt)|0)+Math.imul(le,vt)|0,A=A+Math.imul(le,Nt)|0,w=w+Math.imul(H,Et)|0,j=(j=j+Math.imul(H,_t)|0)+Math.imul(Q,Et)|0,A=A+Math.imul(Q,_t)|0;var ht=(K+(w=w+Math.imul(G,ut)|0)|0)+((8191&(j=(j=j+Math.imul(G,jt)|0)+Math.imul(ae,ut)|0))<<13)|0;K=((A=A+Math.imul(ae,jt)|0)+(j>>>13)|0)+(ht>>>26)|0,ht&=67108863,w=Math.imul(Se,it),j=(j=Math.imul(Se,lt))+Math.imul(ke,it)|0,A=Math.imul(ke,lt),w=w+Math.imul(Ne,vt)|0,j=(j=j+Math.imul(Ne,Nt)|0)+Math.imul(we,vt)|0,A=A+Math.imul(we,Nt)|0,w=w+Math.imul(se,Et)|0,j=(j=j+Math.imul(se,_t)|0)+Math.imul(le,Et)|0,A=A+Math.imul(le,_t)|0,w=w+Math.imul(H,ut)|0,j=(j=j+Math.imul(H,jt)|0)+Math.imul(Q,ut)|0,A=A+Math.imul(Q,jt)|0;var xt=(K+(w=w+Math.imul(G,Vt)|0)|0)+((8191&(j=(j=j+Math.imul(G,St)|0)+Math.imul(ae,Vt)|0))<<13)|0;K=((A=A+Math.imul(ae,St)|0)+(j>>>13)|0)+(xt>>>26)|0,xt&=67108863,w=Math.imul(Oe,it),j=(j=Math.imul(Oe,lt))+Math.imul(je,it)|0,A=Math.imul(je,lt),w=w+Math.imul(Se,vt)|0,j=(j=j+Math.imul(Se,Nt)|0)+Math.imul(ke,vt)|0,A=A+Math.imul(ke,Nt)|0,w=w+Math.imul(Ne,Et)|0,j=(j=j+Math.imul(Ne,_t)|0)+Math.imul(we,Et)|0,A=A+Math.imul(we,_t)|0,w=w+Math.imul(se,ut)|0,j=(j=j+Math.imul(se,jt)|0)+Math.imul(le,ut)|0,A=A+Math.imul(le,jt)|0,w=w+Math.imul(H,Vt)|0,j=(j=j+Math.imul(H,St)|0)+Math.imul(Q,Vt)|0,A=A+Math.imul(Q,St)|0;var pe=(K+(w=w+Math.imul(G,ot)|0)|0)+((8191&(j=(j=j+Math.imul(G,At)|0)+Math.imul(ae,ot)|0))<<13)|0;K=((A=A+Math.imul(ae,At)|0)+(j>>>13)|0)+(pe>>>26)|0,pe&=67108863,w=Math.imul(Pe,it),j=(j=Math.imul(Pe,lt))+Math.imul(He,it)|0,A=Math.imul(He,lt),w=w+Math.imul(Oe,vt)|0,j=(j=j+Math.imul(Oe,Nt)|0)+Math.imul(je,vt)|0,A=A+Math.imul(je,Nt)|0,w=w+Math.imul(Se,Et)|0,j=(j=j+Math.imul(Se,_t)|0)+Math.imul(ke,Et)|0,A=A+Math.imul(ke,_t)|0,w=w+Math.imul(Ne,ut)|0,j=(j=j+Math.imul(Ne,jt)|0)+Math.imul(we,ut)|0,A=A+Math.imul(we,jt)|0,w=w+Math.imul(se,Vt)|0,j=(j=j+Math.imul(se,St)|0)+Math.imul(le,Vt)|0,A=A+Math.imul(le,St)|0,w=w+Math.imul(H,ot)|0,j=(j=j+Math.imul(H,At)|0)+Math.imul(Q,ot)|0,A=A+Math.imul(Q,At)|0;var Ce=(K+(w=w+Math.imul(G,Ve)|0)|0)+((8191&(j=(j=j+Math.imul(G,Qe)|0)+Math.imul(ae,Ve)|0))<<13)|0;K=((A=A+Math.imul(ae,Qe)|0)+(j>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,w=Math.imul(ie,it),j=(j=Math.imul(ie,lt))+Math.imul(ee,it)|0,A=Math.imul(ee,lt),w=w+Math.imul(Pe,vt)|0,j=(j=j+Math.imul(Pe,Nt)|0)+Math.imul(He,vt)|0,A=A+Math.imul(He,Nt)|0,w=w+Math.imul(Oe,Et)|0,j=(j=j+Math.imul(Oe,_t)|0)+Math.imul(je,Et)|0,A=A+Math.imul(je,_t)|0,w=w+Math.imul(Se,ut)|0,j=(j=j+Math.imul(Se,jt)|0)+Math.imul(ke,ut)|0,A=A+Math.imul(ke,jt)|0,w=w+Math.imul(Ne,Vt)|0,j=(j=j+Math.imul(Ne,St)|0)+Math.imul(we,Vt)|0,A=A+Math.imul(we,St)|0,w=w+Math.imul(se,ot)|0,j=(j=j+Math.imul(se,At)|0)+Math.imul(le,ot)|0,A=A+Math.imul(le,At)|0,w=w+Math.imul(H,Ve)|0,j=(j=j+Math.imul(H,Qe)|0)+Math.imul(Q,Ve)|0,A=A+Math.imul(Q,Qe)|0;var Ye=(K+(w=w+Math.imul(G,be)|0)|0)+((8191&(j=(j=j+Math.imul(G,me)|0)+Math.imul(ae,be)|0))<<13)|0;K=((A=A+Math.imul(ae,me)|0)+(j>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,w=Math.imul(fe,it),j=(j=Math.imul(fe,lt))+Math.imul(_e,it)|0,A=Math.imul(_e,lt),w=w+Math.imul(ie,vt)|0,j=(j=j+Math.imul(ie,Nt)|0)+Math.imul(ee,vt)|0,A=A+Math.imul(ee,Nt)|0,w=w+Math.imul(Pe,Et)|0,j=(j=j+Math.imul(Pe,_t)|0)+Math.imul(He,Et)|0,A=A+Math.imul(He,_t)|0,w=w+Math.imul(Oe,ut)|0,j=(j=j+Math.imul(Oe,jt)|0)+Math.imul(je,ut)|0,A=A+Math.imul(je,jt)|0,w=w+Math.imul(Se,Vt)|0,j=(j=j+Math.imul(Se,St)|0)+Math.imul(ke,Vt)|0,A=A+Math.imul(ke,St)|0,w=w+Math.imul(Ne,ot)|0,j=(j=j+Math.imul(Ne,At)|0)+Math.imul(we,ot)|0,A=A+Math.imul(we,At)|0,w=w+Math.imul(se,Ve)|0,j=(j=j+Math.imul(se,Qe)|0)+Math.imul(le,Ve)|0,A=A+Math.imul(le,Qe)|0,w=w+Math.imul(H,be)|0,j=(j=j+Math.imul(H,me)|0)+Math.imul(Q,be)|0,A=A+Math.imul(Q,me)|0;var tt=(K+(w=w+Math.imul(G,ye)|0)|0)+((8191&(j=(j=j+Math.imul(G,ve)|0)+Math.imul(ae,ye)|0))<<13)|0;K=((A=A+Math.imul(ae,ve)|0)+(j>>>13)|0)+(tt>>>26)|0,tt&=67108863,w=Math.imul(Ae,it),j=(j=Math.imul(Ae,lt))+Math.imul(Fe,it)|0,A=Math.imul(Fe,lt),w=w+Math.imul(fe,vt)|0,j=(j=j+Math.imul(fe,Nt)|0)+Math.imul(_e,vt)|0,A=A+Math.imul(_e,Nt)|0,w=w+Math.imul(ie,Et)|0,j=(j=j+Math.imul(ie,_t)|0)+Math.imul(ee,Et)|0,A=A+Math.imul(ee,_t)|0,w=w+Math.imul(Pe,ut)|0,j=(j=j+Math.imul(Pe,jt)|0)+Math.imul(He,ut)|0,A=A+Math.imul(He,jt)|0,w=w+Math.imul(Oe,Vt)|0,j=(j=j+Math.imul(Oe,St)|0)+Math.imul(je,Vt)|0,A=A+Math.imul(je,St)|0,w=w+Math.imul(Se,ot)|0,j=(j=j+Math.imul(Se,At)|0)+Math.imul(ke,ot)|0,A=A+Math.imul(ke,At)|0,w=w+Math.imul(Ne,Ve)|0,j=(j=j+Math.imul(Ne,Qe)|0)+Math.imul(we,Ve)|0,A=A+Math.imul(we,Qe)|0,w=w+Math.imul(se,be)|0,j=(j=j+Math.imul(se,me)|0)+Math.imul(le,be)|0,A=A+Math.imul(le,me)|0,w=w+Math.imul(H,ye)|0,j=(j=j+Math.imul(H,ve)|0)+Math.imul(Q,ye)|0,A=A+Math.imul(Q,ve)|0;var gt=(K+(w=w+Math.imul(G,qe)|0)|0)+((8191&(j=(j=j+Math.imul(G,Be)|0)+Math.imul(ae,qe)|0))<<13)|0;K=((A=A+Math.imul(ae,Be)|0)+(j>>>13)|0)+(gt>>>26)|0,gt&=67108863,w=Math.imul(Ae,vt),j=(j=Math.imul(Ae,Nt))+Math.imul(Fe,vt)|0,A=Math.imul(Fe,Nt),w=w+Math.imul(fe,Et)|0,j=(j=j+Math.imul(fe,_t)|0)+Math.imul(_e,Et)|0,A=A+Math.imul(_e,_t)|0,w=w+Math.imul(ie,ut)|0,j=(j=j+Math.imul(ie,jt)|0)+Math.imul(ee,ut)|0,A=A+Math.imul(ee,jt)|0,w=w+Math.imul(Pe,Vt)|0,j=(j=j+Math.imul(Pe,St)|0)+Math.imul(He,Vt)|0,A=A+Math.imul(He,St)|0,w=w+Math.imul(Oe,ot)|0,j=(j=j+Math.imul(Oe,At)|0)+Math.imul(je,ot)|0,A=A+Math.imul(je,At)|0,w=w+Math.imul(Se,Ve)|0,j=(j=j+Math.imul(Se,Qe)|0)+Math.imul(ke,Ve)|0,A=A+Math.imul(ke,Qe)|0,w=w+Math.imul(Ne,be)|0,j=(j=j+Math.imul(Ne,me)|0)+Math.imul(we,be)|0,A=A+Math.imul(we,me)|0,w=w+Math.imul(se,ye)|0,j=(j=j+Math.imul(se,ve)|0)+Math.imul(le,ye)|0,A=A+Math.imul(le,ve)|0;var ft=(K+(w=w+Math.imul(H,qe)|0)|0)+((8191&(j=(j=j+Math.imul(H,Be)|0)+Math.imul(Q,qe)|0))<<13)|0;K=((A=A+Math.imul(Q,Be)|0)+(j>>>13)|0)+(ft>>>26)|0,ft&=67108863,w=Math.imul(Ae,Et),j=(j=Math.imul(Ae,_t))+Math.imul(Fe,Et)|0,A=Math.imul(Fe,_t),w=w+Math.imul(fe,ut)|0,j=(j=j+Math.imul(fe,jt)|0)+Math.imul(_e,ut)|0,A=A+Math.imul(_e,jt)|0,w=w+Math.imul(ie,Vt)|0,j=(j=j+Math.imul(ie,St)|0)+Math.imul(ee,Vt)|0,A=A+Math.imul(ee,St)|0,w=w+Math.imul(Pe,ot)|0,j=(j=j+Math.imul(Pe,At)|0)+Math.imul(He,ot)|0,A=A+Math.imul(He,At)|0,w=w+Math.imul(Oe,Ve)|0,j=(j=j+Math.imul(Oe,Qe)|0)+Math.imul(je,Ve)|0,A=A+Math.imul(je,Qe)|0,w=w+Math.imul(Se,be)|0,j=(j=j+Math.imul(Se,me)|0)+Math.imul(ke,be)|0,A=A+Math.imul(ke,me)|0,w=w+Math.imul(Ne,ye)|0,j=(j=j+Math.imul(Ne,ve)|0)+Math.imul(we,ye)|0,A=A+Math.imul(we,ve)|0;var pt=(K+(w=w+Math.imul(se,qe)|0)|0)+((8191&(j=(j=j+Math.imul(se,Be)|0)+Math.imul(le,qe)|0))<<13)|0;K=((A=A+Math.imul(le,Be)|0)+(j>>>13)|0)+(pt>>>26)|0,pt&=67108863,w=Math.imul(Ae,ut),j=(j=Math.imul(Ae,jt))+Math.imul(Fe,ut)|0,A=Math.imul(Fe,jt),w=w+Math.imul(fe,Vt)|0,j=(j=j+Math.imul(fe,St)|0)+Math.imul(_e,Vt)|0,A=A+Math.imul(_e,St)|0,w=w+Math.imul(ie,ot)|0,j=(j=j+Math.imul(ie,At)|0)+Math.imul(ee,ot)|0,A=A+Math.imul(ee,At)|0,w=w+Math.imul(Pe,Ve)|0,j=(j=j+Math.imul(Pe,Qe)|0)+Math.imul(He,Ve)|0,A=A+Math.imul(He,Qe)|0,w=w+Math.imul(Oe,be)|0,j=(j=j+Math.imul(Oe,me)|0)+Math.imul(je,be)|0,A=A+Math.imul(je,me)|0,w=w+Math.imul(Se,ye)|0,j=(j=j+Math.imul(Se,ve)|0)+Math.imul(ke,ye)|0,A=A+Math.imul(ke,ve)|0;var Yt=(K+(w=w+Math.imul(Ne,qe)|0)|0)+((8191&(j=(j=j+Math.imul(Ne,Be)|0)+Math.imul(we,qe)|0))<<13)|0;K=((A=A+Math.imul(we,Be)|0)+(j>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,w=Math.imul(Ae,Vt),j=(j=Math.imul(Ae,St))+Math.imul(Fe,Vt)|0,A=Math.imul(Fe,St),w=w+Math.imul(fe,ot)|0,j=(j=j+Math.imul(fe,At)|0)+Math.imul(_e,ot)|0,A=A+Math.imul(_e,At)|0,w=w+Math.imul(ie,Ve)|0,j=(j=j+Math.imul(ie,Qe)|0)+Math.imul(ee,Ve)|0,A=A+Math.imul(ee,Qe)|0,w=w+Math.imul(Pe,be)|0,j=(j=j+Math.imul(Pe,me)|0)+Math.imul(He,be)|0,A=A+Math.imul(He,me)|0,w=w+Math.imul(Oe,ye)|0,j=(j=j+Math.imul(Oe,ve)|0)+Math.imul(je,ye)|0,A=A+Math.imul(je,ve)|0;var Dt=(K+(w=w+Math.imul(Se,qe)|0)|0)+((8191&(j=(j=j+Math.imul(Se,Be)|0)+Math.imul(ke,qe)|0))<<13)|0;K=((A=A+Math.imul(ke,Be)|0)+(j>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,w=Math.imul(Ae,ot),j=(j=Math.imul(Ae,At))+Math.imul(Fe,ot)|0,A=Math.imul(Fe,At),w=w+Math.imul(fe,Ve)|0,j=(j=j+Math.imul(fe,Qe)|0)+Math.imul(_e,Ve)|0,A=A+Math.imul(_e,Qe)|0,w=w+Math.imul(ie,be)|0,j=(j=j+Math.imul(ie,me)|0)+Math.imul(ee,be)|0,A=A+Math.imul(ee,me)|0,w=w+Math.imul(Pe,ye)|0,j=(j=j+Math.imul(Pe,ve)|0)+Math.imul(He,ye)|0,A=A+Math.imul(He,ve)|0;var Ut=(K+(w=w+Math.imul(Oe,qe)|0)|0)+((8191&(j=(j=j+Math.imul(Oe,Be)|0)+Math.imul(je,qe)|0))<<13)|0;K=((A=A+Math.imul(je,Be)|0)+(j>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,w=Math.imul(Ae,Ve),j=(j=Math.imul(Ae,Qe))+Math.imul(Fe,Ve)|0,A=Math.imul(Fe,Qe),w=w+Math.imul(fe,be)|0,j=(j=j+Math.imul(fe,me)|0)+Math.imul(_e,be)|0,A=A+Math.imul(_e,me)|0,w=w+Math.imul(ie,ye)|0,j=(j=j+Math.imul(ie,ve)|0)+Math.imul(ee,ye)|0,A=A+Math.imul(ee,ve)|0;var Ot=(K+(w=w+Math.imul(Pe,qe)|0)|0)+((8191&(j=(j=j+Math.imul(Pe,Be)|0)+Math.imul(He,qe)|0))<<13)|0;K=((A=A+Math.imul(He,Be)|0)+(j>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,w=Math.imul(Ae,be),j=(j=Math.imul(Ae,me))+Math.imul(Fe,be)|0,A=Math.imul(Fe,me),w=w+Math.imul(fe,ye)|0,j=(j=j+Math.imul(fe,ve)|0)+Math.imul(_e,ye)|0,A=A+Math.imul(_e,ve)|0;var Gt=(K+(w=w+Math.imul(ie,qe)|0)|0)+((8191&(j=(j=j+Math.imul(ie,Be)|0)+Math.imul(ee,qe)|0))<<13)|0;K=((A=A+Math.imul(ee,Be)|0)+(j>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,w=Math.imul(Ae,ye),j=(j=Math.imul(Ae,ve))+Math.imul(Fe,ye)|0,A=Math.imul(Fe,ve);var or=(K+(w=w+Math.imul(fe,qe)|0)|0)+((8191&(j=(j=j+Math.imul(fe,Be)|0)+Math.imul(_e,qe)|0))<<13)|0;K=((A=A+Math.imul(_e,Be)|0)+(j>>>13)|0)+(or>>>26)|0,or&=67108863;var Jt=(K+(w=Math.imul(Ae,qe))|0)+((8191&(j=(j=Math.imul(Ae,Be))+Math.imul(Fe,qe)|0))<<13)|0;return K=((A=Math.imul(Fe,Be))+(j>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,Z[0]=$e,Z[1]=ze,Z[2]=nt,Z[3]=ht,Z[4]=xt,Z[5]=pe,Z[6]=Ce,Z[7]=Ye,Z[8]=tt,Z[9]=gt,Z[10]=ft,Z[11]=pt,Z[12]=Yt,Z[13]=Dt,Z[14]=Ut,Z[15]=Ot,Z[16]=Gt,Z[17]=or,Z[18]=Jt,K!==0&&(Z[19]=K,S.length++),S};function O(T,C,S){S.negative=C.negative^T.negative,S.length=T.length+C.length;for(var w=0,j=0,A=0;A<S.length-1;A++){var L=j;j=0;for(var I=67108863&w,Z=Math.min(A,C.length-1),K=Math.max(0,A-T.length+1);K<=Z;K++){var re=A-K,G=(0|T.words[re])*(0|C.words[K]),ae=67108863&G;I=67108863&(ae=ae+I|0),j+=(L=(L=L+(G/67108864|0)|0)+(ae>>>26)|0)>>>26,L&=67108863}S.words[A]=I,w=L,L=j}return w!==0?S.words[A]=w:S.length--,S._strip()}function F(T,C,S){return O(T,C,S)}Math.imul||(E=N),o.prototype.mulTo=function(T,C){var S=this.length+T.length;return this.length===10&&T.length===10?E(this,T,C):S<63?N(this,T,C):S<1024?O(this,T,C):F(this,T,C)},o.prototype.mul=function(T){var C=new o(null);return C.words=new Array(this.length+T.length),this.mulTo(T,C)},o.prototype.mulf=function(T){var C=new o(null);return C.words=new Array(this.length+T.length),F(this,T,C)},o.prototype.imul=function(T){return this.clone().mulTo(T,this)},o.prototype.imuln=function(T){var C=T<0;C&&(T=-T),l(typeof T=="number"),l(T<67108864);for(var S=0,w=0;w<this.length;w++){var j=(0|this.words[w])*T,A=(67108863&j)+(67108863&S);S>>=26,S+=j/67108864|0,S+=A>>>26,this.words[w]=67108863&A}return S!==0&&(this.words[w]=S,this.length++),C?this.ineg():this},o.prototype.muln=function(T){return this.clone().imuln(T)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(T){var C=function(A){for(var L=new Array(A.bitLength()),I=0;I<L.length;I++){var Z=I/26|0,K=I%26;L[I]=A.words[Z]>>>K&1}return L}(T);if(C.length===0)return new o(1);for(var S=this,w=0;w<C.length&&C[w]===0;w++,S=S.sqr());if(++w<C.length)for(var j=S.sqr();w<C.length;w++,j=j.sqr())C[w]!==0&&(S=S.mul(j));return S},o.prototype.iushln=function(T){l(typeof T=="number"&&T>=0);var C,S=T%26,w=(T-S)/26,j=67108863>>>26-S<<26-S;if(S!==0){var A=0;for(C=0;C<this.length;C++){var L=this.words[C]&j,I=(0|this.words[C])-L<<S;this.words[C]=I|A,A=L>>>26-S}A&&(this.words[C]=A,this.length++)}if(w!==0){for(C=this.length-1;C>=0;C--)this.words[C+w]=this.words[C];for(C=0;C<w;C++)this.words[C]=0;this.length+=w}return this._strip()},o.prototype.ishln=function(T){return l(this.negative===0),this.iushln(T)},o.prototype.iushrn=function(T,C,S){var w;l(typeof T=="number"&&T>=0),w=C?(C-C%26)/26:0;var j=T%26,A=Math.min((T-j)/26,this.length),L=67108863^67108863>>>j<<j,I=S;if(w-=A,w=Math.max(0,w),I){for(var Z=0;Z<A;Z++)I.words[Z]=this.words[Z];I.length=A}if(A!==0)if(this.length>A)for(this.length-=A,Z=0;Z<this.length;Z++)this.words[Z]=this.words[Z+A];else this.words[0]=0,this.length=1;var K=0;for(Z=this.length-1;Z>=0&&(K!==0||Z>=w);Z--){var re=0|this.words[Z];this.words[Z]=K<<26-j|re>>>j,K=re&L}return I&&K!==0&&(I.words[I.length++]=K),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(T,C,S){return l(this.negative===0),this.iushrn(T,C,S)},o.prototype.shln=function(T){return this.clone().ishln(T)},o.prototype.ushln=function(T){return this.clone().iushln(T)},o.prototype.shrn=function(T){return this.clone().ishrn(T)},o.prototype.ushrn=function(T){return this.clone().iushrn(T)},o.prototype.testn=function(T){l(typeof T=="number"&&T>=0);var C=T%26,S=(T-C)/26,w=1<<C;return!(this.length<=S)&&!!(this.words[S]&w)},o.prototype.imaskn=function(T){l(typeof T=="number"&&T>=0);var C=T%26,S=(T-C)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(C!==0&&S++,this.length=Math.min(S,this.length),C!==0){var w=67108863^67108863>>>C<<C;this.words[this.length-1]&=w}return this._strip()},o.prototype.maskn=function(T){return this.clone().imaskn(T)},o.prototype.iaddn=function(T){return l(typeof T=="number"),l(T<67108864),T<0?this.isubn(-T):this.negative!==0?this.length===1&&(0|this.words[0])<=T?(this.words[0]=T-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(T),this.negative=1,this):this._iaddn(T)},o.prototype._iaddn=function(T){this.words[0]+=T;for(var C=0;C<this.length&&this.words[C]>=67108864;C++)this.words[C]-=67108864,C===this.length-1?this.words[C+1]=1:this.words[C+1]++;return this.length=Math.max(this.length,C+1),this},o.prototype.isubn=function(T){if(l(typeof T=="number"),l(T<67108864),T<0)return this.iaddn(-T);if(this.negative!==0)return this.negative=0,this.iaddn(T),this.negative=1,this;if(this.words[0]-=T,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var C=0;C<this.length&&this.words[C]<0;C++)this.words[C]+=67108864,this.words[C+1]-=1;return this._strip()},o.prototype.addn=function(T){return this.clone().iaddn(T)},o.prototype.subn=function(T){return this.clone().isubn(T)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(T,C,S){var w,j,A=T.length+S;this._expand(A);var L=0;for(w=0;w<T.length;w++){j=(0|this.words[w+S])+L;var I=(0|T.words[w])*C;L=((j-=67108863&I)>>26)-(I/67108864|0),this.words[w+S]=67108863&j}for(;w<this.length-S;w++)L=(j=(0|this.words[w+S])+L)>>26,this.words[w+S]=67108863&j;if(L===0)return this._strip();for(l(L===-1),L=0,w=0;w<this.length;w++)L=(j=-(0|this.words[w])+L)>>26,this.words[w]=67108863&j;return this.negative=1,this._strip()},o.prototype._wordDiv=function(T,C){var S=(this.length,T.length),w=this.clone(),j=T,A=0|j.words[j.length-1];(S=26-this._countBits(A))!==0&&(j=j.ushln(S),w.iushln(S),A=0|j.words[j.length-1]);var L,I=w.length-j.length;if(C!=="mod"){(L=new o(null)).length=I+1,L.words=new Array(L.length);for(var Z=0;Z<L.length;Z++)L.words[Z]=0}var K=w.clone()._ishlnsubmul(j,1,I);K.negative===0&&(w=K,L&&(L.words[I]=1));for(var re=I-1;re>=0;re--){var G=67108864*(0|w.words[j.length+re])+(0|w.words[j.length+re-1]);for(G=Math.min(G/A|0,67108863),w._ishlnsubmul(j,G,re);w.negative!==0;)G--,w.negative=0,w._ishlnsubmul(j,1,re),w.isZero()||(w.negative^=1);L&&(L.words[re]=G)}return L&&L._strip(),w._strip(),C!=="div"&&S!==0&&w.iushrn(S),{div:L||null,mod:w}},o.prototype.divmod=function(T,C,S){return l(!T.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:this.negative!==0&&T.negative===0?(A=this.neg().divmod(T,C),C!=="mod"&&(w=A.div.neg()),C!=="div"&&(j=A.mod.neg(),S&&j.negative!==0&&j.iadd(T)),{div:w,mod:j}):this.negative===0&&T.negative!==0?(A=this.divmod(T.neg(),C),C!=="mod"&&(w=A.div.neg()),{div:w,mod:A.mod}):this.negative&T.negative?(A=this.neg().divmod(T.neg(),C),C!=="div"&&(j=A.mod.neg(),S&&j.negative!==0&&j.isub(T)),{div:A.div,mod:j}):T.length>this.length||this.cmp(T)<0?{div:new o(0),mod:this}:T.length===1?C==="div"?{div:this.divn(T.words[0]),mod:null}:C==="mod"?{div:null,mod:new o(this.modrn(T.words[0]))}:{div:this.divn(T.words[0]),mod:new o(this.modrn(T.words[0]))}:this._wordDiv(T,C);var w,j,A},o.prototype.div=function(T){return this.divmod(T,"div",!1).div},o.prototype.mod=function(T){return this.divmod(T,"mod",!1).mod},o.prototype.umod=function(T){return this.divmod(T,"mod",!0).mod},o.prototype.divRound=function(T){var C=this.divmod(T);if(C.mod.isZero())return C.div;var S=C.div.negative!==0?C.mod.isub(T):C.mod,w=T.ushrn(1),j=T.andln(1),A=S.cmp(w);return A<0||j===1&&A===0?C.div:C.div.negative!==0?C.div.isubn(1):C.div.iaddn(1)},o.prototype.modrn=function(T){var C=T<0;C&&(T=-T),l(T<=67108863);for(var S=(1<<26)%T,w=0,j=this.length-1;j>=0;j--)w=(S*w+(0|this.words[j]))%T;return C?-w:w},o.prototype.modn=function(T){return this.modrn(T)},o.prototype.idivn=function(T){var C=T<0;C&&(T=-T),l(T<=67108863);for(var S=0,w=this.length-1;w>=0;w--){var j=(0|this.words[w])+67108864*S;this.words[w]=j/T|0,S=j%T}return this._strip(),C?this.ineg():this},o.prototype.divn=function(T){return this.clone().idivn(T)},o.prototype.egcd=function(T){l(T.negative===0),l(!T.isZero());var C=this,S=T.clone();C=C.negative!==0?C.umod(T):C.clone();for(var w=new o(1),j=new o(0),A=new o(0),L=new o(1),I=0;C.isEven()&&S.isEven();)C.iushrn(1),S.iushrn(1),++I;for(var Z=S.clone(),K=C.clone();!C.isZero();){for(var re=0,G=1;!(C.words[0]&G)&&re<26;++re,G<<=1);if(re>0)for(C.iushrn(re);re-- >0;)(w.isOdd()||j.isOdd())&&(w.iadd(Z),j.isub(K)),w.iushrn(1),j.iushrn(1);for(var ae=0,V=1;!(S.words[0]&V)&&ae<26;++ae,V<<=1);if(ae>0)for(S.iushrn(ae);ae-- >0;)(A.isOdd()||L.isOdd())&&(A.iadd(Z),L.isub(K)),A.iushrn(1),L.iushrn(1);C.cmp(S)>=0?(C.isub(S),w.isub(A),j.isub(L)):(S.isub(C),A.isub(w),L.isub(j))}return{a:A,b:L,gcd:S.iushln(I)}},o.prototype._invmp=function(T){l(T.negative===0),l(!T.isZero());var C=this,S=T.clone();C=C.negative!==0?C.umod(T):C.clone();for(var w,j=new o(1),A=new o(0),L=S.clone();C.cmpn(1)>0&&S.cmpn(1)>0;){for(var I=0,Z=1;!(C.words[0]&Z)&&I<26;++I,Z<<=1);if(I>0)for(C.iushrn(I);I-- >0;)j.isOdd()&&j.iadd(L),j.iushrn(1);for(var K=0,re=1;!(S.words[0]&re)&&K<26;++K,re<<=1);if(K>0)for(S.iushrn(K);K-- >0;)A.isOdd()&&A.iadd(L),A.iushrn(1);C.cmp(S)>=0?(C.isub(S),j.isub(A)):(S.isub(C),A.isub(j))}return(w=C.cmpn(1)===0?j:A).cmpn(0)<0&&w.iadd(T),w},o.prototype.gcd=function(T){if(this.isZero())return T.abs();if(T.isZero())return this.abs();var C=this.clone(),S=T.clone();C.negative=0,S.negative=0;for(var w=0;C.isEven()&&S.isEven();w++)C.iushrn(1),S.iushrn(1);for(;;){for(;C.isEven();)C.iushrn(1);for(;S.isEven();)S.iushrn(1);var j=C.cmp(S);if(j<0){var A=C;C=S,S=A}else if(j===0||S.cmpn(1)===0)break;C.isub(S)}return S.iushln(w)},o.prototype.invm=function(T){return this.egcd(T).a.umod(T)},o.prototype.isEven=function(){return(1&this.words[0])==0},o.prototype.isOdd=function(){return(1&this.words[0])==1},o.prototype.andln=function(T){return this.words[0]&T},o.prototype.bincn=function(T){l(typeof T=="number");var C=T%26,S=(T-C)/26,w=1<<C;if(this.length<=S)return this._expand(S+1),this.words[S]|=w,this;for(var j=w,A=S;j!==0&&A<this.length;A++){var L=0|this.words[A];j=(L+=j)>>>26,L&=67108863,this.words[A]=L}return j!==0&&(this.words[A]=j,this.length++),this},o.prototype.isZero=function(){return this.length===1&&this.words[0]===0},o.prototype.cmpn=function(T){var C,S=T<0;if(this.negative!==0&&!S)return-1;if(this.negative===0&&S)return 1;if(this._strip(),this.length>1)C=1;else{S&&(T=-T),l(T<=67108863,"Number is too big");var w=0|this.words[0];C=w===T?0:w<T?-1:1}return this.negative!==0?0|-C:C},o.prototype.cmp=function(T){if(this.negative!==0&&T.negative===0)return-1;if(this.negative===0&&T.negative!==0)return 1;var C=this.ucmp(T);return this.negative!==0?0|-C:C},o.prototype.ucmp=function(T){if(this.length>T.length)return 1;if(this.length<T.length)return-1;for(var C=0,S=this.length-1;S>=0;S--){var w=0|this.words[S],j=0|T.words[S];if(w!==j){w<j?C=-1:w>j&&(C=1);break}}return C},o.prototype.gtn=function(T){return this.cmpn(T)===1},o.prototype.gt=function(T){return this.cmp(T)===1},o.prototype.gten=function(T){return this.cmpn(T)>=0},o.prototype.gte=function(T){return this.cmp(T)>=0},o.prototype.ltn=function(T){return this.cmpn(T)===-1},o.prototype.lt=function(T){return this.cmp(T)===-1},o.prototype.lten=function(T){return this.cmpn(T)<=0},o.prototype.lte=function(T){return this.cmp(T)<=0},o.prototype.eqn=function(T){return this.cmpn(T)===0},o.prototype.eq=function(T){return this.cmp(T)===0},o.red=function(T){return new M(T)},o.prototype.toRed=function(T){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),T.convertTo(this)._forceRed(T)},o.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(T){return this.red=T,this},o.prototype.forceRed=function(T){return l(!this.red,"Already a number in reduction context"),this._forceRed(T)},o.prototype.redAdd=function(T){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,T)},o.prototype.redIAdd=function(T){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,T)},o.prototype.redSub=function(T){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,T)},o.prototype.redISub=function(T){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,T)},o.prototype.redShl=function(T){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,T)},o.prototype.redMul=function(T){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,T),this.red.mul(this,T)},o.prototype.redIMul=function(T){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,T),this.red.imul(this,T)},o.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(T){return l(this.red&&!T.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,T)};var z={k256:null,p224:null,p192:null,p25519:null};function P(T,C){this.name=T,this.p=new o(C,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function U(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function W(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function Y(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function q(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(T){if(typeof T=="string"){var C=o._prime(T);this.m=C.p,this.prime=C}else l(T.gtn(1),"modulus must be greater than 1"),this.m=T,this.prime=null}function D(T){M.call(this,T),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}P.prototype._tmp=function(){var T=new o(null);return T.words=new Array(Math.ceil(this.n/13)),T},P.prototype.ireduce=function(T){var C,S=T;do this.split(S,this.tmp),C=(S=(S=this.imulK(S)).iadd(this.tmp)).bitLength();while(C>this.n);var w=C<this.n?-1:S.ucmp(this.p);return w===0?(S.words[0]=0,S.length=1):w>0?S.isub(this.p):S.strip!==void 0?S.strip():S._strip(),S},P.prototype.split=function(T,C){T.iushrn(this.n,0,C)},P.prototype.imulK=function(T){return T.imul(this.k)},u(U,P),U.prototype.split=function(T,C){for(var S=Math.min(T.length,9),w=0;w<S;w++)C.words[w]=T.words[w];if(C.length=S,T.length<=9)return T.words[0]=0,void(T.length=1);var j=T.words[9];for(C.words[C.length++]=4194303&j,w=10;w<T.length;w++){var A=0|T.words[w];T.words[w-10]=(4194303&A)<<4|j>>>22,j=A}j>>>=22,T.words[w-10]=j,j===0&&T.length>10?T.length-=10:T.length-=9},U.prototype.imulK=function(T){T.words[T.length]=0,T.words[T.length+1]=0,T.length+=2;for(var C=0,S=0;S<T.length;S++){var w=0|T.words[S];C+=977*w,T.words[S]=67108863&C,C=64*w+(C/67108864|0)}return T.words[T.length-1]===0&&(T.length--,T.words[T.length-1]===0&&T.length--),T},u(W,P),u(Y,P),u(q,P),q.prototype.imulK=function(T){for(var C=0,S=0;S<T.length;S++){var w=19*(0|T.words[S])+C,j=67108863&w;w>>>=26,T.words[S]=j,C=w}return C!==0&&(T.words[T.length++]=C),T},o._prime=function(T){if(z[T])return z[T];var C;if(T==="k256")C=new U;else if(T==="p224")C=new W;else if(T==="p192")C=new Y;else{if(T!=="p25519")throw new Error("Unknown prime "+T);C=new q}return z[T]=C,C},M.prototype._verify1=function(T){l(T.negative===0,"red works only with positives"),l(T.red,"red works only with red numbers")},M.prototype._verify2=function(T,C){l((T.negative|C.negative)==0,"red works only with positives"),l(T.red&&T.red===C.red,"red works only with red numbers")},M.prototype.imod=function(T){return this.prime?this.prime.ireduce(T)._forceRed(this):(f(T,T.umod(this.m)._forceRed(this)),T)},M.prototype.neg=function(T){return T.isZero()?T.clone():this.m.sub(T)._forceRed(this)},M.prototype.add=function(T,C){this._verify2(T,C);var S=T.add(C);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},M.prototype.iadd=function(T,C){this._verify2(T,C);var S=T.iadd(C);return S.cmp(this.m)>=0&&S.isub(this.m),S},M.prototype.sub=function(T,C){this._verify2(T,C);var S=T.sub(C);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},M.prototype.isub=function(T,C){this._verify2(T,C);var S=T.isub(C);return S.cmpn(0)<0&&S.iadd(this.m),S},M.prototype.shl=function(T,C){return this._verify1(T),this.imod(T.ushln(C))},M.prototype.imul=function(T,C){return this._verify2(T,C),this.imod(T.imul(C))},M.prototype.mul=function(T,C){return this._verify2(T,C),this.imod(T.mul(C))},M.prototype.isqr=function(T){return this.imul(T,T.clone())},M.prototype.sqr=function(T){return this.mul(T,T)},M.prototype.sqrt=function(T){if(T.isZero())return T.clone();var C=this.m.andln(3);if(l(C%2==1),C===3){var S=this.m.add(new o(1)).iushrn(2);return this.pow(T,S)}for(var w=this.m.subn(1),j=0;!w.isZero()&&w.andln(1)===0;)j++,w.iushrn(1);l(!w.isZero());var A=new o(1).toRed(this),L=A.redNeg(),I=this.m.subn(1).iushrn(1),Z=this.m.bitLength();for(Z=new o(2*Z*Z).toRed(this);this.pow(Z,I).cmp(L)!==0;)Z.redIAdd(L);for(var K=this.pow(Z,w),re=this.pow(T,w.addn(1).iushrn(1)),G=this.pow(T,w),ae=j;G.cmp(A)!==0;){for(var V=G,H=0;V.cmp(A)!==0;H++)V=V.redSqr();l(H<ae);var Q=this.pow(K,new o(1).iushln(ae-H-1));re=re.redMul(Q),K=Q.redSqr(),G=G.redMul(K),ae=H}return re},M.prototype.invm=function(T){var C=T._invmp(this.m);return C.negative!==0?(C.negative=0,this.imod(C).redNeg()):this.imod(C)},M.prototype.pow=function(T,C){if(C.isZero())return new o(1).toRed(this);if(C.cmpn(1)===0)return T.clone();var S=new Array(16);S[0]=new o(1).toRed(this),S[1]=T;for(var w=2;w<S.length;w++)S[w]=this.mul(S[w-1],T);var j=S[0],A=0,L=0,I=C.bitLength()%26;for(I===0&&(I=26),w=C.length-1;w>=0;w--){for(var Z=C.words[w],K=I-1;K>=0;K--){var re=Z>>K&1;j!==S[0]&&(j=this.sqr(j)),re!==0||A!==0?(A<<=1,A|=re,(++L===4||w===0&&K===0)&&(j=this.mul(j,S[A]),L=0,A=0)):L=0}I=26}return j},M.prototype.convertTo=function(T){var C=T.umod(this.m);return C===T?C.clone():C},M.prototype.convertFrom=function(T){var C=T.clone();return C.red=null,C},o.mont=function(T){return new D(T)},u(D,M),D.prototype.convertTo=function(T){return this.imod(T.ushln(this.shift))},D.prototype.convertFrom=function(T){var C=this.imod(T.mul(this.rinv));return C.red=null,C},D.prototype.imul=function(T,C){if(T.isZero()||C.isZero())return T.words[0]=0,T.length=1,T;var S=T.imul(C),w=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=S.isub(w).iushrn(this.shift),A=j;return j.cmp(this.m)>=0?A=j.isub(this.m):j.cmpn(0)<0&&(A=j.iadd(this.m)),A._forceRed(this)},D.prototype.mul=function(T,C){if(T.isZero()||C.isZero())return new o(0)._forceRed(this);var S=T.mul(C),w=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=S.isub(w).iushrn(this.shift),A=j;return j.cmp(this.m)>=0?A=j.isub(this.m):j.cmpn(0)<0&&(A=j.iadd(this.m)),A._forceRed(this)},D.prototype.invm=function(T){return this.imod(T._invmp(this.m).mul(this.r2))._forceRed(this)}})(a===void 0||a)},{buffer:188}],187:[function(e,a,n){var i;function c(u){this.rand=u}if(a.exports=function(u){return i||(i=new c(null)),i.generate(u)},a.exports.Rand=c,c.prototype.generate=function(u){return this._rand(u)},c.prototype._rand=function(u){if(this.rand.getBytes)return this.rand.getBytes(u);for(var o=new Uint8Array(u),d=0;d<o.length;d++)o[d]=this.rand.getByte();return o},typeof self=="object")self.crypto&&self.crypto.getRandomValues?c.prototype._rand=function(u){var o=new Uint8Array(u);return self.crypto.getRandomValues(o),o}:self.msCrypto&&self.msCrypto.getRandomValues?c.prototype._rand=function(u){var o=new Uint8Array(u);return self.msCrypto.getRandomValues(o),o}:typeof window=="object"&&(c.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var l=e("crypto");if(typeof l.randomBytes!="function")throw new Error("Not supported");c.prototype._rand=function(u){return l.randomBytes(u)}}catch{}},{crypto:188}],188:[function(e,a,n){},{}],189:[function(e,a,n){var i=e("safe-buffer").Buffer;function c(p){i.isBuffer(p)||(p=i.from(p));for(var h=p.length/4|0,f=new Array(h),x=0;x<h;x++)f[x]=p.readUInt32BE(4*x);return f}function l(p){for(;0<p.length;p++)p[0]=0}function u(p,h,f,x,b){for(var v,_,N,E,O=f[0],F=f[1],z=f[2],P=f[3],U=p[0]^h[0],W=p[1]^h[1],Y=p[2]^h[2],q=p[3]^h[3],M=4,D=1;D<b;D++)v=O[U>>>24]^F[W>>>16&255]^z[Y>>>8&255]^P[255&q]^h[M++],_=O[W>>>24]^F[Y>>>16&255]^z[q>>>8&255]^P[255&U]^h[M++],N=O[Y>>>24]^F[q>>>16&255]^z[U>>>8&255]^P[255&W]^h[M++],E=O[q>>>24]^F[U>>>16&255]^z[W>>>8&255]^P[255&Y]^h[M++],U=v,W=_,Y=N,q=E;return v=(x[U>>>24]<<24|x[W>>>16&255]<<16|x[Y>>>8&255]<<8|x[255&q])^h[M++],_=(x[W>>>24]<<24|x[Y>>>16&255]<<16|x[q>>>8&255]<<8|x[255&U])^h[M++],N=(x[Y>>>24]<<24|x[q>>>16&255]<<16|x[U>>>8&255]<<8|x[255&W])^h[M++],E=(x[q>>>24]<<24|x[U>>>16&255]<<16|x[W>>>8&255]<<8|x[255&Y])^h[M++],[v>>>=0,_>>>=0,N>>>=0,E>>>=0]}var o=[0,1,2,4,8,16,32,64,128,27,54],d=function(){for(var p=new Array(256),h=0;h<256;h++)p[h]=h<128?h<<1:h<<1^283;for(var f=[],x=[],b=[[],[],[],[]],v=[[],[],[],[]],_=0,N=0,E=0;E<256;++E){var O=N^N<<1^N<<2^N<<3^N<<4;O=O>>>8^255&O^99,f[_]=O,x[O]=_;var F=p[_],z=p[F],P=p[z],U=257*p[O]^16843008*O;b[0][_]=U<<24|U>>>8,b[1][_]=U<<16|U>>>16,b[2][_]=U<<8|U>>>24,b[3][_]=U,U=16843009*P^65537*z^257*F^16843008*_,v[0][O]=U<<24|U>>>8,v[1][O]=U<<16|U>>>16,v[2][O]=U<<8|U>>>24,v[3][O]=U,_===0?_=N=1:(_=F^p[p[p[P^F]]],N^=p[p[N]])}return{SBOX:f,INV_SBOX:x,SUB_MIX:b,INV_SUB_MIX:v}}();function g(p){this._key=c(p),this._reset()}g.blockSize=16,g.keySize=32,g.prototype.blockSize=g.blockSize,g.prototype.keySize=g.keySize,g.prototype._reset=function(){for(var p=this._key,h=p.length,f=h+6,x=4*(f+1),b=[],v=0;v<h;v++)b[v]=p[v];for(v=h;v<x;v++){var _=b[v-1];v%h==0?(_=_<<8|_>>>24,_=d.SBOX[_>>>24]<<24|d.SBOX[_>>>16&255]<<16|d.SBOX[_>>>8&255]<<8|d.SBOX[255&_],_^=o[v/h|0]<<24):h>6&&v%h==4&&(_=d.SBOX[_>>>24]<<24|d.SBOX[_>>>16&255]<<16|d.SBOX[_>>>8&255]<<8|d.SBOX[255&_]),b[v]=b[v-h]^_}for(var N=[],E=0;E<x;E++){var O=x-E,F=b[O-(E%4?0:4)];N[E]=E<4||O<=4?F:d.INV_SUB_MIX[0][d.SBOX[F>>>24]]^d.INV_SUB_MIX[1][d.SBOX[F>>>16&255]]^d.INV_SUB_MIX[2][d.SBOX[F>>>8&255]]^d.INV_SUB_MIX[3][d.SBOX[255&F]]}this._nRounds=f,this._keySchedule=b,this._invKeySchedule=N},g.prototype.encryptBlockRaw=function(p){return u(p=c(p),this._keySchedule,d.SUB_MIX,d.SBOX,this._nRounds)},g.prototype.encryptBlock=function(p){var h=this.encryptBlockRaw(p),f=i.allocUnsafe(16);return f.writeUInt32BE(h[0],0),f.writeUInt32BE(h[1],4),f.writeUInt32BE(h[2],8),f.writeUInt32BE(h[3],12),f},g.prototype.decryptBlock=function(p){var h=(p=c(p))[1];p[1]=p[3],p[3]=h;var f=u(p,this._invKeySchedule,d.INV_SUB_MIX,d.INV_SBOX,this._nRounds),x=i.allocUnsafe(16);return x.writeUInt32BE(f[0],0),x.writeUInt32BE(f[3],4),x.writeUInt32BE(f[2],8),x.writeUInt32BE(f[1],12),x},g.prototype.scrub=function(){l(this._keySchedule),l(this._invKeySchedule),l(this._key)},a.exports.AES=g},{"safe-buffer":494}],190:[function(e,a,n){var i=e("./aes"),c=e("safe-buffer").Buffer,l=e("cipher-base"),u=e("inherits"),o=e("./ghash"),d=e("buffer-xor"),g=e("./incr32");function p(h,f,x,b){l.call(this);var v=c.alloc(4,0);this._cipher=new i.AES(f);var _=this._cipher.encryptBlock(v);this._ghash=new o(_),x=function(N,E,O){if(E.length===12)return N._finID=c.concat([E,c.from([0,0,0,1])]),c.concat([E,c.from([0,0,0,2])]);var F=new o(O),z=E.length,P=z%16;F.update(E),P&&(P=16-P,F.update(c.alloc(P,0))),F.update(c.alloc(8,0));var U=8*z,W=c.alloc(8);W.writeUIntBE(U,0,8),F.update(W),N._finID=F.state;var Y=c.from(N._finID);return g(Y),Y}(this,x,_),this._prev=c.from(x),this._cache=c.allocUnsafe(0),this._secCache=c.allocUnsafe(0),this._decrypt=b,this._alen=0,this._len=0,this._mode=h,this._authTag=null,this._called=!1}u(p,l),p.prototype._update=function(h){if(!this._called&&this._alen){var f=16-this._alen%16;f<16&&(f=c.alloc(f,0),this._ghash.update(f))}this._called=!0;var x=this._mode.encrypt(this,h);return this._decrypt?this._ghash.update(h):this._ghash.update(x),this._len+=h.length,x},p.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var h=d(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(f,x){var b=0;f.length!==x.length&&b++;for(var v=Math.min(f.length,x.length),_=0;_<v;++_)b+=f[_]^x[_];return b}(h,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=h,this._cipher.scrub()},p.prototype.getAuthTag=function(){if(this._decrypt||!c.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},p.prototype.setAuthTag=function(h){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=h},p.prototype.setAAD=function(h){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(h),this._alen+=h.length},a.exports=p},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(e,a,n){var i=e("./encrypter"),c=e("./decrypter"),l=e("./modes/list.json");n.createCipher=n.Cipher=i.createCipher,n.createCipheriv=n.Cipheriv=i.createCipheriv,n.createDecipher=n.Decipher=c.createDecipher,n.createDecipheriv=n.Decipheriv=c.createDecipheriv,n.listCiphers=n.getCiphers=function(){return Object.keys(l)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(e,a,n){var i=e("./authCipher"),c=e("safe-buffer").Buffer,l=e("./modes"),u=e("./streamCipher"),o=e("cipher-base"),d=e("./aes"),g=e("evp_bytestokey");function p(x,b,v){o.call(this),this._cache=new h,this._last=void 0,this._cipher=new d.AES(b),this._prev=c.from(v),this._mode=x,this._autopadding=!0}function h(){this.cache=c.allocUnsafe(0)}function f(x,b,v){var _=l[x.toLowerCase()];if(!_)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=c.from(v)),_.mode!=="GCM"&&v.length!==_.iv)throw new TypeError("invalid iv length "+v.length);if(typeof b=="string"&&(b=c.from(b)),b.length!==_.key/8)throw new TypeError("invalid key length "+b.length);return _.type==="stream"?new u(_.module,b,v,!0):_.type==="auth"?new i(_.module,b,v,!0):new p(_.module,b,v)}e("inherits")(p,o),p.prototype._update=function(x){var b,v;this._cache.add(x);for(var _=[];b=this._cache.get(this._autopadding);)v=this._mode.decrypt(this,b),_.push(v);return c.concat(_)},p.prototype._final=function(){var x=this._cache.flush();if(this._autopadding)return function(b){var v=b[15];if(v<1||v>16)throw new Error("unable to decrypt data");for(var _=-1;++_<v;)if(b[_+(16-v)]!==v)throw new Error("unable to decrypt data");if(v!==16)return b.slice(0,16-v)}(this._mode.decrypt(this,x));if(x)throw new Error("data not multiple of block length")},p.prototype.setAutoPadding=function(x){return this._autopadding=!!x,this},h.prototype.add=function(x){this.cache=c.concat([this.cache,x])},h.prototype.get=function(x){var b;if(x){if(this.cache.length>16)return b=this.cache.slice(0,16),this.cache=this.cache.slice(16),b}else if(this.cache.length>=16)return b=this.cache.slice(0,16),this.cache=this.cache.slice(16),b;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},n.createDecipher=function(x,b){var v=l[x.toLowerCase()];if(!v)throw new TypeError("invalid suite type");var _=g(b,!1,v.key,v.iv);return f(x,_.key,_.iv)},n.createDecipheriv=f},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(e,a,n){var i=e("./modes"),c=e("./authCipher"),l=e("safe-buffer").Buffer,u=e("./streamCipher"),o=e("cipher-base"),d=e("./aes"),g=e("evp_bytestokey");function p(b,v,_){o.call(this),this._cache=new f,this._cipher=new d.AES(v),this._prev=l.from(_),this._mode=b,this._autopadding=!0}e("inherits")(p,o),p.prototype._update=function(b){var v,_;this._cache.add(b);for(var N=[];v=this._cache.get();)_=this._mode.encrypt(this,v),N.push(_);return l.concat(N)};var h=l.alloc(16,16);function f(){this.cache=l.allocUnsafe(0)}function x(b,v,_){var N=i[b.toLowerCase()];if(!N)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=l.from(v)),v.length!==N.key/8)throw new TypeError("invalid key length "+v.length);if(typeof _=="string"&&(_=l.from(_)),N.mode!=="GCM"&&_.length!==N.iv)throw new TypeError("invalid iv length "+_.length);return N.type==="stream"?new u(N.module,v,_):N.type==="auth"?new c(N.module,v,_):new p(N.module,v,_)}p.prototype._final=function(){var b=this._cache.flush();if(this._autopadding)return b=this._mode.encrypt(this,b),this._cipher.scrub(),b;if(!b.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},p.prototype.setAutoPadding=function(b){return this._autopadding=!!b,this},f.prototype.add=function(b){this.cache=l.concat([this.cache,b])},f.prototype.get=function(){if(this.cache.length>15){var b=this.cache.slice(0,16);return this.cache=this.cache.slice(16),b}return null},f.prototype.flush=function(){for(var b=16-this.cache.length,v=l.allocUnsafe(b),_=-1;++_<b;)v.writeUInt8(b,_);return l.concat([this.cache,v])},n.createCipheriv=x,n.createCipher=function(b,v){var _=i[b.toLowerCase()];if(!_)throw new TypeError("invalid suite type");var N=g(v,!1,_.key,_.iv);return x(b,N.key,N.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(e,a,n){var i=e("safe-buffer").Buffer,c=i.alloc(16,0);function l(o){var d=i.allocUnsafe(16);return d.writeUInt32BE(o[0]>>>0,0),d.writeUInt32BE(o[1]>>>0,4),d.writeUInt32BE(o[2]>>>0,8),d.writeUInt32BE(o[3]>>>0,12),d}function u(o){this.h=o,this.state=i.alloc(16,0),this.cache=i.allocUnsafe(0)}u.prototype.ghash=function(o){for(var d=-1;++d<o.length;)this.state[d]^=o[d];this._multiply()},u.prototype._multiply=function(){for(var o,d,g,p=[(o=this.h).readUInt32BE(0),o.readUInt32BE(4),o.readUInt32BE(8),o.readUInt32BE(12)],h=[0,0,0,0],f=-1;++f<128;){for(this.state[~~(f/8)]&1<<7-f%8&&(h[0]^=p[0],h[1]^=p[1],h[2]^=p[2],h[3]^=p[3]),g=(1&p[3])!=0,d=3;d>0;d--)p[d]=p[d]>>>1|(1&p[d-1])<<31;p[0]=p[0]>>>1,g&&(p[0]=p[0]^225<<24)}this.state=l(h)},u.prototype.update=function(o){var d;for(this.cache=i.concat([this.cache,o]);this.cache.length>=16;)d=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(d)},u.prototype.final=function(o,d){return this.cache.length&&this.ghash(i.concat([this.cache,c],16)),this.ghash(l([0,o,0,d])),this.state},a.exports=u},{"safe-buffer":494}],195:[function(e,a,n){a.exports=function(i){for(var c,l=i.length;l--;){if((c=i.readUInt8(l))!==255){c++,i.writeUInt8(c,l);break}i.writeUInt8(0,l)}}},{}],196:[function(e,a,n){var i=e("buffer-xor");n.encrypt=function(c,l){var u=i(l,c._prev);return c._prev=c._cipher.encryptBlock(u),c._prev},n.decrypt=function(c,l){var u=c._prev;c._prev=l;var o=c._cipher.decryptBlock(l);return i(o,u)}},{"buffer-xor":219}],197:[function(e,a,n){var i=e("safe-buffer").Buffer,c=e("buffer-xor");function l(u,o,d){var g=o.length,p=c(o,u._cache);return u._cache=u._cache.slice(g),u._prev=i.concat([u._prev,d?o:p]),p}n.encrypt=function(u,o,d){for(var g,p=i.allocUnsafe(0);o.length;){if(u._cache.length===0&&(u._cache=u._cipher.encryptBlock(u._prev),u._prev=i.allocUnsafe(0)),!(u._cache.length<=o.length)){p=i.concat([p,l(u,o,d)]);break}g=u._cache.length,p=i.concat([p,l(u,o.slice(0,g),d)]),o=o.slice(g)}return p}},{"buffer-xor":219,"safe-buffer":494}],198:[function(e,a,n){var i=e("safe-buffer").Buffer;function c(u,o,d){for(var g,p,h=-1,f=0;++h<8;)g=o&1<<7-h?128:0,f+=(128&(p=u._cipher.encryptBlock(u._prev)[0]^g))>>h%8,u._prev=l(u._prev,d?g:p);return f}function l(u,o){var d=u.length,g=-1,p=i.allocUnsafe(u.length);for(u=i.concat([u,i.from([o])]);++g<d;)p[g]=u[g]<<1|u[g+1]>>7;return p}n.encrypt=function(u,o,d){for(var g=o.length,p=i.allocUnsafe(g),h=-1;++h<g;)p[h]=c(u,o[h],d);return p}},{"safe-buffer":494}],199:[function(e,a,n){var i=e("safe-buffer").Buffer;function c(l,u,o){var d=l._cipher.encryptBlock(l._prev)[0]^u;return l._prev=i.concat([l._prev.slice(1),i.from([o?u:d])]),d}n.encrypt=function(l,u,o){for(var d=u.length,g=i.allocUnsafe(d),p=-1;++p<d;)g[p]=c(l,u[p],o);return g}},{"safe-buffer":494}],200:[function(e,a,n){var i=e("buffer-xor"),c=e("safe-buffer").Buffer,l=e("../incr32");function u(o){var d=o._cipher.encryptBlockRaw(o._prev);return l(o._prev),d}n.encrypt=function(o,d){var g=Math.ceil(d.length/16),p=o._cache.length;o._cache=c.concat([o._cache,c.allocUnsafe(16*g)]);for(var h=0;h<g;h++){var f=u(o),x=p+16*h;o._cache.writeUInt32BE(f[0],x+0),o._cache.writeUInt32BE(f[1],x+4),o._cache.writeUInt32BE(f[2],x+8),o._cache.writeUInt32BE(f[3],x+12)}var b=o._cache.slice(0,d.length);return o._cache=o._cache.slice(d.length),i(d,b)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(e,a,n){n.encrypt=function(i,c){return i._cipher.encryptBlock(c)},n.decrypt=function(i,c){return i._cipher.decryptBlock(c)}},{}],202:[function(e,a,n){var i={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},c=e("./list.json");for(var l in c)c[l].module=i[c[l].mode];a.exports=c},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(e,a,n){a.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(e,a,n){(function(i){(function(){var c=e("buffer-xor");function l(u){return u._prev=u._cipher.encryptBlock(u._prev),u._prev}n.encrypt=function(u,o){for(;u._cache.length<o.length;)u._cache=i.concat([u._cache,l(u)]);var d=u._cache.slice(0,o.length);return u._cache=u._cache.slice(o.length),c(o,d)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(e,a,n){var i=e("./aes"),c=e("safe-buffer").Buffer,l=e("cipher-base");function u(o,d,g,p){l.call(this),this._cipher=new i.AES(d),this._prev=c.from(g),this._cache=c.allocUnsafe(0),this._secCache=c.allocUnsafe(0),this._decrypt=p,this._mode=o}e("inherits")(u,l),u.prototype._update=function(o){return this._mode.encrypt(this,o,this._decrypt)},u.prototype._final=function(){this._cipher.scrub()},a.exports=u},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(e,a,n){var i=e("browserify-des"),c=e("browserify-aes/browser"),l=e("browserify-aes/modes"),u=e("browserify-des/modes"),o=e("evp_bytestokey");function d(p,h,f){if(p=p.toLowerCase(),l[p])return c.createCipheriv(p,h,f);if(u[p])return new i({key:h,iv:f,mode:p});throw new TypeError("invalid suite type")}function g(p,h,f){if(p=p.toLowerCase(),l[p])return c.createDecipheriv(p,h,f);if(u[p])return new i({key:h,iv:f,mode:p,decrypt:!0});throw new TypeError("invalid suite type")}n.createCipher=n.Cipher=function(p,h){var f,x;if(p=p.toLowerCase(),l[p])f=l[p].key,x=l[p].iv;else{if(!u[p])throw new TypeError("invalid suite type");f=8*u[p].key,x=u[p].iv}var b=o(h,!1,f,x);return d(p,b.key,b.iv)},n.createCipheriv=n.Cipheriv=d,n.createDecipher=n.Decipher=function(p,h){var f,x;if(p=p.toLowerCase(),l[p])f=l[p].key,x=l[p].iv;else{if(!u[p])throw new TypeError("invalid suite type");f=8*u[p].key,x=u[p].iv}var b=o(h,!1,f,x);return g(p,b.key,b.iv)},n.createDecipheriv=n.Decipheriv=g,n.listCiphers=n.getCiphers=function(){return Object.keys(u).concat(c.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(e,a,n){var i=e("cipher-base"),c=e("des.js"),l=e("inherits"),u=e("safe-buffer").Buffer,o={"des-ede3-cbc":c.CBC.instantiate(c.EDE),"des-ede3":c.EDE,"des-ede-cbc":c.CBC.instantiate(c.EDE),"des-ede":c.EDE,"des-cbc":c.CBC.instantiate(c.DES),"des-ecb":c.DES};function d(g){i.call(this);var p,h=g.mode.toLowerCase(),f=o[h];p=g.decrypt?"decrypt":"encrypt";var x=g.key;u.isBuffer(x)||(x=u.from(x)),h!=="des-ede"&&h!=="des-ede-cbc"||(x=u.concat([x,x.slice(0,8)]));var b=g.iv;u.isBuffer(b)||(b=u.from(b)),this._des=f.create({key:x,iv:b,type:p})}o.des=o["des-cbc"],o.des3=o["des-ede3-cbc"],a.exports=d,l(d,i),d.prototype._update=function(g){return u.from(this._des.update(g))},d.prototype._final=function(){return u.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(e,a,n){n["des-ecb"]={key:8,iv:0},n["des-cbc"]=n.des={key:8,iv:8},n["des-ede3-cbc"]=n.des3={key:24,iv:8},n["des-ede3"]={key:24,iv:0},n["des-ede-cbc"]={key:16,iv:8},n["des-ede"]={key:16,iv:0}},{}],209:[function(e,a,n){(function(i){(function(){var c=e("bn.js"),l=e("randombytes");function u(d){var g,p=d.modulus.byteLength();do g=new c(l(p));while(g.cmp(d.modulus)>=0||!g.umod(d.prime1)||!g.umod(d.prime2));return g}function o(d,g){var p=function(z){var P=u(z);return{blinder:P.toRed(c.mont(z.modulus)).redPow(new c(z.publicExponent)).fromRed(),unblinder:P.invm(z.modulus)}}(g),h=g.modulus.byteLength(),f=new c(d).mul(p.blinder).umod(g.modulus),x=f.toRed(c.mont(g.prime1)),b=f.toRed(c.mont(g.prime2)),v=g.coefficient,_=g.prime1,N=g.prime2,E=x.redPow(g.exponent1).fromRed(),O=b.redPow(g.exponent2).fromRed(),F=E.isub(O).imul(v).umod(_).imul(N);return O.iadd(F).imul(p.unblinder).umod(g.modulus).toArrayLike(i,"be",h)}o.getr=u,a.exports=o}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(e,a,n){a.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(e,a,n){a.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(e,a,n){a.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(e,a,n){var i=e("safe-buffer").Buffer,c=e("create-hash"),l=e("readable-stream"),u=e("inherits"),o=e("./sign"),d=e("./verify"),g=e("./algorithms.json");function p(b){l.Writable.call(this);var v=g[b];if(!v)throw new Error("Unknown message digest");this._hashType=v.hash,this._hash=c(v.hash),this._tag=v.id,this._signType=v.sign}function h(b){l.Writable.call(this);var v=g[b];if(!v)throw new Error("Unknown message digest");this._hash=c(v.hash),this._tag=v.id,this._signType=v.sign}function f(b){return new p(b)}function x(b){return new h(b)}Object.keys(g).forEach(function(b){g[b].id=i.from(g[b].id,"hex"),g[b.toLowerCase()]=g[b]}),u(p,l.Writable),p.prototype._write=function(b,v,_){this._hash.update(b),_()},p.prototype.update=function(b,v){return typeof b=="string"&&(b=i.from(b,v)),this._hash.update(b),this},p.prototype.sign=function(b,v){this.end();var _=this._hash.digest(),N=o(_,b,this._hashType,this._signType,this._tag);return v?N.toString(v):N},u(h,l.Writable),h.prototype._write=function(b,v,_){this._hash.update(b),_()},h.prototype.update=function(b,v){return typeof b=="string"&&(b=i.from(b,v)),this._hash.update(b),this},h.prototype.verify=function(b,v,_){typeof v=="string"&&(v=i.from(v,_)),this.end();var N=this._hash.digest();return d(v,N,b,this._signType,this._tag)},a.exports={Sign:f,Verify:x,createSign:f,createVerify:x}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(e,a,n){var i=e("safe-buffer").Buffer,c=e("create-hmac"),l=e("browserify-rsa"),u=e("elliptic").ec,o=e("bn.js"),d=e("parse-asn1"),g=e("./curves.json");function p(b,v,_,N){if((b=i.from(b.toArray())).length<v.byteLength()){var E=i.alloc(v.byteLength()-b.length);b=i.concat([E,b])}var O=_.length,F=function(U,W){U=(U=h(U,W)).mod(W);var Y=i.from(U.toArray());if(Y.length<W.byteLength()){var q=i.alloc(W.byteLength()-Y.length);Y=i.concat([q,Y])}return Y}(_,v),z=i.alloc(O);z.fill(1);var P=i.alloc(O);return P=c(N,P).update(z).update(i.from([0])).update(b).update(F).digest(),z=c(N,P).update(z).digest(),{k:P=c(N,P).update(z).update(i.from([1])).update(b).update(F).digest(),v:z=c(N,P).update(z).digest()}}function h(b,v){var _=new o(b),N=(b.length<<3)-v.bitLength();return N>0&&_.ishrn(N),_}function f(b,v,_){var N,E;do{for(N=i.alloc(0);8*N.length<b.bitLength();)v.v=c(_,v.k).update(v.v).digest(),N=i.concat([N,v.v]);E=h(N,b),v.k=c(_,v.k).update(v.v).update(i.from([0])).digest(),v.v=c(_,v.k).update(v.v).digest()}while(E.cmp(b)!==-1);return E}function x(b,v,_,N){return b.toRed(o.mont(_)).redPow(v).fromRed().mod(N)}a.exports=function(b,v,_,N,E){var O=d(v);if(O.curve){if(N!=="ecdsa"&&N!=="ecdsa/rsa")throw new Error("wrong private key type");return function(U,W){var Y=g[W.curve.join(".")];if(!Y)throw new Error("unknown curve "+W.curve.join("."));var q=new u(Y).keyFromPrivate(W.privateKey).sign(U);return i.from(q.toDER())}(b,O)}if(O.type==="dsa"){if(N!=="dsa")throw new Error("wrong private key type");return function(U,W,Y){for(var q,M=W.params.priv_key,D=W.params.p,T=W.params.q,C=W.params.g,S=new o(0),w=h(U,T).mod(T),j=!1,A=p(M,T,U,Y);j===!1;)q=f(T,A,Y),S=x(C,q,D,T),(j=q.invm(T).imul(w.add(M.mul(S))).mod(T)).cmpn(0)===0&&(j=!1,S=new o(0));return function(L,I){L=L.toArray(),I=I.toArray(),128&L[0]&&(L=[0].concat(L)),128&I[0]&&(I=[0].concat(I));var Z=[48,L.length+I.length+4,2,L.length];return Z=Z.concat(L,[2,I.length],I),i.from(Z)}(S,j)}(b,O,_)}if(N!=="rsa"&&N!=="ecdsa/rsa")throw new Error("wrong private key type");b=i.concat([E,b]);for(var F=O.modulus.byteLength(),z=[0,1];b.length+z.length+1<F;)z.push(255);z.push(0);for(var P=-1;++P<b.length;)z.push(b[P]);return l(z,O)},a.exports.getKey=p,a.exports.makeKey=f},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(e,a,n){var i=e("safe-buffer").Buffer,c=e("bn.js"),l=e("elliptic").ec,u=e("parse-asn1"),o=e("./curves.json");function d(g,p){if(g.cmpn(0)<=0)throw new Error("invalid sig");if(g.cmp(p)>=p)throw new Error("invalid sig")}a.exports=function(g,p,h,f,x){var b=u(h);if(b.type==="ec"){if(f!=="ecdsa"&&f!=="ecdsa/rsa")throw new Error("wrong public key type");return function(z,P,U){var W=o[U.data.algorithm.curve.join(".")];if(!W)throw new Error("unknown curve "+U.data.algorithm.curve.join("."));var Y=new l(W),q=U.data.subjectPrivateKey.data;return Y.verify(P,z,q)}(g,p,b)}if(b.type==="dsa"){if(f!=="dsa")throw new Error("wrong public key type");return function(z,P,U){var W=U.data.p,Y=U.data.q,q=U.data.g,M=U.data.pub_key,D=u.signature.decode(z,"der"),T=D.s,C=D.r;d(T,Y),d(C,Y);var S=c.mont(W),w=T.invm(Y);return q.toRed(S).redPow(new c(P).mul(w).mod(Y)).fromRed().mul(M.toRed(S).redPow(C.mul(w).mod(Y)).fromRed()).mod(W).mod(Y).cmp(C)===0}(g,p,b)}if(f!=="rsa"&&f!=="ecdsa/rsa")throw new Error("wrong public key type");p=i.concat([x,p]);for(var v=b.modulus.byteLength(),_=[1],N=0;p.length+_.length+2<v;)_.push(255),N++;_.push(0);for(var E=-1;++E<p.length;)_.push(p[E]);_=i.from(_);var O=c.mont(b.modulus);g=(g=new c(g).toRed(O)).redPow(new c(b.publicExponent)),g=i.from(g.fromRed().toArray());var F=N<8?1:0;for(v=Math.min(g.length,_.length),g.length!==_.length&&(F=1),E=-1;++E<v;)F|=g[E]^_[E];return F===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(e,a,n){},{}],217:[function(e,a,n){var i=e("buffer"),c=i.Buffer;function l(o,d){for(var g in o)d[g]=o[g]}function u(o,d,g){return c(o,d,g)}c.from&&c.alloc&&c.allocUnsafe&&c.allocUnsafeSlow?a.exports=i:(l(i,n),n.Buffer=u),l(c,u),u.from=function(o,d,g){if(typeof o=="number")throw new TypeError("Argument must not be a number");return c(o,d,g)},u.alloc=function(o,d,g){if(typeof o!="number")throw new TypeError("Argument must be a number");var p=c(o);return d!==void 0?typeof g=="string"?p.fill(d,g):p.fill(d):p.fill(0),p},u.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return c(o)},u.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(o)}},{buffer:220}],218:[function(e,a,n){var i=e("safe-buffer").Buffer,c=i.isEncoding||function(b){switch((b=""+b)&&b.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function l(b){var v;switch(this.encoding=function(_){var N=function(E){if(!E)return"utf8";for(var O;;)switch(E){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return E;default:if(O)return;E=(""+E).toLowerCase(),O=!0}}(_);if(typeof N!="string"&&(i.isEncoding===c||!c(_)))throw new Error("Unknown encoding: "+_);return N||_}(b),this.encoding){case"utf16le":this.text=d,this.end=g,v=4;break;case"utf8":this.fillLast=o,v=4;break;case"base64":this.text=p,this.end=h,v=3;break;default:return this.write=f,void(this.end=x)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(v)}function u(b){return b<=127?0:b>>5==6?2:b>>4==14?3:b>>3==30?4:b>>6==2?-1:-2}function o(b){var v=this.lastTotal-this.lastNeed,_=function(N,E,O){if((192&E[0])!=128)return N.lastNeed=0,"";if(N.lastNeed>1&&E.length>1){if((192&E[1])!=128)return N.lastNeed=1,"";if(N.lastNeed>2&&E.length>2&&(192&E[2])!=128)return N.lastNeed=2,""}}(this,b);return _!==void 0?_:this.lastNeed<=b.length?(b.copy(this.lastChar,v,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(b.copy(this.lastChar,v,0,b.length),void(this.lastNeed-=b.length))}function d(b,v){if((b.length-v)%2==0){var _=b.toString("utf16le",v);if(_){var N=_.charCodeAt(_.length-1);if(N>=55296&&N<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1],_.slice(0,-1)}return _}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=b[b.length-1],b.toString("utf16le",v,b.length-1)}function g(b){var v=b&&b.length?this.write(b):"";if(this.lastNeed){var _=this.lastTotal-this.lastNeed;return v+this.lastChar.toString("utf16le",0,_)}return v}function p(b,v){var _=(b.length-v)%3;return _===0?b.toString("base64",v):(this.lastNeed=3-_,this.lastTotal=3,_===1?this.lastChar[0]=b[b.length-1]:(this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1]),b.toString("base64",v,b.length-_))}function h(b){var v=b&&b.length?this.write(b):"";return this.lastNeed?v+this.lastChar.toString("base64",0,3-this.lastNeed):v}function f(b){return b.toString(this.encoding)}function x(b){return b&&b.length?this.write(b):""}n.StringDecoder=l,l.prototype.write=function(b){if(b.length===0)return"";var v,_;if(this.lastNeed){if((v=this.fillLast(b))===void 0)return"";_=this.lastNeed,this.lastNeed=0}else _=0;return _<b.length?v?v+this.text(b,_):this.text(b,_):v||""},l.prototype.end=function(b){var v=b&&b.length?this.write(b):"";return this.lastNeed?v+"":v},l.prototype.text=function(b,v){var _=function(E,O,F){var z=O.length-1;if(z<F)return 0;var P=u(O[z]);return P>=0?(P>0&&(E.lastNeed=P-1),P):--z<F||P===-2?0:(P=u(O[z]))>=0?(P>0&&(E.lastNeed=P-2),P):--z<F||P===-2?0:(P=u(O[z]))>=0?(P>0&&(P===2?P=0:E.lastNeed=P-3),P):0}(this,b,v);if(!this.lastNeed)return b.toString("utf8",v);this.lastTotal=_;var N=b.length-(_-this.lastNeed);return b.copy(this.lastChar,0,N),b.toString("utf8",v,N)},l.prototype.fillLast=function(b){if(this.lastNeed<=b.length)return b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,b.length),this.lastNeed-=b.length}},{"safe-buffer":217}],219:[function(e,a,n){(function(i){(function(){a.exports=function(c,l){for(var u=Math.min(c.length,l.length),o=new i(u),d=0;d<u;++d)o[d]=c[d]^l[d];return o}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],220:[function(e,a,n){(function(i){(function(){var c=e("base64-js"),l=e("ieee754");n.Buffer=o,n.SlowBuffer=function(V){return+V!=V&&(V=0),o.alloc(+V)},n.INSPECT_MAX_BYTES=50;function u(V){if(V>2147483647)throw new RangeError('The value "'+V+'" is invalid for option "size"');var H=new Uint8Array(V);return H.__proto__=o.prototype,H}function o(V,H,Q){if(typeof V=="number"){if(typeof H=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(V)}return d(V,H,Q)}function d(V,H,Q){if(typeof V=="string")return function(le,he){if(typeof he=="string"&&he!==""||(he="utf8"),!o.isEncoding(he))throw new TypeError("Unknown encoding: "+he);var Ne=0|x(le,he),we=u(Ne),ue=we.write(le,he);return ue!==Ne&&(we=we.slice(0,ue)),we}(V,H);if(ArrayBuffer.isView(V))return h(V);if(V==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V);if(G(V,ArrayBuffer)||V&&G(V.buffer,ArrayBuffer))return function(le,he,Ne){if(he<0||le.byteLength<he)throw new RangeError('"offset" is outside of buffer bounds');if(le.byteLength<he+(Ne||0))throw new RangeError('"length" is outside of buffer bounds');var we;return we=he===void 0&&Ne===void 0?new Uint8Array(le):Ne===void 0?new Uint8Array(le,he):new Uint8Array(le,he,Ne),we.__proto__=o.prototype,we}(V,H,Q);if(typeof V=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var oe=V.valueOf&&V.valueOf();if(oe!=null&&oe!==V)return o.from(oe,H,Q);var se=function(le){if(o.isBuffer(le)){var he=0|f(le.length),Ne=u(he);return Ne.length===0||le.copy(Ne,0,0,he),Ne}if(le.length!==void 0)return typeof le.length!="number"||ae(le.length)?u(0):h(le);if(le.type==="Buffer"&&Array.isArray(le.data))return h(le.data)}(V);if(se)return se;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof V[Symbol.toPrimitive]=="function")return o.from(V[Symbol.toPrimitive]("string"),H,Q);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V)}function g(V){if(typeof V!="number")throw new TypeError('"size" argument must be of type number');if(V<0)throw new RangeError('The value "'+V+'" is invalid for option "size"')}function p(V){return g(V),u(V<0?0:0|f(V))}function h(V){for(var H=V.length<0?0:0|f(V.length),Q=u(H),oe=0;oe<H;oe+=1)Q[oe]=255&V[oe];return Q}function f(V){if(V>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|V}function x(V,H){if(o.isBuffer(V))return V.length;if(ArrayBuffer.isView(V)||G(V,ArrayBuffer))return V.byteLength;if(typeof V!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof V);var Q=V.length,oe=arguments.length>2&&arguments[2]===!0;if(!oe&&Q===0)return 0;for(var se=!1;;)switch(H){case"ascii":case"latin1":case"binary":return Q;case"utf8":case"utf-8":return Z(V).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Q;case"hex":return Q>>>1;case"base64":return K(V).length;default:if(se)return oe?-1:Z(V).length;H=(""+H).toLowerCase(),se=!0}}function b(V,H,Q){var oe=!1;if((H===void 0||H<0)&&(H=0),H>this.length||((Q===void 0||Q>this.length)&&(Q=this.length),Q<=0)||(Q>>>=0)<=(H>>>=0))return"";for(V||(V="utf8");;)switch(V){case"hex":return D(this,H,Q);case"utf8":case"utf-8":return Y(this,H,Q);case"ascii":return q(this,H,Q);case"latin1":case"binary":return M(this,H,Q);case"base64":return W(this,H,Q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,H,Q);default:if(oe)throw new TypeError("Unknown encoding: "+V);V=(V+"").toLowerCase(),oe=!0}}function v(V,H,Q){var oe=V[H];V[H]=V[Q],V[Q]=oe}function _(V,H,Q,oe,se){if(V.length===0)return-1;if(typeof Q=="string"?(oe=Q,Q=0):Q>2147483647?Q=2147483647:Q<-2147483648&&(Q=-2147483648),ae(Q=+Q)&&(Q=se?0:V.length-1),Q<0&&(Q=V.length+Q),Q>=V.length){if(se)return-1;Q=V.length-1}else if(Q<0){if(!se)return-1;Q=0}if(typeof H=="string"&&(H=o.from(H,oe)),o.isBuffer(H))return H.length===0?-1:N(V,H,Q,oe,se);if(typeof H=="number")return H&=255,typeof Uint8Array.prototype.indexOf=="function"?se?Uint8Array.prototype.indexOf.call(V,H,Q):Uint8Array.prototype.lastIndexOf.call(V,H,Q):N(V,[H],Q,oe,se);throw new TypeError("val must be string, number or Buffer")}function N(V,H,Q,oe,se){var le,he=1,Ne=V.length,we=H.length;if(oe!==void 0&&((oe=String(oe).toLowerCase())==="ucs2"||oe==="ucs-2"||oe==="utf16le"||oe==="utf-16le")){if(V.length<2||H.length<2)return-1;he=2,Ne/=2,we/=2,Q/=2}function ue(Oe,je){return he===1?Oe[je]:Oe.readUInt16BE(je*he)}if(se){var Se=-1;for(le=Q;le<Ne;le++)if(ue(V,le)===ue(H,Se===-1?0:le-Se)){if(Se===-1&&(Se=le),le-Se+1===we)return Se*he}else Se!==-1&&(le-=le-Se),Se=-1}else for(Q+we>Ne&&(Q=Ne-we),le=Q;le>=0;le--){for(var ke=!0,Me=0;Me<we;Me++)if(ue(V,le+Me)!==ue(H,Me)){ke=!1;break}if(ke)return le}return-1}function E(V,H,Q,oe){Q=Number(Q)||0;var se=V.length-Q;oe?(oe=Number(oe))>se&&(oe=se):oe=se;var le=H.length;oe>le/2&&(oe=le/2);for(var he=0;he<oe;++he){var Ne=parseInt(H.substr(2*he,2),16);if(ae(Ne))return he;V[Q+he]=Ne}return he}function O(V,H,Q,oe){return re(Z(H,V.length-Q),V,Q,oe)}function F(V,H,Q,oe){return re(function(se){for(var le=[],he=0;he<se.length;++he)le.push(255&se.charCodeAt(he));return le}(H),V,Q,oe)}function z(V,H,Q,oe){return F(V,H,Q,oe)}function P(V,H,Q,oe){return re(K(H),V,Q,oe)}function U(V,H,Q,oe){return re(function(se,le){for(var he,Ne,we,ue=[],Se=0;Se<se.length&&!((le-=2)<0);++Se)he=se.charCodeAt(Se),Ne=he>>8,we=he%256,ue.push(we),ue.push(Ne);return ue}(H,V.length-Q),V,Q,oe)}function W(V,H,Q){return H===0&&Q===V.length?c.fromByteArray(V):c.fromByteArray(V.slice(H,Q))}function Y(V,H,Q){Q=Math.min(V.length,Q);for(var oe=[],se=H;se<Q;){var le,he,Ne,we,ue=V[se],Se=null,ke=ue>239?4:ue>223?3:ue>191?2:1;if(se+ke<=Q)switch(ke){case 1:ue<128&&(Se=ue);break;case 2:(192&(le=V[se+1]))==128&&(we=(31&ue)<<6|63&le)>127&&(Se=we);break;case 3:le=V[se+1],he=V[se+2],(192&le)==128&&(192&he)==128&&(we=(15&ue)<<12|(63&le)<<6|63&he)>2047&&(we<55296||we>57343)&&(Se=we);break;case 4:le=V[se+1],he=V[se+2],Ne=V[se+3],(192&le)==128&&(192&he)==128&&(192&Ne)==128&&(we=(15&ue)<<18|(63&le)<<12|(63&he)<<6|63&Ne)>65535&&we<1114112&&(Se=we)}Se===null?(Se=65533,ke=1):Se>65535&&(Se-=65536,oe.push(Se>>>10&1023|55296),Se=56320|1023&Se),oe.push(Se),se+=ke}return function(Me){var Oe=Me.length;if(Oe<=4096)return String.fromCharCode.apply(String,Me);for(var je="",Ie=0;Ie<Oe;)je+=String.fromCharCode.apply(String,Me.slice(Ie,Ie+=4096));return je}(oe)}n.kMaxLength=2147483647,o.TYPED_ARRAY_SUPPORT=function(){try{var V=new Uint8Array(1);return V.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},V.foo()===42}catch{return!1}}(),o.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(V,H,Q){return d(V,H,Q)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(V,H,Q){return function(oe,se,le){return g(oe),oe<=0?u(oe):se!==void 0?typeof le=="string"?u(oe).fill(se,le):u(oe).fill(se):u(oe)}(V,H,Q)},o.allocUnsafe=function(V){return p(V)},o.allocUnsafeSlow=function(V){return p(V)},o.isBuffer=function(V){return V!=null&&V._isBuffer===!0&&V!==o.prototype},o.compare=function(V,H){if(G(V,Uint8Array)&&(V=o.from(V,V.offset,V.byteLength)),G(H,Uint8Array)&&(H=o.from(H,H.offset,H.byteLength)),!o.isBuffer(V)||!o.isBuffer(H))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(V===H)return 0;for(var Q=V.length,oe=H.length,se=0,le=Math.min(Q,oe);se<le;++se)if(V[se]!==H[se]){Q=V[se],oe=H[se];break}return Q<oe?-1:oe<Q?1:0},o.isEncoding=function(V){switch(String(V).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(V,H){if(!Array.isArray(V))throw new TypeError('"list" argument must be an Array of Buffers');if(V.length===0)return o.alloc(0);var Q;if(H===void 0)for(H=0,Q=0;Q<V.length;++Q)H+=V[Q].length;var oe=o.allocUnsafe(H),se=0;for(Q=0;Q<V.length;++Q){var le=V[Q];if(G(le,Uint8Array)&&(le=o.from(le)),!o.isBuffer(le))throw new TypeError('"list" argument must be an Array of Buffers');le.copy(oe,se),se+=le.length}return oe},o.byteLength=x,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var V=this.length;if(V%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var H=0;H<V;H+=2)v(this,H,H+1);return this},o.prototype.swap32=function(){var V=this.length;if(V%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var H=0;H<V;H+=4)v(this,H,H+3),v(this,H+1,H+2);return this},o.prototype.swap64=function(){var V=this.length;if(V%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var H=0;H<V;H+=8)v(this,H,H+7),v(this,H+1,H+6),v(this,H+2,H+5),v(this,H+3,H+4);return this},o.prototype.toString=function(){var V=this.length;return V===0?"":arguments.length===0?Y(this,0,V):b.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(V){if(!o.isBuffer(V))throw new TypeError("Argument must be a Buffer");return this===V||o.compare(this,V)===0},o.prototype.inspect=function(){var V="",H=n.INSPECT_MAX_BYTES;return V=this.toString("hex",0,H).replace(/(.{2})/g,"$1 ").trim(),this.length>H&&(V+=" ... "),"<Buffer "+V+">"},o.prototype.compare=function(V,H,Q,oe,se){if(G(V,Uint8Array)&&(V=o.from(V,V.offset,V.byteLength)),!o.isBuffer(V))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof V);if(H===void 0&&(H=0),Q===void 0&&(Q=V?V.length:0),oe===void 0&&(oe=0),se===void 0&&(se=this.length),H<0||Q>V.length||oe<0||se>this.length)throw new RangeError("out of range index");if(oe>=se&&H>=Q)return 0;if(oe>=se)return-1;if(H>=Q)return 1;if(this===V)return 0;for(var le=(se>>>=0)-(oe>>>=0),he=(Q>>>=0)-(H>>>=0),Ne=Math.min(le,he),we=this.slice(oe,se),ue=V.slice(H,Q),Se=0;Se<Ne;++Se)if(we[Se]!==ue[Se]){le=we[Se],he=ue[Se];break}return le<he?-1:he<le?1:0},o.prototype.includes=function(V,H,Q){return this.indexOf(V,H,Q)!==-1},o.prototype.indexOf=function(V,H,Q){return _(this,V,H,Q,!0)},o.prototype.lastIndexOf=function(V,H,Q){return _(this,V,H,Q,!1)},o.prototype.write=function(V,H,Q,oe){if(H===void 0)oe="utf8",Q=this.length,H=0;else if(Q===void 0&&typeof H=="string")oe=H,Q=this.length,H=0;else{if(!isFinite(H))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");H>>>=0,isFinite(Q)?(Q>>>=0,oe===void 0&&(oe="utf8")):(oe=Q,Q=void 0)}var se=this.length-H;if((Q===void 0||Q>se)&&(Q=se),V.length>0&&(Q<0||H<0)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");oe||(oe="utf8");for(var le=!1;;)switch(oe){case"hex":return E(this,V,H,Q);case"utf8":case"utf-8":return O(this,V,H,Q);case"ascii":return F(this,V,H,Q);case"latin1":case"binary":return z(this,V,H,Q);case"base64":return P(this,V,H,Q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,V,H,Q);default:if(le)throw new TypeError("Unknown encoding: "+oe);oe=(""+oe).toLowerCase(),le=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(V,H,Q){var oe="";Q=Math.min(V.length,Q);for(var se=H;se<Q;++se)oe+=String.fromCharCode(127&V[se]);return oe}function M(V,H,Q){var oe="";Q=Math.min(V.length,Q);for(var se=H;se<Q;++se)oe+=String.fromCharCode(V[se]);return oe}function D(V,H,Q){var oe=V.length;(!H||H<0)&&(H=0),(!Q||Q<0||Q>oe)&&(Q=oe);for(var se="",le=H;le<Q;++le)se+=I(V[le]);return se}function T(V,H,Q){for(var oe=V.slice(H,Q),se="",le=0;le<oe.length;le+=2)se+=String.fromCharCode(oe[le]+256*oe[le+1]);return se}function C(V,H,Q){if(V%1!=0||V<0)throw new RangeError("offset is not uint");if(V+H>Q)throw new RangeError("Trying to access beyond buffer length")}function S(V,H,Q,oe,se,le){if(!o.isBuffer(V))throw new TypeError('"buffer" argument must be a Buffer instance');if(H>se||H<le)throw new RangeError('"value" argument is out of bounds');if(Q+oe>V.length)throw new RangeError("Index out of range")}function w(V,H,Q,oe,se,le){if(Q+oe>V.length)throw new RangeError("Index out of range");if(Q<0)throw new RangeError("Index out of range")}function j(V,H,Q,oe,se){return H=+H,Q>>>=0,se||w(V,0,Q,4),l.write(V,H,Q,oe,23,4),Q+4}function A(V,H,Q,oe,se){return H=+H,Q>>>=0,se||w(V,0,Q,8),l.write(V,H,Q,oe,52,8),Q+8}o.prototype.slice=function(V,H){var Q=this.length;(V=~~V)<0?(V+=Q)<0&&(V=0):V>Q&&(V=Q),(H=H===void 0?Q:~~H)<0?(H+=Q)<0&&(H=0):H>Q&&(H=Q),H<V&&(H=V);var oe=this.subarray(V,H);return oe.__proto__=o.prototype,oe},o.prototype.readUIntLE=function(V,H,Q){V>>>=0,H>>>=0,Q||C(V,H,this.length);for(var oe=this[V],se=1,le=0;++le<H&&(se*=256);)oe+=this[V+le]*se;return oe},o.prototype.readUIntBE=function(V,H,Q){V>>>=0,H>>>=0,Q||C(V,H,this.length);for(var oe=this[V+--H],se=1;H>0&&(se*=256);)oe+=this[V+--H]*se;return oe},o.prototype.readUInt8=function(V,H){return V>>>=0,H||C(V,1,this.length),this[V]},o.prototype.readUInt16LE=function(V,H){return V>>>=0,H||C(V,2,this.length),this[V]|this[V+1]<<8},o.prototype.readUInt16BE=function(V,H){return V>>>=0,H||C(V,2,this.length),this[V]<<8|this[V+1]},o.prototype.readUInt32LE=function(V,H){return V>>>=0,H||C(V,4,this.length),(this[V]|this[V+1]<<8|this[V+2]<<16)+16777216*this[V+3]},o.prototype.readUInt32BE=function(V,H){return V>>>=0,H||C(V,4,this.length),16777216*this[V]+(this[V+1]<<16|this[V+2]<<8|this[V+3])},o.prototype.readIntLE=function(V,H,Q){V>>>=0,H>>>=0,Q||C(V,H,this.length);for(var oe=this[V],se=1,le=0;++le<H&&(se*=256);)oe+=this[V+le]*se;return oe>=(se*=128)&&(oe-=Math.pow(2,8*H)),oe},o.prototype.readIntBE=function(V,H,Q){V>>>=0,H>>>=0,Q||C(V,H,this.length);for(var oe=H,se=1,le=this[V+--oe];oe>0&&(se*=256);)le+=this[V+--oe]*se;return le>=(se*=128)&&(le-=Math.pow(2,8*H)),le},o.prototype.readInt8=function(V,H){return V>>>=0,H||C(V,1,this.length),128&this[V]?-1*(255-this[V]+1):this[V]},o.prototype.readInt16LE=function(V,H){V>>>=0,H||C(V,2,this.length);var Q=this[V]|this[V+1]<<8;return 32768&Q?4294901760|Q:Q},o.prototype.readInt16BE=function(V,H){V>>>=0,H||C(V,2,this.length);var Q=this[V+1]|this[V]<<8;return 32768&Q?4294901760|Q:Q},o.prototype.readInt32LE=function(V,H){return V>>>=0,H||C(V,4,this.length),this[V]|this[V+1]<<8|this[V+2]<<16|this[V+3]<<24},o.prototype.readInt32BE=function(V,H){return V>>>=0,H||C(V,4,this.length),this[V]<<24|this[V+1]<<16|this[V+2]<<8|this[V+3]},o.prototype.readFloatLE=function(V,H){return V>>>=0,H||C(V,4,this.length),l.read(this,V,!0,23,4)},o.prototype.readFloatBE=function(V,H){return V>>>=0,H||C(V,4,this.length),l.read(this,V,!1,23,4)},o.prototype.readDoubleLE=function(V,H){return V>>>=0,H||C(V,8,this.length),l.read(this,V,!0,52,8)},o.prototype.readDoubleBE=function(V,H){return V>>>=0,H||C(V,8,this.length),l.read(this,V,!1,52,8)},o.prototype.writeUIntLE=function(V,H,Q,oe){V=+V,H>>>=0,Q>>>=0,oe||S(this,V,H,Q,Math.pow(2,8*Q)-1,0);var se=1,le=0;for(this[H]=255&V;++le<Q&&(se*=256);)this[H+le]=V/se&255;return H+Q},o.prototype.writeUIntBE=function(V,H,Q,oe){V=+V,H>>>=0,Q>>>=0,oe||S(this,V,H,Q,Math.pow(2,8*Q)-1,0);var se=Q-1,le=1;for(this[H+se]=255&V;--se>=0&&(le*=256);)this[H+se]=V/le&255;return H+Q},o.prototype.writeUInt8=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,1,255,0),this[H]=255&V,H+1},o.prototype.writeUInt16LE=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,2,65535,0),this[H]=255&V,this[H+1]=V>>>8,H+2},o.prototype.writeUInt16BE=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,2,65535,0),this[H]=V>>>8,this[H+1]=255&V,H+2},o.prototype.writeUInt32LE=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,4,4294967295,0),this[H+3]=V>>>24,this[H+2]=V>>>16,this[H+1]=V>>>8,this[H]=255&V,H+4},o.prototype.writeUInt32BE=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,4,4294967295,0),this[H]=V>>>24,this[H+1]=V>>>16,this[H+2]=V>>>8,this[H+3]=255&V,H+4},o.prototype.writeIntLE=function(V,H,Q,oe){if(V=+V,H>>>=0,!oe){var se=Math.pow(2,8*Q-1);S(this,V,H,Q,se-1,-se)}var le=0,he=1,Ne=0;for(this[H]=255&V;++le<Q&&(he*=256);)V<0&&Ne===0&&this[H+le-1]!==0&&(Ne=1),this[H+le]=(V/he>>0)-Ne&255;return H+Q},o.prototype.writeIntBE=function(V,H,Q,oe){if(V=+V,H>>>=0,!oe){var se=Math.pow(2,8*Q-1);S(this,V,H,Q,se-1,-se)}var le=Q-1,he=1,Ne=0;for(this[H+le]=255&V;--le>=0&&(he*=256);)V<0&&Ne===0&&this[H+le+1]!==0&&(Ne=1),this[H+le]=(V/he>>0)-Ne&255;return H+Q},o.prototype.writeInt8=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,1,127,-128),V<0&&(V=255+V+1),this[H]=255&V,H+1},o.prototype.writeInt16LE=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,2,32767,-32768),this[H]=255&V,this[H+1]=V>>>8,H+2},o.prototype.writeInt16BE=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,2,32767,-32768),this[H]=V>>>8,this[H+1]=255&V,H+2},o.prototype.writeInt32LE=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,4,2147483647,-2147483648),this[H]=255&V,this[H+1]=V>>>8,this[H+2]=V>>>16,this[H+3]=V>>>24,H+4},o.prototype.writeInt32BE=function(V,H,Q){return V=+V,H>>>=0,Q||S(this,V,H,4,2147483647,-2147483648),V<0&&(V=4294967295+V+1),this[H]=V>>>24,this[H+1]=V>>>16,this[H+2]=V>>>8,this[H+3]=255&V,H+4},o.prototype.writeFloatLE=function(V,H,Q){return j(this,V,H,!0,Q)},o.prototype.writeFloatBE=function(V,H,Q){return j(this,V,H,!1,Q)},o.prototype.writeDoubleLE=function(V,H,Q){return A(this,V,H,!0,Q)},o.prototype.writeDoubleBE=function(V,H,Q){return A(this,V,H,!1,Q)},o.prototype.copy=function(V,H,Q,oe){if(!o.isBuffer(V))throw new TypeError("argument should be a Buffer");if(Q||(Q=0),oe||oe===0||(oe=this.length),H>=V.length&&(H=V.length),H||(H=0),oe>0&&oe<Q&&(oe=Q),oe===Q||V.length===0||this.length===0)return 0;if(H<0)throw new RangeError("targetStart out of bounds");if(Q<0||Q>=this.length)throw new RangeError("Index out of range");if(oe<0)throw new RangeError("sourceEnd out of bounds");oe>this.length&&(oe=this.length),V.length-H<oe-Q&&(oe=V.length-H+Q);var se=oe-Q;if(this===V&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(H,Q,oe);else if(this===V&&Q<H&&H<oe)for(var le=se-1;le>=0;--le)V[le+H]=this[le+Q];else Uint8Array.prototype.set.call(V,this.subarray(Q,oe),H);return se},o.prototype.fill=function(V,H,Q,oe){if(typeof V=="string"){if(typeof H=="string"?(oe=H,H=0,Q=this.length):typeof Q=="string"&&(oe=Q,Q=this.length),oe!==void 0&&typeof oe!="string")throw new TypeError("encoding must be a string");if(typeof oe=="string"&&!o.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);if(V.length===1){var se=V.charCodeAt(0);(oe==="utf8"&&se<128||oe==="latin1")&&(V=se)}}else typeof V=="number"&&(V&=255);if(H<0||this.length<H||this.length<Q)throw new RangeError("Out of range index");if(Q<=H)return this;var le;if(H>>>=0,Q=Q===void 0?this.length:Q>>>0,V||(V=0),typeof V=="number")for(le=H;le<Q;++le)this[le]=V;else{var he=o.isBuffer(V)?V:o.from(V,oe),Ne=he.length;if(Ne===0)throw new TypeError('The value "'+V+'" is invalid for argument "value"');for(le=0;le<Q-H;++le)this[le+H]=he[le%Ne]}return this};var L=/[^+/0-9A-Za-z-_]/g;function I(V){return V<16?"0"+V.toString(16):V.toString(16)}function Z(V,H){var Q;H=H||1/0;for(var oe=V.length,se=null,le=[],he=0;he<oe;++he){if((Q=V.charCodeAt(he))>55295&&Q<57344){if(!se){if(Q>56319){(H-=3)>-1&&le.push(239,191,189);continue}if(he+1===oe){(H-=3)>-1&&le.push(239,191,189);continue}se=Q;continue}if(Q<56320){(H-=3)>-1&&le.push(239,191,189),se=Q;continue}Q=65536+(se-55296<<10|Q-56320)}else se&&(H-=3)>-1&&le.push(239,191,189);if(se=null,Q<128){if((H-=1)<0)break;le.push(Q)}else if(Q<2048){if((H-=2)<0)break;le.push(Q>>6|192,63&Q|128)}else if(Q<65536){if((H-=3)<0)break;le.push(Q>>12|224,Q>>6&63|128,63&Q|128)}else{if(!(Q<1114112))throw new Error("Invalid code point");if((H-=4)<0)break;le.push(Q>>18|240,Q>>12&63|128,Q>>6&63|128,63&Q|128)}}return le}function K(V){return c.toByteArray(function(H){if((H=(H=H.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;H.length%4!=0;)H+="=";return H}(V))}function re(V,H,Q,oe){for(var se=0;se<oe&&!(se+Q>=H.length||se>=V.length);++se)H[se+Q]=V[se];return se}function G(V,H){return V instanceof H||V!=null&&V.constructor!=null&&V.constructor.name!=null&&V.constructor.name===H.name}function ae(V){return V!=V}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(e,a,n){var i=e("safe-buffer").Buffer,c=e("stream").Transform,l=e("string_decoder").StringDecoder;function u(o){c.call(this),this.hashMode=typeof o=="string",this.hashMode?this[o]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(u,c),u.prototype.update=function(o,d,g){typeof o=="string"&&(o=i.from(o,d));var p=this._update(o);return this.hashMode?this:(g&&(p=this._toString(p,g)),p)},u.prototype.setAutoPadding=function(){},u.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},u.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},u.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},u.prototype._transform=function(o,d,g){var p;try{this.hashMode?this._update(o):this.push(this._update(o))}catch(h){p=h}finally{g(p)}},u.prototype._flush=function(o){var d;try{this.push(this.__final())}catch(g){d=g}o(d)},u.prototype._finalOrDigest=function(o){var d=this.__final()||i.alloc(0);return o&&(d=this._toString(d,o,!0)),d},u.prototype._toString=function(o,d,g){if(this._decoder||(this._decoder=new l(d),this._encoding=d),this._encoding!==d)throw new Error("can't switch encodings");var p=this._decoder.write(o);return g&&(p+=this._decoder.end()),p},a.exports=u},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(e,a,n){var i=e("../internals/is-callable"),c=e("../internals/try-to-string"),l=TypeError;a.exports=function(u){if(i(u))return u;throw new l(c(u)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(e,a,n){var i=e("../internals/is-constructor"),c=e("../internals/try-to-string"),l=TypeError;a.exports=function(u){if(i(u))return u;throw new l(c(u)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(e,a,n){var i=e("../internals/is-callable"),c=String,l=TypeError;a.exports=function(u){if(typeof u=="object"||i(u))return u;throw new l("Can't set "+c(u)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(e,a,n){var i=e("../internals/well-known-symbol"),c=e("../internals/object-create"),l=e("../internals/object-define-property").f,u=i("unscopables"),o=Array.prototype;o[u]===void 0&&l(o,u,{configurable:!0,value:c(null)}),a.exports=function(d){o[u][d]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(e,a,n){var i=e("../internals/object-is-prototype-of"),c=TypeError;a.exports=function(l,u){if(i(u,l))return l;throw new c("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(e,a,n){var i=e("../internals/is-object"),c=String,l=TypeError;a.exports=function(u){if(i(u))return u;throw new l(c(u)+" is not an object")}},{"../internals/is-object":289}],228:[function(e,a,n){var i=e("../internals/to-indexed-object"),c=e("../internals/to-absolute-index"),l=e("../internals/length-of-array-like"),u=function(o){return function(d,g,p){var h,f=i(d),x=l(f),b=c(p,x);if(o&&g!=g){for(;x>b;)if((h=f[b++])!=h)return!0}else for(;x>b;b++)if((o||b in f)&&f[b]===g)return o||b||0;return!o&&-1}};a.exports={includes:u(!0),indexOf:u(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(e,a,n){var i=e("../internals/function-bind-context"),c=e("../internals/function-uncurry-this"),l=e("../internals/indexed-object"),u=e("../internals/to-object"),o=e("../internals/length-of-array-like"),d=e("../internals/array-species-create"),g=c([].push),p=function(h){var f=h===1,x=h===2,b=h===3,v=h===4,_=h===6,N=h===7,E=h===5||_;return function(O,F,z,P){for(var U,W,Y=u(O),q=l(Y),M=i(F,z),D=o(q),T=0,C=P||d,S=f?C(O,D):x||N?C(O,0):void 0;D>T;T++)if((E||T in q)&&(W=M(U=q[T],T,Y),h))if(f)S[T]=W;else if(W)switch(h){case 3:return!0;case 5:return U;case 6:return T;case 2:g(S,U)}else switch(h){case 4:return!1;case 7:g(S,U)}return _?-1:b||v?v:S}};a.exports={forEach:p(0),map:p(1),filter:p(2),some:p(3),every:p(4),find:p(5),findIndex:p(6),filterReject:p(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(e,a,n){var i=e("../internals/to-absolute-index"),c=e("../internals/length-of-array-like"),l=e("../internals/create-property"),u=Array,o=Math.max;a.exports=function(d,g,p){for(var h=c(d),f=i(g,h),x=i(p===void 0?h:p,h),b=u(o(x-f,0)),v=0;f<x;f++,v++)l(b,v,d[f]);return b.length=v,b}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(e,a,n){var i=e("../internals/function-uncurry-this");a.exports=i([].slice)},{"../internals/function-uncurry-this":268}],232:[function(e,a,n){var i=e("../internals/is-array"),c=e("../internals/is-constructor"),l=e("../internals/is-object"),u=e("../internals/well-known-symbol")("species"),o=Array;a.exports=function(d){var g;return i(d)&&(g=d.constructor,(c(g)&&(g===o||i(g.prototype))||l(g)&&(g=g[u])===null)&&(g=void 0)),g===void 0?o:g}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(e,a,n){var i=e("../internals/array-species-constructor");a.exports=function(c,l){return new(i(c))(l===0?0:l)}},{"../internals/array-species-constructor":232}],234:[function(e,a,n){var i=e("../internals/well-known-symbol")("iterator"),c=!1;try{var l=0,u={next:function(){return{done:!!l++}},return:function(){c=!0}};u[i]=function(){return this},Array.from(u,function(){throw 2})}catch{}a.exports=function(o,d){try{if(!d&&!c)return!1}catch{return!1}var g=!1;try{var p={};p[i]=function(){return{next:function(){return{done:g=!0}}}},o(p)}catch{}return g}},{"../internals/well-known-symbol":357}],235:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=i({}.toString),l=i("".slice);a.exports=function(u){return l(c(u),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(e,a,n){var i=e("../internals/to-string-tag-support"),c=e("../internals/is-callable"),l=e("../internals/classof-raw"),u=e("../internals/well-known-symbol")("toStringTag"),o=Object,d=l(function(){return arguments}())==="Arguments";a.exports=i?l:function(g){var p,h,f;return g===void 0?"Undefined":g===null?"Null":typeof(h=function(x,b){try{return x[b]}catch{}}(p=o(g),u))=="string"?h:d?l(p):(f=l(p))==="Object"&&c(p.callee)?"Arguments":f}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(e,a,n){var i=e("../internals/has-own-property"),c=e("../internals/own-keys"),l=e("../internals/object-get-own-property-descriptor"),u=e("../internals/object-define-property");a.exports=function(o,d,g){for(var p=c(d),h=u.f,f=l.f,x=0;x<p.length;x++){var b=p[x];i(o,b)||g&&i(g,b)||h(o,b,f(d,b))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(e,a,n){var i=e("../internals/well-known-symbol")("match");a.exports=function(c){var l=/./;try{"/./"[c](l)}catch{try{return l[i]=!1,"/./"[c](l)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(e,a,n){var i=e("../internals/fails");a.exports=!i(function(){function c(){}return c.prototype.constructor=null,Object.getPrototypeOf(new c)!==c.prototype})},{"../internals/fails":260}],240:[function(e,a,n){a.exports=function(i,c){return{value:i,done:c}}},{}],241:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/object-define-property"),l=e("../internals/create-property-descriptor");a.exports=i?function(u,o,d){return c.f(u,o,l(1,d))}:function(u,o,d){return u[o]=d,u}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(e,a,n){a.exports=function(i,c){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:c}}},{}],243:[function(e,a,n){var i=e("../internals/to-property-key"),c=e("../internals/object-define-property"),l=e("../internals/create-property-descriptor");a.exports=function(u,o,d){var g=i(o);g in u?c.f(u,g,l(0,d)):u[g]=d}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(e,a,n){var i=e("../internals/make-built-in"),c=e("../internals/object-define-property");a.exports=function(l,u,o){return o.get&&i(o.get,u,{getter:!0}),o.set&&i(o.set,u,{setter:!0}),c.f(l,u,o)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(e,a,n){var i=e("../internals/is-callable"),c=e("../internals/object-define-property"),l=e("../internals/make-built-in"),u=e("../internals/define-global-property");a.exports=function(o,d,g,p){p||(p={});var h=p.enumerable,f=p.name!==void 0?p.name:d;if(i(g)&&l(g,f,p),p.global)h?o[d]=g:u(d,g);else{try{p.unsafe?o[d]&&(h=!0):delete o[d]}catch{}h?o[d]=g:c.f(o,d,{value:g,enumerable:!1,configurable:!p.nonConfigurable,writable:!p.nonWritable})}return o}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(e,a,n){var i=e("../internals/global"),c=Object.defineProperty;a.exports=function(l,u){try{c(i,l,{value:u,configurable:!0,writable:!0})}catch{i[l]=u}return u}},{"../internals/global":274}],247:[function(e,a,n){var i=e("../internals/fails");a.exports=!i(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(e,a,n){var i=typeof document=="object"&&document.all,c=i===void 0&&i!==void 0;a.exports={all:i,IS_HTMLDDA:c}},{}],249:[function(e,a,n){var i=e("../internals/global"),c=e("../internals/is-object"),l=i.document,u=c(l)&&c(l.createElement);a.exports=function(o){return u?l.createElement(o):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(e,a,n){var i=e("../internals/engine-is-deno"),c=e("../internals/engine-is-node");a.exports=!i&&!c&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(e,a,n){a.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(e,a,n){var i=e("../internals/engine-user-agent");a.exports=/ipad|iphone|ipod/i.test(i)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(e,a,n){var i=e("../internals/engine-user-agent");a.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},{"../internals/engine-user-agent":256}],254:[function(e,a,n){var i=e("../internals/global"),c=e("../internals/classof-raw");a.exports=c(i.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(e,a,n){var i=e("../internals/engine-user-agent");a.exports=/web0s(?!.*chrome)/i.test(i)},{"../internals/engine-user-agent":256}],256:[function(e,a,n){a.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(e,a,n){var i,c,l=e("../internals/global"),u=e("../internals/engine-user-agent"),o=l.process,d=l.Deno,g=o&&o.versions||d&&d.version,p=g&&g.v8;p&&(c=(i=p.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!c&&u&&(!(i=u.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=u.match(/Chrome\/(\d+)/))&&(c=+i[1]),a.exports=c},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(e,a,n){a.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(e,a,n){var i=e("../internals/global"),c=e("../internals/object-get-own-property-descriptor").f,l=e("../internals/create-non-enumerable-property"),u=e("../internals/define-built-in"),o=e("../internals/define-global-property"),d=e("../internals/copy-constructor-properties"),g=e("../internals/is-forced");a.exports=function(p,h){var f,x,b,v,_,N=p.target,E=p.global,O=p.stat;if(f=E?i:O?i[N]||o(N,{}):(i[N]||{}).prototype)for(x in h){if(v=h[x],b=p.dontCallGetSet?(_=c(f,x))&&_.value:f[x],!g(E?x:N+(O?".":"#")+x,p.forced)&&b!==void 0){if(typeof v==typeof b)continue;d(v,b)}(p.sham||b&&b.sham)&&l(v,"sham",!0),u(f,x,v,p)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(e,a,n){a.exports=function(i){try{return!!i()}catch{return!0}}},{}],261:[function(e,a,n){var i=e("../internals/function-bind-native"),c=Function.prototype,l=c.apply,u=c.call;a.exports=typeof Reflect=="object"&&Reflect.apply||(i?u.bind(l):function(){return u.apply(l,arguments)})},{"../internals/function-bind-native":263}],262:[function(e,a,n){var i=e("../internals/function-uncurry-this-clause"),c=e("../internals/a-callable"),l=e("../internals/function-bind-native"),u=i(i.bind);a.exports=function(o,d){return c(o),d===void 0?o:l?u(o,d):function(){return o.apply(d,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(e,a,n){var i=e("../internals/fails");a.exports=!i(function(){var c=(function(){}).bind();return typeof c!="function"||c.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(e,a,n){var i=e("../internals/function-bind-native"),c=Function.prototype.call;a.exports=i?c.bind(c):function(){return c.apply(c,arguments)}},{"../internals/function-bind-native":263}],265:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/has-own-property"),l=Function.prototype,u=i&&Object.getOwnPropertyDescriptor,o=c(l,"name"),d=o&&(function(){}).name==="something",g=o&&(!i||i&&u(l,"name").configurable);a.exports={EXISTS:o,PROPER:d,CONFIGURABLE:g}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=e("../internals/a-callable");a.exports=function(l,u,o){try{return i(c(Object.getOwnPropertyDescriptor(l,u)[o]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(e,a,n){var i=e("../internals/classof-raw"),c=e("../internals/function-uncurry-this");a.exports=function(l){if(i(l)==="Function")return c(l)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(e,a,n){var i=e("../internals/function-bind-native"),c=Function.prototype,l=c.call,u=i&&c.bind.bind(l,l);a.exports=i?u:function(o){return function(){return l.apply(o,arguments)}}},{"../internals/function-bind-native":263}],269:[function(e,a,n){var i=e("../internals/global"),c=e("../internals/is-callable"),l=function(u){return c(u)?u:void 0};a.exports=function(u,o){return arguments.length<2?l(i[u]):i[u]&&i[u][o]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(e,a,n){var i=e("../internals/classof"),c=e("../internals/get-method"),l=e("../internals/is-null-or-undefined"),u=e("../internals/iterators"),o=e("../internals/well-known-symbol")("iterator");a.exports=function(d){if(!l(d))return c(d,o)||c(d,"@@iterator")||u[i(d)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(e,a,n){var i=e("../internals/function-call"),c=e("../internals/a-callable"),l=e("../internals/an-object"),u=e("../internals/try-to-string"),o=e("../internals/get-iterator-method"),d=TypeError;a.exports=function(g,p){var h=arguments.length<2?o(g):p;if(c(h))return l(i(h,g));throw new d(u(g)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=e("../internals/is-array"),l=e("../internals/is-callable"),u=e("../internals/classof-raw"),o=e("../internals/to-string"),d=i([].push);a.exports=function(g){if(l(g))return g;if(c(g)){for(var p=g.length,h=[],f=0;f<p;f++){var x=g[f];typeof x=="string"?d(h,x):typeof x!="number"&&u(x)!=="Number"&&u(x)!=="String"||d(h,o(x))}var b=h.length,v=!0;return function(_,N){if(v)return v=!1,N;if(c(this))return N;for(var E=0;E<b;E++)if(h[E]===_)return N}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(e,a,n){var i=e("../internals/a-callable"),c=e("../internals/is-null-or-undefined");a.exports=function(l,u){var o=l[u];return c(o)?void 0:i(o)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(e,a,n){(function(i){(function(){var c=function(l){return l&&l.Math===Math&&l};a.exports=c(typeof globalThis=="object"&&globalThis)||c(typeof window=="object"&&window)||c(typeof self=="object"&&self)||c(typeof i=="object"&&i)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=e("../internals/to-object"),l=i({}.hasOwnProperty);a.exports=Object.hasOwn||function(u,o){return l(c(u),o)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(e,a,n){a.exports={}},{}],277:[function(e,a,n){a.exports=function(i,c){try{arguments.length===1?console.error(i):console.error(i,c)}catch{}}},{}],278:[function(e,a,n){var i=e("../internals/get-built-in");a.exports=i("document","documentElement")},{"../internals/get-built-in":269}],279:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/fails"),l=e("../internals/document-create-element");a.exports=!i&&!c(function(){return Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=e("../internals/fails"),l=e("../internals/classof-raw"),u=Object,o=i("".split);a.exports=c(function(){return!u("z").propertyIsEnumerable(0)})?function(d){return l(d)==="String"?o(d,""):u(d)}:u},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=e("../internals/is-callable"),l=e("../internals/shared-store"),u=i(Function.toString);c(l.inspectSource)||(l.inspectSource=function(o){return u(o)}),a.exports=l.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(e,a,n){var i,c,l,u=e("../internals/weak-map-basic-detection"),o=e("../internals/global"),d=e("../internals/is-object"),g=e("../internals/create-non-enumerable-property"),p=e("../internals/has-own-property"),h=e("../internals/shared-store"),f=e("../internals/shared-key"),x=e("../internals/hidden-keys"),b=o.TypeError,v=o.WeakMap;if(u||h.state){var _=h.state||(h.state=new v);_.get=_.get,_.has=_.has,_.set=_.set,i=function(E,O){if(_.has(E))throw new b("Object already initialized");return O.facade=E,_.set(E,O),O},c=function(E){return _.get(E)||{}},l=function(E){return _.has(E)}}else{var N=f("state");x[N]=!0,i=function(E,O){if(p(E,N))throw new b("Object already initialized");return O.facade=E,g(E,N,O),O},c=function(E){return p(E,N)?E[N]:{}},l=function(E){return p(E,N)}}a.exports={set:i,get:c,has:l,enforce:function(E){return l(E)?c(E):i(E,{})},getterFor:function(E){return function(O){var F;if(!d(O)||(F=c(O)).type!==E)throw new b("Incompatible receiver, "+E+" required");return F}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(e,a,n){var i=e("../internals/well-known-symbol"),c=e("../internals/iterators"),l=i("iterator"),u=Array.prototype;a.exports=function(o){return o!==void 0&&(c.Array===o||u[l]===o)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(e,a,n){var i=e("../internals/classof-raw");a.exports=Array.isArray||function(c){return i(c)==="Array"}},{"../internals/classof-raw":235}],285:[function(e,a,n){var i=e("../internals/document-all"),c=i.all;a.exports=i.IS_HTMLDDA?function(l){return typeof l=="function"||l===c}:function(l){return typeof l=="function"}},{"../internals/document-all":248}],286:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=e("../internals/fails"),l=e("../internals/is-callable"),u=e("../internals/classof"),o=e("../internals/get-built-in"),d=e("../internals/inspect-source"),g=function(){},p=[],h=o("Reflect","construct"),f=/^\s*(?:class|function)\b/,x=i(f.exec),b=!f.test(g),v=function(N){if(!l(N))return!1;try{return h(g,p,N),!0}catch{return!1}},_=function(N){if(!l(N))return!1;switch(u(N)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return b||!!x(f,d(N))}catch{return!0}};_.sham=!0,a.exports=!h||c(function(){var N;return v(v.call)||!v(Object)||!v(function(){N=!0})||N})?_:v},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(e,a,n){var i=e("../internals/fails"),c=e("../internals/is-callable"),l=/#|\.prototype\./,u=function(h,f){var x=d[o(h)];return x===p||x!==g&&(c(f)?i(f):!!f)},o=u.normalize=function(h){return String(h).replace(l,".").toLowerCase()},d=u.data={},g=u.NATIVE="N",p=u.POLYFILL="P";a.exports=u},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(e,a,n){a.exports=function(i){return i==null}},{}],289:[function(e,a,n){var i=e("../internals/is-callable"),c=e("../internals/document-all"),l=c.all;a.exports=c.IS_HTMLDDA?function(u){return typeof u=="object"?u!==null:i(u)||u===l}:function(u){return typeof u=="object"?u!==null:i(u)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(e,a,n){a.exports=!1},{}],291:[function(e,a,n){var i=e("../internals/is-object"),c=e("../internals/classof-raw"),l=e("../internals/well-known-symbol")("match");a.exports=function(u){var o;return i(u)&&((o=u[l])!==void 0?!!o:c(u)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(e,a,n){var i=e("../internals/get-built-in"),c=e("../internals/is-callable"),l=e("../internals/object-is-prototype-of"),u=e("../internals/use-symbol-as-uid"),o=Object;a.exports=u?function(d){return typeof d=="symbol"}:function(d){var g=i("Symbol");return c(g)&&l(g.prototype,o(d))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(e,a,n){var i=e("../internals/function-bind-context"),c=e("../internals/function-call"),l=e("../internals/an-object"),u=e("../internals/try-to-string"),o=e("../internals/is-array-iterator-method"),d=e("../internals/length-of-array-like"),g=e("../internals/object-is-prototype-of"),p=e("../internals/get-iterator"),h=e("../internals/get-iterator-method"),f=e("../internals/iterator-close"),x=TypeError,b=function(_,N){this.stopped=_,this.result=N},v=b.prototype;a.exports=function(_,N,E){var O,F,z,P,U,W,Y,q=E&&E.that,M=!(!E||!E.AS_ENTRIES),D=!(!E||!E.IS_RECORD),T=!(!E||!E.IS_ITERATOR),C=!(!E||!E.INTERRUPTED),S=i(N,q),w=function(A){return O&&f(O,"normal",A),new b(!0,A)},j=function(A){return M?(l(A),C?S(A[0],A[1],w):S(A[0],A[1])):C?S(A,w):S(A)};if(D)O=_.iterator;else if(T)O=_;else{if(!(F=h(_)))throw new x(u(_)+" is not iterable");if(o(F)){for(z=0,P=d(_);P>z;z++)if((U=j(_[z]))&&g(v,U))return U;return new b(!1)}O=p(_,F)}for(W=D?_.next:O.next;!(Y=c(W,O)).done;){try{U=j(Y.value)}catch(A){f(O,"throw",A)}if(typeof U=="object"&&U&&g(v,U))return U}return new b(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(e,a,n){var i=e("../internals/function-call"),c=e("../internals/an-object"),l=e("../internals/get-method");a.exports=function(u,o,d){var g,p;c(u);try{if(!(g=l(u,"return"))){if(o==="throw")throw d;return d}g=i(g,u)}catch(h){p=!0,g=h}if(o==="throw")throw d;if(p)throw g;return c(g),d}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(e,a,n){var i=e("../internals/iterators-core").IteratorPrototype,c=e("../internals/object-create"),l=e("../internals/create-property-descriptor"),u=e("../internals/set-to-string-tag"),o=e("../internals/iterators"),d=function(){return this};a.exports=function(g,p,h,f){var x=p+" Iterator";return g.prototype=c(i,{next:l(+!f,h)}),u(g,x,!1,!0),o[x]=d,g}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/function-call"),l=e("../internals/is-pure"),u=e("../internals/function-name"),o=e("../internals/is-callable"),d=e("../internals/iterator-create-constructor"),g=e("../internals/object-get-prototype-of"),p=e("../internals/object-set-prototype-of"),h=e("../internals/set-to-string-tag"),f=e("../internals/create-non-enumerable-property"),x=e("../internals/define-built-in"),b=e("../internals/well-known-symbol"),v=e("../internals/iterators"),_=e("../internals/iterators-core"),N=u.PROPER,E=u.CONFIGURABLE,O=_.IteratorPrototype,F=_.BUGGY_SAFARI_ITERATORS,z=b("iterator"),P=function(){return this};a.exports=function(U,W,Y,q,M,D,T){d(Y,W,q);var C,S,w,j=function(G){if(G===M&&K)return K;if(!F&&G&&G in I)return I[G];switch(G){case"keys":case"values":case"entries":return function(){return new Y(this,G)}}return function(){return new Y(this)}},A=W+" Iterator",L=!1,I=U.prototype,Z=I[z]||I["@@iterator"]||M&&I[M],K=!F&&Z||j(M),re=W==="Array"&&I.entries||Z;if(re&&(C=g(re.call(new U)))!==Object.prototype&&C.next&&(l||g(C)===O||(p?p(C,O):o(C[z])||x(C,z,P)),h(C,A,!0,!0),l&&(v[A]=P)),N&&M==="values"&&Z&&Z.name!=="values"&&(!l&&E?f(I,"name","values"):(L=!0,K=function(){return c(Z,this)})),M)if(S={values:j("values"),keys:D?K:j("keys"),entries:j("entries")},T)for(w in S)(F||L||!(w in I))&&x(I,w,S[w]);else i({target:W,proto:!0,forced:F||L},S);return l&&!T||I[z]===K||x(I,z,K,{name:M}),v[W]=K,S}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(e,a,n){var i,c,l,u=e("../internals/fails"),o=e("../internals/is-callable"),d=e("../internals/is-object"),g=e("../internals/object-create"),p=e("../internals/object-get-prototype-of"),h=e("../internals/define-built-in"),f=e("../internals/well-known-symbol"),x=e("../internals/is-pure"),b=f("iterator"),v=!1;[].keys&&("next"in(l=[].keys())?(c=p(p(l)))!==Object.prototype&&(i=c):v=!0),!d(i)||u(function(){var _={};return i[b].call(_)!==_})?i={}:x&&(i=g(i)),o(i[b])||h(i,b,function(){return this}),a.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:v}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(e,a,n){arguments[4][276][0].apply(n,arguments)},{dup:276}],299:[function(e,a,n){var i=e("../internals/to-length");a.exports=function(c){return i(c.length)}},{"../internals/to-length":343}],300:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=e("../internals/fails"),l=e("../internals/is-callable"),u=e("../internals/has-own-property"),o=e("../internals/descriptors"),d=e("../internals/function-name").CONFIGURABLE,g=e("../internals/inspect-source"),p=e("../internals/internal-state"),h=p.enforce,f=p.get,x=String,b=Object.defineProperty,v=i("".slice),_=i("".replace),N=i([].join),E=o&&!c(function(){return b(function(){},"length",{value:8}).length!==8}),O=String(String).split("String"),F=a.exports=function(z,P,U){v(x(P),0,7)==="Symbol("&&(P="["+_(x(P),/^Symbol\(([^)]*)\)/,"$1")+"]"),U&&U.getter&&(P="get "+P),U&&U.setter&&(P="set "+P),(!u(z,"name")||d&&z.name!==P)&&(o?b(z,"name",{value:P,configurable:!0}):z.name=P),E&&U&&u(U,"arity")&&z.length!==U.arity&&b(z,"length",{value:U.arity});try{U&&u(U,"constructor")&&U.constructor?o&&b(z,"prototype",{writable:!1}):z.prototype&&(z.prototype=void 0)}catch{}var W=h(z);return u(W,"source")||(W.source=N(O,typeof P=="string"?P:"")),z};Function.prototype.toString=F(function(){return l(this)&&f(this).source||g(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(e,a,n){var i=Math.ceil,c=Math.floor;a.exports=Math.trunc||function(l){var u=+l;return(u>0?c:i)(u)}},{}],302:[function(e,a,n){var i,c,l,u,o,d=e("../internals/global"),g=e("../internals/function-bind-context"),p=e("../internals/object-get-own-property-descriptor").f,h=e("../internals/task").set,f=e("../internals/queue"),x=e("../internals/engine-is-ios"),b=e("../internals/engine-is-ios-pebble"),v=e("../internals/engine-is-webos-webkit"),_=e("../internals/engine-is-node"),N=d.MutationObserver||d.WebKitMutationObserver,E=d.document,O=d.process,F=d.Promise,z=p(d,"queueMicrotask"),P=z&&z.value;if(!P){var U=new f,W=function(){var Y,q;for(_&&(Y=O.domain)&&Y.exit();q=U.get();)try{q()}catch(M){throw U.head&&i(),M}Y&&Y.enter()};x||_||v||!N||!E?!b&&F&&F.resolve?((u=F.resolve(void 0)).constructor=F,o=g(u.then,u),i=function(){o(W)}):_?i=function(){O.nextTick(W)}:(h=g(h,d),i=function(){h(W)}):(c=!0,l=E.createTextNode(""),new N(W).observe(l,{characterData:!0}),i=function(){l.data=c=!c}),P=function(Y){U.head||i(),U.add(Y)}}a.exports=P},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(e,a,n){var i=e("../internals/a-callable"),c=TypeError,l=function(u){var o,d;this.promise=new u(function(g,p){if(o!==void 0||d!==void 0)throw new c("Bad Promise constructor");o=g,d=p}),this.resolve=i(o),this.reject=i(d)};a.exports.f=function(u){return new l(u)}},{"../internals/a-callable":222}],304:[function(e,a,n){var i=e("../internals/is-regexp"),c=TypeError;a.exports=function(l){if(i(l))throw new c("The method doesn't accept regular expressions");return l}},{"../internals/is-regexp":291}],305:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/function-uncurry-this"),l=e("../internals/function-call"),u=e("../internals/fails"),o=e("../internals/object-keys"),d=e("../internals/object-get-own-property-symbols"),g=e("../internals/object-property-is-enumerable"),p=e("../internals/to-object"),h=e("../internals/indexed-object"),f=Object.assign,x=Object.defineProperty,b=c([].concat);a.exports=!f||u(function(){if(i&&f({b:1},f(x({},"a",{enumerable:!0,get:function(){x(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var v={},_={},N=Symbol("assign detection");return v[N]=7,"abcdefghijklmnopqrst".split("").forEach(function(E){_[E]=E}),f({},v)[N]!==7||o(f({},_)).join("")!=="abcdefghijklmnopqrst"})?function(v,_){for(var N=p(v),E=arguments.length,O=1,F=d.f,z=g.f;E>O;)for(var P,U=h(arguments[O++]),W=F?b(o(U),F(U)):o(U),Y=W.length,q=0;Y>q;)P=W[q++],i&&!l(z,U,P)||(N[P]=U[P]);return N}:f},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(e,a,n){var i,c=e("../internals/an-object"),l=e("../internals/object-define-properties"),u=e("../internals/enum-bug-keys"),o=e("../internals/hidden-keys"),d=e("../internals/html"),g=e("../internals/document-create-element"),p=e("../internals/shared-key"),h=p("IE_PROTO"),f=function(){},x=function(_){return"<script>"+_+"<\/script>"},b=function(_){_.write(x("")),_.close();var N=_.parentWindow.Object;return _=null,N},v=function(){try{i=new ActiveXObject("htmlfile")}catch{}var _,N;v=typeof document<"u"?document.domain&&i?b(i):((N=g("iframe")).style.display="none",d.appendChild(N),N.src="javascript:",(_=N.contentWindow.document).open(),_.write(x("document.F=Object")),_.close(),_.F):b(i);for(var E=u.length;E--;)delete v.prototype[u[E]];return v()};o[h]=!0,a.exports=Object.create||function(_,N){var E;return _!==null?(f.prototype=c(_),E=new f,f.prototype=null,E[h]=_):E=v(),N===void 0?E:l.f(E,N)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/v8-prototype-define-bug"),l=e("../internals/object-define-property"),u=e("../internals/an-object"),o=e("../internals/to-indexed-object"),d=e("../internals/object-keys");n.f=i&&!c?Object.defineProperties:function(g,p){u(g);for(var h,f=o(p),x=d(p),b=x.length,v=0;b>v;)l.f(g,h=x[v++],f[h]);return g}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/ie8-dom-define"),l=e("../internals/v8-prototype-define-bug"),u=e("../internals/an-object"),o=e("../internals/to-property-key"),d=TypeError,g=Object.defineProperty,p=Object.getOwnPropertyDescriptor;n.f=i?l?function(h,f,x){if(u(h),f=o(f),u(x),typeof h=="function"&&f==="prototype"&&"value"in x&&"writable"in x&&!x.writable){var b=p(h,f);b&&b.writable&&(h[f]=x.value,x={configurable:"configurable"in x?x.configurable:b.configurable,enumerable:"enumerable"in x?x.enumerable:b.enumerable,writable:!1})}return g(h,f,x)}:g:function(h,f,x){if(u(h),f=o(f),u(x),c)try{return g(h,f,x)}catch{}if("get"in x||"set"in x)throw new d("Accessors not supported");return"value"in x&&(h[f]=x.value),h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/function-call"),l=e("../internals/object-property-is-enumerable"),u=e("../internals/create-property-descriptor"),o=e("../internals/to-indexed-object"),d=e("../internals/to-property-key"),g=e("../internals/has-own-property"),p=e("../internals/ie8-dom-define"),h=Object.getOwnPropertyDescriptor;n.f=i?h:function(f,x){if(f=o(f),x=d(x),p)try{return h(f,x)}catch{}if(g(f,x))return u(!c(l.f,f,x),f[x])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(e,a,n){var i=e("../internals/classof-raw"),c=e("../internals/to-indexed-object"),l=e("../internals/object-get-own-property-names").f,u=e("../internals/array-slice-simple"),o=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];a.exports.f=function(d){return o&&i(d)==="Window"?function(g){try{return l(g)}catch{return u(o)}}(d):l(c(d))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(e,a,n){var i=e("../internals/object-keys-internal"),c=e("../internals/enum-bug-keys").concat("length","prototype");n.f=Object.getOwnPropertyNames||function(l){return i(l,c)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(e,a,n){n.f=Object.getOwnPropertySymbols},{}],313:[function(e,a,n){var i=e("../internals/has-own-property"),c=e("../internals/is-callable"),l=e("../internals/to-object"),u=e("../internals/shared-key"),o=e("../internals/correct-prototype-getter"),d=u("IE_PROTO"),g=Object,p=g.prototype;a.exports=o?g.getPrototypeOf:function(h){var f=l(h);if(i(f,d))return f[d];var x=f.constructor;return c(x)&&f instanceof x?x.prototype:f instanceof g?p:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(e,a,n){var i=e("../internals/function-uncurry-this");a.exports=i({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=e("../internals/has-own-property"),l=e("../internals/to-indexed-object"),u=e("../internals/array-includes").indexOf,o=e("../internals/hidden-keys"),d=i([].push);a.exports=function(g,p){var h,f=l(g),x=0,b=[];for(h in f)!c(o,h)&&c(f,h)&&d(b,h);for(;p.length>x;)c(f,h=p[x++])&&(~u(b,h)||d(b,h));return b}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(e,a,n){var i=e("../internals/object-keys-internal"),c=e("../internals/enum-bug-keys");a.exports=Object.keys||function(l){return i(l,c)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(e,a,n){var i={}.propertyIsEnumerable,c=Object.getOwnPropertyDescriptor,l=c&&!i.call({1:2},1);n.f=l?function(u){var o=c(this,u);return!!o&&o.enumerable}:i},{}],318:[function(e,a,n){var i=e("../internals/function-uncurry-this-accessor"),c=e("../internals/an-object"),l=e("../internals/a-possible-prototype");a.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var u,o=!1,d={};try{(u=i(Object.prototype,"__proto__","set"))(d,[]),o=d instanceof Array}catch{}return function(g,p){return c(g),l(p),o?u(g,p):g.__proto__=p,g}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/fails"),l=e("../internals/function-uncurry-this"),u=e("../internals/object-get-prototype-of"),o=e("../internals/object-keys"),d=e("../internals/to-indexed-object"),g=l(e("../internals/object-property-is-enumerable").f),p=l([].push),h=i&&c(function(){var x=Object.create(null);return x[2]=2,!g(x,2)}),f=function(x){return function(b){for(var v,_=d(b),N=o(_),E=h&&u(_)===null,O=N.length,F=0,z=[];O>F;)v=N[F++],i&&!(E?v in _:g(_,v))||p(z,x?[v,_[v]]:_[v]);return z}};a.exports={entries:f(!0),values:f(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(e,a,n){var i=e("../internals/function-call"),c=e("../internals/is-callable"),l=e("../internals/is-object"),u=TypeError;a.exports=function(o,d){var g,p;if(d==="string"&&c(g=o.toString)&&!l(p=i(g,o))||c(g=o.valueOf)&&!l(p=i(g,o))||d!=="string"&&c(g=o.toString)&&!l(p=i(g,o)))return p;throw new u("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(e,a,n){var i=e("../internals/get-built-in"),c=e("../internals/function-uncurry-this"),l=e("../internals/object-get-own-property-names"),u=e("../internals/object-get-own-property-symbols"),o=e("../internals/an-object"),d=c([].concat);a.exports=i("Reflect","ownKeys")||function(g){var p=l.f(o(g)),h=u.f;return h?d(p,h(g)):p}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(e,a,n){var i=e("../internals/global");a.exports=i},{"../internals/global":274}],323:[function(e,a,n){a.exports=function(i){try{return{error:!1,value:i()}}catch(c){return{error:!0,value:c}}}},{}],324:[function(e,a,n){var i=e("../internals/global"),c=e("../internals/promise-native-constructor"),l=e("../internals/is-callable"),u=e("../internals/is-forced"),o=e("../internals/inspect-source"),d=e("../internals/well-known-symbol"),g=e("../internals/engine-is-browser"),p=e("../internals/engine-is-deno"),h=e("../internals/is-pure"),f=e("../internals/engine-v8-version"),x=c&&c.prototype,b=d("species"),v=!1,_=l(i.PromiseRejectionEvent),N=u("Promise",function(){var E=o(c),O=E!==String(c);if(!O&&f===66||h&&(!x.catch||!x.finally))return!0;if(!f||f<51||!/native code/.test(E)){var F=new c(function(P){P(1)}),z=function(P){P(function(){},function(){})};if((F.constructor={})[b]=z,!(v=F.then(function(){})instanceof z))return!0}return!O&&(g||p)&&!_});a.exports={CONSTRUCTOR:N,REJECTION_EVENT:_,SUBCLASSING:v}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(e,a,n){var i=e("../internals/global");a.exports=i.Promise},{"../internals/global":274}],326:[function(e,a,n){var i=e("../internals/an-object"),c=e("../internals/is-object"),l=e("../internals/new-promise-capability");a.exports=function(u,o){if(i(u),c(o)&&o.constructor===u)return o;var d=l.f(u);return(0,d.resolve)(o),d.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(e,a,n){var i=e("../internals/promise-native-constructor"),c=e("../internals/check-correctness-of-iteration"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR;a.exports=l||!c(function(u){i.all(u).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(e,a,n){var i=function(){this.head=null,this.tail=null};i.prototype={add:function(c){var l={item:c,next:null},u=this.tail;u?u.next=l:this.head=l,this.tail=l},get:function(){var c=this.head;if(c)return(this.head=c.next)===null&&(this.tail=null),c.item}},a.exports=i},{}],329:[function(e,a,n){var i=e("../internals/is-null-or-undefined"),c=TypeError;a.exports=function(l){if(i(l))throw new c("Can't call method on "+l);return l}},{"../internals/is-null-or-undefined":288}],330:[function(e,a,n){var i=e("../internals/get-built-in"),c=e("../internals/define-built-in-accessor"),l=e("../internals/well-known-symbol"),u=e("../internals/descriptors"),o=l("species");a.exports=function(d){var g=i(d);u&&g&&!g[o]&&c(g,o,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(e,a,n){var i=e("../internals/object-define-property").f,c=e("../internals/has-own-property"),l=e("../internals/well-known-symbol")("toStringTag");a.exports=function(u,o,d){u&&!d&&(u=u.prototype),u&&!c(u,l)&&i(u,l,{configurable:!0,value:o})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(e,a,n){var i=e("../internals/shared"),c=e("../internals/uid"),l=i("keys");a.exports=function(u){return l[u]||(l[u]=c(u))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(e,a,n){var i=e("../internals/global"),c=e("../internals/define-global-property"),l=i["__core-js_shared__"]||c("__core-js_shared__",{});a.exports=l},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(e,a,n){var i=e("../internals/is-pure"),c=e("../internals/shared-store");(a.exports=function(l,u){return c[l]||(c[l]=u!==void 0?u:{})})("versions",[]).push({version:"3.33.0",mode:i?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(e,a,n){var i=e("../internals/an-object"),c=e("../internals/a-constructor"),l=e("../internals/is-null-or-undefined"),u=e("../internals/well-known-symbol")("species");a.exports=function(o,d){var g,p=i(o).constructor;return p===void 0||l(g=i(p)[u])?d:c(g)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(e,a,n){var i=e("../internals/engine-v8-version"),c=e("../internals/fails"),l=e("../internals/global").String;a.exports=!!Object.getOwnPropertySymbols&&!c(function(){var u=Symbol("symbol detection");return!l(u)||!(Object(u)instanceof Symbol)||!Symbol.sham&&i&&i<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(e,a,n){var i=e("../internals/function-call"),c=e("../internals/get-built-in"),l=e("../internals/well-known-symbol"),u=e("../internals/define-built-in");a.exports=function(){var o=c("Symbol"),d=o&&o.prototype,g=d&&d.valueOf,p=l("toPrimitive");d&&!d[p]&&u(d,p,function(h){return i(g,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(e,a,n){var i=e("../internals/symbol-constructor-detection");a.exports=i&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(e,a,n){var i,c,l,u,o=e("../internals/global"),d=e("../internals/function-apply"),g=e("../internals/function-bind-context"),p=e("../internals/is-callable"),h=e("../internals/has-own-property"),f=e("../internals/fails"),x=e("../internals/html"),b=e("../internals/array-slice"),v=e("../internals/document-create-element"),_=e("../internals/validate-arguments-length"),N=e("../internals/engine-is-ios"),E=e("../internals/engine-is-node"),O=o.setImmediate,F=o.clearImmediate,z=o.process,P=o.Dispatch,U=o.Function,W=o.MessageChannel,Y=o.String,q=0,M={};f(function(){i=o.location});var D=function(w){if(h(M,w)){var j=M[w];delete M[w],j()}},T=function(w){return function(){D(w)}},C=function(w){D(w.data)},S=function(w){o.postMessage(Y(w),i.protocol+"//"+i.host)};O&&F||(O=function(w){_(arguments.length,1);var j=p(w)?w:U(w),A=b(arguments,1);return M[++q]=function(){d(j,void 0,A)},c(q),q},F=function(w){delete M[w]},E?c=function(w){z.nextTick(T(w))}:P&&P.now?c=function(w){P.now(T(w))}:W&&!N?(u=(l=new W).port2,l.port1.onmessage=C,c=g(u.postMessage,u)):o.addEventListener&&p(o.postMessage)&&!o.importScripts&&i&&i.protocol!=="file:"&&!f(S)?(c=S,o.addEventListener("message",C,!1)):c="onreadystatechange"in v("script")?function(w){x.appendChild(v("script")).onreadystatechange=function(){x.removeChild(this),D(w)}}:function(w){setTimeout(T(w),0)}),a.exports={set:O,clear:F}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(e,a,n){var i=e("../internals/to-integer-or-infinity"),c=Math.max,l=Math.min;a.exports=function(u,o){var d=i(u);return d<0?c(d+o,0):l(d,o)}},{"../internals/to-integer-or-infinity":342}],341:[function(e,a,n){var i=e("../internals/indexed-object"),c=e("../internals/require-object-coercible");a.exports=function(l){return i(c(l))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(e,a,n){var i=e("../internals/math-trunc");a.exports=function(c){var l=+c;return l!=l||l===0?0:i(l)}},{"../internals/math-trunc":301}],343:[function(e,a,n){var i=e("../internals/to-integer-or-infinity"),c=Math.min;a.exports=function(l){return l>0?c(i(l),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(e,a,n){var i=e("../internals/require-object-coercible"),c=Object;a.exports=function(l){return c(i(l))}},{"../internals/require-object-coercible":329}],345:[function(e,a,n){var i=e("../internals/function-call"),c=e("../internals/is-object"),l=e("../internals/is-symbol"),u=e("../internals/get-method"),o=e("../internals/ordinary-to-primitive"),d=e("../internals/well-known-symbol"),g=TypeError,p=d("toPrimitive");a.exports=function(h,f){if(!c(h)||l(h))return h;var x,b=u(h,p);if(b){if(f===void 0&&(f="default"),x=i(b,h,f),!c(x)||l(x))return x;throw new g("Can't convert object to primitive value")}return f===void 0&&(f="number"),o(h,f)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(e,a,n){var i=e("../internals/to-primitive"),c=e("../internals/is-symbol");a.exports=function(l){var u=i(l,"string");return c(u)?u:u+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(e,a,n){var i={};i[e("../internals/well-known-symbol")("toStringTag")]="z",a.exports=String(i)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(e,a,n){var i=e("../internals/classof"),c=String;a.exports=function(l){if(i(l)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return c(l)}},{"../internals/classof":236}],349:[function(e,a,n){var i=String;a.exports=function(c){try{return i(c)}catch{return"Object"}}},{}],350:[function(e,a,n){var i=e("../internals/function-uncurry-this"),c=0,l=Math.random(),u=i(1 .toString);a.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+u(++c+l,36)}},{"../internals/function-uncurry-this":268}],351:[function(e,a,n){var i=e("../internals/symbol-constructor-detection");a.exports=i&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(e,a,n){var i=e("../internals/descriptors"),c=e("../internals/fails");a.exports=i&&c(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(e,a,n){var i=TypeError;a.exports=function(c,l){if(c<l)throw new i("Not enough arguments");return c}},{}],354:[function(e,a,n){var i=e("../internals/global"),c=e("../internals/is-callable"),l=i.WeakMap;a.exports=c(l)&&/native code/.test(String(l))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(e,a,n){var i=e("../internals/path"),c=e("../internals/has-own-property"),l=e("../internals/well-known-symbol-wrapped"),u=e("../internals/object-define-property").f;a.exports=function(o){var d=i.Symbol||(i.Symbol={});c(d,o)||u(d,o,{value:l.f(o)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(e,a,n){var i=e("../internals/well-known-symbol");n.f=i},{"../internals/well-known-symbol":357}],357:[function(e,a,n){var i=e("../internals/global"),c=e("../internals/shared"),l=e("../internals/has-own-property"),u=e("../internals/uid"),o=e("../internals/symbol-constructor-detection"),d=e("../internals/use-symbol-as-uid"),g=i.Symbol,p=c("wks"),h=d?g.for||g:g&&g.withoutSetter||u;a.exports=function(f){return l(p,f)||(p[f]=o&&l(g,f)?g[f]:h("Symbol."+f)),p[f]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/array-iteration").findIndex,l=e("../internals/add-to-unscopables"),u=!0;"findIndex"in[]&&Array(1).findIndex(function(){u=!1}),i({target:"Array",proto:!0,forced:u},{findIndex:function(o){return c(this,o,arguments.length>1?arguments[1]:void 0)}}),l("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/array-iteration").find,l=e("../internals/add-to-unscopables"),u=!0;"find"in[]&&Array(1).find(function(){u=!1}),i({target:"Array",proto:!0,forced:u},{find:function(o){return c(this,o,arguments.length>1?arguments[1]:void 0)}}),l("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/array-includes").includes,l=e("../internals/fails"),u=e("../internals/add-to-unscopables");i({target:"Array",proto:!0,forced:l(function(){return!Array(1).includes()})},{includes:function(o){return c(this,o,arguments.length>1?arguments[1]:void 0)}}),u("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(e,a,n){var i=e("../internals/to-indexed-object"),c=e("../internals/add-to-unscopables"),l=e("../internals/iterators"),u=e("../internals/internal-state"),o=e("../internals/object-define-property").f,d=e("../internals/iterator-define"),g=e("../internals/create-iter-result-object"),p=e("../internals/is-pure"),h=e("../internals/descriptors"),f=u.set,x=u.getterFor("Array Iterator");a.exports=d(Array,"Array",function(v,_){f(this,{type:"Array Iterator",target:i(v),index:0,kind:_})},function(){var v=x(this),_=v.target,N=v.kind,E=v.index++;if(!_||E>=_.length)return v.target=void 0,g(void 0,!0);switch(N){case"keys":return g(E,!1);case"values":return g(_[E],!1)}return g([E,_[E]],!1)},"values");var b=l.Arguments=l.Array;if(c("keys"),c("values"),c("entries"),!p&&h&&b.name!=="values")try{o(b,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/get-built-in"),l=e("../internals/function-apply"),u=e("../internals/function-call"),o=e("../internals/function-uncurry-this"),d=e("../internals/fails"),g=e("../internals/is-callable"),p=e("../internals/is-symbol"),h=e("../internals/array-slice"),f=e("../internals/get-json-replacer-function"),x=e("../internals/symbol-constructor-detection"),b=String,v=c("JSON","stringify"),_=o(/./.exec),N=o("".charAt),E=o("".charCodeAt),O=o("".replace),F=o(1 .toString),z=/[\uD800-\uDFFF]/g,P=/^[\uD800-\uDBFF]$/,U=/^[\uDC00-\uDFFF]$/,W=!x||d(function(){var D=c("Symbol")("stringify detection");return v([D])!=="[null]"||v({a:D})!=="{}"||v(Object(D))!=="{}"}),Y=d(function(){return v("\uDF06\uD834")!=='"\\udf06\\ud834"'||v("\uDEAD")!=='"\\udead"'}),q=function(D,T){var C=h(arguments),S=f(T);if(g(S)||D!==void 0&&!p(D))return C[1]=function(w,j){if(g(S)&&(j=u(S,this,b(w),j)),!p(j))return j},l(v,null,C)},M=function(D,T,C){var S=N(C,T-1),w=N(C,T+1);return _(P,D)&&!_(U,w)||_(U,D)&&!_(P,S)?"\\u"+F(E(D,0),16):D};v&&i({target:"JSON",stat:!0,arity:3,forced:W||Y},{stringify:function(D,T,C){var S=h(arguments),w=l(W?q:v,null,S);return Y&&typeof w=="string"?O(w,z,M):w}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(e,a,n){e("../internals/export")({target:"Number",stat:!0},{isNaN:function(i){return i!=i}})},{"../internals/export":259}],364:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/object-assign");i({target:"Object",stat:!0,arity:2,forced:Object.assign!==c},{assign:c})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/symbol-constructor-detection"),l=e("../internals/fails"),u=e("../internals/object-get-own-property-symbols"),o=e("../internals/to-object");i({target:"Object",stat:!0,forced:!c||l(function(){u.f(1)})},{getOwnPropertySymbols:function(d){var g=u.f;return g?g(o(d)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/to-object"),l=e("../internals/object-keys");i({target:"Object",stat:!0,forced:e("../internals/fails")(function(){l(1)})},{keys:function(u){return l(c(u))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/object-to-array").values;i({target:"Object",stat:!0},{values:function(l){return c(l)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/function-call"),l=e("../internals/a-callable"),u=e("../internals/new-promise-capability"),o=e("../internals/perform"),d=e("../internals/iterate");i({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{all:function(g){var p=this,h=u.f(p),f=h.resolve,x=h.reject,b=o(function(){var v=l(p.resolve),_=[],N=0,E=1;d(g,function(O){var F=N++,z=!1;E++,c(v,p,O).then(function(P){z||(z=!0,_[F]=P,--E||f(_))},x)}),--E||f(_)});return b.error&&x(b.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/is-pure"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR,u=e("../internals/promise-native-constructor"),o=e("../internals/get-built-in"),d=e("../internals/is-callable"),g=e("../internals/define-built-in"),p=u&&u.prototype;if(i({target:"Promise",proto:!0,forced:l,real:!0},{catch:function(f){return this.then(void 0,f)}}),!c&&d(u)){var h=o("Promise").prototype.catch;p.catch!==h&&g(p,"catch",h,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(e,a,n){var i,c,l,u=e("../internals/export"),o=e("../internals/is-pure"),d=e("../internals/engine-is-node"),g=e("../internals/global"),p=e("../internals/function-call"),h=e("../internals/define-built-in"),f=e("../internals/object-set-prototype-of"),x=e("../internals/set-to-string-tag"),b=e("../internals/set-species"),v=e("../internals/a-callable"),_=e("../internals/is-callable"),N=e("../internals/is-object"),E=e("../internals/an-instance"),O=e("../internals/species-constructor"),F=e("../internals/task").set,z=e("../internals/microtask"),P=e("../internals/host-report-errors"),U=e("../internals/perform"),W=e("../internals/queue"),Y=e("../internals/internal-state"),q=e("../internals/promise-native-constructor"),M=e("../internals/promise-constructor-detection"),D=e("../internals/new-promise-capability"),T=M.CONSTRUCTOR,C=M.REJECTION_EVENT,S=M.SUBCLASSING,w=Y.getterFor("Promise"),j=Y.set,A=q&&q.prototype,L=q,I=A,Z=g.TypeError,K=g.document,re=g.process,G=D.f,ae=G,V=!!(K&&K.createEvent&&g.dispatchEvent),H=function(ke){var Me;return!(!N(ke)||!_(Me=ke.then))&&Me},Q=function(ke,Me){var Oe,je,Ie,Pe=Me.value,He=Me.state===1,ct=He?ke.ok:ke.fail,ie=ke.resolve,ee=ke.reject,te=ke.domain;try{ct?(He||(Me.rejection===2&&Ne(Me),Me.rejection=1),ct===!0?Oe=Pe:(te&&te.enter(),Oe=ct(Pe),te&&(te.exit(),Ie=!0)),Oe===ke.promise?ee(new Z("Promise-chain cycle")):(je=H(Oe))?p(je,Oe,ie,ee):ie(Oe)):ee(Pe)}catch(fe){te&&!Ie&&te.exit(),ee(fe)}},oe=function(ke,Me){ke.notified||(ke.notified=!0,z(function(){for(var Oe,je=ke.reactions;Oe=je.get();)Q(Oe,ke);ke.notified=!1,Me&&!ke.rejection&&le(ke)}))},se=function(ke,Me,Oe){var je,Ie;V?((je=K.createEvent("Event")).promise=Me,je.reason=Oe,je.initEvent(ke,!1,!0),g.dispatchEvent(je)):je={promise:Me,reason:Oe},!C&&(Ie=g["on"+ke])?Ie(je):ke==="unhandledrejection"&&P("Unhandled promise rejection",Oe)},le=function(ke){p(F,g,function(){var Me,Oe=ke.facade,je=ke.value;if(he(ke)&&(Me=U(function(){d?re.emit("unhandledRejection",je,Oe):se("unhandledrejection",Oe,je)}),ke.rejection=d||he(ke)?2:1,Me.error))throw Me.value})},he=function(ke){return ke.rejection!==1&&!ke.parent},Ne=function(ke){p(F,g,function(){var Me=ke.facade;d?re.emit("rejectionHandled",Me):se("rejectionhandled",Me,ke.value)})},we=function(ke,Me,Oe){return function(je){ke(Me,je,Oe)}},ue=function(ke,Me,Oe){ke.done||(ke.done=!0,Oe&&(ke=Oe),ke.value=Me,ke.state=2,oe(ke,!0))},Se=function(ke,Me,Oe){if(!ke.done){ke.done=!0,Oe&&(ke=Oe);try{if(ke.facade===Me)throw new Z("Promise can't be resolved itself");var je=H(Me);je?z(function(){var Ie={done:!1};try{p(je,Me,we(Se,Ie,ke),we(ue,Ie,ke))}catch(Pe){ue(Ie,Pe,ke)}}):(ke.value=Me,ke.state=1,oe(ke,!1))}catch(Ie){ue({done:!1},Ie,ke)}}};if(T&&(I=(L=function(ke){E(this,I),v(ke),p(i,this);var Me=w(this);try{ke(we(Se,Me),we(ue,Me))}catch(Oe){ue(Me,Oe)}}).prototype,(i=function(ke){j(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new W,rejection:!1,state:0,value:void 0})}).prototype=h(I,"then",function(ke,Me){var Oe=w(this),je=G(O(this,L));return Oe.parent=!0,je.ok=!_(ke)||ke,je.fail=_(Me)&&Me,je.domain=d?re.domain:void 0,Oe.state===0?Oe.reactions.add(je):z(function(){Q(je,Oe)}),je.promise}),c=function(){var ke=new i,Me=w(ke);this.promise=ke,this.resolve=we(Se,Me),this.reject=we(ue,Me)},D.f=G=function(ke){return ke===L||ke===void 0?new c(ke):ae(ke)},!o&&_(q)&&A!==Object.prototype)){l=A.then,S||h(A,"then",function(ke,Me){var Oe=this;return new L(function(je,Ie){p(l,Oe,je,Ie)}).then(ke,Me)},{unsafe:!0});try{delete A.constructor}catch{}f&&f(A,I)}u({global:!0,constructor:!0,wrap:!0,forced:T},{Promise:L}),x(L,"Promise",!1,!0),b("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/is-pure"),l=e("../internals/promise-native-constructor"),u=e("../internals/fails"),o=e("../internals/get-built-in"),d=e("../internals/is-callable"),g=e("../internals/species-constructor"),p=e("../internals/promise-resolve"),h=e("../internals/define-built-in"),f=l&&l.prototype;if(i({target:"Promise",proto:!0,real:!0,forced:!!l&&u(function(){f.finally.call({then:function(){}},function(){})})},{finally:function(b){var v=g(this,o("Promise")),_=d(b);return this.then(_?function(N){return p(v,b()).then(function(){return N})}:b,_?function(N){return p(v,b()).then(function(){throw N})}:b)}}),!c&&d(l)){var x=o("Promise").prototype.finally;f.finally!==x&&h(f,"finally",x,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(e,a,n){e("../modules/es.promise.constructor"),e("../modules/es.promise.all"),e("../modules/es.promise.catch"),e("../modules/es.promise.race"),e("../modules/es.promise.reject"),e("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/function-call"),l=e("../internals/a-callable"),u=e("../internals/new-promise-capability"),o=e("../internals/perform"),d=e("../internals/iterate");i({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{race:function(g){var p=this,h=u.f(p),f=h.reject,x=o(function(){var b=l(p.resolve);d(g,function(v){c(b,p,v).then(h.resolve,f)})});return x.error&&f(x.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/function-call"),l=e("../internals/new-promise-capability");i({target:"Promise",stat:!0,forced:e("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(u){var o=l.f(this);return c(o.reject,void 0,u),o.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/get-built-in"),l=e("../internals/is-pure"),u=e("../internals/promise-native-constructor"),o=e("../internals/promise-constructor-detection").CONSTRUCTOR,d=e("../internals/promise-resolve"),g=c("Promise"),p=l&&!o;i({target:"Promise",stat:!0,forced:l||o},{resolve:function(h){return d(p&&this===g?u:this,h)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/function-uncurry-this"),l=e("../internals/to-absolute-index"),u=RangeError,o=String.fromCharCode,d=String.fromCodePoint,g=c([].join);i({target:"String",stat:!0,arity:1,forced:!!d&&d.length!==1},{fromCodePoint:function(p){for(var h,f=[],x=arguments.length,b=0;x>b;){if(h=+arguments[b++],l(h,1114111)!==h)throw new u(h+" is not a valid code point");f[b]=h<65536?o(h):o(55296+((h-=65536)>>10),h%1024+56320)}return g(f,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/function-uncurry-this"),l=e("../internals/not-a-regexp"),u=e("../internals/require-object-coercible"),o=e("../internals/to-string"),d=e("../internals/correct-is-regexp-logic"),g=c("".indexOf);i({target:"String",proto:!0,forced:!d("includes")},{includes:function(p){return!!~g(o(u(this)),o(l(p)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(e,a,n){e("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/global"),l=e("../internals/function-call"),u=e("../internals/function-uncurry-this"),o=e("../internals/is-pure"),d=e("../internals/descriptors"),g=e("../internals/symbol-constructor-detection"),p=e("../internals/fails"),h=e("../internals/has-own-property"),f=e("../internals/object-is-prototype-of"),x=e("../internals/an-object"),b=e("../internals/to-indexed-object"),v=e("../internals/to-property-key"),_=e("../internals/to-string"),N=e("../internals/create-property-descriptor"),E=e("../internals/object-create"),O=e("../internals/object-keys"),F=e("../internals/object-get-own-property-names"),z=e("../internals/object-get-own-property-names-external"),P=e("../internals/object-get-own-property-symbols"),U=e("../internals/object-get-own-property-descriptor"),W=e("../internals/object-define-property"),Y=e("../internals/object-define-properties"),q=e("../internals/object-property-is-enumerable"),M=e("../internals/define-built-in"),D=e("../internals/define-built-in-accessor"),T=e("../internals/shared"),C=e("../internals/shared-key"),S=e("../internals/hidden-keys"),w=e("../internals/uid"),j=e("../internals/well-known-symbol"),A=e("../internals/well-known-symbol-wrapped"),L=e("../internals/well-known-symbol-define"),I=e("../internals/symbol-define-to-primitive"),Z=e("../internals/set-to-string-tag"),K=e("../internals/internal-state"),re=e("../internals/array-iteration").forEach,G=C("hidden"),ae=K.set,V=K.getterFor("Symbol"),H=Object.prototype,Q=c.Symbol,oe=Q&&Q.prototype,se=c.RangeError,le=c.TypeError,he=c.QObject,Ne=U.f,we=W.f,ue=z.f,Se=q.f,ke=u([].push),Me=T("symbols"),Oe=T("op-symbols"),je=T("wks"),Ie=!he||!he.prototype||!he.prototype.findChild,Pe=function(Ae,Fe,st){var it=Ne(H,Fe);it&&delete H[Fe],we(Ae,Fe,st),it&&Ae!==H&&we(H,Fe,it)},He=d&&p(function(){return E(we({},"a",{get:function(){return we(this,"a",{value:7}).a}})).a!==7})?Pe:we,ct=function(Ae,Fe){var st=Me[Ae]=E(oe);return ae(st,{type:"Symbol",tag:Ae,description:Fe}),d||(st.description=Fe),st},ie=function(Ae,Fe,st){Ae===H&&ie(Oe,Fe,st),x(Ae);var it=v(Fe);return x(st),h(Me,it)?(st.enumerable?(h(Ae,G)&&Ae[G][it]&&(Ae[G][it]=!1),st=E(st,{enumerable:N(0,!1)})):(h(Ae,G)||we(Ae,G,N(1,{})),Ae[G][it]=!0),He(Ae,it,st)):we(Ae,it,st)},ee=function(Ae,Fe){x(Ae);var st=b(Fe),it=O(st).concat(Te(st));return re(it,function(lt){d&&!l(te,st,lt)||ie(Ae,lt,st[lt])}),Ae},te=function(Ae){var Fe=v(Ae),st=l(Se,this,Fe);return!(this===H&&h(Me,Fe)&&!h(Oe,Fe))&&(!(st||!h(this,Fe)||!h(Me,Fe)||h(this,G)&&this[G][Fe])||st)},fe=function(Ae,Fe){var st=b(Ae),it=v(Fe);if(st!==H||!h(Me,it)||h(Oe,it)){var lt=Ne(st,it);return!lt||!h(Me,it)||h(st,G)&&st[G][it]||(lt.enumerable=!0),lt}},_e=function(Ae){var Fe=ue(b(Ae)),st=[];return re(Fe,function(it){h(Me,it)||h(S,it)||ke(st,it)}),st},Te=function(Ae){var Fe=Ae===H,st=ue(Fe?Oe:b(Ae)),it=[];return re(st,function(lt){!h(Me,lt)||Fe&&!h(H,lt)||ke(it,Me[lt])}),it};g||(M(oe=(Q=function(){if(f(oe,this))throw new le("Symbol is not a constructor");var Ae=arguments.length&&arguments[0]!==void 0?_(arguments[0]):void 0,Fe=w(Ae),st=function(it){this===H&&l(st,Oe,it),h(this,G)&&h(this[G],Fe)&&(this[G][Fe]=!1);var lt=N(1,it);try{He(this,Fe,lt)}catch(yt){if(!(yt instanceof se))throw yt;Pe(this,Fe,lt)}};return d&&Ie&&He(H,Fe,{configurable:!0,set:st}),ct(Fe,Ae)}).prototype,"toString",function(){return V(this).tag}),M(Q,"withoutSetter",function(Ae){return ct(w(Ae),Ae)}),q.f=te,W.f=ie,Y.f=ee,U.f=fe,F.f=z.f=_e,P.f=Te,A.f=function(Ae){return ct(j(Ae),Ae)},d&&(D(oe,"description",{configurable:!0,get:function(){return V(this).description}}),o||M(H,"propertyIsEnumerable",te,{unsafe:!0}))),i({global:!0,constructor:!0,wrap:!0,forced:!g,sham:!g},{Symbol:Q}),re(O(je),function(Ae){L(Ae)}),i({target:"Symbol",stat:!0,forced:!g},{useSetter:function(){Ie=!0},useSimple:function(){Ie=!1}}),i({target:"Object",stat:!0,forced:!g,sham:!d},{create:function(Ae,Fe){return Fe===void 0?E(Ae):ee(E(Ae),Fe)},defineProperty:ie,defineProperties:ee,getOwnPropertyDescriptor:fe}),i({target:"Object",stat:!0,forced:!g},{getOwnPropertyNames:_e}),I(),Z(Q,"Symbol"),S[G]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/get-built-in"),l=e("../internals/has-own-property"),u=e("../internals/to-string"),o=e("../internals/shared"),d=e("../internals/symbol-registry-detection"),g=o("string-to-symbol-registry"),p=o("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!d},{for:function(h){var f=u(h);if(l(g,f))return g[f];var x=c("Symbol")(f);return g[f]=x,p[x]=f,x}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(e,a,n){e("../modules/es.symbol.constructor"),e("../modules/es.symbol.for"),e("../modules/es.symbol.key-for"),e("../modules/es.json.stringify"),e("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(e,a,n){var i=e("../internals/export"),c=e("../internals/has-own-property"),l=e("../internals/is-symbol"),u=e("../internals/try-to-string"),o=e("../internals/shared"),d=e("../internals/symbol-registry-detection"),g=o("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!d},{keyFor:function(p){if(!l(p))throw new TypeError(u(p)+" is not a symbol");if(c(g,p))return g[p]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(e,a,n){function i(c){return Object.prototype.toString.call(c)}n.isArray=function(c){return Array.isArray?Array.isArray(c):i(c)==="[object Array]"},n.isBoolean=function(c){return typeof c=="boolean"},n.isNull=function(c){return c===null},n.isNullOrUndefined=function(c){return c==null},n.isNumber=function(c){return typeof c=="number"},n.isString=function(c){return typeof c=="string"},n.isSymbol=function(c){return typeof c=="symbol"},n.isUndefined=function(c){return c===void 0},n.isRegExp=function(c){return i(c)==="[object RegExp]"},n.isObject=function(c){return typeof c=="object"&&c!==null},n.isDate=function(c){return i(c)==="[object Date]"},n.isError=function(c){return i(c)==="[object Error]"||c instanceof Error},n.isFunction=function(c){return typeof c=="function"},n.isPrimitive=function(c){return c===null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||typeof c=="symbol"||c===void 0},n.isBuffer=e("buffer").Buffer.isBuffer},{buffer:220}],384:[function(e,a,n){(function(i){(function(){var c=e("elliptic"),l=e("bn.js");a.exports=function(g){return new o(g)};var u={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function o(g){this.curveType=u[g],this.curveType||(this.curveType={name:g}),this.curve=new c.ec(this.curveType.name),this.keys=void 0}function d(g,p,h){Array.isArray(g)||(g=g.toArray());var f=new i(g);if(h&&f.length<h){var x=new i(h-f.length);x.fill(0),f=i.concat([x,f])}return p?f.toString(p):f}u.p224=u.secp224r1,u.p256=u.secp256r1=u.prime256v1,u.p192=u.secp192r1=u.prime192v1,u.p384=u.secp384r1,u.p521=u.secp521r1,o.prototype.generateKeys=function(g,p){return this.keys=this.curve.genKeyPair(),this.getPublicKey(g,p)},o.prototype.computeSecret=function(g,p,h){return p=p||"utf8",i.isBuffer(g)||(g=new i(g,p)),d(this.curve.keyFromPublic(g).getPublic().mul(this.keys.getPrivate()).getX(),h,this.curveType.byteLength)},o.prototype.getPublicKey=function(g,p){var h=this.keys.getPublic(p==="compressed",!0);return p==="hybrid"&&(h[h.length-1]%2?h[0]=7:h[0]=6),d(h,g)},o.prototype.getPrivateKey=function(g){return d(this.keys.getPrivate(),g)},o.prototype.setPublicKey=function(g,p){return p=p||"utf8",i.isBuffer(g)||(g=new i(g,p)),this.keys._importPublic(g),this},o.prototype.setPrivateKey=function(g,p){p=p||"utf8",i.isBuffer(g)||(g=new i(g,p));var h=new l(g);return h=h.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(h),this}}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],386:[function(e,a,n){var i=e("inherits"),c=e("md5.js"),l=e("ripemd160"),u=e("sha.js"),o=e("cipher-base");function d(g){o.call(this,"digest"),this._hash=g}i(d,o),d.prototype._update=function(g){this._hash.update(g)},d.prototype._final=function(){return this._hash.digest()},a.exports=function(g){return(g=g.toLowerCase())==="md5"?new c:g==="rmd160"||g==="ripemd160"?new l:new d(u(g))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(e,a,n){var i=e("md5.js");a.exports=function(c){return new i().update(c).digest()}},{"md5.js":450}],388:[function(e,a,n){var i=e("inherits"),c=e("./legacy"),l=e("cipher-base"),u=e("safe-buffer").Buffer,o=e("create-hash/md5"),d=e("ripemd160"),g=e("sha.js"),p=u.alloc(128);function h(f,x){l.call(this,"digest"),typeof x=="string"&&(x=u.from(x));var b=f==="sha512"||f==="sha384"?128:64;this._alg=f,this._key=x,x.length>b?x=(f==="rmd160"?new d:g(f)).update(x).digest():x.length<b&&(x=u.concat([x,p],b));for(var v=this._ipad=u.allocUnsafe(b),_=this._opad=u.allocUnsafe(b),N=0;N<b;N++)v[N]=54^x[N],_[N]=92^x[N];this._hash=f==="rmd160"?new d:g(f),this._hash.update(v)}i(h,l),h.prototype._update=function(f){this._hash.update(f)},h.prototype._final=function(){var f=this._hash.digest();return(this._alg==="rmd160"?new d:g(this._alg)).update(this._opad).update(f).digest()},a.exports=function(f,x){return(f=f.toLowerCase())==="rmd160"||f==="ripemd160"?new h("rmd160",x):f==="md5"?new c(o,x):new h(f,x)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(e,a,n){var i=e("inherits"),c=e("safe-buffer").Buffer,l=e("cipher-base"),u=c.alloc(128);function o(d,g){l.call(this,"digest"),typeof g=="string"&&(g=c.from(g)),this._alg=d,this._key=g,g.length>64?g=d(g):g.length<64&&(g=c.concat([g,u],64));for(var p=this._ipad=c.allocUnsafe(64),h=this._opad=c.allocUnsafe(64),f=0;f<64;f++)p[f]=54^g[f],h[f]=92^g[f];this._hash=[p]}i(o,l),o.prototype._update=function(d){this._hash.push(d)},o.prototype._final=function(){var d=this._alg(c.concat(this._hash));return this._alg(c.concat([this._opad,d]))},a.exports=o},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(e,a,n){n.randomBytes=n.rng=n.pseudoRandomBytes=n.prng=e("randombytes"),n.createHash=n.Hash=e("create-hash"),n.createHmac=n.Hmac=e("create-hmac");var i=e("browserify-sign/algos"),c=Object.keys(i),l=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(c);n.getHashes=function(){return l};var u=e("pbkdf2");n.pbkdf2=u.pbkdf2,n.pbkdf2Sync=u.pbkdf2Sync;var o=e("browserify-cipher");n.Cipher=o.Cipher,n.createCipher=o.createCipher,n.Cipheriv=o.Cipheriv,n.createCipheriv=o.createCipheriv,n.Decipher=o.Decipher,n.createDecipher=o.createDecipher,n.Decipheriv=o.Decipheriv,n.createDecipheriv=o.createDecipheriv,n.getCiphers=o.getCiphers,n.listCiphers=o.listCiphers;var d=e("diffie-hellman");n.DiffieHellmanGroup=d.DiffieHellmanGroup,n.createDiffieHellmanGroup=d.createDiffieHellmanGroup,n.getDiffieHellman=d.getDiffieHellman,n.createDiffieHellman=d.createDiffieHellman,n.DiffieHellman=d.DiffieHellman;var g=e("browserify-sign");n.createSign=g.createSign,n.Sign=g.Sign,n.createVerify=g.createVerify,n.Verify=g.Verify,n.createECDH=e("create-ecdh");var p=e("public-encrypt");n.publicEncrypt=p.publicEncrypt,n.privateEncrypt=p.privateEncrypt,n.publicDecrypt=p.publicDecrypt,n.privateDecrypt=p.privateDecrypt;var h=e("randomfill");n.randomFill=h.randomFill,n.randomFillSync=h.randomFillSync,n.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},n.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(e,a,n){(function(i,c){typeof n=="object"&&a!==void 0?a.exports=c():(i=typeof globalThis<"u"?globalThis:i||self).dayjs=c()})(void 0,function(){var i=6e4,c=36e5,l="millisecond",u="second",o="minute",d="hour",g="day",p="week",h="month",f="quarter",x="year",b="date",v="Invalid Date",_=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,E={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(C){var S=["th","st","nd","rd"],w=C%100;return"["+C+(S[(w-20)%10]||S[w]||S[0])+"]"}},O=function(C,S,w){var j=String(C);return!j||j.length>=S?C:""+Array(S+1-j.length).join(w)+C},F={s:O,z:function(C){var S=-C.utcOffset(),w=Math.abs(S),j=Math.floor(w/60),A=w%60;return(S<=0?"+":"-")+O(j,2,"0")+":"+O(A,2,"0")},m:function C(S,w){if(S.date()<w.date())return-C(w,S);var j=12*(w.year()-S.year())+(w.month()-S.month()),A=S.clone().add(j,h),L=w-A<0,I=S.clone().add(j+(L?-1:1),h);return+(-(j+(w-A)/(L?A-I:I-A))||0)},a:function(C){return C<0?Math.ceil(C)||0:Math.floor(C)},p:function(C){return{M:h,y:x,w:p,d:g,D:b,h:d,m:o,s:u,ms:l,Q:f}[C]||String(C||"").toLowerCase().replace(/s$/,"")},u:function(C){return C===void 0}},z="en",P={};P[z]=E;var U="$isDayjsObject",W=function(C){return C instanceof D||!(!C||!C[U])},Y=function C(S,w,j){var A;if(!S)return z;if(typeof S=="string"){var L=S.toLowerCase();P[L]&&(A=L),w&&(P[L]=w,A=L);var I=S.split("-");if(!A&&I.length>1)return C(I[0])}else{var Z=S.name;P[Z]=S,A=Z}return!j&&A&&(z=A),A||!j&&z},q=function(C,S){if(W(C))return C.clone();var w=typeof S=="object"?S:{};return w.date=C,w.args=arguments,new D(w)},M=F;M.l=Y,M.i=W,M.w=function(C,S){return q(C,{locale:S.$L,utc:S.$u,x:S.$x,$offset:S.$offset})};var D=function(){function C(w){this.$L=Y(w.locale,null,!0),this.parse(w),this.$x=this.$x||w.x||{},this[U]=!0}var S=C.prototype;return S.parse=function(w){this.$d=function(j){var A=j.date,L=j.utc;if(A===null)return new Date(NaN);if(M.u(A))return new Date;if(A instanceof Date)return new Date(A);if(typeof A=="string"&&!/Z$/i.test(A)){var I=A.match(_);if(I){var Z=I[2]-1||0,K=(I[7]||"0").substring(0,3);return L?new Date(Date.UTC(I[1],Z,I[3]||1,I[4]||0,I[5]||0,I[6]||0,K)):new Date(I[1],Z,I[3]||1,I[4]||0,I[5]||0,I[6]||0,K)}}return new Date(A)}(w),this.init()},S.init=function(){var w=this.$d;this.$y=w.getFullYear(),this.$M=w.getMonth(),this.$D=w.getDate(),this.$W=w.getDay(),this.$H=w.getHours(),this.$m=w.getMinutes(),this.$s=w.getSeconds(),this.$ms=w.getMilliseconds()},S.$utils=function(){return M},S.isValid=function(){return this.$d.toString()!==v},S.isSame=function(w,j){var A=q(w);return this.startOf(j)<=A&&A<=this.endOf(j)},S.isAfter=function(w,j){return q(w)<this.startOf(j)},S.isBefore=function(w,j){return this.endOf(j)<q(w)},S.$g=function(w,j,A){return M.u(w)?this[j]:this.set(A,w)},S.unix=function(){return Math.floor(this.valueOf()/1e3)},S.valueOf=function(){return this.$d.getTime()},S.startOf=function(w,j){var A=this,L=!!M.u(j)||j,I=M.p(w),Z=function(oe,se){var le=M.w(A.$u?Date.UTC(A.$y,se,oe):new Date(A.$y,se,oe),A);return L?le:le.endOf(g)},K=function(oe,se){return M.w(A.toDate()[oe].apply(A.toDate("s"),(L?[0,0,0,0]:[23,59,59,999]).slice(se)),A)},re=this.$W,G=this.$M,ae=this.$D,V="set"+(this.$u?"UTC":"");switch(I){case x:return L?Z(1,0):Z(31,11);case h:return L?Z(1,G):Z(0,G+1);case p:var H=this.$locale().weekStart||0,Q=(re<H?re+7:re)-H;return Z(L?ae-Q:ae+(6-Q),G);case g:case b:return K(V+"Hours",0);case d:return K(V+"Minutes",1);case o:return K(V+"Seconds",2);case u:return K(V+"Milliseconds",3);default:return this.clone()}},S.endOf=function(w){return this.startOf(w,!1)},S.$set=function(w,j){var A,L=M.p(w),I="set"+(this.$u?"UTC":""),Z=(A={},A[g]=I+"Date",A[b]=I+"Date",A[h]=I+"Month",A[x]=I+"FullYear",A[d]=I+"Hours",A[o]=I+"Minutes",A[u]=I+"Seconds",A[l]=I+"Milliseconds",A)[L],K=L===g?this.$D+(j-this.$W):j;if(L===h||L===x){var re=this.clone().set(b,1);re.$d[Z](K),re.init(),this.$d=re.set(b,Math.min(this.$D,re.daysInMonth())).$d}else Z&&this.$d[Z](K);return this.init(),this},S.set=function(w,j){return this.clone().$set(w,j)},S.get=function(w){return this[M.p(w)]()},S.add=function(w,j){var A,L=this;w=Number(w);var I=M.p(j),Z=function(G){var ae=q(L);return M.w(ae.date(ae.date()+Math.round(G*w)),L)};if(I===h)return this.set(h,this.$M+w);if(I===x)return this.set(x,this.$y+w);if(I===g)return Z(1);if(I===p)return Z(7);var K=(A={},A[o]=i,A[d]=c,A[u]=1e3,A)[I]||1,re=this.$d.getTime()+w*K;return M.w(re,this)},S.subtract=function(w,j){return this.add(-1*w,j)},S.format=function(w){var j=this,A=this.$locale();if(!this.isValid())return A.invalidDate||v;var L=w||"YYYY-MM-DDTHH:mm:ssZ",I=M.z(this),Z=this.$H,K=this.$m,re=this.$M,G=A.weekdays,ae=A.months,V=A.meridiem,H=function(se,le,he,Ne){return se&&(se[le]||se(j,L))||he[le].slice(0,Ne)},Q=function(se){return M.s(Z%12||12,se,"0")},oe=V||function(se,le,he){var Ne=se<12?"AM":"PM";return he?Ne.toLowerCase():Ne};return L.replace(N,function(se,le){return le||function(he){switch(he){case"YY":return String(j.$y).slice(-2);case"YYYY":return M.s(j.$y,4,"0");case"M":return re+1;case"MM":return M.s(re+1,2,"0");case"MMM":return H(A.monthsShort,re,ae,3);case"MMMM":return H(ae,re);case"D":return j.$D;case"DD":return M.s(j.$D,2,"0");case"d":return String(j.$W);case"dd":return H(A.weekdaysMin,j.$W,G,2);case"ddd":return H(A.weekdaysShort,j.$W,G,3);case"dddd":return G[j.$W];case"H":return String(Z);case"HH":return M.s(Z,2,"0");case"h":return Q(1);case"hh":return Q(2);case"a":return oe(Z,K,!0);case"A":return oe(Z,K,!1);case"m":return String(K);case"mm":return M.s(K,2,"0");case"s":return String(j.$s);case"ss":return M.s(j.$s,2,"0");case"SSS":return M.s(j.$ms,3,"0");case"Z":return I}return null}(se)||I.replace(":","")})},S.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},S.diff=function(w,j,A){var L,I=this,Z=M.p(j),K=q(w),re=(K.utcOffset()-this.utcOffset())*i,G=this-K,ae=function(){return M.m(I,K)};switch(Z){case x:L=ae()/12;break;case h:L=ae();break;case f:L=ae()/3;break;case p:L=(G-re)/6048e5;break;case g:L=(G-re)/864e5;break;case d:L=G/c;break;case o:L=G/i;break;case u:L=G/1e3;break;default:L=G}return A?L:M.a(L)},S.daysInMonth=function(){return this.endOf(h).$D},S.$locale=function(){return P[this.$L]},S.locale=function(w,j){if(!w)return this.$L;var A=this.clone(),L=Y(w,j,!0);return L&&(A.$L=L),A},S.clone=function(){return M.w(this.$d,this)},S.toDate=function(){return new Date(this.valueOf())},S.toJSON=function(){return this.isValid()?this.toISOString():null},S.toISOString=function(){return this.$d.toISOString()},S.toString=function(){return this.$d.toUTCString()},C}(),T=D.prototype;return q.prototype=T,[["$ms",l],["$s",u],["$m",o],["$H",d],["$W",g],["$M",h],["$y",x],["$D",b]].forEach(function(C){T[C[1]]=function(S){return this.$g(S,C[0],C[1])}}),q.extend=function(C,S){return C.$i||(C(S,D,q),C.$i=!0),q},q.locale=Y,q.isDayjs=W,q.unix=function(C){return q(1e3*C)},q.en=P[z],q.Ls=P,q.p={},q})},{}],392:[function(e,a,n){(function(i,c){typeof n=="object"&&a!==void 0?a.exports=c():(i=typeof globalThis<"u"?globalThis:i||self).dayjs_plugin_customParseFormat=c()})(void 0,function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},c=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d\d/,u=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,d={},g=function(_){return(_=+_)+(_>68?1900:2e3)},p=function(_){return function(N){this[_]=+N}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(_){(this.zone||(this.zone={})).offset=function(N){if(!N||N==="Z")return 0;var E=N.match(/([+-]|\d\d)/g),O=60*E[1]+(+E[2]||0);return O===0?0:E[0]==="+"?-O:O}(_)}],f=function(_){var N=d[_];return N&&(N.indexOf?N:N.s.concat(N.f))},x=function(_,N){var E,O=d.meridiem;if(O){for(var F=1;F<=24;F+=1)if(_.indexOf(O(F,0,N))>-1){E=F>12;break}}else E=_===(N?"pm":"PM");return E},b={A:[o,function(_){this.afternoon=x(_,!1)}],a:[o,function(_){this.afternoon=x(_,!0)}],S:[/\d/,function(_){this.milliseconds=100*+_}],SS:[l,function(_){this.milliseconds=10*+_}],SSS:[/\d{3}/,function(_){this.milliseconds=+_}],s:[u,p("seconds")],ss:[u,p("seconds")],m:[u,p("minutes")],mm:[u,p("minutes")],H:[u,p("hours")],h:[u,p("hours")],HH:[u,p("hours")],hh:[u,p("hours")],D:[u,p("day")],DD:[l,p("day")],Do:[o,function(_){var N=d.ordinal,E=_.match(/\d+/);if(this.day=E[0],N)for(var O=1;O<=31;O+=1)N(O).replace(/\[|\]/g,"")===_&&(this.day=O)}],M:[u,p("month")],MM:[l,p("month")],MMM:[o,function(_){var N=f("months"),E=(f("monthsShort")||N.map(function(O){return O.slice(0,3)})).indexOf(_)+1;if(E<1)throw new Error;this.month=E%12||E}],MMMM:[o,function(_){var N=f("months").indexOf(_)+1;if(N<1)throw new Error;this.month=N%12||N}],Y:[/[+-]?\d+/,p("year")],YY:[l,function(_){this.year=g(_)}],YYYY:[/\d{4}/,p("year")],Z:h,ZZ:h};function v(_){var N,E;N=_,E=d&&d.formats;for(var O=(_=N.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(q,M,D){var T=D&&D.toUpperCase();return M||E[D]||i[D]||E[T].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(C,S,w){return S||w.slice(1)})})).match(c),F=O.length,z=0;z<F;z+=1){var P=O[z],U=b[P],W=U&&U[0],Y=U&&U[1];O[z]=Y?{regex:W,parser:Y}:P.replace(/^\[|\]$/g,"")}return function(q){for(var M={},D=0,T=0;D<F;D+=1){var C=O[D];if(typeof C=="string")T+=C.length;else{var S=C.regex,w=C.parser,j=q.slice(T),A=S.exec(j)[0];w.call(M,A),q=q.replace(A,"")}}return function(L){var I=L.afternoon;if(I!==void 0){var Z=L.hours;I?Z<12&&(L.hours+=12):Z===12&&(L.hours=0),delete L.afternoon}}(M),M}}return function(_,N,E){E.p.customParseFormat=!0,_&&_.parseTwoDigitYear&&(g=_.parseTwoDigitYear);var O=N.prototype,F=O.parse;O.parse=function(z){var P=z.date,U=z.utc,W=z.args;this.$u=U;var Y=W[1];if(typeof Y=="string"){var q=W[2]===!0,M=W[3]===!0,D=q||M,T=W[2];M&&(T=W[2]),d=this.$locale(),!q&&T&&(d=E.Ls[T]),this.$d=function(j,A,L){try{if(["x","X"].indexOf(A)>-1)return new Date((A==="X"?1e3:1)*j);var I=v(A)(j),Z=I.year,K=I.month,re=I.day,G=I.hours,ae=I.minutes,V=I.seconds,H=I.milliseconds,Q=I.zone,oe=new Date,se=re||(Z||K?1:oe.getDate()),le=Z||oe.getFullYear(),he=0;Z&&!K||(he=K>0?K-1:oe.getMonth());var Ne=G||0,we=ae||0,ue=V||0,Se=H||0;return Q?new Date(Date.UTC(le,he,se,Ne,we,ue,Se+60*Q.offset*1e3)):L?new Date(Date.UTC(le,he,se,Ne,we,ue,Se)):new Date(le,he,se,Ne,we,ue,Se)}catch{return new Date("")}}(P,Y,U),this.init(),T&&T!==!0&&(this.$L=this.locale(T).$L),D&&P!=this.format(Y)&&(this.$d=new Date("")),d={}}else if(Y instanceof Array)for(var C=Y.length,S=1;S<=C;S+=1){W[1]=Y[S-1];var w=E.apply(this,W);if(w.isValid()){this.$d=w.$d,this.$L=w.$L,this.init();break}S===C&&(this.$d=new Date(""))}else F.call(this,z)}}})},{}],393:[function(e,a,n){(function(i,c){typeof n=="object"&&a!==void 0?a.exports=c():(i=typeof globalThis<"u"?globalThis:i||self).dayjs_plugin_utc=c()})(void 0,function(){var i="minute",c=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g;return function(u,o,d){var g=o.prototype;d.utc=function(_){var N={date:_,utc:!0,args:arguments};return new o(N)},g.utc=function(_){var N=d(this.toDate(),{locale:this.$L,utc:!0});return _?N.add(this.utcOffset(),i):N},g.local=function(){return d(this.toDate(),{locale:this.$L,utc:!1})};var p=g.parse;g.parse=function(_){_.utc&&(this.$u=!0),this.$utils().u(_.$offset)||(this.$offset=_.$offset),p.call(this,_)};var h=g.init;g.init=function(){if(this.$u){var _=this.$d;this.$y=_.getUTCFullYear(),this.$M=_.getUTCMonth(),this.$D=_.getUTCDate(),this.$W=_.getUTCDay(),this.$H=_.getUTCHours(),this.$m=_.getUTCMinutes(),this.$s=_.getUTCSeconds(),this.$ms=_.getUTCMilliseconds()}else h.call(this)};var f=g.utcOffset;g.utcOffset=function(_,N){var E=this.$utils().u;if(E(_))return this.$u?0:E(this.$offset)?f.call(this):this.$offset;if(typeof _=="string"&&(_=function(P){P===void 0&&(P="");var U=P.match(c);if(!U)return null;var W=(""+U[0]).match(l)||["-",0,0],Y=W[0],q=60*+W[1]+ +W[2];return q===0?0:Y==="+"?q:-q}(_))===null)return this;var O=Math.abs(_)<=16?60*_:_,F=this;if(N)return F.$offset=O,F.$u=_===0,F;if(_!==0){var z=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(F=this.local().add(O+z,i)).$offset=O,F.$x.$localOffset=z}else F=this.utc();return F};var x=g.format;g.format=function(_){var N=_||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return x.call(this,N)},g.valueOf=function(){var _=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*_},g.isUTC=function(){return!!this.$u},g.toISOString=function(){return this.toDate().toISOString()},g.toString=function(){return this.toDate().toUTCString()};var b=g.toDate;g.toDate=function(_){return _==="s"&&this.$offset?d(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():b.call(this)};var v=g.diff;g.diff=function(_,N,E){if(_&&this.$u===_.$u)return v.call(this,_,N,E);var O=this.local(),F=d(_).local();return v.call(O,F,N,E)}}})},{}],394:[function(e,a,n){n.utils=e("./des/utils"),n.Cipher=e("./des/cipher"),n.DES=e("./des/des"),n.CBC=e("./des/cbc"),n.EDE=e("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(e,a,n){var i=e("minimalistic-assert"),c=e("inherits"),l={};function u(o){i.equal(o.length,8,"Invalid IV length"),this.iv=new Array(8);for(var d=0;d<this.iv.length;d++)this.iv[d]=o[d]}n.instantiate=function(o){function d(f){o.call(this,f),this._cbcInit()}c(d,o);for(var g=Object.keys(l),p=0;p<g.length;p++){var h=g[p];d.prototype[h]=l[h]}return d.create=function(f){return new d(f)},d},l._cbcInit=function(){var o=new u(this.options.iv);this._cbcState=o},l._update=function(o,d,g,p){var h=this._cbcState,f=this.constructor.super_.prototype,x=h.iv;if(this.type==="encrypt"){for(var b=0;b<this.blockSize;b++)x[b]^=o[d+b];for(f._update.call(this,x,0,g,p),b=0;b<this.blockSize;b++)x[b]=g[p+b]}else{for(f._update.call(this,o,d,g,p),b=0;b<this.blockSize;b++)g[p+b]^=x[b];for(b=0;b<this.blockSize;b++)x[b]=o[d+b]}}},{inherits:440,"minimalistic-assert":453}],396:[function(e,a,n){var i=e("minimalistic-assert");function c(l){this.options=l,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=l.padding!==!1}a.exports=c,c.prototype._init=function(){},c.prototype.update=function(l){return l.length===0?[]:this.type==="decrypt"?this._updateDecrypt(l):this._updateEncrypt(l)},c.prototype._buffer=function(l,u){for(var o=Math.min(this.buffer.length-this.bufferOff,l.length-u),d=0;d<o;d++)this.buffer[this.bufferOff+d]=l[u+d];return this.bufferOff+=o,o},c.prototype._flushBuffer=function(l,u){return this._update(this.buffer,0,l,u),this.bufferOff=0,this.blockSize},c.prototype._updateEncrypt=function(l){var u=0,o=0,d=(this.bufferOff+l.length)/this.blockSize|0,g=new Array(d*this.blockSize);this.bufferOff!==0&&(u+=this._buffer(l,u),this.bufferOff===this.buffer.length&&(o+=this._flushBuffer(g,o)));for(var p=l.length-(l.length-u)%this.blockSize;u<p;u+=this.blockSize)this._update(l,u,g,o),o+=this.blockSize;for(;u<l.length;u++,this.bufferOff++)this.buffer[this.bufferOff]=l[u];return g},c.prototype._updateDecrypt=function(l){for(var u=0,o=0,d=Math.ceil((this.bufferOff+l.length)/this.blockSize)-1,g=new Array(d*this.blockSize);d>0;d--)u+=this._buffer(l,u),o+=this._flushBuffer(g,o);return u+=this._buffer(l,u),g},c.prototype.final=function(l){var u,o;return l&&(u=this.update(l)),o=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),u?u.concat(o):o},c.prototype._pad=function(l,u){if(u===0)return!1;for(;u<l.length;)l[u++]=0;return!0},c.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var l=new Array(this.blockSize);return this._update(this.buffer,0,l,0),l},c.prototype._unpad=function(l){return l},c.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var l=new Array(this.blockSize);return this._flushBuffer(l,0),this._unpad(l)}},{"minimalistic-assert":453}],397:[function(e,a,n){var i=e("minimalistic-assert"),c=e("inherits"),l=e("./utils"),u=e("./cipher");function o(){this.tmp=new Array(2),this.keys=null}function d(p){u.call(this,p);var h=new o;this._desState=h,this.deriveKeys(h,p.key)}c(d,u),a.exports=d,d.create=function(p){return new d(p)};var g=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];d.prototype.deriveKeys=function(p,h){p.keys=new Array(32),i.equal(h.length,this.blockSize,"Invalid key length");var f=l.readUInt32BE(h,0),x=l.readUInt32BE(h,4);l.pc1(f,x,p.tmp,0),f=p.tmp[0],x=p.tmp[1];for(var b=0;b<p.keys.length;b+=2){var v=g[b>>>1];f=l.r28shl(f,v),x=l.r28shl(x,v),l.pc2(f,x,p.keys,b)}},d.prototype._update=function(p,h,f,x){var b=this._desState,v=l.readUInt32BE(p,h),_=l.readUInt32BE(p,h+4);l.ip(v,_,b.tmp,0),v=b.tmp[0],_=b.tmp[1],this.type==="encrypt"?this._encrypt(b,v,_,b.tmp,0):this._decrypt(b,v,_,b.tmp,0),v=b.tmp[0],_=b.tmp[1],l.writeUInt32BE(f,v,x),l.writeUInt32BE(f,_,x+4)},d.prototype._pad=function(p,h){if(this.padding===!1)return!1;for(var f=p.length-h,x=h;x<p.length;x++)p[x]=f;return!0},d.prototype._unpad=function(p){if(this.padding===!1)return p;for(var h=p[p.length-1],f=p.length-h;f<p.length;f++)i.equal(p[f],h);return p.slice(0,p.length-h)},d.prototype._encrypt=function(p,h,f,x,b){for(var v=h,_=f,N=0;N<p.keys.length;N+=2){var E=p.keys[N],O=p.keys[N+1];l.expand(_,p.tmp,0),E^=p.tmp[0],O^=p.tmp[1];var F=l.substitute(E,O),z=_;_=(v^l.permute(F))>>>0,v=z}l.rip(_,v,x,b)},d.prototype._decrypt=function(p,h,f,x,b){for(var v=f,_=h,N=p.keys.length-2;N>=0;N-=2){var E=p.keys[N],O=p.keys[N+1];l.expand(v,p.tmp,0),E^=p.tmp[0],O^=p.tmp[1];var F=l.substitute(E,O),z=v;v=(_^l.permute(F))>>>0,_=z}l.rip(v,_,x,b)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(e,a,n){var i=e("minimalistic-assert"),c=e("inherits"),l=e("./cipher"),u=e("./des");function o(g,p){i.equal(p.length,24,"Invalid key length");var h=p.slice(0,8),f=p.slice(8,16),x=p.slice(16,24);this.ciphers=g==="encrypt"?[u.create({type:"encrypt",key:h}),u.create({type:"decrypt",key:f}),u.create({type:"encrypt",key:x})]:[u.create({type:"decrypt",key:x}),u.create({type:"encrypt",key:f}),u.create({type:"decrypt",key:h})]}function d(g){l.call(this,g);var p=new o(this.type,this.options.key);this._edeState=p}c(d,l),a.exports=d,d.create=function(g){return new d(g)},d.prototype._update=function(g,p,h,f){var x=this._edeState;x.ciphers[0]._update(g,p,h,f),x.ciphers[1]._update(h,f,h,f),x.ciphers[2]._update(h,f,h,f)},d.prototype._pad=u.prototype._pad,d.prototype._unpad=u.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(e,a,n){n.readUInt32BE=function(u,o){return(u[0+o]<<24|u[1+o]<<16|u[2+o]<<8|u[3+o])>>>0},n.writeUInt32BE=function(u,o,d){u[0+d]=o>>>24,u[1+d]=o>>>16&255,u[2+d]=o>>>8&255,u[3+d]=255&o},n.ip=function(u,o,d,g){for(var p=0,h=0,f=6;f>=0;f-=2){for(var x=0;x<=24;x+=8)p<<=1,p|=o>>>x+f&1;for(x=0;x<=24;x+=8)p<<=1,p|=u>>>x+f&1}for(f=6;f>=0;f-=2){for(x=1;x<=25;x+=8)h<<=1,h|=o>>>x+f&1;for(x=1;x<=25;x+=8)h<<=1,h|=u>>>x+f&1}d[g+0]=p>>>0,d[g+1]=h>>>0},n.rip=function(u,o,d,g){for(var p=0,h=0,f=0;f<4;f++)for(var x=24;x>=0;x-=8)p<<=1,p|=o>>>x+f&1,p<<=1,p|=u>>>x+f&1;for(f=4;f<8;f++)for(x=24;x>=0;x-=8)h<<=1,h|=o>>>x+f&1,h<<=1,h|=u>>>x+f&1;d[g+0]=p>>>0,d[g+1]=h>>>0},n.pc1=function(u,o,d,g){for(var p=0,h=0,f=7;f>=5;f--){for(var x=0;x<=24;x+=8)p<<=1,p|=o>>x+f&1;for(x=0;x<=24;x+=8)p<<=1,p|=u>>x+f&1}for(x=0;x<=24;x+=8)p<<=1,p|=o>>x+f&1;for(f=1;f<=3;f++){for(x=0;x<=24;x+=8)h<<=1,h|=o>>x+f&1;for(x=0;x<=24;x+=8)h<<=1,h|=u>>x+f&1}for(x=0;x<=24;x+=8)h<<=1,h|=u>>x+f&1;d[g+0]=p>>>0,d[g+1]=h>>>0},n.r28shl=function(u,o){return u<<o&268435455|u>>>28-o};var i=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];n.pc2=function(u,o,d,g){for(var p=0,h=0,f=i.length>>>1,x=0;x<f;x++)p<<=1,p|=u>>>i[x]&1;for(x=f;x<i.length;x++)h<<=1,h|=o>>>i[x]&1;d[g+0]=p>>>0,d[g+1]=h>>>0},n.expand=function(u,o,d){var g=0,p=0;g=(1&u)<<5|u>>>27;for(var h=23;h>=15;h-=4)g<<=6,g|=u>>>h&63;for(h=11;h>=3;h-=4)p|=u>>>h&63,p<<=6;p|=(31&u)<<1|u>>>31,o[d+0]=g>>>0,o[d+1]=p>>>0};var c=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];n.substitute=function(u,o){for(var d=0,g=0;g<4;g++)d<<=4,d|=c[64*g+(u>>>18-6*g&63)];for(g=0;g<4;g++)d<<=4,d|=c[256+64*g+(o>>>18-6*g&63)];return d>>>0};var l=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];n.permute=function(u){for(var o=0,d=0;d<l.length;d++)o<<=1,o|=u>>>l[d]&1;return o>>>0},n.padSplit=function(u,o,d){for(var g=u.toString(2);g.length<o;)g="0"+g;for(var p=[],h=0;h<o;h+=d)p.push(g.slice(h,h+d));return p.join(" ")}},{}],400:[function(e,a,n){(function(i){(function(){var c=e("./lib/generatePrime"),l=e("./lib/primes.json"),u=e("./lib/dh"),o={binary:!0,hex:!0,base64:!0};n.DiffieHellmanGroup=n.createDiffieHellmanGroup=n.getDiffieHellman=function(d){var g=new i(l[d].prime,"hex"),p=new i(l[d].gen,"hex");return new u(g,p)},n.createDiffieHellman=n.DiffieHellman=function d(g,p,h,f){return i.isBuffer(p)||o[p]===void 0?d(g,"binary",p,h):(p=p||"binary",f=f||"binary",h=h||new i([2]),i.isBuffer(h)||(h=new i(h,f)),typeof g=="number"?new u(c(g,h),h,!0):(i.isBuffer(g)||(g=new i(g,p)),new u(g,h,!0)))}}).call(this)}).call(this,e("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(e,a,n){(function(i){(function(){var c=e("bn.js"),l=new(e("miller-rabin")),u=new c(24),o=new c(11),d=new c(10),g=new c(3),p=new c(7),h=e("./generatePrime"),f=e("randombytes");function x(E,O){return O=O||"utf8",i.isBuffer(E)||(E=new i(E,O)),this._pub=new c(E),this}function b(E,O){return O=O||"utf8",i.isBuffer(E)||(E=new i(E,O)),this._priv=new c(E),this}a.exports=_;var v={};function _(E,O,F){this.setGenerator(O),this.__prime=new c(E),this._prime=c.mont(this.__prime),this._primeLen=E.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,F?(this.setPublicKey=x,this.setPrivateKey=b):this._primeCode=8}function N(E,O){var F=new i(E.toArray());return O?F.toString(O):F}Object.defineProperty(_.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(E,O){var F=O.toString("hex"),z=[F,E.toString(16)].join("_");if(z in v)return v[z];var P,U=0;if(E.isEven()||!h.simpleSieve||!h.fermatTest(E)||!l.test(E))return U+=1,U+=F==="02"||F==="05"?8:4,v[z]=U,U;switch(l.test(E.shrn(1))||(U+=2),F){case"02":E.mod(u).cmp(o)&&(U+=8);break;case"05":(P=E.mod(d)).cmp(g)&&P.cmp(p)&&(U+=8);break;default:U+=4}return v[z]=U,U}(this.__prime,this.__gen)),this._primeCode}}),_.prototype.generateKeys=function(){return this._priv||(this._priv=new c(f(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},_.prototype.computeSecret=function(E){var O=(E=(E=new c(E)).toRed(this._prime)).redPow(this._priv).fromRed(),F=new i(O.toArray()),z=this.getPrime();if(F.length<z.length){var P=new i(z.length-F.length);P.fill(0),F=i.concat([P,F])}return F},_.prototype.getPublicKey=function(E){return N(this._pub,E)},_.prototype.getPrivateKey=function(E){return N(this._priv,E)},_.prototype.getPrime=function(E){return N(this.__prime,E)},_.prototype.getGenerator=function(E){return N(this._gen,E)},_.prototype.setGenerator=function(E,O){return O=O||"utf8",i.isBuffer(E)||(E=new i(E,O)),this.__gen=E,this._gen=new c(E),this}}).call(this)}).call(this,e("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(e,a,n){var i=e("randombytes");a.exports=E,E.simpleSieve=_,E.fermatTest=N;var c=e("bn.js"),l=new c(24),u=new(e("miller-rabin")),o=new c(1),d=new c(2),g=new c(5),p=(new c(16),new c(8),new c(10)),h=new c(3),f=(new c(7),new c(11)),x=new c(4),b=(new c(12),null);function v(){if(b!==null)return b;var O=[];O[0]=2;for(var F=1,z=3;z<1048576;z+=2){for(var P=Math.ceil(Math.sqrt(z)),U=0;U<F&&O[U]<=P&&z%O[U]!=0;U++);F!==U&&O[U]<=P||(O[F++]=z)}return b=O,O}function _(O){for(var F=v(),z=0;z<F.length;z++)if(O.modn(F[z])===0)return O.cmpn(F[z])===0;return!0}function N(O){var F=c.mont(O);return d.toRed(F).redPow(O.subn(1)).fromRed().cmpn(1)===0}function E(O,F){if(O<16)return new c(F===2||F===5?[140,123]:[140,39]);var z,P;for(F=new c(F);;){for(z=new c(i(Math.ceil(O/8)));z.bitLength()>O;)z.ishrn(1);if(z.isEven()&&z.iadd(o),z.testn(1)||z.iadd(d),F.cmp(d)){if(!F.cmp(g))for(;z.mod(p).cmp(h);)z.iadd(x)}else for(;z.mod(l).cmp(f);)z.iadd(x);if(_(P=z.shrn(1))&&_(z)&&N(P)&&N(z)&&u.test(P)&&u.test(z))return z}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(e,a,n){a.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],405:[function(e,a,n){var i=n;i.version=e("../package.json").version,i.utils=e("./elliptic/utils"),i.rand=e("brorand"),i.curve=e("./elliptic/curve"),i.curves=e("./elliptic/curves"),i.ec=e("./elliptic/ec"),i.eddsa=e("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(e,a,n){var i=e("bn.js"),c=e("../utils"),l=c.getNAF,u=c.getJSF,o=c.assert;function d(p,h){this.type=p,this.p=new i(h.p,16),this.red=h.prime?i.red(h.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=h.n&&new i(h.n,16),this.g=h.g&&this.pointFromJSON(h.g,h.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var f=this.n&&this.p.div(this.n);!f||f.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function g(p,h){this.curve=p,this.type=h,this.precomputed=null}a.exports=d,d.prototype.point=function(){throw new Error("Not implemented")},d.prototype.validate=function(){throw new Error("Not implemented")},d.prototype._fixedNafMul=function(p,h){o(p.precomputed);var f=p._getDoubles(),x=l(h,1,this._bitLength),b=(1<<f.step+1)-(f.step%2==0?2:1);b/=3;var v,_,N=[];for(v=0;v<x.length;v+=f.step){_=0;for(var E=v+f.step-1;E>=v;E--)_=(_<<1)+x[E];N.push(_)}for(var O=this.jpoint(null,null,null),F=this.jpoint(null,null,null),z=b;z>0;z--){for(v=0;v<N.length;v++)(_=N[v])===z?F=F.mixedAdd(f.points[v]):_===-z&&(F=F.mixedAdd(f.points[v].neg()));O=O.add(F)}return O.toP()},d.prototype._wnafMul=function(p,h){var f=4,x=p._getNAFPoints(f);f=x.wnd;for(var b=x.points,v=l(h,f,this._bitLength),_=this.jpoint(null,null,null),N=v.length-1;N>=0;N--){for(var E=0;N>=0&&v[N]===0;N--)E++;if(N>=0&&E++,_=_.dblp(E),N<0)break;var O=v[N];o(O!==0),_=p.type==="affine"?O>0?_.mixedAdd(b[O-1>>1]):_.mixedAdd(b[-O-1>>1].neg()):O>0?_.add(b[O-1>>1]):_.add(b[-O-1>>1].neg())}return p.type==="affine"?_.toP():_},d.prototype._wnafMulAdd=function(p,h,f,x,b){var v,_,N,E=this._wnafT1,O=this._wnafT2,F=this._wnafT3,z=0;for(v=0;v<x;v++){var P=(N=h[v])._getNAFPoints(p);E[v]=P.wnd,O[v]=P.points}for(v=x-1;v>=1;v-=2){var U=v-1,W=v;if(E[U]===1&&E[W]===1){var Y=[h[U],null,null,h[W]];h[U].y.cmp(h[W].y)===0?(Y[1]=h[U].add(h[W]),Y[2]=h[U].toJ().mixedAdd(h[W].neg())):h[U].y.cmp(h[W].y.redNeg())===0?(Y[1]=h[U].toJ().mixedAdd(h[W]),Y[2]=h[U].add(h[W].neg())):(Y[1]=h[U].toJ().mixedAdd(h[W]),Y[2]=h[U].toJ().mixedAdd(h[W].neg()));var q=[-3,-1,-5,-7,0,7,5,1,3],M=u(f[U],f[W]);for(z=Math.max(M[0].length,z),F[U]=new Array(z),F[W]=new Array(z),_=0;_<z;_++){var D=0|M[0][_],T=0|M[1][_];F[U][_]=q[3*(D+1)+(T+1)],F[W][_]=0,O[U]=Y}}else F[U]=l(f[U],E[U],this._bitLength),F[W]=l(f[W],E[W],this._bitLength),z=Math.max(F[U].length,z),z=Math.max(F[W].length,z)}var C=this.jpoint(null,null,null),S=this._wnafT4;for(v=z;v>=0;v--){for(var w=0;v>=0;){var j=!0;for(_=0;_<x;_++)S[_]=0|F[_][v],S[_]!==0&&(j=!1);if(!j)break;w++,v--}if(v>=0&&w++,C=C.dblp(w),v<0)break;for(_=0;_<x;_++){var A=S[_];A!==0&&(A>0?N=O[_][A-1>>1]:A<0&&(N=O[_][-A-1>>1].neg()),C=N.type==="affine"?C.mixedAdd(N):C.add(N))}}for(v=0;v<x;v++)O[v]=null;return b?C:C.toP()},d.BasePoint=g,g.prototype.eq=function(){throw new Error("Not implemented")},g.prototype.validate=function(){return this.curve.validate(this)},d.prototype.decodePoint=function(p,h){p=c.toArray(p,h);var f=this.p.byteLength();if((p[0]===4||p[0]===6||p[0]===7)&&p.length-1==2*f)return p[0]===6?o(p[p.length-1]%2==0):p[0]===7&&o(p[p.length-1]%2==1),this.point(p.slice(1,1+f),p.slice(1+f,1+2*f));if((p[0]===2||p[0]===3)&&p.length-1===f)return this.pointFromX(p.slice(1,1+f),p[0]===3);throw new Error("Unknown point format")},g.prototype.encodeCompressed=function(p){return this.encode(p,!0)},g.prototype._encode=function(p){var h=this.curve.p.byteLength(),f=this.getX().toArray("be",h);return p?[this.getY().isEven()?2:3].concat(f):[4].concat(f,this.getY().toArray("be",h))},g.prototype.encode=function(p,h){return c.encode(this._encode(h),p)},g.prototype.precompute=function(p){if(this.precomputed)return this;var h={doubles:null,naf:null,beta:null};return h.naf=this._getNAFPoints(8),h.doubles=this._getDoubles(4,p),h.beta=this._getBeta(),this.precomputed=h,this},g.prototype._hasDoubles=function(p){if(!this.precomputed)return!1;var h=this.precomputed.doubles;return!!h&&h.points.length>=Math.ceil((p.bitLength()+1)/h.step)},g.prototype._getDoubles=function(p,h){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var f=[this],x=this,b=0;b<h;b+=p){for(var v=0;v<p;v++)x=x.dbl();f.push(x)}return{step:p,points:f}},g.prototype._getNAFPoints=function(p){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var h=[this],f=(1<<p)-1,x=f===1?null:this.dbl(),b=1;b<f;b++)h[b]=h[b-1].add(x);return{wnd:p,points:h}},g.prototype._getBeta=function(){return null},g.prototype.dblp=function(p){for(var h=this,f=0;f<p;f++)h=h.dbl();return h}},{"../utils":419,"bn.js":420}],407:[function(e,a,n){var i=e("../utils"),c=e("bn.js"),l=e("inherits"),u=e("./base"),o=i.assert;function d(p){this.twisted=(0|p.a)!=1,this.mOneA=this.twisted&&(0|p.a)==-1,this.extended=this.mOneA,u.call(this,"edwards",p),this.a=new c(p.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new c(p.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new c(p.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),o(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|p.c)==1}function g(p,h,f,x,b){u.BasePoint.call(this,p,"projective"),h===null&&f===null&&x===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new c(h,16),this.y=new c(f,16),this.z=x?new c(x,16):this.curve.one,this.t=b&&new c(b,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}l(d,u),a.exports=d,d.prototype._mulA=function(p){return this.mOneA?p.redNeg():this.a.redMul(p)},d.prototype._mulC=function(p){return this.oneC?p:this.c.redMul(p)},d.prototype.jpoint=function(p,h,f,x){return this.point(p,h,f,x)},d.prototype.pointFromX=function(p,h){(p=new c(p,16)).red||(p=p.toRed(this.red));var f=p.redSqr(),x=this.c2.redSub(this.a.redMul(f)),b=this.one.redSub(this.c2.redMul(this.d).redMul(f)),v=x.redMul(b.redInvm()),_=v.redSqrt();if(_.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");var N=_.fromRed().isOdd();return(h&&!N||!h&&N)&&(_=_.redNeg()),this.point(p,_)},d.prototype.pointFromY=function(p,h){(p=new c(p,16)).red||(p=p.toRed(this.red));var f=p.redSqr(),x=f.redSub(this.c2),b=f.redMul(this.d).redMul(this.c2).redSub(this.a),v=x.redMul(b.redInvm());if(v.cmp(this.zero)===0){if(h)throw new Error("invalid point");return this.point(this.zero,p)}var _=v.redSqrt();if(_.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");return _.fromRed().isOdd()!==h&&(_=_.redNeg()),this.point(_,p)},d.prototype.validate=function(p){if(p.isInfinity())return!0;p.normalize();var h=p.x.redSqr(),f=p.y.redSqr(),x=h.redMul(this.a).redAdd(f),b=this.c2.redMul(this.one.redAdd(this.d.redMul(h).redMul(f)));return x.cmp(b)===0},l(g,u.BasePoint),d.prototype.pointFromJSON=function(p){return g.fromJSON(this,p)},d.prototype.point=function(p,h,f,x){return new g(this,p,h,f,x)},g.fromJSON=function(p,h){return new g(p,h[0],h[1],h[2])},g.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},g.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},g.prototype._extDbl=function(){var p=this.x.redSqr(),h=this.y.redSqr(),f=this.z.redSqr();f=f.redIAdd(f);var x=this.curve._mulA(p),b=this.x.redAdd(this.y).redSqr().redISub(p).redISub(h),v=x.redAdd(h),_=v.redSub(f),N=x.redSub(h),E=b.redMul(_),O=v.redMul(N),F=b.redMul(N),z=_.redMul(v);return this.curve.point(E,O,z,F)},g.prototype._projDbl=function(){var p,h,f,x,b,v,_=this.x.redAdd(this.y).redSqr(),N=this.x.redSqr(),E=this.y.redSqr();if(this.curve.twisted){var O=(x=this.curve._mulA(N)).redAdd(E);this.zOne?(p=_.redSub(N).redSub(E).redMul(O.redSub(this.curve.two)),h=O.redMul(x.redSub(E)),f=O.redSqr().redSub(O).redSub(O)):(b=this.z.redSqr(),v=O.redSub(b).redISub(b),p=_.redSub(N).redISub(E).redMul(v),h=O.redMul(x.redSub(E)),f=O.redMul(v))}else x=N.redAdd(E),b=this.curve._mulC(this.z).redSqr(),v=x.redSub(b).redSub(b),p=this.curve._mulC(_.redISub(x)).redMul(v),h=this.curve._mulC(x).redMul(N.redISub(E)),f=x.redMul(v);return this.curve.point(p,h,f)},g.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},g.prototype._extAdd=function(p){var h=this.y.redSub(this.x).redMul(p.y.redSub(p.x)),f=this.y.redAdd(this.x).redMul(p.y.redAdd(p.x)),x=this.t.redMul(this.curve.dd).redMul(p.t),b=this.z.redMul(p.z.redAdd(p.z)),v=f.redSub(h),_=b.redSub(x),N=b.redAdd(x),E=f.redAdd(h),O=v.redMul(_),F=N.redMul(E),z=v.redMul(E),P=_.redMul(N);return this.curve.point(O,F,P,z)},g.prototype._projAdd=function(p){var h,f,x=this.z.redMul(p.z),b=x.redSqr(),v=this.x.redMul(p.x),_=this.y.redMul(p.y),N=this.curve.d.redMul(v).redMul(_),E=b.redSub(N),O=b.redAdd(N),F=this.x.redAdd(this.y).redMul(p.x.redAdd(p.y)).redISub(v).redISub(_),z=x.redMul(E).redMul(F);return this.curve.twisted?(h=x.redMul(O).redMul(_.redSub(this.curve._mulA(v))),f=E.redMul(O)):(h=x.redMul(O).redMul(_.redSub(v)),f=this.curve._mulC(E).redMul(O)),this.curve.point(z,h,f)},g.prototype.add=function(p){return this.isInfinity()?p:p.isInfinity()?this:this.curve.extended?this._extAdd(p):this._projAdd(p)},g.prototype.mul=function(p){return this._hasDoubles(p)?this.curve._fixedNafMul(this,p):this.curve._wnafMul(this,p)},g.prototype.mulAdd=function(p,h,f){return this.curve._wnafMulAdd(1,[this,h],[p,f],2,!1)},g.prototype.jmulAdd=function(p,h,f){return this.curve._wnafMulAdd(1,[this,h],[p,f],2,!0)},g.prototype.normalize=function(){if(this.zOne)return this;var p=this.z.redInvm();return this.x=this.x.redMul(p),this.y=this.y.redMul(p),this.t&&(this.t=this.t.redMul(p)),this.z=this.curve.one,this.zOne=!0,this},g.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},g.prototype.getX=function(){return this.normalize(),this.x.fromRed()},g.prototype.getY=function(){return this.normalize(),this.y.fromRed()},g.prototype.eq=function(p){return this===p||this.getX().cmp(p.getX())===0&&this.getY().cmp(p.getY())===0},g.prototype.eqXToP=function(p){var h=p.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(h)===0)return!0;for(var f=p.clone(),x=this.curve.redN.redMul(this.z);;){if(f.iadd(this.curve.n),f.cmp(this.curve.p)>=0)return!1;if(h.redIAdd(x),this.x.cmp(h)===0)return!0}},g.prototype.toP=g.prototype.normalize,g.prototype.mixedAdd=g.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(e,a,n){var i=n;i.base=e("./base"),i.short=e("./short"),i.mont=e("./mont"),i.edwards=e("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(e,a,n){var i=e("bn.js"),c=e("inherits"),l=e("./base"),u=e("../utils");function o(g){l.call(this,"mont",g),this.a=new i(g.a,16).toRed(this.red),this.b=new i(g.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function d(g,p,h){l.BasePoint.call(this,g,"projective"),p===null&&h===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(p,16),this.z=new i(h,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}c(o,l),a.exports=o,o.prototype.validate=function(g){var p=g.normalize().x,h=p.redSqr(),f=h.redMul(p).redAdd(h.redMul(this.a)).redAdd(p);return f.redSqrt().redSqr().cmp(f)===0},c(d,l.BasePoint),o.prototype.decodePoint=function(g,p){return this.point(u.toArray(g,p),1)},o.prototype.point=function(g,p){return new d(this,g,p)},o.prototype.pointFromJSON=function(g){return d.fromJSON(this,g)},d.prototype.precompute=function(){},d.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},d.fromJSON=function(g,p){return new d(g,p[0],p[1]||g.one)},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.z.cmpn(0)===0},d.prototype.dbl=function(){var g=this.x.redAdd(this.z).redSqr(),p=this.x.redSub(this.z).redSqr(),h=g.redSub(p),f=g.redMul(p),x=h.redMul(p.redAdd(this.curve.a24.redMul(h)));return this.curve.point(f,x)},d.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.diffAdd=function(g,p){var h=this.x.redAdd(this.z),f=this.x.redSub(this.z),x=g.x.redAdd(g.z),b=g.x.redSub(g.z).redMul(h),v=x.redMul(f),_=p.z.redMul(b.redAdd(v).redSqr()),N=p.x.redMul(b.redISub(v).redSqr());return this.curve.point(_,N)},d.prototype.mul=function(g){for(var p=g.clone(),h=this,f=this.curve.point(null,null),x=[];p.cmpn(0)!==0;p.iushrn(1))x.push(p.andln(1));for(var b=x.length-1;b>=0;b--)x[b]===0?(h=h.diffAdd(f,this),f=f.dbl()):(f=h.diffAdd(f,this),h=h.dbl());return f},d.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.eq=function(g){return this.getX().cmp(g.getX())===0},d.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},d.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(e,a,n){var i=e("../utils"),c=e("bn.js"),l=e("inherits"),u=e("./base"),o=i.assert;function d(h){u.call(this,"short",h),this.a=new c(h.a,16).toRed(this.red),this.b=new c(h.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(h),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function g(h,f,x,b){u.BasePoint.call(this,h,"affine"),f===null&&x===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new c(f,16),this.y=new c(x,16),b&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function p(h,f,x,b){u.BasePoint.call(this,h,"jacobian"),f===null&&x===null&&b===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new c(0)):(this.x=new c(f,16),this.y=new c(x,16),this.z=new c(b,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}l(d,u),a.exports=d,d.prototype._getEndomorphism=function(h){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var f,x;if(h.beta)f=new c(h.beta,16).toRed(this.red);else{var b=this._getEndoRoots(this.p);f=(f=b[0].cmp(b[1])<0?b[0]:b[1]).toRed(this.red)}if(h.lambda)x=new c(h.lambda,16);else{var v=this._getEndoRoots(this.n);this.g.mul(v[0]).x.cmp(this.g.x.redMul(f))===0?x=v[0]:(x=v[1],o(this.g.mul(x).x.cmp(this.g.x.redMul(f))===0))}return{beta:f,lambda:x,basis:h.basis?h.basis.map(function(_){return{a:new c(_.a,16),b:new c(_.b,16)}}):this._getEndoBasis(x)}}},d.prototype._getEndoRoots=function(h){var f=h===this.p?this.red:c.mont(h),x=new c(2).toRed(f).redInvm(),b=x.redNeg(),v=new c(3).toRed(f).redNeg().redSqrt().redMul(x);return[b.redAdd(v).fromRed(),b.redSub(v).fromRed()]},d.prototype._getEndoBasis=function(h){for(var f,x,b,v,_,N,E,O,F,z=this.n.ushrn(Math.floor(this.n.bitLength()/2)),P=h,U=this.n.clone(),W=new c(1),Y=new c(0),q=new c(0),M=new c(1),D=0;P.cmpn(0)!==0;){var T=U.div(P);O=U.sub(T.mul(P)),F=q.sub(T.mul(W));var C=M.sub(T.mul(Y));if(!b&&O.cmp(z)<0)f=E.neg(),x=W,b=O.neg(),v=F;else if(b&&++D==2)break;E=O,U=P,P=O,q=W,W=F,M=Y,Y=C}_=O.neg(),N=F;var S=b.sqr().add(v.sqr());return _.sqr().add(N.sqr()).cmp(S)>=0&&(_=f,N=x),b.negative&&(b=b.neg(),v=v.neg()),_.negative&&(_=_.neg(),N=N.neg()),[{a:b,b:v},{a:_,b:N}]},d.prototype._endoSplit=function(h){var f=this.endo.basis,x=f[0],b=f[1],v=b.b.mul(h).divRound(this.n),_=x.b.neg().mul(h).divRound(this.n),N=v.mul(x.a),E=_.mul(b.a),O=v.mul(x.b),F=_.mul(b.b);return{k1:h.sub(N).sub(E),k2:O.add(F).neg()}},d.prototype.pointFromX=function(h,f){(h=new c(h,16)).red||(h=h.toRed(this.red));var x=h.redSqr().redMul(h).redIAdd(h.redMul(this.a)).redIAdd(this.b),b=x.redSqrt();if(b.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");var v=b.fromRed().isOdd();return(f&&!v||!f&&v)&&(b=b.redNeg()),this.point(h,b)},d.prototype.validate=function(h){if(h.inf)return!0;var f=h.x,x=h.y,b=this.a.redMul(f),v=f.redSqr().redMul(f).redIAdd(b).redIAdd(this.b);return x.redSqr().redISub(v).cmpn(0)===0},d.prototype._endoWnafMulAdd=function(h,f,x){for(var b=this._endoWnafT1,v=this._endoWnafT2,_=0;_<h.length;_++){var N=this._endoSplit(f[_]),E=h[_],O=E._getBeta();N.k1.negative&&(N.k1.ineg(),E=E.neg(!0)),N.k2.negative&&(N.k2.ineg(),O=O.neg(!0)),b[2*_]=E,b[2*_+1]=O,v[2*_]=N.k1,v[2*_+1]=N.k2}for(var F=this._wnafMulAdd(1,b,v,2*_,x),z=0;z<2*_;z++)b[z]=null,v[z]=null;return F},l(g,u.BasePoint),d.prototype.point=function(h,f,x){return new g(this,h,f,x)},d.prototype.pointFromJSON=function(h,f){return g.fromJSON(this,h,f)},g.prototype._getBeta=function(){if(this.curve.endo){var h=this.precomputed;if(h&&h.beta)return h.beta;var f=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(h){var x=this.curve,b=function(v){return x.point(v.x.redMul(x.endo.beta),v.y)};h.beta=f,f.precomputed={beta:null,naf:h.naf&&{wnd:h.naf.wnd,points:h.naf.points.map(b)},doubles:h.doubles&&{step:h.doubles.step,points:h.doubles.points.map(b)}}}return f}},g.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},g.fromJSON=function(h,f,x){typeof f=="string"&&(f=JSON.parse(f));var b=h.point(f[0],f[1],x);if(!f[2])return b;function v(N){return h.point(N[0],N[1],x)}var _=f[2];return b.precomputed={beta:null,doubles:_.doubles&&{step:_.doubles.step,points:[b].concat(_.doubles.points.map(v))},naf:_.naf&&{wnd:_.naf.wnd,points:[b].concat(_.naf.points.map(v))}},b},g.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},g.prototype.isInfinity=function(){return this.inf},g.prototype.add=function(h){if(this.inf)return h;if(h.inf)return this;if(this.eq(h))return this.dbl();if(this.neg().eq(h))return this.curve.point(null,null);if(this.x.cmp(h.x)===0)return this.curve.point(null,null);var f=this.y.redSub(h.y);f.cmpn(0)!==0&&(f=f.redMul(this.x.redSub(h.x).redInvm()));var x=f.redSqr().redISub(this.x).redISub(h.x),b=f.redMul(this.x.redSub(x)).redISub(this.y);return this.curve.point(x,b)},g.prototype.dbl=function(){if(this.inf)return this;var h=this.y.redAdd(this.y);if(h.cmpn(0)===0)return this.curve.point(null,null);var f=this.curve.a,x=this.x.redSqr(),b=h.redInvm(),v=x.redAdd(x).redIAdd(x).redIAdd(f).redMul(b),_=v.redSqr().redISub(this.x.redAdd(this.x)),N=v.redMul(this.x.redSub(_)).redISub(this.y);return this.curve.point(_,N)},g.prototype.getX=function(){return this.x.fromRed()},g.prototype.getY=function(){return this.y.fromRed()},g.prototype.mul=function(h){return h=new c(h,16),this.isInfinity()?this:this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve.endo?this.curve._endoWnafMulAdd([this],[h]):this.curve._wnafMul(this,h)},g.prototype.mulAdd=function(h,f,x){var b=[this,f],v=[h,x];return this.curve.endo?this.curve._endoWnafMulAdd(b,v):this.curve._wnafMulAdd(1,b,v,2)},g.prototype.jmulAdd=function(h,f,x){var b=[this,f],v=[h,x];return this.curve.endo?this.curve._endoWnafMulAdd(b,v,!0):this.curve._wnafMulAdd(1,b,v,2,!0)},g.prototype.eq=function(h){return this===h||this.inf===h.inf&&(this.inf||this.x.cmp(h.x)===0&&this.y.cmp(h.y)===0)},g.prototype.neg=function(h){if(this.inf)return this;var f=this.curve.point(this.x,this.y.redNeg());if(h&&this.precomputed){var x=this.precomputed,b=function(v){return v.neg()};f.precomputed={naf:x.naf&&{wnd:x.naf.wnd,points:x.naf.points.map(b)},doubles:x.doubles&&{step:x.doubles.step,points:x.doubles.points.map(b)}}}return f},g.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},l(p,u.BasePoint),d.prototype.jpoint=function(h,f,x){return new p(this,h,f,x)},p.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var h=this.z.redInvm(),f=h.redSqr(),x=this.x.redMul(f),b=this.y.redMul(f).redMul(h);return this.curve.point(x,b)},p.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},p.prototype.add=function(h){if(this.isInfinity())return h;if(h.isInfinity())return this;var f=h.z.redSqr(),x=this.z.redSqr(),b=this.x.redMul(f),v=h.x.redMul(x),_=this.y.redMul(f.redMul(h.z)),N=h.y.redMul(x.redMul(this.z)),E=b.redSub(v),O=_.redSub(N);if(E.cmpn(0)===0)return O.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var F=E.redSqr(),z=F.redMul(E),P=b.redMul(F),U=O.redSqr().redIAdd(z).redISub(P).redISub(P),W=O.redMul(P.redISub(U)).redISub(_.redMul(z)),Y=this.z.redMul(h.z).redMul(E);return this.curve.jpoint(U,W,Y)},p.prototype.mixedAdd=function(h){if(this.isInfinity())return h.toJ();if(h.isInfinity())return this;var f=this.z.redSqr(),x=this.x,b=h.x.redMul(f),v=this.y,_=h.y.redMul(f).redMul(this.z),N=x.redSub(b),E=v.redSub(_);if(N.cmpn(0)===0)return E.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var O=N.redSqr(),F=O.redMul(N),z=x.redMul(O),P=E.redSqr().redIAdd(F).redISub(z).redISub(z),U=E.redMul(z.redISub(P)).redISub(v.redMul(F)),W=this.z.redMul(N);return this.curve.jpoint(P,U,W)},p.prototype.dblp=function(h){if(h===0)return this;if(this.isInfinity())return this;if(!h)return this.dbl();var f;if(this.curve.zeroA||this.curve.threeA){var x=this;for(f=0;f<h;f++)x=x.dbl();return x}var b=this.curve.a,v=this.curve.tinv,_=this.x,N=this.y,E=this.z,O=E.redSqr().redSqr(),F=N.redAdd(N);for(f=0;f<h;f++){var z=_.redSqr(),P=F.redSqr(),U=P.redSqr(),W=z.redAdd(z).redIAdd(z).redIAdd(b.redMul(O)),Y=_.redMul(P),q=W.redSqr().redISub(Y.redAdd(Y)),M=Y.redISub(q),D=W.redMul(M);D=D.redIAdd(D).redISub(U);var T=F.redMul(E);f+1<h&&(O=O.redMul(U)),_=q,E=T,F=D}return this.curve.jpoint(_,F.redMul(v),E)},p.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},p.prototype._zeroDbl=function(){var h,f,x;if(this.zOne){var b=this.x.redSqr(),v=this.y.redSqr(),_=v.redSqr(),N=this.x.redAdd(v).redSqr().redISub(b).redISub(_);N=N.redIAdd(N);var E=b.redAdd(b).redIAdd(b),O=E.redSqr().redISub(N).redISub(N),F=_.redIAdd(_);F=(F=F.redIAdd(F)).redIAdd(F),h=O,f=E.redMul(N.redISub(O)).redISub(F),x=this.y.redAdd(this.y)}else{var z=this.x.redSqr(),P=this.y.redSqr(),U=P.redSqr(),W=this.x.redAdd(P).redSqr().redISub(z).redISub(U);W=W.redIAdd(W);var Y=z.redAdd(z).redIAdd(z),q=Y.redSqr(),M=U.redIAdd(U);M=(M=M.redIAdd(M)).redIAdd(M),h=q.redISub(W).redISub(W),f=Y.redMul(W.redISub(h)).redISub(M),x=(x=this.y.redMul(this.z)).redIAdd(x)}return this.curve.jpoint(h,f,x)},p.prototype._threeDbl=function(){var h,f,x;if(this.zOne){var b=this.x.redSqr(),v=this.y.redSqr(),_=v.redSqr(),N=this.x.redAdd(v).redSqr().redISub(b).redISub(_);N=N.redIAdd(N);var E=b.redAdd(b).redIAdd(b).redIAdd(this.curve.a),O=E.redSqr().redISub(N).redISub(N);h=O;var F=_.redIAdd(_);F=(F=F.redIAdd(F)).redIAdd(F),f=E.redMul(N.redISub(O)).redISub(F),x=this.y.redAdd(this.y)}else{var z=this.z.redSqr(),P=this.y.redSqr(),U=this.x.redMul(P),W=this.x.redSub(z).redMul(this.x.redAdd(z));W=W.redAdd(W).redIAdd(W);var Y=U.redIAdd(U),q=(Y=Y.redIAdd(Y)).redAdd(Y);h=W.redSqr().redISub(q),x=this.y.redAdd(this.z).redSqr().redISub(P).redISub(z);var M=P.redSqr();M=(M=(M=M.redIAdd(M)).redIAdd(M)).redIAdd(M),f=W.redMul(Y.redISub(h)).redISub(M)}return this.curve.jpoint(h,f,x)},p.prototype._dbl=function(){var h=this.curve.a,f=this.x,x=this.y,b=this.z,v=b.redSqr().redSqr(),_=f.redSqr(),N=x.redSqr(),E=_.redAdd(_).redIAdd(_).redIAdd(h.redMul(v)),O=f.redAdd(f),F=(O=O.redIAdd(O)).redMul(N),z=E.redSqr().redISub(F.redAdd(F)),P=F.redISub(z),U=N.redSqr();U=(U=(U=U.redIAdd(U)).redIAdd(U)).redIAdd(U);var W=E.redMul(P).redISub(U),Y=x.redAdd(x).redMul(b);return this.curve.jpoint(z,W,Y)},p.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var h=this.x.redSqr(),f=this.y.redSqr(),x=this.z.redSqr(),b=f.redSqr(),v=h.redAdd(h).redIAdd(h),_=v.redSqr(),N=this.x.redAdd(f).redSqr().redISub(h).redISub(b),E=(N=(N=(N=N.redIAdd(N)).redAdd(N).redIAdd(N)).redISub(_)).redSqr(),O=b.redIAdd(b);O=(O=(O=O.redIAdd(O)).redIAdd(O)).redIAdd(O);var F=v.redIAdd(N).redSqr().redISub(_).redISub(E).redISub(O),z=f.redMul(F);z=(z=z.redIAdd(z)).redIAdd(z);var P=this.x.redMul(E).redISub(z);P=(P=P.redIAdd(P)).redIAdd(P);var U=this.y.redMul(F.redMul(O.redISub(F)).redISub(N.redMul(E)));U=(U=(U=U.redIAdd(U)).redIAdd(U)).redIAdd(U);var W=this.z.redAdd(N).redSqr().redISub(x).redISub(E);return this.curve.jpoint(P,U,W)},p.prototype.mul=function(h,f){return h=new c(h,f),this.curve._wnafMul(this,h)},p.prototype.eq=function(h){if(h.type==="affine")return this.eq(h.toJ());if(this===h)return!0;var f=this.z.redSqr(),x=h.z.redSqr();if(this.x.redMul(x).redISub(h.x.redMul(f)).cmpn(0)!==0)return!1;var b=f.redMul(this.z),v=x.redMul(h.z);return this.y.redMul(v).redISub(h.y.redMul(b)).cmpn(0)===0},p.prototype.eqXToP=function(h){var f=this.z.redSqr(),x=h.toRed(this.curve.red).redMul(f);if(this.x.cmp(x)===0)return!0;for(var b=h.clone(),v=this.curve.redN.redMul(f);;){if(b.iadd(this.curve.n),b.cmp(this.curve.p)>=0)return!1;if(x.redIAdd(v),this.x.cmp(x)===0)return!0}},p.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},p.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(e,a,n){var i,c=n,l=e("hash.js"),u=e("./curve"),o=e("./utils").assert;function d(p){p.type==="short"?this.curve=new u.short(p):p.type==="edwards"?this.curve=new u.edwards(p):this.curve=new u.mont(p),this.g=this.curve.g,this.n=this.curve.n,this.hash=p.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function g(p,h){Object.defineProperty(c,p,{configurable:!0,enumerable:!0,get:function(){var f=new d(h);return Object.defineProperty(c,p,{configurable:!0,enumerable:!0,value:f}),f}})}c.PresetCurve=d,g("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:l.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),g("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:l.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),g("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:l.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),g("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:l.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),g("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:l.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),g("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["9"]}),g("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=e("./precomputed/secp256k1")}catch{i=void 0}g("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:l.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(e,a,n){var i=e("bn.js"),c=e("hmac-drbg"),l=e("../utils"),u=e("../curves"),o=e("brorand"),d=l.assert,g=e("./key"),p=e("./signature");function h(f){if(!(this instanceof h))return new h(f);typeof f=="string"&&(d(Object.prototype.hasOwnProperty.call(u,f),"Unknown curve "+f),f=u[f]),f instanceof u.PresetCurve&&(f={curve:f}),this.curve=f.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=f.curve.g,this.g.precompute(f.curve.n.bitLength()+1),this.hash=f.hash||f.curve.hash}a.exports=h,h.prototype.keyPair=function(f){return new g(this,f)},h.prototype.keyFromPrivate=function(f,x){return g.fromPrivate(this,f,x)},h.prototype.keyFromPublic=function(f,x){return g.fromPublic(this,f,x)},h.prototype.genKeyPair=function(f){f||(f={});for(var x=new c({hash:this.hash,pers:f.pers,persEnc:f.persEnc||"utf8",entropy:f.entropy||o(this.hash.hmacStrength),entropyEnc:f.entropy&&f.entropyEnc||"utf8",nonce:this.n.toArray()}),b=this.n.byteLength(),v=this.n.sub(new i(2));;){var _=new i(x.generate(b));if(!(_.cmp(v)>0))return _.iaddn(1),this.keyFromPrivate(_)}},h.prototype._truncateToN=function(f,x){var b=8*f.byteLength()-this.n.bitLength();return b>0&&(f=f.ushrn(b)),!x&&f.cmp(this.n)>=0?f.sub(this.n):f},h.prototype.sign=function(f,x,b,v){typeof b=="object"&&(v=b,b=null),v||(v={}),x=this.keyFromPrivate(x,b),f=this._truncateToN(new i(f,16));for(var _=this.n.byteLength(),N=x.getPrivate().toArray("be",_),E=f.toArray("be",_),O=new c({hash:this.hash,entropy:N,nonce:E,pers:v.pers,persEnc:v.persEnc||"utf8"}),F=this.n.sub(new i(1)),z=0;;z++){var P=v.k?v.k(z):new i(O.generate(this.n.byteLength()));if(!((P=this._truncateToN(P,!0)).cmpn(1)<=0||P.cmp(F)>=0)){var U=this.g.mul(P);if(!U.isInfinity()){var W=U.getX(),Y=W.umod(this.n);if(Y.cmpn(0)!==0){var q=P.invm(this.n).mul(Y.mul(x.getPrivate()).iadd(f));if((q=q.umod(this.n)).cmpn(0)!==0){var M=(U.getY().isOdd()?1:0)|(W.cmp(Y)!==0?2:0);return v.canonical&&q.cmp(this.nh)>0&&(q=this.n.sub(q),M^=1),new p({r:Y,s:q,recoveryParam:M})}}}}}},h.prototype.verify=function(f,x,b,v){f=this._truncateToN(new i(f,16)),b=this.keyFromPublic(b,v);var _=(x=new p(x,"hex")).r,N=x.s;if(_.cmpn(1)<0||_.cmp(this.n)>=0||N.cmpn(1)<0||N.cmp(this.n)>=0)return!1;var E,O=N.invm(this.n),F=O.mul(f).umod(this.n),z=O.mul(_).umod(this.n);return this.curve._maxwellTrick?!(E=this.g.jmulAdd(F,b.getPublic(),z)).isInfinity()&&E.eqXToP(_):!(E=this.g.mulAdd(F,b.getPublic(),z)).isInfinity()&&E.getX().umod(this.n).cmp(_)===0},h.prototype.recoverPubKey=function(f,x,b,v){d((3&b)===b,"The recovery param is more than two bits"),x=new p(x,v);var _=this.n,N=new i(f),E=x.r,O=x.s,F=1&b,z=b>>1;if(E.cmp(this.curve.p.umod(this.curve.n))>=0&&z)throw new Error("Unable to find sencond key candinate");E=z?this.curve.pointFromX(E.add(this.curve.n),F):this.curve.pointFromX(E,F);var P=x.r.invm(_),U=_.sub(N).mul(P).umod(_),W=O.mul(P).umod(_);return this.g.mulAdd(U,E,W)},h.prototype.getKeyRecoveryParam=function(f,x,b,v){if((x=new p(x,v)).recoveryParam!==null)return x.recoveryParam;for(var _=0;_<4;_++){var N;try{N=this.recoverPubKey(f,x,_)}catch{continue}if(N.eq(b))return _}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(e,a,n){var i=e("bn.js"),c=e("../utils").assert;function l(u,o){this.ec=u,this.priv=null,this.pub=null,o.priv&&this._importPrivate(o.priv,o.privEnc),o.pub&&this._importPublic(o.pub,o.pubEnc)}a.exports=l,l.fromPublic=function(u,o,d){return o instanceof l?o:new l(u,{pub:o,pubEnc:d})},l.fromPrivate=function(u,o,d){return o instanceof l?o:new l(u,{priv:o,privEnc:d})},l.prototype.validate=function(){var u=this.getPublic();return u.isInfinity()?{result:!1,reason:"Invalid public key"}:u.validate()?u.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},l.prototype.getPublic=function(u,o){return typeof u=="string"&&(o=u,u=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),o?this.pub.encode(o,u):this.pub},l.prototype.getPrivate=function(u){return u==="hex"?this.priv.toString(16,2):this.priv},l.prototype._importPrivate=function(u,o){this.priv=new i(u,o||16),this.priv=this.priv.umod(this.ec.curve.n)},l.prototype._importPublic=function(u,o){if(u.x||u.y)return this.ec.curve.type==="mont"?c(u.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||c(u.x&&u.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(u.x,u.y));this.pub=this.ec.curve.decodePoint(u,o)},l.prototype.derive=function(u){return u.validate()||c(u.validate(),"public point not validated"),u.mul(this.priv).getX()},l.prototype.sign=function(u,o,d){return this.ec.sign(u,this,o,d)},l.prototype.verify=function(u,o){return this.ec.verify(u,o,this)},l.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(e,a,n){var i=e("bn.js"),c=e("../utils"),l=c.assert;function u(h,f){if(h instanceof u)return h;this._importDER(h,f)||(l(h.r&&h.s,"Signature without r or s"),this.r=new i(h.r,16),this.s=new i(h.s,16),h.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=h.recoveryParam)}function o(){this.place=0}function d(h,f){var x=h[f.place++];if(!(128&x))return x;var b=15&x;if(b===0||b>4)return!1;for(var v=0,_=0,N=f.place;_<b;_++,N++)v<<=8,v|=h[N],v>>>=0;return!(v<=127)&&(f.place=N,v)}function g(h){for(var f=0,x=h.length-1;!h[f]&&!(128&h[f+1])&&f<x;)f++;return f===0?h:h.slice(f)}function p(h,f){if(f<128)h.push(f);else{var x=1+(Math.log(f)/Math.LN2>>>3);for(h.push(128|x);--x;)h.push(f>>>(x<<3)&255);h.push(f)}}a.exports=u,u.prototype._importDER=function(h,f){h=c.toArray(h,f);var x=new o;if(h[x.place++]!==48)return!1;var b=d(h,x);if(b===!1||b+x.place!==h.length||h[x.place++]!==2)return!1;var v=d(h,x);if(v===!1)return!1;var _=h.slice(x.place,v+x.place);if(x.place+=v,h[x.place++]!==2)return!1;var N=d(h,x);if(N===!1||h.length!==N+x.place)return!1;var E=h.slice(x.place,N+x.place);if(_[0]===0){if(!(128&_[1]))return!1;_=_.slice(1)}if(E[0]===0){if(!(128&E[1]))return!1;E=E.slice(1)}return this.r=new i(_),this.s=new i(E),this.recoveryParam=null,!0},u.prototype.toDER=function(h){var f=this.r.toArray(),x=this.s.toArray();for(128&f[0]&&(f=[0].concat(f)),128&x[0]&&(x=[0].concat(x)),f=g(f),x=g(x);!(x[0]||128&x[1]);)x=x.slice(1);var b=[2];p(b,f.length),(b=b.concat(f)).push(2),p(b,x.length);var v=b.concat(x),_=[48];return p(_,v.length),_=_.concat(v),c.encode(_,h)}},{"../utils":419,"bn.js":420}],415:[function(e,a,n){var i=e("hash.js"),c=e("../curves"),l=e("../utils"),u=l.assert,o=l.parseBytes,d=e("./key"),g=e("./signature");function p(h){if(u(h==="ed25519","only tested with ed25519 so far"),!(this instanceof p))return new p(h);h=c[h].curve,this.curve=h,this.g=h.g,this.g.precompute(h.n.bitLength()+1),this.pointClass=h.point().constructor,this.encodingLength=Math.ceil(h.n.bitLength()/8),this.hash=i.sha512}a.exports=p,p.prototype.sign=function(h,f){h=o(h);var x=this.keyFromSecret(f),b=this.hashInt(x.messagePrefix(),h),v=this.g.mul(b),_=this.encodePoint(v),N=this.hashInt(_,x.pubBytes(),h).mul(x.priv()),E=b.add(N).umod(this.curve.n);return this.makeSignature({R:v,S:E,Rencoded:_})},p.prototype.verify=function(h,f,x){h=o(h),f=this.makeSignature(f);var b=this.keyFromPublic(x),v=this.hashInt(f.Rencoded(),b.pubBytes(),h),_=this.g.mul(f.S());return f.R().add(b.pub().mul(v)).eq(_)},p.prototype.hashInt=function(){for(var h=this.hash(),f=0;f<arguments.length;f++)h.update(arguments[f]);return l.intFromLE(h.digest()).umod(this.curve.n)},p.prototype.keyFromPublic=function(h){return d.fromPublic(this,h)},p.prototype.keyFromSecret=function(h){return d.fromSecret(this,h)},p.prototype.makeSignature=function(h){return h instanceof g?h:new g(this,h)},p.prototype.encodePoint=function(h){var f=h.getY().toArray("le",this.encodingLength);return f[this.encodingLength-1]|=h.getX().isOdd()?128:0,f},p.prototype.decodePoint=function(h){var f=(h=l.parseBytes(h)).length-1,x=h.slice(0,f).concat(-129&h[f]),b=(128&h[f])!=0,v=l.intFromLE(x);return this.curve.pointFromY(v,b)},p.prototype.encodeInt=function(h){return h.toArray("le",this.encodingLength)},p.prototype.decodeInt=function(h){return l.intFromLE(h)},p.prototype.isPoint=function(h){return h instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(e,a,n){var i=e("../utils"),c=i.assert,l=i.parseBytes,u=i.cachedProperty;function o(d,g){this.eddsa=d,this._secret=l(g.secret),d.isPoint(g.pub)?this._pub=g.pub:this._pubBytes=l(g.pub)}o.fromPublic=function(d,g){return g instanceof o?g:new o(d,{pub:g})},o.fromSecret=function(d,g){return g instanceof o?g:new o(d,{secret:g})},o.prototype.secret=function(){return this._secret},u(o,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),u(o,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),u(o,"privBytes",function(){var d=this.eddsa,g=this.hash(),p=d.encodingLength-1,h=g.slice(0,d.encodingLength);return h[0]&=248,h[p]&=127,h[p]|=64,h}),u(o,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),u(o,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),u(o,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),o.prototype.sign=function(d){return c(this._secret,"KeyPair can only verify"),this.eddsa.sign(d,this)},o.prototype.verify=function(d,g){return this.eddsa.verify(d,g,this)},o.prototype.getSecret=function(d){return c(this._secret,"KeyPair is public only"),i.encode(this.secret(),d)},o.prototype.getPublic=function(d){return i.encode(this.pubBytes(),d)},a.exports=o},{"../utils":419}],417:[function(e,a,n){var i=e("bn.js"),c=e("../utils"),l=c.assert,u=c.cachedProperty,o=c.parseBytes;function d(g,p){this.eddsa=g,typeof p!="object"&&(p=o(p)),Array.isArray(p)&&(p={R:p.slice(0,g.encodingLength),S:p.slice(g.encodingLength)}),l(p.R&&p.S,"Signature without R or S"),g.isPoint(p.R)&&(this._R=p.R),p.S instanceof i&&(this._S=p.S),this._Rencoded=Array.isArray(p.R)?p.R:p.Rencoded,this._Sencoded=Array.isArray(p.S)?p.S:p.Sencoded}u(d,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),u(d,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),u(d,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),u(d,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),d.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},d.prototype.toHex=function(){return c.encode(this.toBytes(),"hex").toUpperCase()},a.exports=d},{"../utils":419,"bn.js":420}],418:[function(e,a,n){a.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(e,a,n){var i=n,c=e("bn.js"),l=e("minimalistic-assert"),u=e("minimalistic-crypto-utils");i.assert=l,i.toArray=u.toArray,i.zero2=u.zero2,i.toHex=u.toHex,i.encode=u.encode,i.getNAF=function(o,d,g){var p=new Array(Math.max(o.bitLength(),g)+1);p.fill(0);for(var h=1<<d+1,f=o.clone(),x=0;x<p.length;x++){var b,v=f.andln(h-1);f.isOdd()?(b=v>(h>>1)-1?(h>>1)-v:v,f.isubn(b)):b=0,p[x]=b,f.iushrn(1)}return p},i.getJSF=function(o,d){var g=[[],[]];o=o.clone(),d=d.clone();for(var p,h=0,f=0;o.cmpn(-h)>0||d.cmpn(-f)>0;){var x,b,v=o.andln(3)+h&3,_=d.andln(3)+f&3;v===3&&(v=-1),_===3&&(_=-1),x=1&v?(p=o.andln(7)+h&7)!==3&&p!==5||_!==2?v:-v:0,g[0].push(x),b=1&_?(p=d.andln(7)+f&7)!==3&&p!==5||v!==2?_:-_:0,g[1].push(b),2*h===x+1&&(h=1-h),2*f===b+1&&(f=1-f),o.iushrn(1),d.iushrn(1)}return g},i.cachedProperty=function(o,d,g){var p="_"+d;o.prototype[d]=function(){return this[p]!==void 0?this[p]:this[p]=g.call(this)}},i.parseBytes=function(o){return typeof o=="string"?i.toArray(o,"hex"):o},i.intFromLE=function(o){return new c(o,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],421:[function(e,a,n){a.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(e,a,n){var i=Object.create||function(P){var U=function(){};return U.prototype=P,new U},c=Object.keys||function(P){var U=[];for(var W in P)Object.prototype.hasOwnProperty.call(P,W)&&U.push(W);return W},l=Function.prototype.bind||function(P){var U=this;return function(){return U.apply(P,arguments)}};function u(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=i(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}a.exports=u,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._maxListeners=void 0;var o,d=10;try{var g={};Object.defineProperty&&Object.defineProperty(g,"x",{value:0}),o=g.x===0}catch{o=!1}function p(P){return P._maxListeners===void 0?u.defaultMaxListeners:P._maxListeners}function h(P,U,W){if(U)P.call(W);else for(var Y=P.length,q=z(P,Y),M=0;M<Y;++M)q[M].call(W)}function f(P,U,W,Y){if(U)P.call(W,Y);else for(var q=P.length,M=z(P,q),D=0;D<q;++D)M[D].call(W,Y)}function x(P,U,W,Y,q){if(U)P.call(W,Y,q);else for(var M=P.length,D=z(P,M),T=0;T<M;++T)D[T].call(W,Y,q)}function b(P,U,W,Y,q,M){if(U)P.call(W,Y,q,M);else for(var D=P.length,T=z(P,D),C=0;C<D;++C)T[C].call(W,Y,q,M)}function v(P,U,W,Y){if(U)P.apply(W,Y);else for(var q=P.length,M=z(P,q),D=0;D<q;++D)M[D].apply(W,Y)}function _(P,U,W,Y){var q,M,D;if(typeof W!="function")throw new TypeError('"listener" argument must be a function');if((M=P._events)?(M.newListener&&(P.emit("newListener",U,W.listener?W.listener:W),M=P._events),D=M[U]):(M=P._events=i(null),P._eventsCount=0),D){if(typeof D=="function"?D=M[U]=Y?[W,D]:[D,W]:Y?D.unshift(W):D.push(W),!D.warned&&(q=p(P))&&q>0&&D.length>q){D.warned=!0;var T=new Error("Possible EventEmitter memory leak detected. "+D.length+' "'+String(U)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');T.name="MaxListenersExceededWarning",T.emitter=P,T.type=U,T.count=D.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",T.name,T.message)}}else D=M[U]=W,++P._eventsCount;return P}function N(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var P=new Array(arguments.length),U=0;U<P.length;++U)P[U]=arguments[U];this.listener.apply(this.target,P)}}function E(P,U,W){var Y={fired:!1,wrapFn:void 0,target:P,type:U,listener:W},q=l.call(N,Y);return q.listener=W,Y.wrapFn=q,q}function O(P,U,W){var Y=P._events;if(!Y)return[];var q=Y[U];return q?typeof q=="function"?W?[q.listener||q]:[q]:W?function(M){for(var D=new Array(M.length),T=0;T<D.length;++T)D[T]=M[T].listener||M[T];return D}(q):z(q,q.length):[]}function F(P){var U=this._events;if(U){var W=U[P];if(typeof W=="function")return 1;if(W)return W.length}return 0}function z(P,U){for(var W=new Array(U),Y=0;Y<U;++Y)W[Y]=P[Y];return W}o?Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(P){if(typeof P!="number"||P<0||P!=P)throw new TypeError('"defaultMaxListeners" must be a positive number');d=P}}):u.defaultMaxListeners=d,u.prototype.setMaxListeners=function(P){if(typeof P!="number"||P<0||isNaN(P))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=P,this},u.prototype.getMaxListeners=function(){return p(this)},u.prototype.emit=function(P){var U,W,Y,q,M,D,T=P==="error";if(D=this._events)T=T&&D.error==null;else if(!T)return!1;if(T){if(arguments.length>1&&(U=arguments[1]),U instanceof Error)throw U;var C=new Error('Unhandled "error" event. ('+U+")");throw C.context=U,C}if(!(W=D[P]))return!1;var S=typeof W=="function";switch(Y=arguments.length){case 1:h(W,S,this);break;case 2:f(W,S,this,arguments[1]);break;case 3:x(W,S,this,arguments[1],arguments[2]);break;case 4:b(W,S,this,arguments[1],arguments[2],arguments[3]);break;default:for(q=new Array(Y-1),M=1;M<Y;M++)q[M-1]=arguments[M];v(W,S,this,q)}return!0},u.prototype.addListener=function(P,U){return _(this,P,U,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(P,U){return _(this,P,U,!0)},u.prototype.once=function(P,U){if(typeof U!="function")throw new TypeError('"listener" argument must be a function');return this.on(P,E(this,P,U)),this},u.prototype.prependOnceListener=function(P,U){if(typeof U!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(P,E(this,P,U)),this},u.prototype.removeListener=function(P,U){var W,Y,q,M,D;if(typeof U!="function")throw new TypeError('"listener" argument must be a function');if(!(Y=this._events))return this;if(!(W=Y[P]))return this;if(W===U||W.listener===U)--this._eventsCount==0?this._events=i(null):(delete Y[P],Y.removeListener&&this.emit("removeListener",P,W.listener||U));else if(typeof W!="function"){for(q=-1,M=W.length-1;M>=0;M--)if(W[M]===U||W[M].listener===U){D=W[M].listener,q=M;break}if(q<0)return this;q===0?W.shift():function(T,C){for(var S=C,w=S+1,j=T.length;w<j;S+=1,w+=1)T[S]=T[w];T.pop()}(W,q),W.length===1&&(Y[P]=W[0]),Y.removeListener&&this.emit("removeListener",P,D||U)}return this},u.prototype.removeAllListeners=function(P){var U,W,Y;if(!(W=this._events))return this;if(!W.removeListener)return arguments.length===0?(this._events=i(null),this._eventsCount=0):W[P]&&(--this._eventsCount==0?this._events=i(null):delete W[P]),this;if(arguments.length===0){var q,M=c(W);for(Y=0;Y<M.length;++Y)(q=M[Y])!=="removeListener"&&this.removeAllListeners(q);return this.removeAllListeners("removeListener"),this._events=i(null),this._eventsCount=0,this}if(typeof(U=W[P])=="function")this.removeListener(P,U);else if(U)for(Y=U.length-1;Y>=0;Y--)this.removeListener(P,U[Y]);return this},u.prototype.listeners=function(P){return O(this,P,!0)},u.prototype.rawListeners=function(P){return O(this,P,!1)},u.listenerCount=function(P,U){return typeof P.listenerCount=="function"?P.listenerCount(U):F.call(P,U)},u.prototype.listenerCount=F,u.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(e,a,n){var i=e("safe-buffer").Buffer,c=e("md5.js");a.exports=function(l,u,o,d){if(i.isBuffer(l)||(l=i.from(l,"binary")),u&&(i.isBuffer(u)||(u=i.from(u,"binary")),u.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var g=o/8,p=i.alloc(g),h=i.alloc(d||0),f=i.alloc(0);g>0||d>0;){var x=new c;x.update(f),x.update(l),u&&x.update(u),f=x.digest();var b=0;if(g>0){var v=p.length-g;b=Math.min(g,f.length),f.copy(p,v,0,b),g-=b}if(b<f.length&&d>0){var _=h.length-d,N=Math.min(d,f.length-b);f.copy(h,_,b,b+N),d-=N}}return f.fill(0),{key:p,iv:h}}},{"md5.js":450,"safe-buffer":494}],424:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CsvParserStream=n.ParserOptions=n.parseFile=n.parseStream=n.parseString=n.parse=n.FormatterOptions=n.CsvFormatterStream=n.writeToPath=n.writeToString=n.writeToBuffer=n.writeToStream=n.write=n.format=void 0;var i=e("@fast-csv/format");Object.defineProperty(n,"format",{enumerable:!0,get:function(){return i.format}}),Object.defineProperty(n,"write",{enumerable:!0,get:function(){return i.write}}),Object.defineProperty(n,"writeToStream",{enumerable:!0,get:function(){return i.writeToStream}}),Object.defineProperty(n,"writeToBuffer",{enumerable:!0,get:function(){return i.writeToBuffer}}),Object.defineProperty(n,"writeToString",{enumerable:!0,get:function(){return i.writeToString}}),Object.defineProperty(n,"writeToPath",{enumerable:!0,get:function(){return i.writeToPath}}),Object.defineProperty(n,"CsvFormatterStream",{enumerable:!0,get:function(){return i.CsvFormatterStream}}),Object.defineProperty(n,"FormatterOptions",{enumerable:!0,get:function(){return i.FormatterOptions}});var c=e("@fast-csv/parse");Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return c.parse}}),Object.defineProperty(n,"parseString",{enumerable:!0,get:function(){return c.parseString}}),Object.defineProperty(n,"parseStream",{enumerable:!0,get:function(){return c.parseStream}}),Object.defineProperty(n,"parseFile",{enumerable:!0,get:function(){return c.parseFile}}),Object.defineProperty(n,"ParserOptions",{enumerable:!0,get:function(){return c.ParserOptions}}),Object.defineProperty(n,"CsvParserStream",{enumerable:!0,get:function(){return c.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(e,a,n){var i=e("safe-buffer").Buffer,c=e("readable-stream").Transform;function l(u){c.call(this),this._block=i.allocUnsafe(u),this._blockSize=u,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(l,c),l.prototype._transform=function(u,o,d){var g=null;try{this.update(u,o)}catch(p){g=p}d(g)},l.prototype._flush=function(u){var o=null;try{this.push(this.digest())}catch(d){o=d}u(o)},l.prototype.update=function(u,o){if(function(x,b){if(!i.isBuffer(x)&&typeof x!="string")throw new TypeError(b+" must be a string or a buffer")}(u,"Data"),this._finalized)throw new Error("Digest already called");i.isBuffer(u)||(u=i.from(u,o));for(var d=this._block,g=0;this._blockOffset+u.length-g>=this._blockSize;){for(var p=this._blockOffset;p<this._blockSize;)d[p++]=u[g++];this._update(),this._blockOffset=0}for(;g<u.length;)d[this._blockOffset++]=u[g++];for(var h=0,f=8*u.length;f>0;++h)this._length[h]+=f,(f=this._length[h]/4294967296|0)>0&&(this._length[h]-=4294967296*f);return this},l.prototype._update=function(){throw new Error("_update is not implemented")},l.prototype.digest=function(u){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var o=this._digest();u!==void 0&&(o=o.toString(u)),this._block.fill(0),this._blockOffset=0;for(var d=0;d<4;++d)this._length[d]=0;return o},l.prototype._digest=function(){throw new Error("_digest is not implemented")},a.exports=l},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(e,a,n){var i=n;i.utils=e("./hash/utils"),i.common=e("./hash/common"),i.sha=e("./hash/sha"),i.ripemd=e("./hash/ripemd"),i.hmac=e("./hash/hmac"),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(e,a,n){var i=e("./utils"),c=e("minimalistic-assert");function l(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}n.BlockHash=l,l.prototype.update=function(u,o){if(u=i.toArray(u,o),this.pending?this.pending=this.pending.concat(u):this.pending=u,this.pendingTotal+=u.length,this.pending.length>=this._delta8){var d=(u=this.pending).length%this._delta8;this.pending=u.slice(u.length-d,u.length),this.pending.length===0&&(this.pending=null),u=i.join32(u,0,u.length-d,this.endian);for(var g=0;g<u.length;g+=this._delta32)this._update(u,g,g+this._delta32)}return this},l.prototype.digest=function(u){return this.update(this._pad()),c(this.pending===null),this._digest(u)},l.prototype._pad=function(){var u=this.pendingTotal,o=this._delta8,d=o-(u+this.padLength)%o,g=new Array(d+this.padLength);g[0]=128;for(var p=1;p<d;p++)g[p]=0;if(u<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)g[p++]=0;g[p++]=0,g[p++]=0,g[p++]=0,g[p++]=0,g[p++]=u>>>24&255,g[p++]=u>>>16&255,g[p++]=u>>>8&255,g[p++]=255&u}else for(g[p++]=255&u,g[p++]=u>>>8&255,g[p++]=u>>>16&255,g[p++]=u>>>24&255,g[p++]=0,g[p++]=0,g[p++]=0,g[p++]=0,h=8;h<this.padLength;h++)g[p++]=0;return g}},{"./utils":437,"minimalistic-assert":453}],428:[function(e,a,n){var i=e("./utils"),c=e("minimalistic-assert");function l(u,o,d){if(!(this instanceof l))return new l(u,o,d);this.Hash=u,this.blockSize=u.blockSize/8,this.outSize=u.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(o,d))}a.exports=l,l.prototype._init=function(u){u.length>this.blockSize&&(u=new this.Hash().update(u).digest()),c(u.length<=this.blockSize);for(var o=u.length;o<this.blockSize;o++)u.push(0);for(o=0;o<u.length;o++)u[o]^=54;for(this.inner=new this.Hash().update(u),o=0;o<u.length;o++)u[o]^=106;this.outer=new this.Hash().update(u)},l.prototype.update=function(u,o){return this.inner.update(u,o),this},l.prototype.digest=function(u){return this.outer.update(this.inner.digest()),this.outer.digest(u)}},{"./utils":437,"minimalistic-assert":453}],429:[function(e,a,n){var i=e("./utils"),c=e("./common"),l=i.rotl32,u=i.sum32,o=i.sum32_3,d=i.sum32_4,g=c.BlockHash;function p(){if(!(this instanceof p))return new p;g.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(E,O,F,z){return E<=15?O^F^z:E<=31?O&F|~O&z:E<=47?(O|~F)^z:E<=63?O&z|F&~z:O^(F|~z)}function f(E){return E<=15?0:E<=31?1518500249:E<=47?1859775393:E<=63?2400959708:2840853838}function x(E){return E<=15?1352829926:E<=31?1548603684:E<=47?1836072691:E<=63?2053994217:0}i.inherits(p,g),n.ripemd160=p,p.blockSize=512,p.outSize=160,p.hmacStrength=192,p.padLength=64,p.prototype._update=function(E,O){for(var F=this.h[0],z=this.h[1],P=this.h[2],U=this.h[3],W=this.h[4],Y=F,q=z,M=P,D=U,T=W,C=0;C<80;C++){var S=u(l(d(F,h(C,z,P,U),E[b[C]+O],f(C)),_[C]),W);F=W,W=U,U=l(P,10),P=z,z=S,S=u(l(d(Y,h(79-C,q,M,D),E[v[C]+O],x(C)),N[C]),T),Y=T,T=D,D=l(M,10),M=q,q=S}S=o(this.h[1],P,D),this.h[1]=o(this.h[2],U,T),this.h[2]=o(this.h[3],W,Y),this.h[3]=o(this.h[4],F,q),this.h[4]=o(this.h[0],z,M),this.h[0]=S},p.prototype._digest=function(E){return E==="hex"?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var b=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],v=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],_=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],N=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(e,a,n){n.sha1=e("./sha/1"),n.sha224=e("./sha/224"),n.sha256=e("./sha/256"),n.sha384=e("./sha/384"),n.sha512=e("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(e,a,n){var i=e("../utils"),c=e("../common"),l=e("./common"),u=i.rotl32,o=i.sum32,d=i.sum32_5,g=l.ft_1,p=c.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function f(){if(!(this instanceof f))return new f;p.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}i.inherits(f,p),a.exports=f,f.blockSize=512,f.outSize=160,f.hmacStrength=80,f.padLength=64,f.prototype._update=function(x,b){for(var v=this.W,_=0;_<16;_++)v[_]=x[b+_];for(;_<v.length;_++)v[_]=u(v[_-3]^v[_-8]^v[_-14]^v[_-16],1);var N=this.h[0],E=this.h[1],O=this.h[2],F=this.h[3],z=this.h[4];for(_=0;_<v.length;_++){var P=~~(_/20),U=d(u(N,5),g(P,E,O,F),z,v[_],h[P]);z=F,F=O,O=u(E,30),E=N,N=U}this.h[0]=o(this.h[0],N),this.h[1]=o(this.h[1],E),this.h[2]=o(this.h[2],O),this.h[3]=o(this.h[3],F),this.h[4]=o(this.h[4],z)},f.prototype._digest=function(x){return x==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(e,a,n){var i=e("../utils"),c=e("./256");function l(){if(!(this instanceof l))return new l;c.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(l,c),a.exports=l,l.blockSize=512,l.outSize=224,l.hmacStrength=192,l.padLength=64,l.prototype._digest=function(u){return u==="hex"?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(e,a,n){var i=e("../utils"),c=e("../common"),l=e("./common"),u=e("minimalistic-assert"),o=i.sum32,d=i.sum32_4,g=i.sum32_5,p=l.ch32,h=l.maj32,f=l.s0_256,x=l.s1_256,b=l.g0_256,v=l.g1_256,_=c.BlockHash,N=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function E(){if(!(this instanceof E))return new E;_.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=N,this.W=new Array(64)}i.inherits(E,_),a.exports=E,E.blockSize=512,E.outSize=256,E.hmacStrength=192,E.padLength=64,E.prototype._update=function(O,F){for(var z=this.W,P=0;P<16;P++)z[P]=O[F+P];for(;P<z.length;P++)z[P]=d(v(z[P-2]),z[P-7],b(z[P-15]),z[P-16]);var U=this.h[0],W=this.h[1],Y=this.h[2],q=this.h[3],M=this.h[4],D=this.h[5],T=this.h[6],C=this.h[7];for(u(this.k.length===z.length),P=0;P<z.length;P++){var S=g(C,x(M),p(M,D,T),this.k[P],z[P]),w=o(f(U),h(U,W,Y));C=T,T=D,D=M,M=o(q,S),q=Y,Y=W,W=U,U=o(S,w)}this.h[0]=o(this.h[0],U),this.h[1]=o(this.h[1],W),this.h[2]=o(this.h[2],Y),this.h[3]=o(this.h[3],q),this.h[4]=o(this.h[4],M),this.h[5]=o(this.h[5],D),this.h[6]=o(this.h[6],T),this.h[7]=o(this.h[7],C)},E.prototype._digest=function(O){return O==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(e,a,n){var i=e("../utils"),c=e("./512");function l(){if(!(this instanceof l))return new l;c.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(l,c),a.exports=l,l.blockSize=1024,l.outSize=384,l.hmacStrength=192,l.padLength=128,l.prototype._digest=function(u){return u==="hex"?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(e,a,n){var i=e("../utils"),c=e("../common"),l=e("minimalistic-assert"),u=i.rotr64_hi,o=i.rotr64_lo,d=i.shr64_hi,g=i.shr64_lo,p=i.sum64,h=i.sum64_hi,f=i.sum64_lo,x=i.sum64_4_hi,b=i.sum64_4_lo,v=i.sum64_5_hi,_=i.sum64_5_lo,N=c.BlockHash,E=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function O(){if(!(this instanceof O))return new O;N.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=E,this.W=new Array(160)}function F(w,j,A,L,I){var Z=w&A^~w&I;return Z<0&&(Z+=4294967296),Z}function z(w,j,A,L,I,Z){var K=j&L^~j&Z;return K<0&&(K+=4294967296),K}function P(w,j,A,L,I){var Z=w&A^w&I^A&I;return Z<0&&(Z+=4294967296),Z}function U(w,j,A,L,I,Z){var K=j&L^j&Z^L&Z;return K<0&&(K+=4294967296),K}function W(w,j){var A=u(w,j,28)^u(j,w,2)^u(j,w,7);return A<0&&(A+=4294967296),A}function Y(w,j){var A=o(w,j,28)^o(j,w,2)^o(j,w,7);return A<0&&(A+=4294967296),A}function q(w,j){var A=u(w,j,14)^u(w,j,18)^u(j,w,9);return A<0&&(A+=4294967296),A}function M(w,j){var A=o(w,j,14)^o(w,j,18)^o(j,w,9);return A<0&&(A+=4294967296),A}function D(w,j){var A=u(w,j,1)^u(w,j,8)^d(w,j,7);return A<0&&(A+=4294967296),A}function T(w,j){var A=o(w,j,1)^o(w,j,8)^g(w,j,7);return A<0&&(A+=4294967296),A}function C(w,j){var A=u(w,j,19)^u(j,w,29)^d(w,j,6);return A<0&&(A+=4294967296),A}function S(w,j){var A=o(w,j,19)^o(j,w,29)^g(w,j,6);return A<0&&(A+=4294967296),A}i.inherits(O,N),a.exports=O,O.blockSize=1024,O.outSize=512,O.hmacStrength=192,O.padLength=128,O.prototype._prepareBlock=function(w,j){for(var A=this.W,L=0;L<32;L++)A[L]=w[j+L];for(;L<A.length;L+=2){var I=C(A[L-4],A[L-3]),Z=S(A[L-4],A[L-3]),K=A[L-14],re=A[L-13],G=D(A[L-30],A[L-29]),ae=T(A[L-30],A[L-29]),V=A[L-32],H=A[L-31];A[L]=x(I,Z,K,re,G,ae,V,H),A[L+1]=b(I,Z,K,re,G,ae,V,H)}},O.prototype._update=function(w,j){this._prepareBlock(w,j);var A=this.W,L=this.h[0],I=this.h[1],Z=this.h[2],K=this.h[3],re=this.h[4],G=this.h[5],ae=this.h[6],V=this.h[7],H=this.h[8],Q=this.h[9],oe=this.h[10],se=this.h[11],le=this.h[12],he=this.h[13],Ne=this.h[14],we=this.h[15];l(this.k.length===A.length);for(var ue=0;ue<A.length;ue+=2){var Se=Ne,ke=we,Me=q(H,Q),Oe=M(H,Q),je=F(H,Q,oe,se,le),Ie=z(H,Q,oe,se,le,he),Pe=this.k[ue],He=this.k[ue+1],ct=A[ue],ie=A[ue+1],ee=v(Se,ke,Me,Oe,je,Ie,Pe,He,ct,ie),te=_(Se,ke,Me,Oe,je,Ie,Pe,He,ct,ie);Se=W(L,I),ke=Y(L,I),Me=P(L,I,Z,K,re),Oe=U(L,I,Z,K,re,G);var fe=h(Se,ke,Me,Oe),_e=f(Se,ke,Me,Oe);Ne=le,we=he,le=oe,he=se,oe=H,se=Q,H=h(ae,V,ee,te),Q=f(V,V,ee,te),ae=re,V=G,re=Z,G=K,Z=L,K=I,L=h(ee,te,fe,_e),I=f(ee,te,fe,_e)}p(this.h,0,L,I),p(this.h,2,Z,K),p(this.h,4,re,G),p(this.h,6,ae,V),p(this.h,8,H,Q),p(this.h,10,oe,se),p(this.h,12,le,he),p(this.h,14,Ne,we)},O.prototype._digest=function(w){return w==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(e,a,n){var i=e("../utils").rotr32;function c(o,d,g){return o&d^~o&g}function l(o,d,g){return o&d^o&g^d&g}function u(o,d,g){return o^d^g}n.ft_1=function(o,d,g,p){return o===0?c(d,g,p):o===1||o===3?u(d,g,p):o===2?l(d,g,p):void 0},n.ch32=c,n.maj32=l,n.p32=u,n.s0_256=function(o){return i(o,2)^i(o,13)^i(o,22)},n.s1_256=function(o){return i(o,6)^i(o,11)^i(o,25)},n.g0_256=function(o){return i(o,7)^i(o,18)^o>>>3},n.g1_256=function(o){return i(o,17)^i(o,19)^o>>>10}},{"../utils":437}],437:[function(e,a,n){var i=e("minimalistic-assert"),c=e("inherits");function l(g,p){return(64512&g.charCodeAt(p))==55296&&!(p<0||p+1>=g.length)&&(64512&g.charCodeAt(p+1))==56320}function u(g){return(g>>>24|g>>>8&65280|g<<8&16711680|(255&g)<<24)>>>0}function o(g){return g.length===1?"0"+g:g}function d(g){return g.length===7?"0"+g:g.length===6?"00"+g:g.length===5?"000"+g:g.length===4?"0000"+g:g.length===3?"00000"+g:g.length===2?"000000"+g:g.length===1?"0000000"+g:g}n.inherits=c,n.toArray=function(g,p){if(Array.isArray(g))return g.slice();if(!g)return[];var h=[];if(typeof g=="string")if(p){if(p==="hex")for((g=g.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(g="0"+g),x=0;x<g.length;x+=2)h.push(parseInt(g[x]+g[x+1],16))}else for(var f=0,x=0;x<g.length;x++){var b=g.charCodeAt(x);b<128?h[f++]=b:b<2048?(h[f++]=b>>6|192,h[f++]=63&b|128):l(g,x)?(b=65536+((1023&b)<<10)+(1023&g.charCodeAt(++x)),h[f++]=b>>18|240,h[f++]=b>>12&63|128,h[f++]=b>>6&63|128,h[f++]=63&b|128):(h[f++]=b>>12|224,h[f++]=b>>6&63|128,h[f++]=63&b|128)}else for(x=0;x<g.length;x++)h[x]=0|g[x];return h},n.toHex=function(g){for(var p="",h=0;h<g.length;h++)p+=o(g[h].toString(16));return p},n.htonl=u,n.toHex32=function(g,p){for(var h="",f=0;f<g.length;f++){var x=g[f];p==="little"&&(x=u(x)),h+=d(x.toString(16))}return h},n.zero2=o,n.zero8=d,n.join32=function(g,p,h,f){var x=h-p;i(x%4==0);for(var b=new Array(x/4),v=0,_=p;v<b.length;v++,_+=4){var N;N=f==="big"?g[_]<<24|g[_+1]<<16|g[_+2]<<8|g[_+3]:g[_+3]<<24|g[_+2]<<16|g[_+1]<<8|g[_],b[v]=N>>>0}return b},n.split32=function(g,p){for(var h=new Array(4*g.length),f=0,x=0;f<g.length;f++,x+=4){var b=g[f];p==="big"?(h[x]=b>>>24,h[x+1]=b>>>16&255,h[x+2]=b>>>8&255,h[x+3]=255&b):(h[x+3]=b>>>24,h[x+2]=b>>>16&255,h[x+1]=b>>>8&255,h[x]=255&b)}return h},n.rotr32=function(g,p){return g>>>p|g<<32-p},n.rotl32=function(g,p){return g<<p|g>>>32-p},n.sum32=function(g,p){return g+p>>>0},n.sum32_3=function(g,p,h){return g+p+h>>>0},n.sum32_4=function(g,p,h,f){return g+p+h+f>>>0},n.sum32_5=function(g,p,h,f,x){return g+p+h+f+x>>>0},n.sum64=function(g,p,h,f){var x=g[p],b=f+g[p+1]>>>0,v=(b<f?1:0)+h+x;g[p]=v>>>0,g[p+1]=b},n.sum64_hi=function(g,p,h,f){return(p+f>>>0<p?1:0)+g+h>>>0},n.sum64_lo=function(g,p,h,f){return p+f>>>0},n.sum64_4_hi=function(g,p,h,f,x,b,v,_){var N=0,E=p;return N+=(E=E+f>>>0)<p?1:0,N+=(E=E+b>>>0)<b?1:0,g+h+x+v+(N+=(E=E+_>>>0)<_?1:0)>>>0},n.sum64_4_lo=function(g,p,h,f,x,b,v,_){return p+f+b+_>>>0},n.sum64_5_hi=function(g,p,h,f,x,b,v,_,N,E){var O=0,F=p;return O+=(F=F+f>>>0)<p?1:0,O+=(F=F+b>>>0)<b?1:0,O+=(F=F+_>>>0)<_?1:0,g+h+x+v+N+(O+=(F=F+E>>>0)<E?1:0)>>>0},n.sum64_5_lo=function(g,p,h,f,x,b,v,_,N,E){return p+f+b+_+E>>>0},n.rotr64_hi=function(g,p,h){return(p<<32-h|g>>>h)>>>0},n.rotr64_lo=function(g,p,h){return(g<<32-h|p>>>h)>>>0},n.shr64_hi=function(g,p,h){return g>>>h},n.shr64_lo=function(g,p,h){return(g<<32-h|p>>>h)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(e,a,n){var i=e("hash.js"),c=e("minimalistic-crypto-utils"),l=e("minimalistic-assert");function u(o){if(!(this instanceof u))return new u(o);this.hash=o.hash,this.predResist=!!o.predResist,this.outLen=this.hash.outSize,this.minEntropy=o.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var d=c.toArray(o.entropy,o.entropyEnc||"hex"),g=c.toArray(o.nonce,o.nonceEnc||"hex"),p=c.toArray(o.pers,o.persEnc||"hex");l(d.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(d,g,p)}a.exports=u,u.prototype._init=function(o,d,g){var p=o.concat(d).concat(g);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(p),this._reseed=1,this.reseedInterval=281474976710656},u.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},u.prototype._update=function(o){var d=this._hmac().update(this.V).update([0]);o&&(d=d.update(o)),this.K=d.digest(),this.V=this._hmac().update(this.V).digest(),o&&(this.K=this._hmac().update(this.V).update([1]).update(o).digest(),this.V=this._hmac().update(this.V).digest())},u.prototype.reseed=function(o,d,g,p){typeof d!="string"&&(p=g,g=d,d=null),o=c.toArray(o,d),g=c.toArray(g,p),l(o.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(o.concat(g||[])),this._reseed=1},u.prototype.generate=function(o,d,g,p){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof d!="string"&&(p=g,g=d,d=null),g&&(g=c.toArray(g,p||"hex"),this._update(g));for(var h=[];h.length<o;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var f=h.slice(0,o);return this._update(g),this._reseed++,c.encode(f,d)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(e,a,n){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */n.read=function(i,c,l,u,o){var d,g,p=8*o-u-1,h=(1<<p)-1,f=h>>1,x=-7,b=l?o-1:0,v=l?-1:1,_=i[c+b];for(b+=v,d=_&(1<<-x)-1,_>>=-x,x+=p;x>0;d=256*d+i[c+b],b+=v,x-=8);for(g=d&(1<<-x)-1,d>>=-x,x+=u;x>0;g=256*g+i[c+b],b+=v,x-=8);if(d===0)d=1-f;else{if(d===h)return g?NaN:1/0*(_?-1:1);g+=Math.pow(2,u),d-=f}return(_?-1:1)*g*Math.pow(2,d-u)},n.write=function(i,c,l,u,o,d){var g,p,h,f=8*d-o-1,x=(1<<f)-1,b=x>>1,v=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=u?0:d-1,N=u?1:-1,E=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(p=isNaN(c)?1:0,g=x):(g=Math.floor(Math.log(c)/Math.LN2),c*(h=Math.pow(2,-g))<1&&(g--,h*=2),(c+=g+b>=1?v/h:v*Math.pow(2,1-b))*h>=2&&(g++,h/=2),g+b>=x?(p=0,g=x):g+b>=1?(p=(c*h-1)*Math.pow(2,o),g+=b):(p=c*Math.pow(2,b-1)*Math.pow(2,o),g=0));o>=8;i[l+_]=255&p,_+=N,p/=256,o-=8);for(g=g<<o|p,f+=o;f>0;i[l+_]=255&g,_+=N,g/=256,f-=8);i[l+_-N]|=128*E}},{}],440:[function(e,a,n){typeof Object.create=="function"?a.exports=function(i,c){c&&(i.super_=c,i.prototype=Object.create(c.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}))}:a.exports=function(i,c){if(c){i.super_=c;var l=function(){};l.prototype=c.prototype,i.prototype=new l,i.prototype.constructor=i}}},{}],441:[function(e,a,n){(function(i,c,l,u,o,d,g,p){(function(){/*!

		JSZip v3.10.1 - A JavaScript class for generating and reading zip files
		<http://stuartk.com/jszip>

		(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
		Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

		JSZip uses the library pako released under the MIT license :
		https://github.com/nodeca/pako/blob/main/LICENSE
		*/(function(h){typeof n=="object"&&a!==void 0?a.exports=h():(typeof window<"u"?window:c!==void 0?c:typeof self<"u"?self:this).JSZip=h()})(function(){return function h(f,x,b){function v(E,O){if(!x[E]){if(!f[E]){var F=typeof e=="function"&&e;if(!O&&F)return F(E,!0);if(_)return _(E,!0);var z=new Error("Cannot find module '"+E+"'");throw z.code="MODULE_NOT_FOUND",z}var P=x[E]={exports:{}};f[E][0].call(P.exports,function(U){return v(f[E][1][U]||U)},P,P.exports,h,f,x,b)}return x[E].exports}for(var _=typeof e=="function"&&e,N=0;N<b.length;N++)v(b[N]);return v}({1:[function(h,f,x){var b=h("./utils"),v=h("./support"),_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";x.encode=function(N){for(var E,O,F,z,P,U,W,Y=[],q=0,M=N.length,D=M,T=b.getTypeOf(N)!=="string";q<N.length;)D=M-q,F=T?(E=N[q++],O=q<M?N[q++]:0,q<M?N[q++]:0):(E=N.charCodeAt(q++),O=q<M?N.charCodeAt(q++):0,q<M?N.charCodeAt(q++):0),z=E>>2,P=(3&E)<<4|O>>4,U=1<D?(15&O)<<2|F>>6:64,W=2<D?63&F:64,Y.push(_.charAt(z)+_.charAt(P)+_.charAt(U)+_.charAt(W));return Y.join("")},x.decode=function(N){var E,O,F,z,P,U,W=0,Y=0,q="data:";if(N.substr(0,q.length)===q)throw new Error("Invalid base64 input, it looks like a data url.");var M,D=3*(N=N.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(N.charAt(N.length-1)===_.charAt(64)&&D--,N.charAt(N.length-2)===_.charAt(64)&&D--,D%1!=0)throw new Error("Invalid base64 input, bad content length.");for(M=v.uint8array?new Uint8Array(0|D):new Array(0|D);W<N.length;)E=_.indexOf(N.charAt(W++))<<2|(z=_.indexOf(N.charAt(W++)))>>4,O=(15&z)<<4|(P=_.indexOf(N.charAt(W++)))>>2,F=(3&P)<<6|(U=_.indexOf(N.charAt(W++))),M[Y++]=E,P!==64&&(M[Y++]=O),U!==64&&(M[Y++]=F);return M}},{"./support":30,"./utils":32}],2:[function(h,f,x){var b=h("./external"),v=h("./stream/DataWorker"),_=h("./stream/Crc32Probe"),N=h("./stream/DataLengthProbe");function E(O,F,z,P,U){this.compressedSize=O,this.uncompressedSize=F,this.crc32=z,this.compression=P,this.compressedContent=U}E.prototype={getContentWorker:function(){var O=new v(b.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new N("data_length")),F=this;return O.on("end",function(){if(this.streamInfo.data_length!==F.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),O},getCompressedWorker:function(){return new v(b.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},E.createWorkerFrom=function(O,F,z){return O.pipe(new _).pipe(new N("uncompressedSize")).pipe(F.compressWorker(z)).pipe(new N("compressedSize")).withStreamInfo("compression",F)},f.exports=E},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,f,x){var b=h("./stream/GenericWorker");x.STORE={magic:"\0\0",compressWorker:function(){return new b("STORE compression")},uncompressWorker:function(){return new b("STORE decompression")}},x.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,f,x){var b=h("./utils"),v=function(){for(var _,N=[],E=0;E<256;E++){_=E;for(var O=0;O<8;O++)_=1&_?3988292384^_>>>1:_>>>1;N[E]=_}return N}();f.exports=function(_,N){return _!==void 0&&_.length?b.getTypeOf(_)!=="string"?function(E,O,F,z){var P=v,U=0+F;E^=-1;for(var W=0;W<U;W++)E=E>>>8^P[255&(E^O[W])];return-1^E}(0|N,_,_.length):function(E,O,F,z){var P=v,U=0+F;E^=-1;for(var W=0;W<U;W++)E=E>>>8^P[255&(E^O.charCodeAt(W))];return-1^E}(0|N,_,_.length):0}},{"./utils":32}],5:[function(h,f,x){x.base64=!1,x.binary=!1,x.dir=!1,x.createFolders=!0,x.date=null,x.compression=null,x.compressionOptions=null,x.comment=null,x.unixPermissions=null,x.dosPermissions=null},{}],6:[function(h,f,x){var b;b=typeof Promise<"u"?Promise:h("lie"),f.exports={Promise:b}},{lie:37}],7:[function(h,f,x){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",v=h("pako"),_=h("./utils"),N=h("./stream/GenericWorker"),E=b?"uint8array":"array";function O(F,z){N.call(this,"FlateWorker/"+F),this._pako=null,this._pakoAction=F,this._pakoOptions=z,this.meta={}}x.magic="\b\0",_.inherits(O,N),O.prototype.processChunk=function(F){this.meta=F.meta,this._pako===null&&this._createPako(),this._pako.push(_.transformTo(E,F.data),!1)},O.prototype.flush=function(){N.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},O.prototype.cleanUp=function(){N.prototype.cleanUp.call(this),this._pako=null},O.prototype._createPako=function(){this._pako=new v[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var F=this;this._pako.onData=function(z){F.push({data:z,meta:F.meta})}},x.compressWorker=function(F){return new O("Deflate",F)},x.uncompressWorker=function(){return new O("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,f,x){function b(P,U){var W,Y="";for(W=0;W<U;W++)Y+=String.fromCharCode(255&P),P>>>=8;return Y}function v(P,U,W,Y,q,M){var D,T,C=P.file,S=P.compression,w=M!==E.utf8encode,j=_.transformTo("string",M(C.name)),A=_.transformTo("string",E.utf8encode(C.name)),L=C.comment,I=_.transformTo("string",M(L)),Z=_.transformTo("string",E.utf8encode(L)),K=A.length!==C.name.length,re=Z.length!==L.length,G="",ae="",V="",H=C.dir,Q=C.date,oe={crc32:0,compressedSize:0,uncompressedSize:0};U&&!W||(oe.crc32=P.crc32,oe.compressedSize=P.compressedSize,oe.uncompressedSize=P.uncompressedSize);var se=0;U&&(se|=8),w||!K&&!re||(se|=2048);var le=0,he=0;H&&(le|=16),q==="UNIX"?(he=798,le|=function(we,ue){var Se=we;return we||(Se=ue?16893:33204),(65535&Se)<<16}(C.unixPermissions,H)):(he=20,le|=function(we){return 63&(we||0)}(C.dosPermissions)),D=Q.getUTCHours(),D<<=6,D|=Q.getUTCMinutes(),D<<=5,D|=Q.getUTCSeconds()/2,T=Q.getUTCFullYear()-1980,T<<=4,T|=Q.getUTCMonth()+1,T<<=5,T|=Q.getUTCDate(),K&&(ae=b(1,1)+b(O(j),4)+A,G+="up"+b(ae.length,2)+ae),re&&(V=b(1,1)+b(O(I),4)+Z,G+="uc"+b(V.length,2)+V);var Ne="";return Ne+=`
\0`,Ne+=b(se,2),Ne+=S.magic,Ne+=b(D,2),Ne+=b(T,2),Ne+=b(oe.crc32,4),Ne+=b(oe.compressedSize,4),Ne+=b(oe.uncompressedSize,4),Ne+=b(j.length,2),Ne+=b(G.length,2),{fileRecord:F.LOCAL_FILE_HEADER+Ne+j+G,dirRecord:F.CENTRAL_FILE_HEADER+b(he,2)+Ne+b(I.length,2)+"\0\0\0\0"+b(le,4)+b(Y,4)+j+G+I}}var _=h("../utils"),N=h("../stream/GenericWorker"),E=h("../utf8"),O=h("../crc32"),F=h("../signature");function z(P,U,W,Y){N.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=U,this.zipPlatform=W,this.encodeFileName=Y,this.streamFiles=P,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}_.inherits(z,N),z.prototype.push=function(P){var U=P.meta.percent||0,W=this.entriesCount,Y=this._sources.length;this.accumulate?this.contentBuffer.push(P):(this.bytesWritten+=P.data.length,N.prototype.push.call(this,{data:P.data,meta:{currentFile:this.currentFile,percent:W?(U+100*(W-Y-1))/W:100}}))},z.prototype.openedSource=function(P){this.currentSourceOffset=this.bytesWritten,this.currentFile=P.file.name;var U=this.streamFiles&&!P.file.dir;if(U){var W=v(P,U,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:W.fileRecord,meta:{percent:0}})}else this.accumulate=!0},z.prototype.closedSource=function(P){this.accumulate=!1;var U=this.streamFiles&&!P.file.dir,W=v(P,U,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(W.dirRecord),U)this.push({data:function(Y){return F.DATA_DESCRIPTOR+b(Y.crc32,4)+b(Y.compressedSize,4)+b(Y.uncompressedSize,4)}(P),meta:{percent:100}});else for(this.push({data:W.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},z.prototype.flush=function(){for(var P=this.bytesWritten,U=0;U<this.dirRecords.length;U++)this.push({data:this.dirRecords[U],meta:{percent:100}});var W=this.bytesWritten-P,Y=function(q,M,D,T,C){var S=_.transformTo("string",C(T));return F.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(q,2)+b(q,2)+b(M,4)+b(D,4)+b(S.length,2)+S}(this.dirRecords.length,W,P,this.zipComment,this.encodeFileName);this.push({data:Y,meta:{percent:100}})},z.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},z.prototype.registerPrevious=function(P){this._sources.push(P);var U=this;return P.on("data",function(W){U.processChunk(W)}),P.on("end",function(){U.closedSource(U.previous.streamInfo),U._sources.length?U.prepareNextSource():U.end()}),P.on("error",function(W){U.error(W)}),this},z.prototype.resume=function(){return!!N.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},z.prototype.error=function(P){var U=this._sources;if(!N.prototype.error.call(this,P))return!1;for(var W=0;W<U.length;W++)try{U[W].error(P)}catch{}return!0},z.prototype.lock=function(){N.prototype.lock.call(this);for(var P=this._sources,U=0;U<P.length;U++)P[U].lock()},f.exports=z},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,f,x){var b=h("../compressions"),v=h("./ZipFileWorker");x.generateWorker=function(_,N,E){var O=new v(N.streamFiles,E,N.platform,N.encodeFileName),F=0;try{_.forEach(function(z,P){F++;var U=function(M,D){var T=M||D,C=b[T];if(!C)throw new Error(T+" is not a valid compression method !");return C}(P.options.compression,N.compression),W=P.options.compressionOptions||N.compressionOptions||{},Y=P.dir,q=P.date;P._compressWorker(U,W).withStreamInfo("file",{name:z,dir:Y,date:q,comment:P.comment||"",unixPermissions:P.unixPermissions,dosPermissions:P.dosPermissions}).pipe(O)}),O.entriesCount=F}catch(z){O.error(z)}return O}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,f,x){function b(){if(!(this instanceof b))return new b;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var v=new b;for(var _ in this)typeof this[_]!="function"&&(v[_]=this[_]);return v}}(b.prototype=h("./object")).loadAsync=h("./load"),b.support=h("./support"),b.defaults=h("./defaults"),b.version="3.10.1",b.loadAsync=function(v,_){return new b().loadAsync(v,_)},b.external=h("./external"),f.exports=b},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,f,x){var b=h("./utils"),v=h("./external"),_=h("./utf8"),N=h("./zipEntries"),E=h("./stream/Crc32Probe"),O=h("./nodejsUtils");function F(z){return new v.Promise(function(P,U){var W=z.decompressed.getContentWorker().pipe(new E);W.on("error",function(Y){U(Y)}).on("end",function(){W.streamInfo.crc32!==z.decompressed.crc32?U(new Error("Corrupted zip : CRC32 mismatch")):P()}).resume()})}f.exports=function(z,P){var U=this;return P=b.extend(P||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:_.utf8decode}),O.isNode&&O.isStream(z)?v.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):b.prepareContent("the loaded zip file",z,!0,P.optimizedBinaryString,P.base64).then(function(W){var Y=new N(P);return Y.load(W),Y}).then(function(W){var Y=[v.Promise.resolve(W)],q=W.files;if(P.checkCRC32)for(var M=0;M<q.length;M++)Y.push(F(q[M]));return v.Promise.all(Y)}).then(function(W){for(var Y=W.shift(),q=Y.files,M=0;M<q.length;M++){var D=q[M],T=D.fileNameStr,C=b.resolve(D.fileNameStr);U.file(C,D.decompressed,{binary:!0,optimizedBinaryString:!0,date:D.date,dir:D.dir,comment:D.fileCommentStr.length?D.fileCommentStr:null,unixPermissions:D.unixPermissions,dosPermissions:D.dosPermissions,createFolders:P.createFolders}),D.dir||(U.file(C).unsafeOriginalName=T)}return Y.zipComment.length&&(U.comment=Y.zipComment),U})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,f,x){var b=h("../utils"),v=h("../stream/GenericWorker");function _(N,E){v.call(this,"Nodejs stream input adapter for "+N),this._upstreamEnded=!1,this._bindStream(E)}b.inherits(_,v),_.prototype._bindStream=function(N){var E=this;(this._stream=N).pause(),N.on("data",function(O){E.push({data:O,meta:{percent:0}})}).on("error",function(O){E.isPaused?this.generatedError=O:E.error(O)}).on("end",function(){E.isPaused?E._upstreamEnded=!0:E.end()})},_.prototype.pause=function(){return!!v.prototype.pause.call(this)&&(this._stream.pause(),!0)},_.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},f.exports=_},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,f,x){var b=h("readable-stream").Readable;function v(_,N,E){b.call(this,N),this._helper=_;var O=this;_.on("data",function(F,z){O.push(F)||O._helper.pause(),E&&E(z)}).on("error",function(F){O.emit("error",F)}).on("end",function(){O.push(null)})}h("../utils").inherits(v,b),v.prototype._read=function(){this._helper.resume()},f.exports=v},{"../utils":32,"readable-stream":16}],14:[function(h,f,x){f.exports={isNode:l!==void 0,newBufferFrom:function(b,v){if(l.from&&l.from!==Uint8Array.from)return l.from(b,v);if(typeof b=="number")throw new Error('The "data" argument must not be a number');return new l(b,v)},allocBuffer:function(b){if(l.alloc)return l.alloc(b);var v=new l(b);return v.fill(0),v},isBuffer:function(b){return l.isBuffer(b)},isStream:function(b){return b&&typeof b.on=="function"&&typeof b.pause=="function"&&typeof b.resume=="function"}}},{}],15:[function(h,f,x){function b(C,S,w){var j,A=_.getTypeOf(S),L=_.extend(w||{},O);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&16384&L.unixPermissions&&(L.dir=!0),L.dosPermissions&&16&L.dosPermissions&&(L.dir=!0),L.dir&&(C=q(C)),L.createFolders&&(j=Y(C))&&M.call(this,j,!0);var I=A==="string"&&L.binary===!1&&L.base64===!1;w&&w.binary!==void 0||(L.binary=!I),(S instanceof F&&S.uncompressedSize===0||L.dir||!S||S.length===0)&&(L.base64=!1,L.binary=!0,S="",L.compression="STORE",A="string");var Z;Z=S instanceof F||S instanceof N?S:U.isNode&&U.isStream(S)?new W(C,S):_.prepareContent(C,S,L.binary,L.optimizedBinaryString,L.base64);var K=new z(C,Z,L);this.files[C]=K}var v=h("./utf8"),_=h("./utils"),N=h("./stream/GenericWorker"),E=h("./stream/StreamHelper"),O=h("./defaults"),F=h("./compressedObject"),z=h("./zipObject"),P=h("./generate"),U=h("./nodejsUtils"),W=h("./nodejs/NodejsStreamInputAdapter"),Y=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var S=C.lastIndexOf("/");return 0<S?C.substring(0,S):""},q=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},M=function(C,S){return S=S!==void 0?S:O.createFolders,C=q(C),this.files[C]||b.call(this,C,null,{dir:!0,createFolders:S}),this.files[C]};function D(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var S,w,j;for(S in this.files)j=this.files[S],(w=S.slice(this.root.length,S.length))&&S.slice(0,this.root.length)===this.root&&C(w,j)},filter:function(C){var S=[];return this.forEach(function(w,j){C(w,j)&&S.push(j)}),S},file:function(C,S,w){if(arguments.length!==1)return C=this.root+C,b.call(this,C,S,w),this;if(D(C)){var j=C;return this.filter(function(L,I){return!I.dir&&j.test(L)})}var A=this.files[this.root+C];return A&&!A.dir?A:null},folder:function(C){if(!C)return this;if(D(C))return this.filter(function(A,L){return L.dir&&C.test(A)});var S=this.root+C,w=M.call(this,S),j=this.clone();return j.root=w.name,j},remove:function(C){C=this.root+C;var S=this.files[C];if(S||(C.slice(-1)!=="/"&&(C+="/"),S=this.files[C]),S&&!S.dir)delete this.files[C];else for(var w=this.filter(function(A,L){return L.name.slice(0,C.length)===C}),j=0;j<w.length;j++)delete this.files[w[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var S,w={};try{if((w=_.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:v.utf8encode})).type=w.type.toLowerCase(),w.compression=w.compression.toUpperCase(),w.type==="binarystring"&&(w.type="string"),!w.type)throw new Error("No output type specified.");_.checkSupport(w.type),w.platform!=="darwin"&&w.platform!=="freebsd"&&w.platform!=="linux"&&w.platform!=="sunos"||(w.platform="UNIX"),w.platform==="win32"&&(w.platform="DOS");var j=w.comment||this.comment||"";S=P.generateWorker(this,w,j)}catch(A){(S=new N("error")).error(A)}return new E(S,w.type||"string",w.mimeType)},generateAsync:function(C,S){return this.generateInternalStream(C).accumulate(S)},generateNodeStream:function(C,S){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(S)}};f.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,f,x){f.exports=h("stream")},{stream:void 0}],17:[function(h,f,x){var b=h("./DataReader");function v(_){b.call(this,_);for(var N=0;N<this.data.length;N++)_[N]=255&_[N]}h("../utils").inherits(v,b),v.prototype.byteAt=function(_){return this.data[this.zero+_]},v.prototype.lastIndexOfSignature=function(_){for(var N=_.charCodeAt(0),E=_.charCodeAt(1),O=_.charCodeAt(2),F=_.charCodeAt(3),z=this.length-4;0<=z;--z)if(this.data[z]===N&&this.data[z+1]===E&&this.data[z+2]===O&&this.data[z+3]===F)return z-this.zero;return-1},v.prototype.readAndCheckSignature=function(_){var N=_.charCodeAt(0),E=_.charCodeAt(1),O=_.charCodeAt(2),F=_.charCodeAt(3),z=this.readData(4);return N===z[0]&&E===z[1]&&O===z[2]&&F===z[3]},v.prototype.readData=function(_){if(this.checkOffset(_),_===0)return[];var N=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,N},f.exports=v},{"../utils":32,"./DataReader":18}],18:[function(h,f,x){var b=h("../utils");function v(_){this.data=_,this.length=_.length,this.index=0,this.zero=0}v.prototype={checkOffset:function(_){this.checkIndex(this.index+_)},checkIndex:function(_){if(this.length<this.zero+_||_<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+_+"). Corrupted zip ?")},setIndex:function(_){this.checkIndex(_),this.index=_},skip:function(_){this.setIndex(this.index+_)},byteAt:function(){},readInt:function(_){var N,E=0;for(this.checkOffset(_),N=this.index+_-1;N>=this.index;N--)E=(E<<8)+this.byteAt(N);return this.index+=_,E},readString:function(_){return b.transformTo("string",this.readData(_))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var _=this.readInt(4);return new Date(Date.UTC(1980+(_>>25&127),(_>>21&15)-1,_>>16&31,_>>11&31,_>>5&63,(31&_)<<1))}},f.exports=v},{"../utils":32}],19:[function(h,f,x){var b=h("./Uint8ArrayReader");function v(_){b.call(this,_)}h("../utils").inherits(v,b),v.prototype.readData=function(_){this.checkOffset(_);var N=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,N},f.exports=v},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,f,x){var b=h("./DataReader");function v(_){b.call(this,_)}h("../utils").inherits(v,b),v.prototype.byteAt=function(_){return this.data.charCodeAt(this.zero+_)},v.prototype.lastIndexOfSignature=function(_){return this.data.lastIndexOf(_)-this.zero},v.prototype.readAndCheckSignature=function(_){return _===this.readData(4)},v.prototype.readData=function(_){this.checkOffset(_);var N=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,N},f.exports=v},{"../utils":32,"./DataReader":18}],21:[function(h,f,x){var b=h("./ArrayReader");function v(_){b.call(this,_)}h("../utils").inherits(v,b),v.prototype.readData=function(_){if(this.checkOffset(_),_===0)return new Uint8Array(0);var N=this.data.subarray(this.zero+this.index,this.zero+this.index+_);return this.index+=_,N},f.exports=v},{"../utils":32,"./ArrayReader":17}],22:[function(h,f,x){var b=h("../utils"),v=h("../support"),_=h("./ArrayReader"),N=h("./StringReader"),E=h("./NodeBufferReader"),O=h("./Uint8ArrayReader");f.exports=function(F){var z=b.getTypeOf(F);return b.checkSupport(z),z!=="string"||v.uint8array?z==="nodebuffer"?new E(F):v.uint8array?new O(b.transformTo("uint8array",F)):new _(b.transformTo("array",F)):new N(F)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,f,x){x.LOCAL_FILE_HEADER="PK",x.CENTRAL_FILE_HEADER="PK",x.CENTRAL_DIRECTORY_END="PK",x.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",x.ZIP64_CENTRAL_DIRECTORY_END="PK",x.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,f,x){var b=h("./GenericWorker"),v=h("../utils");function _(N){b.call(this,"ConvertWorker to "+N),this.destType=N}v.inherits(_,b),_.prototype.processChunk=function(N){this.push({data:v.transformTo(this.destType,N.data),meta:N.meta})},f.exports=_},{"../utils":32,"./GenericWorker":28}],25:[function(h,f,x){var b=h("./GenericWorker"),v=h("../crc32");function _(){b.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(_,b),_.prototype.processChunk=function(N){this.streamInfo.crc32=v(N.data,this.streamInfo.crc32||0),this.push(N)},f.exports=_},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,f,x){var b=h("../utils"),v=h("./GenericWorker");function _(N){v.call(this,"DataLengthProbe for "+N),this.propName=N,this.withStreamInfo(N,0)}b.inherits(_,v),_.prototype.processChunk=function(N){if(N){var E=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=E+N.data.length}v.prototype.processChunk.call(this,N)},f.exports=_},{"../utils":32,"./GenericWorker":28}],27:[function(h,f,x){var b=h("../utils"),v=h("./GenericWorker");function _(N){v.call(this,"DataWorker");var E=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,N.then(function(O){E.dataIsReady=!0,E.data=O,E.max=O&&O.length||0,E.type=b.getTypeOf(O),E.isPaused||E._tickAndRepeat()},function(O){E.error(O)})}b.inherits(_,v),_.prototype.cleanUp=function(){v.prototype.cleanUp.call(this),this.data=null},_.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,b.delay(this._tickAndRepeat,[],this)),!0)},_.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(b.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},_.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var N=null,E=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":N=this.data.substring(this.index,E);break;case"uint8array":N=this.data.subarray(this.index,E);break;case"array":case"nodebuffer":N=this.data.slice(this.index,E)}return this.index=E,this.push({data:N,meta:{percent:this.max?this.index/this.max*100:0}})},f.exports=_},{"../utils":32,"./GenericWorker":28}],28:[function(h,f,x){function b(v){this.name=v||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}b.prototype={push:function(v){this.emit("data",v)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(v){this.emit("error",v)}return!0},error:function(v){return!this.isFinished&&(this.isPaused?this.generatedError=v:(this.isFinished=!0,this.emit("error",v),this.previous&&this.previous.error(v),this.cleanUp()),!0)},on:function(v,_){return this._listeners[v].push(_),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(v,_){if(this._listeners[v])for(var N=0;N<this._listeners[v].length;N++)this._listeners[v][N].call(this,_)},pipe:function(v){return v.registerPrevious(this)},registerPrevious:function(v){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=v.streamInfo,this.mergeStreamInfo(),this.previous=v;var _=this;return v.on("data",function(N){_.processChunk(N)}),v.on("end",function(){_.end()}),v.on("error",function(N){_.error(N)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var v=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),v=!0),this.previous&&this.previous.resume(),!v},flush:function(){},processChunk:function(v){this.push(v)},withStreamInfo:function(v,_){return this.extraStreamInfo[v]=_,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var v in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,v)&&(this.streamInfo[v]=this.extraStreamInfo[v])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var v="Worker "+this.name;return this.previous?this.previous+" -> "+v:v}},f.exports=b},{}],29:[function(h,f,x){var b=h("../utils"),v=h("./ConvertWorker"),_=h("./GenericWorker"),N=h("../base64"),E=h("../support"),O=h("../external"),F=null;if(E.nodestream)try{F=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function z(P,U,W){var Y=U;switch(U){case"blob":case"arraybuffer":Y="uint8array";break;case"base64":Y="string"}try{this._internalType=Y,this._outputType=U,this._mimeType=W,b.checkSupport(Y),this._worker=P.pipe(new v(Y)),P.lock()}catch(q){this._worker=new _("error"),this._worker.error(q)}}z.prototype={accumulate:function(P){return function(U,W){return new O.Promise(function(Y,q){var M=[],D=U._internalType,T=U._outputType,C=U._mimeType;U.on("data",function(S,w){M.push(S),W&&W(w)}).on("error",function(S){M=[],q(S)}).on("end",function(){try{var S=function(w,j,A){switch(w){case"blob":return b.newBlob(b.transformTo("arraybuffer",j),A);case"base64":return N.encode(j);default:return b.transformTo(w,j)}}(T,function(w,j){var A,L=0,I=null,Z=0;for(A=0;A<j.length;A++)Z+=j[A].length;switch(w){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(I=new Uint8Array(Z),A=0;A<j.length;A++)I.set(j[A],L),L+=j[A].length;return I;case"nodebuffer":return l.concat(j);default:throw new Error("concat : unsupported type '"+w+"'")}}(D,M),C);Y(S)}catch(w){q(w)}M=[]}).resume()})}(this,P)},on:function(P,U){var W=this;return P==="data"?this._worker.on(P,function(Y){U.call(W,Y.data,Y.meta)}):this._worker.on(P,function(){b.delay(U,arguments,W)}),this},resume:function(){return b.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(P){if(b.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new F(this,{objectMode:this._outputType!=="nodebuffer"},P)}},f.exports=z},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,f,x){if(x.base64=!0,x.array=!0,x.string=!0,x.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",x.nodebuffer=l!==void 0,x.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")x.blob=!1;else{var b=new ArrayBuffer(0);try{x.blob=new Blob([b],{type:"application/zip"}).size===0}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);v.append(b),x.blob=v.getBlob("application/zip").size===0}catch{x.blob=!1}}}try{x.nodestream=!!h("readable-stream").Readable}catch{x.nodestream=!1}},{"readable-stream":16}],31:[function(h,f,x){for(var b=h("./utils"),v=h("./support"),_=h("./nodejsUtils"),N=h("./stream/GenericWorker"),E=new Array(256),O=0;O<256;O++)E[O]=252<=O?6:248<=O?5:240<=O?4:224<=O?3:192<=O?2:1;function F(){N.call(this,"utf-8 decode"),this.leftOver=null}function z(){N.call(this,"utf-8 encode")}E[254]=E[254]=1,x.utf8encode=function(P){return v.nodebuffer?_.newBufferFrom(P,"utf-8"):function(U){var W,Y,q,M,D,T=U.length,C=0;for(M=0;M<T;M++)(64512&(Y=U.charCodeAt(M)))==55296&&M+1<T&&(64512&(q=U.charCodeAt(M+1)))==56320&&(Y=65536+(Y-55296<<10)+(q-56320),M++),C+=Y<128?1:Y<2048?2:Y<65536?3:4;for(W=v.uint8array?new Uint8Array(C):new Array(C),M=D=0;D<C;M++)(64512&(Y=U.charCodeAt(M)))==55296&&M+1<T&&(64512&(q=U.charCodeAt(M+1)))==56320&&(Y=65536+(Y-55296<<10)+(q-56320),M++),Y<128?W[D++]=Y:(Y<2048?W[D++]=192|Y>>>6:(Y<65536?W[D++]=224|Y>>>12:(W[D++]=240|Y>>>18,W[D++]=128|Y>>>12&63),W[D++]=128|Y>>>6&63),W[D++]=128|63&Y);return W}(P)},x.utf8decode=function(P){return v.nodebuffer?b.transformTo("nodebuffer",P).toString("utf-8"):function(U){var W,Y,q,M,D=U.length,T=new Array(2*D);for(W=Y=0;W<D;)if((q=U[W++])<128)T[Y++]=q;else if(4<(M=E[q]))T[Y++]=65533,W+=M-1;else{for(q&=M===2?31:M===3?15:7;1<M&&W<D;)q=q<<6|63&U[W++],M--;1<M?T[Y++]=65533:q<65536?T[Y++]=q:(q-=65536,T[Y++]=55296|q>>10&1023,T[Y++]=56320|1023&q)}return T.length!==Y&&(T.subarray?T=T.subarray(0,Y):T.length=Y),b.applyFromCharCode(T)}(P=b.transformTo(v.uint8array?"uint8array":"array",P))},b.inherits(F,N),F.prototype.processChunk=function(P){var U=b.transformTo(v.uint8array?"uint8array":"array",P.data);if(this.leftOver&&this.leftOver.length){if(v.uint8array){var W=U;(U=new Uint8Array(W.length+this.leftOver.length)).set(this.leftOver,0),U.set(W,this.leftOver.length)}else U=this.leftOver.concat(U);this.leftOver=null}var Y=function(M,D){var T;for((D=D||M.length)>M.length&&(D=M.length),T=D-1;0<=T&&(192&M[T])==128;)T--;return T<0||T===0?D:T+E[M[T]]>D?T:D}(U),q=U;Y!==U.length&&(v.uint8array?(q=U.subarray(0,Y),this.leftOver=U.subarray(Y,U.length)):(q=U.slice(0,Y),this.leftOver=U.slice(Y,U.length))),this.push({data:x.utf8decode(q),meta:P.meta})},F.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:x.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},x.Utf8DecodeWorker=F,b.inherits(z,N),z.prototype.processChunk=function(P){this.push({data:x.utf8encode(P.data),meta:P.meta})},x.Utf8EncodeWorker=z},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,f,x){var b=h("./support"),v=h("./base64"),_=h("./nodejsUtils"),N=h("./external");function E(W){return W}function O(W,Y){for(var q=0;q<W.length;++q)Y[q]=255&W.charCodeAt(q);return Y}h("setimmediate"),x.newBlob=function(W,Y){x.checkSupport("blob");try{return new Blob([W],{type:Y})}catch{try{var q=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return q.append(W),q.getBlob(Y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var F={stringifyByChunk:function(W,Y,q){var M=[],D=0,T=W.length;if(T<=q)return String.fromCharCode.apply(null,W);for(;D<T;)Y==="array"||Y==="nodebuffer"?M.push(String.fromCharCode.apply(null,W.slice(D,Math.min(D+q,T)))):M.push(String.fromCharCode.apply(null,W.subarray(D,Math.min(D+q,T)))),D+=q;return M.join("")},stringifyByChar:function(W){for(var Y="",q=0;q<W.length;q++)Y+=String.fromCharCode(W[q]);return Y},applyCanBeUsed:{uint8array:function(){try{return b.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return b.nodebuffer&&String.fromCharCode.apply(null,_.allocBuffer(1)).length===1}catch{return!1}}()}};function z(W){var Y=65536,q=x.getTypeOf(W),M=!0;if(q==="uint8array"?M=F.applyCanBeUsed.uint8array:q==="nodebuffer"&&(M=F.applyCanBeUsed.nodebuffer),M)for(;1<Y;)try{return F.stringifyByChunk(W,q,Y)}catch{Y=Math.floor(Y/2)}return F.stringifyByChar(W)}function P(W,Y){for(var q=0;q<W.length;q++)Y[q]=W[q];return Y}x.applyFromCharCode=z;var U={};U.string={string:E,array:function(W){return O(W,new Array(W.length))},arraybuffer:function(W){return U.string.uint8array(W).buffer},uint8array:function(W){return O(W,new Uint8Array(W.length))},nodebuffer:function(W){return O(W,_.allocBuffer(W.length))}},U.array={string:z,array:E,arraybuffer:function(W){return new Uint8Array(W).buffer},uint8array:function(W){return new Uint8Array(W)},nodebuffer:function(W){return _.newBufferFrom(W)}},U.arraybuffer={string:function(W){return z(new Uint8Array(W))},array:function(W){return P(new Uint8Array(W),new Array(W.byteLength))},arraybuffer:E,uint8array:function(W){return new Uint8Array(W)},nodebuffer:function(W){return _.newBufferFrom(new Uint8Array(W))}},U.uint8array={string:z,array:function(W){return P(W,new Array(W.length))},arraybuffer:function(W){return W.buffer},uint8array:E,nodebuffer:function(W){return _.newBufferFrom(W)}},U.nodebuffer={string:z,array:function(W){return P(W,new Array(W.length))},arraybuffer:function(W){return U.nodebuffer.uint8array(W).buffer},uint8array:function(W){return P(W,new Uint8Array(W.length))},nodebuffer:E},x.transformTo=function(W,Y){if(Y=Y||"",!W)return Y;x.checkSupport(W);var q=x.getTypeOf(Y);return U[q][W](Y)},x.resolve=function(W){for(var Y=W.split("/"),q=[],M=0;M<Y.length;M++){var D=Y[M];D==="."||D===""&&M!==0&&M!==Y.length-1||(D===".."?q.pop():q.push(D))}return q.join("/")},x.getTypeOf=function(W){return typeof W=="string"?"string":Object.prototype.toString.call(W)==="[object Array]"?"array":b.nodebuffer&&_.isBuffer(W)?"nodebuffer":b.uint8array&&W instanceof Uint8Array?"uint8array":b.arraybuffer&&W instanceof ArrayBuffer?"arraybuffer":void 0},x.checkSupport=function(W){if(!b[W.toLowerCase()])throw new Error(W+" is not supported by this platform")},x.MAX_VALUE_16BITS=65535,x.MAX_VALUE_32BITS=-1,x.pretty=function(W){var Y,q,M="";for(q=0;q<(W||"").length;q++)M+="\\x"+((Y=W.charCodeAt(q))<16?"0":"")+Y.toString(16).toUpperCase();return M},x.delay=function(W,Y,q){p(function(){W.apply(q||null,Y||[])})},x.inherits=function(W,Y){function q(){}q.prototype=Y.prototype,W.prototype=new q},x.extend=function(){var W,Y,q={};for(W=0;W<arguments.length;W++)for(Y in arguments[W])Object.prototype.hasOwnProperty.call(arguments[W],Y)&&q[Y]===void 0&&(q[Y]=arguments[W][Y]);return q},x.prepareContent=function(W,Y,q,M,D){return N.Promise.resolve(Y).then(function(T){return b.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new N.Promise(function(C,S){var w=new FileReader;w.onload=function(j){C(j.target.result)},w.onerror=function(j){S(j.target.error)},w.readAsArrayBuffer(T)}):T}).then(function(T){var C=x.getTypeOf(T);return C?(C==="arraybuffer"?T=x.transformTo("uint8array",T):C==="string"&&(D?T=v.decode(T):q&&M!==!0&&(T=function(S){return O(S,b.uint8array?new Uint8Array(S.length):new Array(S.length))}(T))),T):N.Promise.reject(new Error("Can't read the data of '"+W+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,f,x){var b=h("./reader/readerFor"),v=h("./utils"),_=h("./signature"),N=h("./zipEntry"),E=h("./support");function O(F){this.files=[],this.loadOptions=F}O.prototype={checkSignature:function(F){if(!this.reader.readAndCheckSignature(F)){this.reader.index-=4;var z=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+v.pretty(z)+", expected "+v.pretty(F)+")")}},isSignature:function(F,z){var P=this.reader.index;this.reader.setIndex(F);var U=this.reader.readString(4)===z;return this.reader.setIndex(P),U},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var F=this.reader.readData(this.zipCommentLength),z=E.uint8array?"uint8array":"array",P=v.transformTo(z,F);this.zipComment=this.loadOptions.decodeFileName(P)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var F,z,P,U=this.zip64EndOfCentralSize-44;0<U;)F=this.reader.readInt(2),z=this.reader.readInt(4),P=this.reader.readData(z),this.zip64ExtensibleData[F]={id:F,length:z,value:P}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var F,z;for(F=0;F<this.files.length;F++)z=this.files[F],this.reader.setIndex(z.localHeaderOffset),this.checkSignature(_.LOCAL_FILE_HEADER),z.readLocalPart(this.reader),z.handleUTF8(),z.processAttributes()},readCentralDir:function(){var F;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(_.CENTRAL_FILE_HEADER);)(F=new N({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(F);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var F=this.reader.lastIndexOfSignature(_.CENTRAL_DIRECTORY_END);if(F<0)throw this.isSignature(0,_.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(F);var z=F;if(this.checkSignature(_.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===v.MAX_VALUE_16BITS||this.diskWithCentralDirStart===v.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===v.MAX_VALUE_16BITS||this.centralDirRecords===v.MAX_VALUE_16BITS||this.centralDirSize===v.MAX_VALUE_32BITS||this.centralDirOffset===v.MAX_VALUE_32BITS){if(this.zip64=!0,(F=this.reader.lastIndexOfSignature(_.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(F),this.checkSignature(_.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,_.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(_.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(_.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var P=this.centralDirOffset+this.centralDirSize;this.zip64&&(P+=20,P+=12+this.zip64EndOfCentralSize);var U=z-P;if(0<U)this.isSignature(z,_.CENTRAL_FILE_HEADER)||(this.reader.zero=U);else if(U<0)throw new Error("Corrupted zip: missing "+Math.abs(U)+" bytes.")},prepareReader:function(F){this.reader=b(F)},load:function(F){this.prepareReader(F),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},f.exports=O},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,f,x){var b=h("./reader/readerFor"),v=h("./utils"),_=h("./compressedObject"),N=h("./crc32"),E=h("./utf8"),O=h("./compressions"),F=h("./support");function z(P,U){this.options=P,this.loadOptions=U}z.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(P){var U,W;if(P.skip(22),this.fileNameLength=P.readInt(2),W=P.readInt(2),this.fileName=P.readData(this.fileNameLength),P.skip(W),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((U=function(Y){for(var q in O)if(Object.prototype.hasOwnProperty.call(O,q)&&O[q].magic===Y)return O[q];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+v.pretty(this.compressionMethod)+" unknown (inner file : "+v.transformTo("string",this.fileName)+")");this.decompressed=new _(this.compressedSize,this.uncompressedSize,this.crc32,U,P.readData(this.compressedSize))},readCentralPart:function(P){this.versionMadeBy=P.readInt(2),P.skip(2),this.bitFlag=P.readInt(2),this.compressionMethod=P.readString(2),this.date=P.readDate(),this.crc32=P.readInt(4),this.compressedSize=P.readInt(4),this.uncompressedSize=P.readInt(4);var U=P.readInt(2);if(this.extraFieldsLength=P.readInt(2),this.fileCommentLength=P.readInt(2),this.diskNumberStart=P.readInt(2),this.internalFileAttributes=P.readInt(2),this.externalFileAttributes=P.readInt(4),this.localHeaderOffset=P.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");P.skip(U),this.readExtraFields(P),this.parseZIP64ExtraField(P),this.fileComment=P.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var P=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),P==0&&(this.dosPermissions=63&this.externalFileAttributes),P==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var P=b(this.extraFields[1].value);this.uncompressedSize===v.MAX_VALUE_32BITS&&(this.uncompressedSize=P.readInt(8)),this.compressedSize===v.MAX_VALUE_32BITS&&(this.compressedSize=P.readInt(8)),this.localHeaderOffset===v.MAX_VALUE_32BITS&&(this.localHeaderOffset=P.readInt(8)),this.diskNumberStart===v.MAX_VALUE_32BITS&&(this.diskNumberStart=P.readInt(4))}},readExtraFields:function(P){var U,W,Y,q=P.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});P.index+4<q;)U=P.readInt(2),W=P.readInt(2),Y=P.readData(W),this.extraFields[U]={id:U,length:W,value:Y};P.setIndex(q)},handleUTF8:function(){var P=F.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=E.utf8decode(this.fileName),this.fileCommentStr=E.utf8decode(this.fileComment);else{var U=this.findExtraFieldUnicodePath();if(U!==null)this.fileNameStr=U;else{var W=v.transformTo(P,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(W)}var Y=this.findExtraFieldUnicodeComment();if(Y!==null)this.fileCommentStr=Y;else{var q=v.transformTo(P,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(q)}}},findExtraFieldUnicodePath:function(){var P=this.extraFields[28789];if(P){var U=b(P.value);return U.readInt(1)!==1||N(this.fileName)!==U.readInt(4)?null:E.utf8decode(U.readData(P.length-5))}return null},findExtraFieldUnicodeComment:function(){var P=this.extraFields[25461];if(P){var U=b(P.value);return U.readInt(1)!==1||N(this.fileComment)!==U.readInt(4)?null:E.utf8decode(U.readData(P.length-5))}return null}},f.exports=z},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,f,x){function b(U,W,Y){this.name=U,this.dir=Y.dir,this.date=Y.date,this.comment=Y.comment,this.unixPermissions=Y.unixPermissions,this.dosPermissions=Y.dosPermissions,this._data=W,this._dataBinary=Y.binary,this.options={compression:Y.compression,compressionOptions:Y.compressionOptions}}var v=h("./stream/StreamHelper"),_=h("./stream/DataWorker"),N=h("./utf8"),E=h("./compressedObject"),O=h("./stream/GenericWorker");b.prototype={internalStream:function(U){var W=null,Y="string";try{if(!U)throw new Error("No output type specified.");var q=(Y=U.toLowerCase())==="string"||Y==="text";Y!=="binarystring"&&Y!=="text"||(Y="string"),W=this._decompressWorker();var M=!this._dataBinary;M&&!q&&(W=W.pipe(new N.Utf8EncodeWorker)),!M&&q&&(W=W.pipe(new N.Utf8DecodeWorker))}catch(D){(W=new O("error")).error(D)}return new v(W,Y,"")},async:function(U,W){return this.internalStream(U).accumulate(W)},nodeStream:function(U,W){return this.internalStream(U||"nodebuffer").toNodejsStream(W)},_compressWorker:function(U,W){if(this._data instanceof E&&this._data.compression.magic===U.magic)return this._data.getCompressedWorker();var Y=this._decompressWorker();return this._dataBinary||(Y=Y.pipe(new N.Utf8EncodeWorker)),E.createWorkerFrom(Y,U,W)},_decompressWorker:function(){return this._data instanceof E?this._data.getContentWorker():this._data instanceof O?this._data:new _(this._data)}};for(var F=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],z=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},P=0;P<F.length;P++)b.prototype[F[P]]=z;f.exports=b},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,f,x){(function(b){var v,_,N=b.MutationObserver||b.WebKitMutationObserver;if(N){var E=0,O=new N(U),F=b.document.createTextNode("");O.observe(F,{characterData:!0}),v=function(){F.data=E=++E%2}}else if(b.setImmediate||b.MessageChannel===void 0)v="document"in b&&"onreadystatechange"in b.document.createElement("script")?function(){var W=b.document.createElement("script");W.onreadystatechange=function(){U(),W.onreadystatechange=null,W.parentNode.removeChild(W),W=null},b.document.documentElement.appendChild(W)}:function(){setTimeout(U,0)};else{var z=new b.MessageChannel;z.port1.onmessage=U,v=function(){z.port2.postMessage(0)}}var P=[];function U(){var W,Y;_=!0;for(var q=P.length;q;){for(Y=P,P=[],W=-1;++W<q;)Y[W]();q=P.length}_=!1}f.exports=function(W){P.push(W)!==1||_||v()}}).call(this,c!==void 0?c:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(h,f,x){var b=h("immediate");function v(){}var _={},N=["REJECTED"],E=["FULFILLED"],O=["PENDING"];function F(q){if(typeof q!="function")throw new TypeError("resolver must be a function");this.state=O,this.queue=[],this.outcome=void 0,q!==v&&W(this,q)}function z(q,M,D){this.promise=q,typeof M=="function"&&(this.onFulfilled=M,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}function P(q,M,D){b(function(){var T;try{T=M(D)}catch(C){return _.reject(q,C)}T===q?_.reject(q,new TypeError("Cannot resolve promise with itself")):_.resolve(q,T)})}function U(q){var M=q&&q.then;if(q&&(typeof q=="object"||typeof q=="function")&&typeof M=="function")return function(){M.apply(q,arguments)}}function W(q,M){var D=!1;function T(w){D||(D=!0,_.reject(q,w))}function C(w){D||(D=!0,_.resolve(q,w))}var S=Y(function(){M(C,T)});S.status==="error"&&T(S.value)}function Y(q,M){var D={};try{D.value=q(M),D.status="success"}catch(T){D.status="error",D.value=T}return D}(f.exports=F).prototype.finally=function(q){if(typeof q!="function")return this;var M=this.constructor;return this.then(function(D){return M.resolve(q()).then(function(){return D})},function(D){return M.resolve(q()).then(function(){throw D})})},F.prototype.catch=function(q){return this.then(null,q)},F.prototype.then=function(q,M){if(typeof q!="function"&&this.state===E||typeof M!="function"&&this.state===N)return this;var D=new this.constructor(v);return this.state!==O?P(D,this.state===E?q:M,this.outcome):this.queue.push(new z(D,q,M)),D},z.prototype.callFulfilled=function(q){_.resolve(this.promise,q)},z.prototype.otherCallFulfilled=function(q){P(this.promise,this.onFulfilled,q)},z.prototype.callRejected=function(q){_.reject(this.promise,q)},z.prototype.otherCallRejected=function(q){P(this.promise,this.onRejected,q)},_.resolve=function(q,M){var D=Y(U,M);if(D.status==="error")return _.reject(q,D.value);var T=D.value;if(T)W(q,T);else{q.state=E,q.outcome=M;for(var C=-1,S=q.queue.length;++C<S;)q.queue[C].callFulfilled(M)}return q},_.reject=function(q,M){q.state=N,q.outcome=M;for(var D=-1,T=q.queue.length;++D<T;)q.queue[D].callRejected(M);return q},F.resolve=function(q){return q instanceof this?q:_.resolve(new this(v),q)},F.reject=function(q){var M=new this(v);return _.reject(M,q)},F.all=function(q){var M=this;if(Object.prototype.toString.call(q)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=q.length,T=!1;if(!D)return this.resolve([]);for(var C=new Array(D),S=0,w=-1,j=new this(v);++w<D;)A(q[w],w);return j;function A(L,I){M.resolve(L).then(function(Z){C[I]=Z,++S!==D||T||(T=!0,_.resolve(j,C))},function(Z){T||(T=!0,_.reject(j,Z))})}},F.race=function(q){if(Object.prototype.toString.call(q)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=q.length,D=!1;if(!M)return this.resolve([]);for(var T,C=-1,S=new this(v);++C<M;)T=q[C],this.resolve(T).then(function(w){D||(D=!0,_.resolve(S,w))},function(w){D||(D=!0,_.reject(S,w))});return S}},{immediate:36}],38:[function(h,f,x){var b={};(0,h("./lib/utils/common").assign)(b,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),f.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,f,x){var b=h("./zlib/deflate"),v=h("./utils/common"),_=h("./utils/strings"),N=h("./zlib/messages"),E=h("./zlib/zstream"),O=Object.prototype.toString;function F(P){if(!(this instanceof F))return new F(P);this.options=v.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},P||{});var U=this.options;U.raw&&0<U.windowBits?U.windowBits=-U.windowBits:U.gzip&&0<U.windowBits&&U.windowBits<16&&(U.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new E,this.strm.avail_out=0;var W=b.deflateInit2(this.strm,U.level,U.method,U.windowBits,U.memLevel,U.strategy);if(W!==0)throw new Error(N[W]);if(U.header&&b.deflateSetHeader(this.strm,U.header),U.dictionary){var Y;if(Y=typeof U.dictionary=="string"?_.string2buf(U.dictionary):O.call(U.dictionary)==="[object ArrayBuffer]"?new Uint8Array(U.dictionary):U.dictionary,(W=b.deflateSetDictionary(this.strm,Y))!==0)throw new Error(N[W]);this._dict_set=!0}}function z(P,U){var W=new F(U);if(W.push(P,!0),W.err)throw W.msg||N[W.err];return W.result}F.prototype.push=function(P,U){var W,Y,q=this.strm,M=this.options.chunkSize;if(this.ended)return!1;Y=U===~~U?U:U===!0?4:0,typeof P=="string"?q.input=_.string2buf(P):O.call(P)==="[object ArrayBuffer]"?q.input=new Uint8Array(P):q.input=P,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new v.Buf8(M),q.next_out=0,q.avail_out=M),(W=b.deflate(q,Y))!==1&&W!==0)return this.onEnd(W),!(this.ended=!0);q.avail_out!==0&&(q.avail_in!==0||Y!==4&&Y!==2)||(this.options.to==="string"?this.onData(_.buf2binstring(v.shrinkBuf(q.output,q.next_out))):this.onData(v.shrinkBuf(q.output,q.next_out)))}while((0<q.avail_in||q.avail_out===0)&&W!==1);return Y===4?(W=b.deflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===0):Y!==2||(this.onEnd(0),!(q.avail_out=0))},F.prototype.onData=function(P){this.chunks.push(P)},F.prototype.onEnd=function(P){P===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg},x.Deflate=F,x.deflate=z,x.deflateRaw=function(P,U){return(U=U||{}).raw=!0,z(P,U)},x.gzip=function(P,U){return(U=U||{}).gzip=!0,z(P,U)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,f,x){var b=h("./zlib/inflate"),v=h("./utils/common"),_=h("./utils/strings"),N=h("./zlib/constants"),E=h("./zlib/messages"),O=h("./zlib/zstream"),F=h("./zlib/gzheader"),z=Object.prototype.toString;function P(W){if(!(this instanceof P))return new P(W);this.options=v.assign({chunkSize:16384,windowBits:0,to:""},W||{});var Y=this.options;Y.raw&&0<=Y.windowBits&&Y.windowBits<16&&(Y.windowBits=-Y.windowBits,Y.windowBits===0&&(Y.windowBits=-15)),!(0<=Y.windowBits&&Y.windowBits<16)||W&&W.windowBits||(Y.windowBits+=32),15<Y.windowBits&&Y.windowBits<48&&!(15&Y.windowBits)&&(Y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new O,this.strm.avail_out=0;var q=b.inflateInit2(this.strm,Y.windowBits);if(q!==N.Z_OK)throw new Error(E[q]);this.header=new F,b.inflateGetHeader(this.strm,this.header)}function U(W,Y){var q=new P(Y);if(q.push(W,!0),q.err)throw q.msg||E[q.err];return q.result}P.prototype.push=function(W,Y){var q,M,D,T,C,S,w=this.strm,j=this.options.chunkSize,A=this.options.dictionary,L=!1;if(this.ended)return!1;M=Y===~~Y?Y:Y===!0?N.Z_FINISH:N.Z_NO_FLUSH,typeof W=="string"?w.input=_.binstring2buf(W):z.call(W)==="[object ArrayBuffer]"?w.input=new Uint8Array(W):w.input=W,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new v.Buf8(j),w.next_out=0,w.avail_out=j),(q=b.inflate(w,N.Z_NO_FLUSH))===N.Z_NEED_DICT&&A&&(S=typeof A=="string"?_.string2buf(A):z.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,q=b.inflateSetDictionary(this.strm,S)),q===N.Z_BUF_ERROR&&L===!0&&(q=N.Z_OK,L=!1),q!==N.Z_STREAM_END&&q!==N.Z_OK)return this.onEnd(q),!(this.ended=!0);w.next_out&&(w.avail_out!==0&&q!==N.Z_STREAM_END&&(w.avail_in!==0||M!==N.Z_FINISH&&M!==N.Z_SYNC_FLUSH)||(this.options.to==="string"?(D=_.utf8border(w.output,w.next_out),T=w.next_out-D,C=_.buf2string(w.output,D),w.next_out=T,w.avail_out=j-T,T&&v.arraySet(w.output,w.output,D,T,0),this.onData(C)):this.onData(v.shrinkBuf(w.output,w.next_out)))),w.avail_in===0&&w.avail_out===0&&(L=!0)}while((0<w.avail_in||w.avail_out===0)&&q!==N.Z_STREAM_END);return q===N.Z_STREAM_END&&(M=N.Z_FINISH),M===N.Z_FINISH?(q=b.inflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===N.Z_OK):M!==N.Z_SYNC_FLUSH||(this.onEnd(N.Z_OK),!(w.avail_out=0))},P.prototype.onData=function(W){this.chunks.push(W)},P.prototype.onEnd=function(W){W===N.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=W,this.msg=this.strm.msg},x.Inflate=P,x.inflate=U,x.inflateRaw=function(W,Y){return(Y=Y||{}).raw=!0,U(W,Y)},x.ungzip=U},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,f,x){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";x.assign=function(N){for(var E=Array.prototype.slice.call(arguments,1);E.length;){var O=E.shift();if(O){if(typeof O!="object")throw new TypeError(O+"must be non-object");for(var F in O)O.hasOwnProperty(F)&&(N[F]=O[F])}}return N},x.shrinkBuf=function(N,E){return N.length===E?N:N.subarray?N.subarray(0,E):(N.length=E,N)};var v={arraySet:function(N,E,O,F,z){if(E.subarray&&N.subarray)N.set(E.subarray(O,O+F),z);else for(var P=0;P<F;P++)N[z+P]=E[O+P]},flattenChunks:function(N){var E,O,F,z,P,U;for(E=F=0,O=N.length;E<O;E++)F+=N[E].length;for(U=new Uint8Array(F),E=z=0,O=N.length;E<O;E++)P=N[E],U.set(P,z),z+=P.length;return U}},_={arraySet:function(N,E,O,F,z){for(var P=0;P<F;P++)N[z+P]=E[O+P]},flattenChunks:function(N){return[].concat.apply([],N)}};x.setTyped=function(N){N?(x.Buf8=Uint8Array,x.Buf16=Uint16Array,x.Buf32=Int32Array,x.assign(x,v)):(x.Buf8=Array,x.Buf16=Array,x.Buf32=Array,x.assign(x,_))},x.setTyped(b)},{}],42:[function(h,f,x){var b=h("./common"),v=!0,_=!0;try{String.fromCharCode.apply(null,[0])}catch{v=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{_=!1}for(var N=new b.Buf8(256),E=0;E<256;E++)N[E]=252<=E?6:248<=E?5:240<=E?4:224<=E?3:192<=E?2:1;function O(F,z){if(z<65537&&(F.subarray&&_||!F.subarray&&v))return String.fromCharCode.apply(null,b.shrinkBuf(F,z));for(var P="",U=0;U<z;U++)P+=String.fromCharCode(F[U]);return P}N[254]=N[254]=1,x.string2buf=function(F){var z,P,U,W,Y,q=F.length,M=0;for(W=0;W<q;W++)(64512&(P=F.charCodeAt(W)))==55296&&W+1<q&&(64512&(U=F.charCodeAt(W+1)))==56320&&(P=65536+(P-55296<<10)+(U-56320),W++),M+=P<128?1:P<2048?2:P<65536?3:4;for(z=new b.Buf8(M),W=Y=0;Y<M;W++)(64512&(P=F.charCodeAt(W)))==55296&&W+1<q&&(64512&(U=F.charCodeAt(W+1)))==56320&&(P=65536+(P-55296<<10)+(U-56320),W++),P<128?z[Y++]=P:(P<2048?z[Y++]=192|P>>>6:(P<65536?z[Y++]=224|P>>>12:(z[Y++]=240|P>>>18,z[Y++]=128|P>>>12&63),z[Y++]=128|P>>>6&63),z[Y++]=128|63&P);return z},x.buf2binstring=function(F){return O(F,F.length)},x.binstring2buf=function(F){for(var z=new b.Buf8(F.length),P=0,U=z.length;P<U;P++)z[P]=F.charCodeAt(P);return z},x.buf2string=function(F,z){var P,U,W,Y,q=z||F.length,M=new Array(2*q);for(P=U=0;P<q;)if((W=F[P++])<128)M[U++]=W;else if(4<(Y=N[W]))M[U++]=65533,P+=Y-1;else{for(W&=Y===2?31:Y===3?15:7;1<Y&&P<q;)W=W<<6|63&F[P++],Y--;1<Y?M[U++]=65533:W<65536?M[U++]=W:(W-=65536,M[U++]=55296|W>>10&1023,M[U++]=56320|1023&W)}return O(M,U)},x.utf8border=function(F,z){var P;for((z=z||F.length)>F.length&&(z=F.length),P=z-1;0<=P&&(192&F[P])==128;)P--;return P<0||P===0?z:P+N[F[P]]>z?P:z}},{"./common":41}],43:[function(h,f,x){f.exports=function(b,v,_,N){for(var E=65535&b|0,O=b>>>16&65535|0,F=0;_!==0;){for(_-=F=2e3<_?2e3:_;O=O+(E=E+v[N++]|0)|0,--F;);E%=65521,O%=65521}return E|O<<16|0}},{}],44:[function(h,f,x){f.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,f,x){var b=function(){for(var v,_=[],N=0;N<256;N++){v=N;for(var E=0;E<8;E++)v=1&v?3988292384^v>>>1:v>>>1;_[N]=v}return _}();f.exports=function(v,_,N,E){var O=b,F=E+N;v^=-1;for(var z=E;z<F;z++)v=v>>>8^O[255&(v^_[z])];return-1^v}},{}],46:[function(h,f,x){var b,v=h("../utils/common"),_=h("./trees"),N=h("./adler32"),E=h("./crc32"),O=h("./messages"),F=-2,z=258,P=262,U=113;function W(G,ae){return G.msg=O[ae],ae}function Y(G){return(G<<1)-(4<G?9:0)}function q(G){for(var ae=G.length;0<=--ae;)G[ae]=0}function M(G){var ae=G.state,V=ae.pending;V>G.avail_out&&(V=G.avail_out),V!==0&&(v.arraySet(G.output,ae.pending_buf,ae.pending_out,V,G.next_out),G.next_out+=V,ae.pending_out+=V,G.total_out+=V,G.avail_out-=V,ae.pending-=V,ae.pending===0&&(ae.pending_out=0))}function D(G,ae){_._tr_flush_block(G,0<=G.block_start?G.block_start:-1,G.strstart-G.block_start,ae),G.block_start=G.strstart,M(G.strm)}function T(G,ae){G.pending_buf[G.pending++]=ae}function C(G,ae){G.pending_buf[G.pending++]=ae>>>8&255,G.pending_buf[G.pending++]=255&ae}function S(G,ae){var V,H,Q=G.max_chain_length,oe=G.strstart,se=G.prev_length,le=G.nice_match,he=G.strstart>G.w_size-P?G.strstart-(G.w_size-P):0,Ne=G.window,we=G.w_mask,ue=G.prev,Se=G.strstart+z,ke=Ne[oe+se-1],Me=Ne[oe+se];G.prev_length>=G.good_match&&(Q>>=2),le>G.lookahead&&(le=G.lookahead);do if(Ne[(V=ae)+se]===Me&&Ne[V+se-1]===ke&&Ne[V]===Ne[oe]&&Ne[++V]===Ne[oe+1]){oe+=2,V++;do;while(Ne[++oe]===Ne[++V]&&Ne[++oe]===Ne[++V]&&Ne[++oe]===Ne[++V]&&Ne[++oe]===Ne[++V]&&Ne[++oe]===Ne[++V]&&Ne[++oe]===Ne[++V]&&Ne[++oe]===Ne[++V]&&Ne[++oe]===Ne[++V]&&oe<Se);if(H=z-(Se-oe),oe=Se-z,se<H){if(G.match_start=ae,le<=(se=H))break;ke=Ne[oe+se-1],Me=Ne[oe+se]}}while((ae=ue[ae&we])>he&&--Q!=0);return se<=G.lookahead?se:G.lookahead}function w(G){var ae,V,H,Q,oe,se,le,he,Ne,we,ue=G.w_size;do{if(Q=G.window_size-G.lookahead-G.strstart,G.strstart>=ue+(ue-P)){for(v.arraySet(G.window,G.window,ue,ue,0),G.match_start-=ue,G.strstart-=ue,G.block_start-=ue,ae=V=G.hash_size;H=G.head[--ae],G.head[ae]=ue<=H?H-ue:0,--V;);for(ae=V=ue;H=G.prev[--ae],G.prev[ae]=ue<=H?H-ue:0,--V;);Q+=ue}if(G.strm.avail_in===0)break;if(se=G.strm,le=G.window,he=G.strstart+G.lookahead,we=void 0,(Ne=Q)<(we=se.avail_in)&&(we=Ne),V=we===0?0:(se.avail_in-=we,v.arraySet(le,se.input,se.next_in,we,he),se.state.wrap===1?se.adler=N(se.adler,le,we,he):se.state.wrap===2&&(se.adler=E(se.adler,le,we,he)),se.next_in+=we,se.total_in+=we,we),G.lookahead+=V,G.lookahead+G.insert>=3)for(oe=G.strstart-G.insert,G.ins_h=G.window[oe],G.ins_h=(G.ins_h<<G.hash_shift^G.window[oe+1])&G.hash_mask;G.insert&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[oe+3-1])&G.hash_mask,G.prev[oe&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=oe,oe++,G.insert--,!(G.lookahead+G.insert<3)););}while(G.lookahead<P&&G.strm.avail_in!==0)}function j(G,ae){for(var V,H;;){if(G.lookahead<P){if(w(G),G.lookahead<P&&ae===0)return 1;if(G.lookahead===0)break}if(V=0,G.lookahead>=3&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),V!==0&&G.strstart-V<=G.w_size-P&&(G.match_length=S(G,V)),G.match_length>=3)if(H=_._tr_tally(G,G.strstart-G.match_start,G.match_length-3),G.lookahead-=G.match_length,G.match_length<=G.max_lazy_match&&G.lookahead>=3){for(G.match_length--;G.strstart++,G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart,--G.match_length!=0;);G.strstart++}else G.strstart+=G.match_length,G.match_length=0,G.ins_h=G.window[G.strstart],G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+1])&G.hash_mask;else H=_._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++;if(H&&(D(G,!1),G.strm.avail_out===0))return 1}return G.insert=G.strstart<2?G.strstart:2,ae===4?(D(G,!0),G.strm.avail_out===0?3:4):G.last_lit&&(D(G,!1),G.strm.avail_out===0)?1:2}function A(G,ae){for(var V,H,Q;;){if(G.lookahead<P){if(w(G),G.lookahead<P&&ae===0)return 1;if(G.lookahead===0)break}if(V=0,G.lookahead>=3&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),G.prev_length=G.match_length,G.prev_match=G.match_start,G.match_length=2,V!==0&&G.prev_length<G.max_lazy_match&&G.strstart-V<=G.w_size-P&&(G.match_length=S(G,V),G.match_length<=5&&(G.strategy===1||G.match_length===3&&4096<G.strstart-G.match_start)&&(G.match_length=2)),G.prev_length>=3&&G.match_length<=G.prev_length){for(Q=G.strstart+G.lookahead-3,H=_._tr_tally(G,G.strstart-1-G.prev_match,G.prev_length-3),G.lookahead-=G.prev_length-1,G.prev_length-=2;++G.strstart<=Q&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),--G.prev_length!=0;);if(G.match_available=0,G.match_length=2,G.strstart++,H&&(D(G,!1),G.strm.avail_out===0))return 1}else if(G.match_available){if((H=_._tr_tally(G,0,G.window[G.strstart-1]))&&D(G,!1),G.strstart++,G.lookahead--,G.strm.avail_out===0)return 1}else G.match_available=1,G.strstart++,G.lookahead--}return G.match_available&&(H=_._tr_tally(G,0,G.window[G.strstart-1]),G.match_available=0),G.insert=G.strstart<2?G.strstart:2,ae===4?(D(G,!0),G.strm.avail_out===0?3:4):G.last_lit&&(D(G,!1),G.strm.avail_out===0)?1:2}function L(G,ae,V,H,Q){this.good_length=G,this.max_lazy=ae,this.nice_length=V,this.max_chain=H,this.func=Q}function I(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new v.Buf16(1146),this.dyn_dtree=new v.Buf16(122),this.bl_tree=new v.Buf16(78),q(this.dyn_ltree),q(this.dyn_dtree),q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new v.Buf16(16),this.heap=new v.Buf16(573),q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new v.Buf16(573),q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Z(G){var ae;return G&&G.state?(G.total_in=G.total_out=0,G.data_type=2,(ae=G.state).pending=0,ae.pending_out=0,ae.wrap<0&&(ae.wrap=-ae.wrap),ae.status=ae.wrap?42:U,G.adler=ae.wrap===2?0:1,ae.last_flush=0,_._tr_init(ae),0):W(G,F)}function K(G){var ae=Z(G);return ae===0&&function(V){V.window_size=2*V.w_size,q(V.head),V.max_lazy_match=b[V.level].max_lazy,V.good_match=b[V.level].good_length,V.nice_match=b[V.level].nice_length,V.max_chain_length=b[V.level].max_chain,V.strstart=0,V.block_start=0,V.lookahead=0,V.insert=0,V.match_length=V.prev_length=2,V.match_available=0,V.ins_h=0}(G.state),ae}function re(G,ae,V,H,Q,oe){if(!G)return F;var se=1;if(ae===-1&&(ae=6),H<0?(se=0,H=-H):15<H&&(se=2,H-=16),Q<1||9<Q||V!==8||H<8||15<H||ae<0||9<ae||oe<0||4<oe)return W(G,F);H===8&&(H=9);var le=new I;return(G.state=le).strm=G,le.wrap=se,le.gzhead=null,le.w_bits=H,le.w_size=1<<le.w_bits,le.w_mask=le.w_size-1,le.hash_bits=Q+7,le.hash_size=1<<le.hash_bits,le.hash_mask=le.hash_size-1,le.hash_shift=~~((le.hash_bits+3-1)/3),le.window=new v.Buf8(2*le.w_size),le.head=new v.Buf16(le.hash_size),le.prev=new v.Buf16(le.w_size),le.lit_bufsize=1<<Q+6,le.pending_buf_size=4*le.lit_bufsize,le.pending_buf=new v.Buf8(le.pending_buf_size),le.d_buf=1*le.lit_bufsize,le.l_buf=3*le.lit_bufsize,le.level=ae,le.strategy=oe,le.method=V,K(G)}b=[new L(0,0,0,0,function(G,ae){var V=65535;for(V>G.pending_buf_size-5&&(V=G.pending_buf_size-5);;){if(G.lookahead<=1){if(w(G),G.lookahead===0&&ae===0)return 1;if(G.lookahead===0)break}G.strstart+=G.lookahead,G.lookahead=0;var H=G.block_start+V;if((G.strstart===0||G.strstart>=H)&&(G.lookahead=G.strstart-H,G.strstart=H,D(G,!1),G.strm.avail_out===0)||G.strstart-G.block_start>=G.w_size-P&&(D(G,!1),G.strm.avail_out===0))return 1}return G.insert=0,ae===4?(D(G,!0),G.strm.avail_out===0?3:4):(G.strstart>G.block_start&&(D(G,!1),G.strm.avail_out),1)}),new L(4,4,8,4,j),new L(4,5,16,8,j),new L(4,6,32,32,j),new L(4,4,16,16,A),new L(8,16,32,32,A),new L(8,16,128,128,A),new L(8,32,128,256,A),new L(32,128,258,1024,A),new L(32,258,258,4096,A)],x.deflateInit=function(G,ae){return re(G,ae,8,15,8,0)},x.deflateInit2=re,x.deflateReset=K,x.deflateResetKeep=Z,x.deflateSetHeader=function(G,ae){return G&&G.state?G.state.wrap!==2?F:(G.state.gzhead=ae,0):F},x.deflate=function(G,ae){var V,H,Q,oe;if(!G||!G.state||5<ae||ae<0)return G?W(G,F):F;if(H=G.state,!G.output||!G.input&&G.avail_in!==0||H.status===666&&ae!==4)return W(G,G.avail_out===0?-5:F);if(H.strm=G,V=H.last_flush,H.last_flush=ae,H.status===42)if(H.wrap===2)G.adler=0,T(H,31),T(H,139),T(H,8),H.gzhead?(T(H,(H.gzhead.text?1:0)+(H.gzhead.hcrc?2:0)+(H.gzhead.extra?4:0)+(H.gzhead.name?8:0)+(H.gzhead.comment?16:0)),T(H,255&H.gzhead.time),T(H,H.gzhead.time>>8&255),T(H,H.gzhead.time>>16&255),T(H,H.gzhead.time>>24&255),T(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),T(H,255&H.gzhead.os),H.gzhead.extra&&H.gzhead.extra.length&&(T(H,255&H.gzhead.extra.length),T(H,H.gzhead.extra.length>>8&255)),H.gzhead.hcrc&&(G.adler=E(G.adler,H.pending_buf,H.pending,0)),H.gzindex=0,H.status=69):(T(H,0),T(H,0),T(H,0),T(H,0),T(H,0),T(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),T(H,3),H.status=U);else{var se=8+(H.w_bits-8<<4)<<8;se|=(2<=H.strategy||H.level<2?0:H.level<6?1:H.level===6?2:3)<<6,H.strstart!==0&&(se|=32),se+=31-se%31,H.status=U,C(H,se),H.strstart!==0&&(C(H,G.adler>>>16),C(H,65535&G.adler)),G.adler=1}if(H.status===69)if(H.gzhead.extra){for(Q=H.pending;H.gzindex<(65535&H.gzhead.extra.length)&&(H.pending!==H.pending_buf_size||(H.gzhead.hcrc&&H.pending>Q&&(G.adler=E(G.adler,H.pending_buf,H.pending-Q,Q)),M(G),Q=H.pending,H.pending!==H.pending_buf_size));)T(H,255&H.gzhead.extra[H.gzindex]),H.gzindex++;H.gzhead.hcrc&&H.pending>Q&&(G.adler=E(G.adler,H.pending_buf,H.pending-Q,Q)),H.gzindex===H.gzhead.extra.length&&(H.gzindex=0,H.status=73)}else H.status=73;if(H.status===73)if(H.gzhead.name){Q=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>Q&&(G.adler=E(G.adler,H.pending_buf,H.pending-Q,Q)),M(G),Q=H.pending,H.pending===H.pending_buf_size)){oe=1;break}oe=H.gzindex<H.gzhead.name.length?255&H.gzhead.name.charCodeAt(H.gzindex++):0,T(H,oe)}while(oe!==0);H.gzhead.hcrc&&H.pending>Q&&(G.adler=E(G.adler,H.pending_buf,H.pending-Q,Q)),oe===0&&(H.gzindex=0,H.status=91)}else H.status=91;if(H.status===91)if(H.gzhead.comment){Q=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>Q&&(G.adler=E(G.adler,H.pending_buf,H.pending-Q,Q)),M(G),Q=H.pending,H.pending===H.pending_buf_size)){oe=1;break}oe=H.gzindex<H.gzhead.comment.length?255&H.gzhead.comment.charCodeAt(H.gzindex++):0,T(H,oe)}while(oe!==0);H.gzhead.hcrc&&H.pending>Q&&(G.adler=E(G.adler,H.pending_buf,H.pending-Q,Q)),oe===0&&(H.status=103)}else H.status=103;if(H.status===103&&(H.gzhead.hcrc?(H.pending+2>H.pending_buf_size&&M(G),H.pending+2<=H.pending_buf_size&&(T(H,255&G.adler),T(H,G.adler>>8&255),G.adler=0,H.status=U)):H.status=U),H.pending!==0){if(M(G),G.avail_out===0)return H.last_flush=-1,0}else if(G.avail_in===0&&Y(ae)<=Y(V)&&ae!==4)return W(G,-5);if(H.status===666&&G.avail_in!==0)return W(G,-5);if(G.avail_in!==0||H.lookahead!==0||ae!==0&&H.status!==666){var le=H.strategy===2?function(he,Ne){for(var we;;){if(he.lookahead===0&&(w(he),he.lookahead===0)){if(Ne===0)return 1;break}if(he.match_length=0,we=_._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++,we&&(D(he,!1),he.strm.avail_out===0))return 1}return he.insert=0,Ne===4?(D(he,!0),he.strm.avail_out===0?3:4):he.last_lit&&(D(he,!1),he.strm.avail_out===0)?1:2}(H,ae):H.strategy===3?function(he,Ne){for(var we,ue,Se,ke,Me=he.window;;){if(he.lookahead<=z){if(w(he),he.lookahead<=z&&Ne===0)return 1;if(he.lookahead===0)break}if(he.match_length=0,he.lookahead>=3&&0<he.strstart&&(ue=Me[Se=he.strstart-1])===Me[++Se]&&ue===Me[++Se]&&ue===Me[++Se]){ke=he.strstart+z;do;while(ue===Me[++Se]&&ue===Me[++Se]&&ue===Me[++Se]&&ue===Me[++Se]&&ue===Me[++Se]&&ue===Me[++Se]&&ue===Me[++Se]&&ue===Me[++Se]&&Se<ke);he.match_length=z-(ke-Se),he.match_length>he.lookahead&&(he.match_length=he.lookahead)}if(he.match_length>=3?(we=_._tr_tally(he,1,he.match_length-3),he.lookahead-=he.match_length,he.strstart+=he.match_length,he.match_length=0):(we=_._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++),we&&(D(he,!1),he.strm.avail_out===0))return 1}return he.insert=0,Ne===4?(D(he,!0),he.strm.avail_out===0?3:4):he.last_lit&&(D(he,!1),he.strm.avail_out===0)?1:2}(H,ae):b[H.level].func(H,ae);if(le!==3&&le!==4||(H.status=666),le===1||le===3)return G.avail_out===0&&(H.last_flush=-1),0;if(le===2&&(ae===1?_._tr_align(H):ae!==5&&(_._tr_stored_block(H,0,0,!1),ae===3&&(q(H.head),H.lookahead===0&&(H.strstart=0,H.block_start=0,H.insert=0))),M(G),G.avail_out===0))return H.last_flush=-1,0}return ae!==4?0:H.wrap<=0?1:(H.wrap===2?(T(H,255&G.adler),T(H,G.adler>>8&255),T(H,G.adler>>16&255),T(H,G.adler>>24&255),T(H,255&G.total_in),T(H,G.total_in>>8&255),T(H,G.total_in>>16&255),T(H,G.total_in>>24&255)):(C(H,G.adler>>>16),C(H,65535&G.adler)),M(G),0<H.wrap&&(H.wrap=-H.wrap),H.pending!==0?0:1)},x.deflateEnd=function(G){var ae;return G&&G.state?(ae=G.state.status)!==42&&ae!==69&&ae!==73&&ae!==91&&ae!==103&&ae!==U&&ae!==666?W(G,F):(G.state=null,ae===U?W(G,-3):0):F},x.deflateSetDictionary=function(G,ae){var V,H,Q,oe,se,le,he,Ne,we=ae.length;if(!G||!G.state||(oe=(V=G.state).wrap)===2||oe===1&&V.status!==42||V.lookahead)return F;for(oe===1&&(G.adler=N(G.adler,ae,we,0)),V.wrap=0,we>=V.w_size&&(oe===0&&(q(V.head),V.strstart=0,V.block_start=0,V.insert=0),Ne=new v.Buf8(V.w_size),v.arraySet(Ne,ae,we-V.w_size,V.w_size,0),ae=Ne,we=V.w_size),se=G.avail_in,le=G.next_in,he=G.input,G.avail_in=we,G.next_in=0,G.input=ae,w(V);V.lookahead>=3;){for(H=V.strstart,Q=V.lookahead-2;V.ins_h=(V.ins_h<<V.hash_shift^V.window[H+3-1])&V.hash_mask,V.prev[H&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=H,H++,--Q;);V.strstart=H,V.lookahead=2,w(V)}return V.strstart+=V.lookahead,V.block_start=V.strstart,V.insert=V.lookahead,V.lookahead=0,V.match_length=V.prev_length=2,V.match_available=0,G.next_in=le,G.input=he,G.avail_in=se,V.wrap=oe,0},x.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,f,x){f.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,f,x){f.exports=function(b,v){var _,N,E,O,F,z,P,U,W,Y,q,M,D,T,C,S,w,j,A,L,I,Z,K,re,G;_=b.state,N=b.next_in,re=b.input,E=N+(b.avail_in-5),O=b.next_out,G=b.output,F=O-(v-b.avail_out),z=O+(b.avail_out-257),P=_.dmax,U=_.wsize,W=_.whave,Y=_.wnext,q=_.window,M=_.hold,D=_.bits,T=_.lencode,C=_.distcode,S=(1<<_.lenbits)-1,w=(1<<_.distbits)-1;e:do{D<15&&(M+=re[N++]<<D,D+=8,M+=re[N++]<<D,D+=8),j=T[M&S];t:for(;;){if(M>>>=A=j>>>24,D-=A,(A=j>>>16&255)==0)G[O++]=65535&j;else{if(!(16&A)){if(!(64&A)){j=T[(65535&j)+(M&(1<<A)-1)];continue t}if(32&A){_.mode=12;break e}b.msg="invalid literal/length code",_.mode=30;break e}L=65535&j,(A&=15)&&(D<A&&(M+=re[N++]<<D,D+=8),L+=M&(1<<A)-1,M>>>=A,D-=A),D<15&&(M+=re[N++]<<D,D+=8,M+=re[N++]<<D,D+=8),j=C[M&w];r:for(;;){if(M>>>=A=j>>>24,D-=A,!(16&(A=j>>>16&255))){if(!(64&A)){j=C[(65535&j)+(M&(1<<A)-1)];continue r}b.msg="invalid distance code",_.mode=30;break e}if(I=65535&j,D<(A&=15)&&(M+=re[N++]<<D,(D+=8)<A&&(M+=re[N++]<<D,D+=8)),P<(I+=M&(1<<A)-1)){b.msg="invalid distance too far back",_.mode=30;break e}if(M>>>=A,D-=A,(A=O-F)<I){if(W<(A=I-A)&&_.sane){b.msg="invalid distance too far back",_.mode=30;break e}if(K=q,(Z=0)===Y){if(Z+=U-A,A<L){for(L-=A;G[O++]=q[Z++],--A;);Z=O-I,K=G}}else if(Y<A){if(Z+=U+Y-A,(A-=Y)<L){for(L-=A;G[O++]=q[Z++],--A;);if(Z=0,Y<L){for(L-=A=Y;G[O++]=q[Z++],--A;);Z=O-I,K=G}}}else if(Z+=Y-A,A<L){for(L-=A;G[O++]=q[Z++],--A;);Z=O-I,K=G}for(;2<L;)G[O++]=K[Z++],G[O++]=K[Z++],G[O++]=K[Z++],L-=3;L&&(G[O++]=K[Z++],1<L&&(G[O++]=K[Z++]))}else{for(Z=O-I;G[O++]=G[Z++],G[O++]=G[Z++],G[O++]=G[Z++],2<(L-=3););L&&(G[O++]=G[Z++],1<L&&(G[O++]=G[Z++]))}break}}break}}while(N<E&&O<z);N-=L=D>>3,M&=(1<<(D-=L<<3))-1,b.next_in=N,b.next_out=O,b.avail_in=N<E?E-N+5:5-(N-E),b.avail_out=O<z?z-O+257:257-(O-z),_.hold=M,_.bits=D}},{}],49:[function(h,f,x){var b=h("../utils/common"),v=h("./adler32"),_=h("./crc32"),N=h("./inffast"),E=h("./inftrees"),O=-2;function F(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function z(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function P(S){var w;return S&&S.state?(w=S.state,S.total_in=S.total_out=w.total=0,S.msg="",w.wrap&&(S.adler=1&w.wrap),w.mode=1,w.last=0,w.havedict=0,w.dmax=32768,w.head=null,w.hold=0,w.bits=0,w.lencode=w.lendyn=new b.Buf32(852),w.distcode=w.distdyn=new b.Buf32(592),w.sane=1,w.back=-1,0):O}function U(S){var w;return S&&S.state?((w=S.state).wsize=0,w.whave=0,w.wnext=0,P(S)):O}function W(S,w){var j,A;return S&&S.state?(A=S.state,w<0?(j=0,w=-w):(j=1+(w>>4),w<48&&(w&=15)),w&&(w<8||15<w)?O:(A.window!==null&&A.wbits!==w&&(A.window=null),A.wrap=j,A.wbits=w,U(S))):O}function Y(S,w){var j,A;return S?(A=new z,(S.state=A).window=null,(j=W(S,w))!==0&&(S.state=null),j):O}var q,M,D=!0;function T(S){if(D){var w;for(q=new b.Buf32(512),M=new b.Buf32(32),w=0;w<144;)S.lens[w++]=8;for(;w<256;)S.lens[w++]=9;for(;w<280;)S.lens[w++]=7;for(;w<288;)S.lens[w++]=8;for(E(1,S.lens,0,288,q,0,S.work,{bits:9}),w=0;w<32;)S.lens[w++]=5;E(2,S.lens,0,32,M,0,S.work,{bits:5}),D=!1}S.lencode=q,S.lenbits=9,S.distcode=M,S.distbits=5}function C(S,w,j,A){var L,I=S.state;return I.window===null&&(I.wsize=1<<I.wbits,I.wnext=0,I.whave=0,I.window=new b.Buf8(I.wsize)),A>=I.wsize?(b.arraySet(I.window,w,j-I.wsize,I.wsize,0),I.wnext=0,I.whave=I.wsize):(A<(L=I.wsize-I.wnext)&&(L=A),b.arraySet(I.window,w,j-A,L,I.wnext),(A-=L)?(b.arraySet(I.window,w,j-A,A,0),I.wnext=A,I.whave=I.wsize):(I.wnext+=L,I.wnext===I.wsize&&(I.wnext=0),I.whave<I.wsize&&(I.whave+=L))),0}x.inflateReset=U,x.inflateReset2=W,x.inflateResetKeep=P,x.inflateInit=function(S){return Y(S,15)},x.inflateInit2=Y,x.inflate=function(S,w){var j,A,L,I,Z,K,re,G,ae,V,H,Q,oe,se,le,he,Ne,we,ue,Se,ke,Me,Oe,je,Ie=0,Pe=new b.Buf8(4),He=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return O;(j=S.state).mode===12&&(j.mode=13),Z=S.next_out,L=S.output,re=S.avail_out,I=S.next_in,A=S.input,K=S.avail_in,G=j.hold,ae=j.bits,V=K,H=re,Me=0;e:for(;;)switch(j.mode){case 1:if(j.wrap===0){j.mode=13;break}for(;ae<16;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(2&j.wrap&&G===35615){Pe[j.check=0]=255&G,Pe[1]=G>>>8&255,j.check=_(j.check,Pe,2,0),ae=G=0,j.mode=2;break}if(j.flags=0,j.head&&(j.head.done=!1),!(1&j.wrap)||(((255&G)<<8)+(G>>8))%31){S.msg="incorrect header check",j.mode=30;break}if((15&G)!=8){S.msg="unknown compression method",j.mode=30;break}if(ae-=4,ke=8+(15&(G>>>=4)),j.wbits===0)j.wbits=ke;else if(ke>j.wbits){S.msg="invalid window size",j.mode=30;break}j.dmax=1<<ke,S.adler=j.check=1,j.mode=512&G?10:12,ae=G=0;break;case 2:for(;ae<16;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(j.flags=G,(255&j.flags)!=8){S.msg="unknown compression method",j.mode=30;break}if(57344&j.flags){S.msg="unknown header flags set",j.mode=30;break}j.head&&(j.head.text=G>>8&1),512&j.flags&&(Pe[0]=255&G,Pe[1]=G>>>8&255,j.check=_(j.check,Pe,2,0)),ae=G=0,j.mode=3;case 3:for(;ae<32;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}j.head&&(j.head.time=G),512&j.flags&&(Pe[0]=255&G,Pe[1]=G>>>8&255,Pe[2]=G>>>16&255,Pe[3]=G>>>24&255,j.check=_(j.check,Pe,4,0)),ae=G=0,j.mode=4;case 4:for(;ae<16;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}j.head&&(j.head.xflags=255&G,j.head.os=G>>8),512&j.flags&&(Pe[0]=255&G,Pe[1]=G>>>8&255,j.check=_(j.check,Pe,2,0)),ae=G=0,j.mode=5;case 5:if(1024&j.flags){for(;ae<16;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}j.length=G,j.head&&(j.head.extra_len=G),512&j.flags&&(Pe[0]=255&G,Pe[1]=G>>>8&255,j.check=_(j.check,Pe,2,0)),ae=G=0}else j.head&&(j.head.extra=null);j.mode=6;case 6:if(1024&j.flags&&(K<(Q=j.length)&&(Q=K),Q&&(j.head&&(ke=j.head.extra_len-j.length,j.head.extra||(j.head.extra=new Array(j.head.extra_len)),b.arraySet(j.head.extra,A,I,Q,ke)),512&j.flags&&(j.check=_(j.check,A,Q,I)),K-=Q,I+=Q,j.length-=Q),j.length))break e;j.length=0,j.mode=7;case 7:if(2048&j.flags){if(K===0)break e;for(Q=0;ke=A[I+Q++],j.head&&ke&&j.length<65536&&(j.head.name+=String.fromCharCode(ke)),ke&&Q<K;);if(512&j.flags&&(j.check=_(j.check,A,Q,I)),K-=Q,I+=Q,ke)break e}else j.head&&(j.head.name=null);j.length=0,j.mode=8;case 8:if(4096&j.flags){if(K===0)break e;for(Q=0;ke=A[I+Q++],j.head&&ke&&j.length<65536&&(j.head.comment+=String.fromCharCode(ke)),ke&&Q<K;);if(512&j.flags&&(j.check=_(j.check,A,Q,I)),K-=Q,I+=Q,ke)break e}else j.head&&(j.head.comment=null);j.mode=9;case 9:if(512&j.flags){for(;ae<16;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(G!==(65535&j.check)){S.msg="header crc mismatch",j.mode=30;break}ae=G=0}j.head&&(j.head.hcrc=j.flags>>9&1,j.head.done=!0),S.adler=j.check=0,j.mode=12;break;case 10:for(;ae<32;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}S.adler=j.check=F(G),ae=G=0,j.mode=11;case 11:if(j.havedict===0)return S.next_out=Z,S.avail_out=re,S.next_in=I,S.avail_in=K,j.hold=G,j.bits=ae,2;S.adler=j.check=1,j.mode=12;case 12:if(w===5||w===6)break e;case 13:if(j.last){G>>>=7&ae,ae-=7&ae,j.mode=27;break}for(;ae<3;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}switch(j.last=1&G,ae-=1,3&(G>>>=1)){case 0:j.mode=14;break;case 1:if(T(j),j.mode=20,w!==6)break;G>>>=2,ae-=2;break e;case 2:j.mode=17;break;case 3:S.msg="invalid block type",j.mode=30}G>>>=2,ae-=2;break;case 14:for(G>>>=7&ae,ae-=7&ae;ae<32;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if((65535&G)!=(G>>>16^65535)){S.msg="invalid stored block lengths",j.mode=30;break}if(j.length=65535&G,ae=G=0,j.mode=15,w===6)break e;case 15:j.mode=16;case 16:if(Q=j.length){if(K<Q&&(Q=K),re<Q&&(Q=re),Q===0)break e;b.arraySet(L,A,I,Q,Z),K-=Q,I+=Q,re-=Q,Z+=Q,j.length-=Q;break}j.mode=12;break;case 17:for(;ae<14;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(j.nlen=257+(31&G),G>>>=5,ae-=5,j.ndist=1+(31&G),G>>>=5,ae-=5,j.ncode=4+(15&G),G>>>=4,ae-=4,286<j.nlen||30<j.ndist){S.msg="too many length or distance symbols",j.mode=30;break}j.have=0,j.mode=18;case 18:for(;j.have<j.ncode;){for(;ae<3;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}j.lens[He[j.have++]]=7&G,G>>>=3,ae-=3}for(;j.have<19;)j.lens[He[j.have++]]=0;if(j.lencode=j.lendyn,j.lenbits=7,Oe={bits:j.lenbits},Me=E(0,j.lens,0,19,j.lencode,0,j.work,Oe),j.lenbits=Oe.bits,Me){S.msg="invalid code lengths set",j.mode=30;break}j.have=0,j.mode=19;case 19:for(;j.have<j.nlen+j.ndist;){for(;he=(Ie=j.lencode[G&(1<<j.lenbits)-1])>>>16&255,Ne=65535&Ie,!((le=Ie>>>24)<=ae);){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(Ne<16)G>>>=le,ae-=le,j.lens[j.have++]=Ne;else{if(Ne===16){for(je=le+2;ae<je;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(G>>>=le,ae-=le,j.have===0){S.msg="invalid bit length repeat",j.mode=30;break}ke=j.lens[j.have-1],Q=3+(3&G),G>>>=2,ae-=2}else if(Ne===17){for(je=le+3;ae<je;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}ae-=le,ke=0,Q=3+(7&(G>>>=le)),G>>>=3,ae-=3}else{for(je=le+7;ae<je;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}ae-=le,ke=0,Q=11+(127&(G>>>=le)),G>>>=7,ae-=7}if(j.have+Q>j.nlen+j.ndist){S.msg="invalid bit length repeat",j.mode=30;break}for(;Q--;)j.lens[j.have++]=ke}}if(j.mode===30)break;if(j.lens[256]===0){S.msg="invalid code -- missing end-of-block",j.mode=30;break}if(j.lenbits=9,Oe={bits:j.lenbits},Me=E(1,j.lens,0,j.nlen,j.lencode,0,j.work,Oe),j.lenbits=Oe.bits,Me){S.msg="invalid literal/lengths set",j.mode=30;break}if(j.distbits=6,j.distcode=j.distdyn,Oe={bits:j.distbits},Me=E(2,j.lens,j.nlen,j.ndist,j.distcode,0,j.work,Oe),j.distbits=Oe.bits,Me){S.msg="invalid distances set",j.mode=30;break}if(j.mode=20,w===6)break e;case 20:j.mode=21;case 21:if(6<=K&&258<=re){S.next_out=Z,S.avail_out=re,S.next_in=I,S.avail_in=K,j.hold=G,j.bits=ae,N(S,H),Z=S.next_out,L=S.output,re=S.avail_out,I=S.next_in,A=S.input,K=S.avail_in,G=j.hold,ae=j.bits,j.mode===12&&(j.back=-1);break}for(j.back=0;he=(Ie=j.lencode[G&(1<<j.lenbits)-1])>>>16&255,Ne=65535&Ie,!((le=Ie>>>24)<=ae);){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(he&&!(240&he)){for(we=le,ue=he,Se=Ne;he=(Ie=j.lencode[Se+((G&(1<<we+ue)-1)>>we)])>>>16&255,Ne=65535&Ie,!(we+(le=Ie>>>24)<=ae);){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}G>>>=we,ae-=we,j.back+=we}if(G>>>=le,ae-=le,j.back+=le,j.length=Ne,he===0){j.mode=26;break}if(32&he){j.back=-1,j.mode=12;break}if(64&he){S.msg="invalid literal/length code",j.mode=30;break}j.extra=15&he,j.mode=22;case 22:if(j.extra){for(je=j.extra;ae<je;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}j.length+=G&(1<<j.extra)-1,G>>>=j.extra,ae-=j.extra,j.back+=j.extra}j.was=j.length,j.mode=23;case 23:for(;he=(Ie=j.distcode[G&(1<<j.distbits)-1])>>>16&255,Ne=65535&Ie,!((le=Ie>>>24)<=ae);){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(!(240&he)){for(we=le,ue=he,Se=Ne;he=(Ie=j.distcode[Se+((G&(1<<we+ue)-1)>>we)])>>>16&255,Ne=65535&Ie,!(we+(le=Ie>>>24)<=ae);){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}G>>>=we,ae-=we,j.back+=we}if(G>>>=le,ae-=le,j.back+=le,64&he){S.msg="invalid distance code",j.mode=30;break}j.offset=Ne,j.extra=15&he,j.mode=24;case 24:if(j.extra){for(je=j.extra;ae<je;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}j.offset+=G&(1<<j.extra)-1,G>>>=j.extra,ae-=j.extra,j.back+=j.extra}if(j.offset>j.dmax){S.msg="invalid distance too far back",j.mode=30;break}j.mode=25;case 25:if(re===0)break e;if(Q=H-re,j.offset>Q){if((Q=j.offset-Q)>j.whave&&j.sane){S.msg="invalid distance too far back",j.mode=30;break}oe=Q>j.wnext?(Q-=j.wnext,j.wsize-Q):j.wnext-Q,Q>j.length&&(Q=j.length),se=j.window}else se=L,oe=Z-j.offset,Q=j.length;for(re<Q&&(Q=re),re-=Q,j.length-=Q;L[Z++]=se[oe++],--Q;);j.length===0&&(j.mode=21);break;case 26:if(re===0)break e;L[Z++]=j.length,re--,j.mode=21;break;case 27:if(j.wrap){for(;ae<32;){if(K===0)break e;K--,G|=A[I++]<<ae,ae+=8}if(H-=re,S.total_out+=H,j.total+=H,H&&(S.adler=j.check=j.flags?_(j.check,L,H,Z-H):v(j.check,L,H,Z-H)),H=re,(j.flags?G:F(G))!==j.check){S.msg="incorrect data check",j.mode=30;break}ae=G=0}j.mode=28;case 28:if(j.wrap&&j.flags){for(;ae<32;){if(K===0)break e;K--,G+=A[I++]<<ae,ae+=8}if(G!==(4294967295&j.total)){S.msg="incorrect length check",j.mode=30;break}ae=G=0}j.mode=29;case 29:Me=1;break e;case 30:Me=-3;break e;case 31:return-4;case 32:default:return O}return S.next_out=Z,S.avail_out=re,S.next_in=I,S.avail_in=K,j.hold=G,j.bits=ae,(j.wsize||H!==S.avail_out&&j.mode<30&&(j.mode<27||w!==4))&&C(S,S.output,S.next_out,H-S.avail_out)?(j.mode=31,-4):(V-=S.avail_in,H-=S.avail_out,S.total_in+=V,S.total_out+=H,j.total+=H,j.wrap&&H&&(S.adler=j.check=j.flags?_(j.check,L,H,S.next_out-H):v(j.check,L,H,S.next_out-H)),S.data_type=j.bits+(j.last?64:0)+(j.mode===12?128:0)+(j.mode===20||j.mode===15?256:0),(V==0&&H===0||w===4)&&Me===0&&(Me=-5),Me)},x.inflateEnd=function(S){if(!S||!S.state)return O;var w=S.state;return w.window&&(w.window=null),S.state=null,0},x.inflateGetHeader=function(S,w){var j;return S&&S.state&&2&(j=S.state).wrap?((j.head=w).done=!1,0):O},x.inflateSetDictionary=function(S,w){var j,A=w.length;return S&&S.state?(j=S.state).wrap!==0&&j.mode!==11?O:j.mode===11&&v(1,w,A,0)!==j.check?-3:C(S,w,A,A)?(j.mode=31,-4):(j.havedict=1,0):O},x.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,f,x){var b=h("../utils/common"),v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],_=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],E=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];f.exports=function(O,F,z,P,U,W,Y,q){var M,D,T,C,S,w,j,A,L,I=q.bits,Z=0,K=0,re=0,G=0,ae=0,V=0,H=0,Q=0,oe=0,se=0,le=null,he=0,Ne=new b.Buf16(16),we=new b.Buf16(16),ue=null,Se=0;for(Z=0;Z<=15;Z++)Ne[Z]=0;for(K=0;K<P;K++)Ne[F[z+K]]++;for(ae=I,G=15;1<=G&&Ne[G]===0;G--);if(G<ae&&(ae=G),G===0)return U[W++]=20971520,U[W++]=20971520,q.bits=1,0;for(re=1;re<G&&Ne[re]===0;re++);for(ae<re&&(ae=re),Z=Q=1;Z<=15;Z++)if(Q<<=1,(Q-=Ne[Z])<0)return-1;if(0<Q&&(O===0||G!==1))return-1;for(we[1]=0,Z=1;Z<15;Z++)we[Z+1]=we[Z]+Ne[Z];for(K=0;K<P;K++)F[z+K]!==0&&(Y[we[F[z+K]]++]=K);if(w=O===0?(le=ue=Y,19):O===1?(le=v,he-=257,ue=_,Se-=257,256):(le=N,ue=E,-1),Z=re,S=W,H=K=se=0,T=-1,C=(oe=1<<(V=ae))-1,O===1&&852<oe||O===2&&592<oe)return 1;for(;;){for(j=Z-H,L=Y[K]<w?(A=0,Y[K]):Y[K]>w?(A=ue[Se+Y[K]],le[he+Y[K]]):(A=96,0),M=1<<Z-H,re=D=1<<V;U[S+(se>>H)+(D-=M)]=j<<24|A<<16|L|0,D!==0;);for(M=1<<Z-1;se&M;)M>>=1;if(M!==0?(se&=M-1,se+=M):se=0,K++,--Ne[Z]==0){if(Z===G)break;Z=F[z+Y[K]]}if(ae<Z&&(se&C)!==T){for(H===0&&(H=ae),S+=re,Q=1<<(V=Z-H);V+H<G&&!((Q-=Ne[V+H])<=0);)V++,Q<<=1;if(oe+=1<<V,O===1&&852<oe||O===2&&592<oe)return 1;U[T=se&C]=ae<<24|V<<16|S-W|0}}return se!==0&&(U[S+se]=Z-H<<24|64<<16|0),q.bits=ae,0}},{"../utils/common":41}],51:[function(h,f,x){f.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,f,x){var b=h("../utils/common");function v(ue){for(var Se=ue.length;0<=--Se;)ue[Se]=0}var _=256,N=286,E=30,O=15,F=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=new Array(576);v(W);var Y=new Array(60);v(Y);var q=new Array(512);v(q);var M=new Array(256);v(M);var D=new Array(29);v(D);var T,C,S,w=new Array(E);function j(ue,Se,ke,Me,Oe){this.static_tree=ue,this.extra_bits=Se,this.extra_base=ke,this.elems=Me,this.max_length=Oe,this.has_stree=ue&&ue.length}function A(ue,Se){this.dyn_tree=ue,this.max_code=0,this.stat_desc=Se}function L(ue){return ue<256?q[ue]:q[256+(ue>>>7)]}function I(ue,Se){ue.pending_buf[ue.pending++]=255&Se,ue.pending_buf[ue.pending++]=Se>>>8&255}function Z(ue,Se,ke){ue.bi_valid>16-ke?(ue.bi_buf|=Se<<ue.bi_valid&65535,I(ue,ue.bi_buf),ue.bi_buf=Se>>16-ue.bi_valid,ue.bi_valid+=ke-16):(ue.bi_buf|=Se<<ue.bi_valid&65535,ue.bi_valid+=ke)}function K(ue,Se,ke){Z(ue,ke[2*Se],ke[2*Se+1])}function re(ue,Se){for(var ke=0;ke|=1&ue,ue>>>=1,ke<<=1,0<--Se;);return ke>>>1}function G(ue,Se,ke){var Me,Oe,je=new Array(16),Ie=0;for(Me=1;Me<=O;Me++)je[Me]=Ie=Ie+ke[Me-1]<<1;for(Oe=0;Oe<=Se;Oe++){var Pe=ue[2*Oe+1];Pe!==0&&(ue[2*Oe]=re(je[Pe]++,Pe))}}function ae(ue){var Se;for(Se=0;Se<N;Se++)ue.dyn_ltree[2*Se]=0;for(Se=0;Se<E;Se++)ue.dyn_dtree[2*Se]=0;for(Se=0;Se<19;Se++)ue.bl_tree[2*Se]=0;ue.dyn_ltree[512]=1,ue.opt_len=ue.static_len=0,ue.last_lit=ue.matches=0}function V(ue){8<ue.bi_valid?I(ue,ue.bi_buf):0<ue.bi_valid&&(ue.pending_buf[ue.pending++]=ue.bi_buf),ue.bi_buf=0,ue.bi_valid=0}function H(ue,Se,ke,Me){var Oe=2*Se,je=2*ke;return ue[Oe]<ue[je]||ue[Oe]===ue[je]&&Me[Se]<=Me[ke]}function Q(ue,Se,ke){for(var Me=ue.heap[ke],Oe=ke<<1;Oe<=ue.heap_len&&(Oe<ue.heap_len&&H(Se,ue.heap[Oe+1],ue.heap[Oe],ue.depth)&&Oe++,!H(Se,Me,ue.heap[Oe],ue.depth));)ue.heap[ke]=ue.heap[Oe],ke=Oe,Oe<<=1;ue.heap[ke]=Me}function oe(ue,Se,ke){var Me,Oe,je,Ie,Pe=0;if(ue.last_lit!==0)for(;Me=ue.pending_buf[ue.d_buf+2*Pe]<<8|ue.pending_buf[ue.d_buf+2*Pe+1],Oe=ue.pending_buf[ue.l_buf+Pe],Pe++,Me===0?K(ue,Oe,Se):(K(ue,(je=M[Oe])+_+1,Se),(Ie=F[je])!==0&&Z(ue,Oe-=D[je],Ie),K(ue,je=L(--Me),ke),(Ie=z[je])!==0&&Z(ue,Me-=w[je],Ie)),Pe<ue.last_lit;);K(ue,256,Se)}function se(ue,Se){var ke,Me,Oe,je=Se.dyn_tree,Ie=Se.stat_desc.static_tree,Pe=Se.stat_desc.has_stree,He=Se.stat_desc.elems,ct=-1;for(ue.heap_len=0,ue.heap_max=573,ke=0;ke<He;ke++)je[2*ke]!==0?(ue.heap[++ue.heap_len]=ct=ke,ue.depth[ke]=0):je[2*ke+1]=0;for(;ue.heap_len<2;)je[2*(Oe=ue.heap[++ue.heap_len]=ct<2?++ct:0)]=1,ue.depth[Oe]=0,ue.opt_len--,Pe&&(ue.static_len-=Ie[2*Oe+1]);for(Se.max_code=ct,ke=ue.heap_len>>1;1<=ke;ke--)Q(ue,je,ke);for(Oe=He;ke=ue.heap[1],ue.heap[1]=ue.heap[ue.heap_len--],Q(ue,je,1),Me=ue.heap[1],ue.heap[--ue.heap_max]=ke,ue.heap[--ue.heap_max]=Me,je[2*Oe]=je[2*ke]+je[2*Me],ue.depth[Oe]=(ue.depth[ke]>=ue.depth[Me]?ue.depth[ke]:ue.depth[Me])+1,je[2*ke+1]=je[2*Me+1]=Oe,ue.heap[1]=Oe++,Q(ue,je,1),2<=ue.heap_len;);ue.heap[--ue.heap_max]=ue.heap[1],function(ie,ee){var te,fe,_e,Te,Ae,Fe,st=ee.dyn_tree,it=ee.max_code,lt=ee.stat_desc.static_tree,yt=ee.stat_desc.has_stree,vt=ee.stat_desc.extra_bits,Nt=ee.stat_desc.extra_base,Mt=ee.stat_desc.max_length,Et=0;for(Te=0;Te<=O;Te++)ie.bl_count[Te]=0;for(st[2*ie.heap[ie.heap_max]+1]=0,te=ie.heap_max+1;te<573;te++)Mt<(Te=st[2*st[2*(fe=ie.heap[te])+1]+1]+1)&&(Te=Mt,Et++),st[2*fe+1]=Te,it<fe||(ie.bl_count[Te]++,Ae=0,Nt<=fe&&(Ae=vt[fe-Nt]),Fe=st[2*fe],ie.opt_len+=Fe*(Te+Ae),yt&&(ie.static_len+=Fe*(lt[2*fe+1]+Ae)));if(Et!==0){do{for(Te=Mt-1;ie.bl_count[Te]===0;)Te--;ie.bl_count[Te]--,ie.bl_count[Te+1]+=2,ie.bl_count[Mt]--,Et-=2}while(0<Et);for(Te=Mt;Te!==0;Te--)for(fe=ie.bl_count[Te];fe!==0;)it<(_e=ie.heap[--te])||(st[2*_e+1]!==Te&&(ie.opt_len+=(Te-st[2*_e+1])*st[2*_e],st[2*_e+1]=Te),fe--)}}(ue,Se),G(je,ct,ue.bl_count)}function le(ue,Se,ke){var Me,Oe,je=-1,Ie=Se[1],Pe=0,He=7,ct=4;for(Ie===0&&(He=138,ct=3),Se[2*(ke+1)+1]=65535,Me=0;Me<=ke;Me++)Oe=Ie,Ie=Se[2*(Me+1)+1],++Pe<He&&Oe===Ie||(Pe<ct?ue.bl_tree[2*Oe]+=Pe:Oe!==0?(Oe!==je&&ue.bl_tree[2*Oe]++,ue.bl_tree[32]++):Pe<=10?ue.bl_tree[34]++:ue.bl_tree[36]++,je=Oe,ct=(Pe=0)===Ie?(He=138,3):Oe===Ie?(He=6,3):(He=7,4))}function he(ue,Se,ke){var Me,Oe,je=-1,Ie=Se[1],Pe=0,He=7,ct=4;for(Ie===0&&(He=138,ct=3),Me=0;Me<=ke;Me++)if(Oe=Ie,Ie=Se[2*(Me+1)+1],!(++Pe<He&&Oe===Ie)){if(Pe<ct)for(;K(ue,Oe,ue.bl_tree),--Pe!=0;);else Oe!==0?(Oe!==je&&(K(ue,Oe,ue.bl_tree),Pe--),K(ue,16,ue.bl_tree),Z(ue,Pe-3,2)):Pe<=10?(K(ue,17,ue.bl_tree),Z(ue,Pe-3,3)):(K(ue,18,ue.bl_tree),Z(ue,Pe-11,7));je=Oe,ct=(Pe=0)===Ie?(He=138,3):Oe===Ie?(He=6,3):(He=7,4)}}v(w);var Ne=!1;function we(ue,Se,ke,Me){Z(ue,0+(Me?1:0),3),function(Oe,je,Ie,Pe){V(Oe),I(Oe,Ie),I(Oe,~Ie),b.arraySet(Oe.pending_buf,Oe.window,je,Ie,Oe.pending),Oe.pending+=Ie}(ue,Se,ke)}x._tr_init=function(ue){Ne||(function(){var Se,ke,Me,Oe,je,Ie=new Array(16);for(Oe=Me=0;Oe<28;Oe++)for(D[Oe]=Me,Se=0;Se<1<<F[Oe];Se++)M[Me++]=Oe;for(M[Me-1]=Oe,Oe=je=0;Oe<16;Oe++)for(w[Oe]=je,Se=0;Se<1<<z[Oe];Se++)q[je++]=Oe;for(je>>=7;Oe<E;Oe++)for(w[Oe]=je<<7,Se=0;Se<1<<z[Oe]-7;Se++)q[256+je++]=Oe;for(ke=0;ke<=O;ke++)Ie[ke]=0;for(Se=0;Se<=143;)W[2*Se+1]=8,Se++,Ie[8]++;for(;Se<=255;)W[2*Se+1]=9,Se++,Ie[9]++;for(;Se<=279;)W[2*Se+1]=7,Se++,Ie[7]++;for(;Se<=287;)W[2*Se+1]=8,Se++,Ie[8]++;for(G(W,287,Ie),Se=0;Se<E;Se++)Y[2*Se+1]=5,Y[2*Se]=re(Se,5);T=new j(W,F,257,N,O),C=new j(Y,z,0,E,O),S=new j(new Array(0),P,0,19,7)}(),Ne=!0),ue.l_desc=new A(ue.dyn_ltree,T),ue.d_desc=new A(ue.dyn_dtree,C),ue.bl_desc=new A(ue.bl_tree,S),ue.bi_buf=0,ue.bi_valid=0,ae(ue)},x._tr_stored_block=we,x._tr_flush_block=function(ue,Se,ke,Me){var Oe,je,Ie=0;0<ue.level?(ue.strm.data_type===2&&(ue.strm.data_type=function(Pe){var He,ct=4093624447;for(He=0;He<=31;He++,ct>>>=1)if(1&ct&&Pe.dyn_ltree[2*He]!==0)return 0;if(Pe.dyn_ltree[18]!==0||Pe.dyn_ltree[20]!==0||Pe.dyn_ltree[26]!==0)return 1;for(He=32;He<_;He++)if(Pe.dyn_ltree[2*He]!==0)return 1;return 0}(ue)),se(ue,ue.l_desc),se(ue,ue.d_desc),Ie=function(Pe){var He;for(le(Pe,Pe.dyn_ltree,Pe.l_desc.max_code),le(Pe,Pe.dyn_dtree,Pe.d_desc.max_code),se(Pe,Pe.bl_desc),He=18;3<=He&&Pe.bl_tree[2*U[He]+1]===0;He--);return Pe.opt_len+=3*(He+1)+5+5+4,He}(ue),Oe=ue.opt_len+3+7>>>3,(je=ue.static_len+3+7>>>3)<=Oe&&(Oe=je)):Oe=je=ke+5,ke+4<=Oe&&Se!==-1?we(ue,Se,ke,Me):ue.strategy===4||je===Oe?(Z(ue,2+(Me?1:0),3),oe(ue,W,Y)):(Z(ue,4+(Me?1:0),3),function(Pe,He,ct,ie){var ee;for(Z(Pe,He-257,5),Z(Pe,ct-1,5),Z(Pe,ie-4,4),ee=0;ee<ie;ee++)Z(Pe,Pe.bl_tree[2*U[ee]+1],3);he(Pe,Pe.dyn_ltree,He-1),he(Pe,Pe.dyn_dtree,ct-1)}(ue,ue.l_desc.max_code+1,ue.d_desc.max_code+1,Ie+1),oe(ue,ue.dyn_ltree,ue.dyn_dtree)),ae(ue),Me&&V(ue)},x._tr_tally=function(ue,Se,ke){return ue.pending_buf[ue.d_buf+2*ue.last_lit]=Se>>>8&255,ue.pending_buf[ue.d_buf+2*ue.last_lit+1]=255&Se,ue.pending_buf[ue.l_buf+ue.last_lit]=255&ke,ue.last_lit++,Se===0?ue.dyn_ltree[2*ke]++:(ue.matches++,Se--,ue.dyn_ltree[2*(M[ke]+_+1)]++,ue.dyn_dtree[2*L(Se)]++),ue.last_lit===ue.lit_bufsize-1},x._tr_align=function(ue){Z(ue,2,3),K(ue,256,W),function(Se){Se.bi_valid===16?(I(Se,Se.bi_buf),Se.bi_buf=0,Se.bi_valid=0):8<=Se.bi_valid&&(Se.pending_buf[Se.pending++]=255&Se.bi_buf,Se.bi_buf>>=8,Se.bi_valid-=8)}(ue)}},{"../utils/common":41}],53:[function(h,f,x){f.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,f,x){(function(b){(function(v,_){if(!v.setImmediate){var N,E,O,F,z=1,P={},U=!1,W=v.document,Y=Object.getPrototypeOf&&Object.getPrototypeOf(v);Y=Y&&Y.setTimeout?Y:v,N={}.toString.call(v.process)==="[object process]"?function(T){i.nextTick(function(){M(T)})}:function(){if(v.postMessage&&!v.importScripts){var T=!0,C=v.onmessage;return v.onmessage=function(){T=!1},v.postMessage("","*"),v.onmessage=C,T}}()?(F="setImmediate$"+Math.random()+"$",v.addEventListener?v.addEventListener("message",D,!1):v.attachEvent("onmessage",D),function(T){v.postMessage(F+T,"*")}):v.MessageChannel?((O=new MessageChannel).port1.onmessage=function(T){M(T.data)},function(T){O.port2.postMessage(T)}):W&&"onreadystatechange"in W.createElement("script")?(E=W.documentElement,function(T){var C=W.createElement("script");C.onreadystatechange=function(){M(T),C.onreadystatechange=null,E.removeChild(C),C=null},E.appendChild(C)}):function(T){setTimeout(M,0,T)},Y.setImmediate=function(T){typeof T!="function"&&(T=new Function(""+T));for(var C=new Array(arguments.length-1),S=0;S<C.length;S++)C[S]=arguments[S+1];var w={callback:T,args:C};return P[z]=w,N(z),z++},Y.clearImmediate=q}function q(T){delete P[T]}function M(T){if(U)setTimeout(M,0,T);else{var C=P[T];if(C){U=!0;try{(function(S){var w=S.callback,j=S.args;switch(j.length){case 0:w();break;case 1:w(j[0]);break;case 2:w(j[0],j[1]);break;case 3:w(j[0],j[1],j[2]);break;default:w.apply(void 0,j)}})(C)}finally{q(T),U=!1}}}}function D(T){T.source===v&&typeof T.data=="string"&&T.data.indexOf(F)===0&&M(+T.data.slice(F.length))}})(typeof self>"u"?b===void 0?this:b:self)}).call(this,c!==void 0?c:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(e,a,n){(function(i){(function(){var c=/[\\^$.*+?()[\]{}|]/g,l=RegExp(c.source),u=typeof i=="object"&&i&&i.Object===Object&&i,o=typeof self=="object"&&self&&self.Object===Object&&self,d=u||o||Function("return this")(),g=Object.prototype.toString,p=d.Symbol,h=p?p.prototype:void 0,f=h?h.toString:void 0;function x(b){if(typeof b=="string")return b;if(function(_){return typeof _=="symbol"||function(N){return!!N&&typeof N=="object"}(_)&&g.call(_)=="[object Symbol]"}(b))return f?f.call(b):"";var v=b+"";return v=="0"&&1/b==-1/0?"-0":v}a.exports=function(b){var v;return(b=(v=b)==null?"":x(v))&&l.test(b)?b.replace(c,"\\$&"):b}}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(e,a,n){(function(i){(function(){var c="[object Arguments]",l="[object Map]",u="[object Object]",o="[object Set]",d=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,g=/^\w*$/,p=/^\./,h=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,f=/\\(\\)?/g,x=/^\[object .+?Constructor\]$/,b=/^(?:0|[1-9]\d*)$/,v={};v["[object Float32Array]"]=v["[object Float64Array]"]=v["[object Int8Array]"]=v["[object Int16Array]"]=v["[object Int32Array]"]=v["[object Uint8Array]"]=v["[object Uint8ClampedArray]"]=v["[object Uint16Array]"]=v["[object Uint32Array]"]=!0,v[c]=v["[object Array]"]=v["[object ArrayBuffer]"]=v["[object Boolean]"]=v["[object DataView]"]=v["[object Date]"]=v["[object Error]"]=v["[object Function]"]=v[l]=v["[object Number]"]=v[u]=v["[object RegExp]"]=v[o]=v["[object String]"]=v["[object WeakMap]"]=!1;var _=typeof i=="object"&&i&&i.Object===Object&&i,N=typeof self=="object"&&self&&self.Object===Object&&self,E=_||N||Function("return this")(),O=typeof n=="object"&&n&&!n.nodeType&&n,F=O&&typeof a=="object"&&a&&!a.nodeType&&a,z=F&&F.exports===O&&_.process,P=function(){try{return z&&z.binding("util")}catch{}}(),U=P&&P.isTypedArray;function W(pe,Ce,Ye,tt){for(var gt=-1,ft=pe?pe.length:0;++gt<ft;){var pt=pe[gt];Ce(tt,pt,Ye(pt),pe)}return tt}function Y(pe,Ce){for(var Ye=-1,tt=pe?pe.length:0;++Ye<tt;)if(Ce(pe[Ye],Ye,pe))return!0;return!1}function q(pe){var Ce=!1;if(pe!=null&&typeof pe.toString!="function")try{Ce=!!(pe+"")}catch{}return Ce}function M(pe){var Ce=-1,Ye=Array(pe.size);return pe.forEach(function(tt,gt){Ye[++Ce]=[gt,tt]}),Ye}function D(pe){var Ce=-1,Ye=Array(pe.size);return pe.forEach(function(tt){Ye[++Ce]=tt}),Ye}var T,C,S,w=Array.prototype,j=Function.prototype,A=Object.prototype,L=E["__core-js_shared__"],I=(T=/[^.]+$/.exec(L&&L.keys&&L.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"",Z=j.toString,K=A.hasOwnProperty,re=A.toString,G=RegExp("^"+Z.call(K).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ae=E.Symbol,V=E.Uint8Array,H=A.propertyIsEnumerable,Q=w.splice,oe=(C=Object.keys,S=Object,function(pe){return C(S(pe))}),se=jt(E,"DataView"),le=jt(E,"Map"),he=jt(E,"Promise"),Ne=jt(E,"Set"),we=jt(E,"WeakMap"),ue=jt(Object,"create"),Se=Ve(se),ke=Ve(le),Me=Ve(he),Oe=Ve(Ne),je=Ve(we),Ie=ae?ae.prototype:void 0,Pe=Ie?Ie.valueOf:void 0,He=Ie?Ie.toString:void 0;function ct(pe){var Ce=-1,Ye=pe?pe.length:0;for(this.clear();++Ce<Ye;){var tt=pe[Ce];this.set(tt[0],tt[1])}}function ie(pe){var Ce=-1,Ye=pe?pe.length:0;for(this.clear();++Ce<Ye;){var tt=pe[Ce];this.set(tt[0],tt[1])}}function ee(pe){var Ce=-1,Ye=pe?pe.length:0;for(this.clear();++Ce<Ye;){var tt=pe[Ce];this.set(tt[0],tt[1])}}function te(pe){var Ce=-1,Ye=pe?pe.length:0;for(this.__data__=new ee;++Ce<Ye;)this.add(pe[Ce])}function fe(pe){this.__data__=new ie(pe)}function _e(pe,Ce){var Ye=ye(pe)||ge(pe)?function(pt,Yt){for(var Dt=-1,Ut=Array(pt);++Dt<pt;)Ut[Dt]=Yt(Dt);return Ut}(pe.length,String):[],tt=Ye.length,gt=!!tt;for(var ft in pe)!K.call(pe,ft)||gt&&(ft=="length"||Vt(ft,tt))||Ye.push(ft);return Ye}function Te(pe,Ce){for(var Ye=pe.length;Ye--;)if(me(pe[Ye][0],Ce))return Ye;return-1}function Ae(pe,Ce,Ye,tt){return st(pe,function(gt,ft,pt){Ce(tt,gt,Ye(gt),pt)}),tt}ct.prototype.clear=function(){this.__data__=ue?ue(null):{}},ct.prototype.delete=function(pe){return this.has(pe)&&delete this.__data__[pe]},ct.prototype.get=function(pe){var Ce=this.__data__;if(ue){var Ye=Ce[pe];return Ye==="__lodash_hash_undefined__"?void 0:Ye}return K.call(Ce,pe)?Ce[pe]:void 0},ct.prototype.has=function(pe){var Ce=this.__data__;return ue?Ce[pe]!==void 0:K.call(Ce,pe)},ct.prototype.set=function(pe,Ce){return this.__data__[pe]=ue&&Ce===void 0?"__lodash_hash_undefined__":Ce,this},ie.prototype.clear=function(){this.__data__=[]},ie.prototype.delete=function(pe){var Ce=this.__data__,Ye=Te(Ce,pe);return!(Ye<0)&&(Ye==Ce.length-1?Ce.pop():Q.call(Ce,Ye,1),!0)},ie.prototype.get=function(pe){var Ce=this.__data__,Ye=Te(Ce,pe);return Ye<0?void 0:Ce[Ye][1]},ie.prototype.has=function(pe){return Te(this.__data__,pe)>-1},ie.prototype.set=function(pe,Ce){var Ye=this.__data__,tt=Te(Ye,pe);return tt<0?Ye.push([pe,Ce]):Ye[tt][1]=Ce,this},ee.prototype.clear=function(){this.__data__={hash:new ct,map:new(le||ie),string:new ct}},ee.prototype.delete=function(pe){return ut(this,pe).delete(pe)},ee.prototype.get=function(pe){return ut(this,pe).get(pe)},ee.prototype.has=function(pe){return ut(this,pe).has(pe)},ee.prototype.set=function(pe,Ce){return ut(this,pe).set(pe,Ce),this},te.prototype.add=te.prototype.push=function(pe){return this.__data__.set(pe,"__lodash_hash_undefined__"),this},te.prototype.has=function(pe){return this.__data__.has(pe)},fe.prototype.clear=function(){this.__data__=new ie},fe.prototype.delete=function(pe){return this.__data__.delete(pe)},fe.prototype.get=function(pe){return this.__data__.get(pe)},fe.prototype.has=function(pe){return this.__data__.has(pe)},fe.prototype.set=function(pe,Ce){var Ye=this.__data__;if(Ye instanceof ie){var tt=Ye.__data__;if(!le||tt.length<199)return tt.push([pe,Ce]),this;Ye=this.__data__=new ee(tt)}return Ye.set(pe,Ce),this};var Fe,st=(Fe=function(pe,Ce){return pe&&it(pe,Ce,ht)},function(pe,Ce){if(pe==null)return pe;if(!ve(pe))return Fe(pe,Ce);for(var Ye=pe.length,tt=-1,gt=Object(pe);++tt<Ye&&Ce(gt[tt],tt,gt)!==!1;);return pe}),it=function(pe){return function(Ce,Ye,tt){for(var gt=-1,ft=Object(Ce),pt=tt(Ce),Yt=pt.length;Yt--;){var Dt=pt[++gt];if(Ye(ft[Dt],Dt,ft)===!1)break}return Ce}}();function lt(pe,Ce){for(var Ye=0,tt=(Ce=St(Ce,pe)?[Ce]:_t(Ce)).length;pe!=null&&Ye<tt;)pe=pe[Re(Ce[Ye++])];return Ye&&Ye==tt?pe:void 0}function yt(pe,Ce){return pe!=null&&Ce in Object(pe)}function vt(pe,Ce,Ye,tt,gt){return pe===Ce||(pe==null||Ce==null||!Be(pe)&&!$e(Ce)?pe!=pe&&Ce!=Ce:function(ft,pt,Yt,Dt,Ut,Ot){var Gt=ye(ft),or=ye(pt),Jt="[object Array]",ar="[object Array]";Gt||(Jt=(Jt=Ke(ft))==c?u:Jt),or||(ar=(ar=Ke(pt))==c?u:ar);var Yr=Jt==u&&!q(ft),ws=ar==u&&!q(pt),As=Jt==ar;if(As&&!Yr)return Ot||(Ot=new fe),Gt||nt(ft)?Tt(ft,pt,Yt,Dt,Ut,Ot):function(ur,rr,Ma,aa,oo,Os,Rs){switch(Ma){case"[object DataView]":if(ur.byteLength!=rr.byteLength||ur.byteOffset!=rr.byteOffset)return!1;ur=ur.buffer,rr=rr.buffer;case"[object ArrayBuffer]":return!(ur.byteLength!=rr.byteLength||!aa(new V(ur),new V(rr)));case"[object Boolean]":case"[object Date]":case"[object Number]":return me(+ur,+rr);case"[object Error]":return ur.name==rr.name&&ur.message==rr.message;case"[object RegExp]":case"[object String]":return ur==rr+"";case l:var Nn=M;case o:var wi=2&Os;if(Nn||(Nn=D),ur.size!=rr.size&&!wi)return!1;var lo=Rs.get(ur);if(lo)return lo==rr;Os|=1,Rs.set(ur,rr);var jn=Tt(Nn(ur),Nn(rr),aa,oo,Os,Rs);return Rs.delete(ur),jn;case"[object Symbol]":if(Pe)return Pe.call(ur)==Pe.call(rr)}return!1}(ft,pt,Jt,Yt,Dt,Ut,Ot);if(!(2&Ut)){var wn=Yr&&K.call(ft,"__wrapped__"),rn=ws&&K.call(pt,"__wrapped__");if(wn||rn){var _i=wn?ft.value():ft,ls=rn?pt.value():pt;return Ot||(Ot=new fe),Yt(_i,ls,Dt,Ut,Ot)}}return As?(Ot||(Ot=new fe),function(ur,rr,Ma,aa,oo,Os){var Rs=2&oo,Nn=ht(ur),wi=Nn.length,lo=ht(rr).length;if(wi!=lo&&!Rs)return!1;for(var jn=wi;jn--;){var Sn=Nn[jn];if(!(Rs?Sn in rr:K.call(rr,Sn)))return!1}var md=Os.get(ur);if(md&&Os.get(rr))return md==rr;var qn=!0;Os.set(ur,rr),Os.set(rr,ur);for(var co=Rs;++jn<wi;){Sn=Nn[jn];var Ni=ur[Sn],sn=rr[Sn];if(aa)var Gn=Rs?aa(sn,Ni,Sn,rr,ur,Os):aa(Ni,sn,Sn,ur,rr,Os);if(!(Gn===void 0?Ni===sn||Ma(Ni,sn,aa,oo,Os):Gn)){qn=!1;break}co||(co=Sn=="constructor")}if(qn&&!co){var uo=ur.constructor,ji=rr.constructor;uo==ji||!("constructor"in ur)||!("constructor"in rr)||typeof uo=="function"&&uo instanceof uo&&typeof ji=="function"&&ji instanceof ji||(qn=!1)}return Os.delete(ur),Os.delete(rr),qn}(ft,pt,Yt,Dt,Ut,Ot)):!1}(pe,Ce,vt,Ye,tt,gt))}function Nt(pe){return!(!Be(pe)||function(Ce){return!!I&&I in Ce}(pe))&&(Le(pe)||q(pe)?G:x).test(Ve(pe))}function Mt(pe){return typeof pe=="function"?pe:pe==null?xt:typeof pe=="object"?ye(pe)?function(tt,gt){return St(tt)&&et(gt)?ot(Re(tt),gt):function(ft){var pt=function(Yt,Dt,Ut){var Ot=Yt==null?void 0:lt(Yt,Dt);return Ot===void 0?Ut:Ot}(ft,tt);return pt===void 0&&pt===gt?function(Yt,Dt){return Yt!=null&&function(Ut,Ot,Gt){Ot=St(Ot,Ut)?[Ot]:_t(Ot);for(var or,Jt=-1,ar=Ot.length;++Jt<ar;){var Yr=Re(Ot[Jt]);if(!(or=Ut!=null&&Gt(Ut,Yr)))break;Ut=Ut[Yr]}return or||!!(ar=Ut?Ut.length:0)&&qe(ar)&&Vt(Yr,ar)&&(ye(Ut)||ge(Ut))}(Yt,Dt,yt)}(ft,tt):vt(gt,pt,void 0,3)}}(pe[0],pe[1]):function(tt){var gt=function(ft){for(var pt=ht(ft),Yt=pt.length;Yt--;){var Dt=pt[Yt],Ut=ft[Dt];pt[Yt]=[Dt,Ut,et(Ut)]}return pt}(tt);return gt.length==1&&gt[0][2]?ot(gt[0][0],gt[0][1]):function(ft){return ft===tt||function(pt,Yt,Dt,Ut){var Ot=Dt.length,Gt=Ot;if(pt==null)return!Gt;for(pt=Object(pt);Ot--;){var or=Dt[Ot];if(or[2]?or[1]!==pt[or[0]]:!(or[0]in pt))return!1}for(;++Ot<Gt;){var Jt=(or=Dt[Ot])[0],ar=pt[Jt],Yr=or[1];if(or[2]){if(ar===void 0&&!(Jt in pt))return!1}else{var ws=new fe,As;if(!(As===void 0?vt(Yr,ar,Ut,3,ws):As))return!1}}return!0}(ft,tt,gt)}}(pe):St(Ce=pe)?(Ye=Re(Ce),function(tt){return tt==null?void 0:tt[Ye]}):function(tt){return function(gt){return lt(gt,tt)}}(Ce);var Ce,Ye}function Et(pe){if(Ye=(Ce=pe)&&Ce.constructor,tt=typeof Ye=="function"&&Ye.prototype||A,Ce!==tt)return oe(pe);var Ce,Ye,tt,gt=[];for(var ft in Object(pe))K.call(pe,ft)&&ft!="constructor"&&gt.push(ft);return gt}function _t(pe){return ye(pe)?pe:At(pe)}function Tt(pe,Ce,Ye,tt,gt,ft){var pt=2&gt,Yt=pe.length,Dt=Ce.length;if(Yt!=Dt&&!(pt&&Dt>Yt))return!1;var Ut=ft.get(pe);if(Ut&&ft.get(Ce))return Ut==Ce;var Ot=-1,Gt=!0,or=1&gt?new te:void 0;for(ft.set(pe,Ce),ft.set(Ce,pe);++Ot<Yt;){var Jt=pe[Ot],ar=Ce[Ot];if(tt)var Yr=pt?tt(ar,Jt,Ot,Ce,pe,ft):tt(Jt,ar,Ot,pe,Ce,ft);if(Yr!==void 0){if(Yr)continue;Gt=!1;break}if(or){if(!Y(Ce,function(ws,As){if(!or.has(As)&&(Jt===ws||Ye(Jt,ws,tt,gt,ft)))return or.add(As)})){Gt=!1;break}}else if(Jt!==ar&&!Ye(Jt,ar,tt,gt,ft)){Gt=!1;break}}return ft.delete(pe),ft.delete(Ce),Gt}function ut(pe,Ce){var Ye,tt,gt=pe.__data__;return((tt=typeof(Ye=Ce))=="string"||tt=="number"||tt=="symbol"||tt=="boolean"?Ye!=="__proto__":Ye===null)?gt[typeof Ce=="string"?"string":"hash"]:gt.map}function jt(pe,Ce){var Ye=function(tt,gt){return tt==null?void 0:tt[gt]}(pe,Ce);return Nt(Ye)?Ye:void 0}var Ke=function(pe){return re.call(pe)};function Vt(pe,Ce){return!!(Ce=Ce??9007199254740991)&&(typeof pe=="number"||b.test(pe))&&pe>-1&&pe%1==0&&pe<Ce}function St(pe,Ce){if(ye(pe))return!1;var Ye=typeof pe;return!(Ye!="number"&&Ye!="symbol"&&Ye!="boolean"&&pe!=null&&!ze(pe))||g.test(pe)||!d.test(pe)||Ce!=null&&pe in Object(Ce)}function et(pe){return pe==pe&&!Be(pe)}function ot(pe,Ce){return function(Ye){return Ye!=null&&Ye[pe]===Ce&&(Ce!==void 0||pe in Object(Ye))}}(se&&Ke(new se(new ArrayBuffer(1)))!="[object DataView]"||le&&Ke(new le)!=l||he&&Ke(he.resolve())!="[object Promise]"||Ne&&Ke(new Ne)!=o||we&&Ke(new we)!="[object WeakMap]")&&(Ke=function(pe){var Ce=re.call(pe),Ye=Ce==u?pe.constructor:void 0,tt=Ye?Ve(Ye):void 0;if(tt)switch(tt){case Se:return"[object DataView]";case ke:return l;case Me:return"[object Promise]";case Oe:return o;case je:return"[object WeakMap]"}return Ce});var At=be(function(pe){var Ce;pe=(Ce=pe)==null?"":function(tt){if(typeof tt=="string")return tt;if(ze(tt))return He?He.call(tt):"";var gt=tt+"";return gt=="0"&&1/tt==-1/0?"-0":gt}(Ce);var Ye=[];return p.test(pe)&&Ye.push(""),pe.replace(h,function(tt,gt,ft,pt){Ye.push(ft?pt.replace(f,"$1"):gt||tt)}),Ye});function Re(pe){if(typeof pe=="string"||ze(pe))return pe;var Ce=pe+"";return Ce=="0"&&1/pe==-1/0?"-0":Ce}function Ve(pe){if(pe!=null){try{return Z.call(pe)}catch{}try{return pe+""}catch{}}return""}var Qe,de=(Qe=function(pe,Ce,Ye){K.call(pe,Ye)?pe[Ye].push(Ce):pe[Ye]=[Ce]},function(pe,Ce){var Ye=ye(pe)?W:Ae,tt={};return Ye(pe,Qe,Mt(Ce),tt)});function be(pe,Ce){if(typeof pe!="function"||Ce&&typeof Ce!="function")throw new TypeError("Expected a function");var Ye=function(){var tt=arguments,gt=Ce?Ce.apply(this,tt):tt[0],ft=Ye.cache;if(ft.has(gt))return ft.get(gt);var pt=pe.apply(this,tt);return Ye.cache=ft.set(gt,pt),pt};return Ye.cache=new(be.Cache||ee),Ye}function me(pe,Ce){return pe===Ce||pe!=pe&&Ce!=Ce}function ge(pe){return function(Ce){return $e(Ce)&&ve(Ce)}(pe)&&K.call(pe,"callee")&&(!H.call(pe,"callee")||re.call(pe)==c)}be.Cache=ee;var ye=Array.isArray;function ve(pe){return pe!=null&&qe(pe.length)&&!Le(pe)}function Le(pe){var Ce=Be(pe)?re.call(pe):"";return Ce=="[object Function]"||Ce=="[object GeneratorFunction]"}function qe(pe){return typeof pe=="number"&&pe>-1&&pe%1==0&&pe<=9007199254740991}function Be(pe){var Ce=typeof pe;return!!pe&&(Ce=="object"||Ce=="function")}function $e(pe){return!!pe&&typeof pe=="object"}function ze(pe){return typeof pe=="symbol"||$e(pe)&&re.call(pe)=="[object Symbol]"}var nt=U?function(pe){return function(Ce){return pe(Ce)}}(U):function(pe){return $e(pe)&&qe(pe.length)&&!!v[re.call(pe)]};function ht(pe){return ve(pe)?_e(pe):Et(pe)}function xt(pe){return pe}a.exports=de}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(e,a,n){var i=Object.prototype.toString;a.exports=function(c){return c===!0||c===!1||function(l){return!!l&&typeof l=="object"}(c)&&i.call(c)=="[object Boolean]"}},{}],445:[function(e,a,n){(function(i){(function(){var c="[object Arguments]",l="[object Map]",u="[object Object]",o="[object Set]",d=/^\[object .+?Constructor\]$/,g=/^(?:0|[1-9]\d*)$/,p={};p["[object Float32Array]"]=p["[object Float64Array]"]=p["[object Int8Array]"]=p["[object Int16Array]"]=p["[object Int32Array]"]=p["[object Uint8Array]"]=p["[object Uint8ClampedArray]"]=p["[object Uint16Array]"]=p["[object Uint32Array]"]=!0,p[c]=p["[object Array]"]=p["[object ArrayBuffer]"]=p["[object Boolean]"]=p["[object DataView]"]=p["[object Date]"]=p["[object Error]"]=p["[object Function]"]=p[l]=p["[object Number]"]=p[u]=p["[object RegExp]"]=p[o]=p["[object String]"]=p["[object WeakMap]"]=!1;var h=typeof i=="object"&&i&&i.Object===Object&&i,f=typeof self=="object"&&self&&self.Object===Object&&self,x=h||f||Function("return this")(),b=typeof n=="object"&&n&&!n.nodeType&&n,v=b&&typeof a=="object"&&a&&!a.nodeType&&a,_=v&&v.exports===b,N=_&&h.process,E=function(){try{return N&&N.binding&&N.binding("util")}catch{}}(),O=E&&E.isTypedArray;function F(Re,Ve){for(var Qe=-1,de=Re==null?0:Re.length;++Qe<de;)if(Ve(Re[Qe],Qe,Re))return!0;return!1}function z(Re){var Ve=-1,Qe=Array(Re.size);return Re.forEach(function(de,be){Qe[++Ve]=[be,de]}),Qe}function P(Re){var Ve=-1,Qe=Array(Re.size);return Re.forEach(function(de){Qe[++Ve]=de}),Qe}var U,W,Y,q=Array.prototype,M=Function.prototype,D=Object.prototype,T=x["__core-js_shared__"],C=M.toString,S=D.hasOwnProperty,w=(U=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"",j=D.toString,A=RegExp("^"+C.call(S).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),L=_?x.Buffer:void 0,I=x.Symbol,Z=x.Uint8Array,K=D.propertyIsEnumerable,re=q.splice,G=I?I.toStringTag:void 0,ae=Object.getOwnPropertySymbols,V=L?L.isBuffer:void 0,H=(W=Object.keys,Y=Object,function(Re){return W(Y(Re))}),Q=yt(x,"DataView"),oe=yt(x,"Map"),se=yt(x,"Promise"),le=yt(x,"Set"),he=yt(x,"WeakMap"),Ne=yt(Object,"create"),we=Et(Q),ue=Et(oe),Se=Et(se),ke=Et(le),Me=Et(he),Oe=I?I.prototype:void 0,je=Oe?Oe.valueOf:void 0;function Ie(Re){var Ve=-1,Qe=Re==null?0:Re.length;for(this.clear();++Ve<Qe;){var de=Re[Ve];this.set(de[0],de[1])}}function Pe(Re){var Ve=-1,Qe=Re==null?0:Re.length;for(this.clear();++Ve<Qe;){var de=Re[Ve];this.set(de[0],de[1])}}function He(Re){var Ve=-1,Qe=Re==null?0:Re.length;for(this.clear();++Ve<Qe;){var de=Re[Ve];this.set(de[0],de[1])}}function ct(Re){var Ve=-1,Qe=Re==null?0:Re.length;for(this.__data__=new He;++Ve<Qe;)this.add(Re[Ve])}function ie(Re){var Ve=this.__data__=new Pe(Re);this.size=Ve.size}function ee(Re,Ve){var Qe=ut(Re),de=!Qe&&Tt(Re),be=!Qe&&!de&&jt(Re),me=!Qe&&!de&&!be&&ot(Re),ge=Qe||de||be||me,ye=ge?function(qe,Be){for(var $e=-1,ze=Array(qe);++$e<qe;)ze[$e]=Be($e);return ze}(Re.length,String):[],ve=ye.length;for(var Le in Re)!S.call(Re,Le)||ge&&(Le=="length"||be&&(Le=="offset"||Le=="parent")||me&&(Le=="buffer"||Le=="byteLength"||Le=="byteOffset")||Mt(Le,ve))||ye.push(Le);return ye}function te(Re,Ve){for(var Qe=Re.length;Qe--;)if(_t(Re[Qe][0],Ve))return Qe;return-1}function fe(Re){return Re==null?Re===void 0?"[object Undefined]":"[object Null]":G&&G in Object(Re)?function(Ve){var Qe=S.call(Ve,G),de=Ve[G];try{Ve[G]=void 0;var be=!0}catch{}var me=j.call(Ve);return be&&(Qe?Ve[G]=de:delete Ve[G]),me}(Re):function(Ve){return j.call(Ve)}(Re)}function _e(Re){return et(Re)&&fe(Re)==c}function Te(Re,Ve,Qe,de,be){return Re===Ve||(Re==null||Ve==null||!et(Re)&&!et(Ve)?Re!=Re&&Ve!=Ve:function(me,ge,ye,ve,Le,qe){var Be=ut(me),$e=ut(ge),ze=Be?"[object Array]":Nt(me),nt=$e?"[object Array]":Nt(ge),ht=(ze=ze==c?u:ze)==u,xt=(nt=nt==c?u:nt)==u,pe=ze==nt;if(pe&&jt(me)){if(!jt(ge))return!1;Be=!0,ht=!1}if(pe&&!ht)return qe||(qe=new ie),Be||ot(me)?st(me,ge,ye,ve,Le,qe):function(ft,pt,Yt,Dt,Ut,Ot,Gt){switch(Yt){case"[object DataView]":if(ft.byteLength!=pt.byteLength||ft.byteOffset!=pt.byteOffset)return!1;ft=ft.buffer,pt=pt.buffer;case"[object ArrayBuffer]":return!(ft.byteLength!=pt.byteLength||!Ot(new Z(ft),new Z(pt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _t(+ft,+pt);case"[object Error]":return ft.name==pt.name&&ft.message==pt.message;case"[object RegExp]":case"[object String]":return ft==pt+"";case l:var or=z;case o:var Jt=1&Dt;if(or||(or=P),ft.size!=pt.size&&!Jt)return!1;var ar=Gt.get(ft);if(ar)return ar==pt;Dt|=2,Gt.set(ft,pt);var Yr=st(or(ft),or(pt),Dt,Ut,Ot,Gt);return Gt.delete(ft),Yr;case"[object Symbol]":if(je)return je.call(ft)==je.call(pt)}return!1}(me,ge,ze,ye,ve,Le,qe);if(!(1&ye)){var Ce=ht&&S.call(me,"__wrapped__"),Ye=xt&&S.call(ge,"__wrapped__");if(Ce||Ye){var tt=Ce?me.value():me,gt=Ye?ge.value():ge;return qe||(qe=new ie),Le(tt,gt,ye,ve,qe)}}return pe?(qe||(qe=new ie),function(ft,pt,Yt,Dt,Ut,Ot){var Gt=1&Yt,or=it(ft),Jt=or.length,ar=it(pt).length;if(Jt!=ar&&!Gt)return!1;for(var Yr=Jt;Yr--;){var ws=or[Yr];if(!(Gt?ws in pt:S.call(pt,ws)))return!1}var As=Ot.get(ft);if(As&&Ot.get(pt))return As==pt;var wn=!0;Ot.set(ft,pt),Ot.set(pt,ft);for(var rn=Gt;++Yr<Jt;){ws=or[Yr];var _i=ft[ws],ls=pt[ws];if(Dt)var ur=Gt?Dt(ls,_i,ws,pt,ft,Ot):Dt(_i,ls,ws,ft,pt,Ot);if(!(ur===void 0?_i===ls||Ut(_i,ls,Yt,Dt,Ot):ur)){wn=!1;break}rn||(rn=ws=="constructor")}if(wn&&!rn){var rr=ft.constructor,Ma=pt.constructor;rr==Ma||!("constructor"in ft)||!("constructor"in pt)||typeof rr=="function"&&rr instanceof rr&&typeof Ma=="function"&&Ma instanceof Ma||(wn=!1)}return Ot.delete(ft),Ot.delete(pt),wn}(me,ge,ye,ve,Le,qe)):!1}(Re,Ve,Qe,de,Te,be))}function Ae(Re){return!(!St(Re)||function(Ve){return!!w&&w in Ve}(Re))&&(Ke(Re)?A:d).test(Et(Re))}function Fe(Re){if(Qe=(Ve=Re)&&Ve.constructor,de=typeof Qe=="function"&&Qe.prototype||D,Ve!==de)return H(Re);var Ve,Qe,de,be=[];for(var me in Object(Re))S.call(Re,me)&&me!="constructor"&&be.push(me);return be}function st(Re,Ve,Qe,de,be,me){var ge=1&Qe,ye=Re.length,ve=Ve.length;if(ye!=ve&&!(ge&&ve>ye))return!1;var Le=me.get(Re);if(Le&&me.get(Ve))return Le==Ve;var qe=-1,Be=!0,$e=2&Qe?new ct:void 0;for(me.set(Re,Ve),me.set(Ve,Re);++qe<ye;){var ze=Re[qe],nt=Ve[qe];if(de)var ht=ge?de(nt,ze,qe,Ve,Re,me):de(ze,nt,qe,Re,Ve,me);if(ht!==void 0){if(ht)continue;Be=!1;break}if($e){if(!F(Ve,function(xt,pe){if(Ce=pe,!$e.has(Ce)&&(ze===xt||be(ze,xt,Qe,de,me)))return $e.push(pe);var Ce})){Be=!1;break}}else if(ze!==nt&&!be(ze,nt,Qe,de,me)){Be=!1;break}}return me.delete(Re),me.delete(Ve),Be}function it(Re){return function(Ve,Qe,de){var be=Qe(Ve);return ut(Ve)?be:function(me,ge){for(var ye=-1,ve=ge.length,Le=me.length;++ye<ve;)me[Le+ye]=ge[ye];return me}(be,de(Ve))}(Re,At,vt)}function lt(Re,Ve){var Qe,de,be=Re.__data__;return((de=typeof(Qe=Ve))=="string"||de=="number"||de=="symbol"||de=="boolean"?Qe!=="__proto__":Qe===null)?be[typeof Ve=="string"?"string":"hash"]:be.map}function yt(Re,Ve){var Qe=function(de,be){return de==null?void 0:de[be]}(Re,Ve);return Ae(Qe)?Qe:void 0}Ie.prototype.clear=function(){this.__data__=Ne?Ne(null):{},this.size=0},Ie.prototype.delete=function(Re){var Ve=this.has(Re)&&delete this.__data__[Re];return this.size-=Ve?1:0,Ve},Ie.prototype.get=function(Re){var Ve=this.__data__;if(Ne){var Qe=Ve[Re];return Qe==="__lodash_hash_undefined__"?void 0:Qe}return S.call(Ve,Re)?Ve[Re]:void 0},Ie.prototype.has=function(Re){var Ve=this.__data__;return Ne?Ve[Re]!==void 0:S.call(Ve,Re)},Ie.prototype.set=function(Re,Ve){var Qe=this.__data__;return this.size+=this.has(Re)?0:1,Qe[Re]=Ne&&Ve===void 0?"__lodash_hash_undefined__":Ve,this},Pe.prototype.clear=function(){this.__data__=[],this.size=0},Pe.prototype.delete=function(Re){var Ve=this.__data__,Qe=te(Ve,Re);return!(Qe<0)&&(Qe==Ve.length-1?Ve.pop():re.call(Ve,Qe,1),--this.size,!0)},Pe.prototype.get=function(Re){var Ve=this.__data__,Qe=te(Ve,Re);return Qe<0?void 0:Ve[Qe][1]},Pe.prototype.has=function(Re){return te(this.__data__,Re)>-1},Pe.prototype.set=function(Re,Ve){var Qe=this.__data__,de=te(Qe,Re);return de<0?(++this.size,Qe.push([Re,Ve])):Qe[de][1]=Ve,this},He.prototype.clear=function(){this.size=0,this.__data__={hash:new Ie,map:new(oe||Pe),string:new Ie}},He.prototype.delete=function(Re){var Ve=lt(this,Re).delete(Re);return this.size-=Ve?1:0,Ve},He.prototype.get=function(Re){return lt(this,Re).get(Re)},He.prototype.has=function(Re){return lt(this,Re).has(Re)},He.prototype.set=function(Re,Ve){var Qe=lt(this,Re),de=Qe.size;return Qe.set(Re,Ve),this.size+=Qe.size==de?0:1,this},ct.prototype.add=ct.prototype.push=function(Re){return this.__data__.set(Re,"__lodash_hash_undefined__"),this},ct.prototype.has=function(Re){return this.__data__.has(Re)},ie.prototype.clear=function(){this.__data__=new Pe,this.size=0},ie.prototype.delete=function(Re){var Ve=this.__data__,Qe=Ve.delete(Re);return this.size=Ve.size,Qe},ie.prototype.get=function(Re){return this.__data__.get(Re)},ie.prototype.has=function(Re){return this.__data__.has(Re)},ie.prototype.set=function(Re,Ve){var Qe=this.__data__;if(Qe instanceof Pe){var de=Qe.__data__;if(!oe||de.length<199)return de.push([Re,Ve]),this.size=++Qe.size,this;Qe=this.__data__=new He(de)}return Qe.set(Re,Ve),this.size=Qe.size,this};var vt=ae?function(Re){return Re==null?[]:(Re=Object(Re),function(Ve,Qe){for(var de=-1,be=Ve==null?0:Ve.length,me=0,ge=[];++de<be;){var ye=Ve[de];Qe(ye,de,Ve)&&(ge[me++]=ye)}return ge}(ae(Re),function(Ve){return K.call(Re,Ve)}))}:function(){return[]},Nt=fe;function Mt(Re,Ve){return!!(Ve=Ve??9007199254740991)&&(typeof Re=="number"||g.test(Re))&&Re>-1&&Re%1==0&&Re<Ve}function Et(Re){if(Re!=null){try{return C.call(Re)}catch{}try{return Re+""}catch{}}return""}function _t(Re,Ve){return Re===Ve||Re!=Re&&Ve!=Ve}(Q&&Nt(new Q(new ArrayBuffer(1)))!="[object DataView]"||oe&&Nt(new oe)!=l||se&&Nt(se.resolve())!="[object Promise]"||le&&Nt(new le)!=o||he&&Nt(new he)!="[object WeakMap]")&&(Nt=function(Re){var Ve=fe(Re),Qe=Ve==u?Re.constructor:void 0,de=Qe?Et(Qe):"";if(de)switch(de){case we:return"[object DataView]";case ue:return l;case Se:return"[object Promise]";case ke:return o;case Me:return"[object WeakMap]"}return Ve});var Tt=_e(function(){return arguments}())?_e:function(Re){return et(Re)&&S.call(Re,"callee")&&!K.call(Re,"callee")},ut=Array.isArray,jt=V||function(){return!1};function Ke(Re){if(!St(Re))return!1;var Ve=fe(Re);return Ve=="[object Function]"||Ve=="[object GeneratorFunction]"||Ve=="[object AsyncFunction]"||Ve=="[object Proxy]"}function Vt(Re){return typeof Re=="number"&&Re>-1&&Re%1==0&&Re<=9007199254740991}function St(Re){var Ve=typeof Re;return Re!=null&&(Ve=="object"||Ve=="function")}function et(Re){return Re!=null&&typeof Re=="object"}var ot=O?function(Re){return function(Ve){return Re(Ve)}}(O):function(Re){return et(Re)&&Vt(Re.length)&&!!p[fe(Re)]};function At(Re){return(Ve=Re)!=null&&Vt(Ve.length)&&!Ke(Ve)?ee(Re):Fe(Re);var Ve}a.exports=function(Re,Ve){return Te(Re,Ve)}}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(e,a,n){(function(i){(function(){var c=typeof i=="object"&&i&&i.Object===Object&&i,l=typeof self=="object"&&self&&self.Object===Object&&self,u=c||l||Function("return this")(),o=Object.prototype,d=o.hasOwnProperty,g=o.toString,p=u.Symbol,h=p?p.toStringTag:void 0;function f(x){return x==null?x===void 0?"[object Undefined]":"[object Null]":h&&h in Object(x)?function(b){var v=d.call(b,h),_=b[h];try{b[h]=void 0;var N=!0}catch{}var E=g.call(b);return N&&(v?b[h]=_:delete b[h]),E}(x):function(b){return g.call(b)}(x)}a.exports=function(x){if(!function(v){var _=typeof v;return v!=null&&(_=="object"||_=="function")}(x))return!1;var b=f(x);return b=="[object Function]"||b=="[object GeneratorFunction]"||b=="[object AsyncFunction]"||b=="[object Proxy]"}}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(e,a,n){a.exports=function(i){return i==null}},{}],448:[function(e,a,n){a.exports=function(i){return i===void 0}},{}],449:[function(e,a,n){(function(i){(function(){var c=/^\[object .+?Constructor\]$/,l=typeof i=="object"&&i&&i.Object===Object&&i,u=typeof self=="object"&&self&&self.Object===Object&&self,o=l||u||Function("return this")();function d(I,Z){return!!(I&&I.length)&&function(K,re,G){if(re!=re)return function(H,Q,oe,se){for(var le=H.length,he=oe+-1;++he<le;)if(Q(H[he],he,H))return he;return-1}(K,g,G);for(var ae=G-1,V=K.length;++ae<V;)if(K[ae]===re)return ae;return-1}(I,Z,0)>-1}function g(I){return I!=I}function p(I,Z){return I.has(Z)}function h(I){var Z=-1,K=Array(I.size);return I.forEach(function(re){K[++Z]=re}),K}var f,x=Array.prototype,b=Function.prototype,v=Object.prototype,_=o["__core-js_shared__"],N=(f=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||""))?"Symbol(src)_1."+f:"",E=b.toString,O=v.hasOwnProperty,F=v.toString,z=RegExp("^"+E.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=x.splice,U=A(o,"Map"),W=A(o,"Set"),Y=A(Object,"create");function q(I){var Z=-1,K=I?I.length:0;for(this.clear();++Z<K;){var re=I[Z];this.set(re[0],re[1])}}function M(I){var Z=-1,K=I?I.length:0;for(this.clear();++Z<K;){var re=I[Z];this.set(re[0],re[1])}}function D(I){var Z=-1,K=I?I.length:0;for(this.clear();++Z<K;){var re=I[Z];this.set(re[0],re[1])}}function T(I){var Z=-1,K=I?I.length:0;for(this.__data__=new D;++Z<K;)this.add(I[Z])}function C(I,Z){for(var K,re,G=I.length;G--;)if((K=I[G][0])===(re=Z)||K!=K&&re!=re)return G;return-1}function S(I){return!(!L(I)||(Z=I,N&&N in Z))&&(function(K){var re=L(K)?F.call(K):"";return re=="[object Function]"||re=="[object GeneratorFunction]"}(I)||function(K){var re=!1;if(K!=null&&typeof K.toString!="function")try{re=!!(K+"")}catch{}return re}(I)?z:c).test(function(K){if(K!=null){try{return E.call(K)}catch{}try{return K+""}catch{}}return""}(I));var Z}q.prototype.clear=function(){this.__data__=Y?Y(null):{}},q.prototype.delete=function(I){return this.has(I)&&delete this.__data__[I]},q.prototype.get=function(I){var Z=this.__data__;if(Y){var K=Z[I];return K==="__lodash_hash_undefined__"?void 0:K}return O.call(Z,I)?Z[I]:void 0},q.prototype.has=function(I){var Z=this.__data__;return Y?Z[I]!==void 0:O.call(Z,I)},q.prototype.set=function(I,Z){return this.__data__[I]=Y&&Z===void 0?"__lodash_hash_undefined__":Z,this},M.prototype.clear=function(){this.__data__=[]},M.prototype.delete=function(I){var Z=this.__data__,K=C(Z,I);return!(K<0)&&(K==Z.length-1?Z.pop():P.call(Z,K,1),!0)},M.prototype.get=function(I){var Z=this.__data__,K=C(Z,I);return K<0?void 0:Z[K][1]},M.prototype.has=function(I){return C(this.__data__,I)>-1},M.prototype.set=function(I,Z){var K=this.__data__,re=C(K,I);return re<0?K.push([I,Z]):K[re][1]=Z,this},D.prototype.clear=function(){this.__data__={hash:new q,map:new(U||M),string:new q}},D.prototype.delete=function(I){return j(this,I).delete(I)},D.prototype.get=function(I){return j(this,I).get(I)},D.prototype.has=function(I){return j(this,I).has(I)},D.prototype.set=function(I,Z){return j(this,I).set(I,Z),this},T.prototype.add=T.prototype.push=function(I){return this.__data__.set(I,"__lodash_hash_undefined__"),this},T.prototype.has=function(I){return this.__data__.has(I)};var w=W&&1/h(new W([,-0]))[1]==1/0?function(I){return new W(I)}:function(){};function j(I,Z){var K,re,G=I.__data__;return((re=typeof(K=Z))=="string"||re=="number"||re=="symbol"||re=="boolean"?K!=="__proto__":K===null)?G[typeof Z=="string"?"string":"hash"]:G.map}function A(I,Z){var K=function(re,G){return re==null?void 0:re[G]}(I,Z);return S(K)?K:void 0}function L(I){var Z=typeof I;return!!I&&(Z=="object"||Z=="function")}a.exports=function(I){return I&&I.length?function(Z,K,re){var G=-1,ae=d,V=Z.length,H=!0,Q=[],oe=Q;if(V>=200){var se=w(Z);if(se)return h(se);H=!1,ae=p,oe=new T}else oe=Q;e:for(;++G<V;){var le=Z[G],he=le;if(le=le!==0?le:0,H&&he==he){for(var Ne=oe.length;Ne--;)if(oe[Ne]===he)continue e;Q.push(le)}else ae(oe,he,re)||(oe!==Q&&oe.push(he),Q.push(le))}return Q}(I):[]}}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(e,a,n){var i=e("inherits"),c=e("hash-base"),l=e("safe-buffer").Buffer,u=new Array(16);function o(){c.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function d(x,b){return x<<b|x>>>32-b}function g(x,b,v,_,N,E,O){return d(x+(b&v|~b&_)+N+E|0,O)+b|0}function p(x,b,v,_,N,E,O){return d(x+(b&_|v&~_)+N+E|0,O)+b|0}function h(x,b,v,_,N,E,O){return d(x+(b^v^_)+N+E|0,O)+b|0}function f(x,b,v,_,N,E,O){return d(x+(v^(b|~_))+N+E|0,O)+b|0}i(o,c),o.prototype._update=function(){for(var x=u,b=0;b<16;++b)x[b]=this._block.readInt32LE(4*b);var v=this._a,_=this._b,N=this._c,E=this._d;v=g(v,_,N,E,x[0],3614090360,7),E=g(E,v,_,N,x[1],3905402710,12),N=g(N,E,v,_,x[2],606105819,17),_=g(_,N,E,v,x[3],3250441966,22),v=g(v,_,N,E,x[4],4118548399,7),E=g(E,v,_,N,x[5],1200080426,12),N=g(N,E,v,_,x[6],2821735955,17),_=g(_,N,E,v,x[7],4249261313,22),v=g(v,_,N,E,x[8],1770035416,7),E=g(E,v,_,N,x[9],2336552879,12),N=g(N,E,v,_,x[10],4294925233,17),_=g(_,N,E,v,x[11],2304563134,22),v=g(v,_,N,E,x[12],1804603682,7),E=g(E,v,_,N,x[13],4254626195,12),N=g(N,E,v,_,x[14],2792965006,17),v=p(v,_=g(_,N,E,v,x[15],1236535329,22),N,E,x[1],4129170786,5),E=p(E,v,_,N,x[6],3225465664,9),N=p(N,E,v,_,x[11],643717713,14),_=p(_,N,E,v,x[0],3921069994,20),v=p(v,_,N,E,x[5],3593408605,5),E=p(E,v,_,N,x[10],38016083,9),N=p(N,E,v,_,x[15],3634488961,14),_=p(_,N,E,v,x[4],3889429448,20),v=p(v,_,N,E,x[9],568446438,5),E=p(E,v,_,N,x[14],3275163606,9),N=p(N,E,v,_,x[3],4107603335,14),_=p(_,N,E,v,x[8],1163531501,20),v=p(v,_,N,E,x[13],2850285829,5),E=p(E,v,_,N,x[2],4243563512,9),N=p(N,E,v,_,x[7],1735328473,14),v=h(v,_=p(_,N,E,v,x[12],2368359562,20),N,E,x[5],4294588738,4),E=h(E,v,_,N,x[8],2272392833,11),N=h(N,E,v,_,x[11],1839030562,16),_=h(_,N,E,v,x[14],4259657740,23),v=h(v,_,N,E,x[1],2763975236,4),E=h(E,v,_,N,x[4],1272893353,11),N=h(N,E,v,_,x[7],4139469664,16),_=h(_,N,E,v,x[10],3200236656,23),v=h(v,_,N,E,x[13],681279174,4),E=h(E,v,_,N,x[0],3936430074,11),N=h(N,E,v,_,x[3],3572445317,16),_=h(_,N,E,v,x[6],76029189,23),v=h(v,_,N,E,x[9],3654602809,4),E=h(E,v,_,N,x[12],3873151461,11),N=h(N,E,v,_,x[15],530742520,16),v=f(v,_=h(_,N,E,v,x[2],3299628645,23),N,E,x[0],4096336452,6),E=f(E,v,_,N,x[7],1126891415,10),N=f(N,E,v,_,x[14],2878612391,15),_=f(_,N,E,v,x[5],4237533241,21),v=f(v,_,N,E,x[12],1700485571,6),E=f(E,v,_,N,x[3],2399980690,10),N=f(N,E,v,_,x[10],4293915773,15),_=f(_,N,E,v,x[1],2240044497,21),v=f(v,_,N,E,x[8],1873313359,6),E=f(E,v,_,N,x[15],4264355552,10),N=f(N,E,v,_,x[6],2734768916,15),_=f(_,N,E,v,x[13],1309151649,21),v=f(v,_,N,E,x[4],4149444226,6),E=f(E,v,_,N,x[11],3174756917,10),N=f(N,E,v,_,x[2],718787259,15),_=f(_,N,E,v,x[9],3951481745,21),this._a=this._a+v|0,this._b=this._b+_|0,this._c=this._c+N|0,this._d=this._d+E|0},o.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var x=l.allocUnsafe(16);return x.writeInt32LE(this._a,0),x.writeInt32LE(this._b,4),x.writeInt32LE(this._c,8),x.writeInt32LE(this._d,12),x},a.exports=o},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(e,a,n){var i=e("bn.js"),c=e("brorand");function l(u){this.rand=u||new c.Rand}a.exports=l,l.create=function(u){return new l(u)},l.prototype._randbelow=function(u){var o=u.bitLength(),d=Math.ceil(o/8);do var g=new i(this.rand.generate(d));while(g.cmp(u)>=0);return g},l.prototype._randrange=function(u,o){var d=o.sub(u);return u.add(this._randbelow(d))},l.prototype.test=function(u,o,d){var g=u.bitLength(),p=i.mont(u),h=new i(1).toRed(p);o||(o=Math.max(1,g/48|0));for(var f=u.subn(1),x=0;!f.testn(x);x++);for(var b=u.shrn(x),v=f.toRed(p);o>0;o--){var _=this._randrange(new i(2),f);d&&d(_);var N=_.toRed(p).redPow(b);if(N.cmp(h)!==0&&N.cmp(v)!==0){for(var E=1;E<x;E++){if((N=N.redSqr()).cmp(h)===0)return!1;if(N.cmp(v)===0)break}if(E===x)return!1}}return!0},l.prototype.getDivisor=function(u,o){var d=u.bitLength(),g=i.mont(u),p=new i(1).toRed(g);o||(o=Math.max(1,d/48|0));for(var h=u.subn(1),f=0;!h.testn(f);f++);for(var x=u.shrn(f),b=h.toRed(g);o>0;o--){var v=this._randrange(new i(2),h),_=u.gcd(v);if(_.cmpn(1)!==0)return _;var N=v.toRed(g).redPow(x);if(N.cmp(p)!==0&&N.cmp(b)!==0){for(var E=1;E<f;E++){if((N=N.redSqr()).cmp(p)===0)return N.fromRed().subn(1).gcd(u);if(N.cmp(b)===0)break}if(E===f)return(N=N.redSqr()).fromRed().subn(1).gcd(u)}}return!1}},{"bn.js":452,brorand:187}],452:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],453:[function(e,a,n){function i(c,l){if(!c)throw new Error(l||"Assertion failed")}a.exports=i,i.equal=function(c,l,u){if(c!=l)throw new Error(u||"Assertion failed: "+c+" != "+l)}},{}],454:[function(e,a,n){var i=n;function c(u){return u.length===1?"0"+u:u}function l(u){for(var o="",d=0;d<u.length;d++)o+=c(u[d].toString(16));return o}i.toArray=function(u,o){if(Array.isArray(u))return u.slice();if(!u)return[];var d=[];if(typeof u!="string"){for(var g=0;g<u.length;g++)d[g]=0|u[g];return d}if(o==="hex")for((u=u.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(u="0"+u),g=0;g<u.length;g+=2)d.push(parseInt(u[g]+u[g+1],16));else for(g=0;g<u.length;g++){var p=u.charCodeAt(g),h=p>>8,f=255&p;h?d.push(h,f):d.push(f)}return d},i.zero2=c,i.toHex=l,i.encode=function(u,o){return o==="hex"?l(u):u}},{}],455:[function(e,a,n){a.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,a,n){var i=e("asn1.js");n.certificate=e("./certificate");var c=i.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});n.RSAPrivateKey=c;var l=i.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});n.RSAPublicKey=l;var u=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())});n.PublicKey=u;var o=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),d=i.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(o),this.key("subjectPrivateKey").octstr())});n.PrivateKey=d;var g=i.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});n.EncryptedPrivateKey=g;var p=i.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});n.DSAPrivateKey=p,n.DSAparam=i.define("DSAparam",function(){this.int()});var h=i.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(f),this.key("publicKey").optional().explicit(1).bitstr())});n.ECPrivateKey=h;var f=i.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});n.signature=i.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(e,a,n){var i=e("asn1.js"),c=i.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),l=i.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),u=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),o=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(u),this.key("subjectPublicKey").bitstr())}),d=i.define("RelativeDistinguishedName",function(){this.setof(l)}),g=i.define("RDNSequence",function(){this.seqof(d)}),p=i.define("Name",function(){this.choice({rdnSequence:this.use(g)})}),h=i.define("Validity",function(){this.seq().obj(this.key("notBefore").use(c),this.key("notAfter").use(c))}),f=i.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),x=i.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(u),this.key("issuer").use(p),this.key("validity").use(h),this.key("subject").use(p),this.key("subjectPublicKeyInfo").use(o),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(f).optional())}),b=i.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(x),this.key("signatureAlgorithm").use(u),this.key("signatureValue").bitstr())});a.exports=b},{"asn1.js":170}],458:[function(e,a,n){var i=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,c=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,l=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,u=e("evp_bytestokey"),o=e("browserify-aes"),d=e("safe-buffer").Buffer;a.exports=function(g,p){var h,f=g.toString(),x=f.match(i);if(x){var b="aes"+x[1],v=d.from(x[2],"hex"),_=d.from(x[3].replace(/[\r\n]/g,""),"base64"),N=u(p,v.slice(0,8),parseInt(x[1],10)).key,E=[],O=o.createDecipheriv(b,N,v);E.push(O.update(_)),E.push(O.final()),h=d.concat(E)}else{var F=f.match(l);h=d.from(F[2].replace(/[\r\n]/g,""),"base64")}return{tag:f.match(c)[1],data:h}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(e,a,n){var i=e("./asn1"),c=e("./aesid.json"),l=e("./fixProc"),u=e("browserify-aes"),o=e("pbkdf2"),d=e("safe-buffer").Buffer;function g(p){var h;typeof p!="object"||d.isBuffer(p)||(h=p.passphrase,p=p.key),typeof p=="string"&&(p=d.from(p));var f,x,b=l(p,h),v=b.tag,_=b.data;switch(v){case"CERTIFICATE":x=i.certificate.decode(_,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(x||(x=i.PublicKey.decode(_,"der")),f=x.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(x.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return x.subjectPrivateKey=x.subjectPublicKey,{type:"ec",data:x};case"1.2.840.10040.4.1":return x.algorithm.params.pub_key=i.DSAparam.decode(x.subjectPublicKey.data,"der"),{type:"dsa",data:x.algorithm.params};default:throw new Error("unknown key id "+f)}case"ENCRYPTED PRIVATE KEY":_=function(N,E){var O=N.algorithm.decrypt.kde.kdeparams.salt,F=parseInt(N.algorithm.decrypt.kde.kdeparams.iters.toString(),10),z=c[N.algorithm.decrypt.cipher.algo.join(".")],P=N.algorithm.decrypt.cipher.iv,U=N.subjectPrivateKey,W=parseInt(z.split("-")[1],10)/8,Y=o.pbkdf2Sync(E,O,F,W,"sha1"),q=u.createDecipheriv(z,Y,P),M=[];return M.push(q.update(U)),M.push(q.final()),d.concat(M)}(_=i.EncryptedPrivateKey.decode(_,"der"),h);case"PRIVATE KEY":switch(f=(x=i.PrivateKey.decode(_,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(x.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:x.algorithm.curve,privateKey:i.ECPrivateKey.decode(x.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return x.algorithm.params.priv_key=i.DSAparam.decode(x.subjectPrivateKey,"der"),{type:"dsa",params:x.algorithm.params};default:throw new Error("unknown key id "+f)}case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(_,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(_,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(_,"der")};case"EC PRIVATE KEY":return{curve:(_=i.ECPrivateKey.decode(_,"der")).parameters.value,privateKey:_.privateKey};default:throw new Error("unknown key type "+v)}}a.exports=g,g.signature=i.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(e,a,n){n.pbkdf2=e("./lib/async"),n.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,a,n){(function(i){(function(){var c,l,u=e("safe-buffer").Buffer,o=e("./precondition"),d=e("./default-encoding"),g=e("./sync"),p=e("./to-buffer"),h=i.crypto&&i.crypto.subtle,f={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},x=[];function b(){return l||(l=i.process&&i.process.nextTick?i.process.nextTick:i.queueMicrotask?i.queueMicrotask:i.setImmediate?i.setImmediate:i.setTimeout)}function v(_,N,E,O,F){return h.importKey("raw",_,{name:"PBKDF2"},!1,["deriveBits"]).then(function(z){return h.deriveBits({name:"PBKDF2",salt:N,iterations:E,hash:{name:F}},z,O<<3)}).then(function(z){return u.from(z)})}a.exports=function(_,N,E,O,F,z){typeof F=="function"&&(z=F,F=void 0);var P=f[(F=F||"sha1").toLowerCase()];if(P&&typeof i.Promise=="function"){if(o(E,O),_=p(_,d,"Password"),N=p(N,d,"Salt"),typeof z!="function")throw new Error("No callback provided to pbkdf2");(function(U,W){U.then(function(Y){b()(function(){W(null,Y)})},function(Y){b()(function(){W(Y)})})})(function(U){if(i.process&&!i.process.browser||!h||!h.importKey||!h.deriveBits)return Promise.resolve(!1);if(x[U]!==void 0)return x[U];var W=v(c=c||u.alloc(8),c,10,128,U).then(function(){return!0}).catch(function(){return!1});return x[U]=W,W}(P).then(function(U){return U?v(_,N,E,O,P):g(_,N,E,O,F)}),z)}else b()(function(){var U;try{U=g(_,N,E,O,F)}catch(W){return z(W)}z(null,U)})}}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(e,a,n){(function(i,c){(function(){var l;c.process&&c.process.browser?l="utf-8":c.process&&c.process.version?l=parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":l="utf-8",a.exports=l}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(e,a,n){var i=Math.pow(2,30)-1;a.exports=function(c,l){if(typeof c!="number")throw new TypeError("Iterations not a number");if(c<0)throw new TypeError("Bad iterations");if(typeof l!="number")throw new TypeError("Key length not a number");if(l<0||l>i||l!=l)throw new TypeError("Bad key length")}},{}],464:[function(e,a,n){var i=e("create-hash/md5"),c=e("ripemd160"),l=e("sha.js"),u=e("safe-buffer").Buffer,o=e("./precondition"),d=e("./default-encoding"),g=e("./to-buffer"),p=u.alloc(128),h={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function f(x,b,v){var _=function(P){function U(W){return l(P).update(W).digest()}return P==="rmd160"||P==="ripemd160"?function(W){return new c().update(W).digest()}:P==="md5"?i:U}(x),N=x==="sha512"||x==="sha384"?128:64;b.length>N?b=_(b):b.length<N&&(b=u.concat([b,p],N));for(var E=u.allocUnsafe(N+h[x]),O=u.allocUnsafe(N+h[x]),F=0;F<N;F++)E[F]=54^b[F],O[F]=92^b[F];var z=u.allocUnsafe(N+v+4);E.copy(z,0,0,N),this.ipad1=z,this.ipad2=E,this.opad=O,this.alg=x,this.blocksize=N,this.hash=_,this.size=h[x]}f.prototype.run=function(x,b){return x.copy(b,this.blocksize),this.hash(b).copy(this.opad,this.blocksize),this.hash(this.opad)},a.exports=function(x,b,v,_,N){o(v,_);var E=new f(N=N||"sha1",x=g(x,d,"Password"),(b=g(b,d,"Salt")).length),O=u.allocUnsafe(_),F=u.allocUnsafe(b.length+4);b.copy(F,0,0,b.length);for(var z=0,P=h[N],U=Math.ceil(_/P),W=1;W<=U;W++){F.writeUInt32BE(W,b.length);for(var Y=E.run(F,E.ipad1),q=Y,M=1;M<v;M++){q=E.run(q,E.ipad2);for(var D=0;D<P;D++)Y[D]^=q[D]}Y.copy(O,z),z+=P}return O}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(e,a,n){var i=e("safe-buffer").Buffer;a.exports=function(c,l,u){if(i.isBuffer(c))return c;if(typeof c=="string")return i.from(c,l);if(ArrayBuffer.isView(c))return i.from(c.buffer);throw new TypeError(u+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,a,n){(function(i){(function(){i===void 0||!i.version||i.version.indexOf("v0.")===0||i.version.indexOf("v1.")===0&&i.version.indexOf("v1.8.")!==0?a.exports={nextTick:function(c,l,u,o){if(typeof c!="function")throw new TypeError('"callback" argument must be a function');var d,g,p=arguments.length;switch(p){case 0:case 1:return i.nextTick(c);case 2:return i.nextTick(function(){c.call(null,l)});case 3:return i.nextTick(function(){c.call(null,l,u)});case 4:return i.nextTick(function(){c.call(null,l,u,o)});default:for(d=new Array(p-1),g=0;g<d.length;)d[g++]=arguments[g];return i.nextTick(function(){c.apply(null,d)})}}}:a.exports=i}).call(this)}).call(this,e("_process"))},{_process:467}],467:[function(e,a,n){var i,c,l=a.exports={};function u(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function d(N){if(i===setTimeout)return setTimeout(N,0);if((i===u||!i)&&setTimeout)return i=setTimeout,setTimeout(N,0);try{return i(N,0)}catch{try{return i.call(null,N,0)}catch{return i.call(this,N,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:u}catch{i=u}try{c=typeof clearTimeout=="function"?clearTimeout:o}catch{c=o}})();var g,p=[],h=!1,f=-1;function x(){h&&g&&(h=!1,g.length?p=g.concat(p):f=-1,p.length&&b())}function b(){if(!h){var N=d(x);h=!0;for(var E=p.length;E;){for(g=p,p=[];++f<E;)g&&g[f].run();f=-1,E=p.length}g=null,h=!1,function(O){if(c===clearTimeout)return clearTimeout(O);if((c===o||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(O);try{c(O)}catch{try{return c.call(null,O)}catch{return c.call(this,O)}}}(N)}}function v(N,E){this.fun=N,this.array=E}function _(){}l.nextTick=function(N){var E=new Array(arguments.length-1);if(arguments.length>1)for(var O=1;O<arguments.length;O++)E[O-1]=arguments[O];p.push(new v(N,E)),p.length!==1||h||d(b)},v.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=_,l.addListener=_,l.once=_,l.off=_,l.removeListener=_,l.removeAllListeners=_,l.emit=_,l.prependListener=_,l.prependOnceListener=_,l.listeners=function(N){return[]},l.binding=function(N){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(N){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],468:[function(e,a,n){n.publicEncrypt=e("./publicEncrypt"),n.privateDecrypt=e("./privateDecrypt"),n.privateEncrypt=function(i,c){return n.publicEncrypt(i,c,!0)},n.publicDecrypt=function(i,c){return n.privateDecrypt(i,c,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,a,n){var i=e("create-hash"),c=e("safe-buffer").Buffer;function l(u){var o=c.allocUnsafe(4);return o.writeUInt32BE(u,0),o}a.exports=function(u,o){for(var d,g=c.alloc(0),p=0;g.length<o;)d=l(p++),g=c.concat([g,i("sha1").update(u).update(d).digest()]);return g.slice(0,o)}},{"create-hash":386,"safe-buffer":494}],470:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],471:[function(e,a,n){var i=e("parse-asn1"),c=e("./mgf"),l=e("./xor"),u=e("bn.js"),o=e("browserify-rsa"),d=e("create-hash"),g=e("./withPublic"),p=e("safe-buffer").Buffer;a.exports=function(h,f,x){var b;b=h.padding?h.padding:x?1:4;var v,_=i(h),N=_.modulus.byteLength();if(f.length>N||new u(f).cmp(_.modulus)>=0)throw new Error("decryption error");v=x?g(new u(f),_):o(f,_);var E=p.alloc(N-v.length);if(v=p.concat([E,v],N),b===4)return function(O,F){var z=O.modulus.byteLength(),P=d("sha1").update(p.alloc(0)).digest(),U=P.length;if(F[0]!==0)throw new Error("decryption error");var W=F.slice(1,U+1),Y=F.slice(U+1),q=l(W,c(Y,U)),M=l(Y,c(q,z-U-1));if(function(T,C){T=p.from(T),C=p.from(C);var S=0,w=T.length;T.length!==C.length&&(S++,w=Math.min(T.length,C.length));for(var j=-1;++j<w;)S+=T[j]^C[j];return S}(P,M.slice(0,U)))throw new Error("decryption error");for(var D=U;M[D]===0;)D++;if(M[D++]!==1)throw new Error("decryption error");return M.slice(D)}(_,v);if(b===1)return function(O,F,z){for(var P=F.slice(0,2),U=2,W=0;F[U++]!==0;)if(U>=F.length){W++;break}var Y=F.slice(2,U-1);if((P.toString("hex")!=="0002"&&!z||P.toString("hex")!=="0001"&&z)&&W++,Y.length<8&&W++,W)throw new Error("decryption error");return F.slice(U)}(0,v,x);if(b===3)return v;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(e,a,n){var i=e("parse-asn1"),c=e("randombytes"),l=e("create-hash"),u=e("./mgf"),o=e("./xor"),d=e("bn.js"),g=e("./withPublic"),p=e("browserify-rsa"),h=e("safe-buffer").Buffer;a.exports=function(f,x,b){var v;v=f.padding?f.padding:b?1:4;var _,N=i(f);if(v===4)_=function(E,O){var F=E.modulus.byteLength(),z=O.length,P=l("sha1").update(h.alloc(0)).digest(),U=P.length,W=2*U;if(z>F-W-2)throw new Error("message too long");var Y=h.alloc(F-z-W-2),q=F-U-1,M=c(U),D=o(h.concat([P,Y,h.alloc(1,1),O],q),u(M,q)),T=o(M,u(D,U));return new d(h.concat([h.alloc(1),T,D],F))}(N,x);else if(v===1)_=function(E,O,F){var z,P=O.length,U=E.modulus.byteLength();if(P>U-11)throw new Error("message too long");return z=F?h.alloc(U-P-3,255):function(W){for(var Y,q=h.allocUnsafe(W),M=0,D=c(2*W),T=0;M<W;)T===D.length&&(D=c(2*W),T=0),(Y=D[T++])&&(q[M++]=Y);return q}(U-P-3),new d(h.concat([h.from([0,F?1:2]),z,h.alloc(1),O],U))}(N,x,b);else{if(v!==3)throw new Error("unknown padding");if((_=new d(x)).cmp(N.modulus)>=0)throw new Error("data too long for modulus")}return b?p(_,N):g(_,N)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,a,n){var i=e("bn.js"),c=e("safe-buffer").Buffer;a.exports=function(l,u){return c.from(l.toRed(i.mont(u.modulus)).redPow(new i(u.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,a,n){a.exports=function(i,c){for(var l=i.length,u=-1;++u<l;)i[u]^=c[u];return i}},{}],475:[function(e,a,n){(function(i,c){(function(){var l=e("safe-buffer").Buffer,u=c.crypto||c.msCrypto;u&&u.getRandomValues?a.exports=function(o,d){if(o>4294967295)throw new RangeError("requested too many random bytes");var g=l.allocUnsafe(o);if(o>0)if(o>65536)for(var p=0;p<o;p+=65536)u.getRandomValues(g.slice(p,p+65536));else u.getRandomValues(g);return typeof d=="function"?i.nextTick(function(){d(null,g)}):g}:a.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,a,n){(function(i,c){(function(){function l(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var u=e("safe-buffer"),o=e("randombytes"),d=u.Buffer,g=u.kMaxLength,p=c.crypto||c.msCrypto,h=Math.pow(2,32)-1;function f(v,_){if(typeof v!="number"||v!=v)throw new TypeError("offset must be a number");if(v>h||v<0)throw new TypeError("offset must be a uint32");if(v>g||v>_)throw new RangeError("offset out of range")}function x(v,_,N){if(typeof v!="number"||v!=v)throw new TypeError("size must be a number");if(v>h||v<0)throw new TypeError("size must be a uint32");if(v+_>N||v>g)throw new RangeError("buffer too small")}function b(v,_,N,E){if(i.browser){var O=v.buffer,F=new Uint8Array(O,_,N);return p.getRandomValues(F),E?void i.nextTick(function(){E(null,v)}):v}if(!E)return o(N).copy(v,_),v;o(N,function(z,P){if(z)return E(z);P.copy(v,_),E(null,v)})}p&&p.getRandomValues||!i.browser?(n.randomFill=function(v,_,N,E){if(!(d.isBuffer(v)||v instanceof c.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof _=="function")E=_,_=0,N=v.length;else if(typeof N=="function")E=N,N=v.length-_;else if(typeof E!="function")throw new TypeError('"cb" argument must be a function');return f(_,v.length),x(N,_,v.length),b(v,_,N,E)},n.randomFillSync=function(v,_,N){if(_===void 0&&(_=0),!(d.isBuffer(v)||v instanceof c.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return f(_,v.length),N===void 0&&(N=v.length-_),x(N,_,v.length),b(v,_,N)}):(n.randomFill=l,n.randomFillSync=l)}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,a,n){var i={};function c(u,o,d){d||(d=Error);var g=function(p){var h,f;function x(b,v,_){return p.call(this,function(N,E,O){return typeof o=="string"?o:o(N,E,O)}(b,v,_))||this}return f=p,(h=x).prototype=Object.create(f.prototype),h.prototype.constructor=h,h.__proto__=f,x}(d);g.prototype.name=d.name,g.prototype.code=u,i[u]=g}function l(u,o){if(Array.isArray(u)){var d=u.length;return u=u.map(function(g){return String(g)}),d>2?"one of ".concat(o," ").concat(u.slice(0,d-1).join(", "),", or ")+u[d-1]:d===2?"one of ".concat(o," ").concat(u[0]," or ").concat(u[1]):"of ".concat(o," ").concat(u[0])}return"of ".concat(o," ").concat(String(u))}c("ERR_INVALID_OPT_VALUE",function(u,o){return'The value "'+o+'" is invalid for option "'+u+'"'},TypeError),c("ERR_INVALID_ARG_TYPE",function(u,o,d){var g,p,h;if(typeof o=="string"&&(p="not ",o.substr(0,p.length)===p)?(g="must not be",o=o.replace(/^not /,"")):g="must be",function(x,b,v){return(v===void 0||v>x.length)&&(v=x.length),x.substring(v-b.length,v)===b}(u," argument"))h="The ".concat(u," ").concat(g," ").concat(l(o,"type"));else{var f=function(x,b,v){return typeof v!="number"&&(v=0),!(v+b.length>x.length)&&x.indexOf(b,v)!==-1}(u,".")?"property":"argument";h='The "'.concat(u,'" ').concat(f," ").concat(g," ").concat(l(o,"type"))}return h+=". Received type ".concat(typeof d)},TypeError),c("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),c("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),c("ERR_STREAM_PREMATURE_CLOSE","Premature close"),c("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),c("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),c("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),c("ERR_STREAM_WRITE_AFTER_END","write after end"),c("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),c("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),c("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.codes=i},{}],478:[function(e,a,n){(function(i){(function(){var c=Object.keys||function(x){var b=[];for(var v in x)b.push(v);return b};a.exports=p;var l=e("./_stream_readable"),u=e("./_stream_writable");e("inherits")(p,l);for(var o=c(u.prototype),d=0;d<o.length;d++){var g=o[d];p.prototype[g]||(p.prototype[g]=u.prototype[g])}function p(x){if(!(this instanceof p))return new p(x);l.call(this,x),u.call(this,x),this.allowHalfOpen=!0,x&&(x.readable===!1&&(this.readable=!1),x.writable===!1&&(this.writable=!1),x.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||i.nextTick(f,this)}function f(x){x.end()}Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(p.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(p.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(x){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=x,this._writableState.destroyed=x)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(e,a,n){a.exports=c;var i=e("./_stream_transform");function c(l){if(!(this instanceof c))return new c(l);i.call(this,l)}e("inherits")(c,i),c.prototype._transform=function(l,u,o){o(null,l)}},{"./_stream_transform":481,inherits:440}],480:[function(e,a,n){(function(i,c){(function(){var l;a.exports=q,q.ReadableState=Y,e("events").EventEmitter;var u=function(V,H){return V.listeners(H).length},o=e("./internal/streams/stream"),d=e("buffer").Buffer,g=(c!==void 0?c:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},p,h=e("util");p=h&&h.debuglog?h.debuglog("stream"):function(){};var f,x,b,v=e("./internal/streams/buffer_list"),_=e("./internal/streams/destroy"),N=e("./internal/streams/state").getHighWaterMark,E=e("../errors").codes,O=E.ERR_INVALID_ARG_TYPE,F=E.ERR_STREAM_PUSH_AFTER_EOF,z=E.ERR_METHOD_NOT_IMPLEMENTED,P=E.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(q,o);var U=_.errorOrDestroy,W=["error","close","destroy","pause","resume"];function Y(V,H,Q){l=l||e("./_stream_duplex"),V=V||{},typeof Q!="boolean"&&(Q=H instanceof l),this.objectMode=!!V.objectMode,Q&&(this.objectMode=this.objectMode||!!V.readableObjectMode),this.highWaterMark=N(this,V,"readableHighWaterMark",Q),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.destroyed=!1,this.defaultEncoding=V.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,V.encoding&&(f||(f=e("string_decoder/").StringDecoder),this.decoder=new f(V.encoding),this.encoding=V.encoding)}function q(V){if(l=l||e("./_stream_duplex"),!(this instanceof q))return new q(V);var H=this instanceof l;this._readableState=new Y(V,this,H),this.readable=!0,V&&(typeof V.read=="function"&&(this._read=V.read),typeof V.destroy=="function"&&(this._destroy=V.destroy)),o.call(this)}function M(V,H,Q,oe,se){p("readableAddChunk",H);var le,he=V._readableState;if(H===null)he.reading=!1,function(Ne,we){if(p("onEofChunk"),!we.ended){if(we.decoder){var ue=we.decoder.end();ue&&ue.length&&(we.buffer.push(ue),we.length+=we.objectMode?1:ue.length)}we.ended=!0,we.sync?C(Ne):(we.needReadable=!1,we.emittedReadable||(we.emittedReadable=!0,S(Ne)))}}(V,he);else if(se||(le=function(Ne,we){var ue;Se=we,d.isBuffer(Se)||Se instanceof g||typeof we=="string"||we===void 0||Ne.objectMode||(ue=new O("chunk",["string","Buffer","Uint8Array"],we));var Se;return ue}(he,H)),le)U(V,le);else if(he.objectMode||H&&H.length>0)if(typeof H=="string"||he.objectMode||Object.getPrototypeOf(H)===d.prototype||(H=function(Ne){return d.from(Ne)}(H)),oe)he.endEmitted?U(V,new P):D(V,he,H,!0);else if(he.ended)U(V,new F);else{if(he.destroyed)return!1;he.reading=!1,he.decoder&&!Q?(H=he.decoder.write(H),he.objectMode||H.length!==0?D(V,he,H,!1):w(V,he)):D(V,he,H,!1)}else oe||(he.reading=!1,w(V,he));return!he.ended&&(he.length<he.highWaterMark||he.length===0)}function D(V,H,Q,oe){H.flowing&&H.length===0&&!H.sync?(H.awaitDrain=0,V.emit("data",Q)):(H.length+=H.objectMode?1:Q.length,oe?H.buffer.unshift(Q):H.buffer.push(Q),H.needReadable&&C(V)),w(V,H)}Object.defineProperty(q.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(V){this._readableState&&(this._readableState.destroyed=V)}}),q.prototype.destroy=_.destroy,q.prototype._undestroy=_.undestroy,q.prototype._destroy=function(V,H){H(V)},q.prototype.push=function(V,H){var Q,oe=this._readableState;return oe.objectMode?Q=!0:typeof V=="string"&&((H=H||oe.defaultEncoding)!==oe.encoding&&(V=d.from(V,H),H=""),Q=!0),M(this,V,H,!1,Q)},q.prototype.unshift=function(V){return M(this,V,null,!0,!1)},q.prototype.isPaused=function(){return this._readableState.flowing===!1},q.prototype.setEncoding=function(V){f||(f=e("string_decoder/").StringDecoder);var H=new f(V);this._readableState.decoder=H,this._readableState.encoding=this._readableState.decoder.encoding;for(var Q=this._readableState.buffer.head,oe="";Q!==null;)oe+=H.write(Q.data),Q=Q.next;return this._readableState.buffer.clear(),oe!==""&&this._readableState.buffer.push(oe),this._readableState.length=oe.length,this};function T(V,H){return V<=0||H.length===0&&H.ended?0:H.objectMode?1:V!=V?H.flowing&&H.length?H.buffer.head.data.length:H.length:(V>H.highWaterMark&&(H.highWaterMark=function(Q){return Q>=1073741824?Q=1073741824:(Q--,Q|=Q>>>1,Q|=Q>>>2,Q|=Q>>>4,Q|=Q>>>8,Q|=Q>>>16,Q++),Q}(V)),V<=H.length?V:H.ended?H.length:(H.needReadable=!0,0))}function C(V){var H=V._readableState;p("emitReadable",H.needReadable,H.emittedReadable),H.needReadable=!1,H.emittedReadable||(p("emitReadable",H.flowing),H.emittedReadable=!0,i.nextTick(S,V))}function S(V){var H=V._readableState;p("emitReadable_",H.destroyed,H.length,H.ended),H.destroyed||!H.length&&!H.ended||(V.emit("readable"),H.emittedReadable=!1),H.needReadable=!H.flowing&&!H.ended&&H.length<=H.highWaterMark,Z(V)}function w(V,H){H.readingMore||(H.readingMore=!0,i.nextTick(j,V,H))}function j(V,H){for(;!H.reading&&!H.ended&&(H.length<H.highWaterMark||H.flowing&&H.length===0);){var Q=H.length;if(p("maybeReadMore read 0"),V.read(0),Q===H.length)break}H.readingMore=!1}function A(V){var H=V._readableState;H.readableListening=V.listenerCount("readable")>0,H.resumeScheduled&&!H.paused?H.flowing=!0:V.listenerCount("data")>0&&V.resume()}function L(V){p("readable nexttick read 0"),V.read(0)}function I(V,H){p("resume",H.reading),H.reading||V.read(0),H.resumeScheduled=!1,V.emit("resume"),Z(V),H.flowing&&!H.reading&&V.read(0)}function Z(V){var H=V._readableState;for(p("flow",H.flowing);H.flowing&&V.read()!==null;);}function K(V,H){return H.length===0?null:(H.objectMode?Q=H.buffer.shift():!V||V>=H.length?(Q=H.decoder?H.buffer.join(""):H.buffer.length===1?H.buffer.first():H.buffer.concat(H.length),H.buffer.clear()):Q=H.buffer.consume(V,H.decoder),Q);var Q}function re(V){var H=V._readableState;p("endReadable",H.endEmitted),H.endEmitted||(H.ended=!0,i.nextTick(G,H,V))}function G(V,H){if(p("endReadableNT",V.endEmitted,V.length),!V.endEmitted&&V.length===0&&(V.endEmitted=!0,H.readable=!1,H.emit("end"),V.autoDestroy)){var Q=H._writableState;(!Q||Q.autoDestroy&&Q.finished)&&H.destroy()}}function ae(V,H){for(var Q=0,oe=V.length;Q<oe;Q++)if(V[Q]===H)return Q;return-1}q.prototype.read=function(V){p("read",V),V=parseInt(V,10);var H=this._readableState,Q=V;if(V!==0&&(H.emittedReadable=!1),V===0&&H.needReadable&&((H.highWaterMark!==0?H.length>=H.highWaterMark:H.length>0)||H.ended))return p("read: emitReadable",H.length,H.ended),H.length===0&&H.ended?re(this):C(this),null;if((V=T(V,H))===0&&H.ended)return H.length===0&&re(this),null;var oe,se=H.needReadable;return p("need readable",se),(H.length===0||H.length-V<H.highWaterMark)&&p("length less than watermark",se=!0),H.ended||H.reading?p("reading or ended",se=!1):se&&(p("do read"),H.reading=!0,H.sync=!0,H.length===0&&(H.needReadable=!0),this._read(H.highWaterMark),H.sync=!1,H.reading||(V=T(Q,H))),(oe=V>0?K(V,H):null)===null?(H.needReadable=H.length<=H.highWaterMark,V=0):(H.length-=V,H.awaitDrain=0),H.length===0&&(H.ended||(H.needReadable=!0),Q!==V&&H.ended&&re(this)),oe!==null&&this.emit("data",oe),oe},q.prototype._read=function(V){U(this,new z("_read()"))},q.prototype.pipe=function(V,H){var Q=this,oe=this._readableState;switch(oe.pipesCount){case 0:oe.pipes=V;break;case 1:oe.pipes=[oe.pipes,V];break;default:oe.pipes.push(V)}oe.pipesCount+=1,p("pipe count=%d opts=%j",oe.pipesCount,H);var se=(!H||H.end!==!1)&&V!==i.stdout&&V!==i.stderr?he:Oe;function le(je,Ie){p("onunpipe"),je===Q&&Ie&&Ie.hasUnpiped===!1&&(Ie.hasUnpiped=!0,p("cleanup"),V.removeListener("close",ke),V.removeListener("finish",Me),V.removeListener("drain",Ne),V.removeListener("error",Se),V.removeListener("unpipe",le),Q.removeListener("end",he),Q.removeListener("end",Oe),Q.removeListener("data",ue),we=!0,!oe.awaitDrain||V._writableState&&!V._writableState.needDrain||Ne())}function he(){p("onend"),V.end()}oe.endEmitted?i.nextTick(se):Q.once("end",se),V.on("unpipe",le);var Ne=function(je){return function(){var Ie=je._readableState;p("pipeOnDrain",Ie.awaitDrain),Ie.awaitDrain&&Ie.awaitDrain--,Ie.awaitDrain===0&&u(je,"data")&&(Ie.flowing=!0,Z(je))}}(Q);V.on("drain",Ne);var we=!1;function ue(je){p("ondata");var Ie=V.write(je);p("dest.write",Ie),Ie===!1&&((oe.pipesCount===1&&oe.pipes===V||oe.pipesCount>1&&ae(oe.pipes,V)!==-1)&&!we&&(p("false write response, pause",oe.awaitDrain),oe.awaitDrain++),Q.pause())}function Se(je){p("onerror",je),Oe(),V.removeListener("error",Se),u(V,"error")===0&&U(V,je)}function ke(){V.removeListener("finish",Me),Oe()}function Me(){p("onfinish"),V.removeListener("close",ke),Oe()}function Oe(){p("unpipe"),Q.unpipe(V)}return Q.on("data",ue),function(je,Ie,Pe){if(typeof je.prependListener=="function")return je.prependListener(Ie,Pe);je._events&&je._events[Ie]?Array.isArray(je._events[Ie])?je._events[Ie].unshift(Pe):je._events[Ie]=[Pe,je._events[Ie]]:je.on(Ie,Pe)}(V,"error",Se),V.once("close",ke),V.once("finish",Me),V.emit("pipe",Q),oe.flowing||(p("pipe resume"),Q.resume()),V},q.prototype.unpipe=function(V){var H=this._readableState,Q={hasUnpiped:!1};if(H.pipesCount===0)return this;if(H.pipesCount===1)return V&&V!==H.pipes||(V||(V=H.pipes),H.pipes=null,H.pipesCount=0,H.flowing=!1,V&&V.emit("unpipe",this,Q)),this;if(!V){var oe=H.pipes,se=H.pipesCount;H.pipes=null,H.pipesCount=0,H.flowing=!1;for(var le=0;le<se;le++)oe[le].emit("unpipe",this,{hasUnpiped:!1});return this}var he=ae(H.pipes,V);return he===-1||(H.pipes.splice(he,1),H.pipesCount-=1,H.pipesCount===1&&(H.pipes=H.pipes[0]),V.emit("unpipe",this,Q)),this},q.prototype.on=function(V,H){var Q=o.prototype.on.call(this,V,H),oe=this._readableState;return V==="data"?(oe.readableListening=this.listenerCount("readable")>0,oe.flowing!==!1&&this.resume()):V==="readable"&&(oe.endEmitted||oe.readableListening||(oe.readableListening=oe.needReadable=!0,oe.flowing=!1,oe.emittedReadable=!1,p("on readable",oe.length,oe.reading),oe.length?C(this):oe.reading||i.nextTick(L,this))),Q},q.prototype.addListener=q.prototype.on,q.prototype.removeListener=function(V,H){var Q=o.prototype.removeListener.call(this,V,H);return V==="readable"&&i.nextTick(A,this),Q},q.prototype.removeAllListeners=function(V){var H=o.prototype.removeAllListeners.apply(this,arguments);return V!=="readable"&&V!==void 0||i.nextTick(A,this),H},q.prototype.resume=function(){var V=this._readableState;return V.flowing||(p("resume"),V.flowing=!V.readableListening,function(H,Q){Q.resumeScheduled||(Q.resumeScheduled=!0,i.nextTick(I,H,Q))}(this,V)),V.paused=!1,this},q.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},q.prototype.wrap=function(V){var H=this,Q=this._readableState,oe=!1;for(var se in V.on("end",function(){if(p("wrapped end"),Q.decoder&&!Q.ended){var he=Q.decoder.end();he&&he.length&&H.push(he)}H.push(null)}),V.on("data",function(he){p("wrapped data"),Q.decoder&&(he=Q.decoder.write(he)),Q.objectMode&&he==null||(Q.objectMode||he&&he.length)&&(H.push(he)||(oe=!0,V.pause()))}),V)this[se]===void 0&&typeof V[se]=="function"&&(this[se]=function(he){return function(){return V[he].apply(V,arguments)}}(se));for(var le=0;le<W.length;le++)V.on(W[le],this.emit.bind(this,W[le]));return this._read=function(he){p("wrapped _read",he),oe&&(oe=!1,V.resume())},this},typeof Symbol=="function"&&(q.prototype[Symbol.asyncIterator]=function(){return x===void 0&&(x=e("./internal/streams/async_iterator")),x(this)}),Object.defineProperty(q.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(q.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(q.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}}),q._fromList=K,Object.defineProperty(q.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(q.from=function(V,H){return b===void 0&&(b=e("./internal/streams/from")),b(q,V,H)})}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(e,a,n){a.exports=p;var i=e("../errors").codes,c=i.ERR_METHOD_NOT_IMPLEMENTED,l=i.ERR_MULTIPLE_CALLBACK,u=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=i.ERR_TRANSFORM_WITH_LENGTH_0,d=e("./_stream_duplex");function g(x,b){var v=this._transformState;v.transforming=!1;var _=v.writecb;if(_===null)return this.emit("error",new l);v.writechunk=null,v.writecb=null,b!=null&&this.push(b),_(x);var N=this._readableState;N.reading=!1,(N.needReadable||N.length<N.highWaterMark)&&this._read(N.highWaterMark)}function p(x){if(!(this instanceof p))return new p(x);d.call(this,x),this._transformState={afterTransform:g.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,x&&(typeof x.transform=="function"&&(this._transform=x.transform),typeof x.flush=="function"&&(this._flush=x.flush)),this.on("prefinish",h)}function h(){var x=this;typeof this._flush!="function"||this._readableState.destroyed?f(this,null,null):this._flush(function(b,v){f(x,b,v)})}function f(x,b,v){if(b)return x.emit("error",b);if(v!=null&&x.push(v),x._writableState.length)throw new o;if(x._transformState.transforming)throw new u;return x.push(null)}e("inherits")(p,d),p.prototype.push=function(x,b){return this._transformState.needTransform=!1,d.prototype.push.call(this,x,b)},p.prototype._transform=function(x,b,v){v(new c("_transform()"))},p.prototype._write=function(x,b,v){var _=this._transformState;if(_.writecb=v,_.writechunk=x,_.writeencoding=b,!_.transforming){var N=this._readableState;(_.needTransform||N.needReadable||N.length<N.highWaterMark)&&this._read(N.highWaterMark)}},p.prototype._read=function(x){var b=this._transformState;b.writechunk===null||b.transforming?b.needTransform=!0:(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform))},p.prototype._destroy=function(x,b){d.prototype._destroy.call(this,x,function(v){b(v)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(e,a,n){(function(i,c){(function(){function l(j){var A=this;this.next=null,this.entry=null,this.finish=function(){(function(L,I,Z){var K=L.entry;for(L.entry=null;K;){var re=K.callback;I.pendingcb--,re(Z),K=K.next}I.corkedRequestsFree.next=L})(A,j)}}var u;a.exports=q,q.WritableState=Y;var o={deprecate:e("util-deprecate")},d=e("./internal/streams/stream"),g=e("buffer").Buffer,p=(c!==void 0?c:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},h,f=e("./internal/streams/destroy"),x=e("./internal/streams/state").getHighWaterMark,b=e("../errors").codes,v=b.ERR_INVALID_ARG_TYPE,_=b.ERR_METHOD_NOT_IMPLEMENTED,N=b.ERR_MULTIPLE_CALLBACK,E=b.ERR_STREAM_CANNOT_PIPE,O=b.ERR_STREAM_DESTROYED,F=b.ERR_STREAM_NULL_VALUES,z=b.ERR_STREAM_WRITE_AFTER_END,P=b.ERR_UNKNOWN_ENCODING,U=f.errorOrDestroy;function W(){}function Y(j,A,L){u=u||e("./_stream_duplex"),j=j||{},typeof L!="boolean"&&(L=A instanceof u),this.objectMode=!!j.objectMode,L&&(this.objectMode=this.objectMode||!!j.writableObjectMode),this.highWaterMark=x(this,j,"writableHighWaterMark",L),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var I=j.decodeStrings===!1;this.decodeStrings=!I,this.defaultEncoding=j.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Z){(function(K,re){var G=K._writableState,ae=G.sync,V=G.writecb;if(typeof V!="function")throw new N;if(function(Q){Q.writing=!1,Q.writecb=null,Q.length-=Q.writelen,Q.writelen=0}(G),re)(function(Q,oe,se,le,he){--oe.pendingcb,se?(i.nextTick(he,le),i.nextTick(w,Q,oe),Q._writableState.errorEmitted=!0,U(Q,le)):(he(le),Q._writableState.errorEmitted=!0,U(Q,le),w(Q,oe))})(K,G,ae,re,V);else{var H=C(G)||K.destroyed;H||G.corked||G.bufferProcessing||!G.bufferedRequest||T(K,G),ae?i.nextTick(D,K,G,H,V):D(K,G,H,V)}})(A,Z)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=j.emitClose!==!1,this.autoDestroy=!!j.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function q(j){var A=this instanceof(u=u||e("./_stream_duplex"));if(!A&&!h.call(q,this))return new q(j);this._writableState=new Y(j,this,A),this.writable=!0,j&&(typeof j.write=="function"&&(this._write=j.write),typeof j.writev=="function"&&(this._writev=j.writev),typeof j.destroy=="function"&&(this._destroy=j.destroy),typeof j.final=="function"&&(this._final=j.final)),d.call(this)}function M(j,A,L,I,Z,K,re){A.writelen=I,A.writecb=re,A.writing=!0,A.sync=!0,A.destroyed?A.onwrite(new O("write")):L?j._writev(Z,A.onwrite):j._write(Z,K,A.onwrite),A.sync=!1}function D(j,A,L,I){L||function(Z,K){K.length===0&&K.needDrain&&(K.needDrain=!1,Z.emit("drain"))}(j,A),A.pendingcb--,I(),w(j,A)}function T(j,A){A.bufferProcessing=!0;var L=A.bufferedRequest;if(j._writev&&L&&L.next){var I=A.bufferedRequestCount,Z=new Array(I),K=A.corkedRequestsFree;K.entry=L;for(var re=0,G=!0;L;)Z[re]=L,L.isBuf||(G=!1),L=L.next,re+=1;Z.allBuffers=G,M(j,A,!0,A.length,Z,"",K.finish),A.pendingcb++,A.lastBufferedRequest=null,K.next?(A.corkedRequestsFree=K.next,K.next=null):A.corkedRequestsFree=new l(A),A.bufferedRequestCount=0}else{for(;L;){var ae=L.chunk,V=L.encoding,H=L.callback;if(M(j,A,!1,A.objectMode?1:ae.length,ae,V,H),L=L.next,A.bufferedRequestCount--,A.writing)break}L===null&&(A.lastBufferedRequest=null)}A.bufferedRequest=L,A.bufferProcessing=!1}function C(j){return j.ending&&j.length===0&&j.bufferedRequest===null&&!j.finished&&!j.writing}function S(j,A){j._final(function(L){A.pendingcb--,L&&U(j,L),A.prefinished=!0,j.emit("prefinish"),w(j,A)})}function w(j,A){var L=C(A);if(L&&(function(Z,K){K.prefinished||K.finalCalled||(typeof Z._final!="function"||K.destroyed?(K.prefinished=!0,Z.emit("prefinish")):(K.pendingcb++,K.finalCalled=!0,i.nextTick(S,Z,K)))}(j,A),A.pendingcb===0&&(A.finished=!0,j.emit("finish"),A.autoDestroy))){var I=j._readableState;(!I||I.autoDestroy&&I.endEmitted)&&j.destroy()}return L}e("inherits")(q,d),Y.prototype.getBuffer=function(){for(var j=this.bufferedRequest,A=[];j;)A.push(j),j=j.next;return A},function(){try{Object.defineProperty(Y.prototype,"buffer",{get:o.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(q,Symbol.hasInstance,{value:function(j){return!!h.call(this,j)||this===q&&j&&j._writableState instanceof Y}})):h=function(j){return j instanceof this},q.prototype.pipe=function(){U(this,new E)},q.prototype.write=function(j,A,L){var I,Z=this._writableState,K=!1,re=!Z.objectMode&&(I=j,g.isBuffer(I)||I instanceof p);return re&&!g.isBuffer(j)&&(j=function(G){return g.from(G)}(j)),typeof A=="function"&&(L=A,A=null),re?A="buffer":A||(A=Z.defaultEncoding),typeof L!="function"&&(L=W),Z.ending?function(G,ae){var V=new z;U(G,V),i.nextTick(ae,V)}(this,L):(re||function(G,ae,V,H){var Q;return V===null?Q=new F:typeof V=="string"||ae.objectMode||(Q=new v("chunk",["string","Buffer"],V)),!Q||(U(G,Q),i.nextTick(H,Q),!1)}(this,Z,j,L))&&(Z.pendingcb++,K=function(G,ae,V,H,Q,oe){if(!V){var se=function(we,ue,Se){return we.objectMode||we.decodeStrings===!1||typeof ue!="string"||(ue=g.from(ue,Se)),ue}(ae,H,Q);H!==se&&(V=!0,Q="buffer",H=se)}var le=ae.objectMode?1:H.length;ae.length+=le;var he=ae.length<ae.highWaterMark;if(he||(ae.needDrain=!0),ae.writing||ae.corked){var Ne=ae.lastBufferedRequest;ae.lastBufferedRequest={chunk:H,encoding:Q,isBuf:V,callback:oe,next:null},Ne?Ne.next=ae.lastBufferedRequest:ae.bufferedRequest=ae.lastBufferedRequest,ae.bufferedRequestCount+=1}else M(G,ae,!1,le,H,Q,oe);return he}(this,Z,re,j,A,L)),K},q.prototype.cork=function(){this._writableState.corked++},q.prototype.uncork=function(){var j=this._writableState;j.corked&&(j.corked--,j.writing||j.corked||j.bufferProcessing||!j.bufferedRequest||T(this,j))},q.prototype.setDefaultEncoding=function(j){if(typeof j=="string"&&(j=j.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((j+"").toLowerCase())>-1))throw new P(j);return this._writableState.defaultEncoding=j,this},Object.defineProperty(q.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(q.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),q.prototype._write=function(j,A,L){L(new _("_write()"))},q.prototype._writev=null,q.prototype.end=function(j,A,L){var I=this._writableState;return typeof j=="function"?(L=j,j=null,A=null):typeof A=="function"&&(L=A,A=null),j!=null&&this.write(j,A),I.corked&&(I.corked=1,this.uncork()),I.ending||function(Z,K,re){K.ending=!0,w(Z,K),re&&(K.finished?i.nextTick(re):Z.once("finish",re)),K.ended=!0,Z.writable=!1}(this,I,L),this},Object.defineProperty(q.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(q.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(j){this._writableState&&(this._writableState.destroyed=j)}}),q.prototype.destroy=f.destroy,q.prototype._undestroy=f.undestroy,q.prototype._destroy=function(j,A){A(j)}}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(e,a,n){(function(i){(function(){var c;function l(O,F,z){return(F=function(P){var U=function(W,Y){if(typeof W!="object"||W===null)return W;var q=W[Symbol.toPrimitive];if(q!==void 0){var M=q.call(W,Y);if(typeof M!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Y==="string"?String:Number)(W)}(P,"string");return typeof U=="symbol"?U:String(U)}(F))in O?Object.defineProperty(O,F,{value:z,enumerable:!0,configurable:!0,writable:!0}):O[F]=z,O}var u=e("./end-of-stream"),o=Symbol("lastResolve"),d=Symbol("lastReject"),g=Symbol("error"),p=Symbol("ended"),h=Symbol("lastPromise"),f=Symbol("handlePromise"),x=Symbol("stream");function b(O,F){return{value:O,done:F}}function v(O){var F=O[o];if(F!==null){var z=O[x].read();z!==null&&(O[h]=null,O[o]=null,O[d]=null,F(b(z,!1)))}}function _(O){i.nextTick(v,O)}var N=Object.getPrototypeOf(function(){}),E=Object.setPrototypeOf((l(c={get stream(){return this[x]},next:function(){var O=this,F=this[g];if(F!==null)return Promise.reject(F);if(this[p])return Promise.resolve(b(void 0,!0));if(this[x].destroyed)return new Promise(function(W,Y){i.nextTick(function(){O[g]?Y(O[g]):W(b(void 0,!0))})});var z,P=this[h];if(P)z=new Promise(function(W,Y){return function(q,M){W.then(function(){Y[p]?q(b(void 0,!0)):Y[f](q,M)},M)}}(P,this));else{var U=this[x].read();if(U!==null)return Promise.resolve(b(U,!1));z=new Promise(this[f])}return this[h]=z,z}},Symbol.asyncIterator,function(){return this}),l(c,"return",function(){var O=this;return new Promise(function(F,z){O[x].destroy(null,function(P){P?z(P):F(b(void 0,!0))})})}),c),N);a.exports=function(O){var F,z=Object.create(E,(l(F={},x,{value:O,writable:!0}),l(F,o,{value:null,writable:!0}),l(F,d,{value:null,writable:!0}),l(F,g,{value:null,writable:!0}),l(F,p,{value:O._readableState.endEmitted,writable:!0}),l(F,f,{value:function(P,U){var W=z[x].read();W?(z[h]=null,z[o]=null,z[d]=null,P(b(W,!1))):(z[o]=P,z[d]=U)},writable:!0}),F));return z[h]=null,u(O,function(P){if(P&&P.code!=="ERR_STREAM_PREMATURE_CLOSE"){var U=z[d];return U!==null&&(z[h]=null,z[o]=null,z[d]=null,U(P)),void(z[g]=P)}var W=z[o];W!==null&&(z[h]=null,z[o]=null,z[d]=null,W(b(void 0,!0))),z[p]=!0}),O.on("readable",_.bind(null,z)),z}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,a,n){function i(h,f){var x=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);f&&(b=b.filter(function(v){return Object.getOwnPropertyDescriptor(h,v).enumerable})),x.push.apply(x,b)}return x}function c(h){for(var f=1;f<arguments.length;f++){var x=arguments[f]!=null?arguments[f]:{};f%2?i(Object(x),!0).forEach(function(b){l(h,b,x[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(x)):i(Object(x)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(x,b))})}return h}function l(h,f,x){return(f=o(f))in h?Object.defineProperty(h,f,{value:x,enumerable:!0,configurable:!0,writable:!0}):h[f]=x,h}function u(h,f){for(var x=0;x<f.length;x++){var b=f[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,o(b.key),b)}}function o(h){var f=function(x,b){if(typeof x!="object"||x===null)return x;var v=x[Symbol.toPrimitive];if(v!==void 0){var _=v.call(x,b);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(b==="string"?String:Number)(x)}(h,"string");return typeof f=="symbol"?f:String(f)}var d=e("buffer").Buffer,g=e("util").inspect,p=g&&g.custom||"inspect";a.exports=function(){function h(){(function(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")})(this,h),this.head=null,this.tail=null,this.length=0}var f,x;return f=h,(x=[{key:"push",value:function(b){var v={data:b,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(b){var v={data:b,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var b=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,b}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(b){if(this.length===0)return"";for(var v=this.head,_=""+v.data;v=v.next;)_+=b+v.data;return _}},{key:"concat",value:function(b){if(this.length===0)return d.alloc(0);for(var v,_,N,E=d.allocUnsafe(b>>>0),O=this.head,F=0;O;)v=O.data,_=E,N=F,d.prototype.copy.call(v,_,N),F+=O.data.length,O=O.next;return E}},{key:"consume",value:function(b,v){var _;return b<this.head.data.length?(_=this.head.data.slice(0,b),this.head.data=this.head.data.slice(b)):_=b===this.head.data.length?this.shift():v?this._getString(b):this._getBuffer(b),_}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(b){var v=this.head,_=1,N=v.data;for(b-=N.length;v=v.next;){var E=v.data,O=b>E.length?E.length:b;if(O===E.length?N+=E:N+=E.slice(0,b),(b-=O)==0){O===E.length?(++_,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=E.slice(O));break}++_}return this.length-=_,N}},{key:"_getBuffer",value:function(b){var v=d.allocUnsafe(b),_=this.head,N=1;for(_.data.copy(v),b-=_.data.length;_=_.next;){var E=_.data,O=b>E.length?E.length:b;if(E.copy(v,v.length-b,0,O),(b-=O)==0){O===E.length?(++N,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=E.slice(O));break}++N}return this.length-=N,v}},{key:p,value:function(b,v){return g(this,c(c({},v),{},{depth:0,customInspect:!1}))}}])&&u(f.prototype,x),Object.defineProperty(f,"prototype",{writable:!1}),h}()},{buffer:220,util:188}],485:[function(e,a,n){(function(i){(function(){function c(o,d){u(o,d),l(o)}function l(o){o._writableState&&!o._writableState.emitClose||o._readableState&&!o._readableState.emitClose||o.emit("close")}function u(o,d){o.emit("error",d)}a.exports={destroy:function(o,d){var g=this,p=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return p||h?(d?d(o):o&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(u,this,o)):i.nextTick(u,this,o)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(o||null,function(f){!d&&f?g._writableState?g._writableState.errorEmitted?i.nextTick(l,g):(g._writableState.errorEmitted=!0,i.nextTick(c,g,f)):i.nextTick(c,g,f):d?(i.nextTick(l,g),d(f)):i.nextTick(l,g)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(o,d){var g=o._readableState,p=o._writableState;g&&g.autoDestroy||p&&p.autoDestroy?o.destroy(d):o.emit("error",d)}}}).call(this)}).call(this,e("_process"))},{_process:467}],486:[function(e,a,n){var i=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function c(){}a.exports=function l(u,o,d){if(typeof o=="function")return l(u,null,o);o||(o={}),d=function(O){var F=!1;return function(){if(!F){F=!0;for(var z=arguments.length,P=new Array(z),U=0;U<z;U++)P[U]=arguments[U];O.apply(this,P)}}}(d||c);var g=o.readable||o.readable!==!1&&u.readable,p=o.writable||o.writable!==!1&&u.writable,h=function(){u.writable||x()},f=u._writableState&&u._writableState.finished,x=function(){p=!1,f=!0,g||d.call(u)},b=u._readableState&&u._readableState.endEmitted,v=function(){g=!1,b=!0,p||d.call(u)},_=function(O){d.call(u,O)},N=function(){var O;return g&&!b?(u._readableState&&u._readableState.ended||(O=new i),d.call(u,O)):p&&!f?(u._writableState&&u._writableState.ended||(O=new i),d.call(u,O)):void 0},E=function(){u.req.on("finish",x)};return function(O){return O.setHeader&&typeof O.abort=="function"}(u)?(u.on("complete",x),u.on("abort",N),u.req?E():u.on("request",E)):p&&!u._writableState&&(u.on("end",h),u.on("close",h)),u.on("end",v),u.on("finish",x),o.error!==!1&&u.on("error",_),u.on("close",N),function(){u.removeListener("complete",x),u.removeListener("abort",N),u.removeListener("request",E),u.req&&u.req.removeListener("finish",x),u.removeListener("end",h),u.removeListener("close",h),u.removeListener("finish",x),u.removeListener("end",v),u.removeListener("error",_),u.removeListener("close",N)}}},{"../../../errors":477}],487:[function(e,a,n){a.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(e,a,n){var i,c=e("../../../errors").codes,l=c.ERR_MISSING_ARGS,u=c.ERR_STREAM_DESTROYED;function o(f){if(f)throw f}function d(f,x,b,v){v=function(E){var O=!1;return function(){O||(O=!0,E.apply(void 0,arguments))}}(v);var _=!1;f.on("close",function(){_=!0}),i===void 0&&(i=e("./end-of-stream")),i(f,{readable:x,writable:b},function(E){if(E)return v(E);_=!0,v()});var N=!1;return function(E){if(!_&&!N)return N=!0,function(O){return O.setHeader&&typeof O.abort=="function"}(f)?f.abort():typeof f.destroy=="function"?f.destroy():void v(E||new u("pipe"))}}function g(f){f()}function p(f,x){return f.pipe(x)}function h(f){return f.length?typeof f[f.length-1]!="function"?o:f.pop():o}a.exports=function(){for(var f=arguments.length,x=new Array(f),b=0;b<f;b++)x[b]=arguments[b];var v,_=h(x);if(Array.isArray(x[0])&&(x=x[0]),x.length<2)throw new l("streams");var N=x.map(function(E,O){var F=O<x.length-1;return d(E,F,O>0,function(z){v||(v=z),z&&N.forEach(g),F||(N.forEach(g),_(v))})});return x.reduce(p)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,a,n){var i=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(c,l,u,o){var d=function(g,p,h){return g.highWaterMark!=null?g.highWaterMark:p?g[h]:null}(l,o,u);if(d!=null){if(!isFinite(d)||Math.floor(d)!==d||d<0)throw new i(o?u:"highWaterMark",d);return Math.floor(d)}return c.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,a,n){a.exports=e("events").EventEmitter},{events:422}],491:[function(e,a,n){(n=a.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,a,n){var i=function(c){var l=Object.prototype,u=l.hasOwnProperty,o=Object.defineProperty||function(w,j,A){w[j]=A.value},d=typeof Symbol=="function"?Symbol:{},g=d.iterator||"@@iterator",p=d.asyncIterator||"@@asyncIterator",h=d.toStringTag||"@@toStringTag";function f(w,j,A){return Object.defineProperty(w,j,{value:A,enumerable:!0,configurable:!0,writable:!0}),w[j]}try{f({},"")}catch{f=function(j,A,L){return j[A]=L}}function x(w,j,A,L){var I=j&&j.prototype instanceof _?j:_,Z=Object.create(I.prototype),K=new T(L||[]);return o(Z,"_invoke",{value:Y(w,A,K)}),Z}function b(w,j,A){try{return{type:"normal",arg:w.call(j,A)}}catch(L){return{type:"throw",arg:L}}}c.wrap=x;var v={};function _(){}function N(){}function E(){}var O={};f(O,g,function(){return this});var F=Object.getPrototypeOf,z=F&&F(F(C([])));z&&z!==l&&u.call(z,g)&&(O=z);var P=E.prototype=_.prototype=Object.create(O);function U(w){["next","throw","return"].forEach(function(j){f(w,j,function(A){return this._invoke(j,A)})})}function W(w,j){var A;o(this,"_invoke",{value:function(L,I){function Z(){return new j(function(K,re){(function G(ae,V,H,Q){var oe=b(w[ae],w,V);if(oe.type!=="throw"){var se=oe.arg,le=se.value;return le&&typeof le=="object"&&u.call(le,"__await")?j.resolve(le.__await).then(function(he){G("next",he,H,Q)},function(he){G("throw",he,H,Q)}):j.resolve(le).then(function(he){se.value=he,H(se)},function(he){return G("throw",he,H,Q)})}Q(oe.arg)})(L,I,K,re)})}return A=A?A.then(Z,Z):Z()}})}function Y(w,j,A){var L="suspendedStart";return function(I,Z){if(L==="executing")throw new Error("Generator is already running");if(L==="completed"){if(I==="throw")throw Z;return S()}for(A.method=I,A.arg=Z;;){var K=A.delegate;if(K){var re=q(K,A);if(re){if(re===v)continue;return re}}if(A.method==="next")A.sent=A._sent=A.arg;else if(A.method==="throw"){if(L==="suspendedStart")throw L="completed",A.arg;A.dispatchException(A.arg)}else A.method==="return"&&A.abrupt("return",A.arg);L="executing";var G=b(w,j,A);if(G.type==="normal"){if(L=A.done?"completed":"suspendedYield",G.arg===v)continue;return{value:G.arg,done:A.done}}G.type==="throw"&&(L="completed",A.method="throw",A.arg=G.arg)}}}function q(w,j){var A=j.method,L=w.iterator[A];if(L===void 0)return j.delegate=null,A==="throw"&&w.iterator.return&&(j.method="return",j.arg=void 0,q(w,j),j.method==="throw")||A!=="return"&&(j.method="throw",j.arg=new TypeError("The iterator does not provide a '"+A+"' method")),v;var I=b(L,w.iterator,j.arg);if(I.type==="throw")return j.method="throw",j.arg=I.arg,j.delegate=null,v;var Z=I.arg;return Z?Z.done?(j[w.resultName]=Z.value,j.next=w.nextLoc,j.method!=="return"&&(j.method="next",j.arg=void 0),j.delegate=null,v):Z:(j.method="throw",j.arg=new TypeError("iterator result is not an object"),j.delegate=null,v)}function M(w){var j={tryLoc:w[0]};1 in w&&(j.catchLoc=w[1]),2 in w&&(j.finallyLoc=w[2],j.afterLoc=w[3]),this.tryEntries.push(j)}function D(w){var j=w.completion||{};j.type="normal",delete j.arg,w.completion=j}function T(w){this.tryEntries=[{tryLoc:"root"}],w.forEach(M,this),this.reset(!0)}function C(w){if(w){var j=w[g];if(j)return j.call(w);if(typeof w.next=="function")return w;if(!isNaN(w.length)){var A=-1,L=function I(){for(;++A<w.length;)if(u.call(w,A))return I.value=w[A],I.done=!1,I;return I.value=void 0,I.done=!0,I};return L.next=L}}return{next:S}}function S(){return{value:void 0,done:!0}}return N.prototype=E,o(P,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:N,configurable:!0}),N.displayName=f(E,h,"GeneratorFunction"),c.isGeneratorFunction=function(w){var j=typeof w=="function"&&w.constructor;return!!j&&(j===N||(j.displayName||j.name)==="GeneratorFunction")},c.mark=function(w){return Object.setPrototypeOf?Object.setPrototypeOf(w,E):(w.__proto__=E,f(w,h,"GeneratorFunction")),w.prototype=Object.create(P),w},c.awrap=function(w){return{__await:w}},U(W.prototype),f(W.prototype,p,function(){return this}),c.AsyncIterator=W,c.async=function(w,j,A,L,I){I===void 0&&(I=Promise);var Z=new W(x(w,j,A,L),I);return c.isGeneratorFunction(j)?Z:Z.next().then(function(K){return K.done?K.value:Z.next()})},U(P),f(P,h,"Generator"),f(P,g,function(){return this}),f(P,"toString",function(){return"[object Generator]"}),c.keys=function(w){var j=Object(w),A=[];for(var L in j)A.push(L);return A.reverse(),function I(){for(;A.length;){var Z=A.pop();if(Z in j)return I.value=Z,I.done=!1,I}return I.done=!0,I}},c.values=C,T.prototype={constructor:T,reset:function(w){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!w)for(var j in this)j.charAt(0)==="t"&&u.call(this,j)&&!isNaN(+j.slice(1))&&(this[j]=void 0)},stop:function(){this.done=!0;var w=this.tryEntries[0].completion;if(w.type==="throw")throw w.arg;return this.rval},dispatchException:function(w){if(this.done)throw w;var j=this;function A(G,ae){return Z.type="throw",Z.arg=w,j.next=G,ae&&(j.method="next",j.arg=void 0),!!ae}for(var L=this.tryEntries.length-1;L>=0;--L){var I=this.tryEntries[L],Z=I.completion;if(I.tryLoc==="root")return A("end");if(I.tryLoc<=this.prev){var K=u.call(I,"catchLoc"),re=u.call(I,"finallyLoc");if(K&&re){if(this.prev<I.catchLoc)return A(I.catchLoc,!0);if(this.prev<I.finallyLoc)return A(I.finallyLoc)}else if(K){if(this.prev<I.catchLoc)return A(I.catchLoc,!0)}else{if(!re)throw new Error("try statement without catch or finally");if(this.prev<I.finallyLoc)return A(I.finallyLoc)}}}},abrupt:function(w,j){for(var A=this.tryEntries.length-1;A>=0;--A){var L=this.tryEntries[A];if(L.tryLoc<=this.prev&&u.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var I=L;break}}I&&(w==="break"||w==="continue")&&I.tryLoc<=j&&j<=I.finallyLoc&&(I=null);var Z=I?I.completion:{};return Z.type=w,Z.arg=j,I?(this.method="next",this.next=I.finallyLoc,v):this.complete(Z)},complete:function(w,j){if(w.type==="throw")throw w.arg;return w.type==="break"||w.type==="continue"?this.next=w.arg:w.type==="return"?(this.rval=this.arg=w.arg,this.method="return",this.next="end"):w.type==="normal"&&j&&(this.next=j),v},finish:function(w){for(var j=this.tryEntries.length-1;j>=0;--j){var A=this.tryEntries[j];if(A.finallyLoc===w)return this.complete(A.completion,A.afterLoc),D(A),v}},catch:function(w){for(var j=this.tryEntries.length-1;j>=0;--j){var A=this.tryEntries[j];if(A.tryLoc===w){var L=A.completion;if(L.type==="throw"){var I=L.arg;D(A)}return I}}throw new Error("illegal catch attempt")},delegateYield:function(w,j,A){return this.delegate={iterator:C(w),resultName:j,nextLoc:A},this.method==="next"&&(this.arg=void 0),v}},c}(typeof a=="object"?a.exports:{});try{regeneratorRuntime=i}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},{}],493:[function(e,a,n){var i=e("buffer").Buffer,c=e("inherits"),l=e("hash-base"),u=new Array(16),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],p=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],f=[1352829926,1548603684,1836072691,2053994217,0];function x(){l.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function b(F,z){return F<<z|F>>>32-z}function v(F,z,P,U,W,Y,q,M){return b(F+(z^P^U)+Y+q|0,M)+W|0}function _(F,z,P,U,W,Y,q,M){return b(F+(z&P|~z&U)+Y+q|0,M)+W|0}function N(F,z,P,U,W,Y,q,M){return b(F+((z|~P)^U)+Y+q|0,M)+W|0}function E(F,z,P,U,W,Y,q,M){return b(F+(z&U|P&~U)+Y+q|0,M)+W|0}function O(F,z,P,U,W,Y,q,M){return b(F+(z^(P|~U))+Y+q|0,M)+W|0}c(x,l),x.prototype._update=function(){for(var F=u,z=0;z<16;++z)F[z]=this._block.readInt32LE(4*z);for(var P=0|this._a,U=0|this._b,W=0|this._c,Y=0|this._d,q=0|this._e,M=0|this._a,D=0|this._b,T=0|this._c,C=0|this._d,S=0|this._e,w=0;w<80;w+=1){var j,A;w<16?(j=v(P,U,W,Y,q,F[o[w]],h[0],g[w]),A=O(M,D,T,C,S,F[d[w]],f[0],p[w])):w<32?(j=_(P,U,W,Y,q,F[o[w]],h[1],g[w]),A=E(M,D,T,C,S,F[d[w]],f[1],p[w])):w<48?(j=N(P,U,W,Y,q,F[o[w]],h[2],g[w]),A=N(M,D,T,C,S,F[d[w]],f[2],p[w])):w<64?(j=E(P,U,W,Y,q,F[o[w]],h[3],g[w]),A=_(M,D,T,C,S,F[d[w]],f[3],p[w])):(j=O(P,U,W,Y,q,F[o[w]],h[4],g[w]),A=v(M,D,T,C,S,F[d[w]],f[4],p[w])),P=q,q=Y,Y=b(W,10),W=U,U=j,M=S,S=C,C=b(T,10),T=D,D=A}var L=this._b+W+C|0;this._b=this._c+Y+S|0,this._c=this._d+q+M|0,this._d=this._e+P+D|0,this._e=this._a+U+T|0,this._a=L},x.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var F=i.alloc?i.alloc(20):new i(20);return F.writeInt32LE(this._a,0),F.writeInt32LE(this._b,4),F.writeInt32LE(this._c,8),F.writeInt32LE(this._d,12),F.writeInt32LE(this._e,16),F},a.exports=x},{buffer:220,"hash-base":425,inherits:440}],494:[function(e,a,n){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var i=e("buffer"),c=i.Buffer;function l(o,d){for(var g in o)d[g]=o[g]}function u(o,d,g){return c(o,d,g)}c.from&&c.alloc&&c.allocUnsafe&&c.allocUnsafeSlow?a.exports=i:(l(i,n),n.Buffer=u),u.prototype=Object.create(c.prototype),l(c,u),u.from=function(o,d,g){if(typeof o=="number")throw new TypeError("Argument must not be a number");return c(o,d,g)},u.alloc=function(o,d,g){if(typeof o!="number")throw new TypeError("Argument must be a number");var p=c(o);return d!==void 0?typeof g=="string"?p.fill(d,g):p.fill(d):p.fill(0),p},u.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return c(o)},u.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(o)}},{buffer:220}],495:[function(e,a,n){(function(i){(function(){var c,l=e("buffer"),u=l.Buffer,o={};for(c in l)l.hasOwnProperty(c)&&c!=="SlowBuffer"&&c!=="Buffer"&&(o[c]=l[c]);var d=o.Buffer={};for(c in u)u.hasOwnProperty(c)&&c!=="allocUnsafe"&&c!=="allocUnsafeSlow"&&(d[c]=u[c]);if(o.Buffer.prototype=u.prototype,d.from&&d.from!==Uint8Array.from||(d.from=function(g,p,h){if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof g);if(g&&g.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);return u(g,p,h)}),d.alloc||(d.alloc=function(g,p,h){if(typeof g!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof g);if(g<0||g>=2*(1<<30))throw new RangeError('The value "'+g+'" is invalid for option "size"');var f=u(g);return p&&p.length!==0?typeof h=="string"?f.fill(p,h):f.fill(p):f.fill(0),f}),!o.kStringMaxLength)try{o.kStringMaxLength=i.binding("buffer").kStringMaxLength}catch{}o.constants||(o.constants={MAX_LENGTH:o.kMaxLength},o.kStringMaxLength&&(o.constants.MAX_STRING_LENGTH=o.kStringMaxLength)),a.exports=o}).call(this)}).call(this,e("_process"))},{_process:467,buffer:220}],496:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("xmlchars/xml/1.0/ed5"),c=e("xmlchars/xml/1.1/ed2"),l=e("xmlchars/xmlns/1.0/ed3");var u=i.isS,o=i.isChar,d=i.isNameStartChar,g=i.isNameChar,p=i.S_LIST,h=i.NAME_RE,f=c.isChar,x=l.isNCNameStartChar,b=l.isNCNameChar,v=l.NC_NAME_RE;const _="http://www.w3.org/XML/1998/namespace",N="http://www.w3.org/2000/xmlns/",E={__proto__:null,xml:_,xmlns:N},O={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},F=C=>C===34||C===39,z=[34,39],P=[...z,91,62],U=[...z,60,93],W=[61,63,...p],Y=[...p,62,38,60];function q(C,S,w){switch(S){case"xml":w!==_&&C.fail(`xml prefix must be bound to ${_}.`);break;case"xmlns":w!==N&&C.fail(`xmlns prefix must be bound to ${N}.`)}switch(w){case N:C.fail(S===""?`the default namespace may not be set to ${w}.`:`may not assign a prefix (even "xmlns") to the URI ${N}.`);break;case _:switch(S){case"xml":break;case"":C.fail(`the default namespace may not be set to ${w}.`);break;default:C.fail("may not assign the xml namespace to another prefix.")}}}const M=C=>v.test(C),D=C=>h.test(C);n.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const T={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};n.SaxesParser=class{constructor(C){this.opt=C??{},this.fragmentOpt=!!this.opt.fragment;const S=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,S){this.nameStartCheck=x,this.nameCheck=b,this.isName=M,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},E);const w=this.opt.additionalNamespaces;w!=null&&(function(j,A){for(const L of Object.keys(A))q(j,L,A[L])}(this,w),Object.assign(this.ns,w))}else this.nameStartCheck=d,this.nameCheck=g,this.isName=D,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var C;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:S}=this;this.state=S?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=S,this.xmlDeclPossible=!S,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:w}=this.opt;if(w===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");w="1.0"}this.setXMLVersion(w),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(O),(C=this.readyHandler)===null||C===void 0||C.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(C,S){this[T[C]]=S}off(C){this[T[C]]=void 0}makeError(C){var S;let w=(S=this.fileName)!==null&&S!==void 0?S:"";return this.trackPosition&&(w.length>0&&(w+=":"),w+=`${this.line}:${this.column}`),w.length>0&&(w+=": "),new Error(w+C)}fail(C){const S=this.makeError(C),w=this.errorHandler;if(w===void 0)throw S;return w(S),this}write(C){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let S=!1;C===null?(S=!0,C=""):typeof C=="object"&&(C=C.toString()),this.carriedFromPrevious!==void 0&&(C=`${this.carriedFromPrevious}${C}`,this.carriedFromPrevious=void 0);let w=C.length;const j=C.charCodeAt(w-1);!S&&(j===13||j>=55296&&j<=56319)&&(this.carriedFromPrevious=C[w-1],w--,C=C.slice(0,w));const{stateTable:A}=this;for(this.chunk=C,this.i=0;this.i<w;)A[this.state].call(this);return this.chunkPosition+=w,S?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:C,i:S}=this;if(this.prevI=S,this.i=S+1,S>=C.length)return-1;const w=C.charCodeAt(S);if(this.column++,w<55296){if(w>=32||w===9)return w;switch(w){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return C.charCodeAt(S+1)===10&&(this.i=S+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),w}}if(w>56319)return w>=57344&&w<=65533||this.fail("disallowed character."),w;const j=65536+1024*(w-55296)+(C.charCodeAt(S+1)-56320);return this.i=S+2,j>1114111&&this.fail("disallowed character."),j}getCode11(){const{chunk:C,i:S}=this;if(this.prevI=S,this.i=S+1,S>=C.length)return-1;const w=C.charCodeAt(S);if(this.column++,w<55296){if(w>31&&w<127||w>159&&w!==8232||w===9)return w;switch(w){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const A=C.charCodeAt(S+1);A!==10&&A!==133||(this.i=S+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),w}}if(w>56319)return w>=57344&&w<=65533||this.fail("disallowed character."),w;const j=65536+1024*(w-55296)+(C.charCodeAt(S+1)-56320);return this.i=S+2,j>1114111&&this.fail("disallowed character."),j}getCodeNorm(){const C=this.getCode();return C===-2?10:C}unget(){this.i=this.prevI,this.column--}captureTo(C){let{i:S}=this;const{chunk:w}=this;for(;;){const j=this.getCode(),A=j===-2,L=A?10:j;if(L===-1||C.includes(L))return this.text+=w.slice(S,this.prevI),L;A&&(this.text+=w.slice(S,this.prevI)+`
`,S=this.i)}}captureToChar(C){let{i:S}=this;const{chunk:w}=this;for(;;){let j=this.getCode();switch(j){case-2:this.text+=w.slice(S,this.prevI)+`
`,S=this.i,j=10;break;case-1:return this.text+=w.slice(S),!1}if(j===C)return this.text+=w.slice(S,this.prevI),!0}}captureNameChars(){const{chunk:C,i:S}=this;for(;;){const w=this.getCode();if(w===-1)return this.name+=C.slice(S),-1;if(!g(w))return this.name+=C.slice(S,this.prevI),w===-2?10:w}}skipSpaces(){for(;;){const C=this.getCodeNorm();if(C===-1||!u(C))return C}}setXMLVersion(C){this.currentXMLVersion=C,C==="1.0"?(this.isChar=o,this.getCode=this.getCode10):(this.isChar=f,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const C=this.i,S=this.skipSpaces();switch(this.prevI!==C&&(this.xmlDeclPossible=!1),S){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var C;const S=this.captureTo(P);switch(S){case 62:(C=this.doctypeHandler)===null||C===void 0||C.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(S),S===91?this.state=4:F(S)&&(this.state=3,this.q=S)}}sDoctypeQuote(){const C=this.q;this.captureToChar(C)&&(this.text+=String.fromCodePoint(C),this.q=null,this.state=2)}sDTD(){const C=this.captureTo(U);C!==-1&&(this.text+=String.fromCodePoint(C),C===93?this.state=2:C===60?this.state=6:F(C)&&(this.state=5,this.q=C))}sDTDQuoted(){const C=this.q;this.captureToChar(C)&&(this.text+=String.fromCodePoint(C),this.state=4,this.q=null)}sDTDOpenWaka(){const C=this.getCodeNorm();switch(this.text+=String.fromCodePoint(C),C){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const C=String.fromCodePoint(this.getCodeNorm()),S=this.openWakaBang+=C;this.text+=C,S!=="-"&&(this.state=S==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const C=this.getCodeNorm();this.text+=String.fromCodePoint(C),this.state=C===45?10:8}sDTDCommentEnded(){const C=this.getCodeNorm();this.text+=String.fromCodePoint(C),C===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const C=this.getCodeNorm();this.text+=String.fromCodePoint(C),C===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:C}=this;const{chunk:S}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=S.slice(C,this.prevI)+`
`,C=this.i;break;case 59:{const{entityReturnState:w}=this,j=this.entity+S.slice(C,this.prevI);let A;this.state=w,j===""?(this.fail("empty entity name."),A="&;"):(A=this.parseEntity(j),this.entity=""),w===13&&this.textHandler===void 0||(this.text+=A);break e}case-1:this.entity+=S.slice(C);break e}}sOpenWaka(){const C=this.getCode();if(d(C))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(C){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var C;const S=this.getCodeNorm();S===45?(this.state=19,(C=this.commentHandler)===null||C===void 0||C.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(S),this.state=17)}sCommentEnded(){const C=this.getCodeNorm();C!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(C),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const C=this.getCodeNorm();C===93?this.state=22:(this.text+="]"+String.fromCodePoint(C),this.state=20)}sCDataEnding2(){var C;const S=this.getCodeNorm();switch(S){case 62:(C=this.cdataHandler)===null||C===void 0||C.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(S),this.state=20}}sPIFirstChar(){const C=this.getCodeNorm();this.nameStartCheck(C)?(this.piTarget+=String.fromCodePoint(C),this.state=24):C===63||u(C)?(this.fail("processing instruction without a target."),this.state=C===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(C),this.state=24)}sPIRest(){const{chunk:C,i:S}=this;for(;;){const w=this.getCodeNorm();if(w===-1)return void(this.piTarget+=C.slice(S));if(!this.nameCheck(w)){this.piTarget+=C.slice(S,this.prevI);const j=w===63;j||u(w)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=j?33:27):this.state=j?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(w));break}}}sPIBody(){if(this.text.length===0){const C=this.getCodeNorm();C===63?this.state=26:u(C)||(this.text=String.fromCodePoint(C))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var C;const S=this.getCodeNorm();if(S===62){const{piTarget:w}=this;w.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(C=this.piHandler)===null||C===void 0||C.call(this,{target:w,body:this.text}),this.piTarget=this.text="",this.state=13}else S===63?this.text+="?":(this.text+="?"+String.fromCodePoint(S),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const C=this.skipSpaces();C!==63?C!==-1&&(this.state=28,this.name=String.fromCodePoint(C)):this.state=33}sXMLDeclName(){const C=this.captureTo(W);if(C===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(u(C)||C===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=C===61?30:29}}sXMLDeclEq(){const C=this.getCodeNorm();if(C===63)return this.state=33,void this.fail("XML declaration is incomplete.");u(C)||(C!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const C=this.getCodeNorm();if(C===63)return this.state=33,void this.fail("XML declaration is incomplete.");u(C)||(F(C)?this.q=C:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const C=this.captureTo([this.q,63]);if(C===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(C===-1)return;const S=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const w=S;this.xmlDecl.version=w,/^1\.[0-9]+$/.test(w)?this.opt.forceXMLVersion||this.setXMLVersion(w):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(S)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=S;break;case"standalone":S!=="yes"&&S!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=S}this.name="",this.state=32}sXMLDeclSeparator(){const C=this.getCodeNorm();C!==63?(u(C)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var C;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(C=this.xmldeclHandler)===null||C===void 0||C.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var C;const S=this.captureNameChars();if(S===-1)return;const w=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=w.ns=Object.create(null)),(C=this.openTagStartHandler)===null||C===void 0||C.call(this,w),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),S){case 62:this.openTag();break;case 47:this.state=35;break;default:u(S)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const C=this.skipSpaces();C!==-1&&(d(C)?(this.unget(),this.state=37):C===62?this.openTag():C===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const C=this.captureNameChars();C===61?this.state=39:u(C)?this.state=38:C===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):C!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const C=this.skipSpaces();switch(C){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",C===62?this.openTag():d(C)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const C=this.getCodeNorm();F(C)?(this.q=C,this.state=40):u(C)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:C,chunk:S}=this;let{i:w}=this;for(;;)switch(this.getCode()){case C:return this.pushAttrib(this.name,this.text+S.slice(w,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=S.slice(w,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=S.slice(w,this.prevI)+" ",w=this.i;break;case 60:return this.text+=S.slice(w,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=S.slice(w))}}sAttribValueClosed(){const C=this.getCodeNorm();u(C)?this.state=36:C===62?this.openTag():C===47?this.state=35:d(C)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const C=this.captureTo(Y);switch(C){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",C===62?this.openTag():this.state=36}}sCloseTag(){const C=this.captureNameChars();C===62?this.closeTag():u(C)?this.state=44:C!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:C,forbiddenState:S}=this;const{chunk:w,textHandler:j}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,j!==void 0){const{text:A}=this,L=w.slice(C,this.prevI);A.length!==0?(j(A+L),this.text=""):L.length!==0&&j(L)}S=0;break e;case 38:this.state=14,this.entityReturnState=13,j!==void 0&&(this.text+=w.slice(C,this.prevI)),S=0;break e;case 93:switch(S){case 0:S=1;break;case 1:S=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:S===2&&this.fail('the string "]]>" is disallowed in char data.'),S=0;break;case-2:j!==void 0&&(this.text+=w.slice(C,this.prevI)+`
`),C=this.i,S=0;break;case-1:j!==void 0&&(this.text+=w.slice(C));break e;default:S=0}this.forbiddenState=S}handleTextOutsideRoot(){let{i:C}=this;const{chunk:S,textHandler:w}=this;let j=!1;e:for(;;){const A=this.getCode();switch(A){case 60:if(this.state=15,w!==void 0){const{text:L}=this,I=S.slice(C,this.prevI);L.length!==0?(w(L+I),this.text=""):I.length!==0&&w(I)}break e;case 38:this.state=14,this.entityReturnState=13,w!==void 0&&(this.text+=S.slice(C,this.prevI)),j=!0;break e;case-2:w!==void 0&&(this.text+=S.slice(C,this.prevI)+`
`),C=this.i;break;case-1:w!==void 0&&(this.text+=S.slice(C));break e;default:u(A)||(j=!0)}}j&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(C,S){var w;const{prefix:j,local:A}=this.qname(C),L={name:C,prefix:j,local:A,value:S};if(this.attribList.push(L),(w=this.attributeHandler)===null||w===void 0||w.call(this,L),j==="xmlns"){const I=S.trim();this.currentXMLVersion==="1.0"&&I===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[A]=I,q(this,A,I)}else if(C==="xmlns"){const I=S.trim();this.topNS[""]=I,q(this,"",I)}}pushAttribPlain(C,S){var w;const j={name:C,value:S};this.attribList.push(j),(w=this.attributeHandler)===null||w===void 0||w.call(this,j)}end(){var C,S;this.sawRoot||this.fail("document must contain a root element.");const{tags:w}=this;for(;w.length>0;){const A=w.pop();this.fail("unclosed tag: "+A.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:j}=this;return j.length!==0&&((C=this.textHandler)===null||C===void 0||C.call(this,j),this.text=""),this._closed=!0,(S=this.endHandler)===null||S===void 0||S.call(this),this._init(),this}resolve(C){var S,w;let j=this.topNS[C];if(j!==void 0)return j;const{tags:A}=this;for(let L=A.length-1;L>=0;L--)if(j=A[L].ns[C],j!==void 0)return j;return j=this.ns[C],j!==void 0?j:(w=(S=this.opt).resolvePrefix)===null||w===void 0?void 0:w.call(S,C)}qname(C){const S=C.indexOf(":");if(S===-1)return{prefix:"",local:C};const w=C.slice(S+1),j=C.slice(0,S);return(j===""||w===""||w.includes(":"))&&this.fail(`malformed name: ${C}.`),{prefix:j,local:w}}processAttribsNS(){var C;const{attribList:S}=this,w=this.tag;{const{prefix:L,local:I}=this.qname(w.name);w.prefix=L,w.local=I;const Z=w.uri=(C=this.resolve(L))!==null&&C!==void 0?C:"";L!==""&&(L==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),Z===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(L)}.`),w.uri=L))}if(S.length===0)return;const{attributes:j}=w,A=new Set;for(const L of S){const{name:I,prefix:Z,local:K}=L;let re,G;Z===""?(re=I==="xmlns"?N:"",G=I):(re=this.resolve(Z),re===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(Z)}.`),re=Z),G=`{${re}}${K}`),A.has(G)&&this.fail(`duplicate attribute: ${G}.`),A.add(G),L.uri=re,j[I]=L}this.attribList=[]}processAttribsPlain(){const{attribList:C}=this,S=this.tag.attributes;for(const{name:w,value:j}of C)S[w]!==void 0&&this.fail(`duplicate attribute: ${w}.`),S[w]=j;this.attribList=[]}openTag(){var C;this.processAttribs();const{tags:S}=this,w=this.tag;w.isSelfClosing=!1,(C=this.openTagHandler)===null||C===void 0||C.call(this,w),S.push(w),this.state=13,this.name=""}openSelfClosingTag(){var C,S,w;this.processAttribs();const{tags:j}=this,A=this.tag;A.isSelfClosing=!0,(C=this.openTagHandler)===null||C===void 0||C.call(this,A),(S=this.closeTagHandler)===null||S===void 0||S.call(this,A),(this.tag=(w=j[j.length-1])!==null&&w!==void 0?w:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:C,name:S}=this;if(this.state=13,this.name="",S==="")return this.fail("weird empty close tag."),void(this.text+="</>");const w=this.closeTagHandler;let j=C.length;for(;j-- >0;){const A=this.tag=C.pop();if(this.topNS=A.ns,w==null||w(A),A.name===S)break;this.fail("unexpected close tag.")}j===0?this.closedRoot=!0:j<0&&(this.fail(`unmatched closing tag: ${S}.`),this.text+=`</${S}>`)}parseEntity(C){if(C[0]!=="#"){const w=this.ENTITIES[C];return w!==void 0?w:(this.fail(this.isName(C)?"undefined entity.":"disallowed character in entity name."),`&${C};`)}let S=NaN;return C[1]==="x"&&/^#x[0-9a-f]+$/i.test(C)?S=parseInt(C.slice(2),16):/^#[0-9]+$/.test(C)&&(S=parseInt(C.slice(1),10)),this.isChar(S)?String.fromCodePoint(S):(this.fail("malformed character entity."),`&${C};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(e,a,n){var i=e("safe-buffer").Buffer;function c(l,u){this._block=i.alloc(l),this._finalSize=u,this._blockSize=l,this._len=0}c.prototype.update=function(l,u){typeof l=="string"&&(u=u||"utf8",l=i.from(l,u));for(var o=this._block,d=this._blockSize,g=l.length,p=this._len,h=0;h<g;){for(var f=p%d,x=Math.min(g-h,d-f),b=0;b<x;b++)o[f+b]=l[h+b];h+=x,(p+=x)%d==0&&this._update(o)}return this._len+=g,this},c.prototype.digest=function(l){var u=this._len%this._blockSize;this._block[u]=128,this._block.fill(0,u+1),u>=this._finalSize&&(this._update(this._block),this._block.fill(0));var o=8*this._len;if(o<=4294967295)this._block.writeUInt32BE(o,this._blockSize-4);else{var d=(4294967295&o)>>>0,g=(o-d)/4294967296;this._block.writeUInt32BE(g,this._blockSize-8),this._block.writeUInt32BE(d,this._blockSize-4)}this._update(this._block);var p=this._hash();return l?p.toString(l):p},c.prototype._update=function(){throw new Error("_update must be implemented by subclass")},a.exports=c},{"safe-buffer":494}],498:[function(e,a,n){var i=a.exports=function(c){c=c.toLowerCase();var l=i[c];if(!l)throw new Error(c+" is not supported (we accept pull requests)");return new l};i.sha=e("./sha"),i.sha1=e("./sha1"),i.sha224=e("./sha224"),i.sha256=e("./sha256"),i.sha384=e("./sha384"),i.sha512=e("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(e,a,n){var i=e("inherits"),c=e("./hash"),l=e("safe-buffer").Buffer,u=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function d(){this.init(),this._w=o,c.call(this,64,56)}function g(h){return h<<30|h>>>2}function p(h,f,x,b){return h===0?f&x|~f&b:h===2?f&x|f&b|x&b:f^x^b}i(d,c),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(h){for(var f,x=this._w,b=0|this._a,v=0|this._b,_=0|this._c,N=0|this._d,E=0|this._e,O=0;O<16;++O)x[O]=h.readInt32BE(4*O);for(;O<80;++O)x[O]=x[O-3]^x[O-8]^x[O-14]^x[O-16];for(var F=0;F<80;++F){var z=~~(F/20),P=0|((f=b)<<5|f>>>27)+p(z,v,_,N)+E+x[F]+u[z];E=N,N=_,_=g(v),v=b,b=P}this._a=b+this._a|0,this._b=v+this._b|0,this._c=_+this._c|0,this._d=N+this._d|0,this._e=E+this._e|0},d.prototype._hash=function(){var h=l.allocUnsafe(20);return h.writeInt32BE(0|this._a,0),h.writeInt32BE(0|this._b,4),h.writeInt32BE(0|this._c,8),h.writeInt32BE(0|this._d,12),h.writeInt32BE(0|this._e,16),h},a.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(e,a,n){var i=e("inherits"),c=e("./hash"),l=e("safe-buffer").Buffer,u=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function d(){this.init(),this._w=o,c.call(this,64,56)}function g(f){return f<<5|f>>>27}function p(f){return f<<30|f>>>2}function h(f,x,b,v){return f===0?x&b|~x&v:f===2?x&b|x&v|b&v:x^b^v}i(d,c),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(f){for(var x,b=this._w,v=0|this._a,_=0|this._b,N=0|this._c,E=0|this._d,O=0|this._e,F=0;F<16;++F)b[F]=f.readInt32BE(4*F);for(;F<80;++F)b[F]=(x=b[F-3]^b[F-8]^b[F-14]^b[F-16])<<1|x>>>31;for(var z=0;z<80;++z){var P=~~(z/20),U=g(v)+h(P,_,N,E)+O+b[z]+u[P]|0;O=E,E=N,N=p(_),_=v,v=U}this._a=v+this._a|0,this._b=_+this._b|0,this._c=N+this._c|0,this._d=E+this._d|0,this._e=O+this._e|0},d.prototype._hash=function(){var f=l.allocUnsafe(20);return f.writeInt32BE(0|this._a,0),f.writeInt32BE(0|this._b,4),f.writeInt32BE(0|this._c,8),f.writeInt32BE(0|this._d,12),f.writeInt32BE(0|this._e,16),f},a.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(e,a,n){var i=e("inherits"),c=e("./sha256"),l=e("./hash"),u=e("safe-buffer").Buffer,o=new Array(64);function d(){this.init(),this._w=o,l.call(this,64,56)}i(d,c),d.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},d.prototype._hash=function(){var g=u.allocUnsafe(28);return g.writeInt32BE(this._a,0),g.writeInt32BE(this._b,4),g.writeInt32BE(this._c,8),g.writeInt32BE(this._d,12),g.writeInt32BE(this._e,16),g.writeInt32BE(this._f,20),g.writeInt32BE(this._g,24),g},a.exports=d},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(e,a,n){var i=e("inherits"),c=e("./hash"),l=e("safe-buffer").Buffer,u=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function d(){this.init(),this._w=o,c.call(this,64,56)}function g(b,v,_){return _^b&(v^_)}function p(b,v,_){return b&v|_&(b|v)}function h(b){return(b>>>2|b<<30)^(b>>>13|b<<19)^(b>>>22|b<<10)}function f(b){return(b>>>6|b<<26)^(b>>>11|b<<21)^(b>>>25|b<<7)}function x(b){return(b>>>7|b<<25)^(b>>>18|b<<14)^b>>>3}i(d,c),d.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},d.prototype._update=function(b){for(var v,_=this._w,N=0|this._a,E=0|this._b,O=0|this._c,F=0|this._d,z=0|this._e,P=0|this._f,U=0|this._g,W=0|this._h,Y=0;Y<16;++Y)_[Y]=b.readInt32BE(4*Y);for(;Y<64;++Y)_[Y]=0|(((v=_[Y-2])>>>17|v<<15)^(v>>>19|v<<13)^v>>>10)+_[Y-7]+x(_[Y-15])+_[Y-16];for(var q=0;q<64;++q){var M=W+f(z)+g(z,P,U)+u[q]+_[q]|0,D=h(N)+p(N,E,O)|0;W=U,U=P,P=z,z=F+M|0,F=O,O=E,E=N,N=M+D|0}this._a=N+this._a|0,this._b=E+this._b|0,this._c=O+this._c|0,this._d=F+this._d|0,this._e=z+this._e|0,this._f=P+this._f|0,this._g=U+this._g|0,this._h=W+this._h|0},d.prototype._hash=function(){var b=l.allocUnsafe(32);return b.writeInt32BE(this._a,0),b.writeInt32BE(this._b,4),b.writeInt32BE(this._c,8),b.writeInt32BE(this._d,12),b.writeInt32BE(this._e,16),b.writeInt32BE(this._f,20),b.writeInt32BE(this._g,24),b.writeInt32BE(this._h,28),b},a.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(e,a,n){var i=e("inherits"),c=e("./sha512"),l=e("./hash"),u=e("safe-buffer").Buffer,o=new Array(160);function d(){this.init(),this._w=o,l.call(this,128,112)}i(d,c),d.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},d.prototype._hash=function(){var g=u.allocUnsafe(48);function p(h,f,x){g.writeInt32BE(h,x),g.writeInt32BE(f,x+4)}return p(this._ah,this._al,0),p(this._bh,this._bl,8),p(this._ch,this._cl,16),p(this._dh,this._dl,24),p(this._eh,this._el,32),p(this._fh,this._fl,40),g},a.exports=d},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(e,a,n){var i=e("inherits"),c=e("./hash"),l=e("safe-buffer").Buffer,u=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function d(){this.init(),this._w=o,c.call(this,128,112)}function g(E,O,F){return F^E&(O^F)}function p(E,O,F){return E&O|F&(E|O)}function h(E,O){return(E>>>28|O<<4)^(O>>>2|E<<30)^(O>>>7|E<<25)}function f(E,O){return(E>>>14|O<<18)^(E>>>18|O<<14)^(O>>>9|E<<23)}function x(E,O){return(E>>>1|O<<31)^(E>>>8|O<<24)^E>>>7}function b(E,O){return(E>>>1|O<<31)^(E>>>8|O<<24)^(E>>>7|O<<25)}function v(E,O){return(E>>>19|O<<13)^(O>>>29|E<<3)^E>>>6}function _(E,O){return(E>>>19|O<<13)^(O>>>29|E<<3)^(E>>>6|O<<26)}function N(E,O){return E>>>0<O>>>0?1:0}i(d,c),d.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},d.prototype._update=function(E){for(var O=this._w,F=0|this._ah,z=0|this._bh,P=0|this._ch,U=0|this._dh,W=0|this._eh,Y=0|this._fh,q=0|this._gh,M=0|this._hh,D=0|this._al,T=0|this._bl,C=0|this._cl,S=0|this._dl,w=0|this._el,j=0|this._fl,A=0|this._gl,L=0|this._hl,I=0;I<32;I+=2)O[I]=E.readInt32BE(4*I),O[I+1]=E.readInt32BE(4*I+4);for(;I<160;I+=2){var Z=O[I-30],K=O[I-30+1],re=x(Z,K),G=b(K,Z),ae=v(Z=O[I-4],K=O[I-4+1]),V=_(K,Z),H=O[I-14],Q=O[I-14+1],oe=O[I-32],se=O[I-32+1],le=G+Q|0,he=re+H+N(le,G)|0;he=(he=he+ae+N(le=le+V|0,V)|0)+oe+N(le=le+se|0,se)|0,O[I]=he,O[I+1]=le}for(var Ne=0;Ne<160;Ne+=2){he=O[Ne],le=O[Ne+1];var we=p(F,z,P),ue=p(D,T,C),Se=h(F,D),ke=h(D,F),Me=f(W,w),Oe=f(w,W),je=u[Ne],Ie=u[Ne+1],Pe=g(W,Y,q),He=g(w,j,A),ct=L+Oe|0,ie=M+Me+N(ct,L)|0;ie=(ie=(ie=ie+Pe+N(ct=ct+He|0,He)|0)+je+N(ct=ct+Ie|0,Ie)|0)+he+N(ct=ct+le|0,le)|0;var ee=ke+ue|0,te=Se+we+N(ee,ke)|0;M=q,L=A,q=Y,A=j,Y=W,j=w,W=U+ie+N(w=S+ct|0,S)|0,U=P,S=C,P=z,C=T,z=F,T=D,F=ie+te+N(D=ct+ee|0,ct)|0}this._al=this._al+D|0,this._bl=this._bl+T|0,this._cl=this._cl+C|0,this._dl=this._dl+S|0,this._el=this._el+w|0,this._fl=this._fl+j|0,this._gl=this._gl+A|0,this._hl=this._hl+L|0,this._ah=this._ah+F+N(this._al,D)|0,this._bh=this._bh+z+N(this._bl,T)|0,this._ch=this._ch+P+N(this._cl,C)|0,this._dh=this._dh+U+N(this._dl,S)|0,this._eh=this._eh+W+N(this._el,w)|0,this._fh=this._fh+Y+N(this._fl,j)|0,this._gh=this._gh+q+N(this._gl,A)|0,this._hh=this._hh+M+N(this._hl,L)|0},d.prototype._hash=function(){var E=l.allocUnsafe(64);function O(F,z,P){E.writeInt32BE(F,P),E.writeInt32BE(z,P+4)}return O(this._ah,this._al,0),O(this._bh,this._bl,8),O(this._ch,this._cl,16),O(this._dh,this._dl,24),O(this._eh,this._el,32),O(this._fh,this._fl,40),O(this._gh,this._gl,48),O(this._hh,this._hl,56),E},a.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(e,a,n){a.exports=c;var i=e("events").EventEmitter;function c(){i.call(this)}e("inherits")(c,i),c.Readable=e("readable-stream/readable.js"),c.Writable=e("readable-stream/writable.js"),c.Duplex=e("readable-stream/duplex.js"),c.Transform=e("readable-stream/transform.js"),c.PassThrough=e("readable-stream/passthrough.js"),c.Stream=c,c.prototype.pipe=function(l,u){var o=this;function d(v){l.writable&&l.write(v)===!1&&o.pause&&o.pause()}function g(){o.readable&&o.resume&&o.resume()}o.on("data",d),l.on("drain",g),l._isStdio||u&&u.end===!1||(o.on("end",h),o.on("close",f));var p=!1;function h(){p||(p=!0,l.end())}function f(){p||(p=!0,typeof l.destroy=="function"&&l.destroy())}function x(v){if(b(),i.listenerCount(this,"error")===0)throw v}function b(){o.removeListener("data",d),l.removeListener("drain",g),o.removeListener("end",h),o.removeListener("close",f),o.removeListener("error",x),l.removeListener("error",x),o.removeListener("end",b),o.removeListener("close",b),l.removeListener("close",b)}return o.on("error",x),l.on("error",x),o.on("end",b),o.on("close",b),l.on("close",b),l.emit("pipe",o),l}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(e,a,n){var i={}.toString;a.exports=Array.isArray||function(c){return i.call(c)=="[object Array]"}},{}],507:[function(e,a,n){a.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,a,n){var i=e("process-nextick-args"),c=Object.keys||function(b){var v=[];for(var _ in b)v.push(_);return v};a.exports=h;var l=Object.create(e("core-util-is"));l.inherits=e("inherits");var u=e("./_stream_readable"),o=e("./_stream_writable");l.inherits(h,u);for(var d=c(o.prototype),g=0;g<d.length;g++){var p=d[g];h.prototype[p]||(h.prototype[p]=o.prototype[p])}function h(b){if(!(this instanceof h))return new h(b);u.call(this,b),o.call(this,b),b&&b.readable===!1&&(this.readable=!1),b&&b.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,b&&b.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||i.nextTick(x,this)}function x(b){b.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=b,this._writableState.destroyed=b)}}),h.prototype._destroy=function(b,v){this.push(null),this.end(),i.nextTick(v,b)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(e,a,n){a.exports=l;var i=e("./_stream_transform"),c=Object.create(e("core-util-is"));function l(u){if(!(this instanceof l))return new l(u);i.call(this,u)}c.inherits=e("inherits"),c.inherits(l,i),l.prototype._transform=function(u,o,d){d(null,u)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(e,a,n){(function(i,c){(function(){var l=e("process-nextick-args");a.exports=F;var u,o=e("isarray");F.ReadableState=O,e("events").EventEmitter;var d=function(L,I){return L.listeners(I).length},g=e("./internal/streams/stream"),p=e("safe-buffer").Buffer,h=(c!==void 0?c:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f=Object.create(e("core-util-is"));f.inherits=e("inherits");var x=e("util"),b=void 0;b=x&&x.debuglog?x.debuglog("stream"):function(){};var v,_=e("./internal/streams/BufferList"),N=e("./internal/streams/destroy");f.inherits(F,g);var E=["error","close","destroy","pause","resume"];function O(L,I){L=L||{};var Z=I instanceof(u=u||e("./_stream_duplex"));this.objectMode=!!L.objectMode,Z&&(this.objectMode=this.objectMode||!!L.readableObjectMode);var K=L.highWaterMark,re=L.readableHighWaterMark,G=this.objectMode?16:16384;this.highWaterMark=K||K===0?K:Z&&(re||re===0)?re:G,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new _,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=L.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,L.encoding&&(v||(v=e("string_decoder/").StringDecoder),this.decoder=new v(L.encoding),this.encoding=L.encoding)}function F(L){if(u=u||e("./_stream_duplex"),!(this instanceof F))return new F(L);this._readableState=new O(L,this),this.readable=!0,L&&(typeof L.read=="function"&&(this._read=L.read),typeof L.destroy=="function"&&(this._destroy=L.destroy)),g.call(this)}function z(L,I,Z,K,re){var G,ae=L._readableState;return I===null?(ae.reading=!1,function(V,H){if(!H.ended){if(H.decoder){var Q=H.decoder.end();Q&&Q.length&&(H.buffer.push(Q),H.length+=H.objectMode?1:Q.length)}H.ended=!0,W(V)}}(L,ae)):(re||(G=function(V,H){var Q;oe=H,p.isBuffer(oe)||oe instanceof h||typeof H=="string"||H===void 0||V.objectMode||(Q=new TypeError("Invalid non-string/buffer chunk"));var oe;return Q}(ae,I)),G?L.emit("error",G):ae.objectMode||I&&I.length>0?(typeof I=="string"||ae.objectMode||Object.getPrototypeOf(I)===p.prototype||(I=function(V){return p.from(V)}(I)),K?ae.endEmitted?L.emit("error",new Error("stream.unshift() after end event")):P(L,ae,I,!0):ae.ended?L.emit("error",new Error("stream.push() after EOF")):(ae.reading=!1,ae.decoder&&!Z?(I=ae.decoder.write(I),ae.objectMode||I.length!==0?P(L,ae,I,!1):q(L,ae)):P(L,ae,I,!1))):K||(ae.reading=!1)),function(V){return!V.ended&&(V.needReadable||V.length<V.highWaterMark||V.length===0)}(ae)}function P(L,I,Z,K){I.flowing&&I.length===0&&!I.sync?(L.emit("data",Z),L.read(0)):(I.length+=I.objectMode?1:Z.length,K?I.buffer.unshift(Z):I.buffer.push(Z),I.needReadable&&W(L)),q(L,I)}Object.defineProperty(F.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(L){this._readableState&&(this._readableState.destroyed=L)}}),F.prototype.destroy=N.destroy,F.prototype._undestroy=N.undestroy,F.prototype._destroy=function(L,I){this.push(null),I(L)},F.prototype.push=function(L,I){var Z,K=this._readableState;return K.objectMode?Z=!0:typeof L=="string"&&((I=I||K.defaultEncoding)!==K.encoding&&(L=p.from(L,I),I=""),Z=!0),z(this,L,I,!1,Z)},F.prototype.unshift=function(L){return z(this,L,null,!0,!1)},F.prototype.isPaused=function(){return this._readableState.flowing===!1},F.prototype.setEncoding=function(L){return v||(v=e("string_decoder/").StringDecoder),this._readableState.decoder=new v(L),this._readableState.encoding=L,this};function U(L,I){return L<=0||I.length===0&&I.ended?0:I.objectMode?1:L!=L?I.flowing&&I.length?I.buffer.head.data.length:I.length:(L>I.highWaterMark&&(I.highWaterMark=function(Z){return Z>=8388608?Z=8388608:(Z--,Z|=Z>>>1,Z|=Z>>>2,Z|=Z>>>4,Z|=Z>>>8,Z|=Z>>>16,Z++),Z}(L)),L<=I.length?L:I.ended?I.length:(I.needReadable=!0,0))}function W(L){var I=L._readableState;I.needReadable=!1,I.emittedReadable||(b("emitReadable",I.flowing),I.emittedReadable=!0,I.sync?l.nextTick(Y,L):Y(L))}function Y(L){b("emit readable"),L.emit("readable"),C(L)}function q(L,I){I.readingMore||(I.readingMore=!0,l.nextTick(M,L,I))}function M(L,I){for(var Z=I.length;!I.reading&&!I.flowing&&!I.ended&&I.length<I.highWaterMark&&(b("maybeReadMore read 0"),L.read(0),Z!==I.length);)Z=I.length;I.readingMore=!1}function D(L){b("readable nexttick read 0"),L.read(0)}function T(L,I){I.reading||(b("resume read 0"),L.read(0)),I.resumeScheduled=!1,I.awaitDrain=0,L.emit("resume"),C(L),I.flowing&&!I.reading&&L.read(0)}function C(L){var I=L._readableState;for(b("flow",I.flowing);I.flowing&&L.read()!==null;);}function S(L,I){return I.length===0?null:(I.objectMode?Z=I.buffer.shift():!L||L>=I.length?(Z=I.decoder?I.buffer.join(""):I.buffer.length===1?I.buffer.head.data:I.buffer.concat(I.length),I.buffer.clear()):Z=function(K,re,G){var ae;return K<re.head.data.length?(ae=re.head.data.slice(0,K),re.head.data=re.head.data.slice(K)):ae=K===re.head.data.length?re.shift():G?function(V,H){var Q=H.head,oe=1,se=Q.data;for(V-=se.length;Q=Q.next;){var le=Q.data,he=V>le.length?le.length:V;if(he===le.length?se+=le:se+=le.slice(0,V),(V-=he)===0){he===le.length?(++oe,Q.next?H.head=Q.next:H.head=H.tail=null):(H.head=Q,Q.data=le.slice(he));break}++oe}return H.length-=oe,se}(K,re):function(V,H){var Q=p.allocUnsafe(V),oe=H.head,se=1;for(oe.data.copy(Q),V-=oe.data.length;oe=oe.next;){var le=oe.data,he=V>le.length?le.length:V;if(le.copy(Q,Q.length-V,0,he),(V-=he)===0){he===le.length?(++se,oe.next?H.head=oe.next:H.head=H.tail=null):(H.head=oe,oe.data=le.slice(he));break}++se}return H.length-=se,Q}(K,re),ae}(L,I.buffer,I.decoder),Z);var Z}function w(L){var I=L._readableState;if(I.length>0)throw new Error('"endReadable()" called on non-empty stream');I.endEmitted||(I.ended=!0,l.nextTick(j,I,L))}function j(L,I){L.endEmitted||L.length!==0||(L.endEmitted=!0,I.readable=!1,I.emit("end"))}function A(L,I){for(var Z=0,K=L.length;Z<K;Z++)if(L[Z]===I)return Z;return-1}F.prototype.read=function(L){b("read",L),L=parseInt(L,10);var I=this._readableState,Z=L;if(L!==0&&(I.emittedReadable=!1),L===0&&I.needReadable&&(I.length>=I.highWaterMark||I.ended))return b("read: emitReadable",I.length,I.ended),I.length===0&&I.ended?w(this):W(this),null;if((L=U(L,I))===0&&I.ended)return I.length===0&&w(this),null;var K,re=I.needReadable;return b("need readable",re),(I.length===0||I.length-L<I.highWaterMark)&&b("length less than watermark",re=!0),I.ended||I.reading?b("reading or ended",re=!1):re&&(b("do read"),I.reading=!0,I.sync=!0,I.length===0&&(I.needReadable=!0),this._read(I.highWaterMark),I.sync=!1,I.reading||(L=U(Z,I))),(K=L>0?S(L,I):null)===null?(I.needReadable=!0,L=0):I.length-=L,I.length===0&&(I.ended||(I.needReadable=!0),Z!==L&&I.ended&&w(this)),K!==null&&this.emit("data",K),K},F.prototype._read=function(L){this.emit("error",new Error("_read() is not implemented"))},F.prototype.pipe=function(L,I){var Z=this,K=this._readableState;switch(K.pipesCount){case 0:K.pipes=L;break;case 1:K.pipes=[K.pipes,L];break;default:K.pipes.push(L)}K.pipesCount+=1,b("pipe count=%d opts=%j",K.pipesCount,I);var re=(!I||I.end!==!1)&&L!==i.stdout&&L!==i.stderr?ae:Ne;function G(we,ue){b("onunpipe"),we===Z&&ue&&ue.hasUnpiped===!1&&(ue.hasUnpiped=!0,b("cleanup"),L.removeListener("close",le),L.removeListener("finish",he),L.removeListener("drain",V),L.removeListener("error",se),L.removeListener("unpipe",G),Z.removeListener("end",ae),Z.removeListener("end",Ne),Z.removeListener("data",oe),H=!0,!K.awaitDrain||L._writableState&&!L._writableState.needDrain||V())}function ae(){b("onend"),L.end()}K.endEmitted?l.nextTick(re):Z.once("end",re),L.on("unpipe",G);var V=function(we){return function(){var ue=we._readableState;b("pipeOnDrain",ue.awaitDrain),ue.awaitDrain&&ue.awaitDrain--,ue.awaitDrain===0&&d(we,"data")&&(ue.flowing=!0,C(we))}}(Z);L.on("drain",V);var H=!1,Q=!1;function oe(we){b("ondata"),Q=!1,L.write(we)!==!1||Q||((K.pipesCount===1&&K.pipes===L||K.pipesCount>1&&A(K.pipes,L)!==-1)&&!H&&(b("false write response, pause",K.awaitDrain),K.awaitDrain++,Q=!0),Z.pause())}function se(we){b("onerror",we),Ne(),L.removeListener("error",se),d(L,"error")===0&&L.emit("error",we)}function le(){L.removeListener("finish",he),Ne()}function he(){b("onfinish"),L.removeListener("close",le),Ne()}function Ne(){b("unpipe"),Z.unpipe(L)}return Z.on("data",oe),function(we,ue,Se){if(typeof we.prependListener=="function")return we.prependListener(ue,Se);we._events&&we._events[ue]?o(we._events[ue])?we._events[ue].unshift(Se):we._events[ue]=[Se,we._events[ue]]:we.on(ue,Se)}(L,"error",se),L.once("close",le),L.once("finish",he),L.emit("pipe",Z),K.flowing||(b("pipe resume"),Z.resume()),L},F.prototype.unpipe=function(L){var I=this._readableState,Z={hasUnpiped:!1};if(I.pipesCount===0)return this;if(I.pipesCount===1)return L&&L!==I.pipes||(L||(L=I.pipes),I.pipes=null,I.pipesCount=0,I.flowing=!1,L&&L.emit("unpipe",this,Z)),this;if(!L){var K=I.pipes,re=I.pipesCount;I.pipes=null,I.pipesCount=0,I.flowing=!1;for(var G=0;G<re;G++)K[G].emit("unpipe",this,{hasUnpiped:!1});return this}var ae=A(I.pipes,L);return ae===-1||(I.pipes.splice(ae,1),I.pipesCount-=1,I.pipesCount===1&&(I.pipes=I.pipes[0]),L.emit("unpipe",this,Z)),this},F.prototype.on=function(L,I){var Z=g.prototype.on.call(this,L,I);if(L==="data")this._readableState.flowing!==!1&&this.resume();else if(L==="readable"){var K=this._readableState;K.endEmitted||K.readableListening||(K.readableListening=K.needReadable=!0,K.emittedReadable=!1,K.reading?K.length&&W(this):l.nextTick(D,this))}return Z},F.prototype.addListener=F.prototype.on,F.prototype.resume=function(){var L=this._readableState;return L.flowing||(b("resume"),L.flowing=!0,function(I,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,l.nextTick(T,I,Z))}(this,L)),this},F.prototype.pause=function(){return b("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(b("pause"),this._readableState.flowing=!1,this.emit("pause")),this},F.prototype.wrap=function(L){var I=this,Z=this._readableState,K=!1;for(var re in L.on("end",function(){if(b("wrapped end"),Z.decoder&&!Z.ended){var ae=Z.decoder.end();ae&&ae.length&&I.push(ae)}I.push(null)}),L.on("data",function(ae){b("wrapped data"),Z.decoder&&(ae=Z.decoder.write(ae)),Z.objectMode&&ae==null||(Z.objectMode||ae&&ae.length)&&(I.push(ae)||(K=!0,L.pause()))}),L)this[re]===void 0&&typeof L[re]=="function"&&(this[re]=function(ae){return function(){return L[ae].apply(L,arguments)}}(re));for(var G=0;G<E.length;G++)L.on(E[G],this.emit.bind(this,E[G]));return this._read=function(ae){b("wrapped _read",ae),K&&(K=!1,L.resume())},this},Object.defineProperty(F.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),F._fromList=S}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(e,a,n){a.exports=u;var i=e("./_stream_duplex"),c=Object.create(e("core-util-is"));function l(g,p){var h=this._transformState;h.transforming=!1;var f=h.writecb;if(!f)return this.emit("error",new Error("write callback called multiple times"));h.writechunk=null,h.writecb=null,p!=null&&this.push(p),f(g);var x=this._readableState;x.reading=!1,(x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}function u(g){if(!(this instanceof u))return new u(g);i.call(this,g),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,g&&(typeof g.transform=="function"&&(this._transform=g.transform),typeof g.flush=="function"&&(this._flush=g.flush)),this.on("prefinish",o)}function o(){var g=this;typeof this._flush=="function"?this._flush(function(p,h){d(g,p,h)}):d(this,null,null)}function d(g,p,h){if(p)return g.emit("error",p);if(h!=null&&g.push(h),g._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(g._transformState.transforming)throw new Error("Calling transform done when still transforming");return g.push(null)}c.inherits=e("inherits"),c.inherits(u,i),u.prototype.push=function(g,p){return this._transformState.needTransform=!1,i.prototype.push.call(this,g,p)},u.prototype._transform=function(g,p,h){throw new Error("_transform() is not implemented")},u.prototype._write=function(g,p,h){var f=this._transformState;if(f.writecb=h,f.writechunk=g,f.writeencoding=p,!f.transforming){var x=this._readableState;(f.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}},u.prototype._read=function(g){var p=this._transformState;p.writechunk!==null&&p.writecb&&!p.transforming?(p.transforming=!0,this._transform(p.writechunk,p.writeencoding,p.afterTransform)):p.needTransform=!0},u.prototype._destroy=function(g,p){var h=this;i.prototype._destroy.call(this,g,function(f){p(f),h.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(e,a,n){(function(i,c,l){(function(){var u=e("process-nextick-args");function o(q){var M=this;this.next=null,this.entry=null,this.finish=function(){(function(D,T,C){var S=D.entry;for(D.entry=null;S;){var w=S.callback;T.pendingcb--,w(C),S=S.next}T.corkedRequestsFree.next=D})(M,q)}}a.exports=O;var d,g=!i.browser&&["v0.10","v0.9."].indexOf(i.version.slice(0,5))>-1?l:u.nextTick;O.WritableState=E;var p=Object.create(e("core-util-is"));p.inherits=e("inherits");var h={deprecate:e("util-deprecate")},f=e("./internal/streams/stream"),x=e("safe-buffer").Buffer,b=(c!==void 0?c:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v,_=e("./internal/streams/destroy");function N(){}function E(q,M){d=d||e("./_stream_duplex"),q=q||{};var D=M instanceof d;this.objectMode=!!q.objectMode,D&&(this.objectMode=this.objectMode||!!q.writableObjectMode);var T=q.highWaterMark,C=q.writableHighWaterMark,S=this.objectMode?16:16384;this.highWaterMark=T||T===0?T:D&&(C||C===0)?C:S,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var w=q.decodeStrings===!1;this.decodeStrings=!w,this.defaultEncoding=q.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(j){(function(A,L){var I=A._writableState,Z=I.sync,K=I.writecb;if(function(G){G.writing=!1,G.writecb=null,G.length-=G.writelen,G.writelen=0}(I),L)(function(G,ae,V,H,Q){--ae.pendingcb,V?(u.nextTick(Q,H),u.nextTick(Y,G,ae),G._writableState.errorEmitted=!0,G.emit("error",H)):(Q(H),G._writableState.errorEmitted=!0,G.emit("error",H),Y(G,ae))})(A,I,Z,L,K);else{var re=U(I);re||I.corked||I.bufferProcessing||!I.bufferedRequest||P(A,I),Z?g(z,A,I,re,K):z(A,I,re,K)}})(M,j)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function O(q){if(d=d||e("./_stream_duplex"),!(v.call(O,this)||this instanceof d))return new O(q);this._writableState=new E(q,this),this.writable=!0,q&&(typeof q.write=="function"&&(this._write=q.write),typeof q.writev=="function"&&(this._writev=q.writev),typeof q.destroy=="function"&&(this._destroy=q.destroy),typeof q.final=="function"&&(this._final=q.final)),f.call(this)}function F(q,M,D,T,C,S,w){M.writelen=T,M.writecb=w,M.writing=!0,M.sync=!0,D?q._writev(C,M.onwrite):q._write(C,S,M.onwrite),M.sync=!1}function z(q,M,D,T){D||function(C,S){S.length===0&&S.needDrain&&(S.needDrain=!1,C.emit("drain"))}(q,M),M.pendingcb--,T(),Y(q,M)}function P(q,M){M.bufferProcessing=!0;var D=M.bufferedRequest;if(q._writev&&D&&D.next){var T=M.bufferedRequestCount,C=new Array(T),S=M.corkedRequestsFree;S.entry=D;for(var w=0,j=!0;D;)C[w]=D,D.isBuf||(j=!1),D=D.next,w+=1;C.allBuffers=j,F(q,M,!0,M.length,C,"",S.finish),M.pendingcb++,M.lastBufferedRequest=null,S.next?(M.corkedRequestsFree=S.next,S.next=null):M.corkedRequestsFree=new o(M),M.bufferedRequestCount=0}else{for(;D;){var A=D.chunk,L=D.encoding,I=D.callback;if(F(q,M,!1,M.objectMode?1:A.length,A,L,I),D=D.next,M.bufferedRequestCount--,M.writing)break}D===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=D,M.bufferProcessing=!1}function U(q){return q.ending&&q.length===0&&q.bufferedRequest===null&&!q.finished&&!q.writing}function W(q,M){q._final(function(D){M.pendingcb--,D&&q.emit("error",D),M.prefinished=!0,q.emit("prefinish"),Y(q,M)})}function Y(q,M){var D=U(M);return D&&(function(T,C){C.prefinished||C.finalCalled||(typeof T._final=="function"?(C.pendingcb++,C.finalCalled=!0,u.nextTick(W,T,C)):(C.prefinished=!0,T.emit("prefinish")))}(q,M),M.pendingcb===0&&(M.finished=!0,q.emit("finish"))),D}p.inherits(O,f),E.prototype.getBuffer=function(){for(var q=this.bufferedRequest,M=[];q;)M.push(q),q=q.next;return M},function(){try{Object.defineProperty(E.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(q){return!!v.call(this,q)||this===O&&q&&q._writableState instanceof E}})):v=function(q){return q instanceof this},O.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},O.prototype.write=function(q,M,D){var T,C=this._writableState,S=!1,w=!C.objectMode&&(T=q,x.isBuffer(T)||T instanceof b);return w&&!x.isBuffer(q)&&(q=function(j){return x.from(j)}(q)),typeof M=="function"&&(D=M,M=null),w?M="buffer":M||(M=C.defaultEncoding),typeof D!="function"&&(D=N),C.ended?function(j,A){var L=new Error("write after end");j.emit("error",L),u.nextTick(A,L)}(this,D):(w||function(j,A,L,I){var Z=!0,K=!1;return L===null?K=new TypeError("May not write null values to stream"):typeof L=="string"||L===void 0||A.objectMode||(K=new TypeError("Invalid non-string/buffer chunk")),K&&(j.emit("error",K),u.nextTick(I,K),Z=!1),Z}(this,C,q,D))&&(C.pendingcb++,S=function(j,A,L,I,Z,K){if(!L){var re=function(H,Q,oe){return H.objectMode||H.decodeStrings===!1||typeof Q!="string"||(Q=x.from(Q,oe)),Q}(A,I,Z);I!==re&&(L=!0,Z="buffer",I=re)}var G=A.objectMode?1:I.length;A.length+=G;var ae=A.length<A.highWaterMark;if(ae||(A.needDrain=!0),A.writing||A.corked){var V=A.lastBufferedRequest;A.lastBufferedRequest={chunk:I,encoding:Z,isBuf:L,callback:K,next:null},V?V.next=A.lastBufferedRequest:A.bufferedRequest=A.lastBufferedRequest,A.bufferedRequestCount+=1}else F(j,A,!1,G,I,Z,K);return ae}(this,C,w,q,M,D)),S},O.prototype.cork=function(){this._writableState.corked++},O.prototype.uncork=function(){var q=this._writableState;q.corked&&(q.corked--,q.writing||q.corked||q.bufferProcessing||!q.bufferedRequest||P(this,q))},O.prototype.setDefaultEncoding=function(q){if(typeof q=="string"&&(q=q.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((q+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+q);return this._writableState.defaultEncoding=q,this},Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),O.prototype._write=function(q,M,D){D(new Error("_write() is not implemented"))},O.prototype._writev=null,O.prototype.end=function(q,M,D){var T=this._writableState;typeof q=="function"?(D=q,q=null,M=null):typeof M=="function"&&(D=M,M=null),q!=null&&this.write(q,M),T.corked&&(T.corked=1,this.uncork()),T.ending||function(C,S,w){S.ending=!0,Y(C,S),w&&(S.finished?u.nextTick(w):C.once("finish",w)),S.ended=!0,C.writable=!1}(this,T,D)},Object.defineProperty(O.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(q){this._writableState&&(this._writableState.destroyed=q)}}),O.prototype.destroy=_.destroy,O.prototype._undestroy=_.undestroy,O.prototype._destroy=function(q,M){this.end(),M(q)}}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(e,a,n){var i=e("safe-buffer").Buffer,c=e("util");a.exports=function(){function l(){(function(u,o){if(!(u instanceof o))throw new TypeError("Cannot call a class as a function")})(this,l),this.head=null,this.tail=null,this.length=0}return l.prototype.push=function(u){var o={data:u,next:null};this.length>0?this.tail.next=o:this.head=o,this.tail=o,++this.length},l.prototype.unshift=function(u){var o={data:u,next:this.head};this.length===0&&(this.tail=o),this.head=o,++this.length},l.prototype.shift=function(){if(this.length!==0){var u=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,u}},l.prototype.clear=function(){this.head=this.tail=null,this.length=0},l.prototype.join=function(u){if(this.length===0)return"";for(var o=this.head,d=""+o.data;o=o.next;)d+=u+o.data;return d},l.prototype.concat=function(u){if(this.length===0)return i.alloc(0);for(var o,d,g,p=i.allocUnsafe(u>>>0),h=this.head,f=0;h;)o=h.data,d=p,g=f,o.copy(d,g),f+=h.data.length,h=h.next;return p},l}(),c&&c.inspect&&c.inspect.custom&&(a.exports.prototype[c.inspect.custom]=function(){var l=c.inspect({length:this.length});return this.constructor.name+" "+l})},{"safe-buffer":520,util:188}],514:[function(e,a,n){var i=e("process-nextick-args");function c(l,u){l.emit("error",u)}a.exports={destroy:function(l,u){var o=this,d=this._readableState&&this._readableState.destroyed,g=this._writableState&&this._writableState.destroyed;return d||g?(u?u(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(c,this,l)):i.nextTick(c,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(p){!u&&p?o._writableState?o._writableState.errorEmitted||(o._writableState.errorEmitted=!0,i.nextTick(c,o,p)):i.nextTick(c,o,p):u&&u(p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,a,n){arguments[4][490][0].apply(n,arguments)},{dup:490,events:422}],516:[function(e,a,n){a.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,a,n){(n=a.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,a,n){a.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,a,n){a.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,a,n){arguments[4][217][0].apply(n,arguments)},{buffer:220,dup:217}],521:[function(e,a,n){arguments[4][218][0].apply(n,arguments)},{dup:218,"safe-buffer":520}],522:[function(e,a,n){arguments[4][218][0].apply(n,arguments)},{dup:218,"safe-buffer":494}],523:[function(e,a,n){(function(i,c){(function(){var l=e("process/browser.js").nextTick,u=Function.prototype.apply,o=Array.prototype.slice,d={},g=0;function p(h,f){this._id=h,this._clearFn=f}n.setTimeout=function(){return new p(u.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new p(u.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(h){h.close()},p.prototype.unref=p.prototype.ref=function(){},p.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(h,f){clearTimeout(h._idleTimeoutId),h._idleTimeout=f},n.unenroll=function(h){clearTimeout(h._idleTimeoutId),h._idleTimeout=-1},n._unrefActive=n.active=function(h){clearTimeout(h._idleTimeoutId);var f=h._idleTimeout;f>=0&&(h._idleTimeoutId=setTimeout(function(){h._onTimeout&&h._onTimeout()},f))},n.setImmediate=typeof i=="function"?i:function(h){var f=g++,x=!(arguments.length<2)&&o.call(arguments,1);return d[f]=!0,l(function(){d[f]&&(x?h.apply(null,x):h.call(null),n.clearImmediate(f))}),f},n.clearImmediate=typeof c=="function"?c:function(h){delete d[h]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(e,a,n){(function(i){(function(){function c(l){try{if(!i.localStorage)return!1}catch{return!1}var u=i.localStorage[l];return u!=null&&String(u).toLowerCase()==="true"}a.exports=function(l,u){if(c("noDeprecation"))return l;var o=!1;return function(){if(!o){if(c("throwDeprecation"))throw new Error(u);c("traceDeprecation")?console.trace(u):console.warn(u),o=!0}return l.apply(this,arguments)}}}).call(this)}).call(this,typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(e,a,n){typeof Object.create=="function"?a.exports=function(i,c){i.super_=c,i.prototype=Object.create(c.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,c){i.super_=c;var l=function(){};l.prototype=c.prototype,i.prototype=new l,i.prototype.constructor=i}},{}],526:[function(e,a,n){a.exports=function(i){return i&&typeof i=="object"&&typeof i.copy=="function"&&typeof i.fill=="function"&&typeof i.readUInt8=="function"}},{}],527:[function(e,a,n){(function(i,c){(function(){var l=/%[sdj%]/g;n.format=function(C){if(!E(C)){for(var S=[],w=0;w<arguments.length;w++)S.push(d(arguments[w]));return S.join(" ")}w=1;for(var j=arguments,A=j.length,L=String(C).replace(l,function(Z){if(Z==="%%")return"%";if(w>=A)return Z;switch(Z){case"%s":return String(j[w++]);case"%d":return Number(j[w++]);case"%j":try{return JSON.stringify(j[w++])}catch{return"[Circular]"}default:return Z}}),I=j[w];w<A;I=j[++w])_(I)||!z(I)?L+=" "+I:L+=" "+d(I);return L},n.deprecate=function(C,S){if(O(c.process))return function(){return n.deprecate(C,S).apply(this,arguments)};if(i.noDeprecation===!0)return C;var w=!1;return function(){if(!w){if(i.throwDeprecation)throw new Error(S);i.traceDeprecation?console.trace(S):console.error(S),w=!0}return C.apply(this,arguments)}};var u,o={};function d(C,S){var w={seen:[],stylize:p};return arguments.length>=3&&(w.depth=arguments[2]),arguments.length>=4&&(w.colors=arguments[3]),v(S)?w.showHidden=S:S&&n._extend(w,S),O(w.showHidden)&&(w.showHidden=!1),O(w.depth)&&(w.depth=2),O(w.colors)&&(w.colors=!1),O(w.customInspect)&&(w.customInspect=!0),w.colors&&(w.stylize=g),h(w,C,w.depth)}function g(C,S){var w=d.styles[S];return w?"\x1B["+d.colors[w][0]+"m"+C+"\x1B["+d.colors[w][1]+"m":C}function p(C,S){return C}function h(C,S,w){if(C.customInspect&&S&&W(S.inspect)&&S.inspect!==n.inspect&&(!S.constructor||S.constructor.prototype!==S)){var j=S.inspect(w,C);return E(j)||(j=h(C,j,w)),j}var A=function(V,H){if(O(H))return V.stylize("undefined","undefined");if(E(H)){var Q="'"+JSON.stringify(H).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return V.stylize(Q,"string")}if(N(H))return V.stylize(""+H,"number");if(v(H))return V.stylize(""+H,"boolean");if(_(H))return V.stylize("null","null")}(C,S);if(A)return A;var L=Object.keys(S),I=function(V){var H={};return V.forEach(function(Q,oe){H[Q]=!0}),H}(L);if(C.showHidden&&(L=Object.getOwnPropertyNames(S)),U(S)&&(L.indexOf("message")>=0||L.indexOf("description")>=0))return f(S);if(L.length===0){if(W(S)){var Z=S.name?": "+S.name:"";return C.stylize("[Function"+Z+"]","special")}if(F(S))return C.stylize(RegExp.prototype.toString.call(S),"regexp");if(P(S))return C.stylize(Date.prototype.toString.call(S),"date");if(U(S))return f(S)}var K,re="",G=!1,ae=["{","}"];return b(S)&&(G=!0,ae=["[","]"]),W(S)&&(re=" [Function"+(S.name?": "+S.name:"")+"]"),F(S)&&(re=" "+RegExp.prototype.toString.call(S)),P(S)&&(re=" "+Date.prototype.toUTCString.call(S)),U(S)&&(re=" "+f(S)),L.length!==0||G&&S.length!=0?w<0?F(S)?C.stylize(RegExp.prototype.toString.call(S),"regexp"):C.stylize("[Object]","special"):(C.seen.push(S),K=G?function(V,H,Q,oe,se){for(var le=[],he=0,Ne=H.length;he<Ne;++he)T(H,String(he))?le.push(x(V,H,Q,oe,String(he),!0)):le.push("");return se.forEach(function(we){we.match(/^\d+$/)||le.push(x(V,H,Q,oe,we,!0))}),le}(C,S,w,I,L):L.map(function(V){return x(C,S,w,I,V,G)}),C.seen.pop(),function(V,H,Q){return V.reduce(function(oe,se){return se.indexOf(`
`)>=0,oe+se.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?Q[0]+(H===""?"":H+`
 `)+" "+V.join(`,
  `)+" "+Q[1]:Q[0]+H+" "+V.join(", ")+" "+Q[1]}(K,re,ae)):ae[0]+re+ae[1]}function f(C){return"["+Error.prototype.toString.call(C)+"]"}function x(C,S,w,j,A,L){var I,Z,K;if((K=Object.getOwnPropertyDescriptor(S,A)||{value:S[A]}).get?Z=K.set?C.stylize("[Getter/Setter]","special"):C.stylize("[Getter]","special"):K.set&&(Z=C.stylize("[Setter]","special")),T(j,A)||(I="["+A+"]"),Z||(C.seen.indexOf(K.value)<0?(Z=_(w)?h(C,K.value,null):h(C,K.value,w-1)).indexOf(`
`)>-1&&(Z=L?Z.split(`
`).map(function(re){return"  "+re}).join(`
`).substr(2):`
`+Z.split(`
`).map(function(re){return"   "+re}).join(`
`)):Z=C.stylize("[Circular]","special")),O(I)){if(L&&A.match(/^\d+$/))return Z;(I=JSON.stringify(""+A)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(I=I.substr(1,I.length-2),I=C.stylize(I,"name")):(I=I.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),I=C.stylize(I,"string"))}return I+": "+Z}function b(C){return Array.isArray(C)}function v(C){return typeof C=="boolean"}function _(C){return C===null}function N(C){return typeof C=="number"}function E(C){return typeof C=="string"}function O(C){return C===void 0}function F(C){return z(C)&&Y(C)==="[object RegExp]"}function z(C){return typeof C=="object"&&C!==null}function P(C){return z(C)&&Y(C)==="[object Date]"}function U(C){return z(C)&&(Y(C)==="[object Error]"||C instanceof Error)}function W(C){return typeof C=="function"}function Y(C){return Object.prototype.toString.call(C)}function q(C){return C<10?"0"+C.toString(10):C.toString(10)}n.debuglog=function(C){if(O(u)&&(u=i.env.NODE_DEBUG||""),C=C.toUpperCase(),!o[C])if(new RegExp("\\b"+C+"\\b","i").test(u)){var S=i.pid;o[C]=function(){var w=n.format.apply(n,arguments);console.error("%s %d: %s",C,S,w)}}else o[C]=function(){};return o[C]},n.inspect=d,d.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},d.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=b,n.isBoolean=v,n.isNull=_,n.isNullOrUndefined=function(C){return C==null},n.isNumber=N,n.isString=E,n.isSymbol=function(C){return typeof C=="symbol"},n.isUndefined=O,n.isRegExp=F,n.isObject=z,n.isDate=P,n.isError=U,n.isFunction=W,n.isPrimitive=function(C){return C===null||typeof C=="boolean"||typeof C=="number"||typeof C=="string"||typeof C=="symbol"||C===void 0},n.isBuffer=e("./support/isBuffer");var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function D(){var C=new Date,S=[q(C.getHours()),q(C.getMinutes()),q(C.getSeconds())].join(":");return[C.getDate(),M[C.getMonth()],S].join(" ")}function T(C,S){return Object.prototype.hasOwnProperty.call(C,S)}n.log=function(){console.log("%s - %s",D(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(C,S){if(!S||!z(S))return C;for(var w=Object.keys(S),j=w.length;j--;)C[w[j]]=S[w[j]];return C}}).call(this)}).call(this,e("_process"),typeof nr<"u"?nr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"v1",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"v3",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"v4",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"v5",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"NIL",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(n,"validate",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return h.default}});var i=f(e("./v1.js")),c=f(e("./v3.js")),l=f(e("./v4.js")),u=f(e("./v5.js")),o=f(e("./nil.js")),d=f(e("./version.js")),g=f(e("./validate.js")),p=f(e("./stringify.js")),h=f(e("./parse.js"));function f(x){return x&&x.__esModule?x:{default:x}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(e,a,n){function i(h){return 14+(h+64>>>9<<4)+1}function c(h,f){const x=(65535&h)+(65535&f);return(h>>16)+(f>>16)+(x>>16)<<16|65535&x}function l(h,f,x,b,v,_){return c((N=c(c(f,h),c(b,_)))<<(E=v)|N>>>32-E,x);var N,E}function u(h,f,x,b,v,_,N){return l(f&x|~f&b,h,f,v,_,N)}function o(h,f,x,b,v,_,N){return l(f&b|x&~b,h,f,v,_,N)}function d(h,f,x,b,v,_,N){return l(f^x^b,h,f,v,_,N)}function g(h,f,x,b,v,_,N){return l(x^(f|~b),h,f,v,_,N)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var p=function(h){if(typeof h=="string"){const f=unescape(encodeURIComponent(h));h=new Uint8Array(f.length);for(let x=0;x<f.length;++x)h[x]=f.charCodeAt(x)}return function(f){const x=[],b=32*f.length;for(let v=0;v<b;v+=8){const _=f[v>>5]>>>v%32&255,N=parseInt("0123456789abcdef".charAt(_>>>4&15)+"0123456789abcdef".charAt(15&_),16);x.push(N)}return x}(function(f,x){f[x>>5]|=128<<x%32,f[i(x)-1]=x;let b=1732584193,v=-271733879,_=-1732584194,N=271733878;for(let E=0;E<f.length;E+=16){const O=b,F=v,z=_,P=N;b=u(b,v,_,N,f[E],7,-680876936),N=u(N,b,v,_,f[E+1],12,-389564586),_=u(_,N,b,v,f[E+2],17,606105819),v=u(v,_,N,b,f[E+3],22,-1044525330),b=u(b,v,_,N,f[E+4],7,-176418897),N=u(N,b,v,_,f[E+5],12,1200080426),_=u(_,N,b,v,f[E+6],17,-1473231341),v=u(v,_,N,b,f[E+7],22,-45705983),b=u(b,v,_,N,f[E+8],7,1770035416),N=u(N,b,v,_,f[E+9],12,-1958414417),_=u(_,N,b,v,f[E+10],17,-42063),v=u(v,_,N,b,f[E+11],22,-1990404162),b=u(b,v,_,N,f[E+12],7,1804603682),N=u(N,b,v,_,f[E+13],12,-40341101),_=u(_,N,b,v,f[E+14],17,-1502002290),v=u(v,_,N,b,f[E+15],22,1236535329),b=o(b,v,_,N,f[E+1],5,-165796510),N=o(N,b,v,_,f[E+6],9,-1069501632),_=o(_,N,b,v,f[E+11],14,643717713),v=o(v,_,N,b,f[E],20,-373897302),b=o(b,v,_,N,f[E+5],5,-701558691),N=o(N,b,v,_,f[E+10],9,38016083),_=o(_,N,b,v,f[E+15],14,-660478335),v=o(v,_,N,b,f[E+4],20,-405537848),b=o(b,v,_,N,f[E+9],5,568446438),N=o(N,b,v,_,f[E+14],9,-1019803690),_=o(_,N,b,v,f[E+3],14,-187363961),v=o(v,_,N,b,f[E+8],20,1163531501),b=o(b,v,_,N,f[E+13],5,-1444681467),N=o(N,b,v,_,f[E+2],9,-51403784),_=o(_,N,b,v,f[E+7],14,1735328473),v=o(v,_,N,b,f[E+12],20,-1926607734),b=d(b,v,_,N,f[E+5],4,-378558),N=d(N,b,v,_,f[E+8],11,-2022574463),_=d(_,N,b,v,f[E+11],16,1839030562),v=d(v,_,N,b,f[E+14],23,-35309556),b=d(b,v,_,N,f[E+1],4,-1530992060),N=d(N,b,v,_,f[E+4],11,1272893353),_=d(_,N,b,v,f[E+7],16,-155497632),v=d(v,_,N,b,f[E+10],23,-1094730640),b=d(b,v,_,N,f[E+13],4,681279174),N=d(N,b,v,_,f[E],11,-358537222),_=d(_,N,b,v,f[E+3],16,-722521979),v=d(v,_,N,b,f[E+6],23,76029189),b=d(b,v,_,N,f[E+9],4,-640364487),N=d(N,b,v,_,f[E+12],11,-421815835),_=d(_,N,b,v,f[E+15],16,530742520),v=d(v,_,N,b,f[E+2],23,-995338651),b=g(b,v,_,N,f[E],6,-198630844),N=g(N,b,v,_,f[E+7],10,1126891415),_=g(_,N,b,v,f[E+14],15,-1416354905),v=g(v,_,N,b,f[E+5],21,-57434055),b=g(b,v,_,N,f[E+12],6,1700485571),N=g(N,b,v,_,f[E+3],10,-1894986606),_=g(_,N,b,v,f[E+10],15,-1051523),v=g(v,_,N,b,f[E+1],21,-2054922799),b=g(b,v,_,N,f[E+8],6,1873313359),N=g(N,b,v,_,f[E+15],10,-30611744),_=g(_,N,b,v,f[E+6],15,-1560198380),v=g(v,_,N,b,f[E+13],21,1309151649),b=g(b,v,_,N,f[E+4],6,-145523070),N=g(N,b,v,_,f[E+11],10,-1120210379),_=g(_,N,b,v,f[E+2],15,718787259),v=g(v,_,N,b,f[E+9],21,-343485551),b=c(b,O),v=c(v,F),_=c(_,z),N=c(N,P)}return[b,v,_,N]}(function(f){if(f.length===0)return[];const x=8*f.length,b=new Uint32Array(i(x));for(let v=0;v<x;v+=8)b[v>>5]|=(255&f[v/8])<<v%32;return b}(h),8*h.length))};n.default=p},{}],530:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,n.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,c=(i=e("./validate.js"))&&i.__esModule?i:{default:i},l=function(u){if(!(0,c.default)(u))throw TypeError("Invalid UUID");let o;const d=new Uint8Array(16);return d[0]=(o=parseInt(u.slice(0,8),16))>>>24,d[1]=o>>>16&255,d[2]=o>>>8&255,d[3]=255&o,d[4]=(o=parseInt(u.slice(9,13),16))>>>8,d[5]=255&o,d[6]=(o=parseInt(u.slice(14,18),16))>>>8,d[7]=255&o,d[8]=(o=parseInt(u.slice(19,23),16))>>>8,d[9]=255&o,d[10]=(o=parseInt(u.slice(24,36),16))/1099511627776&255,d[11]=o/4294967296&255,d[12]=o>>>24&255,d[13]=o>>>16&255,d[14]=o>>>8&255,d[15]=255&o,d};n.default=l},{"./validate.js":541}],532:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,n.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(e,a,n){let i;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){if(!i&&(i=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(c)};const c=new Uint8Array(16)},{}],534:[function(e,a,n){function i(u,o,d,g){switch(u){case 0:return o&d^~o&g;case 1:return o^d^g;case 2:return o&d^o&g^d&g;case 3:return o^d^g}}function c(u,o){return u<<o|u>>>32-o}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var l=function(u){const o=[1518500249,1859775393,2400959708,3395469782],d=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof u=="string"){const f=unescape(encodeURIComponent(u));u=[];for(let x=0;x<f.length;++x)u.push(f.charCodeAt(x))}else Array.isArray(u)||(u=Array.prototype.slice.call(u));u.push(128);const g=u.length/4+2,p=Math.ceil(g/16),h=new Array(p);for(let f=0;f<p;++f){const x=new Uint32Array(16);for(let b=0;b<16;++b)x[b]=u[64*f+4*b]<<24|u[64*f+4*b+1]<<16|u[64*f+4*b+2]<<8|u[64*f+4*b+3];h[f]=x}h[p-1][14]=8*(u.length-1)/Math.pow(2,32),h[p-1][14]=Math.floor(h[p-1][14]),h[p-1][15]=8*(u.length-1)&4294967295;for(let f=0;f<p;++f){const x=new Uint32Array(80);for(let O=0;O<16;++O)x[O]=h[f][O];for(let O=16;O<80;++O)x[O]=c(x[O-3]^x[O-8]^x[O-14]^x[O-16],1);let b=d[0],v=d[1],_=d[2],N=d[3],E=d[4];for(let O=0;O<80;++O){const F=Math.floor(O/20),z=c(b,5)+i(F,v,_,N)+E+o[F]+x[O]>>>0;E=N,N=_,_=c(v,30)>>>0,v=b,b=z}d[0]=d[0]+b>>>0,d[1]=d[1]+v>>>0,d[2]=d[2]+_>>>0,d[3]=d[3]+N>>>0,d[4]=d[4]+E>>>0}return[d[0]>>24&255,d[0]>>16&255,d[0]>>8&255,255&d[0],d[1]>>24&255,d[1]>>16&255,d[1]>>8&255,255&d[1],d[2]>>24&255,d[2]>>16&255,d[2]>>8&255,255&d[2],d[3]>>24&255,d[3]>>16&255,d[3]>>8&255,255&d[3],d[4]>>24&255,d[4]>>16&255,d[4]>>8&255,255&d[4]]};n.default=l},{}],535:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,c=(i=e("./validate.js"))&&i.__esModule?i:{default:i};const l=[];for(let o=0;o<256;++o)l.push((o+256).toString(16).substr(1));var u=function(o){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const g=(l[o[d+0]]+l[o[d+1]]+l[o[d+2]]+l[o[d+3]]+"-"+l[o[d+4]]+l[o[d+5]]+"-"+l[o[d+6]]+l[o[d+7]]+"-"+l[o[d+8]]+l[o[d+9]]+"-"+l[o[d+10]]+l[o[d+11]]+l[o[d+12]]+l[o[d+13]]+l[o[d+14]]+l[o[d+15]]).toLowerCase();if(!(0,c.default)(g))throw TypeError("Stringified UUID is invalid");return g};n.default=u},{"./validate.js":541}],536:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=l(e("./rng.js")),c=l(e("./stringify.js"));function l(h){return h&&h.__esModule?h:{default:h}}let u,o,d=0,g=0;var p=function(h,f,x){let b=f&&x||0;const v=f||new Array(16);let _=(h=h||{}).node||u,N=h.clockseq!==void 0?h.clockseq:o;if(_==null||N==null){const U=h.random||(h.rng||i.default)();_==null&&(_=u=[1|U[0],U[1],U[2],U[3],U[4],U[5]]),N==null&&(N=o=16383&(U[6]<<8|U[7]))}let E=h.msecs!==void 0?h.msecs:Date.now(),O=h.nsecs!==void 0?h.nsecs:g+1;const F=E-d+(O-g)/1e4;if(F<0&&h.clockseq===void 0&&(N=N+1&16383),(F<0||E>d)&&h.nsecs===void 0&&(O=0),O>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=E,g=O,o=N,E+=122192928e5;const z=(1e4*(268435455&E)+O)%4294967296;v[b++]=z>>>24&255,v[b++]=z>>>16&255,v[b++]=z>>>8&255,v[b++]=255&z;const P=E/4294967296*1e4&268435455;v[b++]=P>>>8&255,v[b++]=255&P,v[b++]=P>>>24&15|16,v[b++]=P>>>16&255,v[b++]=N>>>8|128,v[b++]=255&N;for(let U=0;U<6;++U)v[b+U]=_[U];return f||(0,c.default)(v)};n.default=p},{"./rng.js":533,"./stringify.js":535}],537:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=l(e("./v35.js")),c=l(e("./md5.js"));function l(o){return o&&o.__esModule?o:{default:o}}var u=(0,i.default)("v3",48,c.default);n.default=u},{"./md5.js":529,"./v35.js":538}],538:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(d,g,p){function h(f,x,b,v){if(typeof f=="string"&&(f=function(N){N=unescape(encodeURIComponent(N));const E=[];for(let O=0;O<N.length;++O)E.push(N.charCodeAt(O));return E}(f)),typeof x=="string"&&(x=(0,c.default)(x)),x.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let _=new Uint8Array(16+f.length);if(_.set(x),_.set(f,x.length),_=p(_),_[6]=15&_[6]|g,_[8]=63&_[8]|128,b){v=v||0;for(let N=0;N<16;++N)b[v+N]=_[N];return b}return(0,i.default)(_)}try{h.name=d}catch{}return h.DNS=u,h.URL=o,h},n.URL=n.DNS=void 0;var i=l(e("./stringify.js")),c=l(e("./parse.js"));function l(d){return d&&d.__esModule?d:{default:d}}const u="6ba7b810-9dad-11d1-80b4-00c04fd430c8";n.DNS=u;const o="6ba7b811-9dad-11d1-80b4-00c04fd430c8";n.URL=o},{"./parse.js":531,"./stringify.js":535}],539:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=l(e("./rng.js")),c=l(e("./stringify.js"));function l(o){return o&&o.__esModule?o:{default:o}}var u=function(o,d,g){const p=(o=o||{}).random||(o.rng||i.default)();if(p[6]=15&p[6]|64,p[8]=63&p[8]|128,d){g=g||0;for(let h=0;h<16;++h)d[g+h]=p[h];return d}return(0,c.default)(p)};n.default=u},{"./rng.js":533,"./stringify.js":535}],540:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=l(e("./v35.js")),c=l(e("./sha1.js"));function l(o){return o&&o.__esModule?o:{default:o}}var u=(0,i.default)("v5",80,c.default);n.default=u},{"./sha1.js":534,"./v35.js":538}],541:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,c=(i=e("./regex.js"))&&i.__esModule?i:{default:i},l=function(u){return typeof u=="string"&&c.default.test(u)};n.default=l},{"./regex.js":532}],542:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,c=(i=e("./validate.js"))&&i.__esModule?i:{default:i},l=function(u){if(!(0,c.default)(u))throw TypeError("Invalid UUID");return parseInt(u.substr(14,1),16)};n.default=l},{"./validate.js":541}],543:[function(e,a,n){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(n,"__esModule",{value:!0}),n.CHAR=`	
\r ---`,n.S=` 	\r
`,n.NAME_START_CHAR=":A-Z_a-z-----------",n.NAME_CHAR="-"+n.NAME_START_CHAR+".0-9--",n.CHAR_RE=new RegExp("^["+n.CHAR+"]$","u"),n.S_RE=new RegExp("^["+n.S+"]+$","u"),n.NAME_START_CHAR_RE=new RegExp("^["+n.NAME_START_CHAR+"]$","u"),n.NAME_CHAR_RE=new RegExp("^["+n.NAME_CHAR+"]$","u"),n.NAME_RE=new RegExp("^["+n.NAME_START_CHAR+"]["+n.NAME_CHAR+"]*$","u"),n.NMTOKEN_RE=new RegExp("^["+n.NAME_CHAR+"]+$","u");function i(c){return c>=65&&c<=90||c>=97&&c<=122||c===58||c===95||c===8204||c===8205||c>=192&&c<=214||c>=216&&c<=246||c>=248&&c<=767||c>=880&&c<=893||c>=895&&c<=8191||c>=8304&&c<=8591||c>=11264&&c<=12271||c>=12289&&c<=55295||c>=63744&&c<=64975||c>=65008&&c<=65533||c>=65536&&c<=983039}n.S_LIST=[32,10,13,9],n.isChar=function(c){return c>=32&&c<=55295||c===10||c===13||c===9||c>=57344&&c<=65533||c>=65536&&c<=1114111},n.isS=function(c){return c===32||c===10||c===13||c===9},n.isNameStartChar=i,n.isNameChar=function(c){return i(c)||c>=48&&c<=57||c===45||c===46||c===183||c>=768&&c<=879||c>=8255&&c<=8256}},{}],544:[function(e,a,n){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(n,"__esModule",{value:!0}),n.CHAR="---",n.RESTRICTED_CHAR="-\b\v\f---",n.S=` 	\r
`,n.NAME_START_CHAR=":A-Z_a-z-----------",n.NAME_CHAR="-"+n.NAME_START_CHAR+".0-9--",n.CHAR_RE=new RegExp("^["+n.CHAR+"]$","u"),n.RESTRICTED_CHAR_RE=new RegExp("^["+n.RESTRICTED_CHAR+"]$","u"),n.S_RE=new RegExp("^["+n.S+"]+$","u"),n.NAME_START_CHAR_RE=new RegExp("^["+n.NAME_START_CHAR+"]$","u"),n.NAME_CHAR_RE=new RegExp("^["+n.NAME_CHAR+"]$","u"),n.NAME_RE=new RegExp("^["+n.NAME_START_CHAR+"]["+n.NAME_CHAR+"]*$","u"),n.NMTOKEN_RE=new RegExp("^["+n.NAME_CHAR+"]+$","u");function i(c){return c>=65&&c<=90||c>=97&&c<=122||c===58||c===95||c===8204||c===8205||c>=192&&c<=214||c>=216&&c<=246||c>=248&&c<=767||c>=880&&c<=893||c>=895&&c<=8191||c>=8304&&c<=8591||c>=11264&&c<=12271||c>=12289&&c<=55295||c>=63744&&c<=64975||c>=65008&&c<=65533||c>=65536&&c<=983039}n.S_LIST=[32,10,13,9],n.isChar=function(c){return c>=1&&c<=55295||c>=57344&&c<=65533||c>=65536&&c<=1114111},n.isRestrictedChar=function(c){return c>=1&&c<=8||c===11||c===12||c>=14&&c<=31||c>=127&&c<=132||c>=134&&c<=159},n.isCharAndNotRestricted=function(c){return c===9||c===10||c===13||c>31&&c<127||c===133||c>159&&c<=55295||c>=57344&&c<=65533||c>=65536&&c<=1114111},n.isS=function(c){return c===32||c===10||c===13||c===9},n.isNameStartChar=i,n.isNameChar=function(c){return i(c)||c>=48&&c<=57||c===45||c===46||c===183||c>=768&&c<=879||c>=8255&&c<=8256}},{}],545:[function(e,a,n){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function i(c){return c>=65&&c<=90||c===95||c>=97&&c<=122||c>=192&&c<=214||c>=216&&c<=246||c>=248&&c<=767||c>=880&&c<=893||c>=895&&c<=8191||c>=8204&&c<=8205||c>=8304&&c<=8591||c>=11264&&c<=12271||c>=12289&&c<=55295||c>=63744&&c<=64975||c>=65008&&c<=65533||c>=65536&&c<=983039}Object.defineProperty(n,"__esModule",{value:!0}),n.NC_NAME_START_CHAR="A-Z_a-z------------",n.NC_NAME_CHAR="-"+n.NC_NAME_START_CHAR+".0-9--",n.NC_NAME_START_CHAR_RE=new RegExp("^["+n.NC_NAME_START_CHAR+"]$","u"),n.NC_NAME_CHAR_RE=new RegExp("^["+n.NC_NAME_CHAR+"]$","u"),n.NC_NAME_RE=new RegExp("^["+n.NC_NAME_START_CHAR+"]["+n.NC_NAME_CHAR+"]*$","u"),n.isNCNameStartChar=i,n.isNCNameChar=function(c){return i(c)||c===45||c===46||c>=48&&c<=57||c===183||c>=768&&c<=879||c>=8255&&c<=8256}},{}]},{},[15])(15)})}(Rp)),Rp.exports}var LU=IU();const fd=Eg(LU);function PU(){var He,ct;const{SucDetailId:t}=Ko(),s=Aa(),e=qs(),a=((He=e.state)==null?void 0:He.heiName)||"Unknown Institution",n=((ct=e.state)==null?void 0:ct.heiUiid)||"Unknown Uiid",[i,c]=ne.useState([]),[l,u]=ne.useState([]),[o,d]=ne.useState(!0),[g,p]=ne.useState(""),[h,f]=ne.useState(null),[x,b]=ne.useState(!1),[v,_]=ne.useState(!1),[N,E]=ne.useState(!1),[O,F]=ne.useState(!1),[z,P]=ne.useState(!1),[U,W]=ne.useState(!1),[Y,q]=ne.useState(!1),[M,D]=ne.useState(""),[T,C]=ne.useState("ALL"),[S,w]=ne.useState(1),[j,A]=ne.useState(10);ne.useEffect(()=>{Z()},[]),ne.useEffect(()=>{let ie=i;M&&(ie=ie.filter(ee=>{var te,fe,_e,Te;return((te=ee.program_name)==null?void 0:te.toLowerCase().includes(M.toLowerCase()))||((fe=ee.program_code)==null?void 0:fe.toString().includes(M.toLowerCase()))||((_e=ee.major_name)==null?void 0:_e.toLowerCase().includes(M.toLowerCase()))||((Te=ee.aop_category)==null?void 0:Te.toLowerCase().includes(M.toLowerCase()))})),T!=="ALL"&&(ie=ie.filter(ee=>ee.program_type===T)),u(ie),w(1)},[i,M,T]);const L=ne.useMemo(()=>{const ie=(S-1)*j,ee=ie+j;return l.slice(ie,ee)},[l,S,j]),I=Math.ceil(l.length/j),Z=async()=>{if(!t){console.error("SucDetailId is undefined. Cannot fetch programs."),p("Invalid institution ID. Please check the URL or try again."),d(!1);return}d(!0),p("");try{const ie=await bt.get(`${Ct.API_URL}/suc-form-b/suc-detail/${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}}),ee=Array.isArray(ie.data)?ie.data:ie.data.data||[];c(ee),u(ee),console.log("Fetched programs:",ee)}catch(ie){console.error("Error fetching programs:",ie),p("Failed to load academic programs. Please try again.")}finally{d(!1)}},K=ne.useCallback(async()=>{try{q(!0),Ft.showConfirmation(`Do you want to export Form B for ${a}?`,async()=>{try{const ie=await fetch("/templates/Form-B-Themeplate.xlsx");if(!ie.ok)throw new Error(`HTTP error! Status: ${ie.status}`);const ee=await ie.arrayBuffer(),te=new fd.Workbook;await te.xlsx.load(ee);const fe=Mt=>{let Et=-1;return Mt.eachRow((_t,Tt)=>{let ut=!1;if(_t.eachCell(jt=>{if(jt.value&&String(jt.value).trim()==="START BELOW THIS ROW")return ut=!0,!1}),ut)return Et=Tt+1,!1}),Et!==-1?Et:11},_e=i.reduce((Mt,Et)=>{const _t=Et.program_type||"Unknown";return Mt[_t]||(Mt[_t]=[]),Mt[_t].push(Et),Mt},{}),Te=Object.keys(_e);if(Te.length===0)throw new Error("No programs found to export");let Ae=0,Fe=[];console.log("Available worksheets:",te.worksheets.map(Mt=>Mt.name));const st={Baccalaureate:"Baccalaureate",Masters:"Masters",Doctoral:"Doctoral","Post-Baccalaureate":"Post-Baccalaureate","Pre-Baccalaureate":"Pre-Baccalaureate",VocTech:"VocTech",Basic:"Basic"};Te.forEach(Mt=>{const Et=st[Mt];if(!Et){console.warn(`No sheet mapping found for program type: ${Mt}`),Fe.push(Mt);return}const _t=te.getWorksheet(Et);if(!_t){console.warn(`Worksheet "${Et}" not found in template`),Fe.push(Mt);return}console.log(`Found matching worksheet "${Et}" for program type "${Mt}"`);const Tt=fe(_t),ut=_t.rowCount;for(let Ke=Tt;Ke<=ut;Ke++)_t.getRow(Ke).eachCell({includeEmpty:!0},(St,et)=>{if(et<=45){if(St.formula||St.isPartOfSharedFormula)return;St.value=null}});_e[Mt].forEach((Ke,Vt)=>{const St=Tt+Vt,et=_t.getRow(St),ot=(At,Re)=>{!At.formula&&!At.isPartOfSharedFormula&&(At.value=Re)};ot(et.getCell(1),Vt+1),ot(et.getCell(2),Ke.program_name||null),ot(et.getCell(3),Ke.program_code||null),ot(et.getCell(4),Ke.major_name||null),ot(et.getCell(5),Ke.major_code||null),ot(et.getCell(6),Ke.aop_category||null),ot(et.getCell(7),Ke.aop_serial||null),ot(et.getCell(8),Ke.aop_year||null),ot(et.getCell(9),Ke.is_thesis_dissertation_required||null),ot(et.getCell(10),Ke.program_status||null),ot(et.getCell(11),Ke.calendar_use_code||null),ot(et.getCell(12),Ke.program_normal_length_in_years||0),ot(et.getCell(13),Ke.lab_units||0),ot(et.getCell(14),Ke.lecture_units||0),ot(et.getCell(16),Ke.tuition_per_unit||0),ot(et.getCell(17),Ke.program_fee||0),ot(et.getCell(18),Ke.new_students_freshmen_male||0),ot(et.getCell(19),Ke.new_students_freshmen_female||0),ot(et.getCell(20),Ke["1st_year_male"]||0),ot(et.getCell(21),Ke["1st_year_female"]||0),ot(et.getCell(22),Ke["2nd_year_male"]||0),ot(et.getCell(23),Ke["2nd_year_female"]||0),ot(et.getCell(24),Ke["3rd_year_male"]||0),ot(et.getCell(25),Ke["3rd_year_female"]||0),ot(et.getCell(26),Ke["4th_year_male"]||0),ot(et.getCell(27),Ke["4th_year_female"]||0),ot(et.getCell(28),Ke["5th_year_male"]||0),ot(et.getCell(29),Ke["5th_year_female"]||0),ot(et.getCell(30),Ke["6th_year_male"]||0),ot(et.getCell(31),Ke["6th_year_female"]||0),ot(et.getCell(32),Ke["7th_year_male"]||0),ot(et.getCell(33),Ke["7th_year_female"]||0),ot(et.getCell(37),Ke.lecture_units_actual||0),ot(et.getCell(38),Ke.laboratory_units_actual||0),ot(et.getCell(40),Ke.graduates_males||0),ot(et.getCell(41),Ke.graduates_females||0),ot(et.getCell(43),Ke.externally_funded_merit_scholars||0),ot(et.getCell(44),Ke.suc_funded_grantees||0),et.commit()}),Ae++}),console.log(`Export completed: ${Ae} sheets populated, ${Fe.length} program types skipped`),Fe.length>0&&console.log(`Skipped program types: ${Fe.join(", ")}`);const it=`${n}_${a.replace(/[^a-zA-Z0-9]/g,"_")}_FormB_${new Date().toISOString().split("T")[0]}.xlsx`,lt=await te.xlsx.writeBuffer(),yt=new Blob([lt],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),vt=window.URL.createObjectURL(yt),Nt=document.createElement("a");Nt.href=vt,Nt.download=it,document.body.appendChild(Nt),Nt.click(),document.body.removeChild(Nt),window.URL.revokeObjectURL(vt),Ft.showAlert(`Form B exported successfully. ${Ae} sheets populated${Fe.length>0?`, ${Fe.length} program types skipped (no matching sheets found)`:""}.`,"success"),q(!1)}catch(ie){console.error("Error exporting Form B:",ie),Ft.showAlert("Failed to export Form B. Please try again.","error"),q(!1)}},()=>{q(!1)})}catch(ie){console.error("Error in export function:",ie),q(!1)}},[i,a,n]),re=()=>{F(!0)},G=ie=>{f(ie),b(!0)},ae=ie=>{f(ie),E(!0)},V=()=>{_(!0)},H=async ie=>{var ee,te;P(!0);try{const fe=await bt.post(`${Ct.API_URL}/suc-form-b`,ie,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(fe.status===201){const _e=fe.data;c(Te=>[...Te,_e]),_(!1),Ft.showAlert("Program created successfully!","success"),console.log("Program created successfully:",_e)}}catch(fe){console.error("Error creating program:",fe),Ft.showAlert(((te=(ee=fe.response)==null?void 0:ee.data)==null?void 0:te.message)||"Failed to create program. Please try again.","error")}finally{P(!1)}},Q=async ie=>{var ee,te;W(!0);try{const fe=await bt.put(`${Ct.API_URL}/suc-form-b/${ie.id}`,ie,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(fe.status===200){const _e=fe.data;c(Te=>Te.map(Ae=>Ae.id===_e.id?_e:Ae)),E(!1),f(null),Ft.showAlert("Program updated successfully!","success"),console.log("Program updated successfully:",_e)}}catch(fe){console.error("Error updating program:",fe),Ft.showAlert(((te=(ee=fe.response)==null?void 0:ee.data)==null?void 0:te.message)||"Failed to update program. Please try again.","error")}finally{W(!1)}},oe=async ie=>{Ft.showConfirmation("Are you sure you want to delete this program?",async()=>{var ee,te;try{(await bt.delete(`${Ct.API_URL}/suc-form-b/${ie}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}})).status===200&&(c(_e=>_e.filter(Te=>Te.id!==ie)),Ft.showAlert("Program deleted successfully!","success"),console.log("Program deleted successfully."))}catch(fe){console.error("Error deleting program:",fe),Ft.showAlert(((te=(ee=fe.response)==null?void 0:ee.data)==null?void 0:te.message)||"Failed to delete program. Please try again.","error")}})},se=()=>{s("/super-admin/institutions/suc")},le=()=>{b(!1),f(null)},he=()=>{_(!1)},Ne=()=>{E(!1),f(null)},we=()=>{F(!1)},ue=ie=>ie?new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(ie):"0.00",Se=ie=>["1st_year_male","1st_year_female","2nd_year_male","2nd_year_female","3rd_year_male","3rd_year_female","4th_year_male","4th_year_female","5th_year_male","5th_year_female","6th_year_male","6th_year_female","7th_year_male","7th_year_female"].reduce((te,fe)=>te+(ie[fe]||0),0),ke=ie=>{switch(ie==null?void 0:ie.toLowerCase()){case"baccalaureate":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border-blue-300";case"masters":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border-purple-300";case"doctoral":return"bg-gradient-to-r from-emerald-100 to-emerald-200 text-emerald-800 border-emerald-300";case"post-baccalaureate":return"bg-gradient-to-r from-indigo-100 to-indigo-200 text-indigo-800 border-indigo-300";case"pre-baccalaureate":return"bg-gradient-to-r from-cyan-100 to-cyan-200 text-cyan-800 border-cyan-300";case"voctech":return"bg-gradient-to-r from-orange-100 to-orange-200 text-orange-800 border-orange-300";case"basic":return"bg-gradient-to-r from-teal-100 to-teal-200 text-teal-800 border-teal-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border-gray-300"}},Me=ie=>{w(ie)},Oe=ie=>{A(ie),w(1)},je=()=>{const ie=(S-1)*j+1,ee=Math.min(S*j,l.length);return{startIndex:ie,endIndex:ee}},{startIndex:Ie,endIndex:Pe}=je();return ne.useEffect(()=>{console.log("Institution Name:",a)},[a]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:se,className:"mr-4 p-2 text-gray-600 hover:text-gray-900 hover:bg-white/50 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Back to SUC List",children:r.jsx(Zo,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Academic Programs Management"}),r.jsxs("p",{className:"text-gray-600 flex items-center",children:[r.jsx(gr,{className:"w-4 h-4 mr-2"}),a]})]})]}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm mb-6",children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1 w-full xl:w-auto",children:[r.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search programs...",value:M,onChange:ie=>D(ie.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-60 lg:w-80 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm transition-all duration-200"})]}),r.jsxs("div",{className:"relative w-full sm:w-auto",children:[r.jsx(zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsxs("select",{value:T,onChange:ie=>{C(ie.target.value)},className:"pl-10 pr-8 py-2 w-full sm:w-auto border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm appearance-none cursor-pointer transition-all duration-200",children:[r.jsx("option",{value:"ALL",children:"All Types"}),r.jsx("option",{value:"Baccalaureate",children:"Baccalaureate"}),r.jsx("option",{value:"Masters",children:"Masters"}),r.jsx("option",{value:"Doctoral",children:"Doctoral"}),r.jsx("option",{value:"Post-Baccalaureate",children:"Post-Baccalaureate"}),r.jsx("option",{value:"Pre-Baccalaureate",children:"Pre-Baccalaureate"}),r.jsx("option",{value:"VocTech",children:"VocTech"}),r.jsx("option",{value:"Basic",children:"Basic"})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full xl:w-auto",children:[r.jsxs("button",{onClick:K,disabled:Y||i.length===0,className:"inline-flex items-center justify-center px-4 py-2 bg-white/50 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-white hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(oc,{className:"w-4 h-4 mr-2"}),Y?"Exporting...":"Export Form B"]}),r.jsxs("button",{onClick:re,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg text-sm font-medium hover:from-green-700 hover:to-green-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500",children:[r.jsx(Qr,{className:"w-4 h-4 mr-2"}),"Upload Excel"]}),r.jsxs("button",{onClick:V,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Program"]})]})]}),r.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Qo,{className:"w-4 h-4 mr-1"}),"Showing"," ",l.length>0?Ie:0," ","to ",Pe," of ",l.length," ","programs",l.length!==i.length&&r.jsxs("span",{className:"text-blue-600 ml-1",children:["(filtered from ",i.length," ","total)"]})]})})]})})]}),g&&r.jsx("div",{className:"mb-6 p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(vs,{className:"w-5 h-5 mr-2"}),g]})}),o?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-8 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),r.jsx("span",{className:"text-gray-600 font-medium",children:"Loading programs..."})]})})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl shadow-sm border border-white/20 overflow-hidden mb-6",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-full",children:[r.jsx("div",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50 border-b border-gray-200/50 sticky top-0 z-10",children:r.jsx("table",{className:"min-w-full table-fixed",children:r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Program Information"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Details & Category"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Enrollment & Units"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Financials"}),r.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})})})}),r.jsx("div",{className:"max-h-[400px] overflow-y-auto overflow-x-hidden relative",style:{scrollBehavior:"smooth",scrollbarWidth:"thin",scrollbarColor:"#CBD5E1 #F1F5F9"},children:r.jsx("table",{className:"min-w-full table-fixed",style:{width:"100%"},children:r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[L.map((ie,ee)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${ee%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-4 py-4",style:{width:"320px"},children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-purple-100 to-purple-200 text-purple-700",children:r.jsx(gr,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[r.jsx("div",{className:"text-sm font-semibold text-gray-900 text-wrap",title:ie.program_name,children:ie.program_name}),r.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Code:"," ",ie.program_code||"N/A"]}),ie.major_name&&r.jsxs("div",{className:"text-xs text-blue-600 font-medium text-wrap",title:ie.major_name,children:["Major:"," ",ie.major_name]})]})]})}),r.jsx("td",{className:"px-4 py-4",style:{width:"256px"},children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full shadow-sm ${ke(ie.program_type)}`,children:ie.program_type||"Unknown"}),r.jsxs("div",{className:"text-xs text-gray-600",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(qr,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0"}),r.jsx("span",{className:"truncate",title:ie.aop_category,children:ie.aop_category||"No Category"})]}),r.jsxs("div",{className:"flex items-center mt-1",children:[r.jsx(Lr,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0"}),r.jsxs("span",{className:"truncate",children:[ie.program_normal_length_in_years||"N/A"," ","years"]})]})]})]})}),r.jsx("td",{className:"px-4 py-4",style:{width:"224px"},children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[r.jsx(Jr,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0"}),r.jsxs("span",{className:"truncate",children:[Se(ie)," ","Students"]})]}),r.jsxs("div",{className:"text-xs text-gray-600 truncate",children:["Total Units:"," ",ie.total_units||0]}),r.jsxs("div",{className:"text-xs text-gray-600 truncate",children:["Lab:"," ",ie.lab_units||0," ","| Lecture:"," ",ie.lecture_units||0]}),ie.graduates_total>0&&r.jsxs("div",{className:"text-xs text-green-600 flex items-center",children:[r.jsx(Zr,{className:"w-3 h-3 mr-1 flex-shrink-0"}),r.jsxs("span",{className:"truncate",children:[ie.graduates_total," ","Graduates"]})]})]})}),r.jsx("td",{className:"px-4 py-4",style:{width:"192px"},children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[r.jsx(bn,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0"}),r.jsxs("span",{className:"truncate",children:[ue(ie.tuition_per_unit),"/unit"]})]}),r.jsxs("div",{className:"text-xs text-gray-600 truncate",children:["Program Fee:"," ",ue(ie.program_fee)]}),(ie.externally_funded_merit_scholars>0||ie.internally_funded_grantees>0)&&r.jsxs("div",{className:"text-xs text-blue-600 truncate",children:["Scholars:"," ",(ie.externally_funded_merit_scholars||0)+(ie.internally_funded_grantees||0)]})]})}),r.jsx("td",{className:"px-4 py-4 text-center",style:{width:"128px"},children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",offset:[0,4],usePortal:!0,children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>G(ie),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"View Details"]}),r.jsxs("button",{onClick:()=>ae(ie),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500 group-hover:text-green-600"}),"Edit Program"]}),r.jsxs("button",{onClick:()=>oe(ie.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",role:"menuitem",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-700 group-hover:text-green-600"}),"Delete Program"]})]})})})]},ie.id)),L.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"5",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(gr,{className:"w-10 h-10 text-gray-400"})}),r.jsxs("div",{className:"mb-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:M||T!=="ALL"?"No programs found":"No programs available"}),r.jsx("p",{className:"text-gray-600",children:M||T!=="ALL"?"Try adjusting your search or filter criteria":"Get started by adding your first academic program"})]}),!M&&T==="ALL"&&r.jsxs("div",{className:"space-y-3",children:[r.jsxs("button",{onClick:V,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 mr-3",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Program"]}),r.jsxs("button",{onClick:re,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg text-sm font-medium hover:from-green-700 hover:to-green-800 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsx(Qr,{className:"w-4 h-4 mr-2"}),"Upload Excel"]})]})]})})})]})})},`table-body-${l.length}-${T}-${M}`)]})})}),l.length>0&&r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm",children:r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[r.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",Ie," to ",Pe," of"," ",l.length," results",l.length!==i.length&&r.jsxs("span",{className:"text-blue-600 ml-1",children:["(filtered from ",i.length," ","total)"]})]}),r.jsx(pc,{currentPage:S,totalPages:I,onPageChange:Me,pageSize:j,onPageSizeChange:Oe,pageSizeOptions:[5,10,20,50],showFirstLast:!0,showPageSize:!0,maxPageButtons:5,className:"flex-shrink-0"})]})})]}),r.jsx(m3,{isOpen:x,onClose:le,programData:h}),r.jsx(c5,{isOpen:v,onClose:he,onSave:H,institutionId:t,loading:z}),r.jsx(u5,{isOpen:N,onClose:Ne,onSave:Q,programData:h,loading:U}),r.jsx(W4,{isOpen:O,onClose:we,institutionId:t,onUploadSuccess:Z})]})})}const BU={1:"President",2:"Chancellor",3:"Executive Director",4:"Dean",5:"Rector",6:"Head",7:"Administrator",8:"Principal",9:"Managing Director",10:"Director",11:"Chair",12:"Others",99:"Not known or not indicated"},DU={50:"Completed a Baccalaureate Degree (including DVM, DDM, D Opt)",60:"Completed Post-Grad Certificate or diploma Program",70:"Completed MD or LLB (or equivalent)",80:"Completed Masters Degree or Equivalent",90:"Completed Doctorate Degree (or equivalent)"};function X4({isOpen:t,onClose:s,sucData:e}){if(!e)return null;const a=l=>l?l.toString():"Not specified",n=l=>l||"Not provided",i=l=>{const u=Number(l);return BU[u]||"Unknown Title"},c=l=>{const u=Number(l);return DU[u]||"Not specified"};return r.jsx(mr,{isOpen:t,onClose:s,title:e.institution_name||e.hei_name||"Institution Details",subtitle:`${e.institution_uiid||e.hei_uiid||"ID not available"}`,icon:gr,className:"max-w-4xl mx-auto",variant:"default",size:"lg",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx($s,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Institution Overview"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-blue-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Institution Name"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:e.institution_name||e.hei_name||"Not specified"})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-blue-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Institution Identifier"}),r.jsx("p",{className:"text-gray-900 mt-1 font-mono text-xs bg-blue-100 px-2 py-1 rounded-md inline-block",children:e.institution_uiid||e.hei_uiid||"Not specified"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(yn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Geographic Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Administrative Region"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:e.region||"Not specified"})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Province"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:e.province||"Not specified"})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"City/Municipality"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:e.municipality||"Not specified"})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Street Address"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:e.address_street||"Not specified"})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Postal Code"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:e.postal_code||"Not specified"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(ao,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Institutional Contact"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(r2,{className:"w-4 h-4 text-amber-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Main Telephone"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:n(e.institutional_telephone)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fE,{className:"w-4 h-4 text-amber-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Facsimile Number"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:n(e.institutional_fax)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Dn,{className:"w-4 h-4 text-amber-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Electronic Mail"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:n(e.institutional_email)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(TC,{className:"w-4 h-4 text-amber-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Web Address"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:n(e.institutional_website)})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Executive Leadership"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-purple-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Chief Executive"}),r.jsx("p",{className:"text-gray-900 mt-1 font-semibold text-base",children:e.head_name||"Not specified"})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-purple-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Executive Position"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:i(e.head_title)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-purple-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Academic Qualifications"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:c(e.head_education)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-purple-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(r2,{className:"w-4 h-4 text-purple-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Executive Contact"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:n(e.head_telephone)})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-rose-50 via-pink-50 to-red-100 rounded-xl p-4 border border-rose-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-rose-500 rounded-lg shadow-sm",children:r.jsx(Lr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Institutional History"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-rose-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Zr,{className:"w-4 h-4 text-rose-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Year of Establishment"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-semibold text-base",children:a(e.year_established)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-rose-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(LC,{className:"w-4 h-4 text-rose-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"SEC Registration Number"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:e.sec_registration||"Not specified"})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-rose-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(qr,{className:"w-4 h-4 text-rose-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Year of Approval"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:a(e.year_granted_approved)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-rose-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Bl,{className:"w-4 h-4 text-rose-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"College Status Year"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:a(e.year_converted_college)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-rose-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(gr,{className:"w-4 h-4 text-rose-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"University Status Year"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:a(e.year_converted_university)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-rose-100",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Lr,{className:"w-4 h-4 text-rose-600"}),r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Reporting Period"})]}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:a(e.report_year)})]})]})]})]})})}X4.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,sucData:B.shape({id:B.oneOfType([B.string,B.number]),institution_name:B.string,hei_name:B.string,institution_uiid:B.string,hei_uiid:B.string,region:B.string,province:B.string,municipality:B.string,address_street:B.string,postal_code:B.string,institutional_telephone:B.string,institutional_fax:B.string,head_telephone:B.string,institutional_email:B.string,institutional_website:B.string,year_established:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number]),head_name:B.string,head_title:B.oneOfType([B.string,B.number]),head_education:B.oneOfType([B.string,B.number]),sec_registration:B.string,year_granted_approved:B.oneOfType([B.string,B.number]),year_converted_college:B.oneOfType([B.string,B.number]),year_converted_university:B.oneOfType([B.string,B.number])})};const UU={1:"President",2:"Chancellor",3:"Executive Director",4:"Dean",5:"Rector",6:"Head",7:"Administrator",8:"Principal",9:"Managing Director",10:"Director",11:"Chair",12:"Others",99:"Not known or not indicated"};function K4({data:t,onEdit:s,onDelete:e,createLog:a,updateProgress:n}){const i=Aa(),[c,l]=ne.useState(null),[u,o]=ne.useState(!1),[d,g]=ne.useState({}),[p,h]=ne.useState(1),[f,x]=ne.useState(10);ne.useEffect(()=>{h(1)},[t]);const b=[...t].sort((q,M)=>{const D=q.institution_name||q.hei_name||"",T=M.institution_name||M.hei_name||"";return D.localeCompare(T)}),v=Math.ceil(b.length/f),_=(p-1)*f,N=_+f,E=b.slice(_,N),O=q=>{h(q)},F=q=>{x(q),h(1)},z=(q,M)=>{const D=q.id||q.id;if(!D){console.error(`No SUC ID found for ${M}:`,q);return}const T={campuses:`/super-admin/institutions/suc/campuses/${D}`,programs:`/super-admin/institutions/suc/programs/${D}`,formE1:`/super-admin/institutions/suc/form-e1/${D}`,formE2:`/super-admin/institutions/suc/form-e2/${D}`,formGH:`/super-admin/institutions/suc/form-gh/${D}`,research:`/super-admin/institutions/suc/research/${D}`,graduates:`/super-admin/institutions/suc/graduates/${D}`};i(T[M],{state:{heiName:q.hei_name||q.institution_name,heiUiid:q.hei_uiid}})},P=q=>{l(q),o(!0)},U=()=>{o(!1),l(null)},W=q=>{const M=Number(q);return UU[M]||"Unknown Title"},Y=ne.useCallback(async q=>{console.log("handleExportToFormA confirmation triggered for",q.institution_name||q.hei_name),Ft.showConfirmation(`Do you want to export Form A for ${q.institution_name||q.hei_name}?`,async()=>{g(M=>({...M,exportFormA:!0}));try{n&&n(10);const M=await fetch("/templates/Form-A-Themeplate.xlsx");if(!M.ok)throw new Error(`HTTP error! Status: ${M.status}`);const D=await M.arrayBuffer(),T=new fd.Workbook;await T.xlsx.load(D);const C=T.getWorksheet("FORM A1"),S=T.getWorksheet("FORM A2");[{row:4,cell:3,key:"institution_name",altKey:"hei_name"},{row:7,cell:3,key:"address_street"},{row:8,cell:3,key:"municipality"},{row:9,cell:3,key:"province"},{row:10,cell:3,key:"region"},{row:11,cell:3,key:"postal_code"},{row:12,cell:3,key:"institutional_telephone"},{row:13,cell:3,key:"institutional_fax"},{row:14,cell:3,key:"head_telephone"},{row:15,cell:3,key:"institutional_email"},{row:16,cell:3,key:"institutional_website"},{row:17,cell:3,key:"year_established"},{row:18,cell:3,key:"sec_registration"},{row:19,cell:3,key:"year_granted_approved"},{row:20,cell:3,key:"year_converted_college"},{row:21,cell:3,key:"year_converted_university"},{row:22,cell:3,key:"head_name"},{row:23,cell:3,key:"head_title",transform:W},{row:24,cell:3,key:"head_education"}].forEach(({row:V,cell:H,key:Q,altKey:oe,transform:se})=>{let le=q[Q]||(oe?q[oe]:"")||"";se&&le&&(le=se(le)),C.getRow(V).getCell(H).value=le}),n&&n(20);const j=localStorage.getItem("token"),{data:A}=await bt.get(`${Ct.API_URL}/suc-campuses?suc_details_id=${q.id}`,{headers:{Authorization:`Bearer ${j}`}});console.log("campusData",A);let L=[];Array.isArray(A)?L=A:A.campuses&&Array.isArray(A.campuses)?L=A.campuses:A.data&&Array.isArray(A.data)&&(L=A.data),console.log("campuses",L);let I=-1;S.eachRow((V,H)=>{let Q=!1;if(V.eachCell(oe=>{if(oe.value&&String(oe.value).trim()==="START BELOW THIS ROW")return Q=!0,!1}),Q)return I=H+1,!1}),I===-1?console.error("Could not find 'START BELOW THIS ROW' marker in FORM A2. Campus data will not be exported."):L.forEach((V,H)=>{const Q=S.getRow(I+H);Q.getCell(1).value=H+1,Q.getCell(2).value=V.name||"",Q.getCell(3).value=V.campus_type||"",Q.getCell(4).value=V.institutional_code||"",Q.getCell(5).value=V.region||"",Q.getCell(6).value=V.province_municipality||"",Q.getCell(7).value=V.year_first_operation||"",Q.getCell(8).value=V.land_area_hectares||"0.0",Q.getCell(9).value=V.distance_from_main||"0.0",Q.getCell(10).value=V.autonomous_code||"",Q.getCell(11).value=V.position_title||"",Q.getCell(12).value=V.head_full_name||"",Q.getCell(13).value=V.former_name||"",Q.getCell(14).value=V.latitude_coordinates||"0.0",Q.getCell(15).value=V.longitude_coordinates||"0.0",Q.commit()}),n&&n(100);const Z=`${q.institution_uiid||q.hei_uiid||"0000"}_${q.institution_name||q.hei_name||"Unknown"}_SUC_${new Date().toISOString().split("T")[0]}.xlsx`,K=await T.xlsx.writeBuffer(),re=new Blob([K],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),G=window.URL.createObjectURL(re),ae=document.createElement("a");ae.href=G,ae.download=Z,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),window.URL.revokeObjectURL(G),a&&await a({action:"Export Institution",description:`Exported Form A for institution: ${q.institution_name||q.hei_name}`}),Ft.showAlert("Form A exported successfully.","success")}catch(M){console.error("Error exporting Form A:",M),Ft.showAlert("Failed to export Form A. Please try again.","error")}finally{g(M=>({...M,exportFormA:!1}))}})},[n,a]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"relative w-full px-4 py-2",children:[r.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[50vh] rounded-lg border border-gray-200 shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200 table-fixed",children:[r.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"w-[25%] px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Institution"}),r.jsx("th",{className:"w-[15%] px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Location"}),r.jsx("th",{className:"w-[20%] px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Leadership"}),r.jsx("th",{className:"w-[20%] px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Contact"}),r.jsx("th",{className:"w-[10%] px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Established"}),r.jsx("th",{className:"w-[10%] px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),r.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[E.map(q=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"flex items-start",children:r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 break-words",children:q.institution_name||q.hei_name}),r.jsx("div",{className:"text-sm text-gray-500 truncate",children:q.institution_uiid||q.hei_uiid})]})})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-sm text-gray-900 truncate",children:[q.municipality,", ",q.province]}),r.jsx("div",{className:"text-sm text-gray-500 truncate",children:q.region})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:q.head_name}),r.jsx("div",{className:"text-sm text-gray-500 truncate",children:W(q.head_title)})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-sm text-gray-900 flex items-center",children:[r.jsx(ao,{className:"w-3 h-3 mr-1 flex-shrink-0"}),r.jsx("span",{className:"truncate",children:q.institutional_telephone})]}),r.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[r.jsx(Dn,{className:"w-3 h-3 mr-1 flex-shrink-0"}),r.jsx("span",{className:"truncate",children:q.institutional_email})]})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm text-gray-900",children:q.year_established}),q.year_converted_university&&r.jsxs("div",{className:"text-sm text-gray-500",children:["Univ:"," ",q.year_converted_university]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium relative",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-md p-1",title:"More Actions",children:r.jsx(ha,{className:"w-5 h-5"})}),placement:"bottom-end",className:"w-48 bg-white border border-gray-200 rounded-md shadow-lg z-[9999]",offset:[0,4],children:r.jsxs("div",{className:"py-1",children:[r.jsx("div",{className:"px-2 py-1 text-xs font-medium text-gray-500",children:"Actions"}),r.jsxs("button",{onClick:()=>P(q),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(gr,{className:"w-4 h-4 mr-3 text-gray-500 group-hover:text-gray-600"}),"View Details"]}),r.jsxs("button",{onClick:()=>s(q),className:"flex items-center w-full px-4 py-2 text-left text-sm text-green-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-700 group-hover:text-green-600"}),"Edit Institution"]}),r.jsxs("button",{onClick:()=>Y(q),disabled:d.exportFormA,className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition-colors duration-150 group disabled:opacity-50 disabled:cursor-not-allowed",role:"menuitem",children:[r.jsx(oc,{className:"w-4 h-4 mr-3 text-gray-500 group-hover:text-gray-600"}),d.exportFormA?"Exporting...":"Export to Excel"]}),r.jsxs("button",{onClick:()=>e(q.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-700 group-hover:text-red-600"}),"Delete Institution"]}),r.jsx("div",{className:"border-t border-gray-100 my-1"}),r.jsx("div",{className:"px-2 py-1 text-xs font-medium text-gray-500",children:"Forms"}),r.jsxs("button",{onClick:()=>z(q,"campuses"),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx($s,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"Campuses (Form A2)"]}),r.jsxs("button",{onClick:()=>z(q,"programs"),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-purple-50 focus:outline-none focus:bg-purple-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(qr,{className:"w-4 h-4 mr-3 text-purple-500 group-hover:text-purple-600"}),"Curricular Programs (Form B)"]}),r.jsxs("button",{onClick:()=>z(q,"formE1"),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-indigo-50 focus:outline-none focus:bg-indigo-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Jr,{className:"w-4 h-4 mr-3 text-indigo-500 group-hover:text-indigo-600"}),"Manage Faculty (Form E1)"]}),r.jsxs("button",{onClick:()=>z(q,"formE2"),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-teal-50 focus:outline-none focus:bg-teal-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(ys,{className:"w-4 h-4 mr-3 text-teal-500 group-hover:text-teal-600"}),"Manage Faculty (Form E2)"]}),r.jsxs("button",{onClick:()=>z(q,"formGH"),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-amber-50 focus:outline-none focus:bg-amber-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(ys,{className:"w-4 h-4 mr-3 text-amber-500 group-hover:text-amber-600"}),"Financial Data (Form G-H)"]}),r.jsx("div",{className:"border-t border-gray-100 my-1"}),r.jsx("div",{className:"px-2 py-1 text-xs font-medium text-gray-500",children:"Additional Data"}),r.jsxs("button",{onClick:()=>z(q,"research"),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(qr,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"Manage Research"]}),r.jsxs("button",{onClick:()=>z(q,"graduates"),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-emerald-50 focus:outline-none focus:bg-emerald-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(gr,{className:"w-4 h-4 mr-3 text-emerald-500 group-hover:text-emerald-600"}),"View Graduates"]}),r.jsx("div",{className:"border-t border-gray-100 my-1"})]})})})]},q.id)),E.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx(gr,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{className:"text-lg font-medium",children:"No SUCs found"}),r.jsx("p",{className:"text-sm",children:"Try adjusting your search terms or add a new SUC."})]})})})]})]})}),r.jsx("div",{className:"mt-2 flex justify-end",children:r.jsx(pc,{currentPage:p,totalPages:v,onPageChange:O,pageSize:f,onPageSizeChange:F,pageSizeOptions:[10,20,50,100],showFirstLast:!0,showPageSize:!0,maxPageButtons:5})})]}),r.jsx(X4,{isOpen:u,onClose:U,sucData:c})]})}K4.propTypes={data:B.arrayOf(B.shape({id:B.oneOfType([B.string,B.number]).isRequired,institution_name:B.string,hei_name:B.string,institution_uiid:B.string,hei_uiid:B.string,region:B.string,province:B.string,municipality:B.string,institutional_telephone:B.string,institutional_email:B.string,year_established:B.oneOfType([B.string,B.number]),head_name:B.string,head_title:B.oneOfType([B.string,B.number]),year_converted_university:B.oneOfType([B.string,B.number])})).isRequired,onEdit:B.func.isRequired,onDelete:B.func.isRequired,createLog:B.func,updateProgress:B.func};function Xo(t){"@babel/helpers - typeof";return Xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Xo(t)}function $U(t,s){if(Xo(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var a=e.call(t,s);if(Xo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Z4(t){var s=$U(t,"string");return Xo(s)=="symbol"?s:s+""}function _u(t,s,e){return(s=Z4(s))in t?Object.defineProperty(t,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[s]=e,t}function A_(t,s){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,a)}return e}function Bt(t){for(var s=1;s<arguments.length;s++){var e=arguments[s]!=null?arguments[s]:{};s%2?A_(Object(e),!0).forEach(function(a){_u(t,a,e[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):A_(Object(e)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))})}return t}function zU(t){if(Array.isArray(t))return t}function HU(t,s){var e=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var a,n,i,c,l=[],u=!0,o=!1;try{if(i=(e=e.call(t)).next,s===0){if(Object(e)!==e)return;u=!1}else for(;!(u=(a=i.call(e)).done)&&(l.push(a.value),l.length!==s);u=!0);}catch(d){o=!0,n=d}finally{try{if(!u&&e.return!=null&&(c=e.return(),Object(c)!==c))return}finally{if(o)throw n}}return l}}function hg(t,s){(s==null||s>t.length)&&(s=t.length);for(var e=0,a=Array(s);e<s;e++)a[e]=t[e];return a}function Q4(t,s){if(t){if(typeof t=="string")return hg(t,s);var e={}.toString.call(t).slice(8,-1);return e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set"?Array.from(t):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?hg(t,s):void 0}}function VU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mi(t,s){return zU(t)||HU(t,s)||Q4(t,s)||VU()}function qU(t,s){if(t==null)return{};var e={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;e[a]=t[a]}return e}function vi(t,s){if(t==null)return{};var e,a,n=qU(t,s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)e=i[a],s.indexOf(e)===-1&&{}.propertyIsEnumerable.call(t,e)&&(n[e]=t[e])}return n}var GU=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function YU(t){var s=t.defaultInputValue,e=s===void 0?"":s,a=t.defaultMenuIsOpen,n=a===void 0?!1:a,i=t.defaultValue,c=i===void 0?null:i,l=t.inputValue,u=t.menuIsOpen,o=t.onChange,d=t.onInputChange,g=t.onMenuClose,p=t.onMenuOpen,h=t.value,f=vi(t,GU),x=ne.useState(l!==void 0?l:e),b=mi(x,2),v=b[0],_=b[1],N=ne.useState(u!==void 0?u:n),E=mi(N,2),O=E[0],F=E[1],z=ne.useState(h!==void 0?h:c),P=mi(z,2),U=P[0],W=P[1],Y=ne.useCallback(function(w,j){typeof o=="function"&&o(w,j),W(w)},[o]),q=ne.useCallback(function(w,j){var A;typeof d=="function"&&(A=d(w,j)),_(A!==void 0?A:w)},[d]),M=ne.useCallback(function(){typeof p=="function"&&p(),F(!0)},[p]),D=ne.useCallback(function(){typeof g=="function"&&g(),F(!1)},[g]),T=l!==void 0?l:v,C=u!==void 0?u:O,S=h!==void 0?h:U;return Bt(Bt({},f),{},{inputValue:T,menuIsOpen:C,onChange:Y,onInputChange:q,onMenuClose:D,onMenuOpen:M,value:S})}function zt(){return zt=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var a in e)({}).hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},zt.apply(null,arguments)}function WU(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function O_(t,s){for(var e=0;e<s.length;e++){var a=s[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,Z4(a.key),a)}}function XU(t,s,e){return s&&O_(t.prototype,s),e&&O_(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function mg(t,s){return mg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,a){return e.__proto__=a,e},mg(t,s)}function KU(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&mg(t,s)}function j0(t){return j0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},j0(t)}function J4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J4=function(){return!!t})()}function ZU(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QU(t,s){if(s&&(Xo(s)=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZU(t)}function JU(t){var s=J4();return function(){var e,a=j0(t);if(s){var n=j0(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return QU(this,e)}}function e$(t){if(Array.isArray(t))return hg(t)}function t$(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function r$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Px(t){return e$(t)||t$(t)||Q4(t)||r$()}function s$(t){if(t.sheet)return t.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===t)return document.styleSheets[s]}function a$(t){var s=document.createElement("style");return s.setAttribute("data-emotion",t.key),t.nonce!==void 0&&s.setAttribute("nonce",t.nonce),s.appendChild(document.createTextNode("")),s.setAttribute("data-s",""),s}var n$=function(){function t(e){var a=this;this._insertTag=function(n){var i;a.tags.length===0?a.insertionPoint?i=a.insertionPoint.nextSibling:a.prepend?i=a.container.firstChild:i=a.before:i=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(n,i),a.tags.push(n)},this.isSpeedy=e.speedy===void 0?!0:e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var s=t.prototype;return s.hydrate=function(a){a.forEach(this._insertTag)},s.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(a$(this));var n=this.tags[this.tags.length-1];if(this.isSpeedy){var i=s$(n);try{i.insertRule(a,i.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(a));this.ctr++},s.flush=function(){this.tags.forEach(function(a){var n;return(n=a.parentNode)==null?void 0:n.removeChild(a)}),this.tags=[],this.ctr=0},t}(),Ls="-ms-",S0="-moz-",vr="-webkit-",e6="comm",Bx="rule",Dx="decl",i$="@import",t6="@keyframes",o$="@layer",l$=Math.abs,eh=String.fromCharCode,c$=Object.assign;function u$(t,s){return Cs(t,0)^45?(((s<<2^Cs(t,0))<<2^Cs(t,1))<<2^Cs(t,2))<<2^Cs(t,3):0}function r6(t){return t.trim()}function d$(t,s){return(t=s.exec(t))?t[0]:t}function _r(t,s,e){return t.replace(s,e)}function pg(t,s){return t.indexOf(s)}function Cs(t,s){return t.charCodeAt(s)|0}function qu(t,s,e){return t.slice(s,e)}function In(t){return t.length}function Ux(t){return t.length}function Mf(t,s){return s.push(t),t}function f$(t,s){return t.map(s).join("")}var th=1,tc=1,s6=0,fa=0,os=0,gc="";function rh(t,s,e,a,n,i,c){return{value:t,root:s,parent:e,type:a,props:n,children:i,line:th,column:tc,length:c,return:""}}function pu(t,s){return c$(rh("",null,null,"",null,null,0),t,{length:-t.length},s)}function h$(){return os}function m$(){return os=fa>0?Cs(gc,--fa):0,tc--,os===10&&(tc=1,th--),os}function ka(){return os=fa<s6?Cs(gc,fa++):0,tc++,os===10&&(tc=1,th++),os}function Bn(){return Cs(gc,fa)}function Gf(){return fa}function hd(t,s){return qu(gc,t,s)}function Gu(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function a6(t){return th=tc=1,s6=In(gc=t),fa=0,[]}function n6(t){return gc="",t}function Yf(t){return r6(hd(fa-1,gg(t===91?t+2:t===40?t+1:t)))}function p$(t){for(;(os=Bn())&&os<33;)ka();return Gu(t)>2||Gu(os)>3?"":" "}function g$(t,s){for(;--s&&ka()&&!(os<48||os>102||os>57&&os<65||os>70&&os<97););return hd(t,Gf()+(s<6&&Bn()==32&&ka()==32))}function gg(t){for(;ka();)switch(os){case t:return fa;case 34:case 39:t!==34&&t!==39&&gg(os);break;case 40:t===41&&gg(t);break;case 92:ka();break}return fa}function x$(t,s){for(;ka()&&t+os!==57;)if(t+os===84&&Bn()===47)break;return"/*"+hd(s,fa-1)+"*"+eh(t===47?t:ka())}function b$(t){for(;!Gu(Bn());)ka();return hd(t,fa)}function y$(t){return n6(Wf("",null,null,null,[""],t=a6(t),0,[0],t))}function Wf(t,s,e,a,n,i,c,l,u){for(var o=0,d=0,g=c,p=0,h=0,f=0,x=1,b=1,v=1,_=0,N="",E=n,O=i,F=a,z=N;b;)switch(f=_,_=ka()){case 40:if(f!=108&&Cs(z,g-1)==58){pg(z+=_r(Yf(_),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:z+=Yf(_);break;case 9:case 10:case 13:case 32:z+=p$(f);break;case 92:z+=g$(Gf()-1,7);continue;case 47:switch(Bn()){case 42:case 47:Mf(v$(x$(ka(),Gf()),s,e),u);break;default:z+="/"}break;case 123*x:l[o++]=In(z)*v;case 125*x:case 59:case 0:switch(_){case 0:case 125:b=0;case 59+d:v==-1&&(z=_r(z,/\f/g,"")),h>0&&In(z)-g&&Mf(h>32?M_(z+";",a,e,g-1):M_(_r(z," ","")+";",a,e,g-2),u);break;case 59:z+=";";default:if(Mf(F=R_(z,s,e,o,d,n,l,N,E=[],O=[],g),i),_===123)if(d===0)Wf(z,s,F,F,E,i,g,l,O);else switch(p===99&&Cs(z,3)===110?100:p){case 100:case 108:case 109:case 115:Wf(t,F,F,a&&Mf(R_(t,F,F,0,0,n,l,N,n,E=[],g),O),n,O,g,l,a?E:O);break;default:Wf(z,F,F,F,[""],O,0,l,O)}}o=d=h=0,x=v=1,N=z="",g=c;break;case 58:g=1+In(z),h=f;default:if(x<1){if(_==123)--x;else if(_==125&&x++==0&&m$()==125)continue}switch(z+=eh(_),_*x){case 38:v=d>0?1:(z+="\f",-1);break;case 44:l[o++]=(In(z)-1)*v,v=1;break;case 64:Bn()===45&&(z+=Yf(ka())),p=Bn(),d=g=In(N=z+=b$(Gf())),_++;break;case 45:f===45&&In(z)==2&&(x=0)}}return i}function R_(t,s,e,a,n,i,c,l,u,o,d){for(var g=n-1,p=n===0?i:[""],h=Ux(p),f=0,x=0,b=0;f<a;++f)for(var v=0,_=qu(t,g+1,g=l$(x=c[f])),N=t;v<h;++v)(N=r6(x>0?p[v]+" "+_:_r(_,/&\f/g,p[v])))&&(u[b++]=N);return rh(t,s,e,n===0?Bx:l,u,o,d)}function v$(t,s,e){return rh(t,s,e,e6,eh(h$()),qu(t,2,-2),0)}function M_(t,s,e,a){return rh(t,s,e,Dx,qu(t,0,a),qu(t,a+1,-1),a)}function Vl(t,s){for(var e="",a=Ux(t),n=0;n<a;n++)e+=s(t[n],n,t,s)||"";return e}function _$(t,s,e,a){switch(t.type){case o$:if(t.children.length)break;case i$:case Dx:return t.return=t.return||t.value;case e6:return"";case t6:return t.return=t.value+"{"+Vl(t.children,a)+"}";case Bx:t.value=t.props.join(",")}return In(e=Vl(t.children,a))?t.return=t.value+"{"+e+"}":""}function w$(t){var s=Ux(t);return function(e,a,n,i){for(var c="",l=0;l<s;l++)c+=t[l](e,a,n,i)||"";return c}}function N$(t){return function(s){s.root||(s=s.return)&&t(s)}}function j$(t){var s=Object.create(null);return function(e){return s[e]===void 0&&(s[e]=t(e)),s[e]}}var S$=function(s,e,a){for(var n=0,i=0;n=i,i=Bn(),n===38&&i===12&&(e[a]=1),!Gu(i);)ka();return hd(s,fa)},k$=function(s,e){var a=-1,n=44;do switch(Gu(n)){case 0:n===38&&Bn()===12&&(e[a]=1),s[a]+=S$(fa-1,e,a);break;case 2:s[a]+=Yf(n);break;case 4:if(n===44){s[++a]=Bn()===58?"&\f":"",e[a]=s[a].length;break}default:s[a]+=eh(n)}while(n=ka());return s},C$=function(s,e){return n6(k$(a6(s),e))},F_=new WeakMap,E$=function(s){if(!(s.type!=="rule"||!s.parent||s.length<1)){for(var e=s.value,a=s.parent,n=s.column===a.column&&s.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(s.props.length===1&&e.charCodeAt(0)!==58&&!F_.get(a))&&!n){F_.set(s,!0);for(var i=[],c=C$(e,i),l=a.props,u=0,o=0;u<c.length;u++)for(var d=0;d<l.length;d++,o++)s.props[o]=i[u]?c[u].replace(/&\f/g,l[d]):l[d]+" "+c[u]}}},T$=function(s){if(s.type==="decl"){var e=s.value;e.charCodeAt(0)===108&&e.charCodeAt(2)===98&&(s.return="",s.value="")}};function i6(t,s){switch(u$(t,s)){case 5103:return vr+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return vr+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return vr+t+S0+t+Ls+t+t;case 6828:case 4268:return vr+t+Ls+t+t;case 6165:return vr+t+Ls+"flex-"+t+t;case 5187:return vr+t+_r(t,/(\w+).+(:[^]+)/,vr+"box-$1$2"+Ls+"flex-$1$2")+t;case 5443:return vr+t+Ls+"flex-item-"+_r(t,/flex-|-self/,"")+t;case 4675:return vr+t+Ls+"flex-line-pack"+_r(t,/align-content|flex-|-self/,"")+t;case 5548:return vr+t+Ls+_r(t,"shrink","negative")+t;case 5292:return vr+t+Ls+_r(t,"basis","preferred-size")+t;case 6060:return vr+"box-"+_r(t,"-grow","")+vr+t+Ls+_r(t,"grow","positive")+t;case 4554:return vr+_r(t,/([^-])(transform)/g,"$1"+vr+"$2")+t;case 6187:return _r(_r(_r(t,/(zoom-|grab)/,vr+"$1"),/(image-set)/,vr+"$1"),t,"")+t;case 5495:case 3959:return _r(t,/(image-set\([^]*)/,vr+"$1$`$1");case 4968:return _r(_r(t,/(.+:)(flex-)?(.*)/,vr+"box-pack:$3"+Ls+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+vr+t+t;case 4095:case 3583:case 4068:case 2532:return _r(t,/(.+)-inline(.+)/,vr+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(In(t)-1-s>6)switch(Cs(t,s+1)){case 109:if(Cs(t,s+4)!==45)break;case 102:return _r(t,/(.+:)(.+)-([^]+)/,"$1"+vr+"$2-$3$1"+S0+(Cs(t,s+3)==108?"$3":"$2-$3"))+t;case 115:return~pg(t,"stretch")?i6(_r(t,"stretch","fill-available"),s)+t:t}break;case 4949:if(Cs(t,s+1)!==115)break;case 6444:switch(Cs(t,In(t)-3-(~pg(t,"!important")&&10))){case 107:return _r(t,":",":"+vr)+t;case 101:return _r(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+vr+(Cs(t,14)===45?"inline-":"")+"box$3$1"+vr+"$2$3$1"+Ls+"$2box$3")+t}break;case 5936:switch(Cs(t,s+11)){case 114:return vr+t+Ls+_r(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return vr+t+Ls+_r(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return vr+t+Ls+_r(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return vr+t+Ls+t+t}return t}var A$=function(s,e,a,n){if(s.length>-1&&!s.return)switch(s.type){case Dx:s.return=i6(s.value,s.length);break;case t6:return Vl([pu(s,{value:_r(s.value,"@","@"+vr)})],n);case Bx:if(s.length)return f$(s.props,function(i){switch(d$(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Vl([pu(s,{props:[_r(i,/:(read-\w+)/,":"+S0+"$1")]})],n);case"::placeholder":return Vl([pu(s,{props:[_r(i,/:(plac\w+)/,":"+vr+"input-$1")]}),pu(s,{props:[_r(i,/:(plac\w+)/,":"+S0+"$1")]}),pu(s,{props:[_r(i,/:(plac\w+)/,Ls+"input-$1")]})],n)}return""})}},O$=[A$],R$=function(s){var e=s.key;if(e==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(x){var b=x.getAttribute("data-emotion");b.indexOf(" ")!==-1&&(document.head.appendChild(x),x.setAttribute("data-s",""))})}var n=s.stylisPlugins||O$,i={},c,l=[];c=s.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),function(x){for(var b=x.getAttribute("data-emotion").split(" "),v=1;v<b.length;v++)i[b[v]]=!0;l.push(x)});var u,o=[E$,T$];{var d,g=[_$,N$(function(x){d.insert(x)})],p=w$(o.concat(n,g)),h=function(b){return Vl(y$(b),p)};u=function(b,v,_,N){d=_,h(b?b+"{"+v.styles+"}":v.styles),N&&(f.inserted[v.name]=!0)}}var f={key:e,sheet:new n$({key:e,container:c,nonce:s.nonce,speedy:s.speedy,prepend:s.prepend,insertionPoint:s.insertionPoint}),nonce:s.nonce,inserted:i,registered:{},insert:u};return f.sheet.hydrate(l),f},Mp={exports:{}},Nr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_;function M$(){if(I_)return Nr;I_=1;var t=typeof Symbol=="function"&&Symbol.for,s=t?Symbol.for("react.element"):60103,e=t?Symbol.for("react.portal"):60106,a=t?Symbol.for("react.fragment"):60107,n=t?Symbol.for("react.strict_mode"):60108,i=t?Symbol.for("react.profiler"):60114,c=t?Symbol.for("react.provider"):60109,l=t?Symbol.for("react.context"):60110,u=t?Symbol.for("react.async_mode"):60111,o=t?Symbol.for("react.concurrent_mode"):60111,d=t?Symbol.for("react.forward_ref"):60112,g=t?Symbol.for("react.suspense"):60113,p=t?Symbol.for("react.suspense_list"):60120,h=t?Symbol.for("react.memo"):60115,f=t?Symbol.for("react.lazy"):60116,x=t?Symbol.for("react.block"):60121,b=t?Symbol.for("react.fundamental"):60117,v=t?Symbol.for("react.responder"):60118,_=t?Symbol.for("react.scope"):60119;function N(O){if(typeof O=="object"&&O!==null){var F=O.$$typeof;switch(F){case s:switch(O=O.type,O){case u:case o:case a:case i:case n:case g:return O;default:switch(O=O&&O.$$typeof,O){case l:case d:case f:case h:case c:return O;default:return F}}case e:return F}}}function E(O){return N(O)===o}return Nr.AsyncMode=u,Nr.ConcurrentMode=o,Nr.ContextConsumer=l,Nr.ContextProvider=c,Nr.Element=s,Nr.ForwardRef=d,Nr.Fragment=a,Nr.Lazy=f,Nr.Memo=h,Nr.Portal=e,Nr.Profiler=i,Nr.StrictMode=n,Nr.Suspense=g,Nr.isAsyncMode=function(O){return E(O)||N(O)===u},Nr.isConcurrentMode=E,Nr.isContextConsumer=function(O){return N(O)===l},Nr.isContextProvider=function(O){return N(O)===c},Nr.isElement=function(O){return typeof O=="object"&&O!==null&&O.$$typeof===s},Nr.isForwardRef=function(O){return N(O)===d},Nr.isFragment=function(O){return N(O)===a},Nr.isLazy=function(O){return N(O)===f},Nr.isMemo=function(O){return N(O)===h},Nr.isPortal=function(O){return N(O)===e},Nr.isProfiler=function(O){return N(O)===i},Nr.isStrictMode=function(O){return N(O)===n},Nr.isSuspense=function(O){return N(O)===g},Nr.isValidElementType=function(O){return typeof O=="string"||typeof O=="function"||O===a||O===o||O===i||O===n||O===g||O===p||typeof O=="object"&&O!==null&&(O.$$typeof===f||O.$$typeof===h||O.$$typeof===c||O.$$typeof===l||O.$$typeof===d||O.$$typeof===b||O.$$typeof===v||O.$$typeof===_||O.$$typeof===x)},Nr.typeOf=N,Nr}var L_;function F$(){return L_||(L_=1,Mp.exports=M$()),Mp.exports}var Fp,P_;function I$(){if(P_)return Fp;P_=1;var t=F$(),s={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},e={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},n={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},i={};i[t.ForwardRef]=a,i[t.Memo]=n;function c(f){return t.isMemo(f)?n:i[f.$$typeof]||s}var l=Object.defineProperty,u=Object.getOwnPropertyNames,o=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,p=Object.prototype;function h(f,x,b){if(typeof x!="string"){if(p){var v=g(x);v&&v!==p&&h(f,v,b)}var _=u(x);o&&(_=_.concat(o(x)));for(var N=c(f),E=c(x),O=0;O<_.length;++O){var F=_[O];if(!e[F]&&!(b&&b[F])&&!(E&&E[F])&&!(N&&N[F])){var z=d(x,F);try{l(f,F,z)}catch{}}}}return f}return Fp=h,Fp}I$();var L$=!0;function P$(t,s,e){var a="";return e.split(" ").forEach(function(n){t[n]!==void 0?s.push(t[n]+";"):n&&(a+=n+" ")}),a}var o6=function(s,e,a){var n=s.key+"-"+e.name;(a===!1||L$===!1)&&s.registered[n]===void 0&&(s.registered[n]=e.styles)},B$=function(s,e,a){o6(s,e,a);var n=s.key+"-"+e.name;if(s.inserted[e.name]===void 0){var i=e;do s.insert(e===i?"."+n:"",i,s.sheet,!0),i=i.next;while(i!==void 0)}};function D$(t){for(var s=0,e,a=0,n=t.length;n>=4;++a,n-=4)e=t.charCodeAt(a)&255|(t.charCodeAt(++a)&255)<<8|(t.charCodeAt(++a)&255)<<16|(t.charCodeAt(++a)&255)<<24,e=(e&65535)*1540483477+((e>>>16)*59797<<16),e^=e>>>24,s=(e&65535)*1540483477+((e>>>16)*59797<<16)^(s&65535)*1540483477+((s>>>16)*59797<<16);switch(n){case 3:s^=(t.charCodeAt(a+2)&255)<<16;case 2:s^=(t.charCodeAt(a+1)&255)<<8;case 1:s^=t.charCodeAt(a)&255,s=(s&65535)*1540483477+((s>>>16)*59797<<16)}return s^=s>>>13,s=(s&65535)*1540483477+((s>>>16)*59797<<16),((s^s>>>15)>>>0).toString(36)}var U$={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},$$=/[A-Z]|^ms/g,z$=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l6=function(s){return s.charCodeAt(1)===45},B_=function(s){return s!=null&&typeof s!="boolean"},Ip=j$(function(t){return l6(t)?t:t.replace($$,"-$&").toLowerCase()}),D_=function(s,e){switch(s){case"animation":case"animationName":if(typeof e=="string")return e.replace(z$,function(a,n,i){return Ln={name:n,styles:i,next:Ln},n})}return U$[s]!==1&&!l6(s)&&typeof e=="number"&&e!==0?e+"px":e};function Yu(t,s,e){if(e==null)return"";var a=e;if(a.__emotion_styles!==void 0)return a;switch(typeof e){case"boolean":return"";case"object":{var n=e;if(n.anim===1)return Ln={name:n.name,styles:n.styles,next:Ln},n.name;var i=e;if(i.styles!==void 0){var c=i.next;if(c!==void 0)for(;c!==void 0;)Ln={name:c.name,styles:c.styles,next:Ln},c=c.next;var l=i.styles+";";return l}return H$(t,s,e)}case"function":{if(t!==void 0){var u=Ln,o=e(t);return Ln=u,Yu(t,s,o)}break}}var d=e;return d}function H$(t,s,e){var a="";if(Array.isArray(e))for(var n=0;n<e.length;n++)a+=Yu(t,s,e[n])+";";else for(var i in e){var c=e[i];if(typeof c!="object"){var l=c;B_(l)&&(a+=Ip(i)+":"+D_(i,l)+";")}else if(Array.isArray(c)&&typeof c[0]=="string"&&s==null)for(var u=0;u<c.length;u++)B_(c[u])&&(a+=Ip(i)+":"+D_(i,c[u])+";");else{var o=Yu(t,s,c);switch(i){case"animation":case"animationName":{a+=Ip(i)+":"+o+";";break}default:a+=i+"{"+o+"}"}}}return a}var U_=/label:\s*([^\s;{]+)\s*(;|$)/g,Ln;function c6(t,s,e){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var a=!0,n="";Ln=void 0;var i=t[0];if(i==null||i.raw===void 0)a=!1,n+=Yu(e,s,i);else{var c=i;n+=c[0]}for(var l=1;l<t.length;l++)if(n+=Yu(e,s,t[l]),a){var u=i;n+=u[l]}U_.lastIndex=0;for(var o="",d;(d=U_.exec(n))!==null;)o+="-"+d[1];var g=D$(n)+o;return{name:g,styles:n,next:Ln}}var V$=function(s){return s()},q$=Nv.useInsertionEffect?Nv.useInsertionEffect:!1,G$=q$||V$,u6=ne.createContext(typeof HTMLElement<"u"?R$({key:"css"}):null);u6.Provider;var Y$=function(s){return ne.forwardRef(function(e,a){var n=ne.useContext(u6);return s(e,n,a)})},W$=ne.createContext({}),$x={}.hasOwnProperty,xg="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",X$=function(s,e){var a={};for(var n in e)$x.call(e,n)&&(a[n]=e[n]);return a[xg]=s,a},K$=function(s){var e=s.cache,a=s.serialized,n=s.isStringTag;return o6(e,a,n),G$(function(){return B$(e,a,n)}),null},Z$=Y$(function(t,s,e){var a=t.css;typeof a=="string"&&s.registered[a]!==void 0&&(a=s.registered[a]);var n=t[xg],i=[a],c="";typeof t.className=="string"?c=P$(s.registered,i,t.className):t.className!=null&&(c=t.className+" ");var l=c6(i,void 0,ne.useContext(W$));c+=s.key+"-"+l.name;var u={};for(var o in t)$x.call(t,o)&&o!=="css"&&o!==xg&&(u[o]=t[o]);return u.className=c,e&&(u.ref=e),ne.createElement(ne.Fragment,null,ne.createElement(K$,{cache:s,serialized:l,isStringTag:typeof n=="string"}),ne.createElement(n,u))}),Q$=Z$,Lt=function(s,e){var a=arguments;if(e==null||!$x.call(e,"css"))return ne.createElement.apply(void 0,a);var n=a.length,i=new Array(n);i[0]=Q$,i[1]=X$(s,e);for(var c=2;c<n;c++)i[c]=a[c];return ne.createElement.apply(null,i)};(function(t){var s;s||(s=t.JSX||(t.JSX={}))})(Lt||(Lt={}));function zx(){for(var t=arguments.length,s=new Array(t),e=0;e<t;e++)s[e]=arguments[e];return c6(s)}function J$(){var t=zx.apply(void 0,arguments),s="animation-"+t.name;return{name:s,styles:"@keyframes "+s+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function ez(t,s){return s||(s=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(s)}}))}const tz=Math.min,rz=Math.max,k0=Math.round,Ff=Math.floor,C0=t=>({x:t,y:t});function sz(t){const{x:s,y:e,width:a,height:n}=t;return{width:a,height:n,top:e,left:s,right:s+a,bottom:e+n,x:s,y:e}}function sh(){return typeof window<"u"}function d6(t){return h6(t)?(t.nodeName||"").toLowerCase():"#document"}function bi(t){var s;return(t==null||(s=t.ownerDocument)==null?void 0:s.defaultView)||window}function f6(t){var s;return(s=(h6(t)?t.ownerDocument:t.document)||window.document)==null?void 0:s.documentElement}function h6(t){return sh()?t instanceof Node||t instanceof bi(t).Node:!1}function az(t){return sh()?t instanceof Element||t instanceof bi(t).Element:!1}function Hx(t){return sh()?t instanceof HTMLElement||t instanceof bi(t).HTMLElement:!1}function $_(t){return!sh()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof bi(t).ShadowRoot}function m6(t){const{overflow:s,overflowX:e,overflowY:a,display:n}=Vx(t);return/auto|scroll|overlay|hidden|clip/.test(s+a+e)&&!["inline","contents"].includes(n)}function nz(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function iz(t){return["html","body","#document"].includes(d6(t))}function Vx(t){return bi(t).getComputedStyle(t)}function oz(t){if(d6(t)==="html")return t;const s=t.assignedSlot||t.parentNode||$_(t)&&t.host||f6(t);return $_(s)?s.host:s}function p6(t){const s=oz(t);return iz(s)?t.ownerDocument?t.ownerDocument.body:t.body:Hx(s)&&m6(s)?s:p6(s)}function E0(t,s,e){var a;s===void 0&&(s=[]),e===void 0&&(e=!0);const n=p6(t),i=n===((a=t.ownerDocument)==null?void 0:a.body),c=bi(n);if(i){const l=bg(c);return s.concat(c,c.visualViewport||[],m6(n)?n:[],l&&e?E0(l):[])}return s.concat(n,E0(n,[],e))}function bg(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function lz(t){const s=Vx(t);let e=parseFloat(s.width)||0,a=parseFloat(s.height)||0;const n=Hx(t),i=n?t.offsetWidth:e,c=n?t.offsetHeight:a,l=k0(e)!==i||k0(a)!==c;return l&&(e=i,a=c),{width:e,height:a,$:l}}function qx(t){return az(t)?t:t.contextElement}function z_(t){const s=qx(t);if(!Hx(s))return C0(1);const e=s.getBoundingClientRect(),{width:a,height:n,$:i}=lz(s);let c=(i?k0(e.width):e.width)/a,l=(i?k0(e.height):e.height)/n;return(!c||!Number.isFinite(c))&&(c=1),(!l||!Number.isFinite(l))&&(l=1),{x:c,y:l}}const cz=C0(0);function uz(t){const s=bi(t);return!nz()||!s.visualViewport?cz:{x:s.visualViewport.offsetLeft,y:s.visualViewport.offsetTop}}function dz(t,s,e){return!1}function H_(t,s,e,a){s===void 0&&(s=!1);const n=t.getBoundingClientRect(),i=qx(t);let c=C0(1);s&&(c=z_(t));const l=dz()?uz(i):C0(0);let u=(n.left+l.x)/c.x,o=(n.top+l.y)/c.y,d=n.width/c.x,g=n.height/c.y;if(i){const p=bi(i),h=a;let f=p,x=bg(f);for(;x&&a&&h!==f;){const b=z_(x),v=x.getBoundingClientRect(),_=Vx(x),N=v.left+(x.clientLeft+parseFloat(_.paddingLeft))*b.x,E=v.top+(x.clientTop+parseFloat(_.paddingTop))*b.y;u*=b.x,o*=b.y,d*=b.x,g*=b.y,u+=N,o+=E,f=bi(x),x=bg(f)}}return sz({width:d,height:g,x:u,y:o})}function g6(t,s){return t.x===s.x&&t.y===s.y&&t.width===s.width&&t.height===s.height}function fz(t,s){let e=null,a;const n=f6(t);function i(){var l;clearTimeout(a),(l=e)==null||l.disconnect(),e=null}function c(l,u){l===void 0&&(l=!1),u===void 0&&(u=1),i();const o=t.getBoundingClientRect(),{left:d,top:g,width:p,height:h}=o;if(l||s(),!p||!h)return;const f=Ff(g),x=Ff(n.clientWidth-(d+p)),b=Ff(n.clientHeight-(g+h)),v=Ff(d),N={rootMargin:-f+"px "+-x+"px "+-b+"px "+-v+"px",threshold:rz(0,tz(1,u))||1};let E=!0;function O(F){const z=F[0].intersectionRatio;if(z!==u){if(!E)return c();z?c(!1,z):a=setTimeout(()=>{c(!1,1e-7)},1e3)}z===1&&!g6(o,t.getBoundingClientRect())&&c(),E=!1}try{e=new IntersectionObserver(O,{...N,root:n.ownerDocument})}catch{e=new IntersectionObserver(O,N)}e.observe(t)}return c(!0),i}function hz(t,s,e,a){a===void 0&&(a={});const{ancestorScroll:n=!0,ancestorResize:i=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:u=!1}=a,o=qx(t),d=n||i?[...o?E0(o):[],...E0(s)]:[];d.forEach(v=>{n&&v.addEventListener("scroll",e,{passive:!0}),i&&v.addEventListener("resize",e)});const g=o&&l?fz(o,e):null;let p=-1,h=null;c&&(h=new ResizeObserver(v=>{let[_]=v;_&&_.target===o&&h&&(h.unobserve(s),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var N;(N=h)==null||N.observe(s)})),e()}),o&&!u&&h.observe(o),h.observe(s));let f,x=u?H_(t):null;u&&b();function b(){const v=H_(t);x&&!g6(x,v)&&e(),x=v,f=requestAnimationFrame(b)}return e(),()=>{var v;d.forEach(_=>{n&&_.removeEventListener("scroll",e),i&&_.removeEventListener("resize",e)}),g==null||g(),(v=h)==null||v.disconnect(),h=null,u&&cancelAnimationFrame(f)}}var yg=ne.useLayoutEffect,mz=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],T0=function(){};function pz(t,s){return s?s[0]==="-"?t+s:t+"__"+s:t}function gz(t,s){for(var e=arguments.length,a=new Array(e>2?e-2:0),n=2;n<e;n++)a[n-2]=arguments[n];var i=[].concat(a);if(s&&t)for(var c in s)s.hasOwnProperty(c)&&s[c]&&i.push("".concat(pz(t,c)));return i.filter(function(l){return l}).map(function(l){return String(l).trim()}).join(" ")}var V_=function(s){return Sz(s)?s.filter(Boolean):Xo(s)==="object"&&s!==null?[s]:[]},x6=function(s){s.className,s.clearValue,s.cx,s.getStyles,s.getClassNames,s.getValue,s.hasValue,s.isMulti,s.isRtl,s.options,s.selectOption,s.selectProps,s.setValue,s.theme;var e=vi(s,mz);return Bt({},e)},Vr=function(s,e,a){var n=s.cx,i=s.getStyles,c=s.getClassNames,l=s.className;return{css:i(e,s),className:n(a??{},c(e,s),l)}};function ah(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function xz(t){return ah(t)?window.innerHeight:t.clientHeight}function b6(t){return ah(t)?window.pageYOffset:t.scrollTop}function A0(t,s){if(ah(t)){window.scrollTo(0,s);return}t.scrollTop=s}function bz(t){var s=getComputedStyle(t),e=s.position==="absolute",a=/(auto|scroll)/;if(s.position==="fixed")return document.documentElement;for(var n=t;n=n.parentElement;)if(s=getComputedStyle(n),!(e&&s.position==="static")&&a.test(s.overflow+s.overflowY+s.overflowX))return n;return document.documentElement}function yz(t,s,e,a){return e*((t=t/a-1)*t*t+1)+s}function If(t,s){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:T0,n=b6(t),i=s-n,c=10,l=0;function u(){l+=c;var o=yz(l,n,i,e);A0(t,o),l<e?window.requestAnimationFrame(u):a(t)}u()}function q_(t,s){var e=t.getBoundingClientRect(),a=s.getBoundingClientRect(),n=s.offsetHeight/3;a.bottom+n>e.bottom?A0(t,Math.min(s.offsetTop+s.clientHeight-t.offsetHeight+n,t.scrollHeight)):a.top-n<e.top&&A0(t,Math.max(s.offsetTop-n,0))}function vz(t){var s=t.getBoundingClientRect();return{bottom:s.bottom,height:s.height,left:s.left,right:s.right,top:s.top,width:s.width}}function G_(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function _z(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var y6=!1,wz={get passive(){return y6=!0}},Lf=typeof window<"u"?window:{};Lf.addEventListener&&Lf.removeEventListener&&(Lf.addEventListener("p",T0,wz),Lf.removeEventListener("p",T0,!1));var Nz=y6;function jz(t){return t!=null}function Sz(t){return Array.isArray(t)}function Pf(t,s,e){return t?s:e}var kz=function(s){for(var e=arguments.length,a=new Array(e>1?e-1:0),n=1;n<e;n++)a[n-1]=arguments[n];var i=Object.entries(s).filter(function(c){var l=mi(c,1),u=l[0];return!a.includes(u)});return i.reduce(function(c,l){var u=mi(l,2),o=u[0],d=u[1];return c[o]=d,c},{})},Cz=["children","innerProps"],Ez=["children","innerProps"];function Tz(t){var s=t.maxHeight,e=t.menuEl,a=t.minHeight,n=t.placement,i=t.shouldScroll,c=t.isFixedPosition,l=t.controlHeight,u=bz(e),o={placement:"bottom",maxHeight:s};if(!e||!e.offsetParent)return o;var d=u.getBoundingClientRect(),g=d.height,p=e.getBoundingClientRect(),h=p.bottom,f=p.height,x=p.top,b=e.offsetParent.getBoundingClientRect(),v=b.top,_=c?window.innerHeight:xz(u),N=b6(u),E=parseInt(getComputedStyle(e).marginBottom,10),O=parseInt(getComputedStyle(e).marginTop,10),F=v-O,z=_-x,P=F+N,U=g-N-x,W=h-_+N+E,Y=N+x-O,q=160;switch(n){case"auto":case"bottom":if(z>=f)return{placement:"bottom",maxHeight:s};if(U>=f&&!c)return i&&If(u,W,q),{placement:"bottom",maxHeight:s};if(!c&&U>=a||c&&z>=a){i&&If(u,W,q);var M=c?z-E:U-E;return{placement:"bottom",maxHeight:M}}if(n==="auto"||c){var D=s,T=c?F:P;return T>=a&&(D=Math.min(T-E-l,s)),{placement:"top",maxHeight:D}}if(n==="bottom")return i&&A0(u,W),{placement:"bottom",maxHeight:s};break;case"top":if(F>=f)return{placement:"top",maxHeight:s};if(P>=f&&!c)return i&&If(u,Y,q),{placement:"top",maxHeight:s};if(!c&&P>=a||c&&F>=a){var C=s;return(!c&&P>=a||c&&F>=a)&&(C=c?F-O:P-O),i&&If(u,Y,q),{placement:"top",maxHeight:C}}return{placement:"bottom",maxHeight:s};default:throw new Error('Invalid placement provided "'.concat(n,'".'))}return o}function Az(t){var s={bottom:"top",top:"bottom"};return t?s[t]:"bottom"}var v6=function(s){return s==="auto"?"bottom":s},Oz=function(s,e){var a,n=s.placement,i=s.theme,c=i.borderRadius,l=i.spacing,u=i.colors;return Bt((a={label:"menu"},_u(a,Az(n),"100%"),_u(a,"position","absolute"),_u(a,"width","100%"),_u(a,"zIndex",1),a),e?{}:{backgroundColor:u.neutral0,borderRadius:c,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:l.menuGutter,marginTop:l.menuGutter})},_6=ne.createContext(null),Rz=function(s){var e=s.children,a=s.minMenuHeight,n=s.maxMenuHeight,i=s.menuPlacement,c=s.menuPosition,l=s.menuShouldScrollIntoView,u=s.theme,o=ne.useContext(_6)||{},d=o.setPortalPlacement,g=ne.useRef(null),p=ne.useState(n),h=mi(p,2),f=h[0],x=h[1],b=ne.useState(null),v=mi(b,2),_=v[0],N=v[1],E=u.spacing.controlHeight;return yg(function(){var O=g.current;if(O){var F=c==="fixed",z=l&&!F,P=Tz({maxHeight:n,menuEl:O,minHeight:a,placement:i,shouldScroll:z,isFixedPosition:F,controlHeight:E});x(P.maxHeight),N(P.placement),d==null||d(P.placement)}},[n,i,c,l,a,d,E]),e({ref:g,placerProps:Bt(Bt({},s),{},{placement:_||v6(i),maxHeight:f})})},Mz=function(s){var e=s.children,a=s.innerRef,n=s.innerProps;return Lt("div",zt({},Vr(s,"menu",{menu:!0}),{ref:a},n),e)},Fz=Mz,Iz=function(s,e){var a=s.maxHeight,n=s.theme.spacing.baseUnit;return Bt({maxHeight:a,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},e?{}:{paddingBottom:n,paddingTop:n})},Lz=function(s){var e=s.children,a=s.innerProps,n=s.innerRef,i=s.isMulti;return Lt("div",zt({},Vr(s,"menuList",{"menu-list":!0,"menu-list--is-multi":i}),{ref:n},a),e)},w6=function(s,e){var a=s.theme,n=a.spacing.baseUnit,i=a.colors;return Bt({textAlign:"center"},e?{}:{color:i.neutral40,padding:"".concat(n*2,"px ").concat(n*3,"px")})},Pz=w6,Bz=w6,Dz=function(s){var e=s.children,a=e===void 0?"No options":e,n=s.innerProps,i=vi(s,Cz);return Lt("div",zt({},Vr(Bt(Bt({},i),{},{children:a,innerProps:n}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),n),a)},Uz=function(s){var e=s.children,a=e===void 0?"Loading...":e,n=s.innerProps,i=vi(s,Ez);return Lt("div",zt({},Vr(Bt(Bt({},i),{},{children:a,innerProps:n}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),n),a)},$z=function(s){var e=s.rect,a=s.offset,n=s.position;return{left:e.left,position:n,top:a,width:e.width,zIndex:1}},zz=function(s){var e=s.appendTo,a=s.children,n=s.controlElement,i=s.innerProps,c=s.menuPlacement,l=s.menuPosition,u=ne.useRef(null),o=ne.useRef(null),d=ne.useState(v6(c)),g=mi(d,2),p=g[0],h=g[1],f=ne.useMemo(function(){return{setPortalPlacement:h}},[]),x=ne.useState(null),b=mi(x,2),v=b[0],_=b[1],N=ne.useCallback(function(){if(n){var z=vz(n),P=l==="fixed"?0:window.pageYOffset,U=z[p]+P;(U!==(v==null?void 0:v.offset)||z.left!==(v==null?void 0:v.rect.left)||z.width!==(v==null?void 0:v.rect.width))&&_({offset:U,rect:z})}},[n,l,p,v==null?void 0:v.offset,v==null?void 0:v.rect.left,v==null?void 0:v.rect.width]);yg(function(){N()},[N]);var E=ne.useCallback(function(){typeof o.current=="function"&&(o.current(),o.current=null),n&&u.current&&(o.current=hz(n,u.current,N,{elementResize:"ResizeObserver"in window}))},[n,N]);yg(function(){E()},[E]);var O=ne.useCallback(function(z){u.current=z,E()},[E]);if(!e&&l!=="fixed"||!v)return null;var F=Lt("div",zt({ref:O},Vr(Bt(Bt({},s),{},{offset:v.offset,position:l,rect:v.rect}),"menuPortal",{"menu-portal":!0}),i),a);return Lt(_6.Provider,{value:f},e?Cw.createPortal(F,e):F)},Hz=function(s){var e=s.isDisabled,a=s.isRtl;return{label:"container",direction:a?"rtl":void 0,pointerEvents:e?"none":void 0,position:"relative"}},Vz=function(s){var e=s.children,a=s.innerProps,n=s.isDisabled,i=s.isRtl;return Lt("div",zt({},Vr(s,"container",{"--is-disabled":n,"--is-rtl":i}),a),e)},qz=function(s,e){var a=s.theme.spacing,n=s.isMulti,i=s.hasValue,c=s.selectProps.controlShouldRenderValue;return Bt({alignItems:"center",display:n&&i&&c?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},e?{}:{padding:"".concat(a.baseUnit/2,"px ").concat(a.baseUnit*2,"px")})},Gz=function(s){var e=s.children,a=s.innerProps,n=s.isMulti,i=s.hasValue;return Lt("div",zt({},Vr(s,"valueContainer",{"value-container":!0,"value-container--is-multi":n,"value-container--has-value":i}),a),e)},Yz=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},Wz=function(s){var e=s.children,a=s.innerProps;return Lt("div",zt({},Vr(s,"indicatorsContainer",{indicators:!0}),a),e)},Y_,Xz=["size"],Kz=["innerProps","isRtl","size"],Zz={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},N6=function(s){var e=s.size,a=vi(s,Xz);return Lt("svg",zt({height:e,width:e,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Zz},a))},Gx=function(s){return Lt(N6,zt({size:20},s),Lt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},j6=function(s){return Lt(N6,zt({size:20},s),Lt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},S6=function(s,e){var a=s.isFocused,n=s.theme,i=n.spacing.baseUnit,c=n.colors;return Bt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},e?{}:{color:a?c.neutral60:c.neutral20,padding:i*2,":hover":{color:a?c.neutral80:c.neutral40}})},Qz=S6,Jz=function(s){var e=s.children,a=s.innerProps;return Lt("div",zt({},Vr(s,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),a),e||Lt(j6,null))},eH=S6,tH=function(s){var e=s.children,a=s.innerProps;return Lt("div",zt({},Vr(s,"clearIndicator",{indicator:!0,"clear-indicator":!0}),a),e||Lt(Gx,null))},rH=function(s,e){var a=s.isDisabled,n=s.theme,i=n.spacing.baseUnit,c=n.colors;return Bt({label:"indicatorSeparator",alignSelf:"stretch",width:1},e?{}:{backgroundColor:a?c.neutral10:c.neutral20,marginBottom:i*2,marginTop:i*2})},sH=function(s){var e=s.innerProps;return Lt("span",zt({},e,Vr(s,"indicatorSeparator",{"indicator-separator":!0})))},aH=J$(Y_||(Y_=ez([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),nH=function(s,e){var a=s.isFocused,n=s.size,i=s.theme,c=i.colors,l=i.spacing.baseUnit;return Bt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:n,lineHeight:1,marginRight:n,textAlign:"center",verticalAlign:"middle"},e?{}:{color:a?c.neutral60:c.neutral20,padding:l*2})},Lp=function(s){var e=s.delay,a=s.offset;return Lt("span",{css:zx({animation:"".concat(aH," 1s ease-in-out ").concat(e,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:a?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},iH=function(s){var e=s.innerProps,a=s.isRtl,n=s.size,i=n===void 0?4:n,c=vi(s,Kz);return Lt("div",zt({},Vr(Bt(Bt({},c),{},{innerProps:e,isRtl:a,size:i}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),e),Lt(Lp,{delay:0,offset:a}),Lt(Lp,{delay:160,offset:!0}),Lt(Lp,{delay:320,offset:!a}))},oH=function(s,e){var a=s.isDisabled,n=s.isFocused,i=s.theme,c=i.colors,l=i.borderRadius,u=i.spacing;return Bt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},e?{}:{backgroundColor:a?c.neutral5:c.neutral0,borderColor:a?c.neutral10:n?c.primary:c.neutral20,borderRadius:l,borderStyle:"solid",borderWidth:1,boxShadow:n?"0 0 0 1px ".concat(c.primary):void 0,"&:hover":{borderColor:n?c.primary:c.neutral30}})},lH=function(s){var e=s.children,a=s.isDisabled,n=s.isFocused,i=s.innerRef,c=s.innerProps,l=s.menuIsOpen;return Lt("div",zt({ref:i},Vr(s,"control",{control:!0,"control--is-disabled":a,"control--is-focused":n,"control--menu-is-open":l}),c,{"aria-disabled":a||void 0}),e)},cH=lH,uH=["data"],dH=function(s,e){var a=s.theme.spacing;return e?{}:{paddingBottom:a.baseUnit*2,paddingTop:a.baseUnit*2}},fH=function(s){var e=s.children,a=s.cx,n=s.getStyles,i=s.getClassNames,c=s.Heading,l=s.headingProps,u=s.innerProps,o=s.label,d=s.theme,g=s.selectProps;return Lt("div",zt({},Vr(s,"group",{group:!0}),u),Lt(c,zt({},l,{selectProps:g,theme:d,getStyles:n,getClassNames:i,cx:a}),o),Lt("div",null,e))},hH=function(s,e){var a=s.theme,n=a.colors,i=a.spacing;return Bt({label:"group",cursor:"default",display:"block"},e?{}:{color:n.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:i.baseUnit*3,paddingRight:i.baseUnit*3,textTransform:"uppercase"})},mH=function(s){var e=x6(s);e.data;var a=vi(e,uH);return Lt("div",zt({},Vr(s,"groupHeading",{"group-heading":!0}),a))},pH=fH,gH=["innerRef","isDisabled","isHidden","inputClassName"],xH=function(s,e){var a=s.isDisabled,n=s.value,i=s.theme,c=i.spacing,l=i.colors;return Bt(Bt({visibility:a?"hidden":"visible",transform:n?"translateZ(0)":""},bH),e?{}:{margin:c.baseUnit/2,paddingBottom:c.baseUnit/2,paddingTop:c.baseUnit/2,color:l.neutral80})},k6={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},bH={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Bt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},k6)},yH=function(s){return Bt({label:"input",color:"inherit",background:0,opacity:s?0:1,width:"100%"},k6)},vH=function(s){var e=s.cx,a=s.value,n=x6(s),i=n.innerRef,c=n.isDisabled,l=n.isHidden,u=n.inputClassName,o=vi(n,gH);return Lt("div",zt({},Vr(s,"input",{"input-container":!0}),{"data-value":a||""}),Lt("input",zt({className:e({input:!0},u),ref:i,style:yH(l),disabled:c},o)))},_H=vH,wH=function(s,e){var a=s.theme,n=a.spacing,i=a.borderRadius,c=a.colors;return Bt({label:"multiValue",display:"flex",minWidth:0},e?{}:{backgroundColor:c.neutral10,borderRadius:i/2,margin:n.baseUnit/2})},NH=function(s,e){var a=s.theme,n=a.borderRadius,i=a.colors,c=s.cropWithEllipsis;return Bt({overflow:"hidden",textOverflow:c||c===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},e?{}:{borderRadius:n/2,color:i.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},jH=function(s,e){var a=s.theme,n=a.spacing,i=a.borderRadius,c=a.colors,l=s.isFocused;return Bt({alignItems:"center",display:"flex"},e?{}:{borderRadius:i/2,backgroundColor:l?c.dangerLight:void 0,paddingLeft:n.baseUnit,paddingRight:n.baseUnit,":hover":{backgroundColor:c.dangerLight,color:c.danger}})},C6=function(s){var e=s.children,a=s.innerProps;return Lt("div",a,e)},SH=C6,kH=C6;function CH(t){var s=t.children,e=t.innerProps;return Lt("div",zt({role:"button"},e),s||Lt(Gx,{size:14}))}var EH=function(s){var e=s.children,a=s.components,n=s.data,i=s.innerProps,c=s.isDisabled,l=s.removeProps,u=s.selectProps,o=a.Container,d=a.Label,g=a.Remove;return Lt(o,{data:n,innerProps:Bt(Bt({},Vr(s,"multiValue",{"multi-value":!0,"multi-value--is-disabled":c})),i),selectProps:u},Lt(d,{data:n,innerProps:Bt({},Vr(s,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},e),Lt(g,{data:n,innerProps:Bt(Bt({},Vr(s,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(e||"option")},l),selectProps:u}))},TH=EH,AH=function(s,e){var a=s.isDisabled,n=s.isFocused,i=s.isSelected,c=s.theme,l=c.spacing,u=c.colors;return Bt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},e?{}:{backgroundColor:i?u.primary:n?u.primary25:"transparent",color:a?u.neutral20:i?u.neutral0:"inherit",padding:"".concat(l.baseUnit*2,"px ").concat(l.baseUnit*3,"px"),":active":{backgroundColor:a?void 0:i?u.primary:u.primary50}})},OH=function(s){var e=s.children,a=s.isDisabled,n=s.isFocused,i=s.isSelected,c=s.innerRef,l=s.innerProps;return Lt("div",zt({},Vr(s,"option",{option:!0,"option--is-disabled":a,"option--is-focused":n,"option--is-selected":i}),{ref:c,"aria-disabled":a},l),e)},RH=OH,MH=function(s,e){var a=s.theme,n=a.spacing,i=a.colors;return Bt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},e?{}:{color:i.neutral50,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2})},FH=function(s){var e=s.children,a=s.innerProps;return Lt("div",zt({},Vr(s,"placeholder",{placeholder:!0}),a),e)},IH=FH,LH=function(s,e){var a=s.isDisabled,n=s.theme,i=n.spacing,c=n.colors;return Bt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e?{}:{color:a?c.neutral40:c.neutral80,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},PH=function(s){var e=s.children,a=s.isDisabled,n=s.innerProps;return Lt("div",zt({},Vr(s,"singleValue",{"single-value":!0,"single-value--is-disabled":a}),n),e)},BH=PH,DH={ClearIndicator:tH,Control:cH,DropdownIndicator:Jz,DownChevron:j6,CrossIcon:Gx,Group:pH,GroupHeading:mH,IndicatorsContainer:Wz,IndicatorSeparator:sH,Input:_H,LoadingIndicator:iH,Menu:Fz,MenuList:Lz,MenuPortal:zz,LoadingMessage:Uz,NoOptionsMessage:Dz,MultiValue:TH,MultiValueContainer:SH,MultiValueLabel:kH,MultiValueRemove:CH,Option:RH,Placeholder:IH,SelectContainer:Vz,SingleValue:BH,ValueContainer:Gz},UH=function(s){return Bt(Bt({},DH),s.components)},W_=Number.isNaN||function(s){return typeof s=="number"&&s!==s};function $H(t,s){return!!(t===s||W_(t)&&W_(s))}function zH(t,s){if(t.length!==s.length)return!1;for(var e=0;e<t.length;e++)if(!$H(t[e],s[e]))return!1;return!0}function HH(t,s){s===void 0&&(s=zH);var e=null;function a(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(e&&e.lastThis===this&&s(n,e.lastArgs))return e.lastResult;var c=t.apply(this,n);return e={lastResult:c,lastArgs:n,lastThis:this},c}return a.clear=function(){e=null},a}var VH={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},qH=function(s){return Lt("span",zt({css:VH},s))},X_=qH,GH={guidance:function(s){var e=s.isSearchable,a=s.isMulti,n=s.tabSelectsValue,i=s.context,c=s.isInitialFocus;switch(i){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(n?", press Tab to select the option and exit the menu":"",".");case"input":return c?"".concat(s["aria-label"]||"Select"," is focused ").concat(e?",type to refine list":"",", press Down to open the menu, ").concat(a?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(s){var e=s.action,a=s.label,n=a===void 0?"":a,i=s.labels,c=s.isDisabled;switch(e){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(n,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(i.length>1?"s":""," ").concat(i.join(","),", selected.");case"select-option":return c?"option ".concat(n," is disabled. Select another option."):"option ".concat(n,", selected.");default:return""}},onFocus:function(s){var e=s.context,a=s.focused,n=s.options,i=s.label,c=i===void 0?"":i,l=s.selectValue,u=s.isDisabled,o=s.isSelected,d=s.isAppleDevice,g=function(x,b){return x&&x.length?"".concat(x.indexOf(b)+1," of ").concat(x.length):""};if(e==="value"&&l)return"value ".concat(c," focused, ").concat(g(l,a),".");if(e==="menu"&&d){var p=u?" disabled":"",h="".concat(o?" selected":"").concat(p);return"".concat(c).concat(h,", ").concat(g(n,a),".")}return""},onFilter:function(s){var e=s.inputValue,a=s.resultsMessage;return"".concat(a).concat(e?" for search term "+e:"",".")}},YH=function(s){var e=s.ariaSelection,a=s.focusedOption,n=s.focusedValue,i=s.focusableOptions,c=s.isFocused,l=s.selectValue,u=s.selectProps,o=s.id,d=s.isAppleDevice,g=u.ariaLiveMessages,p=u.getOptionLabel,h=u.inputValue,f=u.isMulti,x=u.isOptionDisabled,b=u.isSearchable,v=u.menuIsOpen,_=u.options,N=u.screenReaderStatus,E=u.tabSelectsValue,O=u.isLoading,F=u["aria-label"],z=u["aria-live"],P=ne.useMemo(function(){return Bt(Bt({},GH),g||{})},[g]),U=ne.useMemo(function(){var T="";if(e&&P.onChange){var C=e.option,S=e.options,w=e.removedValue,j=e.removedValues,A=e.value,L=function(V){return Array.isArray(V)?null:V},I=w||C||L(A),Z=I?p(I):"",K=S||j||void 0,re=K?K.map(p):[],G=Bt({isDisabled:I&&x(I,l),label:Z,labels:re},e);T=P.onChange(G)}return T},[e,P,x,l,p]),W=ne.useMemo(function(){var T="",C=a||n,S=!!(a&&l&&l.includes(a));if(C&&P.onFocus){var w={focused:C,label:p(C),isDisabled:x(C,l),isSelected:S,options:i,context:C===a?"menu":"value",selectValue:l,isAppleDevice:d};T=P.onFocus(w)}return T},[a,n,p,x,P,i,l,d]),Y=ne.useMemo(function(){var T="";if(v&&_.length&&!O&&P.onFilter){var C=N({count:i.length});T=P.onFilter({inputValue:h,resultsMessage:C})}return T},[i,h,v,P,_,N,O]),q=(e==null?void 0:e.action)==="initial-input-focus",M=ne.useMemo(function(){var T="";if(P.guidance){var C=n?"value":v?"menu":"input";T=P.guidance({"aria-label":F,context:C,isDisabled:a&&x(a,l),isMulti:f,isSearchable:b,tabSelectsValue:E,isInitialFocus:q})}return T},[F,a,n,f,x,b,v,P,l,E,q]),D=Lt(ne.Fragment,null,Lt("span",{id:"aria-selection"},U),Lt("span",{id:"aria-focused"},W),Lt("span",{id:"aria-results"},Y),Lt("span",{id:"aria-guidance"},M));return Lt(ne.Fragment,null,Lt(X_,{id:o},q&&D),Lt(X_,{"aria-live":z,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},c&&!q&&D))},WH=YH,vg=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],XH=new RegExp("["+vg.map(function(t){return t.letters}).join("")+"]","g"),E6={};for(var Pp=0;Pp<vg.length;Pp++)for(var Bp=vg[Pp],Dp=0;Dp<Bp.letters.length;Dp++)E6[Bp.letters[Dp]]=Bp.base;var T6=function(s){return s.replace(XH,function(e){return E6[e]})},KH=HH(T6),K_=function(s){return s.replace(/^\s+|\s+$/g,"")},ZH=function(s){return"".concat(s.label," ").concat(s.value)},QH=function(s){return function(e,a){if(e.data.__isNew__)return!0;var n=Bt({ignoreCase:!0,ignoreAccents:!0,stringify:ZH,trim:!0,matchFrom:"any"},s),i=n.ignoreCase,c=n.ignoreAccents,l=n.stringify,u=n.trim,o=n.matchFrom,d=u?K_(a):a,g=u?K_(l(e)):l(e);return i&&(d=d.toLowerCase(),g=g.toLowerCase()),c&&(d=KH(d),g=T6(g)),o==="start"?g.substr(0,d.length)===d:g.indexOf(d)>-1}},JH=["innerRef"];function eV(t){var s=t.innerRef,e=vi(t,JH),a=kz(e,"onExited","in","enter","exit","appear");return Lt("input",zt({ref:s},a,{css:zx({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var tV=function(s){s.cancelable&&s.preventDefault(),s.stopPropagation()};function rV(t){var s=t.isEnabled,e=t.onBottomArrive,a=t.onBottomLeave,n=t.onTopArrive,i=t.onTopLeave,c=ne.useRef(!1),l=ne.useRef(!1),u=ne.useRef(0),o=ne.useRef(null),d=ne.useCallback(function(b,v){if(o.current!==null){var _=o.current,N=_.scrollTop,E=_.scrollHeight,O=_.clientHeight,F=o.current,z=v>0,P=E-O-N,U=!1;P>v&&c.current&&(a&&a(b),c.current=!1),z&&l.current&&(i&&i(b),l.current=!1),z&&v>P?(e&&!c.current&&e(b),F.scrollTop=E,U=!0,c.current=!0):!z&&-v>N&&(n&&!l.current&&n(b),F.scrollTop=0,U=!0,l.current=!0),U&&tV(b)}},[e,a,n,i]),g=ne.useCallback(function(b){d(b,b.deltaY)},[d]),p=ne.useCallback(function(b){u.current=b.changedTouches[0].clientY},[]),h=ne.useCallback(function(b){var v=u.current-b.changedTouches[0].clientY;d(b,v)},[d]),f=ne.useCallback(function(b){if(b){var v=Nz?{passive:!1}:!1;b.addEventListener("wheel",g,v),b.addEventListener("touchstart",p,v),b.addEventListener("touchmove",h,v)}},[h,p,g]),x=ne.useCallback(function(b){b&&(b.removeEventListener("wheel",g,!1),b.removeEventListener("touchstart",p,!1),b.removeEventListener("touchmove",h,!1))},[h,p,g]);return ne.useEffect(function(){if(s){var b=o.current;return f(b),function(){x(b)}}},[s,f,x]),function(b){o.current=b}}var Z_=["boxSizing","height","overflow","paddingRight","position"],Q_={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function J_(t){t.cancelable&&t.preventDefault()}function ew(t){t.stopPropagation()}function tw(){var t=this.scrollTop,s=this.scrollHeight,e=t+this.offsetHeight;t===0?this.scrollTop=1:e===s&&(this.scrollTop=t-1)}function rw(){return"ontouchstart"in window||navigator.maxTouchPoints}var sw=!!(typeof window<"u"&&window.document&&window.document.createElement),gu=0,Il={capture:!1,passive:!1};function sV(t){var s=t.isEnabled,e=t.accountForScrollbars,a=e===void 0?!0:e,n=ne.useRef({}),i=ne.useRef(null),c=ne.useCallback(function(u){if(sw){var o=document.body,d=o&&o.style;if(a&&Z_.forEach(function(f){var x=d&&d[f];n.current[f]=x}),a&&gu<1){var g=parseInt(n.current.paddingRight,10)||0,p=document.body?document.body.clientWidth:0,h=window.innerWidth-p+g||0;Object.keys(Q_).forEach(function(f){var x=Q_[f];d&&(d[f]=x)}),d&&(d.paddingRight="".concat(h,"px"))}o&&rw()&&(o.addEventListener("touchmove",J_,Il),u&&(u.addEventListener("touchstart",tw,Il),u.addEventListener("touchmove",ew,Il))),gu+=1}},[a]),l=ne.useCallback(function(u){if(sw){var o=document.body,d=o&&o.style;gu=Math.max(gu-1,0),a&&gu<1&&Z_.forEach(function(g){var p=n.current[g];d&&(d[g]=p)}),o&&rw()&&(o.removeEventListener("touchmove",J_,Il),u&&(u.removeEventListener("touchstart",tw,Il),u.removeEventListener("touchmove",ew,Il)))}},[a]);return ne.useEffect(function(){if(s){var u=i.current;return c(u),function(){l(u)}}},[s,c,l]),function(u){i.current=u}}var aV=function(s){var e=s.target;return e.ownerDocument.activeElement&&e.ownerDocument.activeElement.blur()},nV={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function iV(t){var s=t.children,e=t.lockEnabled,a=t.captureEnabled,n=a===void 0?!0:a,i=t.onBottomArrive,c=t.onBottomLeave,l=t.onTopArrive,u=t.onTopLeave,o=rV({isEnabled:n,onBottomArrive:i,onBottomLeave:c,onTopArrive:l,onTopLeave:u}),d=sV({isEnabled:e}),g=function(h){o(h),d(h)};return Lt(ne.Fragment,null,e&&Lt("div",{onClick:aV,css:nV}),s(g))}var oV={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},lV=function(s){var e=s.name,a=s.onFocus;return Lt("input",{required:!0,name:e,tabIndex:-1,"aria-hidden":"true",onFocus:a,css:oV,value:"",onChange:function(){}})},cV=lV;function Yx(t){var s;return typeof window<"u"&&window.navigator!=null?t.test(((s=window.navigator.userAgentData)===null||s===void 0?void 0:s.platform)||window.navigator.platform):!1}function uV(){return Yx(/^iPhone/i)}function A6(){return Yx(/^Mac/i)}function dV(){return Yx(/^iPad/i)||A6()&&navigator.maxTouchPoints>1}function fV(){return uV()||dV()}function hV(){return A6()||fV()}var mV=function(s){return s.label},pV=function(s){return s.label},gV=function(s){return s.value},xV=function(s){return!!s.isDisabled},bV={clearIndicator:eH,container:Hz,control:oH,dropdownIndicator:Qz,group:dH,groupHeading:hH,indicatorsContainer:Yz,indicatorSeparator:rH,input:xH,loadingIndicator:nH,loadingMessage:Bz,menu:Oz,menuList:Iz,menuPortal:$z,multiValue:wH,multiValueLabel:NH,multiValueRemove:jH,noOptionsMessage:Pz,option:AH,placeholder:MH,singleValue:LH,valueContainer:qz},yV={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},vV=4,O6=4,_V=38,wV=O6*2,NV={baseUnit:O6,controlHeight:_V,menuGutter:wV},Up={borderRadius:vV,colors:yV,spacing:NV},jV={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:G_(),captureMenuScroll:!G_(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:QH(),formatGroupLabel:mV,getOptionLabel:pV,getOptionValue:gV,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:xV,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!_z(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(s){var e=s.count;return"".concat(e," result").concat(e!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function aw(t,s,e,a){var n=F6(t,s,e),i=I6(t,s,e),c=M6(t,s),l=O0(t,s);return{type:"option",data:s,isDisabled:n,isSelected:i,label:c,value:l,index:a}}function Xf(t,s){return t.options.map(function(e,a){if("options"in e){var n=e.options.map(function(c,l){return aw(t,c,s,l)}).filter(function(c){return iw(t,c)});return n.length>0?{type:"group",data:e,options:n,index:a}:void 0}var i=aw(t,e,s,a);return iw(t,i)?i:void 0}).filter(jz)}function R6(t){return t.reduce(function(s,e){return e.type==="group"?s.push.apply(s,Px(e.options.map(function(a){return a.data}))):s.push(e.data),s},[])}function nw(t,s){return t.reduce(function(e,a){return a.type==="group"?e.push.apply(e,Px(a.options.map(function(n){return{data:n.data,id:"".concat(s,"-").concat(a.index,"-").concat(n.index)}}))):e.push({data:a.data,id:"".concat(s,"-").concat(a.index)}),e},[])}function SV(t,s){return R6(Xf(t,s))}function iw(t,s){var e=t.inputValue,a=e===void 0?"":e,n=s.data,i=s.isSelected,c=s.label,l=s.value;return(!P6(t)||!i)&&L6(t,{label:c,value:l,data:n},a)}function kV(t,s){var e=t.focusedValue,a=t.selectValue,n=a.indexOf(e);if(n>-1){var i=s.indexOf(e);if(i>-1)return e;if(n<s.length)return s[n]}return null}function CV(t,s){var e=t.focusedOption;return e&&s.indexOf(e)>-1?e:s[0]}var $p=function(s,e){var a,n=(a=s.find(function(i){return i.data===e}))===null||a===void 0?void 0:a.id;return n||null},M6=function(s,e){return s.getOptionLabel(e)},O0=function(s,e){return s.getOptionValue(e)};function F6(t,s,e){return typeof t.isOptionDisabled=="function"?t.isOptionDisabled(s,e):!1}function I6(t,s,e){if(e.indexOf(s)>-1)return!0;if(typeof t.isOptionSelected=="function")return t.isOptionSelected(s,e);var a=O0(t,s);return e.some(function(n){return O0(t,n)===a})}function L6(t,s,e){return t.filterOption?t.filterOption(s,e):!0}var P6=function(s){var e=s.hideSelectedOptions,a=s.isMulti;return e===void 0?a:e},EV=1,B6=function(t){KU(e,t);var s=JU(e);function e(a){var n;if(WU(this,e),n=s.call(this,a),n.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},n.blockOptionHover=!1,n.isComposing=!1,n.commonProps=void 0,n.initialTouchX=0,n.initialTouchY=0,n.openAfterFocus=!1,n.scrollToFocusedOptionOnUpdate=!1,n.userIsDragging=void 0,n.isAppleDevice=hV(),n.controlRef=null,n.getControlRef=function(u){n.controlRef=u},n.focusedOptionRef=null,n.getFocusedOptionRef=function(u){n.focusedOptionRef=u},n.menuListRef=null,n.getMenuListRef=function(u){n.menuListRef=u},n.inputRef=null,n.getInputRef=function(u){n.inputRef=u},n.focus=n.focusInput,n.blur=n.blurInput,n.onChange=function(u,o){var d=n.props,g=d.onChange,p=d.name;o.name=p,n.ariaOnChange(u,o),g(u,o)},n.setValue=function(u,o,d){var g=n.props,p=g.closeMenuOnSelect,h=g.isMulti,f=g.inputValue;n.onInputChange("",{action:"set-value",prevInputValue:f}),p&&(n.setState({inputIsHiddenAfterUpdate:!h}),n.onMenuClose()),n.setState({clearFocusValueOnUpdate:!0}),n.onChange(u,{action:o,option:d})},n.selectOption=function(u){var o=n.props,d=o.blurInputOnSelect,g=o.isMulti,p=o.name,h=n.state.selectValue,f=g&&n.isOptionSelected(u,h),x=n.isOptionDisabled(u,h);if(f){var b=n.getOptionValue(u);n.setValue(h.filter(function(v){return n.getOptionValue(v)!==b}),"deselect-option",u)}else if(!x)g?n.setValue([].concat(Px(h),[u]),"select-option",u):n.setValue(u,"select-option");else{n.ariaOnChange(u,{action:"select-option",option:u,name:p});return}d&&n.blurInput()},n.removeValue=function(u){var o=n.props.isMulti,d=n.state.selectValue,g=n.getOptionValue(u),p=d.filter(function(f){return n.getOptionValue(f)!==g}),h=Pf(o,p,p[0]||null);n.onChange(h,{action:"remove-value",removedValue:u}),n.focusInput()},n.clearValue=function(){var u=n.state.selectValue;n.onChange(Pf(n.props.isMulti,[],null),{action:"clear",removedValues:u})},n.popValue=function(){var u=n.props.isMulti,o=n.state.selectValue,d=o[o.length-1],g=o.slice(0,o.length-1),p=Pf(u,g,g[0]||null);d&&n.onChange(p,{action:"pop-value",removedValue:d})},n.getFocusedOptionId=function(u){return $p(n.state.focusableOptionsWithIds,u)},n.getFocusableOptionsWithIds=function(){return nw(Xf(n.props,n.state.selectValue),n.getElementId("option"))},n.getValue=function(){return n.state.selectValue},n.cx=function(){for(var u=arguments.length,o=new Array(u),d=0;d<u;d++)o[d]=arguments[d];return gz.apply(void 0,[n.props.classNamePrefix].concat(o))},n.getOptionLabel=function(u){return M6(n.props,u)},n.getOptionValue=function(u){return O0(n.props,u)},n.getStyles=function(u,o){var d=n.props.unstyled,g=bV[u](o,d);g.boxSizing="border-box";var p=n.props.styles[u];return p?p(g,o):g},n.getClassNames=function(u,o){var d,g;return(d=(g=n.props.classNames)[u])===null||d===void 0?void 0:d.call(g,o)},n.getElementId=function(u){return"".concat(n.state.instancePrefix,"-").concat(u)},n.getComponents=function(){return UH(n.props)},n.buildCategorizedOptions=function(){return Xf(n.props,n.state.selectValue)},n.getCategorizedOptions=function(){return n.props.menuIsOpen?n.buildCategorizedOptions():[]},n.buildFocusableOptions=function(){return R6(n.buildCategorizedOptions())},n.getFocusableOptions=function(){return n.props.menuIsOpen?n.buildFocusableOptions():[]},n.ariaOnChange=function(u,o){n.setState({ariaSelection:Bt({value:u},o)})},n.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),n.focusInput())},n.onMenuMouseMove=function(u){n.blockOptionHover=!1},n.onControlMouseDown=function(u){if(!u.defaultPrevented){var o=n.props.openMenuOnClick;n.state.isFocused?n.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&n.onMenuClose():o&&n.openMenu("first"):(o&&(n.openAfterFocus=!0),n.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},n.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!n.props.isDisabled){var o=n.props,d=o.isMulti,g=o.menuIsOpen;n.focusInput(),g?(n.setState({inputIsHiddenAfterUpdate:!d}),n.onMenuClose()):n.openMenu("first"),u.preventDefault()}},n.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(n.clearValue(),u.preventDefault(),n.openAfterFocus=!1,u.type==="touchend"?n.focusInput():setTimeout(function(){return n.focusInput()}))},n.onScroll=function(u){typeof n.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&ah(u.target)&&n.props.onMenuClose():typeof n.props.closeMenuOnScroll=="function"&&n.props.closeMenuOnScroll(u)&&n.props.onMenuClose()},n.onCompositionStart=function(){n.isComposing=!0},n.onCompositionEnd=function(){n.isComposing=!1},n.onTouchStart=function(u){var o=u.touches,d=o&&o.item(0);d&&(n.initialTouchX=d.clientX,n.initialTouchY=d.clientY,n.userIsDragging=!1)},n.onTouchMove=function(u){var o=u.touches,d=o&&o.item(0);if(d){var g=Math.abs(d.clientX-n.initialTouchX),p=Math.abs(d.clientY-n.initialTouchY),h=5;n.userIsDragging=g>h||p>h}},n.onTouchEnd=function(u){n.userIsDragging||(n.controlRef&&!n.controlRef.contains(u.target)&&n.menuListRef&&!n.menuListRef.contains(u.target)&&n.blurInput(),n.initialTouchX=0,n.initialTouchY=0)},n.onControlTouchEnd=function(u){n.userIsDragging||n.onControlMouseDown(u)},n.onClearIndicatorTouchEnd=function(u){n.userIsDragging||n.onClearIndicatorMouseDown(u)},n.onDropdownIndicatorTouchEnd=function(u){n.userIsDragging||n.onDropdownIndicatorMouseDown(u)},n.handleInputChange=function(u){var o=n.props.inputValue,d=u.currentTarget.value;n.setState({inputIsHiddenAfterUpdate:!1}),n.onInputChange(d,{action:"input-change",prevInputValue:o}),n.props.menuIsOpen||n.onMenuOpen()},n.onInputFocus=function(u){n.props.onFocus&&n.props.onFocus(u),n.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(n.openAfterFocus||n.props.openMenuOnFocus)&&n.openMenu("first"),n.openAfterFocus=!1},n.onInputBlur=function(u){var o=n.props.inputValue;if(n.menuListRef&&n.menuListRef.contains(document.activeElement)){n.inputRef.focus();return}n.props.onBlur&&n.props.onBlur(u),n.onInputChange("",{action:"input-blur",prevInputValue:o}),n.onMenuClose(),n.setState({focusedValue:null,isFocused:!1})},n.onOptionHover=function(u){if(!(n.blockOptionHover||n.state.focusedOption===u)){var o=n.getFocusableOptions(),d=o.indexOf(u);n.setState({focusedOption:u,focusedOptionId:d>-1?n.getFocusedOptionId(u):null})}},n.shouldHideSelectedOptions=function(){return P6(n.props)},n.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),n.focus()},n.onKeyDown=function(u){var o=n.props,d=o.isMulti,g=o.backspaceRemovesValue,p=o.escapeClearsValue,h=o.inputValue,f=o.isClearable,x=o.isDisabled,b=o.menuIsOpen,v=o.onKeyDown,_=o.tabSelectsValue,N=o.openMenuOnFocus,E=n.state,O=E.focusedOption,F=E.focusedValue,z=E.selectValue;if(!x&&!(typeof v=="function"&&(v(u),u.defaultPrevented))){switch(n.blockOptionHover=!0,u.key){case"ArrowLeft":if(!d||h)return;n.focusValue("previous");break;case"ArrowRight":if(!d||h)return;n.focusValue("next");break;case"Delete":case"Backspace":if(h)return;if(F)n.removeValue(F);else{if(!g)return;d?n.popValue():f&&n.clearValue()}break;case"Tab":if(n.isComposing||u.shiftKey||!b||!_||!O||N&&n.isOptionSelected(O,z))return;n.selectOption(O);break;case"Enter":if(u.keyCode===229)break;if(b){if(!O||n.isComposing)return;n.selectOption(O);break}return;case"Escape":b?(n.setState({inputIsHiddenAfterUpdate:!1}),n.onInputChange("",{action:"menu-close",prevInputValue:h}),n.onMenuClose()):f&&p&&n.clearValue();break;case" ":if(h)return;if(!b){n.openMenu("first");break}if(!O)return;n.selectOption(O);break;case"ArrowUp":b?n.focusOption("up"):n.openMenu("last");break;case"ArrowDown":b?n.focusOption("down"):n.openMenu("first");break;case"PageUp":if(!b)return;n.focusOption("pageup");break;case"PageDown":if(!b)return;n.focusOption("pagedown");break;case"Home":if(!b)return;n.focusOption("first");break;case"End":if(!b)return;n.focusOption("last");break;default:return}u.preventDefault()}},n.state.instancePrefix="react-select-"+(n.props.instanceId||++EV),n.state.selectValue=V_(a.value),a.menuIsOpen&&n.state.selectValue.length){var i=n.getFocusableOptionsWithIds(),c=n.buildFocusableOptions(),l=c.indexOf(n.state.selectValue[0]);n.state.focusableOptionsWithIds=i,n.state.focusedOption=c[l],n.state.focusedOptionId=$p(i,c[l])}return n}return XU(e,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&q_(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(n){var i=this.props,c=i.isDisabled,l=i.menuIsOpen,u=this.state.isFocused;(u&&!c&&n.isDisabled||u&&l&&!n.menuIsOpen)&&this.focusInput(),u&&c&&!n.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!c&&n.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(q_(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(n,i){this.props.onInputChange(n,i)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(n){var i=this,c=this.state,l=c.selectValue,u=c.isFocused,o=this.buildFocusableOptions(),d=n==="first"?0:o.length-1;if(!this.props.isMulti){var g=o.indexOf(l[0]);g>-1&&(d=g)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:o[d],focusedOptionId:this.getFocusedOptionId(o[d])},function(){return i.onMenuOpen()})}},{key:"focusValue",value:function(n){var i=this.state,c=i.selectValue,l=i.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=c.indexOf(l);l||(u=-1);var o=c.length-1,d=-1;if(c.length){switch(n){case"previous":u===0?d=0:u===-1?d=o:d=u-1;break;case"next":u>-1&&u<o&&(d=u+1);break}this.setState({inputIsHidden:d!==-1,focusedValue:c[d]})}}}},{key:"focusOption",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",i=this.props.pageSize,c=this.state.focusedOption,l=this.getFocusableOptions();if(l.length){var u=0,o=l.indexOf(c);c||(o=-1),n==="up"?u=o>0?o-1:l.length-1:n==="down"?u=(o+1)%l.length:n==="pageup"?(u=o-i,u<0&&(u=0)):n==="pagedown"?(u=o+i,u>l.length-1&&(u=l.length-1)):n==="last"&&(u=l.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:l[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(l[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Up):Bt(Bt({},Up),this.props.theme):Up}},{key:"getCommonProps",value:function(){var n=this.clearValue,i=this.cx,c=this.getStyles,l=this.getClassNames,u=this.getValue,o=this.selectOption,d=this.setValue,g=this.props,p=g.isMulti,h=g.isRtl,f=g.options,x=this.hasValue();return{clearValue:n,cx:i,getStyles:c,getClassNames:l,getValue:u,hasValue:x,isMulti:p,isRtl:h,options:f,selectOption:o,selectProps:g,setValue:d,theme:this.getTheme()}}},{key:"hasValue",value:function(){var n=this.state.selectValue;return n.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var n=this.props,i=n.isClearable,c=n.isMulti;return i===void 0?c:i}},{key:"isOptionDisabled",value:function(n,i){return F6(this.props,n,i)}},{key:"isOptionSelected",value:function(n,i){return I6(this.props,n,i)}},{key:"filterOption",value:function(n,i){return L6(this.props,n,i)}},{key:"formatOptionLabel",value:function(n,i){if(typeof this.props.formatOptionLabel=="function"){var c=this.props.inputValue,l=this.state.selectValue;return this.props.formatOptionLabel(n,{context:i,inputValue:c,selectValue:l})}else return this.getOptionLabel(n)}},{key:"formatGroupLabel",value:function(n){return this.props.formatGroupLabel(n)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var n=this.props,i=n.isDisabled,c=n.isSearchable,l=n.inputId,u=n.inputValue,o=n.tabIndex,d=n.form,g=n.menuIsOpen,p=n.required,h=this.getComponents(),f=h.Input,x=this.state,b=x.inputIsHidden,v=x.ariaSelection,_=this.commonProps,N=l||this.getElementId("input"),E=Bt(Bt(Bt({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":p,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!c&&{"aria-readonly":!0}),this.hasValue()?(v==null?void 0:v.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return c?ne.createElement(f,zt({},_,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:N,innerRef:this.getInputRef,isDisabled:i,isHidden:b,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:o,form:d,type:"text",value:u},E)):ne.createElement(eV,zt({id:N,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:T0,onFocus:this.onInputFocus,disabled:i,tabIndex:o,inputMode:"none",form:d,value:""},E))}},{key:"renderPlaceholderOrValue",value:function(){var n=this,i=this.getComponents(),c=i.MultiValue,l=i.MultiValueContainer,u=i.MultiValueLabel,o=i.MultiValueRemove,d=i.SingleValue,g=i.Placeholder,p=this.commonProps,h=this.props,f=h.controlShouldRenderValue,x=h.isDisabled,b=h.isMulti,v=h.inputValue,_=h.placeholder,N=this.state,E=N.selectValue,O=N.focusedValue,F=N.isFocused;if(!this.hasValue()||!f)return v?null:ne.createElement(g,zt({},p,{key:"placeholder",isDisabled:x,isFocused:F,innerProps:{id:this.getElementId("placeholder")}}),_);if(b)return E.map(function(P,U){var W=P===O,Y="".concat(n.getOptionLabel(P),"-").concat(n.getOptionValue(P));return ne.createElement(c,zt({},p,{components:{Container:l,Label:u,Remove:o},isFocused:W,isDisabled:x,key:Y,index:U,removeProps:{onClick:function(){return n.removeValue(P)},onTouchEnd:function(){return n.removeValue(P)},onMouseDown:function(M){M.preventDefault()}},data:P}),n.formatOptionLabel(P,"value"))});if(v)return null;var z=E[0];return ne.createElement(d,zt({},p,{data:z,isDisabled:x}),this.formatOptionLabel(z,"value"))}},{key:"renderClearIndicator",value:function(){var n=this.getComponents(),i=n.ClearIndicator,c=this.commonProps,l=this.props,u=l.isDisabled,o=l.isLoading,d=this.state.isFocused;if(!this.isClearable()||!i||u||!this.hasValue()||o)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return ne.createElement(i,zt({},c,{innerProps:g,isFocused:d}))}},{key:"renderLoadingIndicator",value:function(){var n=this.getComponents(),i=n.LoadingIndicator,c=this.commonProps,l=this.props,u=l.isDisabled,o=l.isLoading,d=this.state.isFocused;if(!i||!o)return null;var g={"aria-hidden":"true"};return ne.createElement(i,zt({},c,{innerProps:g,isDisabled:u,isFocused:d}))}},{key:"renderIndicatorSeparator",value:function(){var n=this.getComponents(),i=n.DropdownIndicator,c=n.IndicatorSeparator;if(!i||!c)return null;var l=this.commonProps,u=this.props.isDisabled,o=this.state.isFocused;return ne.createElement(c,zt({},l,{isDisabled:u,isFocused:o}))}},{key:"renderDropdownIndicator",value:function(){var n=this.getComponents(),i=n.DropdownIndicator;if(!i)return null;var c=this.commonProps,l=this.props.isDisabled,u=this.state.isFocused,o={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return ne.createElement(i,zt({},c,{innerProps:o,isDisabled:l,isFocused:u}))}},{key:"renderMenu",value:function(){var n=this,i=this.getComponents(),c=i.Group,l=i.GroupHeading,u=i.Menu,o=i.MenuList,d=i.MenuPortal,g=i.LoadingMessage,p=i.NoOptionsMessage,h=i.Option,f=this.commonProps,x=this.state.focusedOption,b=this.props,v=b.captureMenuScroll,_=b.inputValue,N=b.isLoading,E=b.loadingMessage,O=b.minMenuHeight,F=b.maxMenuHeight,z=b.menuIsOpen,P=b.menuPlacement,U=b.menuPosition,W=b.menuPortalTarget,Y=b.menuShouldBlockScroll,q=b.menuShouldScrollIntoView,M=b.noOptionsMessage,D=b.onMenuScrollToTop,T=b.onMenuScrollToBottom;if(!z)return null;var C=function(Z,K){var re=Z.type,G=Z.data,ae=Z.isDisabled,V=Z.isSelected,H=Z.label,Q=Z.value,oe=x===G,se=ae?void 0:function(){return n.onOptionHover(G)},le=ae?void 0:function(){return n.selectOption(G)},he="".concat(n.getElementId("option"),"-").concat(K),Ne={id:he,onClick:le,onMouseMove:se,onMouseOver:se,tabIndex:-1,role:"option","aria-selected":n.isAppleDevice?void 0:V};return ne.createElement(h,zt({},f,{innerProps:Ne,data:G,isDisabled:ae,isSelected:V,key:he,label:H,type:re,value:Q,isFocused:oe,innerRef:oe?n.getFocusedOptionRef:void 0}),n.formatOptionLabel(Z.data,"menu"))},S;if(this.hasOptions())S=this.getCategorizedOptions().map(function(I){if(I.type==="group"){var Z=I.data,K=I.options,re=I.index,G="".concat(n.getElementId("group"),"-").concat(re),ae="".concat(G,"-heading");return ne.createElement(c,zt({},f,{key:G,data:Z,options:K,Heading:l,headingProps:{id:ae,data:I.data},label:n.formatGroupLabel(I.data)}),I.options.map(function(V){return C(V,"".concat(re,"-").concat(V.index))}))}else if(I.type==="option")return C(I,"".concat(I.index))});else if(N){var w=E({inputValue:_});if(w===null)return null;S=ne.createElement(g,f,w)}else{var j=M({inputValue:_});if(j===null)return null;S=ne.createElement(p,f,j)}var A={minMenuHeight:O,maxMenuHeight:F,menuPlacement:P,menuPosition:U,menuShouldScrollIntoView:q},L=ne.createElement(Rz,zt({},f,A),function(I){var Z=I.ref,K=I.placerProps,re=K.placement,G=K.maxHeight;return ne.createElement(u,zt({},f,A,{innerRef:Z,innerProps:{onMouseDown:n.onMenuMouseDown,onMouseMove:n.onMenuMouseMove},isLoading:N,placement:re}),ne.createElement(iV,{captureEnabled:v,onTopArrive:D,onBottomArrive:T,lockEnabled:Y},function(ae){return ne.createElement(o,zt({},f,{innerRef:function(H){n.getMenuListRef(H),ae(H)},innerProps:{role:"listbox","aria-multiselectable":f.isMulti,id:n.getElementId("listbox")},isLoading:N,maxHeight:G,focusedOption:x}),S)}))});return W||U==="fixed"?ne.createElement(d,zt({},f,{appendTo:W,controlElement:this.controlRef,menuPlacement:P,menuPosition:U}),L):L}},{key:"renderFormField",value:function(){var n=this,i=this.props,c=i.delimiter,l=i.isDisabled,u=i.isMulti,o=i.name,d=i.required,g=this.state.selectValue;if(d&&!this.hasValue()&&!l)return ne.createElement(cV,{name:o,onFocus:this.onValueInputFocus});if(!(!o||l))if(u)if(c){var p=g.map(function(x){return n.getOptionValue(x)}).join(c);return ne.createElement("input",{name:o,type:"hidden",value:p})}else{var h=g.length>0?g.map(function(x,b){return ne.createElement("input",{key:"i-".concat(b),name:o,type:"hidden",value:n.getOptionValue(x)})}):ne.createElement("input",{name:o,type:"hidden",value:""});return ne.createElement("div",null,h)}else{var f=g[0]?this.getOptionValue(g[0]):"";return ne.createElement("input",{name:o,type:"hidden",value:f})}}},{key:"renderLiveRegion",value:function(){var n=this.commonProps,i=this.state,c=i.ariaSelection,l=i.focusedOption,u=i.focusedValue,o=i.isFocused,d=i.selectValue,g=this.getFocusableOptions();return ne.createElement(WH,zt({},n,{id:this.getElementId("live-region"),ariaSelection:c,focusedOption:l,focusedValue:u,isFocused:o,selectValue:d,focusableOptions:g,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var n=this.getComponents(),i=n.Control,c=n.IndicatorsContainer,l=n.SelectContainer,u=n.ValueContainer,o=this.props,d=o.className,g=o.id,p=o.isDisabled,h=o.menuIsOpen,f=this.state.isFocused,x=this.commonProps=this.getCommonProps();return ne.createElement(l,zt({},x,{className:d,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:p,isFocused:f}),this.renderLiveRegion(),ne.createElement(i,zt({},x,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:p,isFocused:f,menuIsOpen:h}),ne.createElement(u,zt({},x,{isDisabled:p}),this.renderPlaceholderOrValue(),this.renderInput()),ne.createElement(c,zt({},x,{isDisabled:p}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(n,i){var c=i.prevProps,l=i.clearFocusValueOnUpdate,u=i.inputIsHiddenAfterUpdate,o=i.ariaSelection,d=i.isFocused,g=i.prevWasFocused,p=i.instancePrefix,h=n.options,f=n.value,x=n.menuIsOpen,b=n.inputValue,v=n.isMulti,_=V_(f),N={};if(c&&(f!==c.value||h!==c.options||x!==c.menuIsOpen||b!==c.inputValue)){var E=x?SV(n,_):[],O=x?nw(Xf(n,_),"".concat(p,"-option")):[],F=l?kV(i,_):null,z=CV(i,E),P=$p(O,z);N={selectValue:_,focusedOption:z,focusedOptionId:P,focusableOptionsWithIds:O,focusedValue:F,clearFocusValueOnUpdate:!1}}var U=u!=null&&n!==c?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},W=o,Y=d&&g;return d&&!Y&&(W={value:Pf(v,_,_[0]||null),options:_,action:"initial-input-focus"},Y=!g),(o==null?void 0:o.action)==="initial-input-focus"&&(W=null),Bt(Bt(Bt({},N),U),{},{prevProps:n,ariaSelection:W,prevWasFocused:Y})}}]),e}(ne.Component);B6.defaultProps=jV;var TV=ne.forwardRef(function(t,s){var e=YU(t);return ne.createElement(B6,zt({ref:s},e))}),Na=TV;const D6=()=>{const[t,s]=ne.useState([]),[e,a]=ne.useState([]),[n,i]=ne.useState([]),[c,l]=ne.useState(!1),[u,o]=ne.useState(null),d=ne.useCallback(async()=>{l(!0),o(null);try{const p=localStorage.getItem("token"),[h,f,x]=await Promise.all([bt.get(`${Ct.API_URL}/regions`,{headers:{Authorization:`Bearer ${p}`}}),bt.get(`${Ct.API_URL}/provinces`,{headers:{Authorization:`Bearer ${p}`}}),bt.get(`${Ct.API_URL}/municipalities`,{headers:{Authorization:`Bearer ${p}`}})]),b=(v,_)=>Array.isArray(v)?v:(console.warn(`Invalid ${_} data received:`,v),[]);s(b(h.data,"regions")),a(b(f.data,"provinces")),i(b(x.data,"municipalities")),console.log("Location data fetched successfully:",{regions:h.data,provinces:f.data,municipalities:x.data})}catch(p){console.error("Error fetching location data:",p);let h="Failed to fetch location data. Please try again.";p.response&&p.response.status===401?h="Unauthorized: Please log in again.":p.response&&p.response.status===404&&(h="Location API endpoints not found."),o(h)}finally{l(!1)}},[]),g=ne.useCallback(p=>{if(!p||!Array.isArray(n))return"";const h=n.find(f=>f.name===p);return h?h.postal_code:""},[n]);return ne.useEffect(()=>{d()},[d]),{regions:t,provinces:e,municipalities:n,loading:c,error:u,getMunicipalityPostalCode:g,refreshData:d}},U6={1:"President",2:"Chancellor",3:"Executive Director",4:"Dean",5:"Rector",6:"Head",7:"Administrator",8:"Principal",9:"Managing Director",10:"Director",11:"Chair",12:"Others",99:"Not known or not indicated"},$6={50:"Completed a Baccalaureate Degree (including DVM, DDM, D Opt)",60:"Completed Post-Grad Certificate or diploma Program",70:"Completed MD or LLB (or equivalent)",80:"Completed Masters Degree or Equivalent",90:"Completed Doctorate Degree (or equivalent)"};function z6({onSave:t,onCancel:s,loading:e=!1}){const[a,n]=ne.useState({institution_uiid:"",institution_name:"",region:"Region IX (Zamboanga Peninsula)",province:"",municipality:"",address_street:"",postal_code:"",institutional_telephone:"",institutional_fax:"",head_telephone:"",institutional_email:"",institutional_website:"",year_established:"",report_year:new Date().getFullYear(),head_name:"",head_title:"",head_education:"",sec_registration:"",year_granted_approved:"",year_converted_college:"",year_converted_university:""}),[i,c]=ne.useState([]),[l,u]=ne.useState(!1),[o,d]=ne.useState({}),{regions:g,provinces:p,municipalities:h,loading:f,error:x,getMunicipalityPostalCode:b}=D6(),v=Object.entries(U6).map(([S,w])=>({value:Number(S),label:w})),_=Object.entries($6).map(([S,w])=>({value:Number(S),label:w}));ne.useEffect(()=>{N()},[]);const N=async()=>{u(!0);try{const S=await bt.get(`${Ct.API_URL}/heis?type=SUC`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),w=Array.isArray(S.data)?S.data:S.data.data?S.data.data:S.data.heis?S.data.heis:[];c(w.sort((j,A)=>j.name.localeCompare(A.name)))}catch(S){console.error("Error fetching HEIs:",S),d(w=>({...w,heis:"Failed to load institutions. Please try again."})),c([])}finally{u(!1)}},E=(S,w)=>{n(j=>({...j,[S]:w})),o[S]&&d(j=>({...j,[S]:""}))},O=()=>{const S={};a.institution_uiid.trim()||(S.institution_uiid="Institution UIID is required"),a.institution_name.trim()||(S.institution_name="Institution name is required"),a.report_year||(S.report_year="Report year is required"),a.institutional_email&&!/\S+@\S+\.\S+/.test(a.institutional_email)&&(S.institutional_email="Please enter a valid email address");const w=new Date().getFullYear();return a.year_established&&(isNaN(a.year_established)||a.year_established<1800||a.year_established>w)&&(S.year_established="Please enter a valid year"),a.report_year&&(isNaN(a.report_year)||a.report_year<1800||a.report_year>w+1)&&(S.report_year="Please enter a valid report year"),d(S),Object.keys(S).length===0},F=Array.isArray(i)?i.map(S=>({value:S.uiid,label:`${S.name} (${S.uiid})`,name:S.name,uiid:S.uiid})):[],z=g.map(S=>({value:S.name,label:S.name,id:S.id})),P=()=>{var w;if(!a.region)return[];const S=(w=g.find(j=>j.name===a.region))==null?void 0:w.id;return S?p.filter(j=>j.region_id===S).map(j=>({value:j.name,label:j.name,id:j.id})):[]},U=()=>{var w;if(!a.province)return[];const S=(w=p.find(j=>j.name===a.province))==null?void 0:w.id;return S?h.filter(j=>j.province_id===S).map(j=>({value:j.name,label:j.name})):[]},W=S=>{E("institution_uiid",S?S.value:""),E("institution_name",S?S.name:"")},Y=S=>{n({...a,region:S?S.value:"",province:"",municipality:"",postal_code:""})},q=S=>{n({...a,province:S?S.value:"",municipality:"",postal_code:""})},M=S=>{const w=S?S.value:"",j=S?b(w):"";let A="",L="";if(S){const I=h.find(Z=>Z.name===w);if(I){const Z=p.find(K=>K.id===I.province_id);if(Z){L=Z.name;const K=g.find(re=>re.id===Z.region_id);K&&(A=K.name)}}}n(I=>({...I,region:A,province:L,municipality:w,postal_code:j}))},D=async()=>{var S;if(O())try{const w=localStorage.getItem("token");console.log("Checking for existing records:",{hei_uiid:a.institution_uiid,report_year:a.report_year,hei_name:a.institution_name});const j=await bt.get(`${Ct.API_URL}/suc-details?hei_uiid=${a.institution_uiid}&report_year=${a.report_year}`,{headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"}});console.log("SUC Details API Response:",j.data);const A=Array.isArray(j.data)?j.data:(S=j.data)!=null&&S.data?j.data.data:[];console.log("Existing SUC records found:",A);const L=A.find(I=>I.hei_uiid===a.institution_uiid&&I.report_year===a.report_year&&!I.deleted_at);if(console.log("Duplicate record check:",{found:!!L,record:L,hei_uiid:a.institution_uiid,report_year:a.report_year}),L){console.log("Duplicate record found:",L),Ft.showAlert(`A record for ${a.institution_name} (UIID: ${a.institution_uiid}) already exists for the year ${a.report_year}. Please select a different institution or year.`,"error");return}await t(a),Ft.showAlert("SUC institution created successfully!","success")}catch(w){Ft.showAlert(w.message||"Failed to create SUC institution. Please try again.","error")}else Ft.showAlert("Please fill in all required fields correctly.","error")},T=()=>{Ft.showConfirmation("Are you sure you want to cancel? Any unsaved changes will be lost.",()=>{d({}),s()})},C={control:(S,w)=>({...S,borderColor:w.isFocused?"#3b82f6":"#d1d5db",boxShadow:w.isFocused?"0 0 0 1px #3b82f6":"none","&:hover":{borderColor:"#3b82f6"},borderRadius:"0.5rem",padding:"0.125rem"}),option:(S,w)=>({...S,backgroundColor:w.isSelected?"#3b82f6":w.isFocused?"#eff6ff":"",color:w.isSelected?"white":"#374151"}),menuPortal:S=>({...S,zIndex:9999})};return r.jsx(mr,{isOpen:!0,onClose:T,title:"Add New SUC Institution",subtitle:"State University & College Details - Region IX",icon:Er,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 p-4",children:[(o.heis||x)&&r.jsx("div",{className:"p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(ys,{className:"w-5 h-5 mr-2"}),o.heis||x]})}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(Ya,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Basic Information"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select SUC Institution ",r.jsx("span",{className:"text-red-500",children:"*"})]}),l?r.jsxs("div",{className:"flex items-center justify-center p-4 border border-gray-200 rounded-lg bg-gray-50",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-blue-600 mr-2"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Loading institutions..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(Na,{options:F,value:F.find(S=>S.value===a.institution_uiid)||null,onChange:W,placeholder:"Select an institution (e.g., Western Mindanao State University)",isClearable:!0,isSearchable:!0,className:`text-sm ${o.institution_uiid?"border-red-400":""}`,classNamePrefix:"select",styles:{...C,control:S=>({...S,borderColor:o.institution_uiid?"#ef4444":S.borderColor,"&:hover":{borderColor:o.institution_uiid?"#ef4444":"#3b82f6"}})}}),o.institution_uiid&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.institution_uiid})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Established"}),r.jsx("input",{type:"number",value:a.year_established,onChange:S=>E("year_established",S.target.value),placeholder:"e.g., 1957",min:"1800",max:new Date().getFullYear(),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${o.year_established?"border-red-300 bg-red-50":"border-gray-300"}`}),o.year_established&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.year_established})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Report Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:a.report_year,onChange:S=>E("report_year",S.target.value),placeholder:"e.g., 2024",min:"1800",max:new Date().getFullYear()+1,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${o.report_year?"border-red-300 bg-red-50":"border-gray-300"}`}),o.report_year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.report_year})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(yn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Location"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region"}),f?r.jsxs("div",{className:"flex items-center justify-center p-3 border border-gray-200 rounded-lg bg-gray-50",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-emerald-600 mr-2"}),r.jsx("span",{className:"text-xs text-gray-500",children:"Loading..."})]}):r.jsx(Na,{options:z,value:z.find(S=>String(S.value)===String(a.region))||null,onChange:Y,placeholder:"Select region...",isClearable:!0,isSearchable:!0,className:"text-sm",classNamePrefix:"select",styles:C})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Province"}),r.jsx(Na,{options:P(),value:P().find(S=>String(S.value)===String(a.province))||null,onChange:q,placeholder:"Select province...",isClearable:!0,isSearchable:!0,isDisabled:!a.region||f,className:"text-sm",classNamePrefix:"select",styles:C})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Municipality/City"}),r.jsx(Na,{options:U(),value:U().find(S=>String(S.value)===String(a.municipality))||null,onChange:M,placeholder:"Select municipality...",isClearable:!0,isSearchable:!0,isDisabled:!a.province||f,className:"text-sm",classNamePrefix:"select",styles:C})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),r.jsx("input",{type:"text",value:a.address_street,onChange:S=>E("address_street",S.target.value),placeholder:"e.g., Normal Road, Baliwasan",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),r.jsx("input",{type:"text",value:a.postal_code,onChange:S=>E("postal_code",S.target.value),placeholder:"e.g., 7000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(ao,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Contact"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Telephone"}),r.jsx("input",{type:"text",value:a.institutional_telephone,onChange:S=>E("institutional_telephone",S.target.value),placeholder:"e.g., +63-62-991-8888",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Fax"}),r.jsx("input",{type:"text",value:a.institutional_fax,onChange:S=>E("institutional_fax",S.target.value),placeholder:"e.g., +63-62-991-8889",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),r.jsx("input",{type:"email",value:a.institutional_email,onChange:S=>E("institutional_email",S.target.value),placeholder:"e.g., info@wmsu.edu.ph",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${o.institutional_email?"border-red-300 bg-red-50":"border-gray-300"}`}),o.institutional_email&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.institutional_email})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(ql,{className:"w-4 h-4 inline mr-1"}),"Website"]}),r.jsx("input",{type:"url",value:a.institutional_website,onChange:S=>E("institutional_website",S.target.value),placeholder:"e.g., https://wmsu.edu.ph",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${o.institutional_website?"border-red-300 bg-red-50":"border-gray-300"}`}),o.institutional_website&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.institutional_website})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Leadership"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Head Name"}),r.jsx("input",{type:"text",value:a.head_name,onChange:S=>E("head_name",S.target.value),placeholder:"e.g., Dr. Grace J. Rebollos",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),r.jsx(Na,{options:v,value:v.find(S=>Number(S.value)===Number(a.head_title))||null,onChange:S=>E("head_title",S?S.value:""),placeholder:"Select title...",isClearable:!0,isSearchable:!0,className:"text-sm",classNamePrefix:"select",styles:C,menuPortalTarget:document.body,menuPosition:"fixed"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(gr,{className:"w-4 h-4 inline mr-1"}),"Educational Background"]}),r.jsx(Na,{options:_,value:_.find(S=>Number(S.value)===Number(a.head_education))||null,onChange:S=>E("head_education",S?S.value:""),placeholder:"Select educational level...",isClearable:!0,isSearchable:!0,className:"text-sm",classNamePrefix:"select",styles:C,menuPortalTarget:document.body,menuPosition:"fixed"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direct Telephone"}),r.jsx("input",{type:"text",value:a.head_telephone,onChange:S=>E("head_telephone",S.target.value),placeholder:"e.g., +63-62-991-8800",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(Lr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Legal & Historical"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Zr,{className:"w-4 h-4 inline mr-1"}),"SEC Registration"]}),r.jsx("input",{type:"text",value:a.sec_registration,onChange:S=>E("sec_registration",S.target.value),placeholder:"e.g., SUC-WMSU-001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Granted/Approved"}),r.jsx("input",{type:"number",value:a.year_granted_approved,onChange:S=>E("year_granted_approved",S.target.value),placeholder:"e.g., 1957",min:"1800",max:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Converted to College"}),r.jsx("input",{type:"number",value:a.year_converted_college,onChange:S=>E("year_converted_college",S.target.value),placeholder:"Leave blank if not applicable",min:"1800",max:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Converted to University"}),r.jsx("input",{type:"number",value:a.year_converted_university,onChange:S=>E("year_converted_university",S.target.value),placeholder:"e.g., 1957",min:"1800",max:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:T,disabled:e,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),r.jsx("button",{type:"button",onClick:D,disabled:e,className:"w-full sm:w-auto px-6 py-2.5 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 focus:ring-blue-500",children:e?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2"}),"Create SUC"]})})]})]})})}z6.propTypes={onSave:B.func.isRequired,onCancel:B.func.isRequired,closeModal:B.func.isRequired,loading:B.bool};function H6({initialData:t,onSave:s,onCancel:e,loading:a=!1}){const[n,i]=ne.useState({institution_uiid:(t==null?void 0:t.institution_uiid)||"",institution_name:(t==null?void 0:t.institution_name)||"",region:(t==null?void 0:t.region)||"Region IX (Zamboanga Peninsula)",province:(t==null?void 0:t.province)||"",municipality:(t==null?void 0:t.municipality)||"",address_street:(t==null?void 0:t.address_street)||"",postal_code:(t==null?void 0:t.postal_code)||"",institutional_telephone:(t==null?void 0:t.institutional_telephone)||"",institutional_fax:(t==null?void 0:t.institutional_fax)||"",head_telephone:(t==null?void 0:t.head_telephone)||"",institutional_email:(t==null?void 0:t.institutional_email)||"",institutional_website:(t==null?void 0:t.institutional_website)||"",year_established:(t==null?void 0:t.year_established)||"",report_year:(t==null?void 0:t.report_year)||new Date().getFullYear(),head_name:(t==null?void 0:t.head_name)||"",head_title:(t==null?void 0:t.head_title)||"",head_education:(t==null?void 0:t.head_education)||"",sec_registration:(t==null?void 0:t.sec_registration)||"",year_granted_approved:(t==null?void 0:t.year_granted_approved)||"",year_converted_college:(t==null?void 0:t.year_converted_college)||"",year_converted_university:(t==null?void 0:t.year_converted_university)||""}),[c,l]=ne.useState([]),[u,o]=ne.useState(!1),[d,g]=ne.useState({}),{regions:p,provinces:h,municipalities:f,loading:x,error:b,getMunicipalityPostalCode:v}=D6(),_=Object.entries(U6).map(([w,j])=>({value:Number(w),label:j})),N=Object.entries($6).map(([w,j])=>({value:Number(w),label:j}));ne.useEffect(()=>{E()},[]),ne.useEffect(()=>{t&&p.length>0&&h.length>0&&f.length>0&&i(w=>({...w,region:t.region||"",province:t.province||"",municipality:t.municipality||""}))},[t,p,h,f]);const E=async()=>{o(!0);try{const w=await bt.get(`${Ct.API_URL}/heis?type=SUC`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),j=Array.isArray(w.data)?w.data:w.data.data?w.data.data:w.data.heis?w.data.heis:[];l(j.sort((A,L)=>A.name.localeCompare(L.name)))}catch(w){console.error("Error fetching HEIs:",w),g(j=>({...j,heis:"Failed to load institutions. Please try again."})),l([])}finally{o(!1)}},O=(w,j)=>{i(A=>({...A,[w]:j})),d[w]&&g(A=>({...A,[w]:""}))},F=()=>{const w={};n.institution_uiid.trim()||(w.institution_uiid="Institution UIID is required"),n.institution_name.trim()||(w.institution_name="Institution name is required"),n.report_year||(w.report_year="Report year is required"),n.institutional_email&&!/\S+@\S+\.\S+/.test(n.institutional_email)&&(w.institutional_email="Please enter a valid email address");const j=new Date().getFullYear();return n.year_established&&(isNaN(n.year_established)||n.year_established<1800||n.year_established>j)&&(w.year_established="Please enter a valid year"),n.report_year&&(isNaN(n.report_year)||n.report_year<1800||n.report_year>j+1)&&(w.report_year="Please enter a valid report year"),g(w),Object.keys(w).length===0},z=Array.isArray(c)?c.map(w=>({value:w.uiid,label:`${w.name} (${w.uiid})`,name:w.name,uiid:w.uiid})):[],P=p.map(w=>({value:w.name,label:w.name,id:w.id})),U=()=>{var j;if(!n.region)return[];const w=(j=p.find(A=>A.name===n.region))==null?void 0:j.id;return w?h.filter(A=>A.region_id===w).map(A=>({value:A.name,label:A.name,id:A.id})):[]},W=()=>{var j;if(!n.province)return[];const w=(j=h.find(A=>A.name===n.province))==null?void 0:j.id;return w?f.filter(A=>A.province_id===w).map(A=>({value:A.name,label:A.name})):[]},Y=w=>{O("institution_uiid",w?w.value:""),O("institution_name",w?w.name:"")},q=w=>{i({...n,region:w?w.value:"",province:"",municipality:"",postal_code:""})},M=w=>{i({...n,province:w?w.value:"",municipality:"",postal_code:""})},D=w=>{const j=w?w.value:"",A=w?v(j):"";let L="",I="";if(w){const Z=f.find(K=>K.name===j);if(Z){const K=h.find(re=>re.id===Z.province_id);if(K){I=K.name;const re=p.find(G=>G.id===K.region_id);re&&(L=re.name)}}}i(Z=>({...Z,region:L,province:I,municipality:j,postal_code:A}))},T=async()=>{var w;if(F())try{const j=localStorage.getItem("token");console.log("Checking for existing records:",{hei_uiid:n.institution_uiid,report_year:n.report_year,hei_name:n.institution_name,current_id:t==null?void 0:t.id});const A=await bt.get(`${Ct.API_URL}/suc-details?hei_uiid=${n.institution_uiid}&report_year=${n.report_year}`,{headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"}});console.log("SUC Details API Response:",A.data);const L=Array.isArray(A.data)?A.data:(w=A.data)!=null&&w.data?A.data.data:[];console.log("Existing SUC records found:",L);const I=L.find(Z=>Z.hei_uiid===n.institution_uiid&&Z.report_year===n.report_year&&!Z.deleted_at&&Z.id!==(t==null?void 0:t.id));if(console.log("Duplicate record check:",{found:!!I,record:I,hei_uiid:n.institution_uiid,report_year:n.report_year,current_id:t==null?void 0:t.id}),I){console.log("Duplicate record found:",I),Ft.showAlert(`A record for ${n.institution_name} (UIID: ${n.institution_uiid}) already exists for the year ${n.report_year}. Please select a different institution or year.`,"error");return}await s(n),Ft.showAlert("SUC institution updated successfully!","success")}catch(j){Ft.showAlert(j.message||"Failed to update SUC institution. Please try again.","error")}else Ft.showAlert("Please fill in all required fields correctly.","error")},C=()=>{Ft.showConfirmation("Are you sure you want to cancel? Any unsaved changes will be lost.",()=>{g({}),e()})},S={control:(w,j)=>({...w,borderColor:j.isFocused?"#3b82f6":"#d1d5db",boxShadow:j.isFocused?"0 0 0 1px #3b82f6":"none","&:hover":{borderColor:"#3b82f6"},borderRadius:"0.5rem",padding:"0.125rem"}),option:(w,j)=>({...w,backgroundColor:j.isSelected?"#3b82f6":j.isFocused?"#eff6ff":"",color:j.isSelected?"white":"#374151"}),menuPortal:w=>({...w,zIndex:9999})};return r.jsx(mr,{isOpen:!0,onClose:C,title:"Edit SUC Institution",subtitle:"State University & College Details - Region IX",icon:Dr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 p-4",children:[(d.heis||b)&&r.jsx("div",{className:"p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(ys,{className:"w-5 h-5 mr-2"}),d.heis||b]})}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(Ya,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Basic Information"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select SUC Institution ",r.jsx("span",{className:"text-red-500",children:"*"})]}),u?r.jsxs("div",{className:"flex items-center justify-center p-4 border border-gray-200 rounded-lg bg-gray-50",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-blue-600 mr-2"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Loading institutions..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(Na,{options:z,value:z.find(w=>w.value===n.institution_uiid)||null,onChange:Y,placeholder:"Select an institution (e.g., Western Mindanao State University)",isClearable:!0,isSearchable:!0,className:`text-sm ${d.institution_uiid?"border-red-400":""}`,classNamePrefix:"select",styles:{...S,control:w=>({...w,borderColor:d.institution_uiid?"#ef4444":w.borderColor,"&:hover":{borderColor:d.institution_uiid?"#ef4444":"#3b82f6"}})}}),d.institution_uiid&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.institution_uiid})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Established"}),r.jsx("input",{type:"number",value:n.year_established,onChange:w=>O("year_established",w.target.value),placeholder:"e.g., 1957",min:"1800",max:new Date().getFullYear(),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${d.year_established?"border-red-300 bg-red-50":"border-gray-300"}`}),d.year_established&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.year_established})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Report Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:n.report_year,onChange:w=>O("report_year",w.target.value),placeholder:"e.g., 2024",min:"1800",max:new Date().getFullYear()+1,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${d.report_year?"border-red-300 bg-red-50":"border-gray-300"}`}),d.report_year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.report_year})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(yn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Location"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region"}),x?r.jsxs("div",{className:"flex items-center justify-center p-3 border border-gray-200 rounded-lg bg-gray-50",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-emerald-600 mr-2"}),r.jsx("span",{className:"text-xs text-gray-500",children:"Loading..."})]}):r.jsx(Na,{options:P,value:P.find(w=>String(w.value)===String(n.region))||null,onChange:q,placeholder:"Select region...",isClearable:!0,isSearchable:!0,className:"text-sm",classNamePrefix:"select",styles:S})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Province"}),r.jsx(Na,{options:U(),value:U().find(w=>String(w.value)===String(n.province))||null,onChange:M,placeholder:"Select province...",isClearable:!0,isSearchable:!0,isDisabled:!n.region||x,className:"text-sm",classNamePrefix:"select",styles:S})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Municipality/City"}),r.jsx(Na,{options:W(),value:W().find(w=>String(w.value)===String(n.municipality))||null,onChange:D,placeholder:"Select municipality...",isClearable:!0,isSearchable:!0,isDisabled:!n.province||x,className:"text-sm",classNamePrefix:"select",styles:S})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),r.jsx("input",{type:"text",value:n.address_street,onChange:w=>O("address_street",w.target.value),placeholder:"e.g., Normal Road, Baliwasan",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),r.jsx("input",{type:"text",value:n.postal_code,onChange:w=>O("postal_code",w.target.value),placeholder:"e.g., 7000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(ao,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Contact"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Telephone"}),r.jsx("input",{type:"text",value:n.institutional_telephone,onChange:w=>O("institutional_telephone",w.target.value),placeholder:"e.g., +63-62-991-8888",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Fax"}),r.jsx("input",{type:"text",value:n.institutional_fax,onChange:w=>O("institutional_fax",w.target.value),placeholder:"e.g., +63-62-991-8889",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),r.jsx("input",{type:"email",value:n.institutional_email,onChange:w=>O("institutional_email",w.target.value),placeholder:"e.g., info@wmsu.edu.ph",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${d.institutional_email?"border-red-300 bg-red-50":"border-gray-300"}`}),d.institutional_email&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.institutional_email})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(ql,{className:"w-4 h-4 inline mr-1"}),"Website"]}),r.jsx("input",{type:"url",value:n.institutional_website,onChange:w=>O("institutional_website",w.target.value),placeholder:"e.g., https://wmsu.edu.ph",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${d.institutional_website?"border-red-300 bg-red-50":"border-gray-300"}`}),d.institutional_website&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.institutional_website})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Leadership"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Head Name"}),r.jsx("input",{type:"text",value:n.head_name,onChange:w=>O("head_name",w.target.value),placeholder:"e.g., Dr. Grace J. Rebollos",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),r.jsx(Na,{options:_,value:_.find(w=>Number(w.value)===Number(n.head_title))||null,onChange:w=>O("head_title",w?w.value:""),placeholder:"Select title...",isClearable:!0,isSearchable:!0,className:"text-sm",classNamePrefix:"select",styles:S,menuPortalTarget:document.body,menuPosition:"fixed"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(gr,{className:"w-4 h-4 inline mr-1"}),"Educational Background"]}),r.jsx(Na,{options:N,value:N.find(w=>Number(w.value)===Number(n.head_education))||null,onChange:w=>O("head_education",w?w.value:""),placeholder:"Select educational level...",isClearable:!0,isSearchable:!0,className:"text-sm",classNamePrefix:"select",styles:S,menuPortalTarget:document.body,menuPosition:"fixed"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direct Telephone"}),r.jsx("input",{type:"text",value:n.head_telephone,onChange:w=>O("head_telephone",w.target.value),placeholder:"e.g., +63-62-991-8800",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(Lr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Legal & Historical"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Zr,{className:"w-4 h-4 inline mr-1"}),"SEC Registration"]}),r.jsx("input",{type:"text",value:n.sec_registration,onChange:w=>O("sec_registration",w.target.value),placeholder:"e.g., SUC-WMSU-001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Granted/Approved"}),r.jsx("input",{type:"number",value:n.year_granted_approved,onChange:w=>O("year_granted_approved",w.target.value),placeholder:"e.g., 1957",min:"1800",max:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Converted to College"}),r.jsx("input",{type:"number",value:n.year_converted_college,onChange:w=>O("year_converted_college",w.target.value),placeholder:"Leave blank if not applicable",min:"1800",max:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Converted to University"}),r.jsx("input",{type:"number",value:n.year_converted_university,onChange:w=>O("year_converted_university",w.target.value),placeholder:"e.g., 1957",min:"1800",max:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:C,disabled:a,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),r.jsx("button",{type:"button",onClick:T,disabled:a,className:"w-full sm:w-auto px-6 py-2.5 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 focus:ring-green-500",children:a?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2"}),"Update SUC"]})})]})]})})}H6.propTypes={initialData:B.shape({id:B.number,institution_uiid:B.string,institution_name:B.string,region:B.string,province:B.string,municipality:B.string,address_street:B.string,postal_code:B.string,institutional_telephone:B.string,institutional_fax:B.string,head_telephone:B.string,institutional_email:B.string,institutional_website:B.string,year_established:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number]),head_name:B.string,head_title:B.oneOfType([B.string,B.number]),head_education:B.oneOfType([B.string,B.number]),sec_registration:B.string,year_granted_approved:B.oneOfType([B.string,B.number]),year_converted_college:B.oneOfType([B.string,B.number]),year_converted_university:B.oneOfType([B.string,B.number])}).isRequired,onSave:B.func.isRequired,onCancel:B.func.isRequired,closeModal:B.func.isRequired,loading:B.bool};function V6({isOpen:t,onClose:s,onDataImported:e}){const[a,n]=ne.useState(!1),[i,c]=ne.useState([]),[l,u]=ne.useState(null),[o,d]=ne.useState(!1),[g,p]=ne.useState({}),[h,f]=ne.useState(new Date().getFullYear()),{showLoading:x,hideLoading:b,updateProgress:v}=J0(),_=Array.isArray(i)?i.map(w=>({value:w.uiid,label:`${w.name} (${w.uiid})`,name:w.name,uiid:w.uiid})):[];ne.useEffect(()=>{t&&N()},[t]);const N=async()=>{d(!0);try{const w=await bt.get(`${Ct.API_URL}/heis`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),A=(Array.isArray(w.data)?w.data:w.data.data||[]).filter(L=>L.type==="SUC");c(A.sort((L,I)=>L.name.localeCompare(I.name)))}catch(w){console.error("Error fetching HEIs:",w),p(j=>({...j,heis:"Failed to load institutions. Please try again."}))}finally{d(!1)}},E=(w,j)=>{g[w]&&p(A=>({...A,[w]:""})),w==="hei"?u(j):w==="year"&&f(j)},O=()=>{const w={};return l||(w.hei="Please select an institution before uploading"),h||(w.year="Please select a report year"),p(w),Object.keys(w).length===0},F={control:(w,j)=>({...w,borderColor:j.isFocused?"#3b82f6":"#d1d5db",boxShadow:j.isFocused?"0 0 0 1px #3b82f6":"none","&:hover":{borderColor:"#3b82f6"},borderRadius:"0.5rem",padding:"0.125rem"}),option:(w,j)=>({...w,backgroundColor:j.isSelected?"#3b82f6":j.isFocused?"#eff6ff":"",color:j.isSelected?"white":"#374151"})},z={1:"Ilocos Region (Region 1)",2:"Cagayan Valley (Region II)",3:"Central Luzon (Region III)",4:"CALABARZON (Region IV-A)",5:"Bicol Region (Region V)",6:"Western Visayas (Region VI)",7:"Central Visayas (Region VII)",8:"Eastern Visayas (Region VIII)",9:"Zamboanga Peninsula (Region IX)",10:"Northern Mindanao (Region X)",11:"Davao Region (Region XI)",12:"SOCCSKSARGEN (Region XII)",13:"National Capital Region (NCR)",14:"Cordillera Administrative Region (CAR)",15:"Autonomous Region in Muslim Mindanao (ARMM)",16:"Caraga (Region XIII)",17:"MIMAROPA (Region IV-B)"},P={"01":"President","02":"Chancellor","03":"Executive Director","04":"Dean","05":"Rector","06":"Head","07":"Administrator","08":"Principal","09":"Managing Director",10:"Director",11:"Chair",12:"Others",99:"Not known or not indicated"},U=w=>{if(!w||w==="N/A"||w==="")return null;const j=Number.parseInt(w,10);return isNaN(j)?null:j},W=(w,j,A)=>{if(w===void 0||w===""||isNaN(w))return null;const L=Number.parseFloat(w);return j!==void 0&&L<j||A!==void 0&&L>A?null:L},Y=(w,j,A)=>{if(w===void 0||w===""||isNaN(w))return null;const L=Number.parseInt(w,10);return L<j||A!==void 0&&L>A?null:L},q=w=>{if(w===void 0||w==="")return null;const j=String(w).trim();return j.length>255?j.substring(0,255):j},M=async w=>{const j=w.target.files[0];if(!j)return;if(!O()){Ft.showAlert("Please fill in all required fields before uploading.","error"),s();return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(j.type)&&!j.name.match(/\.(xlsx|xls|csv)$/i)){Ft.showAlert("Please upload a valid Excel file (.xlsx, .xls) or CSV file.","error"),s();return}n(!0),x(),v(10);try{const L=await j.arrayBuffer();v(30);const I=so(L,{cellStyles:!0,cellFormulas:!0,cellDates:!0,cellNF:!0,sheetStubs:!0,type:"array"});v(50);const Z=I.SheetNames.filter(K=>K.toUpperCase().includes("FORM A1")||K.toUpperCase().includes("FORM A2")||K.toUpperCase().includes("A1")||K.toUpperCase().includes("A2")).map(K=>({name:K,type:K.toUpperCase().includes("A1")?"A1":"A2",description:K.toUpperCase().includes("A1")?"SUC Institutional Profile":"Campus Information"}));if(Z.length===0)throw new Error("No HEMIS forms (A1 or A2) found in the Excel file.");await D(I,Z)}catch(L){console.error("Excel upload error:",L),Ft.showAlert(L.message||"Failed to process Excel file. Please try again.","error"),s()}finally{n(!1),b(),w.target.value=""}},D=async(w,j)=>{var re,G,ae,V;const A=[],L=[];let I="",Z=null;const K=j.filter(H=>H.type==="A1");for(const H of K)try{const Q=w.Sheets[H.name],oe=await T(Q);if(oe.length===0){s();return}oe.length>0&&(Z=oe[0].institution.id,A.push(...oe),I+=`Imported SUC institutional profile from ${H.name}. `)}catch(Q){console.error(`Error processing sheet ${H.name}:`,Q),L.push(`Error in ${H.name}: ${((G=(re=Q.response)==null?void 0:re.data)==null?void 0:G.error)||Q.message}`),s();return}if(Z){const H=j.filter(Q=>Q.type==="A2");for(const Q of H)try{const oe=w.Sheets[Q.name],se=await C(oe,Z);A.push(...se),I+=`Imported ${se.length} campus records from ${Q.name}. `}catch(oe){console.error(`Error processing sheet ${Q.name}:`,oe),L.push(`Error in ${Q.name}: ${((V=(ae=oe.response)==null?void 0:ae.data)==null?void 0:V.error)||oe.message}`),s();return}}A.length>0?(e(A),Ft.showAlert(I.trim(),"success"),s()):L.length>0&&(Ft.showAlert(`No valid data imported. Errors: ${L.join("; ")}`,"error"),s())},T=async w=>{var j,A,L,I,Z,K,re,G,ae,V,H,Q,oe,se,le,he,Ne,we,ue,Se,ke,Me;try{const Oe=localStorage.getItem("token");console.log("Checking for existing records:",{hei_uiid:l==null?void 0:l.uiid,report_year:h,hei_name:l==null?void 0:l.name});const je=await bt.get(`${Ct.API_URL}/suc-details?hei_uiid=${l==null?void 0:l.uiid}&report_year=${h}`,{headers:{Authorization:`Bearer ${Oe}`,"Content-Type":"application/json"}});console.log("SUC Details API Response:",je.data);const Ie=Array.isArray(je.data)?je.data:(j=je.data)!=null&&j.data?je.data.data:[];console.log("Existing SUC records found:",Ie);const Pe=Ie.find(te=>te.hei_uiid===(l==null?void 0:l.uiid)&&te.report_year===h&&!te.deleted_at);if(console.log("Duplicate record check:",{found:!!Pe,record:Pe,hei_uiid:l==null?void 0:l.uiid,report_year:h}),Pe)return console.log("Duplicate record found:",Pe),Ft.showAlert(`A record for ${l==null?void 0:l.name} (UIID: ${l==null?void 0:l.uiid}) already exists for the year ${h}. Please select a different institution or year.`,"error"),u(null),s(),[];v(60);const He=Wo.sheet_to_json(w,{header:1,defval:"",raw:!1}),ct={hei_uiid:(l==null?void 0:l.uiid)||"",cluster_id:((A=l==null?void 0:l.cluster)==null?void 0:A.id)||null,address_street:q(((L=He[7])==null?void 0:L[2])||""),municipality:q(((I=He[8])==null?void 0:I[2])||""),province:q(((Z=He[9])==null?void 0:Z[2])||""),region:q(((K=He[10])==null?void 0:K[2])||""),postal_code:q(((re=He[11])==null?void 0:re[2])||""),institutional_telephone:q(((G=He[12])==null?void 0:G[2])||""),institutional_fax:q(((ae=He[13])==null?void 0:ae[2])||""),head_telephone:q(((V=He[14])==null?void 0:V[2])||""),institutional_email:q(((H=He[15])==null?void 0:H[2])||""),institutional_website:q(((Q=He[16])==null?void 0:Q[2])||""),year_established:U((oe=He[17])==null?void 0:oe[2]),sec_registration:q(((se=He[18])==null?void 0:se[2])||""),year_granted_approved:U((le=He[19])==null?void 0:le[2]),year_converted_college:U((he=He[20])==null?void 0:he[2]),year_converted_university:U((Ne=He[21])==null?void 0:Ne[2]),head_name:q(((we=He[22])==null?void 0:we[2])||""),head_title:q(((ue=He[23])==null?void 0:ue[2])||""),head_education:q(((Se=He[24])==null?void 0:Se[2])||""),institution_type:"SUC",report_year:Y(h,1800,new Date().getFullYear())};v(80);const ee=(await bt.post(`${Ct.API_URL}/suc-details`,ct,{headers:{Authorization:`Bearer ${Oe}`,"Content-Type":"application/json"}})).data.id;if(!ee||isNaN(Number(ee)))throw new Error("Invalid institution ID received from server.");return v(90),[{institution:{id:ee,...ct}}]}catch(Oe){throw console.error("Form A1 processing error:",Oe),Ft.showAlert(((Me=(ke=Oe.response)==null?void 0:ke.data)==null?void 0:Me.error)||`Failed to process Form A1: ${Oe.message}`,"error"),s(),Oe}},C=async(w,j)=>{var A,L;try{const I=Wo.sheet_to_json(w,{header:1,defval:"",raw:!1}),Z=I.findIndex(ae=>ae.some(V=>String(V).toUpperCase().includes("START BELOW THIS ROW")))+1;if(Z<=0)throw new Error('Marker "START BELOW THIS ROW" not found in the sheet.');const K=new Date().getFullYear(),re=I.slice(Z).filter(ae=>ae.some(V=>V!==void 0&&V!=="")).map(ae=>({suc_details_id:Number.parseInt(j,10)||null,name:q(ae[1])||"",campus_type:q(ae[2]),institutional_code:q(ae[3]),region:z[ae[4]]||q(ae[4])||"",province_municipality:q(ae[5])||"",year_first_operation:Y(ae[6],1800,K),land_area_hectares:W(ae[7],0),distance_from_main:W(ae[8],0),autonomous_code:q[ae[9]]||q(ae[9]),position_title:P[ae[10]]||q(ae[10]),head_full_name:q(ae[11]),former_name:q(ae[12]),latitude_coordinates:W(ae[13],-90,90),longitude_coordinates:W(ae[14],-180,180),report_year:Y(h,1800,K)})).filter(ae=>ae.name);if(re.length===0)throw new Error("No valid campus data found in Form A2.");const G=localStorage.getItem("token");return await bt.post(`${Ct.API_URL}/suc-campuses`,re,{headers:{Authorization:`Bearer ${G}`,"Content-Type":"application/json"}}),re.map(ae=>({sucCampuses:ae}))}catch(I){throw console.error("Form A2 processing error:",I),new Error(((L=(A=I.response)==null?void 0:A.data)==null?void 0:L.error)||`Failed to process Form A2: ${I.message}`)}},S=()=>{p({}),u(null),f(new Date().getFullYear()),s()};return t?r.jsx(mr,{isOpen:t,onClose:S,title:"Upload SUC Data",subtitle:"Import HEMIS Form A Excel files with institutional and campus data",icon:Qr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx($s,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Institution Selection"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Institution ",r.jsx("span",{className:"text-red-500",children:"*"})]}),o?r.jsxs("div",{className:"flex items-center justify-center p-4 border border-gray-200 rounded-lg bg-gray-50",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-blue-600 mr-2"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Loading institutions..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(Na,{options:_,value:_.find(w=>w.value===(l==null?void 0:l.uiid))||null,onChange:w=>{E("hei",w?{uiid:w.value,name:w.name}:null)},placeholder:"Search and select an institution...",isClearable:!0,isSearchable:!0,className:"text-sm",classNamePrefix:"select",styles:{...F,control:w=>({...w,borderColor:g.hei?"#ef4444":w.borderColor,"&:hover":{borderColor:g.hei?"#ef4444":"#3b82f6"}})}}),g.hei&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:g.hei})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Report Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{value:h,onChange:w=>E("year",parseInt(w.target.value)),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${g.year?"border-red-300 bg-red-50":"border-gray-300"}`,children:Array.from({length:10},(w,j)=>{const A=new Date().getFullYear()-j;return r.jsx("option",{value:A,children:A},A)})}),g.year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:g.year})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(pi,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Upload Instructions"})]}),r.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ys,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"HEMIS Form A Excel Files:"}),r.jsxs("ul",{className:"space-y-1 ml-2",children:[r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),r.jsx("strong",{children:"Form A1:"})," SUC Institutional Profile (details, address, contact, leadership)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),r.jsx("strong",{children:"Form A2:"})," Campus Information (names, locations, officials, coordinates)"]})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ui,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"The system processes Form A1 first to create the institutional profile, then links Form A2 campus data to it."})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ql,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"Supported formats: .xlsx, .xls, and .csv files"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($o,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"File Upload"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"file",id:"excel-upload",accept:".xlsx,.xls,.csv",onChange:M,disabled:a||!l,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),r.jsxs("div",{className:`border-2 border-dashed rounded-xl p-4 text-center transition-all duration-200 ${!l||a?"border-gray-200 bg-gray-50/50":"border-slate-300 hover:border-slate-400 hover:bg-slate-50/50 bg-white"}`,children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[r.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${!l||a?"bg-gray-100":"bg-gradient-to-br from-slate-100 to-slate-200"}`,children:a?r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-slate-600"}):r.jsx(Qr,{className:`w-5 h-5 ${l?"text-slate-600":"text-gray-300"}`})}),r.jsxs("div",{className:"text-left",children:[r.jsx("p",{className:`text-sm font-medium ${!l||a?"text-gray-400":"text-gray-900"}`,children:a?"Processing File...":"Choose Excel File to Upload"}),r.jsx("p",{className:`text-xs ${!l||a?"text-gray-400":"text-gray-600"}`,children:"Drag and drop or click to browse"})]})]}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-1 mt-2",children:[r.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:".xlsx"}),r.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:".xls"}),r.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:".csv"})]}),!l&&r.jsxs("div",{className:"flex items-center justify-center mt-2",children:[r.jsx(Ht,{className:"w-3.5 h-3.5 text-red-500 mr-1"}),r.jsx("span",{className:"text-xs text-red-500 font-medium",children:"Select an institution first"})]})]})]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:r.jsx("button",{onClick:S,disabled:a,className:"w-full sm:w-auto px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:a?"Processing...":"Close"})})]})}):null}V6.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onDataImported:B.func.isRequired};function AV(){const[t,s]=ne.useState([]),[e,a]=ne.useState(!1),[n,i]=ne.useState(!1),[c,l]=ne.useState(""),[u,o]=ne.useState(null),[d,g]=ne.useState(""),[p,h]=ne.useState(!0),[f,x]=ne.useState(null),[b,v]=ne.useState(null),[_,N]=ne.useState(null),[E,O]=ne.useState([]);ne.useEffect(()=>{F(),z()},[]);const F=async()=>{h(!0),x(null);try{const L=await bt.get(`${Ct.API_URL}/suc-details`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}});s(L.data),console.log("response.data after fetchSucData:",L.data)}catch(L){console.error("Error fetching SUC data:",L),x("Failed to load SUC data. Please try again.")}finally{h(!1)}},z=async()=>{try{const L=await bt.get(`${Ct.API_URL}/clusters`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}});O(L.data)}catch(L){console.error("Error fetching clusters:",L),x("Failed to load clusters. Please try again.")}},P=(L,I=null)=>{l(L),o(I),a(!0)},U=()=>{a(!1),o(null),l("")},W=()=>{i(!0)},Y=()=>{i(!1)},q=async L=>{try{return(await bt.post(`${Ct.API_URL}/suc-details`,L,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json",Accept:"application/json"}})).data}catch(I){throw console.error("Error creating SUC detail:",I),I}},M=async(L,I)=>{try{return(await bt.put(`${Ct.API_URL}/suc-details/${L}`,I,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json",Accept:"application/json"}})).data}catch(Z){throw console.error("Error updating SUC detail:",Z),Z}},D=async L=>{try{return await bt.delete(`${Ct.API_URL}/suc-details/${L}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}}),!0}catch(I){throw console.error("Error deleting SUC detail:",I),I}},T=async L=>{try{const I={hei_uiid:L.institution_uiid,region:L.region||null,province:L.province||null,municipality:L.municipality||null,report_year:L.report_year,address_street:L.address_street||null,postal_code:L.postal_code||null,institutional_telephone:L.institutional_telephone||null,institutional_fax:L.institutional_fax||null,head_telephone:L.head_telephone||null,institutional_email:L.institutional_email||null,institutional_website:L.institutional_website||null,year_established:L.year_established||null,head_name:L.head_name||null,head_title:L.head_title||null,head_education:L.head_education||null,sec_registration:L.sec_registration||null,year_granted_approved:L.year_granted_approved||null,year_converted_college:L.year_converted_college||null,year_converted_university:L.year_converted_university||null,institution_name:L.institution_name||null};if(c==="add"){if(t.some(K=>K.institution_uiid===L.institution_uiid&&K.report_year===L.report_year)){Ft.showAlert("This SUC record for the selected year already exists.","error");return}await q(I),Ft.showAlert("SUC record created successfully!","success")}else await M(u.id,I),Ft.showAlert("SUC record updated successfully!","success");U(),g(""),v(null),F()}catch(I){Ft.showAlert(`Error ${c==="add"?"creating":"updating"} SUC record: ${I.message}`,"error")}},C=L=>{P("edit",L)},S=async L=>{Ft.showConfirmation("Are you sure you want to delete this SUC record?",async()=>{try{await D(L),s(t.filter(I=>I.id!==L)),Ft.showAlert("SUC record deleted successfully!","success")}catch(I){Ft.showAlert(`Error deleting SUC record: ${I.message}`,"error")}})},w=()=>{i(!1),g(""),v(null),F()},j=()=>{F()},A=t.filter(L=>{var I,Z,K,re;return(((I=L.institution_name)==null?void 0:I.toLowerCase().includes(d.toLowerCase()))||((Z=L.head_name)==null?void 0:Z.toLowerCase().includes(d.toLowerCase()))||((K=L.region)==null?void 0:K.toLowerCase().includes(d.toLowerCase()))||((re=L.municipality)==null?void 0:re.toLowerCase().includes(d.toLowerCase())))&&(b===null||String(L.report_year)===String(b))&&(_===null||String(L.cluster_id)===String(_))});return console.log("filteredData passed to DataTable:",A),p?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Loading SUC data..."})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[r.jsxs("div",{className:"flex items-center mb-2",children:[r.jsx(gr,{className:"w-8 h-8 text-blue-600 mr-3"}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"State Universities and Colleges Management"})]}),r.jsx("p",{className:"text-gray-600",children:"Comprehensive management system for State Universities and Colleges (SUC) in the Philippines"})]}),f&&r.jsx("div",{className:"mb-6 p-4 rounded-lg border bg-red-50 border-red-200 text-red-800",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(vs,{className:"w-5 h-5 mr-2"}),r.jsx("span",{className:"font-medium",children:f})]}),r.jsx("button",{onClick:()=>x(null),className:"text-red-500 hover:text-red-700",children:r.jsx(vs,{className:"w-4 h-4"})})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-4",children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-3 flex-1",children:[r.jsxs("div",{className:"relative",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search institutions...",value:d,onChange:L=>g(L.target.value),className:"pl-10 pr-4 py-2 w-64 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{htmlFor:"reportYear",className:"text-sm text-gray-600",children:"Year:"}),r.jsxs("select",{id:"reportYear",value:b||"",onChange:L=>v(L.target.value===""?null:Number(L.target.value)),className:"px-2 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-sm",children:[r.jsx("option",{value:"",children:"All"}),Array.from({length:new Date().getFullYear()-2e3+1},(L,I)=>{const Z=new Date().getFullYear()-I;return r.jsx("option",{value:Z,children:Z},Z)})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{htmlFor:"cluster",className:"text-sm text-gray-600",children:"Cluster:"}),r.jsxs("select",{id:"cluster",value:_||"",onChange:L=>N(L.target.value===""?null:L.target.value),className:"px-2 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-sm",children:[r.jsx("option",{value:"",children:"All"}),E.map(L=>r.jsx("option",{value:L.id,children:L.name},L.id))]})]}),r.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",r.jsx("span",{className:"font-semibold",children:A.length})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:j,disabled:p,className:"p-2 border border-gray-300 text-sm rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(pE,{className:`w-4 h-4 ${p?"animate-spin":""}`})}),r.jsxs("button",{onClick:W,className:"flex items-center px-3 py-2 border border-gray-300 text-sm rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[r.jsx(Qr,{className:"w-4 h-4 mr-1"}),"Upload"]}),r.jsxs("button",{onClick:()=>P("add"),className:"flex items-center px-3 py-2 border border-transparent text-sm rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-1"}),"Add SUC"]})]})]})}),r.jsx(K4,{data:A,onEdit:C,onDelete:S,loading:p})]})]}),r.jsx(V6,{isOpen:n,onClose:Y,onDataImported:w}),e&&(c==="add"?r.jsx(z6,{onSave:T,onCancel:U,closeModal:U}):r.jsx(H6,{initialData:u,onSave:T,onCancel:U,closeModal:U}))]})}function ow(){const[t,s]=ne.useState([]),[e,a]=ne.useState(!1),[n,i]=ne.useState(""),[c,l]=ne.useState(null),[u,o]=ne.useState("");ne.useEffect(()=>{s([{id:1,institution_uiid:"PRI-001",institution_name:"Ateneo de Manila University",region:"NCR",province:"Metro Manila",municipality:"Quezon City",address_street:"Katipunan Avenue",postal_code:"1108",institutional_telephone:"+63-2-8426-6001",institutional_fax:"+63-2-8426-6002",institutional_email:"info@ateneo.edu",institutional_website:"https://ateneo.edu",year_established:1859,report_year:2024,head_name:"Fr. Roberto C. Yap, SJ",head_title:"President",head_education:"PhD in Philosophy",head_telephone:"+63-2-8426-6003",sec_registration:"SEC-ADMU-001",year_granted_approved:1859,year_converted_college:1865,year_converted_university:1959},{id:2,institution_uiid:"PRI-002",institution_name:"De La Salle University",region:"NCR",province:"Metro Manila",municipality:"Manila",address_street:"2401 Taft Avenue",postal_code:"1004",institutional_telephone:"+63-2-8524-4611",institutional_email:"info@dlsu.edu.ph",institutional_website:"https://dlsu.edu.ph",year_established:1911,report_year:2024,head_name:"Br. Raymundo B. Suplido FSC",head_title:"President",head_education:"PhD in Chemical Engineering",head_telephone:"+63-2-8524-4612",sec_registration:"SEC-DLSU-001",year_granted_approved:1911,year_converted_college:1920,year_converted_university:1975},{id:3,institution_uiid:"PRI-003",institution_name:"University of Santo Tomas",region:"NCR",province:"Metro Manila",municipality:"Manila",address_street:"Espaa Boulevard",postal_code:"1008",institutional_telephone:"+63-2-8731-3101",institutional_email:"info@ust.edu.ph",institutional_website:"https://ust.edu.ph",year_established:1611,report_year:2024,head_name:"Rev. Fr. Richard Ang, OP",head_title:"Rector Magnificus",head_education:"PhD in Sacred Theology",head_telephone:"+63-2-8731-3102",sec_registration:"SEC-UST-001",year_granted_approved:1611,year_converted_college:1645,year_converted_university:1645},{id:4,institution_uiid:"PRI-004",institution_name:"Mapa University",region:"NCR",province:"Metro Manila",municipality:"Manila",address_street:"658 Muralla Street, Intramuros",postal_code:"1002",institutional_telephone:"+63-2-8247-5000",institutional_email:"info@mapua.edu.ph",institutional_website:"https://mapua.edu.ph",year_established:1925,report_year:2024,head_name:"Dr. Reynaldo B. Vea",head_title:"President",head_education:"PhD in Electrical Engineering",head_telephone:"+63-2-8247-5001",sec_registration:"SEC-MIT-001",year_granted_approved:1925,year_converted_college:1930,year_converted_university:2001}])},[]);const d=(x,b=null)=>{i(x),l(b),a(!0)},g=()=>{a(!1),l(null),i("")},p=x=>{if(n==="add"){const b={...x,id:Date.now()};s([...t,b])}else s(t.map(b=>b.id===c.id?{...b,...x}:b));g()},h=x=>{window.confirm("Are you sure you want to delete this Private HEI record?")&&s(t.filter(b=>b.id!==x))},f=t.filter(x=>{var b,v,_,N;return((b=x.institution_name)==null?void 0:b.toLowerCase().includes(u.toLowerCase()))||((v=x.head_name)==null?void 0:v.toLowerCase().includes(u.toLowerCase()))||((_=x.region)==null?void 0:_.toLowerCase().includes(u.toLowerCase()))||((N=x.municipality)==null?void 0:N.toLowerCase().includes(u.toLowerCase()))});return r.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[r.jsxs("div",{className:"flex items-center mb-2",children:[r.jsx(Hf,{className:"w-8 h-8 text-purple-600 mr-3"}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Private Higher Education Institutions Management"})]}),r.jsx("p",{className:"text-gray-600",children:"Comprehensive management system for Private Universities and Colleges in the Philippines"})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search by institution name, head, or location...",value:u,onChange:x=>o(x.target.value),className:"pl-10 pr-4 py-2 w-80 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),r.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:["Total Private HEIs: ",r.jsx("span",{className:"font-semibold ml-1",children:f.length})]})]}),r.jsxs("button",{onClick:()=>d("add"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add New Private HEI"]})]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Institution"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leadership"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Established"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[f.map(x=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.institution_name}),r.jsx("div",{className:"text-sm text-gray-500",children:x.institution_uiid})]})})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:[x.municipality,", ",x.province]}),r.jsx("div",{className:"text-sm text-gray-500",children:x.region})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.head_name}),r.jsx("div",{className:"text-sm text-gray-500",children:x.head_title})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"text-sm text-gray-900 flex items-center",children:[r.jsx(ao,{className:"w-3 h-3 mr-1"}),x.institutional_telephone]}),r.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[r.jsx(Dn,{className:"w-3 h-3 mr-1"}),x.institutional_email]})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:x.year_established}),x.year_converted_university&&r.jsxs("div",{className:"text-sm text-gray-500",children:["Univ: ",x.year_converted_university]})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[r.jsx("button",{onClick:()=>d("edit",x),className:"text-purple-600 hover:text-purple-900 mr-3",title:"Edit Private HEI",children:r.jsx(Dr,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>h(x.id),className:"text-red-600 hover:text-red-900",title:"Delete Private HEI",children:r.jsx(a3,{className:"w-4 h-4"})})]})]},x.id)),f.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx(Hf,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{className:"text-lg font-medium",children:"No Private HEIs found"}),r.jsx("p",{className:"text-sm",children:"Try adjusting your search terms or add a new Private HEI."})]})})})]})]})})]})]}),e&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:r.jsxs("div",{className:"relative top-10 mx-auto p-5 border w-11/12 max-w-5xl shadow-lg rounded-md bg-white",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Hf,{className:"w-5 h-5 mr-2"}),n==="add"?"Add New":"Edit"," Private Higher Education Institution"]}),r.jsx("button",{onClick:g,className:"text-gray-400 hover:text-gray-600",children:r.jsx(vs,{className:"w-6 h-6"})})]}),r.jsx(q6,{initialData:c,onSave:p,onCancel:g})]})})]})}function q6({initialData:t,onSave:s,onCancel:e}){const[a,n]=ne.useState({institution_uiid:(t==null?void 0:t.institution_uiid)||"",institution_name:(t==null?void 0:t.institution_name)||"",region:(t==null?void 0:t.region)||"",province:(t==null?void 0:t.province)||"",municipality:(t==null?void 0:t.municipality)||"",address_street:(t==null?void 0:t.address_street)||"",postal_code:(t==null?void 0:t.postal_code)||"",institutional_telephone:(t==null?void 0:t.institutional_telephone)||"",institutional_fax:(t==null?void 0:t.institutional_fax)||"",head_telephone:(t==null?void 0:t.head_telephone)||"",institutional_email:(t==null?void 0:t.institutional_email)||"",institutional_website:(t==null?void 0:t.institutional_website)||"",year_established:(t==null?void 0:t.year_established)||"",report_year:(t==null?void 0:t.report_year)||new Date().getFullYear(),head_name:(t==null?void 0:t.head_name)||"",head_title:(t==null?void 0:t.head_title)||"",head_education:(t==null?void 0:t.head_education)||"",sec_registration:(t==null?void 0:t.sec_registration)||"",year_granted_approved:(t==null?void 0:t.year_granted_approved)||"",year_converted_college:(t==null?void 0:t.year_converted_college)||"",year_converted_university:(t==null?void 0:t.year_converted_university)||""}),i=()=>{if(!a.institution_uiid||!a.institution_name||!a.report_year){alert("Please fill in all required fields (Institution UIID, Name, and Report Year)");return}s(a)};return r.jsxs("div",{className:"space-y-6 max-h-96 overflow-y-auto",children:[r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(Ya,{className:"w-5 h-5 mr-2"}),"Basic Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution UIID ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a.institution_uiid,onChange:c=>n({...a,institution_uiid:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., PRI-001",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Established"}),r.jsx("input",{type:"number",value:a.year_established,onChange:c=>n({...a,year_established:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., 1859"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Report Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:a.report_year,onChange:c=>n({...a,report_year:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",required:!0})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a.institution_name,onChange:c=>n({...a,institution_name:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Ateneo de Manila University",required:!0})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(yn,{className:"w-5 h-5 mr-2"}),"Location Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region"}),r.jsx("input",{type:"text",value:a.region,onChange:c=>n({...a,region:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., NCR"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Province"}),r.jsx("input",{type:"text",value:a.province,onChange:c=>n({...a,province:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Metro Manila"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Municipality/City"}),r.jsx("input",{type:"text",value:a.municipality,onChange:c=>n({...a,municipality:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Quezon City"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4",children:[r.jsxs("div",{className:"md:col-span-3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),r.jsx("input",{type:"text",value:a.address_street,onChange:c=>n({...a,address_street:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Katipunan Avenue"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),r.jsx("input",{type:"text",value:a.postal_code,onChange:c=>n({...a,postal_code:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., 1108"})]})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(ao,{className:"w-5 h-5 mr-2"}),"Contact Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Telephone"}),r.jsx("input",{type:"text",value:a.institutional_telephone,onChange:c=>n({...a,institutional_telephone:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., +63-2-8426-6001"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Fax"}),r.jsx("input",{type:"text",value:a.institutional_fax,onChange:c=>n({...a,institutional_fax:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., +63-2-8426-6002"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),r.jsx("input",{type:"email",value:a.institutional_email,onChange:c=>n({...a,institutional_email:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., info@university.edu"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),r.jsx("input",{type:"url",value:a.institutional_website,onChange:c=>n({...a,institutional_website:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., https://university.edu"})]})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(ir,{className:"w-5 h-5 mr-2"}),"Leadership Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chief Executive Name"}),r.jsx("input",{type:"text",value:a.head_name,onChange:c=>n({...a,head_name:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Fr. Roberto C. Yap, SJ"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),r.jsx("input",{type:"text",value:a.head_title,onChange:c=>n({...a,head_title:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., President, Rector, Chancellor"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Educational Background"}),r.jsx("input",{type:"text",value:a.head_education,onChange:c=>n({...a,head_education:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., PhD in Philosophy"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direct Telephone"}),r.jsx("input",{type:"text",value:a.head_telephone,onChange:c=>n({...a,head_telephone:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., +63-2-8426-6003"})]})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(Lr,{className:"w-5 h-5 mr-2"}),"Legal & Corporate Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SEC Registration Number"}),r.jsx("input",{type:"text",value:a.sec_registration,onChange:c=>n({...a,sec_registration:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., SEC-ADMU-001"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Incorporated/Founded"}),r.jsx("input",{type:"number",value:a.year_granted_approved,onChange:c=>n({...a,year_granted_approved:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., 1859"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Converted to College"}),r.jsx("input",{type:"number",value:a.year_converted_college,onChange:c=>n({...a,year_converted_college:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"Leave blank if not applicable"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Granted University Status"}),r.jsx("input",{type:"number",value:a.year_converted_university,onChange:c=>n({...a,year_converted_university:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"Leave blank if still a college"})]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t bg-gray-50 -mx-5 px-5",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsxs("button",{type:"button",onClick:i,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700",children:[r.jsx(ma,{className:"w-4 h-4 mr-2 inline"}),"Save Private HEI"]})]})]})}q6.propTypes={initialData:B.shape({institution_uiid:B.string,institution_name:B.string,region:B.string,province:B.string,municipality:B.string,address_street:B.string,postal_code:B.string,institutional_telephone:B.string,institutional_fax:B.string,head_telephone:B.string,institutional_email:B.string,institutional_website:B.string,year_established:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number]),head_name:B.string,head_title:B.string,head_education:B.string,sec_registration:B.string,year_granted_approved:B.oneOfType([B.string,B.number]),year_converted_college:B.oneOfType([B.string,B.number]),year_converted_university:B.oneOfType([B.string,B.number])}),onSave:B.func.isRequired,onCancel:B.func.isRequired};function lw(){const[t,s]=ne.useState([]),[e,a]=ne.useState(!1),[n,i]=ne.useState(""),[c,l]=ne.useState(null),[u,o]=ne.useState("");ne.useEffect(()=>{s([{id:1,institution_uiid:"LUC-001",institution_name:"University of Makati",region:"NCR",province:"Metro Manila",municipality:"Makati City",address_street:"J.P. Rizal Extension",postal_code:"1215",institutional_telephone:"+63-2-8883-1863",institutional_fax:"+63-2-8883-1864",institutional_email:"info@umak.edu.ph",institutional_website:"https://umak.edu.ph",year_established:1972,report_year:2024,head_name:"Dr. Tomas D. Fontanilla",head_title:"President",head_education:"PhD in Business Administration",head_telephone:"+63-2-8883-1865",sec_registration:"SEC-UMAK-001",year_granted_approved:1972,year_converted_college:1982,year_converted_university:1995},{id:2,institution_uiid:"LUC-002",institution_name:"Pamantasan ng Lungsod ng Maynila",region:"NCR",province:"Metro Manila",municipality:"Manila",address_street:"General Luna Street, Intramuros",postal_code:"1002",institutional_telephone:"+63-2-8643-2500",institutional_email:"info@plm.edu.ph",institutional_website:"https://plm.edu.ph",year_established:1965,report_year:2024,head_name:"Dr. Emmanuel de Guzman",head_title:"President",head_education:"PhD in Public Administration",head_telephone:"+63-2-8643-2501",sec_registration:"SEC-PLM-001",year_granted_approved:1965,year_converted_college:1967,year_converted_university:1977},{id:3,institution_uiid:"LUC-003",institution_name:"Pamantasan ng Lungsod ng Pasig",region:"NCR",province:"Metro Manila",municipality:"Pasig City",address_street:"Nagpayong Complex, C. Raymundo Avenue",postal_code:"1600",institutional_telephone:"+63-2-8641-5661",institutional_email:"info@plpasig.edu.ph",institutional_website:"https://plpasig.edu.ph",year_established:1999,report_year:2024,head_name:"Dr. Carmelita Divinagracia",head_title:"President",head_education:"PhD in Education",head_telephone:"+63-2-8641-5662",sec_registration:"SEC-PLP-001",year_granted_approved:1999,year_converted_college:2001,year_converted_university:2010}])},[]);const d=(x,b=null)=>{i(x),l(b),a(!0)},g=()=>{a(!1),l(null),i("")},p=x=>{if(n==="add"){const b={...x,id:Date.now()};s([...t,b])}else s(t.map(b=>b.id===c.id?{...b,...x}:b));g()},h=x=>{window.confirm("Are you sure you want to delete this LUC record?")&&s(t.filter(b=>b.id!==x))},f=t.filter(x=>{var b,v,_,N;return((b=x.institution_name)==null?void 0:b.toLowerCase().includes(u.toLowerCase()))||((v=x.head_name)==null?void 0:v.toLowerCase().includes(u.toLowerCase()))||((_=x.region)==null?void 0:_.toLowerCase().includes(u.toLowerCase()))||((N=x.municipality)==null?void 0:N.toLowerCase().includes(u.toLowerCase()))});return r.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[r.jsxs("div",{className:"flex items-center mb-2",children:[r.jsx(Bl,{className:"w-8 h-8 text-green-600 mr-3"}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Local Universities and Colleges Management"})]}),r.jsx("p",{className:"text-gray-600",children:"Comprehensive management system for Local Universities and Colleges (LUC) in the Philippines"})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search by institution name, head, or location...",value:u,onChange:x=>o(x.target.value),className:"pl-10 pr-4 py-2 w-80 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500"})]}),r.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:["Total LUCs: ",r.jsx("span",{className:"font-semibold ml-1",children:f.length})]})]}),r.jsxs("button",{onClick:()=>d("add"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add New LUC"]})]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Institution"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leadership"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Established"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[f.map(x=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.institution_name}),r.jsx("div",{className:"text-sm text-gray-500",children:x.institution_uiid})]})})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:[x.municipality,", ",x.province]}),r.jsx("div",{className:"text-sm text-gray-500",children:x.region})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.head_name}),r.jsx("div",{className:"text-sm text-gray-500",children:x.head_title})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"text-sm text-gray-900 flex items-center",children:[r.jsx(ao,{className:"w-3 h-3 mr-1"}),x.institutional_telephone]}),r.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[r.jsx(Dn,{className:"w-3 h-3 mr-1"}),x.institutional_email]})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:x.year_established}),x.year_converted_university&&r.jsxs("div",{className:"text-sm text-gray-500",children:["Univ: ",x.year_converted_university]})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[r.jsx("button",{onClick:()=>d("edit",x),className:"text-green-600 hover:text-green-900 mr-3",title:"Edit LUC",children:r.jsx(Dr,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>h(x.id),className:"text-red-600 hover:text-red-900",title:"Delete LUC",children:r.jsx(a3,{className:"w-4 h-4"})})]})]},x.id)),f.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx(Bl,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{className:"text-lg font-medium",children:"No LUCs found"}),r.jsx("p",{className:"text-sm",children:"Try adjusting your search terms or add a new LUC."})]})})})]})]})})]})]}),e&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:r.jsxs("div",{className:"relative top-10 mx-auto p-5 border w-11/12 max-w-5xl shadow-lg rounded-md bg-white",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Bl,{className:"w-5 h-5 mr-2"}),n==="add"?"Add New":"Edit"," Local University/College"]}),r.jsx("button",{onClick:g,className:"text-gray-400 hover:text-gray-600",children:r.jsx(vs,{className:"w-6 h-6"})})]}),r.jsx(G6,{initialData:c,onSave:p,onCancel:g})]})})]})}function G6({initialData:t,onSave:s,onCancel:e}){const[a,n]=ne.useState({institution_uiid:(t==null?void 0:t.institution_uiid)||"",institution_name:(t==null?void 0:t.institution_name)||"",region:(t==null?void 0:t.region)||"",province:(t==null?void 0:t.province)||"",municipality:(t==null?void 0:t.municipality)||"",address_street:(t==null?void 0:t.address_street)||"",postal_code:(t==null?void 0:t.postal_code)||"",institutional_telephone:(t==null?void 0:t.institutional_telephone)||"",institutional_fax:(t==null?void 0:t.institutional_fax)||"",head_telephone:(t==null?void 0:t.head_telephone)||"",institutional_email:(t==null?void 0:t.institutional_email)||"",institutional_website:(t==null?void 0:t.institutional_website)||"",year_established:(t==null?void 0:t.year_established)||"",report_year:(t==null?void 0:t.report_year)||new Date().getFullYear(),head_name:(t==null?void 0:t.head_name)||"",head_title:(t==null?void 0:t.head_title)||"",head_education:(t==null?void 0:t.head_education)||"",sec_registration:(t==null?void 0:t.sec_registration)||"",year_granted_approved:(t==null?void 0:t.year_granted_approved)||"",year_converted_college:(t==null?void 0:t.year_converted_college)||"",year_converted_university:(t==null?void 0:t.year_converted_university)||""}),i=()=>{if(!a.institution_uiid||!a.institution_name||!a.report_year){alert("Please fill in all required fields (Institution UIID, Name, and Report Year)");return}s(a)};return r.jsxs("div",{className:"space-y-6 max-h-96 overflow-y-auto",children:[r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(Ya,{className:"w-5 h-5 mr-2"}),"Basic Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution UIID ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a.institution_uiid,onChange:c=>n({...a,institution_uiid:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., LUC-001",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Established"}),r.jsx("input",{type:"number",value:a.year_established,onChange:c=>n({...a,year_established:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 1972"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Report Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:a.report_year,onChange:c=>n({...a,report_year:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",required:!0})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a.institution_name,onChange:c=>n({...a,institution_name:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., University of Makati",required:!0})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(yn,{className:"w-5 h-5 mr-2"}),"Location Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region"}),r.jsx("input",{type:"text",value:a.region,onChange:c=>n({...a,region:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., NCR"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Province"}),r.jsx("input",{type:"text",value:a.province,onChange:c=>n({...a,province:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Metro Manila"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Municipality/City"}),r.jsx("input",{type:"text",value:a.municipality,onChange:c=>n({...a,municipality:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Makati City"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4",children:[r.jsxs("div",{className:"md:col-span-3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),r.jsx("input",{type:"text",value:a.address_street,onChange:c=>n({...a,address_street:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., J.P. Rizal Extension"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),r.jsx("input",{type:"text",value:a.postal_code,onChange:c=>n({...a,postal_code:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 1215"})]})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(ao,{className:"w-5 h-5 mr-2"}),"Contact Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Telephone"}),r.jsx("input",{type:"text",value:a.institutional_telephone,onChange:c=>n({...a,institutional_telephone:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., +63-2-8883-1863"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Fax"}),r.jsx("input",{type:"text",value:a.institutional_fax,onChange:c=>n({...a,institutional_fax:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., +63-2-8883-1864"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),r.jsx("input",{type:"email",value:a.institutional_email,onChange:c=>n({...a,institutional_email:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., info@university.edu.ph"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),r.jsx("input",{type:"url",value:a.institutional_website,onChange:c=>n({...a,institutional_website:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., https://university.edu.ph"})]})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(ir,{className:"w-5 h-5 mr-2"}),"Leadership Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Head Name"}),r.jsx("input",{type:"text",value:a.head_name,onChange:c=>n({...a,head_name:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Dr. Tomas D. Fontanilla"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),r.jsx("input",{type:"text",value:a.head_title,onChange:c=>n({...a,head_title:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., President, Chancellor"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Educational Background"}),r.jsx("input",{type:"text",value:a.head_education,onChange:c=>n({...a,head_education:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., PhD in Business Administration"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direct Telephone"}),r.jsx("input",{type:"text",value:a.head_telephone,onChange:c=>n({...a,head_telephone:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., +63-2-8883-1865"})]})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(Lr,{className:"w-5 h-5 mr-2"}),"Legal & Historical Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Local Government Registration"}),r.jsx("input",{type:"text",value:a.sec_registration,onChange:c=>n({...a,sec_registration:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., LGU-UMAK-001"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Granted/Approved"}),r.jsx("input",{type:"number",value:a.year_granted_approved,onChange:c=>n({...a,year_granted_approved:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 1972"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Converted to College"}),r.jsx("input",{type:"number",value:a.year_converted_college,onChange:c=>n({...a,year_converted_college:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"Leave blank if not applicable"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Converted to University"}),r.jsx("input",{type:"number",value:a.year_converted_university,onChange:c=>n({...a,year_converted_university:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",placeholder:"Leave blank if still a college"})]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t bg-gray-50 -mx-5 px-5",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsxs("button",{type:"button",onClick:i,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700",children:[r.jsx(ma,{className:"w-4 h-4 mr-2 inline"}),"Save LUC"]})]})]})}G6.propTypes={initialData:B.shape({institution_uiid:B.string,institution_name:B.string,region:B.string,province:B.string,municipality:B.string,address_street:B.string,postal_code:B.string,institutional_telephone:B.string,institutional_fax:B.string,head_telephone:B.string,institutional_email:B.string,institutional_website:B.string,year_established:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number]),head_name:B.string,head_title:B.string,head_education:B.string,sec_registration:B.string,year_granted_approved:B.oneOfType([B.string,B.number]),year_converted_college:B.oneOfType([B.string,B.number]),year_converted_university:B.oneOfType([B.string,B.number])}),onSave:B.func.isRequired,onCancel:B.func.isRequired};function Y6({isOpen:t,onClose:s,campusData:e}){if(!e)return null;const a=n=>n||"Not specified";return r.jsx(mr,{isOpen:t,onClose:s,title:e.name||"Campus Details",subtitle:"Campus Details & Information",icon:$s,variant:"default",size:"lg",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx($s,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Campus Overview"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-blue-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Campus Type"}),r.jsx("div",{className:"mt-1",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e.campus_type==="MAIN"?"bg-gradient-to-r from-green-100 to-green-200 text-green-800":"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800"}`,children:e.campus_type||"Not specified"})})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-blue-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Institutional Code"}),r.jsx("p",{className:"text-gray-900 mt-1 font-mono text-xs bg-blue-100 px-2 py-1 rounded-md inline-block",children:a(e.institutional_code)})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(yn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Location"})]}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between items-center bg-white/70 rounded-lg p-2 border border-emerald-100",children:[r.jsx("span",{className:"font-medium text-gray-600",children:"Province/Municipality:"}),r.jsx("span",{className:"text-gray-900 font-medium text-right ml-2 break-words",children:a(e.province_municipality)})]}),r.jsxs("div",{className:"flex justify-between items-center bg-white/70 rounded-lg p-2 border border-emerald-100",children:[r.jsx("span",{className:"font-medium text-gray-600",children:"Region:"}),r.jsx("span",{className:"text-gray-900 font-medium text-right ml-2 break-words",children:a(e.region)})]}),e.latitude&&e.longitude&&r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Coordinates"}),r.jsxs("a",{href:`https://maps.google.com/?q=${e.latitude},${e.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-emerald-600 hover:text-emerald-800 text-xs font-medium transition-colors duration-200",children:[r.jsx(ql,{className:"w-3 h-3 mr-1"}),"View Map",r.jsx(t3,{className:"w-3 h-3 ml-1"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-900 font-mono",children:[r.jsxs("div",{children:["Lat: ",e.latitude.toFixed(6)]}),r.jsxs("div",{children:["Lng: ",e.longitude.toFixed(6)]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Leadership"})]}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-purple-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Campus Head"}),r.jsx("p",{className:"text-gray-900 mt-1 font-semibold",children:a(e.head_full_name)})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-purple-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Position/Title"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:a(e.position_title)})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Lr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Operations"})]}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 bg-white/70 rounded-lg p-3 border border-amber-100",children:[r.jsx(Zr,{className:"w-4 h-4 text-amber-600"}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide block",children:"Year Started"}),r.jsx("p",{className:"text-gray-900 font-semibold",children:a(e.year_first_operation)})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 bg-white/70 rounded-lg p-3 border border-amber-100",children:[r.jsx(xE,{className:"w-4 h-4 text-amber-600"}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide block",children:"Land Area"}),r.jsx("p",{className:"text-gray-900 font-semibold",children:e.land_area_hectares?`${e.land_area_hectares} hectares`:"Not specified"})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($g,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Additional Info"})]}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Distance from Main"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:e.distance_from_main?`${e.distance_from_main} km`:"Not specified"})]}),r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Autonomous Status"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:a(e.autonomous_code)})]}),e.former_campus_name&&r.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:[r.jsx("span",{className:"font-medium text-gray-600 text-xs uppercase tracking-wide",children:"Former Name"}),r.jsx("p",{className:"text-gray-900 mt-1 font-medium italic break-words",children:e.former_campus_name})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 via-sky-50 to-blue-100 rounded-xl p-4 border border-cyan-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"p-2 bg-cyan-500 rounded-lg shadow-sm",children:r.jsx(ql,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Data Quality"})]}),r.jsxs("div",{className:"text-xs font-medium text-cyan-700 bg-cyan-100 px-2 py-1 rounded-full",children:[[e.name,e.campus_type,e.province_municipality,e.region,e.head_full_name,e.position_title,e.year_first_operation,e.institutional_code].filter(Boolean).length,"/8 Complete"]})]}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-cyan-100",children:r.jsx("div",{className:"flex space-x-1",children:[e.name,e.campus_type,e.province_municipality,e.region,e.head_full_name,e.position_title,e.year_first_operation,e.institutional_code].map((n,i)=>r.jsx("div",{className:`flex-1 h-2 rounded-full transition-all duration-300 ${n?"bg-gradient-to-r from-green-400 to-emerald-500 shadow-sm":"bg-gray-300"}`,title:n?"Complete":"Missing"},i))})})]})]})})}Y6.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,campusData:B.shape({id:B.oneOfType([B.string,B.number]),name:B.string,campus_type:B.string,institutional_code:B.string,province_municipality:B.string,region:B.string,latitude:B.number,longitude:B.number,head_full_name:B.string,position_title:B.string,year_first_operation:B.oneOfType([B.string,B.number]),land_area_hectares:B.oneOfType([B.string,B.number]),distance_from_main:B.oneOfType([B.string,B.number]),autonomous_code:B.string,former_campus_name:B.string})};function W6({isOpen:t,onClose:s,onSave:e,institutionId:a,loading:n=!1}){const[i,c]=ne.useState({name:"",campus_type:"SATELLITE",institutional_code:"",province_municipality:"",region:"",latitude:"",longitude:"",head_full_name:"",position_title:"",year_first_operation:"",land_area_hectares:"",distance_from_main:"",autonomous_code:"",former_campus_name:""}),[l,u]=ne.useState({}),o=(h,f)=>{c(x=>({...x,[h]:f})),l[h]&&u(x=>({...x,[h]:""}))},d=()=>{const h={};return i.name.trim()||(h.name="Campus name is required"),i.campus_type||(h.campus_type="Campus type is required"),i.province_municipality.trim()||(h.province_municipality="Province/Municipality is required"),i.region.trim()||(h.region="Region is required"),i.latitude&&(isNaN(i.latitude)||i.latitude<-90||i.latitude>90)&&(h.latitude="Latitude must be between -90 and 90"),i.longitude&&(isNaN(i.longitude)||i.longitude<-180||i.longitude>180)&&(h.longitude="Longitude must be between -180 and 180"),i.year_first_operation&&(isNaN(i.year_first_operation)||i.year_first_operation<1800||i.year_first_operation>new Date().getFullYear())&&(h.year_first_operation="Please enter a valid year"),i.land_area_hectares&&(isNaN(i.land_area_hectares)||i.land_area_hectares<0)&&(h.land_area_hectares="Land area must be a positive number"),i.distance_from_main&&(isNaN(i.distance_from_main)||i.distance_from_main<0)&&(h.distance_from_main="Distance must be a positive number"),u(h),Object.keys(h).length===0},g=()=>{if(d()){const h={...i,suc_details_id:a,latitude:i.latitude?parseFloat(i.latitude):null,longitude:i.longitude?parseFloat(i.longitude):null,year_first_operation:i.year_first_operation?parseInt(i.year_first_operation):null,land_area_hectares:i.land_area_hectares?parseFloat(i.land_area_hectares):null,distance_from_main:i.distance_from_main?parseFloat(i.distance_from_main):null};e(h)}},p=()=>{c({name:"",campus_type:"SATELLITE",institutional_code:"",province_municipality:"",region:"",latitude:"",longitude:"",head_full_name:"",position_title:"",year_first_operation:"",land_area_hectares:"",distance_from_main:"",autonomous_code:"",former_campus_name:""}),u({}),s()};return r.jsx(mr,{isOpen:t,onClose:p,title:"Add New Campus",subtitle:"Create a new campus for the institution",icon:Er,variant:"default",size:"lg",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx($s,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Basic Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Campus Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.name,onChange:h=>o("name",h.target.value),placeholder:"Enter campus name",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Campus Type ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:i.campus_type,onChange:h=>o("campus_type",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.campus_type?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"MAIN",children:"Main Campus"}),r.jsx("option",{value:"SATELLITE",children:"Satellite Campus"})]}),l.campus_type&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.campus_type})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Code"}),r.jsx("input",{type:"text",value:i.institutional_code,onChange:h=>o("institutional_code",h.target.value),placeholder:"Enter institutional code",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(yn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Location"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Province/Municipality ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.province_municipality,onChange:h=>o("province_municipality",h.target.value),placeholder:"Enter province/municipality",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.province_municipality?"border-red-300 bg-red-50":"border-gray-300"}`}),l.province_municipality&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.province_municipality})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Region ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.region,onChange:h=>o("region",h.target.value),placeholder:"Enter region",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.region?"border-red-300 bg-red-50":"border-gray-300"}`}),l.region&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.region})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),r.jsx("input",{type:"number",step:"any",value:i.latitude,onChange:h=>o("latitude",h.target.value),placeholder:"0.000000",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.latitude?"border-red-300 bg-red-50":"border-gray-300"}`}),l.latitude&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.latitude})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),r.jsx("input",{type:"number",step:"any",value:i.longitude,onChange:h=>o("longitude",h.target.value),placeholder:"0.000000",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.longitude?"border-red-300 bg-red-50":"border-gray-300"}`}),l.longitude&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.longitude})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Leadership"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Campus Head"}),r.jsx("input",{type:"text",value:i.head_full_name,onChange:h=>o("head_full_name",h.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position/Title"}),r.jsx("input",{type:"text",value:i.position_title,onChange:h=>o("position_title",h.target.value),placeholder:"Enter position/title",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Lr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Operations"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year First Operation"}),r.jsx("input",{type:"number",value:i.year_first_operation,onChange:h=>o("year_first_operation",h.target.value),placeholder:"e.g. 2020",min:"1800",max:new Date().getFullYear(),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200 ${l.year_first_operation?"border-red-300 bg-red-50":"border-gray-300"}`}),l.year_first_operation&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.year_first_operation})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Land Area (hectares)"}),r.jsx("input",{type:"number",step:"0.01",value:i.land_area_hectares,onChange:h=>o("land_area_hectares",h.target.value),placeholder:"e.g. 10.5",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200 ${l.land_area_hectares?"border-red-300 bg-red-50":"border-gray-300"}`}),l.land_area_hectares&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.land_area_hectares})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($g,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Additional Info"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Distance from Main (km)"}),r.jsx("input",{type:"number",step:"0.1",value:i.distance_from_main,onChange:h=>o("distance_from_main",h.target.value),placeholder:"e.g. 15.5",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200 ${l.distance_from_main?"border-red-300 bg-red-50":"border-gray-300"}`}),l.distance_from_main&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.distance_from_main})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autonomous Code"}),r.jsx("input",{type:"text",value:i.autonomous_code,onChange:h=>o("autonomous_code",h.target.value),placeholder:"Enter autonomous code",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Former Campus Name"}),r.jsx("input",{type:"text",value:i.former_campus_name,onChange:h=>o("former_campus_name",h.target.value),placeholder:"Enter former name (if any)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:p,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),r.jsx("button",{onClick:g,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2"}),"Create Campus"]})})]})]})})}W6.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired,loading:B.bool};const OV={"01":"President","02":"Chancellor","03":"Executive Director","04":"Dean","05":"Rector","06":"Head","07":"Administrator","08":"Principal","09":"Managing Director",10:"Director",11:"Chair",12:"Others",99:"Not known or not indicated"},RV={1:"CAMPUS IS AUTONOMOUS FROM THE SUC MAIN CAMPUS",2:"CAMPUS IS NOT AUTONOMOUS FROM MAIN CAMPUS",3:"NO INFORMATION ON THE MATTER"};function X6({isOpen:t,onClose:s,onSave:e,campusData:a,loading:n=!1}){const[i,c]=ne.useState({name:"",campus_type:"SATELLITE",institutional_code:"",province_municipality:"",region:"",latitude:"",longitude:"",head_full_name:"",position_title:"",year_first_operation:"",land_area_hectares:"",distance_from_main:"",autonomous_code:"",former_campus_name:""}),[l,u]=ne.useState({});ne.useEffect(()=>{a&&c({name:a.name||"",campus_type:a.campus_type||"SATELLITE",institutional_code:a.institutional_code||"",province_municipality:a.province_municipality||"",region:a.region||"",latitude:a.latitude?a.latitude.toString():"",longitude:a.longitude?a.longitude.toString():"",head_full_name:a.head_full_name||"",position_title:a.position_title||"",year_first_operation:a.year_first_operation?a.year_first_operation.toString():"",land_area_hectares:a.land_area_hectares?a.land_area_hectares.toString():"",distance_from_main:a.distance_from_main?a.distance_from_main.toString():"",autonomous_code:a.autonomous_code||"",former_campus_name:a.former_campus_name||""})},[a]);const o=(f,x)=>{c(b=>({...b,[f]:x})),l[f]&&u(b=>({...b,[f]:""}))},d=()=>{const f={};return i.name.trim()||(f.name="Campus name is required"),i.campus_type||(f.campus_type="Campus type is required"),i.province_municipality.trim()||(f.province_municipality="Province/Municipality is required"),i.region.trim()||(f.region="Region is required"),u(f),Object.keys(f).length===0},g=()=>{if(d()){const f={...i,id:a.id,latitude:i.latitude?parseFloat(i.latitude):null,longitude:i.longitude?parseFloat(i.longitude):null,year_first_operation:i.year_first_operation?parseInt(i.year_first_operation):null,land_area_hectares:i.land_area_hectares?parseFloat(i.land_area_hectares):null,distance_from_main:i.distance_from_main?parseFloat(i.distance_from_main):null};e(f)}},p=()=>{u({}),s()},h=Object.entries(OV).sort(([f],[x])=>parseInt(f)-parseInt(x));return r.jsx(mr,{isOpen:t,onClose:p,title:`Edit ${(a==null?void 0:a.name)||"Campus"}`,subtitle:"Update campus information and details",icon:Dr,variant:"default",size:"lg",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx($s,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Basic Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Campus Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.name,onChange:f=>o("name",f.target.value),placeholder:"Enter campus name",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Campus Type ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:i.campus_type,onChange:f=>o("campus_type",f.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.campus_type?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"MAIN",children:"Main Campus"}),r.jsx("option",{value:"SATELLITE",children:"Satellite Campus"})]}),l.campus_type&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.campus_type})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institutional Code"}),r.jsx("input",{type:"text",value:i.institutional_code,onChange:f=>o("institutional_code",f.target.value),placeholder:"Enter institutional code",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(yn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Location"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Province/Municipality ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.province_municipality,onChange:f=>o("province_municipality",f.target.value),placeholder:"Enter province/municipality",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.province_municipality?"border-red-300 bg-red-50":"border-gray-300"}`}),l.province_municipality&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.province_municipality})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Region ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.region,onChange:f=>o("region",f.target.value),placeholder:"Enter region",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.region?"border-red-300 bg-red-50":"border-gray-300"}`}),l.region&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.region})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),r.jsx("input",{type:"number",step:"any",value:i.latitude,onChange:f=>o("latitude",f.target.value),placeholder:"0.000000",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.latitude?"border-red-300 bg-red-50":"border-gray-300"}`}),l.latitude&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.latitude})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),r.jsx("input",{type:"number",step:"any",value:i.longitude,onChange:f=>o("longitude",f.target.value),placeholder:"0.000000",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.longitude?"border-red-300 bg-red-50":"border-gray-300"}`}),l.longitude&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.longitude})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Leadership"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Campus Head"}),r.jsx("input",{type:"text",value:i.head_full_name,onChange:f=>o("head_full_name",f.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position/Title"}),r.jsxs("select",{value:i.position_title,onChange:f=>o("position_title",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200",children:[r.jsx("option",{value:"",children:"Select Position"}),h.map(([f,x])=>r.jsx("option",{value:f,children:x},f))]})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Lr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Operations"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year First Operation"}),r.jsx("input",{type:"number",value:i.year_first_operation,onChange:f=>o("year_first_operation",f.target.value),placeholder:"e.g. 2020",min:"1800",max:new Date().getFullYear(),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200 ${l.year_first_operation?"border-red-300 bg-red-50":"border-gray-300"}`}),l.year_first_operation&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.year_first_operation})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Land Area (hectares)"}),r.jsx("input",{type:"number",step:"0.01",value:i.land_area_hectares,onChange:f=>o("land_area_hectares",f.target.value),placeholder:"e.g. 10.5",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200 ${l.land_area_hectares?"border-red-300 bg-red-50":"border-gray-300"}`}),l.land_area_hectares&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.land_area_hectares})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($g,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Additional Info"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Distance from Main (km)"}),r.jsx("input",{type:"number",step:"0.1",value:i.distance_from_main,onChange:f=>o("distance_from_main",f.target.value),placeholder:"e.g. 15.5",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200 ${l.distance_from_main?"border-red-300 bg-red-50":"border-gray-300"}`}),l.distance_from_main&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.distance_from_main})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autonomous Code"}),r.jsxs("select",{value:i.autonomous_code,onChange:f=>o("autonomous_code",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200",children:[r.jsx("option",{value:"",children:"Select Autonomous Code"}),Object.entries(RV).map(([f,x])=>r.jsx("option",{value:f,children:x},f))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Former Campus Name"}),r.jsx("input",{type:"text",value:i.former_campus_name,onChange:f=>o("former_campus_name",f.target.value),placeholder:"Enter former name (if any)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200"})]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:p,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),r.jsx("button",{onClick:g,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2"}),"Update Campus"]})})]})]})})}X6.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,campusData:B.shape({id:B.oneOfType([B.string,B.number]),name:B.string,campus_type:B.string,institutional_code:B.string,province_municipality:B.string,region:B.string,latitude:B.number,longitude:B.number,head_full_name:B.string,position_title:B.string,year_first_operation:B.oneOfType([B.string,B.number]),land_area_hectares:B.oneOfType([B.string,B.number]),distance_from_main:B.oneOfType([B.string,B.number]),autonomous_code:B.string,former_campus_name:B.string}),loading:B.bool};function MV(){var Z;const{SucDetailId:t}=Ko(),s=Aa(),a=((Z=qs().state)==null?void 0:Z.heiName)||"Unknown Institution",[n,i]=ne.useState([]),[c,l]=ne.useState([]),[u,o]=ne.useState(!0),[d,g]=ne.useState(""),[p,h]=ne.useState(null),[f,x]=ne.useState(!1),[b,v]=ne.useState(!1),[_,N]=ne.useState(!1),[E,O]=ne.useState(!1),[F,z]=ne.useState(!1),[P,U]=ne.useState(""),[W,Y]=ne.useState("ALL");ne.useEffect(()=>{q()},[]),ne.useEffect(()=>{let K=n;P&&(K=K.filter(re=>{var G,ae,V;return((G=re.name)==null?void 0:G.toLowerCase().includes(P.toLowerCase()))||((ae=re.municipality)==null?void 0:ae.toLowerCase().includes(P.toLowerCase()))||((V=re.head_name)==null?void 0:V.toLowerCase().includes(P.toLowerCase()))})),W!=="ALL"&&(K=K.filter(re=>re.campus_type===W)),l(K)},[n,P,W]);const q=async()=>{if(!t){console.error("SucDetailId is undefined. Cannot fetch campuses."),g("Invalid institution ID. Please check the URL or try again."),o(!1);return}o(!0),g("");try{const K=await bt.get(`${Ct.API_URL}/suc-campuses`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"},params:{suc_details_id:t}}),re=Array.isArray(K.data)?K.data:K.data.data||[];i(re),l(re),console.log("Fetched campuses:",re)}catch(K){console.error("Error fetching campuses:",K),g("Failed to load campuses. Please try again.")}finally{o(!1)}},M=K=>{h(K),x(!0)},D=K=>{h(K),N(!0)},T=async K=>{z(!0);try{const re=await bt.put(`${Ct.API_URL}/suc-campuses/${K.id}`,K,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(re.status===200){const G=re.data;i(ae=>ae.map(V=>V.id===G.id?G:V)),l(ae=>ae.map(V=>V.id===G.id?G:V)),N(!1),h(null),console.log("Campus updated successfully:",G)}}catch(re){console.error("Error updating campus:",re),g("Failed to update campus. Please try again.")}finally{z(!1)}},C=()=>{N(!1),h(null)},S=()=>{v(!0)},w=async K=>{O(!0);try{const re=await bt.post(`${Ct.API_URL}/suc-campuses`,K,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(re.status===201){const G=re.data;i(ae=>[...ae,G]),l(ae=>[...ae,G]),v(!1),console.log("Campus created successfully:",G)}}catch(re){console.error("Error creating campus:",re),g("Failed to create campus. Please try again.")}finally{O(!1)}},j=()=>{v(!1)},A=async K=>{if(window.confirm("Are you sure you want to delete this campus?"))try{if((await bt.delete(`${Ct.API_URL}/suc-campus/${K}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}})).status===200)i(n.filter(G=>G.id!==K));else throw new Error("Failed to delete campus")}catch(re){console.error("Error deleting campus:",re),g("Failed to delete campus. Please try again.")}},L=()=>{s("/super-admin/institutions/suc")},I=()=>{x(!1),h(null)};return ne.useEffect(()=>{console.log("Institution Name:",a)},[a]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:L,className:"mr-4 p-2 text-gray-600 hover:text-gray-900 hover:bg-white/50 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Back to SUC List",children:r.jsx(Zo,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Campus Management"}),r.jsxs("p",{className:"text-gray-600 flex items-center",children:[r.jsx($s,{className:"w-4 h-4 mr-2"}),a]})]})]}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm mb-6",children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1 w-full xl:w-auto",children:[r.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search campuses...",value:P,onChange:K=>U(K.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-60 lg:w-80 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm transition-all duration-200"})]}),r.jsxs("div",{className:"relative w-full sm:w-auto",children:[r.jsx(zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsxs("select",{value:W,onChange:K=>Y(K.target.value),className:"pl-10 pr-8 py-2 w-full sm:w-auto border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm appearance-none cursor-pointer transition-all duration-200",children:[r.jsx("option",{value:"ALL",children:"All Types"}),r.jsx("option",{value:"MAIN",children:"Main Campus"}),r.jsx("option",{value:"SATELLITE",children:"Satellite Campus"})]})]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row gap-2 w-full xl:w-auto",children:r.jsxs("button",{onClick:S,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Campus"]})})]}),r.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(Qo,{className:"w-4 h-4 mr-1"}),"Showing ",c.length," of"," ",n.length," campuses"]})]})})]}),d&&r.jsx("div",{className:"mb-6 p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(vs,{className:"w-5 h-5 mr-2"}),d]})}),u?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-8 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),r.jsx("span",{className:"text-gray-600 font-medium",children:"Loading campuses..."})]})})}):r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl shadow-sm border border-white/20 overflow-hidden",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsx("table",{className:"min-w-full table-fixed",children:r.jsx("thead",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50 border-b border-gray-200/50 sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"w-[300px] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Campus Information"}),r.jsx("th",{className:"w-[200px] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Type & Code"}),r.jsx("th",{className:"w-[250px] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Location"}),r.jsx("th",{className:"w-[200px] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Leadership"}),r.jsx("th",{className:"w-[120px] px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})})})}),r.jsx("div",{className:"max-h-[400px] overflow-y-auto overflow-x-hidden",style:{scrollBehavior:"smooth",scrollbarWidth:"thin",scrollbarColor:"#CBD5E1 #F1F5F9"},children:r.jsx("table",{className:"min-w-full table-fixed",children:r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[c.map((K,re)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${re%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"w-[300px] px-4 py-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0 h-8 w-8 mt-1",children:r.jsx("div",{className:`h-8 w-8 rounded-lg flex items-center justify-center ${K.campus_type==="MAIN"?"bg-gradient-to-br from-green-100 to-green-200 text-green-700":"bg-gradient-to-br from-blue-100 to-blue-200 text-blue-700"}`,children:r.jsx($s,{className:"w-4 h-4"})})}),r.jsxs("div",{className:"ml-3 min-w-0 flex-1",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-900 leading-tight break-words",children:K.name}),r.jsxs("div",{className:"text-[10px] text-gray-500 mt-1",children:["Campus ID: ",K.id]})]})]})}),r.jsx("td",{className:"w-[200px] px-4 py-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("span",{className:`inline-flex px-2 py-1 text-[10px] font-semibold rounded-full shadow-sm ${K.campus_type==="MAIN"?"bg-gradient-to-r from-green-100 to-green-200 text-green-800 border border-green-300":"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border border-blue-300"}`,children:K.campus_type}),r.jsx("div",{className:"text-[10px] text-gray-600 font-mono break-words leading-tight",children:K.institutional_code||"No Code"})]})}),r.jsx("td",{className:"w-[250px] px-4 py-4",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-xs font-medium text-gray-900 flex items-start",children:[r.jsx(yn,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0 mt-0.5"}),r.jsx("span",{className:"break-words leading-tight",children:K.province_municipality})]}),r.jsx("div",{className:"text-[10px] text-gray-600 break-words leading-tight ml-4",children:K.region}),K.latitude&&K.longitude&&r.jsxs("div",{className:"text-[10px] text-green-600 flex items-center ml-4",children:[r.jsx(ql,{className:"w-2.5 h-2.5 mr-1 flex-shrink-0"}),r.jsx("span",{children:"Geo-located"})]})]})}),r.jsx("td",{className:"w-[200px] px-4 py-4",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-xs font-medium text-gray-900 flex items-start",children:[r.jsx(ir,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0 mt-0.5"}),r.jsx("span",{className:"break-words leading-tight",children:K.head_full_name||"Not assigned"})]}),r.jsx("div",{className:"text-[10px] text-gray-600 break-words leading-tight ml-4",children:K.position_title||"No title"})]})}),r.jsx("td",{className:"w-[120px] px-4 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",offset:[0,4],usePortal:!0,children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>M(K),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"View Details"]}),r.jsxs("button",{onClick:()=>D(K),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500 group-hover:text-green-600"}),"Edit Campus"]}),r.jsxs("button",{onClick:()=>A(K.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",role:"menuitem",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-700 group-hover:text-red-600"}),"Delete Campus"]})]})})})]},K.id)),c.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"5",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx($s,{className:"w-10 h-10 text-gray-400"})}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:P||W!=="ALL"?"No matching campuses found":"No Campuses Found"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:P||W!=="ALL"?"Try adjusting your search terms or filters.":"This institution has no campuses registered yet."}),!P&&W==="ALL"&&r.jsxs("button",{onClick:S,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add First Campus"]})]})})})]})})})]}),r.jsx(Y6,{isOpen:f,onClose:I,campusData:p}),r.jsx(W6,{isOpen:b,onClose:j,onSave:w,institutionId:t,loading:E}),r.jsx(X6,{isOpen:_,onClose:C,onSave:T,campusData:p,loading:F})]})})}const FV=[{code:"10",label:"TEACHER, MASTER TEACHER"},{code:"20",label:"INSTRUCTOR"},{code:"30",label:"ASSISTANT PROFESSOR"},{code:"40",label:"ASSOCIATE PROFESSOR"},{code:"50",label:"FULL PROFESSOR (including UNIVERSITY PROFESSOR)"},{code:"09",label:"TEACHING FELLOW OR TEACHING ASSOCIATE"},{code:"11",label:"LECTURER, SENIOR LECTURER, PROFESSORIAL LECTURER"},{code:"12",label:"PROFESSOR EMERITUS"},{code:"13",label:"VISITING PROFESSOR (WHATEVER THE ACTUAL RANK)"},{code:"14",label:"ADJUNCT OR AFFILIATE FACULTY"},{code:"90",label:"OTHERS"}],IV=[{code:"000",label:"No formal education at all"},{code:"101",label:"Partial elementary schooling but did not complete Grade 4"},{code:"102",label:"Completed Grade 4 but did not graduate from elementary school"},{code:"103",label:"Completed Elementary School"},{code:"201",label:"Partial completion of High School"},{code:"202",label:"Secondary school graduate or equivalent"},{code:"301",label:"Partial completion of High School"},{code:"302",label:"Completed Tech/Voc"},{code:"401",label:"Partial completion of pre-baccalaureate certificate, diploma or associateship"},{code:"402",label:"Completed pre-bacc certificate, diploma or associateship"},{code:"501",label:"Completed Year 1 of baccalaureate level or equivalent"},{code:"502",label:"Completed Year 2 of baccalaureate level or equivalent"},{code:"503",label:"Completed Year 3 of baccalaureate level or equivalent"},{code:"504",label:"Completed Year 4 of baccalaureate level or equivalent"},{code:"505",label:"Completed Year 5 of baccalaureate level or equivalent"},{code:"506",label:"Completed Year 6 of baccalaureate level or equivalent"},{code:"507",label:"Completed a baccalaureate degree (including DVM, DDM, D Opt)"},{code:"601",label:"Partial Completion of postgraduate certificate or diploma program"},{code:"602",label:"Completed post-grad certificate or diploma program"},{code:"701",label:"Completed Year 1 of MD or LLB (or equivalent)"},{code:"702",label:"Completed Year 2 of MD or LLB (or equivalent)"},{code:"703",label:"Completed Year 3 of MD or LLB (or equivalent)"},{code:"704",label:"Completed Year 4 of MD or LLB (or equivalent)"},{code:"705",label:"Completed MD or LLB (or equivalent)"},{code:"801",label:"Partial completion of masters degree"},{code:"802",label:"Completed all masters requirements except masters thesis"},{code:"803",label:"Completed masters degree or equivalent"},{code:"901",label:"Partial completion of doctorate degree"},{code:"902",label:"Completed all doctorate requirements except dissertation"},{code:"903",label:"Completed doctorate degree"},{code:"980",label:"NOT A FACULTY MEMBER"},{code:"999",label:"No record"}],LV=[{code:"1",label:"Male"},{code:"2",label:"Female"}],PV=[{code:"1",label:"Faculty member is tenured"},{code:"2",label:"Faculty member has his own plantilla item but is NOT TENURED"},{code:"3",label:"Faculty member has no plantilla item"},{code:"4",label:"No information on the matter"}],BV=[{code:"1",label:"Salary Grade 1 - 33"},{code:"90",label:"No salary grade to speak of (part-time, lecturer, emeritus, adjunct)"},{code:"99",label:"No information on the matter"}],DV=[{code:"1",label:"FTEF = 1.00"},{code:"2",label:"FTEF = 0.50"},{code:"3",label:"FTEF = 0.250"}],UV=[{code:"1",label:"Faculty has already completed doctorate degree in the field where he is teaching"},{code:"2",label:"Masters degree holder with some PhD units actively pursuing doctorate degree"},{code:"3",label:"Masters degree holder with some PhD units but no longer actively pursuing PhD"},{code:"4",label:"Masters degree holder with no PhD units in the discipline where he is teaching"},{code:"5",label:"Bachelors degree holder with some masters units actively pursuing masters degree"},{code:"6",label:"Bachelors degree holder with some masters units but no longer in active pursuit"},{code:"7",label:"Bachelors degree holder with no masters units in the discipline where he is teaching"},{code:"8",label:"Not a faculty member"},{code:"9",label:"No information on the matter"}],$V=[{code:"1",label:"YES. IN OBTAINING MASTERS DEGREE, THE FACULTY MEMBER WROTE A THESIS"},{code:"2",label:"NO. IN OBTAINING HIS MASTERS, FACULTY MEMBER DID NOT WRITE A THESIS"},{code:"3",label:"NO INFORMATION ON THE MATTER"}],zV=[{code:"1",label:"YES. IN OBTAINING DOCTORATE, THE FACULTY MEMBER WROTE A DISSERTATION"},{code:"2",label:"NO. IN OBTAINING DOCTORATE, FACULTY MEMBER DID NOT WRITE DISSERTATION"},{code:"3",label:"NO INFORMATION ON THE MATTER"}],HV=[{code:"A1",label:"GROUP A1: FULL-TIME FACULTY MEMBERS WITH THEIR OWN FACULTY PLANTILLA ITEMS TEACHING AT ELEM, SECONDARY AND TECH/VOC"},{code:"B",label:"GROUP B: FULL-TIME FACULTY MEMBERS WITH NO PS ITEMS BUT DRAWING SALARIES FROM THE PS ITEMS OF FACULTY ON LEAVE WITHOUT PAY"},{code:"C1",label:"GROUP C1: FULL-TIME FACULTY MEMBERS WITH NO PS ITEMS DRAWING SALARIES FROM GAA PS LUMP SUMS"},{code:"C2",label:"GROUP C2: FULL-TIME FACULTY MEMBERS WITH NO PS ITEMS DRAWING SALARIES FROM SUC INCOME"},{code:"C3",label:"GROUP C3: FULL-TIME FACULTY MEMBERS WITH NO PS ITEMS DRAWING SALARIES FROM LGU FUNDS"},{code:"E",label:"GROUP E: LECTURERS AND OTHER PART-TIME FACULTY WITH NO ITEMS TEACHING AT ELEMENTARY, SECONDARY OR TECH/VOC LEVELS"}];function K6({isOpen:t,onClose:s,facultyData:e}){if(!e)return null;const a=l=>l||"Not specified",n=(l,u)=>{if(!l)return"Not specified";const o=u.find(d=>d.code===l);return o?o.label:l},i=l=>{switch(l==null?void 0:l.toLowerCase()){case"doctorate":case"phd":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800";case"masters":case"master":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800";case"bachelors":case"bachelor":return"bg-gradient-to-r from-green-100 to-green-200 text-green-800";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800"}},c=l=>l?`${l} hours`:"Not specified";return r.jsx(mr,{isOpen:t,onClose:s,title:e.faculty_name,subtitle:"Faculty Details & Information",icon:ir,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Personal Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-blue-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:n(e.gender,LV)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tenure Status"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-blue-100",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e.is_tenured==="1"?"bg-gradient-to-r from-green-100 to-green-200 text-green-800":"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800"}`,children:n(e.is_tenured,PV)})})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty Type"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-blue-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:n(e.faculty_type,HV)})})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(Zr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Position & Rank"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty Rank"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:n(e.generic_faculty_rank,FV)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salary Grade"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:n(e.ssl_salary_grade,BV)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full-Time Equivalent"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-emerald-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:n(e.full_time_equivalent,DV)})})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Academic Home"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Home College"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-purple-100",children:r.jsx("p",{className:"text-gray-900 font-medium break-words",children:a(e.home_college)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Home Department"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-purple-100",children:r.jsx("p",{className:"text-gray-900 font-medium break-words",children:a(e.home_dept)})})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Educational Background"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Highest Degree"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-amber-100",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${i(e.highest_degree_attained)}`,children:n(e.highest_degree_attained,IV)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pursuing Next Degree"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-amber-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:n(e.actively_pursuing_next_degree,UV)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Masters Thesis Status"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-amber-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:n(e.masters_with_thesis,$V)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Doctorate Dissertation Status"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-amber-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:n(e.doctorate_with_dissertation,zV)})})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 via-sky-50 to-blue-100 rounded-xl p-4 border border-cyan-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-cyan-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Teaching Load"})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Elementary/Secondary Teaching Load"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab Hours"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-cyan-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.lab_hours_elem_sec)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lecture Hours"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-cyan-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.lecture_hours_elem_sec)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Teaching Hours"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-cyan-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.total_teaching_hours_elem_sec)})})]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Technical/Vocational Teaching Load"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab Hours"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-cyan-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.lab_hours_tech_voc)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lecture Hours"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-cyan-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.lecture_hours_tech_voc)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Teaching Hours"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-cyan-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.total_teaching_hours_tech_voc)})})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(Xa,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Official Load Distribution"})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Research Load"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.official_research_load)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Extension Services"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.official_extension_services_load)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Study Load"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.official_study_load)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Production Load"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.official_load_for_production)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Administrative Load"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.official_administrative_load)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other Official Load"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.other_official_load_credits)})})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-green-50 via-emerald-50 to-teal-100 rounded-xl p-4 border border-green-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-green-500 rounded-lg shadow-sm",children:r.jsx(bn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Total Work Load"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Work Load (Hours)"}),r.jsx("div",{className:"bg-white/70 rounded-lg p-3 border border-green-100",children:r.jsx("p",{className:"text-gray-900 font-medium",children:c(e.total_work_load)})})]})})]})]})})}K6.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,facultyData:B.shape({id:B.oneOfType([B.string,B.number]),faculty_name:B.string,generic_faculty_rank:B.string,home_college:B.string,home_dept:B.string,is_tenured:B.string,ssl_salary_grade:B.string,annual_basic_salary:B.oneOfType([B.string,B.number]),on_leave_without_pay:B.string,full_time_equivalent:B.oneOfType([B.string,B.number]),gender:B.string,highest_degree_attained:B.string,actively_pursuing_next_degree:B.string,primary_teaching_load_discipline_1:B.string,primary_teaching_load_discipline_2:B.string,bachelors_discipline:B.string,masters_discipline:B.string,doctorate_discipline:B.string,masters_with_thesis:B.string,doctorate_with_dissertation:B.string,lab_hours_elem_sec:B.oneOfType([B.string,B.number]),lecture_hours_elem_sec:B.oneOfType([B.string,B.number]),total_teaching_hours_elem_sec:B.oneOfType([B.string,B.number]),student_lab_contact_hours_elem_sec:B.oneOfType([B.string,B.number]),student_lecture_contact_hours_elem_sec:B.oneOfType([B.string,B.number]),total_student_contact_hours_elem_sec:B.oneOfType([B.string,B.number]),lab_hours_tech_voc:B.oneOfType([B.string,B.number]),lecture_hours_tech_voc:B.oneOfType([B.string,B.number]),total_teaching_hours_tech_voc:B.oneOfType([B.string,B.number]),student_lab_contact_hours_tech_voc:B.oneOfType([B.string,B.number]),student_lecture_contact_hours_tech_voc:B.oneOfType([B.string,B.number]),total_student_contact_hours_tech_voc:B.oneOfType([B.string,B.number]),official_research_load:B.oneOfType([B.string,B.number]),official_extension_services_load:B.oneOfType([B.string,B.number]),official_study_load:B.oneOfType([B.string,B.number]),official_load_for_production:B.oneOfType([B.string,B.number]),official_administrative_load:B.oneOfType([B.string,B.number]),other_official_load_credits:B.oneOfType([B.string,B.number]),total_work_load:B.oneOfType([B.string,B.number]),faculty_type:B.string})};const Wx={10:"Master Teacher",20:"Instructor",30:"Asst. Prof.",40:"Assoc. Prof.",50:"Full Prof.",9:"Teaching Fellow",11:"Lecturer",12:"Prof. Emeritus",13:"Visiting Prof.",14:"Adjunct Faculty",90:"Others"},Xx={1:"Tenured",2:"Not Tenured (Has Plantilla)",3:"No Plantilla",4:"No Info"},Kx={1:"Grade 1-33",90:"No Grade (Part-time)",99:"No Info"},Zx={1:"Below 60k",2:"60k-69,999",3:"70k-79,999",4:"80k-89,999",5:"90k-99,999",6:"100k-149,999",7:"150k-249,999",8:"250k-499,999",9:"500k+",99:"No Info"},Qx={1:"On Leave (No Pay)",2:"Active/On Leave (With Pay)",3:"No Info"},Z6={1:"Full Time (1.00)",2:"Half Time (0.50)",3:"Quarter Time (0.25)"},Jx={1:"Male",2:"Female"},R0={0:"None",101:"Partial Elem.",102:"Grade 4 Only",103:"Elem. Grad.",201:"Partial HS",202:"HS Grad.",301:"Partial HS",302:"Tech/Voc Grad.",401:"Partial Pre-bacc.",402:"Pre-bacc Grad.",501:"1st Yr College",502:"2nd Yr College",503:"3rd Yr College",504:"4th Yr College",505:"5th Yr College",506:"6th Yr College",507:"Bachelor's",601:"Partial Post-grad Cert.",602:"Post-grad Cert.",701:"1st Yr MD/LLB",702:"2nd Yr MD/LLB",703:"3rd Yr MD/LLB",704:"4th Yr MD/LLB",705:"MD/LLB Grad.",801:"Partial Master's",802:"Master's (No Thesis)",803:"Master's",901:"Partial Doctorate",902:"Doctorate (No Diss.)",903:"Doctorate",980:"Not Faculty",999:"No Record"},Q6={1:"Completed Doctorate",2:"Pursuing Doctorate",3:"Stopped Doctorate",4:"Master's Only",5:"Pursuing Master's",6:"Stopped Master's",7:"Bachelor's Only",8:"Not Faculty",9:"No Info"},J6={1:"With Thesis",2:"No Thesis",3:"No Info"},eN={1:"With Dissertation",2:"No Dissertation",3:"No Info"},M0=[{code:"A1",label:" A1 - Full-time with Plantilla (Elem/Sec/Tech)"},{code:"B",label:" B - Full-time (Salary from Leave)"},{code:"C1",label:" C1 - Full-time (GAA PS Lump Sum)"},{code:"C2",label:"C2 - Full-time (SUC Income)"},{code:"C3",label:"C3 - Full-time (LGU Funds)"},{code:"E",label:"E - Part-time Lecturer"}],vn=t=>Object.entries(t).map(([s,e])=>({code:String(s),label:e})),VV=vn(Wx),qV=vn(R0),GV=vn(Q6),YV=vn(J6),WV=vn(eN),XV=vn(Xx),KV=vn(Kx),ZV=vn(Zx),QV=vn(Qx),JV=vn(Z6),eq=vn(Jx),cw=["lab_hours_elem_sec","lecture_hours_elem_sec","total_teaching_hours_elem_sec","student_lab_contact_hours_elem_sec","student_lecture_contact_hours_elem_sec","total_student_contact_hours_elem_sec","lab_hours_tech_voc","lecture_hours_tech_voc","total_teaching_hours_tech_voc","student_lab_contact_hours_tech_voc","student_lecture_contact_hours_tech_voc","total_student_contact_hours_tech_voc","official_research_load","official_extension_services_load","official_study_load","official_load_for_production","official_administrative_load","other_official_load_credits","total_work_load"];function tN({isOpen:t,onClose:s,onSave:e,institutionId:a,loading:n=!1}){const[i,c]=ne.useState({suc_details_id:a||"",faculty_name:"",generic_faculty_rank:"",home_college:"",home_dept:"",is_tenured:"",ssl_salary_grade:"",annual_basic_salary:"",on_leave_without_pay:"",full_time_equivalent:"",gender:"",highest_degree_attained:"",actively_pursuing_next_degree:"",primary_teaching_load_discipline_1:"",primary_teaching_load_discipline_2:"",bachelors_discipline:"",masters_discipline:"",doctorate_discipline:"",masters_with_thesis:"",doctorate_with_dissertation:"",lab_hours_elem_sec:"",lecture_hours_elem_sec:"",total_teaching_hours_elem_sec:"",student_lab_contact_hours_elem_sec:"",student_lecture_contact_hours_elem_sec:"",total_student_contact_hours_elem_sec:"",lab_hours_tech_voc:"",lecture_hours_tech_voc:"",total_teaching_hours_tech_voc:"",student_lab_contact_hours_tech_voc:"",student_lecture_contact_hours_tech_voc:"",total_student_contact_hours_tech_voc:"",official_research_load:"",official_extension_services_load:"",official_study_load:"",official_load_for_production:"",official_administrative_load:"",other_official_load_credits:"",total_work_load:"",faculty_type:""}),[l,u]=ne.useState({}),o=(f,x)=>{if(c(b=>({...b,[f]:x})),l[f]&&u(b=>({...b,[f]:""})),f==="lab_hours_elem_sec"||f==="lecture_hours_elem_sec"){const b=f==="lab_hours_elem_sec"?parseFloat(x)||0:parseFloat(i.lab_hours_elem_sec)||0,v=f==="lecture_hours_elem_sec"?parseFloat(x)||0:parseFloat(i.lecture_hours_elem_sec)||0;c(_=>({..._,[f]:x,total_teaching_hours_elem_sec:b+v}))}if(f==="student_lab_contact_hours_elem_sec"||f==="student_lecture_contact_hours_elem_sec"){const b=f==="student_lab_contact_hours_elem_sec"?parseFloat(x)||0:parseFloat(i.student_lab_contact_hours_elem_sec)||0,v=f==="student_lecture_contact_hours_elem_sec"?parseFloat(x)||0:parseFloat(i.student_lecture_contact_hours_elem_sec)||0;c(_=>({..._,[f]:x,total_student_contact_hours_elem_sec:b+v}))}if(f==="lab_hours_tech_voc"||f==="lecture_hours_tech_voc"){const b=f==="lab_hours_tech_voc"?parseFloat(x)||0:parseFloat(i.lab_hours_tech_voc)||0,v=f==="lecture_hours_tech_voc"?parseFloat(x)||0:parseFloat(i.lecture_hours_tech_voc)||0;c(_=>({..._,[f]:x,total_teaching_hours_tech_voc:b+v}))}if(f==="student_lab_contact_hours_tech_voc"||f==="student_lecture_contact_hours_tech_voc"){const b=f==="student_lab_contact_hours_tech_voc"?parseFloat(x)||0:parseFloat(i.student_lab_contact_hours_tech_voc)||0,v=f==="student_lecture_contact_hours_tech_voc"?parseFloat(x)||0:parseFloat(i.student_lecture_contact_hours_tech_voc)||0;c(_=>({..._,[f]:x,total_student_contact_hours_tech_voc:b+v}))}(f.includes("official_")||f.includes("_load"))&&d({...i,[f]:x})},d=f=>{const b=["official_research_load","official_extension_services_load","official_study_load","official_load_for_production","official_administrative_load","other_official_load_credits"].reduce((v,_)=>v+(parseFloat(f[_])||0),0);c(v=>({...v,total_work_load:b}))},g=()=>{const f={};return i.faculty_name.trim()||(f.faculty_name="Faculty name is required"),i.suc_details_id||(f.suc_details_id="Institution ID is required"),i.annual_basic_salary&&(isNaN(i.annual_basic_salary)||i.annual_basic_salary<0)&&(f.annual_basic_salary="Annual salary must be a positive number"),i.full_time_equivalent&&(isNaN(i.full_time_equivalent)||i.full_time_equivalent<0)&&(f.full_time_equivalent="FTE must be a positive number"),i.faculty_name&&i.faculty_name.length>255&&(f.faculty_name="Faculty name must not exceed 255 characters"),i.generic_faculty_rank&&i.generic_faculty_rank.length>255&&(f.generic_faculty_rank="Faculty rank must not exceed 255 characters"),i.home_college&&i.home_college.length>255&&(f.home_college="Home college must not exceed 255 characters"),i.home_dept&&i.home_dept.length>255&&(f.home_dept="Home department must not exceed 255 characters"),i.gender&&i.gender.length>10&&(f.gender="Gender must not exceed 10 characters"),i.highest_degree_attained&&i.highest_degree_attained.length>255&&(f.highest_degree_attained="Highest degree must not exceed 255 characters"),cw.forEach(x=>{i[x]&&(isNaN(i[x])||i[x]<0)&&(f[x]="Hours must be a positive number")}),u(f),Object.keys(f).length===0},p=()=>{if(g()){const f={...i,suc_details_id:a?String(a):"",annual_basic_salary:i.annual_basic_salary?String(i.annual_basic_salary):"",full_time_equivalent:i.full_time_equivalent?String(i.full_time_equivalent):"",...Object.fromEntries(cw.map(x=>[x,i[x]?String(i[x]):""]))};e(f)}},h=()=>{c({suc_details_id:a||"",faculty_name:"",generic_faculty_rank:"",home_college:"",home_dept:"",is_tenured:"",ssl_salary_grade:"",annual_basic_salary:"",on_leave_without_pay:"",full_time_equivalent:"",gender:"",highest_degree_attained:"",actively_pursuing_next_degree:"",primary_teaching_load_discipline_1:"",primary_teaching_load_discipline_2:"",bachelors_discipline:"",masters_discipline:"",doctorate_discipline:"",masters_with_thesis:"",doctorate_with_dissertation:"",lab_hours_elem_sec:"",lecture_hours_elem_sec:"",total_teaching_hours_elem_sec:"",student_lab_contact_hours_elem_sec:"",student_lecture_contact_hours_elem_sec:"",total_student_contact_hours_elem_sec:"",lab_hours_tech_voc:"",lecture_hours_tech_voc:"",total_teaching_hours_tech_voc:"",student_lab_contact_hours_tech_voc:"",student_lecture_contact_hours_tech_voc:"",total_student_contact_hours_tech_voc:"",official_research_load:"",official_extension_services_load:"",official_study_load:"",official_load_for_production:"",official_administrative_load:"",other_official_load_credits:"",total_work_load:"",faculty_type:""}),u({}),s()};return r.jsx(mr,{isOpen:t,onClose:h,title:"Add New Faculty Member",subtitle:"Create a new faculty record for the institution",icon:Er,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-2 max-h-[600px] overflow-y-auto p-2",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-lg p-2 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Basic Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Name"}),r.jsx("input",{type:"text",value:i.faculty_name,onChange:f=>o("faculty_name",f.target.value),placeholder:"Enter name",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Faculty Name"}),l.faculty_name&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.faculty_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Gender"}),r.jsxs("select",{value:i.gender,onChange:f=>o("gender",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Gender",children:[r.jsx("option",{value:"",children:"Select Gender"}),eq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Faculty Type"}),r.jsxs("select",{value:i.faculty_type,onChange:f=>o("faculty_type",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Faculty Type",children:[r.jsx("option",{value:"",children:"Select Type"}),M0.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-lg p-2 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Academic Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Rank"}),r.jsxs("select",{value:i.generic_faculty_rank,onChange:f=>o("generic_faculty_rank",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Faculty Rank",children:[r.jsx("option",{value:"",children:"Select Rank"}),VV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"College"}),r.jsx("input",{type:"text",value:i.home_college,onChange:f=>o("home_college",f.target.value),placeholder:"Enter college",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Home College"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Department"}),r.jsx("input",{type:"text",value:i.home_dept,onChange:f=>o("home_dept",f.target.value),placeholder:"Enter department",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Home Department"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Tenure"}),r.jsxs("select",{value:i.is_tenured,onChange:f=>o("is_tenured",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Tenure Status",children:[r.jsx("option",{value:"",children:"Select Status"}),XV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Highest Degree"}),r.jsxs("select",{value:i.highest_degree_attained,onChange:f=>o("highest_degree_attained",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Highest Degree Attained",children:[r.jsx("option",{value:"",children:"Select Degree"}),qV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Degree Progress"}),r.jsxs("select",{value:i.actively_pursuing_next_degree,onChange:f=>o("actively_pursuing_next_degree",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Pursuing Next Degree",children:[r.jsx("option",{value:"",children:"Select Status"}),GV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Bachelor's Discipline"}),r.jsx("input",{type:"text",value:i.bachelors_discipline,onChange:f=>o("bachelors_discipline",f.target.value),placeholder:"Enter discipline",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Bachelor's Discipline"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Master's Discipline"}),r.jsx("input",{type:"text",value:i.masters_discipline,onChange:f=>o("masters_discipline",f.target.value),placeholder:"Enter discipline",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Master's Discipline"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Doctorate Discipline"}),r.jsx("input",{type:"text",value:i.doctorate_discipline,onChange:f=>o("doctorate_discipline",f.target.value),placeholder:"Enter discipline",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Doctorate Discipline"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Master's Thesis"}),r.jsxs("select",{value:i.masters_with_thesis,onChange:f=>o("masters_with_thesis",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Masters Thesis Status",children:[r.jsx("option",{value:"",children:"Select Status"}),YV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Doctorate Dissertation"}),r.jsxs("select",{value:i.doctorate_with_dissertation,onChange:f=>o("doctorate_with_dissertation",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Doctorate Dissertation Status",children:[r.jsx("option",{value:"",children:"Select Status"}),WV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-green-50 via-green-50 to-emerald-100 rounded-lg p-2 border border-green-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-green-500 rounded-lg shadow-sm",children:r.jsx(bn,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Employment Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Salary Grade"}),r.jsxs("select",{value:i.ssl_salary_grade,onChange:f=>o("ssl_salary_grade",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500 transition-colors duration-200","aria-label":"Salary Grade",children:[r.jsx("option",{value:"",children:"Select Grade"}),KV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Salary Range"}),r.jsxs("select",{value:i.annual_basic_salary,onChange:f=>o("annual_basic_salary",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500 transition-colors duration-200","aria-label":"Annual Basic Salary",children:[r.jsx("option",{value:"",children:"Select Range"}),ZV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]}),l.annual_basic_salary&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.annual_basic_salary})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Work Status"}),r.jsxs("select",{value:i.full_time_equivalent,onChange:f=>o("full_time_equivalent",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500 transition-colors duration-200","aria-label":"Full Time Equivalent",children:[r.jsx("option",{value:"",children:"Select Status"}),JV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]}),l.full_time_equivalent&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.full_time_equivalent})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Leave Status"}),r.jsxs("select",{value:i.on_leave_without_pay,onChange:f=>o("on_leave_without_pay",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500 transition-colors duration-200","aria-label":"Leave Status",children:[r.jsx("option",{value:"",children:"Select Status"}),QV.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-purple-100 rounded-lg p-2 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-indigo-500 rounded-lg shadow-sm",children:r.jsx(r0,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Teaching Fields"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Primary Field 1"}),r.jsx("input",{type:"text",value:i.primary_teaching_load_discipline_1,onChange:f=>o("primary_teaching_load_discipline_1",f.target.value),placeholder:"Enter field",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200","aria-label":"Primary Teaching Load Discipline 1"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Primary Field 2"}),r.jsx("input",{type:"text",value:i.primary_teaching_load_discipline_2,onChange:f=>o("primary_teaching_load_discipline_2",f.target.value),placeholder:"Enter field",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200","aria-label":"Primary Teaching Load Discipline 2"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2",children:[r.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 via-sky-50 to-blue-100 rounded-lg p-2 border border-cyan-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-cyan-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Elementary/Secondary"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Teaching Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.lab_hours_elem_sec,onChange:f=>o("lab_hours_elem_sec",f.target.value),placeholder:"Lab",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 transition-colors duration-200","aria-label":"Lab Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"}),l.lab_hours_elem_sec&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.lab_hours_elem_sec})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.lecture_hours_elem_sec,onChange:f=>o("lecture_hours_elem_sec",f.target.value),placeholder:"Lecture",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 transition-colors duration-200","aria-label":"Lecture Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"}),l.lecture_hours_elem_sec&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.lecture_hours_elem_sec})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",value:i.total_teaching_hours_elem_sec,className:"w-full px-2 py-1 text-sm border border-cyan-300 rounded bg-cyan-50",readOnly:!0,"aria-label":"Total Teaching Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-cyan-600",children:"Total"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.student_lab_contact_hours_elem_sec,onChange:f=>o("student_lab_contact_hours_elem_sec",f.target.value),placeholder:"Lab",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 transition-colors duration-200","aria-label":"Student Lab Contact Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"}),l.student_lab_contact_hours_elem_sec&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.student_lab_contact_hours_elem_sec})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.student_lecture_contact_hours_elem_sec,onChange:f=>o("student_lecture_contact_hours_elem_sec",f.target.value),placeholder:"Lecture",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 transition-colors duration-200","aria-label":"Student Lecture Contact Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"}),l.student_lecture_contact_hours_elem_sec&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.student_lecture_contact_hours_elem_sec})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",value:i.total_student_contact_hours_elem_sec,className:"w-full px-2 py-1 text-sm border border-cyan-300 rounded bg-cyan-50",readOnly:!0,"aria-label":"Total Student Contact Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-cyan-600",children:"Total"})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-teal-50 via-emerald-50 to-green-100 rounded-lg p-2 border border-teal-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-teal-500 rounded-lg shadow-sm",children:r.jsx(r0,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Technical/Vocational"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Teaching Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.lab_hours_tech_voc,onChange:f=>o("lab_hours_tech_voc",f.target.value),placeholder:"Lab",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200","aria-label":"Lab Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"}),l.lab_hours_tech_voc&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.lab_hours_tech_voc})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.lecture_hours_tech_voc,onChange:f=>o("lecture_hours_tech_voc",f.target.value),placeholder:"Lecture",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200","aria-label":"Lecture Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"}),l.lecture_hours_tech_voc&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.lecture_hours_tech_voc})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",value:i.total_teaching_hours_tech_voc,className:"w-full px-2 py-1 text-sm border border-teal-300 rounded bg-teal-50",readOnly:!0,"aria-label":"Total Teaching Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-teal-600",children:"Total"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.student_lab_contact_hours_tech_voc,onChange:f=>o("student_lab_contact_hours_tech_voc",f.target.value),placeholder:"Lab",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200","aria-label":"Student Lab Contact Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"}),l.student_lab_contact_hours_tech_voc&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.student_lab_contact_hours_tech_voc})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.student_lecture_contact_hours_tech_voc,onChange:f=>o("student_lecture_contact_hours_tech_voc",f.target.value),placeholder:"Lecture",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200","aria-label":"Student Lecture Contact Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"}),l.student_lecture_contact_hours_tech_voc&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.student_lecture_contact_hours_tech_voc})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",value:i.total_student_contact_hours_tech_voc,className:"w-full px-2 py-1 text-sm border border-teal-300 rounded bg-teal-50",readOnly:!0,"aria-label":"Total Student Contact Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-teal-600",children:"Total"})]})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-lg p-2 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(Xa,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Work Load"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Research"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_research_load,onChange:f=>o("official_research_load",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Research Load"}),l.official_research_load&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_research_load})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Extension"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_extension_services_load,onChange:f=>o("official_extension_services_load",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Extension Services Load"}),l.official_extension_services_load&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_extension_services_load})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Study"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_study_load,onChange:f=>o("official_study_load",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Study Load"}),l.official_study_load&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_study_load})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Production"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_load_for_production,onChange:f=>o("official_load_for_production",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Production Load"}),l.official_load_for_production&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_load_for_production})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Administrative"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_administrative_load,onChange:f=>o("official_administrative_load",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Administrative Load"}),l.official_administrative_load&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_administrative_load})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Other"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.other_official_load_credits,onChange:f=>o("other_official_load_credits",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Other Official Load"}),l.other_official_load_credits&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.other_official_load_credits})]})]}),r.jsx("div",{className:"bg-white/60 rounded-md p-2 border border-slate-300",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Total Hours:"}),r.jsx("div",{className:"text-sm font-bold text-slate-900",children:i.total_work_load||0})]})})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-2 border-t border-gray-200",children:[r.jsx("button",{onClick:h,disabled:n,className:"w-full sm:w-auto px-4 py-1.5 text-sm border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium","aria-label":"Cancel",children:"Cancel"}),r.jsx("button",{onClick:p,disabled:n,className:"w-full sm:w-auto px-4 py-1.5 text-sm bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-md hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-blue-500 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center","aria-label":"Create Faculty",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-1.5"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-3 h-3 mr-1.5"}),"Create Faculty"]})})]})]})})}tN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired,loading:B.bool};const _n=t=>Object.entries(t).map(([s,e])=>({code:String(s),label:e})),tq=_n(Wx),rq=_n(R0),sq=_n(Q6),aq=_n(J6),nq=_n(eN),iq=_n(Xx),oq=_n(Kx),lq=_n(Zx),cq=_n(Qx),uq=_n(Z6),dq=_n(Jx),uw=["lab_hours_elem_sec","lecture_hours_elem_sec","total_teaching_hours_elem_sec","student_lab_contact_hours_elem_sec","student_lecture_contact_hours_elem_sec","total_student_contact_hours_elem_sec","lab_hours_tech_voc","lecture_hours_tech_voc","total_teaching_hours_tech_voc","student_lab_contact_hours_tech_voc","student_lecture_contact_hours_tech_voc","total_student_contact_hours_tech_voc","official_research_load","official_extension_services_load","official_study_load","official_load_for_production","official_administrative_load","other_official_load_credits","total_work_load"];function rN({isOpen:t,onClose:s,onSave:e,facultyData:a,loading:n=!1}){const[i,c]=ne.useState({faculty_name:"",generic_faculty_rank:"",home_college:"",home_dept:"",is_tenured:"",ssl_salary_grade:"",annual_basic_salary:"",on_leave_without_pay:"",full_time_equivalent:"",gender:"",highest_degree_attained:"",actively_pursuing_next_degree:"",primary_teaching_load_discipline_1:"",primary_teaching_load_discipline_2:"",bachelors_discipline:"",masters_discipline:"",doctorate_discipline:"",masters_with_thesis:"",doctorate_with_dissertation:"",lab_hours_elem_sec:"",lecture_hours_elem_sec:"",total_teaching_hours_elem_sec:"",student_lab_contact_hours_elem_sec:"",student_lecture_contact_hours_elem_sec:"",total_student_contact_hours_elem_sec:"",lab_hours_tech_voc:"",lecture_hours_tech_voc:"",total_teaching_hours_tech_voc:"",student_lab_contact_hours_tech_voc:"",student_lecture_contact_hours_tech_voc:"",total_student_contact_hours_tech_voc:"",official_research_load:"",official_extension_services_load:"",official_study_load:"",official_load_for_production:"",official_administrative_load:"",other_official_load_credits:"",total_work_load:"",faculty_type:""}),[l,u]=ne.useState({});ne.useEffect(()=>{a&&(console.log("Initial faculty data:",a),c({faculty_name:a.faculty_name||"",generic_faculty_rank:a.generic_faculty_rank||"",home_college:a.home_college||"",home_dept:a.home_dept||"",is_tenured:a.is_tenured||"",ssl_salary_grade:a.ssl_salary_grade||"",annual_basic_salary:a.annual_basic_salary||"",on_leave_without_pay:a.on_leave_without_pay||"",full_time_equivalent:a.full_time_equivalent||"",gender:a.gender||"",highest_degree_attained:a.highest_degree_attained||"",actively_pursuing_next_degree:a.actively_pursuing_next_degree||"",primary_teaching_load_discipline_1:a.primary_teaching_load_discipline_1||"",primary_teaching_load_discipline_2:a.primary_teaching_load_discipline_2||"",bachelors_discipline:a.bachelors_discipline||"",masters_discipline:a.masters_discipline||"",doctorate_discipline:a.doctorate_discipline||"",masters_with_thesis:a.masters_with_thesis||"",doctorate_with_dissertation:a.doctorate_with_dissertation||"",lab_hours_elem_sec:a.lab_hours_elem_sec||"",lecture_hours_elem_sec:a.lecture_hours_elem_sec||"",total_teaching_hours_elem_sec:a.total_teaching_hours_elem_sec||"",student_lab_contact_hours_elem_sec:a.student_lab_contact_hours_elem_sec||"",student_lecture_contact_hours_elem_sec:a.student_lecture_contact_hours_elem_sec||"",total_student_contact_hours_elem_sec:a.total_student_contact_hours_elem_sec||"",lab_hours_tech_voc:a.lab_hours_tech_voc||"",lecture_hours_tech_voc:a.lecture_hours_tech_voc||"",total_teaching_hours_tech_voc:a.total_teaching_hours_tech_voc||"",student_lab_contact_hours_tech_voc:a.student_lab_contact_hours_tech_voc||"",student_lecture_contact_hours_tech_voc:a.student_lecture_contact_hours_tech_voc||"",total_student_contact_hours_tech_voc:a.total_student_contact_hours_tech_voc||"",official_research_load:a.official_research_load||"",official_extension_services_load:a.official_extension_services_load||"",official_study_load:a.official_study_load||"",official_load_for_production:a.official_load_for_production||"",official_administrative_load:a.official_administrative_load||"",other_official_load_credits:a.other_official_load_credits||"",total_work_load:a.total_work_load||"",faculty_type:a.faculty_type||""}),console.log("Form data after setting:",i))},[a]);const o=(f,x)=>{if(f==="faculty_type"&&console.log("Changing faculty_type to:",x),c(b=>{const v={...b,[f]:x};return f==="faculty_type"&&console.log("New form data after faculty_type change:",v),v}),l[f]&&u(b=>({...b,[f]:""})),f==="lab_hours_elem_sec"||f==="lecture_hours_elem_sec"){const b=f==="lab_hours_elem_sec"?parseFloat(x)||0:parseFloat(i.lab_hours_elem_sec)||0,v=f==="lecture_hours_elem_sec"?parseFloat(x)||0:parseFloat(i.lecture_hours_elem_sec)||0;c(_=>({..._,[f]:x,total_teaching_hours_elem_sec:b+v}))}if(f==="student_lab_contact_hours_elem_sec"||f==="student_lecture_contact_hours_elem_sec"){const b=f==="student_lab_contact_hours_elem_sec"?parseFloat(x)||0:parseFloat(i.student_lab_contact_hours_elem_sec)||0,v=f==="student_lecture_contact_hours_elem_sec"?parseFloat(x)||0:parseFloat(i.student_lecture_contact_hours_elem_sec)||0;c(_=>({..._,[f]:x,total_student_contact_hours_elem_sec:b+v}))}if(f==="lab_hours_tech_voc"||f==="lecture_hours_tech_voc"){const b=f==="lab_hours_tech_voc"?parseFloat(x)||0:parseFloat(i.lab_hours_tech_voc)||0,v=f==="lecture_hours_tech_voc"?parseFloat(x)||0:parseFloat(i.lecture_hours_tech_voc)||0;c(_=>({..._,[f]:x,total_teaching_hours_tech_voc:b+v}))}if(f==="student_lab_contact_hours_tech_voc"||f==="student_lecture_contact_hours_tech_voc"){const b=f==="student_lab_contact_hours_tech_voc"?parseFloat(x)||0:parseFloat(i.student_lab_contact_hours_tech_voc)||0,v=f==="student_lecture_contact_hours_tech_voc"?parseFloat(x)||0:parseFloat(i.student_lecture_contact_hours_tech_voc)||0;c(_=>({..._,[f]:x,total_student_contact_hours_tech_voc:b+v}))}(f.includes("official_")||f.includes("_load"))&&d({...i,[f]:x})},d=f=>{const b=["official_research_load","official_extension_services_load","official_study_load","official_load_for_production","official_administrative_load","other_official_load_credits"].reduce((v,_)=>v+(parseFloat(f[_])||0),0);c(v=>({...v,total_work_load:b}))},g=()=>{const f={};return i.faculty_name.trim()||(f.faculty_name="Faculty name is required"),i.faculty_name&&i.faculty_name.length>255&&(f.faculty_name="Faculty name must not exceed 255 characters"),i.generic_faculty_rank&&i.generic_faculty_rank.length>255&&(f.generic_faculty_rank="Faculty rank must not exceed 255 characters"),i.home_college&&i.home_college.length>255&&(f.home_college="Home college must not exceed 255 characters"),i.home_dept&&i.home_dept.length>255&&(f.home_dept="Home department must not exceed 255 characters"),i.gender&&i.gender.length>10&&(f.gender="Gender must not exceed 10 characters"),i.highest_degree_attained&&i.highest_degree_attained.length>255&&(f.highest_degree_attained="Highest degree must not exceed 255 characters"),uw.forEach(x=>{i[x]&&(isNaN(i[x])||i[x]<0)&&(f[x]="Hours must be a positive number")}),u(f),Object.keys(f).length===0},p=()=>{if(g()){const f=Object.fromEntries(uw.map(b=>[b,i[b]?parseFloat(i[b]):null])),x={...i,id:a.id,...f,faculty_type:i.faculty_type||null};console.log("Submitting faculty data:",x),e(x)}},h=()=>{c({faculty_name:"",generic_faculty_rank:"",home_college:"",home_dept:"",is_tenured:"",ssl_salary_grade:"",annual_basic_salary:"",on_leave_without_pay:"",full_time_equivalent:"",gender:"",highest_degree_attained:"",actively_pursuing_next_degree:"",primary_teaching_load_discipline_1:"",primary_teaching_load_discipline_2:"",bachelors_discipline:"",masters_discipline:"",doctorate_discipline:"",masters_with_thesis:"",doctorate_with_dissertation:"",lab_hours_elem_sec:"",lecture_hours_elem_sec:"",total_teaching_hours_elem_sec:"",student_lab_contact_hours_elem_sec:"",student_lecture_contact_hours_elem_sec:"",total_student_contact_hours_elem_sec:"",lab_hours_tech_voc:"",lecture_hours_tech_voc:"",total_teaching_hours_tech_voc:"",student_lab_contact_hours_tech_voc:"",student_lecture_contact_hours_tech_voc:"",total_student_contact_hours_tech_voc:"",official_research_load:"",official_extension_services_load:"",official_study_load:"",official_load_for_production:"",official_administrative_load:"",other_official_load_credits:"",total_work_load:"",faculty_type:""}),u({}),s()};return r.jsx(mr,{isOpen:t,onClose:h,title:"Edit Faculty Member",subtitle:"Update faculty information and details",icon:Dr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-2 max-h-[600px] overflow-y-auto p-2",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-lg p-2 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Basic Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Name"}),r.jsx("input",{type:"text",value:i.faculty_name,onChange:f=>o("faculty_name",f.target.value),placeholder:"Enter name",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Faculty Name"}),l.faculty_name&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.faculty_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Gender"}),r.jsxs("select",{value:i.gender,onChange:f=>o("gender",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Gender",children:[r.jsx("option",{value:"",children:"Select Gender"}),dq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Faculty Type"}),r.jsxs("select",{value:i.faculty_type,onChange:f=>o("faculty_type",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Faculty Type",children:[r.jsx("option",{value:"",children:"Select Type"}),M0.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-lg p-2 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Academic Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Rank"}),r.jsxs("select",{value:i.generic_faculty_rank,onChange:f=>o("generic_faculty_rank",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Faculty Rank",children:[r.jsx("option",{value:"",children:"Select Rank"}),tq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"College"}),r.jsx("input",{type:"text",value:i.home_college,onChange:f=>o("home_college",f.target.value),placeholder:"Enter college",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Home College"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Department"}),r.jsx("input",{type:"text",value:i.home_dept,onChange:f=>o("home_dept",f.target.value),placeholder:"Enter department",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Home Department"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Tenure"}),r.jsxs("select",{value:i.is_tenured,onChange:f=>o("is_tenured",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Tenure Status",children:[r.jsx("option",{value:"",children:"Select Status"}),iq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Highest Degree"}),r.jsxs("select",{value:i.highest_degree_attained,onChange:f=>o("highest_degree_attained",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Highest Degree Attained",children:[r.jsx("option",{value:"",children:"Select Degree"}),rq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Degree Progress"}),r.jsxs("select",{value:i.actively_pursuing_next_degree,onChange:f=>o("actively_pursuing_next_degree",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Pursuing Next Degree",children:[r.jsx("option",{value:"",children:"Select Status"}),sq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Bachelor's Discipline"}),r.jsx("input",{type:"text",value:i.bachelors_discipline,onChange:f=>o("bachelors_discipline",f.target.value),placeholder:"Enter discipline",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Bachelor's Discipline"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Master's Discipline"}),r.jsx("input",{type:"text",value:i.masters_discipline,onChange:f=>o("masters_discipline",f.target.value),placeholder:"Enter discipline",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Master's Discipline"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Doctorate Discipline"}),r.jsx("input",{type:"text",value:i.doctorate_discipline,onChange:f=>o("doctorate_discipline",f.target.value),placeholder:"Enter discipline",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Doctorate Discipline"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Master's Thesis"}),r.jsxs("select",{value:i.masters_with_thesis,onChange:f=>o("masters_with_thesis",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Masters Thesis Status",children:[r.jsx("option",{value:"",children:"Select Status"}),aq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Doctorate Dissertation"}),r.jsxs("select",{value:i.doctorate_with_dissertation,onChange:f=>o("doctorate_with_dissertation",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200","aria-label":"Doctorate Dissertation Status",children:[r.jsx("option",{value:"",children:"Select Status"}),nq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-green-50 via-green-50 to-emerald-100 rounded-lg p-2 border border-green-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-green-500 rounded-lg shadow-sm",children:r.jsx(bn,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Employment Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Salary Grade"}),r.jsxs("select",{value:i.ssl_salary_grade,onChange:f=>o("ssl_salary_grade",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500 transition-colors duration-200","aria-label":"Salary Grade",children:[r.jsx("option",{value:"",children:"Select Grade"}),oq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Salary Range"}),r.jsxs("select",{value:i.annual_basic_salary,onChange:f=>o("annual_basic_salary",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500 transition-colors duration-200","aria-label":"Annual Basic Salary",children:[r.jsx("option",{value:"",children:"Select Range"}),lq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]}),l.annual_basic_salary&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.annual_basic_salary})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Work Status"}),r.jsxs("select",{value:i.full_time_equivalent,onChange:f=>o("full_time_equivalent",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500 transition-colors duration-200","aria-label":"Full Time Equivalent",children:[r.jsx("option",{value:"",children:"Select Status"}),uq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]}),l.full_time_equivalent&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.full_time_equivalent})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Leave Status"}),r.jsxs("select",{value:i.on_leave_without_pay,onChange:f=>o("on_leave_without_pay",f.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500 transition-colors duration-200","aria-label":"Leave Status",children:[r.jsx("option",{value:"",children:"Select Status"}),cq.map(f=>r.jsx("option",{value:f.code,children:f.label},f.code))]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-purple-100 rounded-lg p-2 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-indigo-500 rounded-lg shadow-sm",children:r.jsx(r0,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Teaching Fields"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Primary Field 1"}),r.jsx("input",{type:"text",value:i.primary_teaching_load_discipline_1,onChange:f=>o("primary_teaching_load_discipline_1",f.target.value),placeholder:"Enter field",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200","aria-label":"Primary Teaching Load Discipline 1"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Primary Field 2"}),r.jsx("input",{type:"text",value:i.primary_teaching_load_discipline_2,onChange:f=>o("primary_teaching_load_discipline_2",f.target.value),placeholder:"Enter field",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200","aria-label":"Primary Teaching Load Discipline 2"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2",children:[r.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 via-sky-50 to-blue-100 rounded-lg p-2 border border-cyan-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-cyan-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Elementary/Secondary"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Teaching Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.lab_hours_elem_sec,onChange:f=>o("lab_hours_elem_sec",f.target.value),placeholder:"Lab",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 transition-colors duration-200","aria-label":"Lab Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"}),l.lab_hours_elem_sec&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.lab_hours_elem_sec})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.lecture_hours_elem_sec,onChange:f=>o("lecture_hours_elem_sec",f.target.value),placeholder:"Lecture",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 transition-colors duration-200","aria-label":"Lecture Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"}),l.lecture_hours_elem_sec&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.lecture_hours_elem_sec})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",value:i.total_teaching_hours_elem_sec,className:"w-full px-2 py-1 text-sm border border-cyan-300 rounded bg-cyan-50",readOnly:!0,"aria-label":"Total Teaching Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-cyan-600",children:"Total"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.student_lab_contact_hours_elem_sec,onChange:f=>o("student_lab_contact_hours_elem_sec",f.target.value),placeholder:"Lab",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 transition-colors duration-200","aria-label":"Student Lab Contact Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"}),l.student_lab_contact_hours_elem_sec&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.student_lab_contact_hours_elem_sec})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.student_lecture_contact_hours_elem_sec,onChange:f=>o("student_lecture_contact_hours_elem_sec",f.target.value),placeholder:"Lecture",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 transition-colors duration-200","aria-label":"Student Lecture Contact Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"}),l.student_lecture_contact_hours_elem_sec&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.student_lecture_contact_hours_elem_sec})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",value:i.total_student_contact_hours_elem_sec,className:"w-full px-2 py-1 text-sm border border-cyan-300 rounded bg-cyan-50",readOnly:!0,"aria-label":"Total Student Contact Hours Elementary/Secondary"}),r.jsx("label",{className:"text-xs text-cyan-600",children:"Total"})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-teal-50 via-emerald-50 to-green-100 rounded-lg p-2 border border-teal-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-teal-500 rounded-lg shadow-sm",children:r.jsx(r0,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Technical/Vocational"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Teaching Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.lab_hours_tech_voc,onChange:f=>o("lab_hours_tech_voc",f.target.value),placeholder:"Lab",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200","aria-label":"Lab Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"}),l.lab_hours_tech_voc&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.lab_hours_tech_voc})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.lecture_hours_tech_voc,onChange:f=>o("lecture_hours_tech_voc",f.target.value),placeholder:"Lecture",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200","aria-label":"Lecture Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"}),l.lecture_hours_tech_voc&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.lecture_hours_tech_voc})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",value:i.total_teaching_hours_tech_voc,className:"w-full px-2 py-1 text-sm border border-teal-300 rounded bg-teal-50",readOnly:!0,"aria-label":"Total Teaching Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-teal-600",children:"Total"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.student_lab_contact_hours_tech_voc,onChange:f=>o("student_lab_contact_hours_tech_voc",f.target.value),placeholder:"Lab",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200","aria-label":"Student Lab Contact Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lab"}),l.student_lab_contact_hours_tech_voc&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.student_lab_contact_hours_tech_voc})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.student_lecture_contact_hours_tech_voc,onChange:f=>o("student_lecture_contact_hours_tech_voc",f.target.value),placeholder:"Lecture",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200","aria-label":"Student Lecture Contact Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-gray-600",children:"Lecture"}),l.student_lecture_contact_hours_tech_voc&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.student_lecture_contact_hours_tech_voc})]}),r.jsxs("div",{children:[r.jsx("input",{type:"number",step:"0.1",value:i.total_student_contact_hours_tech_voc,className:"w-full px-2 py-1 text-sm border border-teal-300 rounded bg-teal-50",readOnly:!0,"aria-label":"Total Student Contact Hours Technical/Vocational"}),r.jsx("label",{className:"text-xs text-teal-600",children:"Total"})]})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-lg p-2 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(Xa,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Work Load"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Research"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_research_load,onChange:f=>o("official_research_load",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Research Load"}),l.official_research_load&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_research_load})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Extension"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_extension_services_load,onChange:f=>o("official_extension_services_load",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Extension Services Load"}),l.official_extension_services_load&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_extension_services_load})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Study"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_study_load,onChange:f=>o("official_study_load",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Study Load"}),l.official_study_load&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_study_load})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Production"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_load_for_production,onChange:f=>o("official_load_for_production",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Production Load"}),l.official_load_for_production&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_load_for_production})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Administrative"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.official_administrative_load,onChange:f=>o("official_administrative_load",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Administrative Load"}),l.official_administrative_load&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.official_administrative_load})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Other"}),r.jsx("input",{type:"number",step:"0.1",min:"0",value:i.other_official_load_credits,onChange:f=>o("other_official_load_credits",f.target.value),placeholder:"0.0",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-slate-500 focus:border-slate-500 transition-colors duration-200","aria-label":"Other Official Load"}),l.other_official_load_credits&&r.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:l.other_official_load_credits})]})]}),r.jsx("div",{className:"bg-white/60 rounded-md p-2 border border-slate-300",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Total Hours:"}),r.jsx("div",{className:"text-sm font-bold text-slate-900",children:i.total_work_load||0})]})})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-2 border-t border-gray-200",children:[r.jsx("button",{onClick:h,disabled:n,className:"w-full sm:w-auto px-4 py-1.5 text-sm border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium","aria-label":"Cancel",children:"Cancel"}),r.jsx("button",{onClick:p,disabled:n,className:"w-full sm:w-auto px-4 py-1.5 text-sm bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-md hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-blue-500 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center","aria-label":"Update Faculty",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-1.5"}),"Updating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-3 h-3 mr-1.5"}),"Update Faculty"]})})]})]})})}rN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,facultyData:B.object,loading:B.bool};function sN({isOpen:t,onClose:s,onUploadSuccess:e,institutionId:a}){const[n,i]=ne.useState(!1),[c,l]=ne.useState({}),[u,o]=ne.useState(new Date().getFullYear()),{showLoading:d,hideLoading:g,updateProgress:p}=J0(),h=(O,F)=>{c[O]&&l(z=>({...z,[O]:""})),o(F)},f=()=>{const O={};return a||(O.institution="Institution ID is required"),u||(O.year="Please select a report year"),l(O),Object.keys(O).length===0},x=O=>O==null?"":String(O).trim(),b=O=>{if(O==null||O==="")return 0;const F=Number(O);return isNaN(F)?0:F},v=async O=>{var P,U;const F=O.target.files[0];if(!F)return;if(!f()){Ft.showAlert("Please ensure institution and year are properly set before uploading.","error");return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(F.type)&&!F.name.match(/\.(xlsx|xls|csv)$/i)){Ft.showAlert("Please upload a valid Excel file (.xlsx, .xls) or CSV file.","error");return}i(!0),d();try{const W=await F.arrayBuffer(),Y=so(W,{cellStyles:!0,cellFormulas:!0,cellDates:!0,cellNF:!0,sheetStubs:!0,type:"array"}),q=Y.SheetNames.filter(M=>{const D=M.toLowerCase();return!D.includes("reference")&&!D.includes("discipline")}).map(M=>({name:M,type:"FACULTY",description:`Faculty Data from ${M}`}));if(console.log("Found sheets:",q),q.length===0)throw new Error("No valid faculty sheets found in the Excel file.");await _(Y,q),Ft.showAlert("Faculty E1 data uploaded successfully!","success"),s()}catch(W){console.error("Excel upload error:",W),Ft.showAlert(((U=(P=W.response)==null?void 0:P.data)==null?void 0:U.message)||W.message||"Failed to upload faculty data","error")}finally{i(!1),g(),O.target.value=""}},_=async(O,F)=>{var W,Y;const z=[],P=[];let U=0;for(const q of F)try{const M=O.Sheets[q.name],D=await N(M,q.name);D&&D.length>0?z.push(...D):console.log(`No valid faculty records found in sheet ${q.name}`),U++,p(U/F.length*80)}catch(M){console.error(`Error processing sheet ${q.name}:`,M),P.push(`Error in ${q.name}: ${((Y=(W=M.response)==null?void 0:W.data)==null?void 0:Y.error)||M.message}`)}if(z.length>0)try{p(90);const q=localStorage.getItem("token"),M=await bt.post(`${Ct.API_URL}/suc-form-e1/bulk`,{operation:"create",records:z},{headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"}});console.log("Faculty E1 upload response:",M.data),p(100),e(),l({})}catch(q){throw console.error("API request error:",q),q}},N=async(O,F)=>{var z,P,U,W,Y;try{const q=((z=F.match(/[A-E][1-3]?/))==null?void 0:z[0])||"A1",M=Wo.sheet_to_json(O,{header:1,defval:"",raw:!1});console.log(`Parsed JSON data from ${F} sheet:`,M);let D=-1;for(let S=0;S<M.length;S++){const w=M[S];if(Array.isArray(w)&&w.join(" ").toLowerCase().includes("start below this row")){D=S;break}}if(D===-1)for(let S=0;S<Math.min(20,M.length);S++){const w=M[S];if(Array.isArray(w)){const j=w.join(" ").toLowerCase();if(j.includes("name")||j.includes("faculty")||j.includes("rank")){D=S;break}}}console.log(`Start row index fetched: ${D}`),D===-1&&(console.warn(`Could not find "START BELOW THIS ROW" or header in the ${F} sheet. Using row 0.`),D=0);const T=D+1;if(T>=M.length)throw new Error(`No data rows found in the ${F} sheet.`);const C=M.slice(T).filter(S=>{const w=x(S[1]||S[0]);return!w||!w.trim()?(console.log(`Skipping row in ${F} sheet: missing or empty faculty name`),!1):S&&S.length>0&&S.some(j=>j!==void 0&&j!=="")}).map((S,w)=>{try{return{suc_details_id:parseInt(a),faculty_name:x(S[1]||S[0]),generic_faculty_rank:x(S[2]),home_college:x(S[3]),home_department:x(S[4]),is_tenured:x(S[5]),ssl_salary_grade:x(S[6]),annual_basic_salary:b(S[7]),on_leave_without_pay:x(S[8]),full_time_equivalent:b(S[9]),gender:x(S[10]),highest_degree_attained:x(S[11]),pursuing_next_degree:x(S[12]),discipline_teaching_load_1:x(S[13]),discipline_teaching_load_2:x(S[14]),discipline_bachelors:x(S[15]),discipline_masters:x(S[16]),discipline_doctorate:x(S[17]),masters_with_thesis:x(S[18]),doctorate_with_dissertation:x(S[19]),elem_sec_lab_hours_per_week:b(S[20]),elem_sec_lecture_hours_per_week:b(S[21]),elem_sec_total_teaching_hours:b(S[22]),elem_sec_lab_contact_hours:b(S[23]),elem_sec_lecture_contact_hours:b(S[24]),elem_sec_total_contact_hours:b(S[25]),tech_voc_lab_hours_per_week:b(S[26]),tech_voc_lecture_hours_per_week:b(S[27]),tech_voc_total_teaching_hours:b(S[28]),tech_voc_lab_contact_hours:b(S[29]),tech_voc_lecture_contact_hours:b(S[30]),tech_voc_total_contact_hours:b(S[31]),research_load:b(S[32]),extension_services_load:b(S[33]),study_load:b(S[34]),production_load:b(S[35]),administrative_load:b(S[36]),other_load_credits:b(S[37]),total_work_load:b(S[38]),report_year:parseInt(u),faculty_type:q}}catch(j){return console.warn(`Error processing row ${w+1} in ${F}:`,j),null}}).filter(S=>S!==null);if(C.length===0)throw new Error(`No valid faculty data found in the ${F} sheet.`);return console.log(`Processed faculty from ${F}:`,C),C}catch(q){console.error(`Faculty sheet processing error in ${F}:`,q);const M=(U=(P=q.response)==null?void 0:P.data)==null?void 0:U.errors;if(M){const D=Object.entries(M).map(([T,C])=>`${T}: ${C.join(", ")}`).join(`
`);throw new Error(`Validation failed:
${D}`)}throw new Error(((Y=(W=q.response)==null?void 0:W.data)==null?void 0:Y.message)||`Failed to process faculty in ${F}: ${q.message}`)}},E=()=>{l({}),s()};return t?r.jsx(mr,{isOpen:t,onClose:E,title:"Upload Faculty E1 Data",subtitle:"Import HEMIS Form E1 or faculty Excel files for Elementary, Secondary, and Tech/Voc Levels",icon:Qr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Upload Configuration"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution ID"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600",placeholder:"Institution ID will be auto-filled"}),c.institution&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.institution})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Report Year"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{value:u,onChange:O=>h("year",parseInt(O.target.value)),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${c.year?"border-red-300 bg-red-50":"border-gray-300"}`,children:Array.from({length:10},(O,F)=>{const z=new Date().getFullYear()-F;return r.jsx("option",{value:z,children:z},z)})}),c.year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.year})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(pi,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Excel Format Guidelines"})]}),r.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ys,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"HEMIS Form E1 Structure:"}),r.jsxs("ul",{className:"space-y-1 ml-2",children:[r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),'Data starts after "START BELOW THIS ROW" or header row']}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Only rows with a valid Faculty Name are processed"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Column A/B: Faculty Name (Required)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Column C: Faculty Rank (e.g., TEACHER, INSTRUCTOR)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns D-E: College & Department"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns F-K: Employment details (tenure, salary, gender)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns L-T: Academic qualifications (degree, disciplines)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns U-Z: Elementary/Secondary teaching load"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns AA-AI: Tech/Voc teaching load"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns AJ-AP: Additional workload (research, extension, admin)"]})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(eo,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"Faculty Type Mapping:"}),r.jsxs("ul",{className:"space-y-1 ml-2 text-xs",children:[r.jsx("li",{children:"A1: Full-time with Plantilla Items"}),r.jsx("li",{children:"B: Full-time from PS Items on Leave"}),r.jsx("li",{children:"C1: Full-time from GAA PS Lump Sums"}),r.jsx("li",{children:"C2: Full-time from SUC Income"}),r.jsx("li",{children:"C3: Full-time from LGU Funds"}),r.jsx("li",{children:"E: Part-time Lecturers"})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ui,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"Data will be processed as-is from the Excel file without any transformations."})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(qr,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"Supported formats: .xlsx, .xls, and .csv files with faculty information"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($o,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"File Upload"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"file",id:"excel-upload",accept:".xlsx,.xls,.csv",onChange:v,disabled:n||!a,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),r.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200 ${!a||n?"border-gray-200 bg-gray-50/50":"border-slate-300 hover:border-slate-400 hover:bg-slate-50/50 bg-white"}`,children:[r.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${!a||n?"bg-gray-100":"bg-gradient-to-br from-slate-100 to-slate-200"}`,children:n?r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}):r.jsx(Qr,{className:`w-8 h-8 ${a?"text-slate-600":"text-gray-300"}`})}),r.jsx("p",{className:`text-lg font-semibold mb-2 ${!a||n?"text-gray-400":"text-gray-900"}`,children:n?"Processing File...":"Choose Excel File to Upload"}),r.jsx("p",{className:`text-sm mb-2 ${!a||n?"text-gray-400":"text-gray-600"}`,children:"Drag and drop or click to browse"}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-2",children:[r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:".xlsx"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:".xls"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:".csv"})]}),!a&&r.jsxs("div",{className:"flex items-center justify-center mt-3",children:[r.jsx(Ht,{className:"w-4 h-4 text-red-500 mr-1"}),r.jsx("span",{className:"text-sm text-red-500 font-medium",children:"Institution ID is required"})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Faculty Classification Reference"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-blue-800 mb-1",children:"Group A1"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty with their own plantilla items"})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-green-800 mb-1",children:"Group B"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty drawing from PS items of those on leave"})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-purple-800 mb-1",children:"Group C1"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty from GAA PS lump sums"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-orange-800 mb-1",children:"Group C2"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty from SUC income"})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-pink-800 mb-1",children:"Group C3"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty from LGU funds"})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-yellow-800 mb-1",children:"Group E"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Part-time lecturers and faculty"})]})]})]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:r.jsx("button",{onClick:E,disabled:n,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:n?"Processing...":"Close"})})]})}):null}sN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onUploadSuccess:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired};function aN(){var Me,Oe;const{SucDetailId:t}=Ko(),s=Aa(),e=qs(),a=((Me=e.state)==null?void 0:Me.heiName)||"Unknown Institution",n=((Oe=e.state)==null?void 0:Oe.heiName)||"Unknown Institution",[i,c]=ne.useState([]),[l,u]=ne.useState([]),[o,d]=ne.useState(!0),[g,p]=ne.useState(""),[h,f]=ne.useState(null),[x,b]=ne.useState(!1),[v,_]=ne.useState(!1),[N,E]=ne.useState(!1),[O,F]=ne.useState(!1),[z,P]=ne.useState(!1),[U,W]=ne.useState(!1),[Y,q]=ne.useState(!1),[M,D]=ne.useState(""),[T,C]=ne.useState("ALL"),[S,w]=ne.useState(1),[j,A]=ne.useState(10);ne.useEffect(()=>{ae()},[]),ne.useEffect(()=>{let je=i;M&&(je=je.filter(Ie=>{var Pe,He,ct,ie,ee;return((Pe=Ie.faculty_name_ln)==null?void 0:Pe.toLowerCase().includes(M.toLowerCase()))||((He=Ie.faculty_name_fn)==null?void 0:He.toLowerCase().includes(M.toLowerCase()))||((ct=Ie.home_college)==null?void 0:ct.toLowerCase().includes(M.toLowerCase()))||((ie=Ie.home_dept)==null?void 0:ie.toLowerCase().includes(M.toLowerCase()))||((ee=Ie.generic_faculty_rank)==null?void 0:ee.toLowerCase().includes(M.toLowerCase()))})),T!=="ALL"&&(je=je.filter(Ie=>Ie.faculty_type===T)),u(je),w(1)},[i,M,T]);const L=ne.useMemo(()=>{const je=(S-1)*j,Ie=je+j;return l.slice(je,Ie)},[l,S,j]),I=Math.ceil(l.length/j),Z=je=>{w(je)},K=je=>{A(je),w(1)},re=()=>{const je=(S-1)*j+1,Ie=Math.min(je+j-1,l.length);return`${je}-${Ie}`},G=ne.useCallback(async()=>{try{q(!0),jr.fire({title:"Confirm Export",text:`Do you want to export Form E-1 for ${n}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Export",cancelButtonText:"Cancel",customClass:{popup:"swal2-popup",title:"text-lg font-semibold text-gray-900",content:"text-gray-600"}}).then(async je=>{if(je.isConfirmed)try{const Ie=await fetch("/templates/Form-E1-Themeplate.xlsx");if(!Ie.ok)throw new Error(`HTTP error! Status: ${Ie.status}`);const Pe=await Ie.arrayBuffer(),He=new fd.Workbook;await He.xlsx.load(Pe);const ct=(Fe,st)=>{let it=Fe.getWorksheet(st);if(!it)for(let lt=0;lt<Fe.worksheets.length;lt++){const yt=Fe.worksheets[lt];if(yt.name.toUpperCase()===st.toUpperCase()){it=yt;break}}return it||(it=Fe.addWorksheet(st)),it},ie=Fe=>{if(!Fe)return null;const st=String(Fe).toUpperCase();return st==="A1"?"GROUP A1":st==="B"?"GROUP B":st==="C1"?"GROUP C1":st==="C2"?"GROUP C2":st==="C3"?"GROUP C3":st==="E"?"GROUP E":null},ee={};["GROUP A1","GROUP B","GROUP C1","GROUP C2","GROUP C3","GROUP E"].forEach(Fe=>{const st=ct(He,Fe);let it=-1;st.eachRow((lt,yt)=>{let vt=!1;if(lt.eachCell(Nt=>{if(Nt.value&&String(Nt.value).trim()==="START BELOW THIS ROW")return vt=!0,!1}),vt)return it=yt+1,!1}),it===-1&&(it=11),ee[Fe]=it}),i.forEach((Fe,st)=>{const it=ie(Fe.faculty_type);if(!it)return;const lt=ct(He,it),yt=ee[it]++,vt=lt.getRow(yt);vt.getCell(1).value=st+1,vt.getCell(2).value=Fe.faculty_name||"",vt.getCell(3).value=Fe.generic_faculty_rank||"",vt.getCell(4).value=Fe.home_college||"",vt.getCell(5).value=Fe.home_dept||"",vt.getCell(6).value=Fe.is_tenured||"",vt.getCell(7).value=Fe.ssl_salary_grade||"",vt.getCell(8).value=Fe.annual_basic_salary||"",vt.getCell(9).value=Fe.on_leave_without_pay||"",vt.getCell(10).value=Fe.full_time_equivalent||"",vt.getCell(11).value=Fe.gender||"",vt.getCell(12).value=Fe.highest_degree_attained||"",vt.getCell(13).value=Fe.actively_pursuing_next_degree||"",vt.getCell(14).value=Fe.primary_teaching_load_discipline_1||"",vt.getCell(15).value=Fe.primary_teaching_load_discipline_2||"",vt.getCell(16).value=Fe.bachelors_discipline||"",vt.getCell(17).value=Fe.masters_discipline||"",vt.getCell(18).value=Fe.doctorate_discipline||"",vt.getCell(19).value=Fe.masters_with_thesis||"",vt.getCell(20).value=Fe.doctorate_with_dissertation||"",vt.getCell(21).value=Fe.lab_hours_elem_sec||"",vt.getCell(22).value=Fe.lecture_hours_elem_sec||"",vt.getCell(24).value=Fe.student_lab_contact_hours_elem_sec||"",vt.getCell(25).value=Fe.student_lecture_contact_hours_elem_sec||"",vt.getCell(27).value=Fe.lab_hours_tech_voc||"",vt.getCell(28).value=Fe.lecture_hours_tech_voc||"",vt.getCell(30).value=Fe.student_lab_contact_hours_tech_voc||"",vt.getCell(31).value=Fe.student_lecture_contact_hours_tech_voc||"",vt.getCell(33).value=Fe.official_research_load||"",vt.getCell(34).value=Fe.official_extension_services_load||"",vt.getCell(35).value=Fe.official_study_load||"",vt.getCell(36).value=Fe.official_load_for_production||"",vt.getCell(37).value=Fe.official_administrative_load||"",vt.getCell(38).value=Fe.other_official_load_credits||"",vt.commit()}),console.log(`Export completed: ${i.length} faculty records exported`);const te=`${a}_${n.replace(/[^a-zA-Z0-9]/g,"_")}_FormE1_${new Date().toISOString().split("T")[0]}.xlsx`,fe=await He.xlsx.writeBuffer(),_e=new Blob([fe],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Te=window.URL.createObjectURL(_e),Ae=document.createElement("a");Ae.href=Te,Ae.download=te,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),window.URL.revokeObjectURL(Te),jr.fire({title:"Success!",text:`Form E-1 exported successfully. ${i.length} faculty records exported.`,icon:"success",timer:4e3,showConfirmButton:!1})}catch(Ie){console.error("Error exporting Form E-1:",Ie),jr.fire({title:"Error!",text:"Failed to export Form E-1. Please try again.",icon:"error",confirmButtonText:"OK"})}finally{q(!1)}else q(!1)})}catch(je){console.error("Error in export function:",je),q(!1)}},[i,n]),ae=async()=>{var je;if(!t){console.error("SucDetailId is undefined. Cannot fetch faculties."),p("Invalid institution ID. Please check the URL or try again."),d(!1);return}d(!0),p("");try{const Ie=await bt.get(`${Ct.API_URL}/suc-form-e1`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"},params:{suc_details_id:t}}),Pe=Array.isArray(Ie.data)?Ie.data.filter(He=>He.suc_details_id==t):((je=Ie.data.data)==null?void 0:je.filter(He=>He.suc_details_id==t))||[];c(Pe),u(Pe),console.log("Fetched faculties:",Pe)}catch(Ie){console.error("Error fetching faculties:",Ie),p("Failed to load faculty records. Please try again.")}finally{d(!1)}},V=je=>{f(je),b(!0)},H=je=>{f(je),E(!0)},Q=async je=>{W(!0);try{const Ie=await bt.put(`${Ct.API_URL}/suc-form-e1/${je.id}`,je,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(Ie.status===200){const Pe=Ie.data;c(He=>He.map(ct=>ct.id===Pe.id?Pe:ct)),u(He=>He.map(ct=>ct.id===Pe.id?Pe:ct)),E(!1),f(null),console.log("Faculty updated successfully:",Pe)}}catch(Ie){console.error("Error updating faculty:",Ie),p("Failed to update faculty. Please try again.")}finally{W(!1)}},oe=()=>{E(!1),f(null)},se=()=>{_(!0)},le=async je=>{P(!0);try{const Ie=await bt.post(`${Ct.API_URL}/suc-form-e1`,{...je,suc_details_id:t},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(Ie.status===201){const Pe=Ie.data;c(He=>[...He,Pe]),u(He=>[...He,Pe]),_(!1),console.log("Faculty created successfully:",Pe)}}catch(Ie){console.error("Error creating faculty:",Ie),p("Failed to create faculty. Please try again.")}finally{P(!1)}},he=()=>{_(!1)},Ne=async je=>{if(window.confirm("Are you sure you want to delete this faculty record?"))try{if((await bt.delete(`${Ct.API_URL}/suc-form-e1/${je}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}})).status===200)c(i.filter(Pe=>Pe.id!==je)),u(l.filter(Pe=>Pe.id!==je));else throw new Error("Failed to delete faculty")}catch(Ie){console.error("Error deleting faculty:",Ie),p("Failed to delete faculty. Please try again.")}},we=()=>{s("/super-admin/institutions/suc")},ue=()=>{b(!1),f(null)},Se=je=>{switch(je==null?void 0:je.toLowerCase()){case"doctorate":case"phd":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border border-purple-300";case"masters":case"master":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border border-blue-300";case"bachelors":case"bachelor":return"bg-gradient-to-r from-green-100 to-green-200 text-green-800 border border-green-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border border-gray-300"}};ne.useEffect(()=>{console.log("Institution Name:",n)},[n]);const ke=(je,Ie)=>{if(!je&&je!==0)return"Not specified";if(Array.isArray(Ie)){const Pe=Ie.find(He=>String(He.code)===String(je));return Pe?Pe.label:je}return Ie[String(je)]||je};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:we,className:"mr-4 p-2 text-gray-600 hover:text-gray-900 hover:bg-white/50 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Back to SUC List",children:r.jsx(Zo,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Faculty Management (Form E-1)"}),r.jsxs("p",{className:"text-gray-600 flex items-center",children:[r.jsx(Jr,{className:"w-4 h-4 mr-2"}),n]})]})]}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm mb-6",children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1 w-full xl:w-auto",children:[r.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search faculty...",value:M,onChange:je=>D(je.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-60 lg:w-80 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm transition-all duration-200"})]}),r.jsxs("div",{className:"relative w-full sm:w-auto",children:[r.jsx(zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsxs("select",{value:T,onChange:je=>C(je.target.value),className:"pl-10 pr-8 py-2 w-full sm:w-auto border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm appearance-none cursor-pointer transition-all duration-200",children:[r.jsx("option",{value:"ALL",children:"All Types"}),M0.map(je=>r.jsx("option",{value:je.code,children:je.label},je.code))]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full xl:w-auto",children:[r.jsxs("button",{onClick:G,disabled:Y,className:"inline-flex items-center justify-center px-4 py-2 bg-white/50 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-white hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(oc,{className:"w-4 h-4 mr-2"}),Y?"Exporting...":"Export"]}),r.jsxs("button",{onClick:()=>F(!0),className:"inline-flex items-center justify-center px-4 py-2 bg-white/50 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-white hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx(Qr,{className:"w-4 h-4 mr-2"}),"Upload"]}),r.jsxs("button",{onClick:se,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Faculty"]})]})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Qo,{className:"w-4 h-4 mr-1"}),"Showing ",re()," of ",l.length," faculty members"]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("select",{value:j,onChange:je=>K(Number(je.target.value)),className:"px-2 py-1 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm",children:[r.jsx("option",{value:5,children:"5 per page"}),r.jsx("option",{value:10,children:"10 per page"}),r.jsx("option",{value:20,children:"20 per page"}),r.jsx("option",{value:50,children:"50 per page"})]})})]})]})})]}),g&&r.jsx("div",{className:"mb-6 p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(vs,{className:"w-5 h-5 mr-2"}),g]})}),o?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-8 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),r.jsx("span",{className:"text-gray-600 font-medium",children:"Loading faculty records..."})]})})}):r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl shadow-sm border border-white/20 overflow-hidden",children:[r.jsx("div",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50 border-b border-gray-200/50",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsx("table",{className:"min-w-full",children:r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Faculty Information"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Position & College"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Education & Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Work Load & Salary"}),r.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})})})})}),r.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsx("table",{className:"min-w-full",children:r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[L.map((je,Ie)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${Ie%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-4 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-indigo-100 to-indigo-200 text-indigo-700",children:r.jsx(ir,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:je.faculty_name}),r.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[r.jsx(ir,{className:"w-3 h-3 mr-1"}),ke(je.gender,Jx)]}),r.jsxs("div",{className:"text-xs text-gray-500 flex items-center mt-1",children:[r.jsx(Zr,{className:"w-3 h-3 mr-1"}),ke(je.faculty_type,M0)]}),r.jsx("div",{className:"text-xs text-gray-400 flex items-center mt-1",children:r.jsxs("span",{className:"font-mono",children:["ID: ",je.id]})})]})]})}),r.jsx("td",{className:"px-4 py-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:ke(je.generic_faculty_rank,Wx)||"Not assigned"}),r.jsxs("div",{className:"text-xs text-gray-600",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(qr,{className:"w-3 h-3 mr-1 text-blue-500"}),je.home_college||"No college"]}),r.jsxs("div",{className:"flex items-center mt-1",children:[r.jsx(Zr,{className:"w-3 h-3 mr-1 text-green-500"}),je.home_dept||"No department"]})]})]})}),r.jsx("td",{className:"px-4 py-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full shadow-sm ${Se(je.highest_degree_attained)}`,children:ke(je.highest_degree_attained,R0)||"Not specified"}),r.jsxs("div",{className:"space-y-1",children:[je.is_tenured&&r.jsxs("div",{className:"text-xs text-green-600 flex items-center",children:[r.jsx(Zr,{className:"w-3 h-3 mr-1"}),ke(je.is_tenured,Xx)]}),je.actively_pursuing_next_degree&&r.jsxs("div",{className:"text-xs text-blue-600 flex items-center",children:[r.jsx(gr,{className:"w-3 h-3 mr-1"}),ke(je.actively_pursuing_next_degree,R0)]}),je.on_leave_without_pay&&r.jsxs("div",{className:"text-xs text-orange-600 flex items-center",children:[r.jsx(Xa,{className:"w-3 h-3 mr-1"}),ke(je.on_leave_without_pay,Qx)]})]})]})}),r.jsx("td",{className:"px-4 py-4",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[r.jsx(Xa,{className:"w-3 h-3 mr-1 text-blue-500"}),je.total_work_load?`${je.total_work_load} hrs`:"Not set"]}),r.jsxs("div",{className:"text-xs text-gray-600",children:[je.annual_basic_salary&&r.jsxs("div",{className:"flex items-center",children:[r.jsx(s3,{className:"w-3 h-3 mr-1 text-green-500"}),ke(je.annual_basic_salary,Zx)]}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Grade: ",ke(je.ssl_salary_grade,Kx)||"Not specified"]})]})]})}),r.jsx("td",{className:"px-4 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",offset:[0,4],usePortal:!0,children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>V(je),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"View Details"]}),r.jsxs("button",{onClick:()=>H(je),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500 group-hover:text-green-600"}),"Edit Faculty"]}),r.jsxs("button",{onClick:()=>Ne(je.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-700 group-hover:text-red-800"}),"Delete Faculty"]})]})})})]},je.id)),l.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"5",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(Jr,{className:"w-10 h-10 text-gray-400"})}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:M||T!=="ALL"?"No matching faculty found":"No Faculty Records Found"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:M||T!=="ALL"?"Try adjusting your search terms or filters.":"This institution has no faculty records yet."}),!M&&T==="ALL"&&r.jsxs("button",{onClick:se,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add First Faculty"]})]})})})]})})})})]}),l.length>0&&r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx(pc,{currentPage:S,totalPages:I,onPageChange:Z,pageSize:j,onPageSizeChange:K})}),r.jsx(K6,{isOpen:x,onClose:ue,facultyData:h}),r.jsx(tN,{isOpen:v,onClose:he,onSave:le,institutionId:t,loading:z}),r.jsx(rN,{isOpen:N,onClose:oe,onSave:Q,facultyData:h,loading:U}),r.jsx(sN,{isOpen:O,onClose:()=>F(!1),onUploadSuccess:ae,institutionId:t})]})})}aN.propTypes={};const eb=t=>{const[s,e]=ne.useState({name:"",gender:"",generic_faculty_rank:"",home_college:"",home_department:"",is_tenured:"",ssl_salary_grade:"",annual_basic_salary:"",on_leave_without_pay:"",full_time_equivalent:"",highest_degree_attained:"",pursuing_next_degree:"",discipline_teaching_load_1:"",discipline_teaching_load_2:"",discipline_bachelors:"",discipline_masters:"",discipline_doctorate:"",masters_with_thesis:"",doctorate_with_dissertation:"",undergrad_lab_credit_units:0,undergrad_lecture_credit_units:0,undergrad_total_credit_units:0,undergrad_lab_hours_per_week:0,undergrad_lecture_hours_per_week:0,undergrad_total_hours_per_week:0,undergrad_lab_contact_hours:0,undergrad_lecture_contact_hours:0,undergrad_total_contact_hours:0,graduate_lab_credit_units:0,graduate_lecture_credit_units:0,graduate_total_credit_units:0,graduate_lab_contact_hours:0,graduate_lecture_contact_hours:0,graduate_total_contact_hours:0,research_load:0,extension_services_load:0,study_load:0,production_load:0,administrative_load:0,other_load_credits:0,total_work_load:0,report_year:new Date().getFullYear(),faculty_type:"",suc_details_id:t}),[a,n]=ne.useState({});return{formData:s,errors:a,handleInputChange:(N,E)=>{e(O=>{const F={...O,[N]:E};return(N==="undergrad_lab_credit_units"||N==="undergrad_lecture_credit_units")&&(F.undergrad_total_credit_units=(parseFloat(F.undergrad_lab_credit_units)||0)+(parseFloat(F.undergrad_lecture_credit_units)||0)),(N==="undergrad_lab_hours_per_week"||N==="undergrad_lecture_hours_per_week")&&(F.undergrad_total_hours_per_week=(parseFloat(F.undergrad_lab_hours_per_week)||0)+(parseFloat(F.undergrad_lecture_hours_per_week)||0)),(N==="undergrad_lab_contact_hours"||N==="undergrad_lecture_contact_hours")&&(F.undergrad_total_contact_hours=(parseFloat(F.undergrad_lab_contact_hours)||0)+(parseFloat(F.undergrad_lecture_contact_hours)||0)),(N==="graduate_lab_credit_units"||N==="graduate_lecture_credit_units")&&(F.graduate_total_credit_units=(parseFloat(F.graduate_lab_credit_units)||0)+(parseFloat(F.graduate_lecture_credit_units)||0)),(N==="graduate_lab_contact_hours"||N==="graduate_lecture_contact_hours")&&(F.graduate_total_contact_hours=(parseFloat(F.graduate_lab_contact_hours)||0)+(parseFloat(F.graduate_lecture_contact_hours)||0)),(N.includes("_load")||N.includes("credit_units"))&&(F.total_work_load=(parseFloat(F.undergrad_total_credit_units)||0)+(parseFloat(F.graduate_total_credit_units)||0)+(parseFloat(F.research_load)||0)+(parseFloat(F.extension_services_load)||0)+(parseFloat(F.study_load)||0)+(parseFloat(F.production_load)||0)+(parseFloat(F.administrative_load)||0)+(parseFloat(F.other_load_credits)||0)),F}),a[N]&&n(O=>({...O,[N]:null}))},validateForm:()=>{var E;const N={};return(E=s.name)!=null&&E.trim()||(N.name="Name is required"),s.gender||(N.gender="Gender is required"),s.faculty_type||(N.faculty_type="Faculty type is required"),s.highest_degree_attained||(N.highest_degree_attained="Highest degree is required"),s.annual_basic_salary&&parseFloat(s.annual_basic_salary)<0&&(N.annual_basic_salary="Salary cannot be negative"),s.full_time_equivalent&&(parseFloat(s.full_time_equivalent)<0||parseFloat(s.full_time_equivalent)>1)&&(N.full_time_equivalent="FTE must be between 0 and 1"),s.ssl_salary_grade&&(parseFloat(s.ssl_salary_grade)<1||parseFloat(s.ssl_salary_grade)>33)&&(N.ssl_salary_grade="Salary Grade must be between 1 and 33"),n(N),Object.keys(N).length===0},facultyRankOptions:[{value:"20",label:"Instructor"},{value:"30",label:"Assistant Professor"},{value:"40",label:"Associate Professor"},{value:"50",label:"Full Professor (including University Professor)"},{value:"09",label:"Teaching Fellow or Teaching Associate"},{value:"11",label:"Lecturer, Senior Lecturer, Professorial Lecturer"},{value:"12",label:"Professor Emeritus"},{value:"13",label:"Visiting Professor (whatever the actual rank)"},{value:"14",label:"Adjunct or Affiliate Faculty (regardless of whether adjunct asst prof or adjunct associate prof or adjunt professor, etc.)"},{value:"90",label:"Others"}],tenuredOptions:[{value:"1",label:"Faculty member is tenured"},{value:"2",label:"Faculty member has his own plantilla item but is NOT TENURED"},{value:"3",label:"Faculty member has no plantilla item"},{value:"4",label:"No information on the matter"}],annualSalaryOptions:[{value:"1",label:"Below 60,000"},{value:"2",label:"60,000 - 69,999"},{value:"3",label:"70,000 - 79,999"},{value:"4",label:"80,000 - 89,999"},{value:"5",label:"90,000 - 99,999"},{value:"6",label:"100,000 - 149,999"},{value:"7",label:"150,000 - 249,999"},{value:"8",label:"250,000 - 499,999"},{value:"9",label:"500,000 and above"}],onLeavePayOptions:[{value:"1",label:"The faculty member is on OFFICIAL LEAVE WITHOUT PAY"},{value:"2",label:"The faculty member is in ACTIVE DUTY OR ON OFFICIAL LEAVE WITH PAY."},{value:"3",label:"No information on the matter."}],fullTimeEquivalentOptions:[{value:"1",label:"1.00"},{value:"2",label:"0.50"},{value:"3",label:"0.250"}],genderOptions:[{value:"1",label:"Male"},{value:"2",label:"Female"}],highestDegreeOptions:[{value:"000",label:"No formal education at all"},{value:"101",label:"Partial elementary schooling but did not complete Grade 4"},{value:"102",label:"Completed Grade 4 but did not graduate from elementary school"},{value:"103",label:"Completed Elementary School"},{value:"201",label:"Partial completion of High School"},{value:"202",label:"Secondary school graduate or equivalent"},{value:"301",label:"Partial completion of High School"},{value:"302",label:"Completed Tech/Voch"},{value:"401",label:"Partial completion of pre-baccalaureate certificate, diploma or associateship"},{value:"402",label:"Completed pre-bacc certificate, diploma or associateship"},{value:"501",label:"Completed Year 1 of baccalaureate level or equivalent"},{value:"502",label:"Completed Year 2 of baccalaureate level or equivalent"},{value:"503",label:"Completed Year 3 of baccalaureate level or equivalent"},{value:"504",label:"Completed Year 4 of baccalaureate level or equivalent"},{value:"505",label:"Completed Year 5 of baccalaureate level or equivalent"},{value:"506",label:"Completed Year 6 of baccalaureate level or equivalent"},{value:"507",label:"Completed a baccalaureate degree (including DVM, DDM, D Opt)"},{value:"601",label:"Partial Completion of postgraduate certificate or diploma program"},{value:"602",label:"Completed post-grad certificate or diploma program"},{value:"701",label:"Completed Year 1 of MD"},{value:"702",label:"Completed Year 2 of MD"},{value:"703",label:"Completed Year 3 of MD"},{value:"704",label:"Completed Year 4 of MD"},{value:"705",label:"Completed MD or LLB (or)"},{value:"801",label:"Partial completion of"},{value:"802",label:"Completed all masters"},{value:"803",label:"Completed masters"},{value:"901",label:"Partial completion of"},{value:"902",label:"Completed all doctorate"},{value:"903",label:"Completed"}],pursuingNextDegreeOptions:[{value:"1",label:"Faculty has already completed doctorate degree in the field where he is teaching."},{value:"2",label:"Masters degree holder with some PhD units actively pursuing doctorate degree in the discipline where he is teaching."},{value:"3",label:"Masters degree holder with some PhD units in the discipline where he is teaching but no longer actively pursuing a PhD."},{value:"4",label:"Masters degree holder with no PhD units in the discipline where he is teaching."},{value:"5",label:"Bachelors degree holder with some masters units in the discipline where he is teaching actively pursuing masters degree."},{value:"6",label:"Bachelors degree holder with some masters units in the discipline whre he is teaching but no longer in active pursuit of masters degree."},{value:"7",label:"Bachelors degree holder with no masters units in the discipline where he is teaching."},{value:"8",label:"Not a faculty member."},{value:"9",label:"No information on the matter."}],thesisOptions:[{value:"1",label:"YES. IN OBTAINING MASTERS DEGREE, THE FACULTY MEMBER WROTE A THESIS."},{value:"2",label:"NO. IN OBTAINING HIS MASTERS, FACULTY MEMBER DID NOT WRITE A THESIS."},{value:"3",label:"NO INFORMATION ON THE MATTER."}],dissertationOptions:[{value:"1",label:"YES. IN OBTAINING DOCTORATE, THE FACULTY MEMBER WROTE A DISSERTATION."},{value:"2",label:"NO. IN OBTAINING DOCTORATE, FACULTY MEMBER DID NOT WRITE DISSERTATION."},{value:"3",label:"NO INFORMATION ON THE MATTER."}],facultyTypeOptions:[{value:"A1",label:"A1 - Full-time with Plantilla"},{value:"B",label:"B - Full-time from PS Items"},{value:"C1",label:"C1 - Full-time from GAA"},{value:"C2",label:"C2 - Full-time from SUC Income"},{value:"C3",label:"C3 - Full-time from LGU"},{value:"E",label:"E - Part-time Lecturer"}],resetForm:()=>{e({name:"",gender:"",generic_faculty_rank:"",home_college:"",home_department:"",is_tenured:"",ssl_salary_grade:"",annual_basic_salary:"",on_leave_without_pay:"",full_time_equivalent:"",highest_degree_attained:"",pursuing_next_degree:"",discipline_teaching_load_1:"",discipline_teaching_load_2:"",discipline_bachelors:"",discipline_masters:"",discipline_doctorate:"",masters_with_thesis:"",doctorate_with_dissertation:"",undergrad_lab_credit_units:0,undergrad_lecture_credit_units:0,undergrad_total_credit_units:0,undergrad_lab_hours_per_week:0,undergrad_lecture_hours_per_week:0,undergrad_total_hours_per_week:0,undergrad_lab_contact_hours:0,undergrad_lecture_contact_hours:0,undergrad_total_contact_hours:0,graduate_lab_credit_units:0,graduate_lecture_credit_units:0,graduate_total_credit_units:0,graduate_lab_contact_hours:0,graduate_lecture_contact_hours:0,graduate_total_contact_hours:0,research_load:0,extension_services_load:0,study_load:0,production_load:0,administrative_load:0,other_load_credits:0,total_work_load:0,report_year:new Date().getFullYear(),faculty_type:"",suc_details_id:t}),n({})}}},fq=[{value:"1",label:"60,000 below"},{value:"2",label:"60,000 - 69,999"},{value:"3",label:"70,000 - 79,999"},{value:"4",label:"80,000 - 89,999"},{value:"5",label:"90,000 - 99,999"},{value:"6",label:"100,000 - 149,999"},{value:"7",label:"150,000 - 249,999"},{value:"8",label:"250,000 - 499,999"},{value:"9",label:"500,000 - UP"}],hq=t=>{if(!t)return"No salary range specified";const s=fq.find(e=>e.value===String(t));return s?s.label:"Invalid range"},nN=({isOpen:t,onClose:s,facultyData:e})=>{const{genderOptions:a,facultyTypeOptions:n}=eb(e==null?void 0:e.suc_details_id);if(!e)return null;const i=x=>{switch(x==null?void 0:x.toUpperCase()){case"A1":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border-blue-300";case"B":return"bg-gradient-to-r from-green-100 to-green-200 text-green-800 border-green-300";case"C1":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border-purple-300";case"C2":return"bg-gradient-to-r from-orange-100 to-orange-200 text-orange-800 border-orange-300";case"C3":return"bg-gradient-to-r from-pink-100 to-pink-200 text-pink-800 border-pink-300";case"E":return"bg-gradient-to-r from-yellow-100 to-yellow-200 text-yellow-800 border-yellow-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border-gray-300"}},c=x=>{const b=n.find(v=>v.value===x);return b?b.label:"Unknown Faculty Type"},l=x=>{switch(String(x||"").toLowerCase()){case"doctorate":case"phd":return"text-purple-700 bg-purple-100";case"masters":case"master":return"text-blue-700 bg-blue-100";case"bachelor":case"bachelors":return"text-green-700 bg-green-100";default:return"text-gray-700 bg-gray-100"}},u=x=>{const b=a.find(v=>v.value===String(x));return b?b.label:"Not specified"},o=x=>x==="1"?"":x==="2"?"":"",d=(x,b="Not specified")=>x==null||x===""?b:typeof x=="object"?String(x)||b:String(x),g=x=>x?typeof x=="object"&&x.year?String(x.year):String(x):"Not specified",p=(x,b=0)=>{const v=Number(x);return isNaN(v)?b:v},h=()=>p(e.undergrad_total_credit_units)+p(e.graduate_total_credit_units),f=()=>p(e.undergrad_total_contact_hours)+p(e.graduate_total_contact_hours);return r.jsx(mr,{isOpen:t,onClose:s,title:d(e.name,"Faculty Details"),subtitle:"Faculty Member Information",icon:Gs,variant:"view",size:"xl",children:r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Personal Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),r.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:d(e.name)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Gender"}),r.jsxs("p",{className:"text-sm text-gray-900",children:[o(e.gender)," ",u(e.gender)]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Faculty Rank"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.generic_faculty_rank)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Salary Grade"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.ssl_salary_grade,"Not assigned")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty Status"}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full border ${i(e.faculty_type)}`,children:d(e.faculty_type,"Unknown Type")}),e.is_tenured==="Yes"&&r.jsxs("span",{className:"inline-flex items-center px-3 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 border border-green-300",children:[r.jsx(eo,{className:"w-3 h-3 mr-1"}),"Tenured"]}),e.on_leave_without_pay===1&&r.jsxs("span",{className:"inline-flex items-center px-3 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800 border border-orange-300",children:[r.jsx(Xa,{className:"w-3 h-3 mr-1"}),"On Leave"]})]}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:c(e.faculty_type)})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(Ya,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Department & Position"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Home College"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.home_college)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Home Department"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.home_department)})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[r.jsx(Xa,{className:"w-4 h-4 inline mr-1"}),"Full-Time Equivalent"]}),r.jsxs("p",{className:"text-sm text-gray-900",children:[p(e.full_time_equivalent)," FTE"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Report Year"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.report_year)})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Academic Qualifications"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Highest Degree Attained"}),r.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${l(e.highest_degree_attained)}`,children:[r.jsx(gr,{className:"w-4 h-4 mr-1"}),d(e.highest_degree_attained)]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pursuing Next Degree"}),r.jsx("p",{className:"text-sm text-gray-900",children:e.pursuing_next_degree===1?"Yes":"No"})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[r.jsxs("div",{className:"flex items-center justify-between bg-white/60 rounded-lg p-2 border",children:[r.jsx("span",{className:"text-sm text-gray-700",children:"Masters with Thesis:"}),r.jsx("span",{className:`text-sm font-medium ${e.masters_with_thesis===1?"text-green-600":"text-gray-500"}`,children:e.masters_with_thesis===1?" Yes":" No"})]}),r.jsxs("div",{className:"flex items-center justify-between bg-white/60 rounded-lg p-2 border",children:[r.jsx("span",{className:"text-sm text-gray-700",children:"Doctorate with Dissertation:"}),r.jsx("span",{className:`text-sm font-medium ${e.doctorate_with_dissertation===1?"text-green-600":"text-gray-500"}`,children:e.doctorate_with_dissertation===1?" Yes":" No"})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(bn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Salary Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Annual Basic Salary"}),e.annual_basic_salary&&r.jsx("p",{className:"text-2xl font-bold text-amber-900",children:hq(e.annual_basic_salary)}),r.jsxs("p",{className:"text-xs text-gray-600",children:["Salary Grade: ",d(e.ssl_salary_grade,"Not assigned")]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Leave Status"}),r.jsx("div",{className:`inline-flex items-center px-3 py-2 rounded-lg font-semibold ${e.on_leave_without_pay===1?"bg-red-100 text-red-800 border border-red-300":"bg-green-100 text-green-800 border border-green-300"}`,children:e.on_leave_without_pay===1?"On Leave":"Active"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Teaching Disciplines"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Teaching Load Disciplines"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-xs text-gray-600",children:"Primary:"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.discipline_teaching_load_1)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-xs text-gray-600",children:"Secondary:"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.discipline_teaching_load_2)})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Degree Disciplines"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-xs text-gray-600",children:"Bachelors:"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.discipline_bachelors)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-xs text-gray-600",children:"Masters:"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.discipline_masters)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-xs text-gray-600",children:"Doctorate:"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.discipline_doctorate)})]})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-cyan-100 rounded-xl p-4 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-indigo-500 rounded-lg shadow-sm",children:r.jsx(Bl,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Undergraduate Teaching"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Units"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lecture"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.undergrad_lecture_credit_units)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lab"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.undergrad_lab_credit_units)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border border-indigo-300",children:[r.jsx("div",{className:"text-xs text-indigo-600",children:"Total"}),r.jsx("div",{className:"text-sm font-semibold text-indigo-900",children:p(e.undergrad_total_credit_units)})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hours per Week"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lecture"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.undergrad_lecture_hours_per_week)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lab"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.undergrad_lab_hours_per_week)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border border-indigo-300",children:[r.jsx("div",{className:"text-xs text-indigo-600",children:"Total"}),r.jsx("div",{className:"text-sm font-semibold text-indigo-900",children:p(e.undergrad_total_hours_per_week)})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Hours"}),r.jsx("div",{className:"bg-white/60 rounded-lg p-2 border border-indigo-300",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-lg font-bold text-indigo-900",children:p(e.undergrad_total_contact_hours)}),r.jsx("div",{className:"text-xs text-indigo-600",children:"Total Contact Hours"})]})})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-rose-50 via-pink-50 to-red-100 rounded-xl p-4 border border-rose-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-rose-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduate Teaching"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Units"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lecture"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.graduate_lecture_credit_units)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lab"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.graduate_lab_credit_units)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border border-rose-300",children:[r.jsx("div",{className:"text-xs text-rose-600",children:"Total"}),r.jsx("div",{className:"text-sm font-semibold text-rose-900",children:p(e.graduate_total_credit_units)})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Hours"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lecture"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.graduate_lecture_contact_hours)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border",children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Lab"}),r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:p(e.graduate_lab_contact_hours)})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-2 border border-rose-300",children:[r.jsx("div",{className:"text-xs text-rose-600",children:"Total"}),r.jsx("div",{className:"text-sm font-semibold text-rose-900",children:p(e.graduate_total_contact_hours)})]})]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Teaching Load Summary"}),r.jsxs("div",{className:"text-lg font-bold text-rose-900",children:[h()," Total Units"]}),r.jsxs("div",{className:"text-sm text-gray-600",children:[f()," Contact Hours"]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-teal-50 via-cyan-50 to-blue-100 rounded-xl p-4 border border-teal-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-teal-500 rounded-lg shadow-sm",children:r.jsx(Ug,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Additional Workload"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[{label:"Research",value:e.research_load,color:"bg-purple-100 text-purple-800 border-purple-300"},{label:"Extension",value:e.extension_services_load,color:"bg-green-100 text-green-800 border-green-300"},{label:"Study",value:e.study_load,color:"bg-blue-100 text-blue-800 border-blue-300"},{label:"Production",value:e.production_load,color:"bg-orange-100 text-orange-800 border-orange-300"},{label:"Admin",value:e.administrative_load,color:"bg-red-100 text-red-800 border-red-300"},{label:"Other",value:e.other_load_credits,color:"bg-gray-100 text-gray-800 border-gray-300"}].map((x,b)=>r.jsxs("div",{className:`p-3 rounded-lg border text-center ${x.color}`,children:[r.jsx("div",{className:"text-lg font-bold",children:p(x.value)}),r.jsx("div",{className:"text-xs font-medium",children:x.label})]},b))}),r.jsx("div",{className:"text-center",children:r.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border-2 border-teal-300",children:[r.jsx("div",{className:"text-3xl font-bold text-teal-900",children:p(e.total_work_load)}),r.jsx("div",{className:"text-sm font-semibold text-teal-700",children:"Total Workload"}),r.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Teaching: ",h()," units | Other: ",p(e.total_work_load)-h()," units"]})]})})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-gray-50 to-slate-100 rounded-xl p-4 border border-gray-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-gray-600 rounded-lg shadow-sm",children:r.jsx(ys,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Record Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Record ID"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.id)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Report Year"}),r.jsx("p",{className:"text-sm text-gray-900",children:g(e.report_year)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Faculty Type Code"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.faculty_type)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"SUC Details ID"}),r.jsx("p",{className:"text-sm text-gray-900",children:d(e.suc_details_id)})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Summary"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-2",children:[r.jsxs("div",{className:"text-center bg-blue-50 p-3 rounded-lg border",children:[r.jsx("div",{className:"text-lg font-bold text-blue-900",children:h()}),r.jsx("div",{className:"text-xs text-blue-600",children:"Teaching Units"})]}),r.jsxs("div",{className:"text-center bg-purple-50 p-3 rounded-lg border",children:[r.jsx("div",{className:"text-lg font-bold text-purple-900",children:p(e.research_load)+p(e.extension_services_load)}),r.jsx("div",{className:"text-xs text-purple-600",children:"Research & Extension"})]}),r.jsxs("div",{className:"text-center bg-orange-50 p-3 rounded-lg border",children:[r.jsx("div",{className:"text-lg font-bold text-orange-900",children:p(e.administrative_load)}),r.jsx("div",{className:"text-xs text-orange-600",children:"Administrative Load"})]})]})]})]})]})]})})};nN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,facultyData:B.shape({id:B.oneOfType([B.string,B.number]),suc_details_id:B.oneOfType([B.string,B.number]),name:B.string,generic_faculty_rank:B.string,home_college:B.string,home_department:B.string,is_tenured:B.oneOfType([B.string,B.number]),ssl_salary_grade:B.oneOfType([B.string,B.number]),annual_basic_salary:B.oneOfType([B.string,B.number]),on_leave_without_pay:B.oneOfType([B.string,B.number]),full_time_equivalent:B.oneOfType([B.string,B.number]),gender:B.string,highest_degree_attained:B.string,pursuing_next_degree:B.oneOfType([B.string,B.number]),discipline_teaching_load_1:B.string,discipline_teaching_load_2:B.string,discipline_bachelors:B.string,discipline_masters:B.string,discipline_doctorate:B.string,masters_with_thesis:B.oneOfType([B.string,B.number]),doctorate_with_dissertation:B.oneOfType([B.string,B.number]),undergrad_lab_credit_units:B.oneOfType([B.string,B.number]),undergrad_lecture_credit_units:B.oneOfType([B.string,B.number]),undergrad_total_credit_units:B.oneOfType([B.string,B.number]),undergrad_lab_hours_per_week:B.oneOfType([B.string,B.number]),undergrad_lecture_hours_per_week:B.oneOfType([B.string,B.number]),undergrad_total_hours_per_week:B.oneOfType([B.string,B.number]),undergrad_lab_contact_hours:B.oneOfType([B.string,B.number]),undergrad_lecture_contact_hours:B.oneOfType([B.string,B.number]),undergrad_total_contact_hours:B.oneOfType([B.string,B.number]),graduate_lab_credit_units:B.oneOfType([B.string,B.number]),graduate_lecture_credit_units:B.oneOfType([B.string,B.number]),graduate_total_credit_units:B.oneOfType([B.string,B.number]),graduate_lab_contact_hours:B.oneOfType([B.string,B.number]),graduate_lecture_contact_hours:B.oneOfType([B.string,B.number]),graduate_total_contact_hours:B.oneOfType([B.string,B.number]),research_load:B.oneOfType([B.string,B.number]),extension_services_load:B.oneOfType([B.string,B.number]),study_load:B.oneOfType([B.string,B.number]),production_load:B.oneOfType([B.string,B.number]),administrative_load:B.oneOfType([B.string,B.number]),other_load_credits:B.oneOfType([B.string,B.number]),total_work_load:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number]),faculty_type:B.string})};const iN=({isOpen:t,onClose:s,onSave:e,institutionId:a})=>{const{formData:n,errors:i,handleInputChange:c,validateForm:l,facultyRankOptions:u,tenuredOptions:o,annualSalaryOptions:d,onLeavePayOptions:g,fullTimeEquivalentOptions:p,genderOptions:h,highestDegreeOptions:f,pursuingNextDegreeOptions:x,thesisOptions:b,dissertationOptions:v,facultyTypeOptions:_,resetForm:N}=eb(a),E=F=>{if(F.preventDefault(),!l())return;const z={...n};["annual_basic_salary","ssl_salary_grade","full_time_equivalent","on_leave_without_pay","pursuing_next_degree","masters_with_thesis","doctorate_with_dissertation","undergrad_lab_credit_units","undergrad_lecture_credit_units","undergrad_total_credit_units","undergrad_lab_hours_per_week","undergrad_lecture_hours_per_week","undergrad_total_hours_per_week","undergrad_lab_contact_hours","undergrad_lecture_contact_hours","undergrad_total_contact_hours","graduate_lab_credit_units","graduate_lecture_credit_units","graduate_total_credit_units","graduate_lab_contact_hours","graduate_lecture_contact_hours","graduate_total_contact_hours","research_load","extension_services_load","study_load","production_load","administrative_load","other_load_credits","total_work_load","report_year"].forEach(U=>{z[U]=z[U]===""?"":parseFloat(z[U])||0}),e(z)},O=()=>{N(),s()};return r.jsx(mr,{isOpen:t,onClose:O,title:"Add Faculty Member",subtitle:"Create a new faculty record",icon:Er,variant:"form",size:"xl",children:r.jsx("div",{className:"space-y-6 max-h-[600px] overflow-y-auto p-4 ",children:r.jsxs("form",{onSubmit:E,children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl m-2 p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Personal Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Full Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:n.name,onChange:F=>c("name",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.name?"border-red-300 bg-red-50":"border-gray-300"}`,required:!0}),i.name&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.name]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gender ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:n.gender,onChange:F=>c("gender",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.gender?"border-red-300 bg-red-50":"border-gray-300"}`,required:!0,children:[r.jsx("option",{value:"",children:"Select Gender"}),h.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.gender&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.gender]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty Rank"}),r.jsxs("select",{value:n.generic_faculty_rank,onChange:F=>c("generic_faculty_rank",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.generic_faculty_rank?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Faculty Rank"}),u.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.generic_faculty_rank&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.generic_faculty_rank]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Faculty Type ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:n.faculty_type,onChange:F=>c("faculty_type",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.faculty_type?"border-red-300 bg-red-50":"border-gray-300"}`,required:!0,children:[r.jsx("option",{value:"",children:"Select Faculty Type"}),_.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.faculty_type&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.faculty_type]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tenure Status"}),r.jsxs("select",{value:n.is_tenured,onChange:F=>c("is_tenured",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.is_tenured?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Tenure Status"}),o.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.is_tenured&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.is_tenured]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salary Grade"}),r.jsx("input",{type:"number",value:n.ssl_salary_grade,onChange:F=>c("ssl_salary_grade",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.ssl_salary_grade?"border-red-300 bg-red-50":"border-gray-300"}`,min:"1",max:"33"}),i.ssl_salary_grade&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.ssl_salary_grade]})]})]})]}),r.jsxs("div",{className:"grid m-2 grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(Ya,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Department & Position"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Home College"}),r.jsx("input",{type:"text",value:n.home_college,onChange:F=>c("home_college",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.home_college?"border-red-300 bg-red-50":"border-gray-300"}`}),i.home_college&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.home_college]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Home Department"}),r.jsx("input",{type:"text",value:n.home_department,onChange:F=>c("home_department",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.home_department?"border-red-300 bg-red-50":"border-gray-300"}`}),i.home_department&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.home_department]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full-Time Equivalent"}),r.jsxs("select",{value:n.full_time_equivalent,onChange:F=>c("full_time_equivalent",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.full_time_equivalent?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select FTE"}),p.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.full_time_equivalent&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.full_time_equivalent]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"On Leave Without Pay"}),r.jsxs("select",{value:n.on_leave_without_pay,onChange:F=>c("on_leave_without_pay",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.on_leave_without_pay?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Leave Status"}),g.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.on_leave_without_pay&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.on_leave_without_pay]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br m-2 from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(bn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Salary Information"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Basic Salary"}),r.jsxs("select",{value:n.annual_basic_salary,onChange:F=>c("annual_basic_salary",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.annual_basic_salary?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Annual Basic Salary"}),d.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.annual_basic_salary&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.annual_basic_salary]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Year"}),r.jsx("input",{type:"number",value:n.report_year,onChange:F=>c("report_year",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.report_year?"border-red-300 bg-red-50":"border-gray-300"}`,min:"2020",max:"2030"}),i.report_year&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.report_year]})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Total Workload:"}),r.jsxs("div",{className:"text-lg font-bold text-amber-900",children:[n.total_work_load||0," units"]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br m-2 from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Academic Qualifications"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Highest Degree Attained ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:n.highest_degree_attained,onChange:F=>c("highest_degree_attained",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.highest_degree_attained?"border-red-300 bg-red-50":"border-gray-300"}`,required:!0,children:[r.jsx("option",{value:"",children:"Select Highest Degree"}),f.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.highest_degree_attained&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.highest_degree_attained]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pursuing Next Degree"}),r.jsxs("select",{value:n.pursuing_next_degree,onChange:F=>c("pursuing_next_degree",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.pursuing_next_degree?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Status"}),x.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.pursuing_next_degree&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.pursuing_next_degree]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Masters with Thesis"}),r.jsxs("select",{value:n.masters_with_thesis,onChange:F=>c("masters_with_thesis",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.masters_with_thesis?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Option"}),b.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.masters_with_thesis&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.masters_with_thesis]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Doctorate with Dissertation"}),r.jsxs("select",{value:n.doctorate_with_dissertation,onChange:F=>c("doctorate_with_dissertation",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${i.doctorate_with_dissertation?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Option"}),v.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))]}),i.doctorate_with_dissertation&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.doctorate_with_dissertation]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Teaching Discipline"}),r.jsx("input",{type:"text",value:n.discipline_teaching_load_1,onChange:F=>c("discipline_teaching_load_1",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.discipline_teaching_load_1?"border-red-300 bg-red-50":"border-gray-300"}`}),i.discipline_teaching_load_1&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.discipline_teaching_load_1]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secondary Teaching Discipline"}),r.jsx("input",{type:"text",value:n.discipline_teaching_load_2,onChange:F=>c("discipline_teaching_load_2",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.discipline_teaching_load_2?"border-red-300 bg-red-50":"border-gray-300"}`}),i.discipline_teaching_load_2&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.discipline_teaching_load_2]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bachelor's Discipline"}),r.jsx("input",{type:"text",value:n.discipline_bachelors,onChange:F=>c("discipline_bachelors",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.discipline_bachelors?"border-red-300 bg-red-50":"border-gray-300"}`}),i.discipline_bachelors&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.discipline_bachelors]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Master's Discipline"}),r.jsx("input",{type:"text",value:n.discipline_masters,onChange:F=>c("discipline_masters",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.discipline_masters?"border-red-300 bg-red-50":"border-gray-300"}`}),i.discipline_masters&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.discipline_masters]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Doctorate Discipline"}),r.jsx("input",{type:"text",value:n.discipline_doctorate,onChange:F=>c("discipline_doctorate",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.discipline_doctorate?"border-red-300 bg-red-50":"border-gray-300"}`}),i.discipline_doctorate&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.discipline_doctorate]})]})]})]})]}),r.jsxs("div",{className:"grid m-2 grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-cyan-100 rounded-xl p-4 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsxs("div",{className:"p-2 bg-indigo-500 rounded-lg shadow-sm",children:[r.jsx(Er,{className:"w-5 h-5 text-white"})," "]}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Undergraduate Teaching"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab Units"}),r.jsx("input",{type:"number",value:n.undergrad_lab_credit_units,onChange:F=>c("undergrad_lab_credit_units",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.undergrad_lab_credit_units?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.undergrad_lab_credit_units&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.undergrad_lab_credit_units]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lecture Units"}),r.jsx("input",{type:"number",value:n.undergrad_lecture_credit_units,onChange:F=>c("undergrad_lecture_credit_units",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.undergrad_lecture_credit_units?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.undergrad_lecture_credit_units&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.undergrad_lecture_credit_units]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Units"}),r.jsx("input",{type:"number",value:n.undergrad_total_credit_units||0,readOnly:!0,className:"w-full px-3 py-2 border border-indigo-300 rounded-lg bg-indigo-50 text-indigo-900 font-semibold"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab Hours/Week"}),r.jsx("input",{type:"number",value:n.undergrad_lab_hours_per_week,onChange:F=>c("undergrad_lab_hours_per_week",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.undergrad_lab_hours_per_week?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.undergrad_lab_hours_per_week&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.undergrad_lab_hours_per_week]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lecture Hours/Week"}),r.jsx("input",{type:"number",value:n.undergrad_lecture_hours_per_week,onChange:F=>c("undergrad_lecture_hours_per_week",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.undergrad_lecture_hours_per_week?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.undergrad_lecture_hours_per_week&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.undergrad_lecture_hours_per_week]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Hours/Week"}),r.jsx("input",{type:"number",value:n.undergrad_total_hours_per_week||0,readOnly:!0,className:"w-full px-3 py-2 border border-indigo-300 rounded-lg bg-indigo-50 text-indigo-900 font-semibold"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab Contact Hours"}),r.jsx("input",{type:"number",value:n.undergrad_lab_contact_hours,onChange:F=>c("undergrad_lab_contact_hours",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.undergrad_lab_contact_hours?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.undergrad_lab_contact_hours&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.undergrad_lab_contact_hours]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lecture Contact Hours"}),r.jsx("input",{type:"number",value:n.undergrad_lecture_contact_hours,onChange:F=>c("undergrad_lecture_contact_hours",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.undergrad_lecture_contact_hours?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.undergrad_lecture_contact_hours&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.undergrad_lecture_contact_hours]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Contact Hours"}),r.jsx("input",{type:"number",value:n.undergrad_total_contact_hours||0,readOnly:!0,className:"w-full px-3 py-2 border border-indigo-300 rounded-lg bg-indigo-50 text-indigo-900 font-semibold"})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br m-2 from-rose-50 via-pink-50 to-red-100 rounded-xl p-4 border border-rose-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsxs("div",{className:"p-2 bg-rose-500 rounded-lg shadow-sm",children:[r.jsx(Er,{className:"w-5 h-5 text-white"})," "]}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduate Teaching"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab Units"}),r.jsx("input",{type:"number",value:n.graduate_lab_credit_units,onChange:F=>c("graduate_lab_credit_units",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.graduate_lab_credit_units?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.graduate_lab_credit_units&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.graduate_lab_credit_units]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lecture Units"}),r.jsx("input",{type:"number",value:n.graduate_lecture_credit_units,onChange:F=>c("graduate_lecture_credit_units",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.graduate_lecture_credit_units?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.graduate_lecture_credit_units&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.graduate_lecture_credit_units]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Units"}),r.jsx("input",{type:"number",value:n.graduate_total_credit_units||0,readOnly:!0,className:"w-full px-3 py-2 border border-rose-300 rounded-lg bg-rose-50 text-rose-900 font-semibold"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab Contact Hours"}),r.jsx("input",{type:"number",value:n.graduate_lab_contact_hours,onChange:F=>c("graduate_lab_contact_hours",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.graduate_lab_contact_hours?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.graduate_lab_contact_hours&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.graduate_lab_contact_hours]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lecture Contact Hours"}),r.jsx("input",{type:"number",value:n.graduate_lecture_contact_hours,onChange:F=>c("graduate_lecture_contact_hours",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.graduate_lecture_contact_hours?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.graduate_lecture_contact_hours&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.graduate_lecture_contact_hours]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Contact Hours"}),r.jsx("input",{type:"number",value:n.graduate_total_contact_hours||0,readOnly:!0,className:"w-full px-3 py-2 border border-rose-300 rounded-lg bg-rose-50 text-rose-900 font-semibold"})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br m-2 from-teal-50 via-cyan-50 to-blue-100 rounded-xl p-4 border border-teal-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsxs("div",{className:"p-2 bg-teal-500 rounded-lg shadow-sm",children:[r.jsx(Er,{className:"w-5 h-5 text-white"})," "]}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Additional Workload"})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Research Load"}),r.jsx("input",{type:"number",value:n.research_load,onChange:F=>c("research_load",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.research_load?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.research_load&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.research_load]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Extension Services"}),r.jsx("input",{type:"number",value:n.extension_services_load,onChange:F=>c("extension_services_load",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.extension_services_load?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.extension_services_load&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.extension_services_load]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Study Load"}),r.jsx("input",{type:"number",value:n.study_load,onChange:F=>c("study_load",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.study_load?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.study_load&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.study_load]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Production Load"}),r.jsx("input",{type:"number",value:n.production_load,onChange:F=>c("production_load",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.production_load?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.production_load&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.production_load]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Administrative Load"}),r.jsx("input",{type:"number",value:n.administrative_load,onChange:F=>c("administrative_load",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.administrative_load?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.administrative_load&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.administrative_load]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other Load Credits"}),r.jsx("input",{type:"number",value:n.other_load_credits,onChange:F=>c("other_load_credits",F.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i.other_load_credits?"border-red-300 bg-red-50":"border-gray-300"}`,min:"0",step:"0.5"}),i.other_load_credits&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),i.other_load_credits]})]})]}),r.jsx("div",{className:"mt-4",children:r.jsx("div",{className:"bg-white/80 rounded-lg p-4 border-2 border-teal-300",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-teal-900",children:n.total_work_load||0}),r.jsx("div",{className:"text-sm font-semibold text-teal-700",children:"Total Workload"}),r.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Teaching: ",(n.undergrad_total_credit_units||0)+(n.graduate_total_credit_units||0)," units | Other: ",(n.total_work_load||0)-((n.undergrad_total_credit_units||0)+(n.graduate_total_credit_units||0))," units"]})]})})})]}),Object.keys(i).length>0&&Object.keys(i).filter(F=>i[F]!==null).length>0&&r.jsxs("div",{className:"bg-red-50 border m-2 border-red-200 rounded-xl p-4",children:[r.jsxs("div",{className:"flex items-center mb-2",children:[r.jsx(Ht,{className:"w-5 h-5 text-red-600 mr-2"}),r.jsx("h4",{className:"text-sm font-semibold text-red-800",children:"Please correct the following errors:"})]}),r.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:Object.entries(i).map(([F,z])=>z&&r.jsxs("li",{className:"flex items-center",children:[r.jsx("span",{className:"w-2 h-2 bg-red-400 rounded-full mr-2"}),z]},F))})]}),r.jsxs("div",{className:"flex justify-end space-x-3  m-2",children:[r.jsx("button",{type:"button",onClick:O,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Save"})]})]})})})};iN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired};const tb=({isOpen:t,onClose:s,onSave:e,facultyData:a,loading:n})=>{const{formData:i,errors:c,handleInputChange:l,validateForm:u,facultyRankOptions:o,tenuredOptions:d,annualSalaryOptions:g,onLeavePayOptions:p,fullTimeEquivalentOptions:h,genderOptions:f,highestDegreeOptions:x,pursuingNextDegreeOptions:b,thesisOptions:v,dissertationOptions:_,facultyTypeOptions:N}=eb(a==null?void 0:a.suc_details_id);ne.useEffect(()=>{a&&t&&Object.entries(a).forEach(([z,P])=>{l(z,P)})},[a,t]);const E=z=>{if(z.preventDefault(),!u())return;const P={...i};["annual_basic_salary","ssl_salary_grade","full_time_equivalent","on_leave_without_pay","pursuing_next_degree","masters_with_thesis","doctorate_with_dissertation","undergrad_lab_credit_units","undergrad_lecture_credit_units","undergrad_total_credit_units","undergrad_lab_hours_per_week","undergrad_lecture_hours_per_week","undergrad_total_hours_per_week","undergrad_lab_contact_hours","undergrad_lecture_contact_hours","undergrad_total_contact_hours","graduate_lab_credit_units","graduate_lecture_credit_units","graduate_total_credit_units","graduate_lab_contact_hours","graduate_lecture_contact_hours","graduate_total_contact_hours","research_load","extension_services_load","study_load","production_load","administrative_load","other_load_credits","total_work_load","report_year"].forEach(W=>{P[W]=parseFloat(P[W])||0}),e(P)},O=()=>{window.confirm("You have unsaved changes. Are you sure you want to close?")&&s()},F=({label:z,field:P,type:U="text",required:W=!1,options:Y=null,min:q,max:M,step:D})=>r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[z," ",W&&r.jsx("span",{className:"text-red-500",children:"*"})]}),Y?r.jsxs("select",{value:i[P]||"",onChange:T=>l(P,T.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors ${c[P]?"border-red-300 bg-red-50":"border-gray-300"}`,required:W,children:[r.jsxs("option",{value:"",children:["Select ",z]}),Y.map(T=>r.jsx("option",{value:T.value,children:T.label},T.value))]}):r.jsx("input",{type:U,value:i[P]||"",onChange:T=>l(P,T.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${c[P]?"border-red-300 bg-red-50":"border-gray-300"}`,required:W,min:q,max:M,step:D}),c[P]&&r.jsxs("div",{className:"flex items-center mt-1 text-red-600 text-sm",children:[r.jsx(Ht,{className:"w-4 h-4 mr-1"}),c[P]]})]});return F.propTypes={label:B.string.isRequired,field:B.string.isRequired,type:B.string,required:B.bool,options:B.arrayOf(B.shape({value:B.oneOfType([B.string,B.number]).isRequired,label:B.string.isRequired})),min:B.oneOfType([B.string,B.number]),max:B.oneOfType([B.string,B.number]),step:B.oneOfType([B.string,B.number])},F.defaultProps={type:"text",required:!1,options:null},a?r.jsx(mr,{isOpen:t,onClose:O,title:`Edit Faculty: ${a.name||"Faculty Member"}`,subtitle:"Update faculty information",icon:Dr,variant:"form",size:"xl",children:r.jsxs("form",{onSubmit:E,className:"space-y-6 max-h-[600px] overflow-y-auto",children:[r.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Ht,{className:"w-5 h-5 text-amber-600 mr-2"}),r.jsx("span",{className:"text-sm text-amber-800 font-medium",children:"You have unsaved changes"})]})}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Personal Information"}),r.jsxs("div",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded",children:["ID: ",a.id]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(F,{label:"Full Name",field:"name",required:!0}),r.jsx(F,{label:"Gender",field:"gender",required:!0,options:f}),r.jsx(F,{label:"Faculty Rank",field:"generic_faculty_rank",options:o}),r.jsx(F,{label:"Salary Grade",field:"ssl_salary_grade",type:"number",min:"1",max:"33"}),r.jsx(F,{label:"Faculty Type",field:"faculty_type",required:!0,options:N}),r.jsx(F,{label:"Tenure Status",field:"is_tenured",options:d})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(Ya,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Department & Position"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(F,{label:"Home College",field:"home_college"}),r.jsx(F,{label:"Home Department",field:"home_department"}),r.jsx(F,{label:"Full-Time Equivalent",field:"full_time_equivalent",options:h}),r.jsx(F,{label:"On Leave Without Pay",field:"on_leave_without_pay",options:p})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(bn,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Salary Information"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(F,{label:"Annual Basic Salary",field:"annual_basic_salary",options:g}),r.jsx(F,{label:"Report Year",field:"report_year",type:"number",min:"2020",max:"2030"}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Total Workload:"}),r.jsxs("div",{className:"text-lg font-bold text-amber-900",children:[i.total_work_load||0," units"]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Academic Qualifications"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx(F,{label:"Highest Degree Attained",field:"highest_degree_attained",required:!0,options:x}),r.jsx(F,{label:"Pursuing Next Degree",field:"pursuing_next_degree",options:b}),r.jsx(F,{label:"Masters with Thesis",field:"masters_with_thesis",options:v}),r.jsx(F,{label:"Doctorate with Dissertation",field:"doctorate_with_dissertation",options:_})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(F,{label:"Primary Teaching Discipline",field:"discipline_teaching_load_1"}),r.jsx(F,{label:"Secondary Teaching Discipline",field:"discipline_teaching_load_2"}),r.jsx(F,{label:"Bachelor's Discipline",field:"discipline_bachelors"}),r.jsx(F,{label:"Master's Discipline",field:"discipline_masters"}),r.jsx(F,{label:"Doctorate Discipline",field:"discipline_doctorate"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-cyan-100 rounded-xl p-4 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-indigo-500 rounded-lg shadow-sm",children:r.jsx(Bl,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Undergraduate Teaching"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsx(F,{label:"Lab Units",field:"undergrad_lab_credit_units",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Lecture Units",field:"undergrad_lecture_credit_units",type:"number",min:"0",step:"0.5"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Units"}),r.jsx("input",{type:"number",value:i.undergrad_total_credit_units||0,readOnly:!0,className:"w-full px-3 py-2 border border-rose-300 rounded-lg bg-rose-50 text-rose-900 font-semibold"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsx(F,{label:"Lab Contact Hours",field:"undergrad_lab_contact_hours",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Lecture Contact Hours",field:"undergrad_lecture_contact_hours",type:"number",min:"0",step:"0.5"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Contact Hours"}),r.jsx("input",{type:"number",value:i.undergrad_total_contact_hours||0,readOnly:!0,className:"w-full px-3 py-2 border border-rose-300 rounded-lg bg-rose-50 text-rose-900 font-semibold"})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-rose-50 via-pink-50 to-red-100 rounded-xl p-4 border border-rose-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-rose-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduate Teaching"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsx(F,{label:"Lab Units",field:"graduate_lab_credit_units",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Lecture Units",field:"graduate_lecture_credit_units",type:"number",min:"0",step:"0.5"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Units"}),r.jsx("input",{type:"number",value:i.graduate_total_credit_units||0,readOnly:!0,className:"w-full px-3 py-2 border border-rose-300 rounded-lg bg-rose-50 text-rose-900 font-semibold"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsx(F,{label:"Lab Contact Hours",field:"graduate_lab_contact_hours",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Lecture Contact Hours",field:"graduate_lecture_contact_hours",type:"number",min:"0",step:"0.5"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Contact Hours"}),r.jsx("input",{type:"number",value:i.graduate_total_contact_hours||0,readOnly:!0,className:"w-full px-3 py-2 border border-rose-300 rounded-lg bg-rose-50 text-rose-900 font-semibold"})]})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-teal-50 via-cyan-50 to-blue-100 rounded-xl p-4 border border-teal-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-teal-500 rounded-lg shadow-sm",children:r.jsx(Ug,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Additional Workload"})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[r.jsx(F,{label:"Research Load",field:"research_load",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Extension Services",field:"extension_services_load",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Study Load",field:"study_load",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Production Load",field:"production_load",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Administrative Load",field:"administrative_load",type:"number",min:"0",step:"0.5"}),r.jsx(F,{label:"Other Load Credits",field:"other_load_credits",type:"number",min:"0",step:"0.5"})]}),r.jsx("div",{className:"mt-4",children:r.jsx("div",{className:"bg-white/80 rounded-lg p-4 border-2 border-teal-300",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-teal-900",children:i.total_work_load||0}),r.jsx("div",{className:"text-sm font-semibold text-teal-700",children:"Total Workload"}),r.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Teaching: ",(i.undergrad_total_credit_units||0)+(i.graduate_total_credit_units||0)," units | Other: ",(i.total_work_load||0)-((i.undergrad_total_credit_units||0)+(i.graduate_total_credit_units||0))," units"]})]})})})]}),r.jsx("div",{className:"bg-gradient-to-br from-gray-50 via-gray-50 to-slate-100 rounded-xl p-4 border border-gray-200/60 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[r.jsx(ys,{className:"w-4 h-4"}),r.jsx("span",{children:"All required fields must be completed"})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("button",{type:"button",onClick:O,disabled:n,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[r.jsx(vs,{className:"w-4 h-4 mr-2 inline"}),"Cancel"]}),r.jsx("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm hover:shadow-md transition-all duration-200",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Updating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2 inline"}),"Update Faculty"]})})]})]})}),Object.keys(c).length>0&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[r.jsxs("div",{className:"flex items-center mb-2",children:[r.jsx(Ht,{className:"w-5 h-5 text-red-600 mr-2"}),r.jsx("h4",{className:"text-sm font-semibold text-red-800",children:"Please correct the following errors:"})]}),r.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:Object.entries(c).map(([z,P])=>r.jsxs("li",{className:"flex items-center",children:[r.jsx("span",{className:"w-2 h-2 bg-red-400 rounded-full mr-2"}),P]},z))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-gray-50 to-slate-100 rounded-xl p-4 border border-gray-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-gray-600 rounded-lg shadow-sm",children:r.jsx(ys,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Record Information"})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Record ID"}),r.jsx("p",{className:"text-sm text-gray-900 font-mono bg-gray-100 px-2 py-1 rounded",children:a.id})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"SUC Details ID"}),r.jsx("p",{className:"text-sm text-gray-900 font-mono bg-gray-100 px-2 py-1 rounded",children:a.suc_details_id})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),r.jsx("p",{className:"text-sm text-gray-900",children:a.created_at?new Date(a.created_at).toLocaleDateString():"N/A"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Updated"}),r.jsx("p",{className:"text-sm text-gray-900",children:a.updated_at?new Date(a.updated_at).toLocaleDateString():"N/A"})]})]})]})]})}):null};tb.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,facultyData:B.shape({id:B.oneOfType([B.string,B.number]),suc_details_id:B.oneOfType([B.string,B.number]),name:B.string,generic_faculty_rank:B.string,home_college:B.string,home_department:B.string,is_tenured:B.oneOfType([B.string,B.number]),ssl_salary_grade:B.oneOfType([B.string,B.number]),annual_basic_salary:B.oneOfType([B.string,B.number]),on_leave_without_pay:B.oneOfType([B.string,B.number]),full_time_equivalent:B.oneOfType([B.string,B.number]),gender:B.string,highest_degree_attained:B.string,pursuing_next_degree:B.oneOfType([B.string,B.number]),discipline_teaching_load_1:B.string,discipline_teaching_load_2:B.string,discipline_bachelors:B.string,discipline_masters:B.string,discipline_doctorate:B.string,masters_with_thesis:B.oneOfType([B.string,B.number]),doctorate_with_dissertation:B.oneOfType([B.string,B.number]),undergrad_lab_credit_units:B.oneOfType([B.string,B.number]),undergrad_lecture_credit_units:B.oneOfType([B.string,B.number]),undergrad_total_credit_units:B.oneOfType([B.string,B.number]),undergrad_lab_hours_per_week:B.oneOfType([B.string,B.number]),undergrad_lecture_hours_per_week:B.oneOfType([B.string,B.number]),undergrad_total_hours_per_week:B.oneOfType([B.string,B.number]),undergrad_lab_contact_hours:B.oneOfType([B.string,B.number]),undergrad_lecture_contact_hours:B.oneOfType([B.string,B.number]),undergrad_total_contact_hours:B.oneOfType([B.string,B.number]),graduate_lab_credit_units:B.oneOfType([B.string,B.number]),graduate_lecture_credit_units:B.oneOfType([B.string,B.number]),graduate_total_credit_units:B.oneOfType([B.string,B.number]),graduate_lab_contact_hours:B.oneOfType([B.string,B.number]),graduate_lecture_contact_hours:B.oneOfType([B.string,B.number]),graduate_total_contact_hours:B.oneOfType([B.string,B.number]),research_load:B.oneOfType([B.string,B.number]),extension_services_load:B.oneOfType([B.string,B.number]),study_load:B.oneOfType([B.string,B.number]),production_load:B.oneOfType([B.string,B.number]),administrative_load:B.oneOfType([B.string,B.number]),other_load_credits:B.oneOfType([B.string,B.number]),total_work_load:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number]),faculty_type:B.string,created_at:B.string,updated_at:B.string}),loading:B.bool};tb.defaultProps={loading:!1,facultyData:null};function oN({isOpen:t,onClose:s,institutionId:e}){const[a,n]=ne.useState(!1),[i,c]=ne.useState({}),[l,u]=ne.useState(new Date().getFullYear()),{showLoading:o,hideLoading:d}=J0(),g=(x,b)=>{i[x]&&c(v=>({...v,[x]:""})),u(b)},p=()=>{const x={};return e||(x.institution="Institution ID is required"),l||(x.year="Please select a report year"),c(x),Object.keys(x).length===0},h=async x=>{var _,N;const b=x.target.files[0];if(!b)return;if(!p()){Ft.showAlert("Please ensure institution and year are properly set before uploading.","error");return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(b.type)&&!b.name.match(/\.(xlsx|xls|csv)$/i)){Ft.showAlert("Please upload a valid Excel file (.xlsx, .xls) or CSV file.","error");return}n(!0),o();try{const E=await b.arrayBuffer(),O=so(E,{cellStyles:!0,cellFormulas:!0,cellDates:!0,cellNF:!0,sheetStubs:!0,type:"array"}),F=O.SheetNames.filter(U=>!U.toLowerCase().includes("reference"));if(F.length===0)throw new Error("No valid faculty sheets found in the Excel file.");let z=[];for(const U of F){const W=O.Sheets[U],Y=Wo.sheet_to_json(W,{header:1,defval:""});z.push({sheet:U,rows:Y})}const P=localStorage.getItem("token");await bt.post(`${Ct.API_URL}/suc-form-e2/bulk-raw`,{institutionId:e,year:l,sheets:z},{headers:{Authorization:`Bearer ${P}`,"Content-Type":"application/json"}}),Ft.showAlert("Faculty data uploaded successfully! (Raw)","success"),s()}catch(E){console.error("Excel upload error:",E),Ft.showAlert(((N=(_=E.response)==null?void 0:_.data)==null?void 0:N.message)||E.message||"Failed to upload faculty data","error")}finally{n(!1),d(),x.target.value=""}},f=()=>{c({}),s()};return t?r.jsx(mr,{isOpen:t,onClose:f,title:"Upload Faculty Data",subtitle:"Import HEMIS Form E2 or faculty Excel files",icon:Qr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Upload Configuration"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution ID"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:e||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600",placeholder:"Institution ID will be auto-filled"}),i.institution&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.institution})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Report Year"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{value:l,onChange:x=>g("year",parseInt(x.target.value)),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${i.year?"border-red-300 bg-red-50":"border-gray-300"}`,children:Array.from({length:10},(x,b)=>{const v=new Date().getFullYear()-b;return r.jsx("option",{value:v,children:v},v)})}),i.year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.year})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(pi,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Excel Format Guidelines"})]}),r.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ys,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"HEMIS Form E2 Structure:"}),r.jsxs("ul",{className:"space-y-1 ml-2",children:[r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),'Data starts after "START BELOW THIS ROW" or header row']}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Only rows with a valid Faculty Name are processed"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Column A/B: Faculty Name (Required)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Column C: Faculty Rank"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns D-E: College & Department"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns F-K: Employment details (tenure, salary, gender)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns L-S: Academic qualifications"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns T-AO: Teaching load (undergraduate & graduate)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Columns AP-AV: Additional workload (research, extension, admin)"]})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(eo,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"Faculty Type Mapping:"}),r.jsxs("ul",{className:"space-y-1 ml-2 text-xs",children:[r.jsx("li",{children:"A1: Full-time with Plantilla Items"}),r.jsx("li",{children:"B: Full-time from PS Items on Leave"}),r.jsx("li",{children:"C1: Full-time from GAA PS Lump Sums"}),r.jsx("li",{children:"C2: Full-time from SUC Income"}),r.jsx("li",{children:"C3: Full-time from LGU Funds"}),r.jsx("li",{children:"E: Part-time Lecturers"})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ui,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"The system will automatically calculate totals for teaching loads and workload if not provided in the Excel file."})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(qr,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"Supported formats: .xlsx, .xls, and .csv files with faculty information"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($o,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"File Upload"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"file",id:"excel-upload",accept:".xlsx,.xls,.csv",onChange:h,disabled:a||!e,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),r.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200 ${!e||a?"border-gray-200 bg-gray-50/50":"border-slate-300 hover:border-slate-400 hover:bg-slate-50/50 bg-white"}`,children:[r.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${!e||a?"bg-gray-100":"bg-gradient-to-br from-slate-100 to-slate-200"}`,children:a?r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}):r.jsx(Qr,{className:`w-8 h-8 ${e?"text-slate-600":"text-gray-300"}`})}),r.jsx("p",{className:`text-lg font-semibold mb-2 ${!e||a?"text-gray-400":"text-gray-900"}`,children:a?"Processing File...":"Choose Excel File to Upload"}),r.jsx("p",{className:`text-sm mb-2 ${!e||a?"text-gray-400":"text-gray-600"}`,children:"Drag and drop or click to browse"}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-2",children:[r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:".xlsx"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:".xls"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:".csv"})]}),!e&&r.jsxs("div",{className:"flex items-center justify-center mt-3",children:[r.jsx(Ht,{className:"w-4 h-4 text-red-500 mr-1"}),r.jsx("span",{className:"text-sm text-red-500 font-medium",children:"Institution ID is required"})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(gr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Faculty Classification Reference"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-blue-800 mb-1",children:"Group A1"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty with their own plantilla items"})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-green-800 mb-1",children:"Group B"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty drawing from PS items of those on leave"})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-purple-800 mb-1",children:"Group C1"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty from GAA PS lump sums"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-orange-800 mb-1",children:"Group C2"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty from SUC income"})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-pink-800 mb-1",children:"Group C3"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Full-time faculty from LGU funds"})]}),r.jsxs("div",{className:"bg-white/60 rounded-lg p-3 border",children:[r.jsx("div",{className:"font-semibold text-yellow-800 mb-1",children:"Group E"}),r.jsx("p",{className:"text-gray-700 text-xs",children:"Part-time lecturers and faculty"})]})]})]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:r.jsx("button",{onClick:f,disabled:a,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:a?"Processing...":"Close"})})]})}):null}oN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired};const mq={10:"Master Teacher",20:"Instructor",30:"Asst. Prof.",40:"Assoc. Prof.",50:"Full Prof.",9:"Teaching Fellow",11:"Lecturer",12:"Prof. Emeritus",13:"Visiting Prof.",14:"Adjunct Faculty",90:"Others"},pq={1:"Tenured",2:"Not Tenured (Has Plantilla)",3:"No Plantilla",4:"No Info"},gq={1:"Grade 1-33",90:"No Grade (Part-time)",99:"No Info"},xq={1:"Below 60k",2:"60k-69,999",3:"70k-79,999",4:"80k-89,999",5:"90k-99,999",6:"100k-149,999",7:"150k-249,999",8:"250k-499,999",9:"500k+",99:"No Info"},bq={1:"Male",2:"Female"},yq={0:"None",101:"Partial Elem.",102:"Grade 4 Only",103:"Elem. Grad.",201:"Partial HS",202:"HS Grad.",301:"Partial HS",302:"Tech/Voc Grad.",401:"Partial Pre-bacc.",402:"Pre-bacc Grad.",501:"1st Yr College",502:"2nd Yr College",503:"3rd Yr College",504:"4th Yr College",505:"5th Yr College",506:"6th Yr College",507:"Bachelor's",601:"Partial Post-grad Cert.",602:"Post-grad Cert.",701:"1st Yr MD/LLB",702:"2nd Yr MD/LLB",703:"3rd Yr MD/LLB",704:"4th Yr MD/LLB",705:"MD/LLB Grad.",801:"Partial Master's",802:"Master's (No Thesis)",803:"Master's",901:"Partial Doctorate",902:"Doctorate (No Diss.)",903:"Doctorate",980:"Not Faculty",999:"No Record"};function vq(){var ie,ee;const{SucDetailId:t}=Ko(),s=Aa(),e=qs(),a=((ie=e.state)==null?void 0:ie.heiName)||"Unknown Institution",n=((ee=e.state)==null?void 0:ee.heiUiid)||"Unknown Uiid",[i,c]=ne.useState([]),[l,u]=ne.useState([]),[o,d]=ne.useState(!0),[g,p]=ne.useState(""),[h,f]=ne.useState(null),[x,b]=ne.useState(!1),[v,_]=ne.useState(!1),[N,E]=ne.useState(!1),[O,F]=ne.useState(!1),[z,P]=ne.useState(!1),[U,W]=ne.useState(!1),[Y,q]=ne.useState(!1),[M,D]=ne.useState(""),[T,C]=ne.useState("ALL"),[S,w]=ne.useState("ALL"),[j,A]=ne.useState(1),[L,I]=ne.useState(10);ne.useEffect(()=>{re()},[]),ne.useEffect(()=>{let te=i;M&&(te=te.filter(fe=>{var _e,Te,Ae,Fe,st;return((_e=fe.name)==null?void 0:_e.toLowerCase().includes(M.toLowerCase()))||((Te=fe.home_college)==null?void 0:Te.toLowerCase().includes(M.toLowerCase()))||((Ae=fe.home_department)==null?void 0:Ae.toLowerCase().includes(M.toLowerCase()))||((Fe=fe.generic_faculty_rank)==null?void 0:Fe.toLowerCase().includes(M.toLowerCase()))||((st=fe.highest_degree_attained)==null?void 0:st.toLowerCase().includes(M.toLowerCase()))})),T!=="ALL"&&(te=te.filter(fe=>fe.faculty_type===T)),S!=="ALL"&&(te=te.filter(fe=>fe.highest_degree_attained===S)),u(te),A(1)},[i,M,T,S]);const Z=ne.useMemo(()=>{const te=(j-1)*L,fe=te+L;return l.slice(te,fe)},[l,j,L]),K=Math.ceil(l.length/L),re=async()=>{if(!t){console.error("SucDetailId is undefined. Cannot fetch faculty."),p("Invalid institution ID. Please check the URL or try again."),d(!1);return}d(!0),p("");try{const te=await bt.get(`${Ct.API_URL}/suc-form-e2/suc-detail/${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}}),fe=Array.isArray(te.data)?te.data:te.data.data||[];c(fe),u(fe),console.log("Fetched faculty:",fe)}catch(te){console.error("Error fetching faculty:",te),p("Failed to load faculty data. Please try again.")}finally{d(!1)}},G=ne.useCallback(async()=>{try{q(!0),jr.fire({title:"Confirm Export",text:`Do you want to export Form E2 for ${a}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Export",cancelButtonText:"Cancel",customClass:{popup:"swal2-popup",title:"text-lg font-semibold text-gray-900",content:"text-gray-600"}}).then(async te=>{if(te.isConfirmed)try{const fe=await fetch("/templates/Form-E2-Themeplate.xlsx");if(!fe.ok)throw new Error(`HTTP error! Status: ${fe.status}`);const _e=await fe.arrayBuffer(),Te=new fd.Workbook;await Te.xlsx.load(_e);const Ae=(Tt,ut)=>{const jt=`GROUP ${ut}`;let Ke=Tt.getWorksheet(jt);if(!Ke)for(let Vt=0;Vt<Tt.worksheets.length;Vt++){const St=Tt.worksheets[Vt];if(St.name.toUpperCase()===jt.toUpperCase()){Ke=St;break}}return Ke},Fe=Te.worksheets[0];if(Fe&&Fe.name==="Faculty Data"){let Tt=!1;Fe.eachRow(ut=>{if(ut.eachCell(jt=>{if(jt.value)return Tt=!0,!1}),Tt)return!1}),(!Tt||st(Fe)!==-1)&&Te.removeWorksheet(Fe.id)}const st=Tt=>{let ut=-1;return Tt.eachRow((jt,Ke)=>{let Vt=!1;if(jt.eachCell(St=>{if(St.value&&String(St.value).trim()==="START BELOW THIS ROW")return Vt=!0,!1}),Vt)return ut=Ke+1,!1}),ut!==-1?ut:4},it={},yt=`FORM E-2: PROFILE OF EACH TERTIARY FACULTY IN AN SUC CAMPUS, as of ${new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}`;i.forEach(Tt=>{if(Tt.faculty_type&&Tt.faculty_type!=="Reference"){const ut=Tt.faculty_type.toUpperCase();it[ut]||(it[ut]=[]),it[ut].push(Tt)}});for(const Tt in it){const ut=Ae(Te,Tt);if(!ut){console.warn(`Worksheet named 'GROUP ${Tt}' (or case variation) not found in the Excel template. Skipping data for this faculty type.`);continue}ut.getCell("A1").value=yt,ut.getCell("A1").font={bold:!0},ut.getCell("A1").alignment={horizontal:"center"},ut.getCell("A2").value=`GROUP ${Tt}`,ut.getCell("A2").font={bold:!0},ut.getCell("A2").alignment={horizontal:"center"},ut.getCell("A3").value="SEQ",ut.getCell("B3").value="NAME",ut.getCell("C3").value="RANK",ut.getCell("D3").value="COLLEGE",ut.getCell("E3").value="DEPARTMENT",ut.getCell("F3").value="TENURED",ut.getCell("G3").value="SALARY GRADE",ut.getCell("H3").value="ANNUAL SALARY",ut.getCell("I3").value="ON LEAVE",ut.getCell("J3").value="FTE",ut.getCell("K3").value="GENDER",ut.getCell("L3").value="HIGHEST DEGREE",ut.getCell("M3").value="PURSUING DEGREE",ut.getCell("N3").value="DISCIPLINE 1",ut.getCell("O3").value="DISCIPLINE 2",ut.getCell("P3").value="BACHELORS DISCIPLINE",ut.getCell("Q3").value="MASTERS DISCIPLINE",ut.getCell("R3").value="DOCTORATE DISCIPLINE",ut.getCell("S3").value="MASTERS WITH THESIS",ut.getCell("T3").value="DOCTORATE WITH DISSERTATION",ut.getCell("U3").value="UNDERGRAD LAB UNITS",ut.getCell("V3").value="UNDERGRAD LECTURE UNITS",ut.getCell("W3").value="UNDERGRAD TOTAL UNITS",ut.getCell("X3").value="UNDERGRAD LAB HOURS",ut.getCell("Y3").value="UNDERGRAD LECTURE HOURS",ut.getCell("Z3").value="UNDERGRAD TOTAL HOURS",ut.getCell("AA3").value="UNDERGRAD LAB CONTACT",ut.getCell("AB3").value="UNDERGRAD LECTURE CONTACT",ut.getCell("AC3").value="UNDERGRAD TOTAL CONTACT",ut.getCell("AD3").value="GRADUATE LAB UNITS",ut.getCell("AE3").value="GRADUATE LECTURE UNITS",ut.getCell("AF3").value="GRADUATE TOTAL UNITS",ut.getCell("AG3").value="GRADUATE LAB CONTACT",ut.getCell("AH3").value="GRADUATE LECTURE CONTACT",ut.getCell("AI3").value="GRADUATE TOTAL CONTACT",ut.getCell("AJ3").value="RESEARCH LOAD",ut.getCell("AK3").value="EXTENSION LOAD",ut.getCell("AL3").value="STUDY LOAD",ut.getCell("AM3").value="PRODUCTION LOAD",ut.getCell("AN3").value="ADMIN LOAD",ut.getCell("AO3").value="OTHER LOAD",ut.getCell("AP3").value="TOTAL WORKLOAD",ut.getCell("AQ3").value="REPORT YEAR",ut.getCell("AR3").value="FACULTY TYPE";const jt=st(ut);for(let Ke=ut.rowCount;Ke>=jt;Ke--)ut.spliceRows(Ke,1);it[Tt].forEach((Ke,Vt)=>{const St=jt+Vt,et=ut.getRow(St),ot=(At,Re)=>{!At.formula&&!At.isPartOfSharedFormula&&(At.value=Re)};ot(et.getCell(1),Vt+1),ot(et.getCell(2),Ke.name||""),ot(et.getCell(3),Ke.generic_faculty_rank||""),ot(et.getCell(4),Ke.home_college||""),ot(et.getCell(5),Ke.home_department||""),ot(et.getCell(6),Ke.is_tenured||""),ot(et.getCell(7),Ke.ssl_salary_grade||""),ot(et.getCell(8),Ke.annual_basic_salary||0),ot(et.getCell(9),Ke.on_leave_without_pay||0),ot(et.getCell(10),Ke.full_time_equivalent||0),ot(et.getCell(11),Ke.gender||""),ot(et.getCell(12),Ke.highest_degree_attained||""),ot(et.getCell(13),Ke.pursuing_next_degree||0),ot(et.getCell(14),Ke.discipline_teaching_load_1||""),ot(et.getCell(15),Ke.discipline_teaching_load_2||""),ot(et.getCell(16),Ke.discipline_bachelors||""),ot(et.getCell(17),Ke.discipline_masters||""),ot(et.getCell(18),Ke.discipline_doctorate||""),ot(et.getCell(19),Ke.masters_with_thesis||0),ot(et.getCell(20),Ke.doctorate_with_dissertation||0),ot(et.getCell(21),Ke.undergrad_lab_credit_units||0),ot(et.getCell(22),Ke.undergrad_lecture_credit_units||0),ot(et.getCell(23),Ke.undergrad_total_credit_units||0),ot(et.getCell(24),Ke.undergrad_lab_hours_per_week||0),ot(et.getCell(25),Ke.undergrad_lecture_hours_per_week||0),ot(et.getCell(26),Ke.undergrad_total_hours_per_week||0),ot(et.getCell(27),Ke.undergrad_lab_contact_hours||0),ot(et.getCell(28),Ke.undergrad_lecture_contact_hours||0),ot(et.getCell(29),Ke.undergrad_total_contact_hours||0),ot(et.getCell(30),Ke.graduate_lab_credit_units||0),ot(et.getCell(31),Ke.graduate_lecture_credit_units||0),ot(et.getCell(32),Ke.graduate_total_credit_units||0),ot(et.getCell(33),Ke.graduate_lab_contact_hours||0),ot(et.getCell(34),Ke.graduate_lecture_contact_hours||0),ot(et.getCell(35),Ke.graduate_total_contact_hours||0),ot(et.getCell(36),Ke.research_load||0),ot(et.getCell(37),Ke.extension_services_load||0),ot(et.getCell(38),Ke.study_load||0),ot(et.getCell(39),Ke.production_load||0),ot(et.getCell(40),Ke.administrative_load||0),ot(et.getCell(41),Ke.other_load_credits||0),ot(et.getCell(42),Ke.total_work_load||0),ot(et.getCell(43),Ke.report_year||""),ot(et.getCell(44),Ke.faculty_type||""),et.commit()})}const vt=`${n}_${a.replace(/[^a-zA-Z0-9]/g,"_")}_FormE2_${new Date().toISOString().split("T")[0]}.xlsx`,Nt=await Te.xlsx.writeBuffer(),Mt=new Blob([Nt],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Et=window.URL.createObjectURL(Mt),_t=document.createElement("a");_t.href=Et,_t.download=vt,document.body.appendChild(_t),_t.click(),document.body.removeChild(_t),window.URL.revokeObjectURL(Et),jr.fire({title:"Success!",text:`Form E2 exported successfully with ${i.length} faculty members.`,icon:"success",timer:4e3,showConfirmButton:!1})}catch(fe){console.error("Error exporting Form E2:",fe),jr.fire({title:"Error!",text:"Failed to export Form E2. Please try again.",icon:"error",confirmButtonText:"OK"})}q(!1)})}catch(te){console.error("Error in export function:",te),q(!1)}},[i,a,n]),ae=()=>{F(!0)},V=te=>{f(te),b(!0)},H=te=>{f(te),E(!0)},Q=()=>{_(!0)},oe=async te=>{P(!0);try{const fe=await bt.post(`${Ct.API_URL}/suc-form-e2`,te,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(fe.status===201){const _e=fe.data;c(Te=>[...Te,_e]),_(!1),console.log("Faculty created successfully:",_e)}}catch(fe){console.error("Error creating faculty:",fe),p("Failed to create faculty record. Please try again.")}finally{P(!1)}},se=async te=>{W(!0);try{const fe=await bt.put(`${Ct.API_URL}/suc-form-e2/${te.id}`,te,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(fe.status===200){const _e=fe.data;c(Te=>Te.map(Ae=>Ae.id===_e.id?_e:Ae)),E(!1),f(null),console.log("Faculty updated successfully:",_e)}}catch(fe){console.error("Error updating faculty:",fe),p("Failed to update faculty record. Please try again.")}finally{W(!1)}},le=async te=>{try{(await bt.delete(`${Ct.API_URL}/suc-form-e2/${te}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}})).status===200&&(c(_e=>_e.filter(Te=>Te.id!==te)),console.log("Faculty deleted successfully."))}catch(fe){console.error("Error deleting faculty:",fe),p("Failed to delete faculty record. Please try again.")}},he=()=>{s("/super-admin/institutions/suc")},Ne=()=>{b(!1),f(null)},we=()=>{_(!1)},ue=()=>{E(!1),f(null)},Se=()=>{F(!1)},ke=te=>{if(!te)return"unknown";const fe=String(te).padStart(3,"0");return fe.startsWith("9")?"doctorate":fe.startsWith("8")?"master":fe.startsWith("5")||fe.startsWith("7")?"bachelor":"other"},Me=te=>{switch(ke(te)){case"doctorate":return"text-purple-700 bg-purple-100";case"master":return"text-blue-700 bg-blue-100";case"bachelor":return"text-green-700 bg-green-100";default:return"text-gray-700 bg-gray-100"}},Oe=te=>{A(te)},je=te=>{I(te),A(1)},Ie=()=>{const te=(j-1)*L+1,fe=Math.min(j*L,l.length);return{startIndex:te,endIndex:fe}},{startIndex:Pe,endIndex:He}=Ie(),ct=[...new Set(i.map(te=>te.highest_degree_attained).filter(Boolean))];return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:he,className:"mr-4 p-2 text-gray-600 hover:text-gray-900 hover:bg-white/50 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Back to SUC List",children:r.jsx(Zo,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Faculty Management"}),r.jsxs("p",{className:"text-gray-600 flex items-center",children:[r.jsx(Jr,{className:"w-4 h-4 mr-2"}),a]})]})]}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm mb-6",children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1 w-full xl:w-auto",children:[r.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search faculty...",value:M,onChange:te=>D(te.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-60 lg:w-80 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm transition-all duration-200"})]}),r.jsxs("div",{className:"relative w-full sm:w-auto",children:[r.jsx(zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsxs("select",{value:T,onChange:te=>C(te.target.value),className:"pl-10 pr-8 py-2 w-full sm:w-auto border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm appearance-none cursor-pointer transition-all duration-200",children:[r.jsx("option",{value:"ALL",children:"All Types"}),r.jsx("option",{value:"A1",children:"Group A1"}),r.jsx("option",{value:"B",children:"Group B"}),r.jsx("option",{value:"C1",children:"Group C1"}),r.jsx("option",{value:"C2",children:"Group C2"}),r.jsx("option",{value:"C3",children:"Group C3"}),r.jsx("option",{value:"E",children:"Group E"})]})]}),r.jsxs("div",{className:"relative w-full sm:w-auto",children:[r.jsx(gr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsxs("select",{value:S,onChange:te=>w(te.target.value),className:"pl-10 pr-8 py-2 w-full sm:w-auto border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm appearance-none cursor-pointer transition-all duration-200",children:[r.jsx("option",{value:"ALL",children:"All Degrees"}),ct.map(te=>r.jsx("option",{value:te,children:te},te))]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full xl:w-auto",children:[r.jsxs("button",{onClick:G,disabled:Y||i.length===0,className:"inline-flex items-center justify-center px-4 py-2 bg-white/50 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-white hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(oc,{className:"w-4 h-4 mr-2"}),Y?"Exporting...":"Export Form E2"]}),r.jsxs("button",{onClick:ae,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg text-sm font-medium hover:from-green-700 hover:to-green-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500",children:[r.jsx(Qr,{className:"w-4 h-4 mr-2"}),"Upload Excel"]}),r.jsxs("button",{onClick:Q,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Faculty"]})]})]}),r.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Qo,{className:"w-4 h-4 mr-1"}),"Showing"," ",l.length>0?Pe:0," ","to ",He," of ",l.length," ","faculty members",l.length!==i.length&&r.jsxs("span",{className:"text-blue-600 ml-1",children:["(filtered from ",i.length," ","total)"]})]})})]})})]}),g&&r.jsx("div",{className:"mb-6 p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(vs,{className:"w-5 h-5 mr-2"}),g]})}),o?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-8 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),r.jsx("span",{className:"text-gray-600 font-medium",children:"Loading faculty..."})]})})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl shadow-sm border border-white/20 overflow-hidden mb-6",children:[r.jsx("div",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50 border-b border-gray-200/50",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsx("table",{className:"min-w-full",children:r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Faculty Information"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Position & College"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Education & Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Work Load & Salary"}),r.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})})})})}),r.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsx("table",{className:"min-w-full",children:r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[Z.map((te,fe)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${fe%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-4 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-blue-100 to-blue-200 text-blue-700",children:r.jsx(Jr,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[r.jsx("div",{className:"text-sm font-semibold text-gray-900 text-wrap",title:te.name,children:te.name}),r.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[r.jsx(ir,{className:"w-3 h-3 mr-1"}),bq[te.gender]||te.gender]}),r.jsxs("div",{className:"text-xs text-gray-500 flex items-center mt-1",children:[r.jsx(Zr,{className:"w-3 h-3 mr-1"}),te.faculty_type||"Unknown"]}),r.jsx("div",{className:"text-xs text-gray-400 flex items-center mt-1",children:r.jsxs("span",{className:"font-mono",children:["ID: ",te.id]})})]})]})}),r.jsx("td",{className:"px-4 py-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:mq[te.generic_faculty_rank]||te.generic_faculty_rank||"Not assigned"}),r.jsxs("div",{className:"text-xs text-gray-600",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(qr,{className:"w-3 h-3 mr-1 text-blue-500"}),te.home_college||"No college"]}),r.jsxs("div",{className:"flex items-center mt-1",children:[r.jsx(Zr,{className:"w-3 h-3 mr-1 text-green-500"}),te.home_department||"No department"]})]})]})}),r.jsx("td",{className:"px-4 py-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full shadow-sm ${Me(te.highest_degree_attained)}`,children:yq[te.highest_degree_attained]||te.highest_degree_attained||"Not specified"}),r.jsxs("div",{className:"space-y-1",children:[te.is_tenured&&r.jsxs("div",{className:"text-xs text-green-600 flex items-center",children:[r.jsx(Zr,{className:"w-3 h-3 mr-1"}),pq[te.is_tenured]||te.is_tenured]}),te.pursuing_next_degree&&r.jsxs("div",{className:"text-xs text-blue-600 flex items-center",children:[r.jsx(gr,{className:"w-3 h-3 mr-1"}),te.pursuing_next_degree]}),te.on_leave_without_pay&&r.jsxs("div",{className:"text-xs text-orange-600 flex items-center",children:[r.jsx(Xa,{className:"w-3 h-3 mr-1"}),te.on_leave_without_pay]})]})]})}),r.jsx("td",{className:"px-4 py-4",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[r.jsx(Xa,{className:"w-3 h-3 mr-1 text-blue-500"}),te.total_work_load?`${te.total_work_load} hrs`:"Not set"]}),r.jsxs("div",{className:"text-xs text-gray-600",children:[te.annual_basic_salary&&r.jsxs("div",{className:"flex items-center",children:[r.jsx(s3,{className:"w-3 h-3 mr-1 text-green-500"}),xq[te.annual_basic_salary]||te.annual_basic_salary]}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Grade: ",gq[te.ssl_salary_grade]||te.ssl_salary_grade||"Not specified"]})]})]})}),r.jsx("td",{className:"px-4 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",offset:[0,4],usePortal:!0,children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>V(te),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"View Details"]}),r.jsxs("button",{onClick:()=>H(te),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500 group-hover:text-green-600"}),"Edit Faculty"]}),r.jsxs("button",{onClick:()=>le(te.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-700 group-hover:text-red-800"}),"Delete Faculty"]})]})})})]},te.id)),Z.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"5",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(Jr,{className:"w-10 h-10 text-gray-400"})}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:M||T!=="ALL"||S!=="ALL"?"No matching faculty found":"No Faculty Records Found"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:M||T!=="ALL"||S!=="ALL"?"Try adjusting your search terms or filters.":"This institution has no faculty records yet."}),!M&&T==="ALL"&&S==="ALL"&&r.jsxs("button",{onClick:Q,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add First Faculty"]})]})})})]})})})})]}),l.length>0&&r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm",children:r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[r.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",Pe," to ",He," of"," ",l.length," results",l.length!==i.length&&r.jsxs("span",{className:"text-blue-600 ml-1",children:["(filtered from ",i.length," ","total)"]})]}),r.jsx(pc,{currentPage:j,totalPages:K,onPageChange:Oe,pageSize:L,onPageSizeChange:je,pageSizeOptions:[5,10,20,50],showFirstLast:!0,showPageSize:!0,maxPageButtons:5,className:"flex-shrink-0"})]})})]}),r.jsx(nN,{isOpen:x,onClose:Ne,facultyData:h}),r.jsx(iN,{isOpen:v,onClose:we,onSave:oe,institutionId:t,loading:z}),r.jsx(tb,{isOpen:N,onClose:ue,onSave:se,facultyData:h,loading:U}),r.jsx(oN,{isOpen:O,onClose:Se,institutionId:t,onUploadSuccess:re})]})})}const _q=async({incomes:t,expenditures:s,allotments:e,heiName:a,heiUiid:n,setExportLoading:i})=>{var c;try{typeof i=="function"&&i(!0);const l=new fd.Workbook,u={style:"thin",color:{argb:"FF000000"}},o={top:u,left:u,bottom:u,right:u},d=((c=t[0])==null?void 0:c.report_year)||new Date().getFullYear();wq(l,e,a,d,o),Nq(l,s,a,d,o),jq(l,t,a,d,o);const g=`${n}_${a.replace(/[^a-zA-Z0-9]/g,"_")}_FormGH_${new Date().toISOString().split("T")[0]}.xlsx`,p=await l.xlsx.writeBuffer(),h=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=window.URL.createObjectURL(h),x=document.createElement("a");x.href=f,x.download=g,document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(f),jr.fire({title:"Success!",text:"Form GH data exported successfully.",icon:"success",timer:4e3,showConfirmButton:!1})}catch(l){console.error("Error exporting data:",l),jr.fire({title:"Error!",text:"Failed to export data. Please try again.",icon:"error",confirmButtonText:"OK"})}finally{typeof i=="function"&&i(!1)}},wq=(t,s,e,a,n)=>{const i=t.addWorksheet("FORM G-1 - ALLOTMENTS");i.columns=[{width:5},{width:25},{width:12},{width:12},{width:12},{width:15},{width:12},{width:12},{width:12},{width:15},{width:12},{width:12},{width:12},{width:18}],lN(i,e,a,"G-1: ALLOTMENTS"),cN(i,"ALLOT.");let c=10;console.log("Exporting allotment data:",s),s.forEach((l,u)=>{console.log(`Processing allotment row ${u+1}:`,l),i.getCell(`A${c}`).value=`${u+1}.0`,i.getCell(`B${c}`).value=l.function_name||"",i.getCell(`C${c}`).value=parseFloat(l.fund_101_ps)||0,i.getCell(`D${c}`).value=parseFloat(l.fund_101_mooe)||0,i.getCell(`E${c}`).value=parseFloat(l.fund_101_co)||0,i.getCell(`F${c}`).value=parseFloat(l.fund_101_total)||0,i.getCell(`G${c}`).value=parseFloat(l.fund_164_ps)||0,i.getCell(`H${c}`).value=parseFloat(l.fund_164_mooe)||0,i.getCell(`I${c}`).value=parseFloat(l.fund_164_co)||0,i.getCell(`J${c}`).value=parseFloat(l.fund_164_total)||0,i.getCell(`K${c}`).value=parseFloat(l.total_ps)||0,i.getCell(`L${c}`).value=parseFloat(l.total_mooe)||0,i.getCell(`M${c}`).value=parseFloat(l.total_co)||0,i.getCell(`N${c}`).value=parseFloat(l.total_allot)||0,uN(i,c,n),c++}),dN(i,c+2)},Nq=(t,s,e,a,n)=>{const i=t.addWorksheet("FORM G-2 - EXPENDITURES");i.columns=[{width:5},{width:25},{width:12},{width:12},{width:12},{width:15},{width:12},{width:12},{width:12},{width:15},{width:12},{width:12},{width:12},{width:18}],lN(i,e,a,"G-2: EXPENDITURES"),cN(i,"ALLOT.");let c=10;console.log("Exporting expenditure data:",s),s.forEach((l,u)=>{console.log(`Processing expenditure row ${u+1}:`,l);const o=(parseFloat(l.fund_101_ps)||0)+(parseFloat(l.fund_101_mooe)||0)+(parseFloat(l.fund_101_co)||0),d=(parseFloat(l.fund_164_ps)||0)+(parseFloat(l.fund_164_mooe)||0)+(parseFloat(l.fund_164_co)||0),g=(parseFloat(l.fund_101_ps)||0)+(parseFloat(l.fund_164_ps)||0),p=(parseFloat(l.fund_101_mooe)||0)+(parseFloat(l.fund_164_mooe)||0),h=(parseFloat(l.fund_101_co)||0)+(parseFloat(l.fund_164_co)||0),f=g+p+h;i.getCell(`A${c}`).value=`${u+1}.0`,i.getCell(`B${c}`).value=l.function_name||"",i.getCell(`C${c}`).value=parseFloat(l.fund_101_ps)||0,i.getCell(`D${c}`).value=parseFloat(l.fund_101_mooe)||0,i.getCell(`E${c}`).value=parseFloat(l.fund_101_co)||0,i.getCell(`F${c}`).value=o,i.getCell(`G${c}`).value=parseFloat(l.fund_164_ps)||0,i.getCell(`H${c}`).value=parseFloat(l.fund_164_mooe)||0,i.getCell(`I${c}`).value=parseFloat(l.fund_164_co)||0,i.getCell(`J${c}`).value=d,i.getCell(`K${c}`).value=g,i.getCell(`L${c}`).value=p,i.getCell(`M${c}`).value=h,i.getCell(`N${c}`).value=f,uN(i,c,n),c++}),dN(i,c+2)},jq=(t,s,e,a,n)=>{const i=t.addWorksheet("FORM H - INCOME");i.columns=[{width:5},{width:25},{width:22},{width:22},{width:22},{width:20}],i.getCell("A1").value=`FORM H: STATEMENT OF INCOME ( Jan 1 to Dec 31 ${a})`,i.mergeCells("A1:F1"),i.getCell("A1").font={bold:!0,size:14},i.getCell("A1").alignment={horizontal:"center"},i.getCell("A2").value="BY CAMPUS and FUNCTION",i.mergeCells("A2:F2"),i.getCell("A2").font={bold:!0},i.getCell("A2").alignment={horizontal:"center"},i.getCell("A3").value=`SUC ${e.toUpperCase()}`,i.mergeCells("A3:F3"),i.getCell("A3").font={bold:!0,color:{argb:"FF0000FF"}},i.getCell("A3").alignment={horizontal:"center"},i.getCell("A4").value="CAMPUS",i.mergeCells("A4:F4"),i.getCell("A4").font={bold:!0,color:{argb:"FFFF0000"}},i.getCell("A4").alignment={horizontal:"center"},i.getCell("A6").value="",i.getCell("B6").value="SUC CAMPUS",i.getCell("C6").value="TUITION AND MISC FEES",i.getCell("D6").value="MISCELLANEOUS",i.getCell("E6").value="OTHER INCOME",i.getCell("F6").value="TOTAL SUC INCOME",["A6","B6","C6","D6","E6","F6"].forEach(u=>{i.getCell(u).font={bold:!0},i.getCell(u).alignment={horizontal:"center",vertical:"middle"},i.getCell(u).border=n,i.getCell(u).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFECECEC"}}});let c=7;console.log("Exporting income data:",s),s.forEach((u,o)=>{console.log(`Processing income row ${o+1}:`,u);const d=parseFloat(u.tuition_fees)||0,g=parseFloat(u.miscellaneous_fees)||0,p=parseFloat(u.other_income)||0,h=d+g+p;i.getCell(`A${c}`).value=`${o+1}.0`,i.getCell(`B${c}`).value=u.income_category||u.campus||"",i.getCell(`C${c}`).value=d,i.getCell(`D${c}`).value=g,i.getCell(`E${c}`).value=p,i.getCell(`F${c}`).value=h,["A","B","C","D","E","F"].forEach(f=>{const x=i.getCell(`${f}${c}`);x.border=n,["C","D","E","F"].includes(f)&&(x.numFmt="#,##0.00",x.alignment={horizontal:"right"})}),c++}),i.getCell(`B${c}`).value="GRAND TOTAL FOR SUC",i.getCell(`B${c}`).font={bold:!0};const l=s.reduce((u,o)=>{const d=parseFloat(o.tuition_fees)||0,g=parseFloat(o.miscellaneous_fees)||0,p=parseFloat(o.other_income)||0,h=d+g+p;return u.tuitionFees+=d,u.miscFees+=g,u.otherIncome+=p,u.totalIncome+=h,u},{tuitionFees:0,miscFees:0,otherIncome:0,totalIncome:0});console.log("Grand totals:",l),i.getCell(`C${c}`).value=l.tuitionFees,i.getCell(`D${c}`).value=l.miscFees,i.getCell(`E${c}`).value=l.otherIncome,i.getCell(`F${c}`).value=l.totalIncome,["A","B","C","D","E","F"].forEach(u=>{const o=i.getCell(`${u}${c}`);o.border=n,o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFFF0"}},["C","D","E","F"].includes(u)&&(o.numFmt="#,##0.00",o.alignment={horizontal:"right"},o.font={bold:!0})}),Sq(i,c+2)},lN=(t,s,e,a)=>{t.getCell("A1").value=`HEMIS DATA COLLECTION ${e}`,t.mergeCells("A1:N1"),t.getCell("A1").font={bold:!0,size:12},t.getCell("A1").alignment={horizontal:"center"},t.getCell("A2").value=`Form ${a} ( FUND 101 and FUND 164) FY ${e}`,t.mergeCells("A2:N2"),t.getCell("A2").font={bold:!0,size:14},t.getCell("A2").alignment={horizontal:"center"},t.getCell("A3").value="BY CAMPUS and by FUNCTION",t.mergeCells("A3:N3"),t.getCell("A3").font={bold:!0},t.getCell("A3").alignment={horizontal:"center"},t.getCell("A4").value=`SUC ${s.toUpperCase()}`,t.mergeCells("A4:N4"),t.getCell("A4").font={bold:!0,color:{argb:"FF0000FF"}},t.getCell("A4").alignment={horizontal:"center"},t.getCell("A5").value="CAMPUS",t.mergeCells("A5:N5"),t.getCell("A5").font={bold:!0,color:{argb:"FFFF0000"}},t.getCell("A5").alignment={horizontal:"center"}},cN=(t,s)=>{const e={style:"thin",color:{argb:"FF000000"}},a={top:e,left:e,bottom:e,right:e};t.getCell("A7").value="",t.getCell("B7").value="",t.getCell("C7").value="ALLOTMENTS FROM GAA",t.mergeCells("C7:F7"),t.getCell("G7").value="ALLOTMENTS FROM SUC INCOME",t.mergeCells("G7:J7"),t.getCell("K7").value="ALLOTMENTS ( GAA AND SUC INCOME)",t.mergeCells("K7:N7"),t.getCell("A8").value="",t.getCell("B8").value="FUNCTION",t.getCell("C8").value="FUND 101",t.mergeCells("C8:F8"),t.getCell("G8").value="FUND 164",t.mergeCells("G8:J8"),t.getCell("K8").value="TOTAL",t.mergeCells("K8:N8"),t.getCell("A9").value="",t.getCell("B9").value="",t.getCell("C9").value="PS",t.getCell("D9").value="MOOE",t.getCell("E9").value="CO",t.getCell("F9").value="TOTAL",t.getCell("G9").value="PS",t.getCell("H9").value="MOOE",t.getCell("I9").value="CO",t.getCell("J9").value="TOTAL",t.getCell("K9").value="PS",t.getCell("L9").value="MOOE",t.getCell("M9").value="CO",t.getCell("N9").value=`TOTAL ${s}`,["A7","B7","C7","G7","K7","A8","B8","C8","G8","K8","A9","B9","C9","D9","E9","F9","G9","H9","I9","J9","K9","L9","M9","N9"].forEach(n=>{const i=t.getCell(n);i.font={bold:!0},i.alignment={vertical:"middle",horizontal:"center",wrapText:!0},i.border=a,i.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFECECEC"}}})},uN=(t,s,e)=>{["A","B","C","D","E","F","G","H","I","J","K","L","M","N"].forEach(a=>{const n=t.getCell(`${a}${s}`);n.border=e,["C","D","E","F","G","H","I","J","K","L","M","N"].includes(a)&&(n.numFmt="#,##0.00",n.alignment={horizontal:"right"}),["F","J","N"].includes(a)&&(n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF0F0F0"}})})},Sq=(t,s)=>{let e=s;t.getCell(`A${e}`).value="NOTE: TUITION AND INCOME FROM MISCELLANEOUS FEES SHOULD BE TABULATED SEPARATELY.",t.mergeCells(`A${e}:F${e}`),t.getCell(`A${e}`).font={italic:!0},e+=1,t.getCell(`A${e}`).value="ALL SUC RECEIVABLES SHOULD BE CERTIFIED BY THE SUC.",t.mergeCells(`A${e}:F${e}`),t.getCell(`A${e}`).font={italic:!0},e+=2,t.getCell(`A${e}`).value="ORIGINAL DATA SUPPLIED BY:",t.mergeCells(`A${e}:B${e}`),t.getCell(`D${e}`).value=" ",t.mergeCells(`D${e}:F${e}`),e+=1,t.getCell(`A${e}`).value="DATA KEYED IN BY:",t.mergeCells(`A${e}:B${e}`),t.getCell(`D${e}`).value=" ",t.mergeCells(`D${e}:F${e}`),e+=1,t.getCell(`A${e}`).value="CERTIFIED CORRECT BY:",t.mergeCells(`A${e}:B${e}`),t.getCell(`D${e}`).value=" ",t.mergeCells(`D${e}:F${e}`)},dN=(t,s)=>{let e=s;t.getCell(`A${e}`).value="NOTE:",t.getCell(`A${e}`).font={bold:!0},t.getCell(`B${e}`).value="THIS, IN EFFECT, IS THE INTERNAL OPERATING BUDGET (IOB) OF THE SUC.",t.mergeCells(`B${e}:N${e}`),t.getCell(`B${e}`).font={bold:!1},e+=2,t.getCell(`B${e}`).value="ORIGINAL DATA SUPPLIED BY:",t.mergeCells(`B${e}:D${e}`),t.getCell(`F${e}`).value="PRINTED NAME, POSITION, SIGNATURE, DATE",t.mergeCells(`F${e}:N${e}`),e+=1,t.getCell(`B${e}`).value="DATA KEYED IN BY:",t.mergeCells(`B${e}:D${e}`),t.getCell(`F${e}`).value="PRINTED NAME, POSITION, SIGNATURE, DATE",t.mergeCells(`F${e}:N${e}`),e+=1,t.getCell(`B${e}`).value="CERTIFIED CORRECT BY:",t.mergeCells(`B${e}:D${e}`),t.getCell(`F${e}`).value="PRINTED NAME, POSITION, SIGNATURE, DATE",t.mergeCells(`F${e}:N${e}`)},kq=()=>{var C,S;const{SucDetailId:t}=Ko(),s=Aa(),e=qs(),a=((C=e.state)==null?void 0:C.heiName)||"Unknown Institution",n=((S=e.state)==null?void 0:S.heiUiid)||"Unknown Uiid",[i,c]=ne.useState([]),[l,u]=ne.useState([]),[o,d]=ne.useState([]),[g,p]=ne.useState("income"),[h,f]=ne.useState(!1),[x,b]=ne.useState(null),v=w=>(parseFloat(w.tuition_fees)||0)+(parseFloat(w.miscellaneous_fees)||0)+(parseFloat(w.other_income)||0),_=w=>{const j=(parseFloat(w.fund_101_ps)||0)+(parseFloat(w.fund_101_mooe)||0)+(parseFloat(w.fund_101_co)||0),A=(parseFloat(w.fund_164_ps)||0)+(parseFloat(w.fund_164_mooe)||0)+(parseFloat(w.fund_164_co)||0),L=(parseFloat(w.fund_101_ps)||0)+(parseFloat(w.fund_164_ps)||0),I=(parseFloat(w.fund_101_mooe)||0)+(parseFloat(w.fund_164_mooe)||0),Z=(parseFloat(w.fund_101_co)||0)+(parseFloat(w.fund_164_co)||0),K=L+I+Z;return{fund_101_total:j,fund_164_total:A,total_ps:L,total_mooe:I,total_co:Z,total_expend:K}},N=w=>{const j=(parseFloat(w.fund_101_ps)||0)+(parseFloat(w.fund_101_mooe)||0)+(parseFloat(w.fund_101_co)||0),A=(parseFloat(w.fund_164_ps)||0)+(parseFloat(w.fund_164_mooe)||0)+(parseFloat(w.fund_164_co)||0),L=(parseFloat(w.fund_101_ps)||0)+(parseFloat(w.fund_164_ps)||0),I=(parseFloat(w.fund_101_mooe)||0)+(parseFloat(w.fund_164_mooe)||0),Z=(parseFloat(w.fund_101_co)||0)+(parseFloat(w.fund_164_co)||0),K=L+I+Z;return{fund_101_total:j,fund_164_total:A,total_ps:L,total_mooe:I,total_co:Z,total_allot:K}};ne.useEffect(()=>{E()},[]);const E=async()=>{if(!t){console.error("SucDetailId is undefined");return}console.log("Fetching data for SucDetailId:",t);try{const w=await bt.get(`${Ct.API_URL}/suc-form-gh/${t}/all-data`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}}),{income:j,expenditure:A,allotment:L}=w.data.data;c(Array.isArray(j)?j:[]),console.log("Fetched Income data:",j),u(Array.isArray(A)?A:[]),console.log("Fetched Expenditure data:",A),d(Array.isArray(L)?L:[]),console.log("Fetched Allotment data:",L)}catch(w){console.error("Error fetching data:",w)}},O=()=>{s("/super-admin/institutions/suc")},F=w=>w?new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:0,maximumFractionDigits:0}).format(w):"0",z=async()=>{f(!0),jr.fire({title:"Confirm Export",text:`Do you want to export Form GH data for ${a}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Export",cancelButtonText:"Cancel"}).then(async w=>{w.isConfirmed&&await _q({incomes:i,expenditures:l,allotments:o,heiName:a,heiUiid:n}),f(!1)})},P=(w,j,A)=>{b({id:w,field:j,type:A})},U=(w,j,A,L)=>{const I=w.target.value;L==="expenditure"?u(Z=>Z.map(K=>K.id===j?{...K,[A]:I}:K)):L==="allotment"?d(Z=>Z.map(K=>K.id===j?{...K,[A]:I}:K)):L==="income"&&c(Z=>Z.map(K=>K.id===j?{...K,[A]:I}:K))},W=w=>{w.key==="Enter"?(w.preventDefault(),console.log("Enter key pressed"),w.target.blur()):w.key==="Escape"&&(w.preventDefault(),console.log("Escape key pressed"),b(null))},Y=async(w,j,A,L,I=!1,Z)=>{var ae,V;console.log("Blur event triggered"),console.log("Event type:",w.type),console.log("Related target:",w.relatedTarget);let K=w.target.value.trim();I&&(K=parseFloat(K)||0),console.log("Original value:",Z),console.log("New value:",K),console.log("Field:",A),console.log("Type:",L);let re,G;L==="expenditure"?(re={...j,[A]:K},G=_(re),u(H=>H.map(Q=>Q.id===j.id?{...re,...G}:Q))):L==="allotment"?(re={...j,[A]:K},G=N(re),d(H=>H.map(Q=>Q.id===j.id?{...re,...G}:Q))):L==="income"&&(re={...j,[A]:K},G={total_income:v(re)},c(Q=>Q.map(oe=>oe.id===j.id?{...re,...G}:oe)));try{const H=localStorage.getItem("token"),Q=`${Ct.API_URL}/suc-form-gh/${L}s/${j.id}`,oe={[A]:K,report_year:j.report_year,suc_details_id:j.suc_details_id,...G};console.log("Sending data to:",Q),console.log("Data being sent:",oe);const se=await bt.put(Q,oe,{headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"}});console.log("Response:",se.data),b(null),await E(),jr.fire({icon:"success",title:"Saved!",showConfirmButton:!1,timer:1500})}catch(H){console.error(`Error updating ${A} for ${L} id ${j.id}:`,H.response||H),await E(),jr.fire({icon:"error",title:"Failed to save!",text:((V=(ae=H.response)==null?void 0:ae.data)==null?void 0:V.message)||"Please try again.",confirmButtonText:"OK"})}},q=({value:w,item:j,field:A,type:L,isEditable:I=!0,isNumber:Z=!1})=>(x==null?void 0:x.id)===j.id&&(x==null?void 0:x.field)===A&&(x==null?void 0:x.type)===L?r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:Z?"number":"text",value:w||"",onChange:re=>U(re,j.id,A,L),onKeyDown:W,onBlur:re=>Y(re,j,A,L,Z,w),className:"w-full h-full bg-blue-50 border border-blue-400 px-2 py-1 text-xs focus:bg-white focus:ring-1 focus:ring-blue-500 focus:border-blue-500 outline-none",autoFocus:!0}),r.jsx("div",{className:"absolute top-full right-0 mt-1 text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded shadow-sm z-40",children:"Enter to save  Esc to cancel"})]}):r.jsxs("div",{className:`w-full h-full px-2 py-1 text-xs truncate group relative ${I?"cursor-pointer hover:bg-gray-50":""}`,onClick:()=>I&&P(j.id,A,L),title:w,children:[r.jsx("span",{className:"block truncate",children:Z?F(w):w}),I&&r.jsx(nE,{className:"w-3 h-3 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150 absolute top-1 right-1"})]});q.propTypes={value:B.oneOfType([B.string,B.number]),item:B.shape({id:B.oneOfType([B.string,B.number]).isRequired}).isRequired,field:B.string.isRequired,type:B.string.isRequired,isEditable:B.bool,isNumber:B.bool};const M=()=>r.jsx("div",{className:"w-full overflow-x-auto border border-gray-200",children:r.jsx("div",{className:"min-w-[50vh] max-h-[45vh] overflow-y-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-100 border-b border-gray-200",children:[r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-left w-40",children:"Income Category"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-32",children:"Tuition Fees"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-32",children:"Miscellaneous Fees"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-32",children:"Other Income"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-32",children:"Total Income"})]})}),r.jsx("tbody",{children:i.map((w,j)=>r.jsxs("tr",{className:`border-b border-gray-200 hover:bg-gray-50 ${j%2===0?"bg-white":"bg-gray-25"}`,children:[r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.income_category,item:w,field:"income_category",type:"income"})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.tuition_fees,item:w,field:"tuition_fees",type:"income",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.miscellaneous_fees,item:w,field:"miscellaneous_fees",type:"income",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.other_income,item:w,field:"other_income",type:"income",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-gray-100",children:r.jsx(q,{value:w.total_income,item:w,field:"total_income",type:"income",isNumber:!0,isEditable:!1})})]},w.id))})]})})}),D=()=>r.jsx("div",{className:"w-full overflow-x-auto border border-gray-200",children:r.jsx("div",{className:"min-w-[1400px] max-h-[600px] overflow-y-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-100 border-b border-gray-200",children:[r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-left w-40",children:"Function Name"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 101 PS"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 101 MOOE"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 101 CO"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-blue-50",children:"Fund 101 Total"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 164 PS"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 164 MOOE"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 164 CO"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-blue-50",children:"Fund 164 Total"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-green-50",children:"Total PS"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-green-50",children:"Total MOOE"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-green-50",children:"Total CO"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-32 bg-yellow-50",children:"Total Expenditure"})]})}),r.jsx("tbody",{children:l.map((w,j)=>r.jsxs("tr",{className:`border-b border-gray-200 hover:bg-gray-50 ${j%2===0?"bg-white":"bg-gray-25"}`,children:[r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.function_name,item:w,field:"function_name",type:"expenditure"})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_101_ps,item:w,field:"fund_101_ps",type:"expenditure",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_101_mooe,item:w,field:"fund_101_mooe",type:"expenditure",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_101_co,item:w,field:"fund_101_co",type:"expenditure",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-blue-50",children:r.jsx(q,{value:w.fund_101_total,item:w,field:"fund_101_total",type:"expenditure",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_164_ps,item:w,field:"fund_164_ps",type:"expenditure",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_164_mooe,item:w,field:"fund_164_mooe",type:"expenditure",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_164_co,item:w,field:"fund_164_co",type:"expenditure",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-blue-50",children:r.jsx(q,{value:w.fund_164_total,item:w,field:"fund_164_total",type:"expenditure",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-green-50",children:r.jsx(q,{value:w.total_ps,item:w,field:"total_ps",type:"expenditure",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-green-50",children:r.jsx(q,{value:w.total_mooe,item:w,field:"total_mooe",type:"expenditure",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-green-50",children:r.jsx(q,{value:w.total_co,item:w,field:"total_co",type:"expenditure",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-yellow-50",children:r.jsx(q,{value:w.total_expend,item:w,field:"total_expend",type:"expenditure",isNumber:!0,isEditable:!1})})]},w.id))})]})})}),T=()=>r.jsx("div",{className:"w-full overflow-x-auto border border-gray-200",children:r.jsx("div",{className:"min-w-[1400px] max-h-[600px] overflow-y-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-100 border-b border-gray-200",children:[r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-left w-40",children:"Function Name"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 101 PS"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 101 MOOE"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 101 CO"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-blue-50",children:"Fund 101 Total"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 164 PS"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 164 MOOE"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24",children:"Fund 164 CO"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-blue-50",children:"Fund 164 Total"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-green-50",children:"Total PS"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-green-50",children:"Total MOOE"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-24 bg-green-50",children:"Total CO"}),r.jsx("th",{className:"border-r border-gray-200 px-2 py-2 text-xs font-semibold text-gray-700 text-right w-32 bg-yellow-50",children:"Total Allotment"})]})}),r.jsx("tbody",{children:o.map((w,j)=>r.jsxs("tr",{className:`border-b border-gray-200 hover:bg-gray-50 ${j%2===0?"bg-white":"bg-gray-25"}`,children:[r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.function_name,item:w,field:"function_name",type:"allotment"})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_101_ps,item:w,field:"fund_101_ps",type:"allotment",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_101_mooe,item:w,field:"fund_101_mooe",type:"allotment",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_101_co,item:w,field:"fund_101_co",type:"allotment",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-blue-50",children:r.jsx(q,{value:w.fund_101_total,item:w,field:"fund_101_total",type:"allotment",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_164_ps,item:w,field:"fund_164_ps",type:"allotment",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_164_mooe,item:w,field:"fund_164_mooe",type:"allotment",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8",children:r.jsx(q,{value:w.fund_164_co,item:w,field:"fund_164_co",type:"allotment",isNumber:!0})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-blue-50",children:r.jsx(q,{value:w.fund_164_total,item:w,field:"fund_164_total",type:"allotment",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-green-50",children:r.jsx(q,{value:w.total_ps,item:w,field:"total_ps",type:"allotment",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-green-50",children:r.jsx(q,{value:w.total_mooe,item:w,field:"total_mooe",type:"allotment",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-green-50",children:r.jsx(q,{value:w.total_co,item:w,field:"total_co",type:"allotment",isNumber:!0,isEditable:!1})}),r.jsx("td",{className:"border-r border-gray-200 h-8 bg-yellow-50",children:r.jsx(q,{value:w.total_allot,item:w,field:"total_allot",type:"allotment",isNumber:!0,isEditable:!1})})]},w.id))})]})})});return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:r.jsxs("div",{className:"p-4 max-w-full mx-auto",children:[r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:O,className:"mr-4 p-2 text-gray-600 hover:text-gray-900 hover:bg-white/50 rounded-lg transition-all duration-200",children:r.jsx(Zo,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Financial Management"}),r.jsx("p",{className:"text-sm text-gray-600 flex items-center",children:a})]})]}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-3 border border-white/20 shadow-sm mb-4",children:r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 justify-between items-start lg:items-center",children:[r.jsx("div",{className:"flex flex-col sm:flex-row gap-2 flex-1 w-full lg:w-auto"}),r.jsx("div",{className:"flex flex-col sm:flex-row gap-2 w-full lg:w-auto",children:r.jsxs("button",{onClick:z,disabled:h,className:"inline-flex items-center justify-center px-3 py-2 bg-white/50 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-white hover:shadow-md transition-all duration-200",children:[r.jsx(oc,{className:"w-4 h-4 mr-2"}),h?"Exporting...":"Export Excel"]})})]}),r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"-mb-px flex space-x-6",children:[r.jsxs("button",{onClick:()=>p("income"),className:`${g==="income"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center`,children:[r.jsx(bn,{className:"w-4 h-4 mr-2"}),"Income (",i.length,")"]}),r.jsxs("button",{onClick:()=>p("expenditure"),className:`${g==="expenditure"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center`,children:[r.jsx(mC,{className:"w-4 h-4 mr-2"}),"Expenditure (",l.length,")"]}),r.jsxs("button",{onClick:()=>p("allotment"),className:`${g==="allotment"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center`,children:[r.jsx(gC,{className:"w-4 h-4 mr-2"}),"Allotment (",o.length,")"]})]})})]})})]}),r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl shadow-sm border border-white/20",children:[g==="income"&&M(),g==="expenditure"&&D(),g==="allotment"&&T()]}),r.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:r.jsxs("p",{className:"text-sm text-blue-800",children:[r.jsx("strong",{children:"Excel-like editing:"})," Click on any editable cell to edit. Press Enter to save or Escape to cancel. Calculated fields (totals) are highlighted and read-only."]})})]})})};function fN({isOpen:t,onClose:s,hei:e}){var i;const a=c=>{switch(c){case"SUC":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border border-blue-300";case"LUC":return"bg-gradient-to-r from-green-100 to-green-200 text-green-800 border border-green-300";case"Private":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border border-purple-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border border-gray-300"}},n=c=>{if(!c)return"N/A";try{return new Date(c).toLocaleDateString()}catch(l){return console.error("Error formatting date:",l),"Invalid Date"}};return r.jsx(mr,{isOpen:t,onClose:s,title:"HEI Details",subtitle:"View detailed information about the Higher Education Institution",icon:$s,size:"sm",children:r.jsx("div",{className:"p-6",children:e?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx($s,{className:"w-6 h-6 text-blue-600"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:e.name||"Unnamed Institution"})]}),r.jsxs("p",{className:"text-gray-600 text-sm",children:["UIID: ",e.uiid||"N/A"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Type"}),r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold ${a(e.type)}`,children:e.type||"Unknown"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Cluster"}),r.jsxs("p",{className:"text-sm text-gray-800 flex items-center",children:[r.jsx(yn,{className:"w-4 h-4 mr-1 text-gray-400"}),((i=e.cluster)==null?void 0:i.name)||"Not assigned"]})]})]}),r.jsx("div",{className:"border-t border-gray-200 pt-4",children:r.jsxs("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Created At"}),r.jsxs("dd",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[r.jsx(pi,{className:"w-3 h-3 mr-1 text-gray-400"}),n(e.created_at)]})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),r.jsxs("dd",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[r.jsx(pi,{className:"w-3 h-3 mr-1 text-gray-400"}),n(e.updated_at)]})]})]})})]}):r.jsx("div",{className:"text-center text-gray-500 py-4",children:"No HEI data available"})})})}fN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,hei:B.shape({name:B.string,uiid:B.string,type:B.string,created_at:B.string,updated_at:B.string,cluster:B.shape({id:B.number,name:B.string,regionID:B.number})})};function hN({isOpen:t,onClose:s,onSave:e,loading:a,clusters:n}){const[i,c]=ne.useState({uiid:"",name:"",type:"SUC",cluster_id:""}),[l,u]=ne.useState({}),o=h=>{const{name:f,value:x}=h.target;c(b=>({...b,[f]:x})),l[f]&&u(b=>({...b,[f]:""}))},d=()=>{const h={};return i.uiid.trim()||(h.uiid="UIID is required"),i.name.trim()||(h.name="Name is required"),i.cluster_id||(h.cluster_id="Cluster is required"),u(h),Object.keys(h).length===0},g=async h=>{h.preventDefault(),d()&&(await e(i),c({uiid:"",name:"",type:"SUC",cluster_id:""}))},p=r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),r.jsx("button",{type:"submit",onClick:g,disabled:a,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Saving...":"Save HEI"})]});return r.jsx(mr,{isOpen:t,onClose:s,title:"Add New HEI",subtitle:"Enter the details of the new Higher Education Institution",icon:$s,footer:p,size:"sm",children:r.jsx("div",{className:"p-6",children:r.jsxs("form",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"uiid",className:"block text-sm font-medium text-gray-700",children:"UIID"}),r.jsx("input",{type:"text",id:"uiid",name:"uiid",value:i.uiid,onChange:o,className:`mt-1 block w-full rounded-md border ${l.uiid?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"} shadow-sm p-2`}),l.uiid&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.uiid})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Institution Name"}),r.jsx("input",{type:"text",id:"name",name:"name",value:i.name,onChange:o,className:`mt-1 block w-full rounded-md border ${l.name?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"} shadow-sm p-2`}),l.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.name})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700",children:"Type"}),r.jsxs("select",{id:"type",name:"type",value:i.type,onChange:o,className:"mt-1 block w-full rounded-md border border-gray-300 shadow-sm p-2 focus:border-blue-500 focus:ring-blue-500",children:[r.jsx("option",{value:"SUC",children:"SUC"}),r.jsx("option",{value:"LUC",children:"LUC"}),r.jsx("option",{value:"Private",children:"Private"})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"cluster_id",className:"block text-sm font-medium text-gray-700",children:"Cluster"}),r.jsxs("select",{id:"cluster_id",name:"cluster_id",value:i.cluster_id,onChange:o,className:`mt-1 block w-full rounded-md border ${l.cluster_id?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"} shadow-sm p-2`,children:[r.jsx("option",{value:"",children:"Select a cluster"}),n.map(h=>r.jsx("option",{value:h.id,children:h.name},h.id))]}),l.cluster_id&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.cluster_id})]})]})})})}hN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,loading:B.bool.isRequired,clusters:B.array.isRequired};function mN({isOpen:t,onClose:s,onSave:e,hei:a,loading:n,clusters:i}){const[c,l]=ne.useState({uiid:"",name:"",type:"SUC",cluster_id:""}),[u,o]=ne.useState({});ne.useEffect(()=>{a&&l({uiid:a.uiid||"",name:a.name||"",type:a.type||"SUC",cluster_id:a.cluster_id||""})},[a]);const d=f=>{const{name:x,value:b}=f.target;l(v=>({...v,[x]:b})),u[x]&&o(v=>({...v,[x]:""}))},g=()=>{const f={};return c.uiid.trim()||(f.uiid="UIID is required"),c.name.trim()||(f.name="Name is required"),c.cluster_id||(f.cluster_id="Cluster is required"),o(f),Object.keys(f).length===0},p=async f=>{f.preventDefault(),g()&&await e(c)},h=r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),r.jsx("button",{type:"submit",onClick:p,disabled:n,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Saving...":"Save Changes"})]});return r.jsx(mr,{isOpen:t,onClose:s,title:"Edit HEI",subtitle:"Update the details of the Higher Education Institution",icon:$s,footer:h,size:"sm",children:r.jsx("div",{className:"p-6",children:r.jsxs("form",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"uiid",className:"block text-sm font-medium text-gray-700",children:"UIID"}),r.jsx("input",{type:"text",id:"uiid",name:"uiid",value:c.uiid,onChange:d,className:`mt-1 block w-full rounded-md border ${u.uiid?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"} shadow-sm p-2`}),u.uiid&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.uiid})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Institution Name"}),r.jsx("input",{type:"text",id:"name",name:"name",value:c.name,onChange:d,className:`mt-1 block w-full rounded-md border ${u.name?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"} shadow-sm p-2`}),u.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.name})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700",children:"Type"}),r.jsxs("select",{id:"type",name:"type",value:c.type,onChange:d,className:"mt-1 block w-full rounded-md border border-gray-300 shadow-sm p-2 focus:border-blue-500 focus:ring-blue-500",children:[r.jsx("option",{value:"SUC",children:"SUC"}),r.jsx("option",{value:"LUC",children:"LUC"}),r.jsx("option",{value:"Private",children:"Private"})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"cluster_id",className:"block text-sm font-medium text-gray-700",children:"Cluster"}),r.jsxs("select",{id:"cluster_id",name:"cluster_id",value:c.cluster_id,onChange:d,className:`mt-1 block w-full rounded-md border ${u.cluster_id?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"} shadow-sm p-2`,children:[r.jsx("option",{value:"",children:"Select a cluster"}),i.map(f=>r.jsx("option",{value:f.id,children:f.name},f.id))]}),u.cluster_id&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.cluster_id})]})]})})})}mN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,loading:B.bool.isRequired,hei:B.shape({uiid:B.string,name:B.string,type:B.string,cluster_id:B.string}),clusters:B.arrayOf(B.shape({id:B.string.isRequired,name:B.string.isRequired}))};function Cq(){const[t,s]=ne.useState([]),[e,a]=ne.useState([]),[n,i]=ne.useState([]),[c,l]=ne.useState(!0),[u,o]=ne.useState(""),[d,g]=ne.useState(null),[p,h]=ne.useState(!1),[f,x]=ne.useState(!1),[b,v]=ne.useState(!1),[_,N]=ne.useState(!1),[E,O]=ne.useState(!1),[F,z]=ne.useState(""),[P,U]=ne.useState("ALL"),[W,Y]=ne.useState("ALL"),[q,M]=ne.useState(1),[D,T]=ne.useState(10),[C,S]=ne.useState([]);ne.useEffect(()=>{j(),w()},[]),ne.useEffect(()=>{let se=t;F&&(se=se.filter(le=>{var he,Ne;return((he=le.name)==null?void 0:he.toLowerCase().includes(F.toLowerCase()))||((Ne=le.uiid)==null?void 0:Ne.toLowerCase().includes(F.toLowerCase()))})),P!=="ALL"&&(se=se.filter(le=>le.type===P)),W!=="ALL"&&(se=se.filter(le=>le.cluster_id===parseInt(W))),se=se.sort((le,he)=>le.name.localeCompare(he.name)),i(se),M(1)},[t,F,P,W]),ne.useEffect(()=>{const se=(q-1)*D,le=se+D;S(n.slice(se,le))},[n,q,D]);const w=async()=>{try{const se=await bt.get(`${Ct.API_URL}/clusters`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}});a(se.data)}catch(se){console.error("Error fetching clusters:",se),o("Failed to load clusters. Please try again.")}},j=async()=>{l(!0),o("");try{const se=await bt.get(`${Ct.API_URL}/heis`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}}),he=(Array.isArray(se.data)?se.data:se.data.data||[]).sort((Ne,we)=>Ne.name.localeCompare(we.name));s(he),i(he),console.log("Fetched HEIs:",he)}catch(se){console.error("Error fetching HEIs:",se),o("Failed to load HEIs. Please try again.")}finally{l(!1)}},A=se=>{g(se),h(!0)},L=se=>{g(se),v(!0)},I=async se=>{O(!0);try{const le=await bt.put(`${Ct.API_URL}/heis/${se.id}`,se,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(le.status===200){const he=le.data;s(Ne=>Ne.map(we=>we.id===he.id?he:we)),i(Ne=>Ne.map(we=>we.id===he.id?he:we)),v(!1),g(null),console.log("Hei updated successfully:",he)}}catch(le){console.error("Error updating HEI:",le),o("Failed to update HEI. Please try again.")}finally{O(!1)}},Z=async se=>{if(window.confirm("Are you sure you want to delete this HEI?"))try{if((await bt.delete(`${Ct.API_URL}/heis/${se}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}})).status===200)s(t.filter(he=>he.id!==se)),i(n.filter(he=>he.id!==se)),console.log("Hei deleted successfully:",se);else throw new Error("Failed to delete HEI")}catch(le){console.error("Error deleting HEI:",le),o("Failed to delete HEI. Please try again.")}},K=()=>{x(!0)},re=async se=>{N(!0);try{const le=await bt.post(`${Ct.API_URL}/heis`,se,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(le.status===201){const he=le.data;s(Ne=>[...Ne,he]),i(Ne=>[...Ne,he]),x(!1),console.log("Hei created successfully:",he),j()}}catch(le){console.error("Error creating HEI:",le),o("Failed to create HEI. Please try again.")}finally{N(!1)}},G=()=>{h(!1),g(null)},ae=()=>{x(!1)},V=()=>{v(!1),g(null)},H=se=>{switch(se){case"SUC":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border border-blue-300";case"LUC":return"bg-gradient-to-r from-green-100 to-green-200 text-green-800 border border-green-300";case"Private":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border border-purple-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border border-gray-300"}},Q=se=>{M(se)},oe=se=>{T(se),M(1)};return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:[r.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"HEI Management"}),r.jsxs("p",{className:"text-gray-600 flex items-center",children:[r.jsx($s,{className:"w-4 h-4 mr-2"}),"Manage Higher Education Institutions"]})]}),r.jsxs("button",{onClick:K,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[r.jsx(Er,{className:"w-5 h-5 mr-2"}),"Add HEI"]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",placeholder:"Search HEIs...",value:F,onChange:se=>z(se.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),r.jsx(pa,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("select",{value:P,onChange:se=>U(se.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"ALL",children:"All Types"}),r.jsx("option",{value:"SUC",children:"SUC"}),r.jsx("option",{value:"LUC",children:"LUC"}),r.jsx("option",{value:"Private",children:"Private"})]}),r.jsxs("select",{value:W,onChange:se=>Y(se.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"ALL",children:"All Clusters"}),e.map(se=>r.jsx("option",{value:se.id,children:se.name},se.id))]})]})]}),c?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading HEIs..."})]}):u?r.jsx("div",{className:"text-center py-8 text-red-600",children:u}):r.jsx(r.Fragment,{children:r.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[r.jsx("div",{className:"shadow-sm overflow-x-auto max-h-[600px] overflow-y-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"HEI Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"UIID"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cluster"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(se=>{var le;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:se.name})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-500",children:se.uiid})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${H(se.type)}`,children:se.type})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(yn,{className:"w-4 h-4 mr-1"}),((le=e.find(he=>he.id===se.cluster_id))==null?void 0:le.name)||"N/A"]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsx(ra,{trigger:r.jsx("button",{type:"button",className:"text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-5 h-5"})}),className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg right-0 top-full mt-1",children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{type:"button",onClick:()=>A(se),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"View Details"]}),r.jsxs("button",{type:"button",onClick:()=>L(se),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150 group",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500 group-hover:text-green-600"}),"Edit HEI"]}),r.jsxs("button",{type:"button",onClick:()=>Z(se.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-700 group-hover:text-red-600"}),"Delete HEI"]})]})})})]},se.uiid)})})]})}),r.jsx("div",{className:"mt-2 flex justify-end  ",children:r.jsx(pc,{currentPage:q,totalPages:Math.ceil(n.length/D),onPageChange:Q,pageSize:D,onPageSizeChange:oe,pageSizeOptions:[10,20,50,100],showFirstLast:!0,showPageSize:!0,maxPageButtons:5})})]})})]})}),r.jsx(fN,{isOpen:p,onClose:G,hei:d}),r.jsx(hN,{isOpen:f,onClose:ae,onSave:re,loading:_,clusters:e}),r.jsx(mN,{isOpen:b,onClose:V,onSave:I,hei:d,loading:E,clusters:e})]})}function _g({data:t,onView:s,onEdit:e,onDelete:a}){return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200/30",children:[r.jsx("thead",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Article Information"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Authors & Keywords"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Publication Details"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[t.map((n,i)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${i%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-purple-100 to-purple-200 text-purple-700",children:r.jsx(qr,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.title_of_article}),r.jsx("div",{className:"text-sm text-gray-500",children:n.year_of_publication})]})]})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:n.authors}),r.jsx("div",{className:"text-sm text-gray-500",children:n.keywords})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:n.name_of_book_journal}),r.jsxs("div",{className:"text-sm text-gray-500",children:[n.vol_no_issue_no&&`Vol. ${n.vol_no_issue_no}`,n.no_of_pages&&`  ${n.no_of_pages} pages`]})]}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>s(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500"}),"View Details"]}),r.jsxs("button",{onClick:()=>e(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500"}),"Edit Research"]}),r.jsxs("button",{onClick:()=>a(n.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-500"}),"Delete Research"]})]})})})]},n.id)),t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(qr,{className:"w-10 h-10 text-gray-400"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No research articles found"}),r.jsx("p",{className:"text-gray-600",children:"Get started by adding your first research article"})]})})})]})]})})}_g.propTypes={data:B.arrayOf(B.shape({id:B.number.isRequired,title_of_article:B.string.isRequired,year_of_publication:B.number,authors:B.string.isRequired,keywords:B.string,name_of_book_journal:B.string.isRequired,vol_no_issue_no:B.string,no_of_pages:B.number})).isRequired,onView:B.func.isRequired,onEdit:B.func.isRequired,onDelete:B.func.isRequired};function wg({data:t,onView:s,onEdit:e,onDelete:a}){return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200/30",children:[r.jsx("thead",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Research Paper"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Researchers & Keywords"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Conference Details"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[t.map((n,i)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${i%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-blue-100 to-blue-200 text-blue-700",children:r.jsx(s2,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.title_of_research_paper}),r.jsx("div",{className:"text-sm text-gray-500",children:n.type_of_conference})]})]})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:n.researchers}),r.jsx("div",{className:"text-sm text-gray-500",children:n.keywords})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:n.conference_title}),r.jsxs("div",{className:"text-sm text-gray-500",children:[n.conference_venue,"  ",n.conference_date]}),r.jsx("div",{className:"text-sm text-gray-500",children:n.conference_organizer})]}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>s(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500"}),"View Details"]}),r.jsxs("button",{onClick:()=>e(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500"}),"Edit Research"]}),r.jsxs("button",{onClick:()=>a(n.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-500"}),"Delete Research"]})]})})})]},n.id)),t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(s2,{className:"w-10 h-10 text-gray-400"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No conference papers found"}),r.jsx("p",{className:"text-gray-600",children:"Get started by adding your first conference paper"})]})})})]})]})})}wg.propTypes={data:B.arrayOf(B.shape({id:B.number.isRequired,title_of_research_paper:B.string.isRequired,type_of_conference:B.string.isRequired,researchers:B.string.isRequired,keywords:B.string,conference_title:B.string.isRequired,conference_venue:B.string.isRequired,conference_date:B.string.isRequired,conference_organizer:B.string.isRequired})).isRequired,onView:B.func.isRequired,onEdit:B.func.isRequired,onDelete:B.func.isRequired};function Ng({data:t,onView:s,onEdit:e,onDelete:a}){return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200/30",children:[r.jsx("thead",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Invention"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Patent Details"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Utilization"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[t.map((n,i)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${i%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-yellow-100 to-yellow-200 text-yellow-700",children:r.jsx(e2,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.inventions}),r.jsxs("div",{className:"text-sm text-gray-500",children:["Patent #",n.patent_number]})]})]})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:["Issued: ",n.date_of_issue]}),r.jsxs("div",{className:"text-sm text-gray-500",children:["Points: ",n.points]})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[n.utilization_development&&r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Development"}),n.utilization_service&&r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Service"})]}),n.name_of_commercial_product&&r.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Product: ",n.name_of_commercial_product]})]}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>s(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500"}),"View Details"]}),r.jsxs("button",{onClick:()=>e(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500"}),"Edit Research"]}),r.jsxs("button",{onClick:()=>a(n.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-500"}),"Delete Research"]})]})})})]},n.id)),t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(e2,{className:"w-10 h-10 text-gray-400"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No inventions found"}),r.jsx("p",{className:"text-gray-600",children:"Get started by adding your first invention"})]})})})]})]})})}Ng.propTypes={data:B.arrayOf(B.shape({id:B.number.isRequired,inventions:B.string.isRequired,patent_number:B.string.isRequired,date_of_issue:B.string.isRequired,utilization_development:B.bool,utilization_service:B.bool,name_of_commercial_product:B.string,points:B.number.isRequired})).isRequired,onView:B.func.isRequired,onEdit:B.func.isRequired,onDelete:B.func.isRequired};function jg({data:t,onView:s,onEdit:e,onDelete:a}){return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200/30",children:[r.jsx("thead",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Citation Details"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Researchers & Keywords"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Journal Information"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[t.map((n,i)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${i%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-indigo-100 to-indigo-200 text-indigo-700",children:r.jsx(a2,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.citing_article_title}),r.jsx("div",{className:"text-sm text-gray-500",children:n.citing_authors})]})]})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:n.researchers}),r.jsx("div",{className:"text-sm text-gray-500",children:n.keywords})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:n.journal_title}),r.jsx("div",{className:"text-sm text-gray-500",children:n.vol_issue_page_no}),r.jsx("div",{className:"text-sm text-gray-500",children:n.city_year_published}),r.jsx("div",{className:"text-sm text-gray-500",children:n.publisher_name})]}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>s(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500"}),"View Details"]}),r.jsxs("button",{onClick:()=>e(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500"}),"Edit Research"]}),r.jsxs("button",{onClick:()=>a(n.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-500"}),"Delete Research"]})]})})})]},n.id)),t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(a2,{className:"w-10 h-10 text-gray-400"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No citations found"}),r.jsx("p",{className:"text-gray-600",children:"Get started by adding your first citation"})]})})})]})]})})}jg.propTypes={data:B.arrayOf(B.shape({id:B.number.isRequired,citing_article_title:B.string.isRequired,citing_authors:B.string.isRequired,researchers:B.string.isRequired,keywords:B.string.isRequired,journal_title:B.string.isRequired,vol_issue_page_no:B.string.isRequired,city_year_published:B.string.isRequired,publisher_name:B.string.isRequired})).isRequired,onView:B.func.isRequired,onEdit:B.func.isRequired,onDelete:B.func.isRequired};function Sg({data:t,onView:s,onEdit:e,onDelete:a}){return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200/30",children:[r.jsx("thead",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Award Information"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Researcher"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Award Details"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[t.map((n,i)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${i%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-amber-100 to-amber-200 text-amber-700",children:r.jsx(Zr,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.title_of_research_output_award}),r.jsx("div",{className:"text-sm text-gray-500",children:n.year_published_accepted_presented_received})]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"text-sm text-gray-900",children:n.name_of_researcher})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"text-sm text-gray-900",children:n.publisher_conference_organizer_confering_body})}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>s(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500"}),"View Details"]}),r.jsxs("button",{onClick:()=>e(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500"}),"Edit Research"]}),r.jsxs("button",{onClick:()=>a(n.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-500"}),"Delete Research"]})]})})})]},n.id)),t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(Zr,{className:"w-10 h-10 text-gray-400"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No awards found"}),r.jsx("p",{className:"text-gray-600",children:"Get started by adding your first award"})]})})})]})]})})}Sg.propTypes={data:B.arrayOf(B.shape({id:B.number.isRequired,title_of_research_output_award:B.string.isRequired,year_published_accepted_presented_received:B.string.isRequired,name_of_researcher:B.string.isRequired,publisher_conference_organizer_confering_body:B.string.isRequired})).isRequired,onView:B.func.isRequired,onEdit:B.func.isRequired,onDelete:B.func.isRequired};function kg({data:t,onView:s,onEdit:e,onDelete:a}){return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200/30",children:[r.jsx("thead",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Training Program"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Keywords"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Program Details"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200/30",children:[t.map((n,i)=>r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${i%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-emerald-100 to-emerald-200 text-emerald-700",children:r.jsx(gr,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.title}),r.jsxs("div",{className:"text-sm text-gray-500",children:[n.duration_number_of_hours," hours"]})]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"text-sm text-gray-500",children:n.keywords})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:["Beneficiaries: ",n.number_of_trainees_beneficiaries]}),n.citation_title&&r.jsxs("div",{className:"text-sm text-gray-500",children:["Citation: ",n.citation_title]}),n.citation_confering_agency_body&&r.jsxs("div",{className:"text-sm text-gray-500",children:["Agency: ",n.citation_confering_agency_body]}),n.citation_year_received&&r.jsxs("div",{className:"text-sm text-gray-500",children:["Year: ",n.citation_year_received]})]}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>s(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500"}),"View Details"]}),r.jsxs("button",{onClick:()=>e(n),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500"}),"Edit Research"]}),r.jsxs("button",{onClick:()=>a(n.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-500"}),"Delete Research"]})]})})})]},n.id)),t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(gr,{className:"w-10 h-10 text-gray-400"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No training programs found"}),r.jsx("p",{className:"text-gray-600",children:"Get started by adding your first training program"})]})})})]})]})})}kg.propTypes={data:B.arrayOf(B.shape({id:B.number.isRequired,title:B.string.isRequired,duration_number_of_hours:B.number.isRequired,keywords:B.string.isRequired,number_of_trainees_beneficiaries:B.number.isRequired,citation_title:B.string,citation_confering_agency_body:B.string,citation_year_received:B.string})).isRequired,onView:B.func.isRequired,onEdit:B.func.isRequired,onDelete:B.func.isRequired};function pN({isOpen:t,onClose:s,researchData:e}){if(!e)return null;const a=(i,c="Not specified")=>i==null||i===""?c:typeof i=="object"?String(i)||c:String(i),n=i=>{switch(i==null?void 0:i.toLowerCase()){case"publications":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border-blue-300";case"conferences":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border-purple-300";case"other_outputs":return"bg-gradient-to-r from-emerald-100 to-emerald-200 text-emerald-800 border-emerald-300";case"citations":return"bg-gradient-to-r from-amber-100 to-amber-200 text-amber-800 border-amber-300";case"awards":return"bg-gradient-to-r from-indigo-100 to-indigo-200 text-indigo-800 border-indigo-300";case"extension":return"bg-gradient-to-r from-rose-100 to-rose-200 text-rose-800 border-rose-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border-gray-300"}};return r.jsx(mr,{isOpen:t,onClose:s,title:"Research Details",subtitle:"Research Information and Statistics",icon:ys,variant:"view",size:"xl",children:r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ys,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Research Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),r.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:a(e.title_of_article||e.title_of_research_paper||e.inventions||e.title)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),r.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full border ${n(e.type)}`,children:a(e.type)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Authors/Researchers"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.authors||e.researchers||e.citing_authors||e.name_of_researcher)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Year"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.year_of_publication||e.conference_date||e.date_of_issue||e.year_published_accepted_presented_received||e.citation_year_received)})]})]})]}),(e.title_of_article||e.name_of_book_journal)&&r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Publication Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Journal/Book"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.name_of_book_journal)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Volume/Issue"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.vol_no_issue_no)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pages"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.no_of_pages)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Editors"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.editors)})]})]})]}),(e.conference_title||e.conference_venue)&&r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(Lr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Conference Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Conference Title"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.conference_title)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Venue"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.conference_venue)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.conference_date)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organizer"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.conference_organizer)})]})]})]}),(e.inventions||e.patent_number)&&r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Zr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Other Research Outputs"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Invention"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.inventions)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Patent Number"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.patent_number)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Issue"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.date_of_issue)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Commercial Product"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.name_of_commercial_product)})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Utilization"}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.utilization_development&&r.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 border border-green-300",children:"Development"}),e.utilization_service&&r.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 border border-blue-300",children:"Service"}),e.utilization_end_product&&r.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800 border border-purple-300",children:"End Product"})]})]})]})]}),(e.citing_authors||e.citing_article_title)&&r.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 via-blue-50 to-cyan-100 rounded-xl p-4 border border-indigo-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-indigo-500 rounded-lg shadow-sm",children:r.jsx(pa,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Citation Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Citing Authors"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.citing_authors)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Article Title"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.citing_article_title)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Journal Title"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.journal_title)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Volume/Issue/Page"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.vol_issue_page_no)})]})]})]}),(e.title||e.duration_number_of_hours)&&r.jsxs("div",{className:"bg-gradient-to-br from-rose-50 via-pink-50 to-red-100 rounded-xl p-4 border border-rose-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-rose-500 rounded-lg shadow-sm",children:r.jsx(Jr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Extension Activities"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.title)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Duration"}),r.jsxs("p",{className:"text-sm text-gray-900",children:[a(e.duration_number_of_hours)," hours"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Beneficiaries"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.number_of_trainees_beneficiaries)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Agency/Body"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.citation_confering_agency_body)})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-gray-50 to-slate-100 rounded-xl p-4 border border-gray-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-gray-600 rounded-lg shadow-sm",children:r.jsx(pi,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Additional Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Keywords"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.keywords)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Points"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e.points||e.points_invention||e.points_commercial)})]})]})]})]})})}pN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,researchData:B.shape({type:B.string,keywords:B.string,points:B.oneOfType([B.string,B.number]),title_of_article:B.string,authors:B.string,name_of_book_journal:B.string,editors:B.string,vol_no_issue_no:B.string,no_of_pages:B.string,year_of_publication:B.string,title_of_research_paper:B.string,researchers:B.string,conference_title:B.string,conference_venue:B.string,conference_date:B.string,conference_organizer:B.string,type_of_conference:B.string,inventions:B.string,patent_number:B.string,date_of_issue:B.string,utilization_development:B.oneOfType([B.string,B.bool]),utilization_service:B.oneOfType([B.string,B.bool]),utilization_end_product:B.oneOfType([B.string,B.bool]),name_of_commercial_product:B.string,points_invention:B.oneOfType([B.string,B.number]),points_commercial:B.oneOfType([B.string,B.number]),citing_authors:B.string,citing_article_title:B.string,journal_title:B.string,vol_issue_page_no:B.string,city_year_published:B.string,publisher_name:B.string,title:B.string,duration_number_of_hours:B.string,number_of_trainees_beneficiaries:B.string,citation_title:B.string,citation_confering_agency_body:B.string,citation_year_received:B.string,name_of_researcher:B.string,year_published_accepted_presented_received:B.string})};function gN({isOpen:t,onClose:s,onUploadSuccess:e,institutionId:a}){const[n,i]=ne.useState(null),[c,l]=ne.useState(""),[u,o]=ne.useState(!1),[d,g]=ne.useState({}),[p,h]=ne.useState(new Date().getFullYear()),f=(z,P)=>{d[z]&&g(U=>({...U,[z]:""})),h(P)},x=()=>{const z={};return a||(z.institution="Institution ID is required"),p||(z.year="Please select a report year"),g(z),Object.keys(z).length===0},b=()=>{i(null),l("")},v=z=>{if(z===void 0||z===""||z===null)return null;const P=String(z).trim();return P.length>0?P:null},_={"Research T-B1":{type:"PUBLICATIONS",description:"Referred Publications",fields:["title_of_article","keywords","authors","name_of_book_journal","editors","vol_issue_no","no_of_pages","year_of_publication","type_of_publication","points"]},"Research T-B2":{type:"CONFERENCES",description:"Research Papers Presented in Conferences",fields:["title_of_research_paper","keywords","researchers","conference_title","venue","date","organizer","type_of_conference","points"]},"Research T-B3":{type:"OTHER_OUTPUTS",description:"Other Research Outputs",fields:["inventions","patent_number","date_of_issue","points_invention","utilization_development","utilization_service","utilization_end_product","name_of_commercial_product","points_commercial"]},"Research T-B4":{type:"CITATIONS",description:"Citations of Research Outputs",fields:["title_of_research_output","keywords","researchers","citing_authors","citing_article_title","journal_title","vol_issue_page","city_year_published","publisher","points"]},"Research T-B5":{type:"AWARDS",description:"Research Awards and Recognition",fields:["researcher_name","title_of_output_award","year_published_received","publisher_organizer_body","points"]},"Extension T-C":{type:"EXTENSION",description:"Extension Activities",fields:["title","keywords","duration_number_of_hours","number_of_trainees_beneficiaries","citation_title","citation_confering_agency_body","citation_year_received"]}},N=async z=>{const P=z.target.files[0];if(!P)return;if(!x()){Ft.showAlert("Please ensure institution and year are properly set before uploading.","error");return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(P.type)&&!P.name.match(/\.(xlsx|xls|csv)$/i)){Ft.showAlert("Please upload a valid Excel file (.xlsx, .xls) or CSV file.","error");return}o(!0),i("loading"),l("Processing Excel file...");try{const W=await P.arrayBuffer(),Y=so(W,{cellStyles:!0,cellFormulas:!0,cellDates:!0,cellNF:!0,sheetStubs:!0,type:"array"}),q=Y.SheetNames.filter(M=>Object.keys(_).includes(M)).map(M=>({name:M,..._[M]}));if(q.length===0)if(Y.SheetNames.length>0)q.push({name:Y.SheetNames[0],type:"RESEARCH_DATA",description:"Research Data (Default Sheet)",fields:[]});else throw new Error("No valid sheets found in the Excel file.");await E(Y,q)}catch(W){console.error("Excel upload error:",W),i("error"),l(`Error processing Excel file: ${W.message}`)}finally{o(!1),z.target.value=""}},E=async(z,P)=>{var q,M;const U=[],W=[];let Y="";for(const D of P)try{l(`Processing ${D.description} from ${D.name}...`);const T=z.Sheets[D.name],C=await O(T,D);U.push(...C),Y+=`Imported ${C.length} records from ${D.name}. `}catch(T){console.error(`Error processing sheet ${D.name}:`,T),W.push(`Error in ${D.name}: ${((M=(q=T.response)==null?void 0:q.data)==null?void 0:M.error)||T.message}`)}U.length>0?(e(),i("success"),l(Y.trim()),g({})):(i("error"),l(`No valid data imported. Errors: ${W.join("; ")}`))},O=async(z,P)=>{var U,W;try{l(`Processing ${P.description} and saving to database...`);const Y=Wo.sheet_to_json(z,{header:1,defval:"",raw:!1});console.log(`Parsed JSON data from ${P.name} sheet:`,Y);let q=-1;for(let j=0;j<Math.min(Y.length,15);j++){const A=Y[j];if(A&&A.length>2&&A.some(I=>I&&I.toString().includes(")"))){q=j;break}}if(console.log(`Header row index for ${P.name}: ${q}`),q===-1)throw new Error(`Could not find header row in the ${P.name} sheet. Please ensure the sheet has appropriate column headers.`);const M=q+1;if(M>=Y.length)throw new Error(`No data rows found in the ${P.name} sheet after header.`);const D=Y[q];console.log(`Headers for ${P.name}:`,D);const T=Y.slice(M).filter(j=>{if(!j||j.length===0)return!1;switch(P.type){case"PUBLICATIONS":return j[0]&&j[2];case"CONFERENCES":return j[0]&&j[2];case"OTHER_OUTPUTS":return j[0];case"CITATIONS":return j[2]&&j[3];case"AWARDS":return j[0]&&j[1];case"EXTENSION":return j[0]&&j[2];default:return!1}}).map((j,A)=>{try{const L={hei_uiid:a};switch(D.forEach((I,Z)=>{if(I&&j[Z]!==void 0){const K=I.toString().toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");L[K]=v(j[Z])}}),P.type){case"PUBLICATIONS":L.title_of_article=v(j[0]),L.keywords=v(j[1]),L.authors=v(j[2]),L.name_of_book_journal=v(j[3]),L.editors=v(j[4]),L.vol_no_issue_no=v(j[5]),L.no_of_pages=v(j[6]),L.year_of_publication=v(j[7]),L.points=v(j[8]);break;case"CONFERENCES":L.title_of_research_paper=v(j[0]),L.keywords=v(j[1]),L.researchers=v(j[2]),L.conference_title=v(j[3]),L.conference_venue=v(j[4]),L.conference_date=v(j[5]),L.conference_organizer=v(j[6]),L.type_of_conference=v(j[7]),L.points=v(j[8]);break;case"OTHER_OUTPUTS":L.inventions=v(j[0]),L.patent_number=v(j[1]),L.date_of_issue=v(j[2]),L.points_invention=v(j[3]),L.utilization_development=v(j[4]),L.utilization_service=v(j[5]),L.utilization_end_product=v(j[6]),L.name_of_commercial_product=v(j[7]),L.points_commercial=v(j[8]);break;case"CITATIONS":L.citing_authors=v(j[0]),L.citing_article_title=v(j[1]),L.journal_title=v(j[2]),L.vol_issue_page_no=v(j[3]),L.city_year_published=v(j[4]),L.publisher_name=v(j[5]),L.points=v(j[6]);break;case"AWARDS":L.name_of_researcher=v(j[0]),L.title_of_research_output_award=v(j[1]),L.year_published_accepted_presented_received=v(j[2]),L.publisher_conference_organizer_confering_body=v(j[3]),L.points=v(j[4]);break;case"EXTENSION":L.title=v(j[0]),L.keywords=v(j[1]),L.duration_number_of_hours=v(j[2]),L.number_of_trainees_beneficiaries=v(j[3]),L.citation_title=v(j[4]),L.citation_confering_agency_body=v(j[5]),L.citation_year_received=v(j[6]);break;default:throw new Error(`Unknown sheet type: ${P.type}`)}switch(P.type){case"PUBLICATIONS":if(!L.title_of_article||!L.authors)return null;break;case"CONFERENCES":if(!L.title_of_research_paper||!L.researchers)return null;break;case"OTHER_OUTPUTS":if(!L.inventions||!L.patent_number&&!L.utilization_development&&!L.utilization_service&&!L.utilization_end_product&&!L.name_of_commercial_product)return null;break;case"CITATIONS":if(!L.citing_authors||!L.citing_article_title)return null;break;case"AWARDS":if(!L.name_of_researcher||!L.title_of_research_output_award)return null;break;case"EXTENSION":if(!L.title||!L.duration_number_of_hours)return null;break}return L}catch(L){return console.warn(`Error processing row ${A+1} in ${P.name}:`,L),null}}).filter(j=>j!==null);if(T.length===0)throw new Error(`No valid research data found in the ${P.name} sheet.`);console.log(`Processed records from ${P.name}:`,T);let C="";switch(P.type){case"PUBLICATIONS":C="/research-tb1/bulk";break;case"CONFERENCES":C="/research-tb2/bulk";break;case"OTHER_OUTPUTS":C="/research-tb3/bulk";break;case"CITATIONS":C="/research-tb4/bulk";break;case"AWARDS":C="/research-tb5/bulk";break;case"EXTENSION":C="/research-tbc/bulk";break;default:throw new Error(`Unknown sheet type: ${P.type}`)}const S=localStorage.getItem("token"),w=await bt.post(`${Ct.API_URL}${C}`,{records:T},{headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"}});return console.log(`Research upload response from ${P.name}:`,w.data),T}catch(Y){throw console.error(`Research sheet processing error in ${P.name}:`,Y),new Error(((W=(U=Y.response)==null?void 0:U.data)==null?void 0:W.error)||`Failed to process research data in ${P.name}: ${Y.message}`)}},F=()=>{g({}),i(null),l(""),s()};return t?r.jsx(mr,{isOpen:t,onClose:F,title:"Upload Research & Extension Data",subtitle:"Import research publications, conferences, citations, awards, and extension activities",icon:Qr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4",children:[n&&r.jsx("div",{className:`p-4 rounded-xl border shadow-sm ${n==="success"?"bg-green-50/80 border-green-200 text-green-800":n==="error"?"bg-red-50/80 border-red-200 text-red-800":"bg-blue-50/80 border-blue-200 text-blue-800"}`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[n==="success"&&r.jsx(e0,{className:"w-5 h-5 mr-2"}),n==="error"&&r.jsx(Ht,{className:"w-5 h-5 mr-2"}),n==="loading"&&r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-800 mr-2"}),r.jsx("span",{className:"font-medium",children:c})]}),n!=="loading"&&r.jsx("button",{onClick:b,className:"text-gray-500 hover:text-gray-700 transition-colors duration-200",children:r.jsx(vs,{className:"w-4 h-4"})})]})}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(pa,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Upload Configuration"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution ID"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600",placeholder:"Institution ID will be auto-filled"}),d.institution&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.institution})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Report Year"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{value:p,onChange:z=>f("year",parseInt(z.target.value)),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${d.year?"border-red-300 bg-red-50":"border-gray-300"}`,children:Array.from({length:10},(z,P)=>{const U=new Date().getFullYear()-P;return r.jsx("option",{value:U,children:U},U)})}),d.year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.year})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(pi,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Excel Format Guidelines"})]}),r.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ys,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"Research & Extension Forms Structure:"}),r.jsxs("ul",{className:"space-y-1 ml-2",children:[r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),r.jsx("strong",{children:"Research T-B1:"})," Referred Publications"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),r.jsx("strong",{children:"Research T-B2:"})," Conference Papers"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),r.jsx("strong",{children:"Research T-B3:"})," Other Research Outputs"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),r.jsx("strong",{children:"Research T-B4:"})," Research Citations"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),r.jsx("strong",{children:"Research T-B5:"})," Awards & Recognition"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),r.jsx("strong",{children:"Extension T-C:"})," Extension Activities"]})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ui,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"The system will automatically detect research and extension data from each sheet and map columns to appropriate database fields."})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(qr,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"Supported formats: .xlsx, .xls, and .csv files with research and extension information"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($o,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"File Upload"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"file",id:"excel-upload",accept:".xlsx,.xls,.csv",onChange:N,disabled:u||!a,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),r.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200 ${!a||u?"border-gray-200 bg-gray-50/50":"border-slate-300 hover:border-slate-400 hover:bg-slate-50/50 bg-white"}`,children:[r.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${!a||u?"bg-gray-100":"bg-gradient-to-br from-slate-100 to-slate-200"}`,children:u?r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}):r.jsx(Qr,{className:`w-8 h-8 ${a?"text-slate-600":"text-gray-300"}`})}),r.jsx("p",{className:`text-lg font-semibold mb-2 ${!a||u?"text-gray-400":"text-gray-900"}`,children:u?"Processing File...":"Choose Research Excel File to Upload"}),r.jsx("p",{className:`text-sm mb-2 ${!a||u?"text-gray-400":"text-gray-600"}`,children:"Drag and drop or click to browse"}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-2",children:[r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:".xlsx"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:".xls"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:".csv"})]}),!a&&r.jsxs("div",{className:"flex items-center justify-center mt-3",children:[r.jsx(Ht,{className:"w-4 h-4 text-red-500 mr-1"}),r.jsx("span",{className:"text-sm text-red-500 font-medium",children:"Institution ID is required"})]}),n==="loading"&&r.jsxs("div",{className:"mt-4",children:[r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-2 rounded-full animate-pulse",style:{width:"60%"}})}),r.jsx("p",{className:"text-sm text-gray-600 mt-2",children:c})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx($o,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Supported Sheet Types"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded-full mr-2"}),r.jsx("span",{className:"font-medium",children:"Research T-B1:"}),r.jsx("span",{className:"ml-1 text-gray-600",children:"Publications"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded-full mr-2"}),r.jsx("span",{className:"font-medium",children:"Research T-B2:"}),r.jsx("span",{className:"ml-1 text-gray-600",children:"Conferences"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded-full mr-2"}),r.jsx("span",{className:"font-medium",children:"Research T-B3:"}),r.jsx("span",{className:"ml-1 text-gray-600",children:"Other Outputs"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded-full mr-2"}),r.jsx("span",{className:"font-medium",children:"Research T-B4:"}),r.jsx("span",{className:"ml-1 text-gray-600",children:"Citations"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded-full mr-2"}),r.jsx("span",{className:"font-medium",children:"Research T-B5:"}),r.jsx("span",{className:"ml-1 text-gray-600",children:"Awards"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded-full mr-2"}),r.jsx("span",{className:"font-medium",children:"Extension T-C:"}),r.jsx("span",{className:"ml-1 text-gray-600",children:"Extension Activities"})]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:F,disabled:u,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:u?"Processing...":"Close"}),n==="success"&&r.jsxs("button",{onClick:()=>{i(null),l("")},className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm hover:shadow-md transition-all duration-200 font-medium flex items-center justify-center",children:[r.jsx(Qr,{className:"w-4 h-4 mr-2"}),"Upload Another File"]})]})]})}):null}gN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onUploadSuccess:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired};function xN({isOpen:t,onClose:s,institutionId:e,onAddSuccess:a}){const[n,i]=ne.useState("TB1"),[c,l]=ne.useState(!1),[u,o]=ne.useState({hei_uiid:e||"",title_of_article:"",keywords:"",authors:"",name_of_book_journal:"",editors:"",vol_no_issue_no:"",no_of_pages:"",year_of_publication:new Date().getFullYear()}),[d,g]=ne.useState({hei_uiid:e||"",title_of_research_paper:"",keywords:"",researchers:"",conference_title:"",conference_venue:"",conference_date:"",conference_organizer:"",type_of_conference:""}),[p,h]=ne.useState({hei_uiid:e||"",inventions:"",patent_number:"",date_of_issue:"",utilization_development:!1,utilization_service:!1,name_of_commercial_product:"",points:0}),[f,x]=ne.useState({hei_uiid:e||"",keywords:"",researchers:"",citing_authors:"",citing_article_title:"",journal_title:"",vol_issue_page_no:"",city_year_published:"",publisher_name:""}),[b,v]=ne.useState({hei_uiid:e||"",name_of_researcher:"",title_of_research_output_award:"",year_published_accepted_presented_received:new Date().getFullYear(),publisher_conference_organizer_confering_body:""}),[_,N]=ne.useState({hei_uiid:e||"",title:"",keywords:"",duration_number_of_hours:"",number_of_trainees_beneficiaries:0,citation_title:"",citation_confering_agency_body:"",citation_year_received:""}),[E,O]=ne.useState({}),F=(Y,q,M)=>{switch(M){case"TB1":o(D=>({...D,[Y]:q}));break;case"TB2":g(D=>({...D,[Y]:q}));break;case"TB3":h(D=>({...D,[Y]:q}));break;case"TB4":x(D=>({...D,[Y]:q}));break;case"TB5":v(D=>({...D,[Y]:q}));break;case"TBC":N(D=>({...D,[Y]:q}));break}E[Y]&&O(D=>({...D,[Y]:""}))},z=()=>{const Y={};switch(n){case"TB1":u.title_of_article.trim()||(Y.title_of_article="Title of article is required"),u.keywords.trim()||(Y.keywords="Keywords are required"),u.authors.trim()||(Y.authors="Authors are required"),u.name_of_book_journal.trim()||(Y.name_of_book_journal="Journal name is required"),u.vol_no_issue_no.trim()||(Y.vol_no_issue_no="Volume/Issue number is required"),u.no_of_pages||(Y.no_of_pages="Number of pages is required"),u.year_of_publication||(Y.year_of_publication="Year of publication is required");break;case"TB2":d.title_of_research_paper.trim()||(Y.title_of_research_paper="Title of research paper is required"),d.keywords.trim()||(Y.keywords="Keywords are required"),d.researchers.trim()||(Y.researchers="Researchers are required"),d.conference_title.trim()||(Y.conference_title="Conference title is required"),d.conference_venue.trim()||(Y.conference_venue="Conference venue is required"),d.conference_date||(Y.conference_date="Conference date is required"),d.conference_organizer.trim()||(Y.conference_organizer="Conference organizer is required"),d.type_of_conference.trim()||(Y.type_of_conference="Type of conference is required");break;case"TB3":p.inventions.trim()||(Y.inventions="Inventions are required"),p.patent_number.trim()||(Y.patent_number="Patent number is required"),p.date_of_issue||(Y.date_of_issue="Date of issue is required"),p.name_of_commercial_product.trim()||(Y.name_of_commercial_product="Name of commercial product is required"),p.points||(Y.points="Points are required");break;case"TB4":f.keywords.trim()||(Y.keywords="Keywords are required"),f.researchers.trim()||(Y.researchers="Researchers are required"),f.citing_authors.trim()||(Y.citing_authors="Citing authors are required"),f.citing_article_title.trim()||(Y.citing_article_title="Citing article title is required"),f.journal_title.trim()||(Y.journal_title="Journal title is required"),f.vol_issue_page_no.trim()||(Y.vol_issue_page_no="Volume/Issue/Page number is required"),f.city_year_published.trim()||(Y.city_year_published="City and year published are required"),f.publisher_name.trim()||(Y.publisher_name="Publisher name is required");break;case"TB5":b.name_of_researcher.trim()||(Y.name_of_researcher="Name of researcher is required"),b.title_of_research_output_award.trim()||(Y.title_of_research_output_award="Title of research output/award is required"),b.year_published_accepted_presented_received||(Y.year_published_accepted_presented_received="Year is required"),b.publisher_conference_organizer_confering_body.trim()||(Y.publisher_conference_organizer_confering_body="Publisher/Conference organizer/Conferring body is required");break;case"TBC":_.title.trim()||(Y.title="Title is required"),_.keywords.trim()||(Y.keywords="Keywords are required"),_.duration_number_of_hours.trim()||(Y.duration_number_of_hours="Duration (number of hours) is required"),_.number_of_trainees_beneficiaries||(Y.number_of_trainees_beneficiaries="Number of trainees/beneficiaries is required");break}return O(Y),Object.keys(Y).length===0},P=async()=>{var Y,q;if(z())try{l(!0);let M;switch(n){case"TB1":M=u;break;case"TB2":M=d;break;case"TB3":M=p;break;case"TB4":M=f;break;case"TB5":M=b;break;case"TBC":M=_;break}(await bt.post(`${Ct.API_URL}/research-${n.toLowerCase()}`,M,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).status===201&&(jr.fire({icon:"success",title:"Success!",text:"Research has been added successfully."}),a(),s())}catch(M){console.error("Error adding research:",M),jr.fire({icon:"error",title:"Error!",text:((q=(Y=M.response)==null?void 0:Y.data)==null?void 0:q.message)||"Failed to add research."})}finally{l(!1)}},U=()=>{o({hei_uiid:e||"",title_of_article:"",keywords:"",authors:"",name_of_book_journal:"",editors:"",vol_no_issue_no:"",no_of_pages:"",year_of_publication:new Date().getFullYear()}),g({hei_uiid:e||"",title_of_research_paper:"",keywords:"",researchers:"",conference_title:"",conference_venue:"",conference_date:"",conference_organizer:"",type_of_conference:""}),h({hei_uiid:e||"",inventions:"",patent_number:"",date_of_issue:"",utilization_development:!1,utilization_service:!1,name_of_commercial_product:"",points:0}),x({hei_uiid:e||"",keywords:"",researchers:"",citing_authors:"",citing_article_title:"",journal_title:"",vol_issue_page_no:"",city_year_published:"",publisher_name:""}),v({hei_uiid:e||"",name_of_researcher:"",title_of_research_output_award:"",year_published_accepted_presented_received:new Date().getFullYear(),publisher_conference_organizer_confering_body:""}),N({hei_uiid:e||"",title:"",keywords:"",duration_number_of_hours:"",number_of_trainees_beneficiaries:0,citation_title:"",citation_confering_agency_body:"",citation_year_received:""}),O({}),s()},W=()=>{switch(n){case"TB1":return r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title of Article ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:u.title_of_article,onChange:Y=>F("title_of_article",Y.target.value,"TB1"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.title_of_article?"border-red-300 bg-red-50":"border-gray-300"}`}),E.title_of_article&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.title_of_article})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Keywords ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:u.keywords,onChange:Y=>F("keywords",Y.target.value,"TB1"),placeholder:"Separate keywords with commas",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.keywords?"border-red-300 bg-red-50":"border-gray-300"}`}),E.keywords&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.keywords})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Author(s) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:u.authors,onChange:Y=>F("authors",Y.target.value,"TB1"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.authors?"border-red-300 bg-red-50":"border-gray-300"}`}),E.authors&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.authors})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name of Book/Journal ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:u.name_of_book_journal,onChange:Y=>F("name_of_book_journal",Y.target.value,"TB1"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.name_of_book_journal?"border-red-300 bg-red-50":"border-gray-300"}`}),E.name_of_book_journal&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.name_of_book_journal})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Editors"}),r.jsx("input",{type:"text",value:u.editors,onChange:Y=>F("editors",Y.target.value,"TB1"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vol. No. / Issue No. ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:u.vol_no_issue_no,onChange:Y=>F("vol_no_issue_no",Y.target.value,"TB1"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.vol_no_issue_no?"border-red-300 bg-red-50":"border-gray-300"}`}),E.vol_no_issue_no&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.vol_no_issue_no})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["No. of Pages ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:u.no_of_pages,onChange:Y=>F("no_of_pages",Y.target.value,"TB1"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.no_of_pages?"border-red-300 bg-red-50":"border-gray-300"}`}),E.no_of_pages&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.no_of_pages})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Year of Publication ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:u.year_of_publication,onChange:Y=>F("year_of_publication",Y.target.value,"TB1"),min:"1900",max:new Date().getFullYear(),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.year_of_publication?"border-red-300 bg-red-50":"border-gray-300"}`}),E.year_of_publication&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.year_of_publication})]})]})});case"TB2":return r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title of Research Paper ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:d.title_of_research_paper,onChange:Y=>F("title_of_research_paper",Y.target.value,"TB2"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.title_of_research_paper?"border-red-300 bg-red-50":"border-gray-300"}`}),E.title_of_research_paper&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.title_of_research_paper})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Keywords ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:d.keywords,onChange:Y=>F("keywords",Y.target.value,"TB2"),placeholder:"Separate keywords with commas",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.keywords?"border-red-300 bg-red-50":"border-gray-300"}`}),E.keywords&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.keywords})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Researchers ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:d.researchers,onChange:Y=>F("researchers",Y.target.value,"TB2"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.researchers?"border-red-300 bg-red-50":"border-gray-300"}`}),E.researchers&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.researchers})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Conference Title ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:d.conference_title,onChange:Y=>F("conference_title",Y.target.value,"TB2"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.conference_title?"border-red-300 bg-red-50":"border-gray-300"}`}),E.conference_title&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.conference_title})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Conference Venue ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:d.conference_venue,onChange:Y=>F("conference_venue",Y.target.value,"TB2"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.conference_venue?"border-red-300 bg-red-50":"border-gray-300"}`}),E.conference_venue&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.conference_venue})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Conference Date ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",value:d.conference_date,onChange:Y=>F("conference_date",Y.target.value,"TB2"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.conference_date?"border-red-300 bg-red-50":"border-gray-300"}`}),E.conference_date&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.conference_date})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Conference Organizer ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:d.conference_organizer,onChange:Y=>F("conference_organizer",Y.target.value,"TB2"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.conference_organizer?"border-red-300 bg-red-50":"border-gray-300"}`}),E.conference_organizer&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.conference_organizer})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Type of Conference ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:d.type_of_conference,onChange:Y=>F("type_of_conference",Y.target.value,"TB2"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.type_of_conference?"border-red-300 bg-red-50":"border-gray-300"}`}),E.type_of_conference&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.type_of_conference})]})]})});case"TB3":return r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Inventions ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:p.inventions,onChange:Y=>F("inventions",Y.target.value,"TB3"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.inventions?"border-red-300 bg-red-50":"border-gray-300"}`}),E.inventions&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.inventions})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Patent Number ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:p.patent_number,onChange:Y=>F("patent_number",Y.target.value,"TB3"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.patent_number?"border-red-300 bg-red-50":"border-gray-300"}`}),E.patent_number&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.patent_number})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Issue ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",value:p.date_of_issue,onChange:Y=>F("date_of_issue",Y.target.value,"TB3"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.date_of_issue?"border-red-300 bg-red-50":"border-gray-300"}`}),E.date_of_issue&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.date_of_issue})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name of Commercial Product ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:p.name_of_commercial_product,onChange:Y=>F("name_of_commercial_product",Y.target.value,"TB3"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.name_of_commercial_product?"border-red-300 bg-red-50":"border-gray-300"}`}),E.name_of_commercial_product&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.name_of_commercial_product})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Points ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:p.points,onChange:Y=>F("points",Y.target.value,"TB3"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.points?"border-red-300 bg-red-50":"border-gray-300"}`}),E.points&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.points})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:p.utilization_development,onChange:Y=>F("utilization_development",Y.target.checked,"TB3"),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Utilization Development"})]}),r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:p.utilization_service,onChange:Y=>F("utilization_service",Y.target.checked,"TB3"),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Utilization Service"})]})]})]})});case"TB4":return r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Keywords ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.keywords,onChange:Y=>F("keywords",Y.target.value,"TB4"),placeholder:"Separate keywords with commas",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.keywords?"border-red-300 bg-red-50":"border-gray-300"}`}),E.keywords&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.keywords})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Researchers ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.researchers,onChange:Y=>F("researchers",Y.target.value,"TB4"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.researchers?"border-red-300 bg-red-50":"border-gray-300"}`}),E.researchers&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.researchers})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Citing Authors ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.citing_authors,onChange:Y=>F("citing_authors",Y.target.value,"TB4"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.citing_authors?"border-red-300 bg-red-50":"border-gray-300"}`}),E.citing_authors&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.citing_authors})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Citing Article Title ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.citing_article_title,onChange:Y=>F("citing_article_title",Y.target.value,"TB4"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.citing_article_title?"border-red-300 bg-red-50":"border-gray-300"}`}),E.citing_article_title&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.citing_article_title})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Journal Title ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.journal_title,onChange:Y=>F("journal_title",Y.target.value,"TB4"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.journal_title?"border-red-300 bg-red-50":"border-gray-300"}`}),E.journal_title&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.journal_title})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Volume/Issue/Page Number ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.vol_issue_page_no,onChange:Y=>F("vol_issue_page_no",Y.target.value,"TB4"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.vol_issue_page_no?"border-red-300 bg-red-50":"border-gray-300"}`}),E.vol_issue_page_no&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.vol_issue_page_no})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["City and Year Published ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.city_year_published,onChange:Y=>F("city_year_published",Y.target.value,"TB4"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.city_year_published?"border-red-300 bg-red-50":"border-gray-300"}`}),E.city_year_published&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.city_year_published})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Publisher Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.publisher_name,onChange:Y=>F("publisher_name",Y.target.value,"TB4"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.publisher_name?"border-red-300 bg-red-50":"border-gray-300"}`}),E.publisher_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.publisher_name})]})]})});case"TB5":return r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name of Researcher ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:b.name_of_researcher,onChange:Y=>F("name_of_researcher",Y.target.value,"TB5"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.name_of_researcher?"border-red-300 bg-red-50":"border-gray-300"}`}),E.name_of_researcher&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.name_of_researcher})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title of Research Output/Award ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:b.title_of_research_output_award,onChange:Y=>F("title_of_research_output_award",Y.target.value,"TB5"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.title_of_research_output_award?"border-red-300 bg-red-50":"border-gray-300"}`}),E.title_of_research_output_award&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.title_of_research_output_award})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Year Published/Accepted/Presented/Received ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:b.year_published_accepted_presented_received,onChange:Y=>F("year_published_accepted_presented_received",Y.target.value,"TB5"),min:"1900",max:new Date().getFullYear(),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.year_published_accepted_presented_received?"border-red-300 bg-red-50":"border-gray-300"}`}),E.year_published_accepted_presented_received&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.year_published_accepted_presented_received})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Publisher/Conference Organizer/Conferring Body ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:b.publisher_conference_organizer_confering_body,onChange:Y=>F("publisher_conference_organizer_confering_body",Y.target.value,"TB5"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.publisher_conference_organizer_confering_body?"border-red-300 bg-red-50":"border-gray-300"}`}),E.publisher_conference_organizer_confering_body&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.publisher_conference_organizer_confering_body})]})]})});case"TBC":return r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:_.title,onChange:Y=>F("title",Y.target.value,"TBC"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.title?"border-red-300 bg-red-50":"border-gray-300"}`}),E.title&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.title})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Keywords ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:_.keywords,onChange:Y=>F("keywords",Y.target.value,"TBC"),placeholder:"Separate keywords with commas",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.keywords?"border-red-300 bg-red-50":"border-gray-300"}`}),E.keywords&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.keywords})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Duration (Number of Hours) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:_.duration_number_of_hours,onChange:Y=>F("duration_number_of_hours",Y.target.value,"TBC"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.duration_number_of_hours?"border-red-300 bg-red-50":"border-gray-300"}`}),E.duration_number_of_hours&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.duration_number_of_hours})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Number of Trainees/Beneficiaries ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:_.number_of_trainees_beneficiaries,onChange:Y=>F("number_of_trainees_beneficiaries",Y.target.value,"TBC"),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${E.number_of_trainees_beneficiaries?"border-red-300 bg-red-50":"border-gray-300"}`}),E.number_of_trainees_beneficiaries&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.number_of_trainees_beneficiaries})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Citation Title"}),r.jsx("input",{type:"text",value:_.citation_title,onChange:Y=>F("citation_title",Y.target.value,"TBC"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Citation Confering Agency/Body"}),r.jsx("input",{type:"text",value:_.citation_confering_agency_body,onChange:Y=>F("citation_confering_agency_body",Y.target.value,"TBC"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Citation Year Received"}),r.jsx("input",{type:"text",value:_.citation_year_received,onChange:Y=>F("citation_year_received",Y.target.value,"TBC"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})});default:return null}};return r.jsx(mr,{isOpen:t,onClose:U,title:"Add New Research",subtitle:"Create a new research entry for the institution",icon:Er,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto p-4",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsx("nav",{className:"flex space-x-4",children:["TB1","TB2","TB3","TB4","TB5","TBC"].map(Y=>r.jsx("button",{onClick:()=>i(Y),className:`px-4 py-2 text-sm font-medium border-b-2 ${n===Y?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:Y==="TB1"?"Articles/Books":Y==="TB2"?"Conference Papers":Y==="TB3"?"Inventions/Patents":Y==="TB4"?"Citations":Y==="TB5"?"Awards":"Training Programs"},Y))})}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm",children:W()}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:U,disabled:c,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),r.jsx("button",{onClick:P,disabled:c,className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center",children:c?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2"}),"Create Research"]})})]})]})})}xN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired,onAddSuccess:B.func.isRequired};function Eq(){var L,I;const t=qs(),s=Aa(),{heiId:e}=Ko(),a=((L=t.state)==null?void 0:L.heiUiid)||e,n=((I=t.state)==null?void 0:I.heiName)||"Unknown Institution",[i,c]=ne.useState({research_tb1:[],research_tb2:[],research_tb3:[],research_tb4:[],research_tb5:[],research_tbc:[]}),[l,u]=ne.useState(!0),[o,d]=ne.useState(null),[g,p]=ne.useState(""),[h,f]=ne.useState("ALL"),[x,b]=ne.useState(!1),[v,_]=ne.useState(null),[N,E]=ne.useState(!1),[O,F]=ne.useState(!1),[z,P]=ne.useState(!1);ne.useEffect(()=>{U()},[a]);const U=async()=>{try{if(u(!0),d(null),!a)throw new Error("HEI ID is required");const Z=await bt.get(`${Ct.API_URL}/research/all/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});c(Z.data)}catch(Z){d(Z.message||"Failed to fetch research data")}finally{u(!1)}},W=Z=>{_(Z),E(!0)},Y=async Z=>{try{(await jr.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed&&(await bt.delete(`${Ct.API_URL}/research/${Z}`),await U(),jr.fire("Deleted!","Research has been deleted.","success"))}catch(K){console.error("Error deleting research:",K),jr.fire("Error!","Failed to delete research.","error")}},q=async()=>{try{b(!0);const Z=await bt.get(`${Ct.API_URL}/research/export/${a}`,{responseType:"blob"}),K=window.URL.createObjectURL(new Blob([Z.data])),re=document.createElement("a");re.href=K,re.setAttribute("download",`research_data_${a}.xlsx`),document.body.appendChild(re),re.click(),re.remove()}catch(Z){console.error("Error exporting research:",Z),jr.fire("Error!","Failed to export research data.","error")}finally{b(!1)}},M=()=>{F(!0)},D=()=>{P(!0)},T=()=>{s("/super-admin/institutions/suc")},C=()=>{E(!1),_(null)},S=()=>{F(!1)},w=()=>{P(!1)},j=()=>{const Z=g.toLowerCase();let K=[];switch(h){case"ALL":K=[...i.research_tb1,...i.research_tb2,...i.research_tb3,...i.research_tb4,...i.research_tb5,...i.research_tbc];break;case"TB1":K=i.research_tb1;break;case"TB2":K=i.research_tb2;break;case"TB3":K=i.research_tb3;break;case"TB4":K=i.research_tb4;break;case"TB5":K=i.research_tb5;break;case"TBC":K=i.research_tbc;break;default:K=[]}return K.filter(re=>Object.values(re).join(" ").toLowerCase().includes(Z))},A=()=>{const Z=j();switch(h){case"ALL":return r.jsxs("div",{className:"space-y-8",children:[i.research_tb1.length>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Articles/Books"}),r.jsx(_g,{data:i.research_tb1,onView:W,onDelete:Y})]}),i.research_tb2.length>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conference Papers"}),r.jsx(wg,{data:i.research_tb2,onView:W,onDelete:Y})]}),i.research_tb3.length>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Inventions/Patents"}),r.jsx(Ng,{data:i.research_tb3,onView:W,onDelete:Y})]}),i.research_tb4.length>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Citations"}),r.jsx(jg,{data:i.research_tb4,onView:W,onDelete:Y})]}),i.research_tb5.length>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Awards"}),r.jsx(Sg,{data:i.research_tb5,onView:W,onDelete:Y})]}),i.research_tbc.length>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Training Programs"}),r.jsx(kg,{data:i.research_tbc,onView:W,onDelete:Y})]}),Z.length===0&&r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-gray-500",children:"No research data found"})})]});case"TB1":return r.jsx(_g,{data:Z,onView:W,onDelete:Y});case"TB2":return r.jsx(wg,{data:Z,onView:W,onDelete:Y});case"TB3":return r.jsx(Ng,{data:Z,onView:W,onDelete:Y});case"TB4":return r.jsx(jg,{data:Z,onView:W,onDelete:Y});case"TB5":return r.jsx(Sg,{data:Z,onView:W,onDelete:Y});case"TBC":return r.jsx(kg,{data:Z,onView:W,onDelete:Y});default:return null}};return l?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):o?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"text-red-500",children:o})}):r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:[r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:T,className:"mr-4 p-2 text-gray-600 hover:text-gray-900 hover:bg-white/50 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Back to SUC List",children:r.jsx(Zo,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Research Management"}),r.jsxs("p",{className:"text-gray-600 flex items-center",children:[r.jsx(gr,{className:"w-4 h-4 mr-2"}),n]})]})]}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm mb-6",children:r.jsx("div",{className:"flex flex-col gap-4",children:r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center",children:[r.jsx("div",{className:"flex flex-col sm:flex-row gap-3 flex-1 w-full xl:w-auto",children:r.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search research...",value:g,onChange:Z=>p(Z.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-60 lg:w-80 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm transition-all duration-200"})]})}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full xl:w-auto",children:[r.jsxs("button",{onClick:D,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Research"]}),r.jsxs("button",{onClick:q,disabled:x,className:"inline-flex items-center justify-center px-4 py-2 bg-white/50 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-white hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(BC,{className:"w-4 h-4 mr-2"}),x?"Exporting...":"Export"]}),r.jsxs("button",{onClick:M,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg text-sm font-medium hover:from-green-700 hover:to-green-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500",children:[r.jsx(zC,{className:"w-4 h-4 mr-2"}),"Upload Excel"]})]})]})})})]}),o&&r.jsx("div",{className:"mb-6 p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(vs,{className:"w-5 h-5 mr-2"}),o]})}),r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl shadow-sm border border-white/20 overflow-hidden",children:[r.jsx("div",{className:"border-b border-gray-200/50",children:r.jsx("nav",{className:"flex overflow-x-auto",children:["ALL","TB1","TB2","TB3","TB4","TB5","TBC"].map(Z=>r.jsx("button",{onClick:()=>f(Z),className:`px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 transition-colors duration-200 ${h===Z?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:Z==="ALL"?"All Research":Z},Z))})}),r.jsx("div",{className:"p-6",children:A()})]})]}),r.jsx(pN,{isOpen:N,onClose:C,researchData:v}),r.jsx(gN,{isOpen:O,onClose:S,institutionId:a,onUploadSuccess:U}),r.jsx(xN,{isOpen:z,onClose:w,institutionId:a,onAddSuccess:U})]})}const Kf=({allowedRoles:t})=>{const s=JSON.parse(localStorage.getItem("user"));if(!localStorage.getItem("token")||!s)return r.jsx(Hp,{to:"/login",replace:!0});if(!t.includes(s.role)){const a={"super-admin":"/super-admin/dashboard","hei-admin":"/hei-admin/dashboard","hei-staff":"/hei-staff/dashboard"};return r.jsx(Hp,{to:a[s.role]||"/login",replace:!0})}return r.jsx(_w,{})};Kf.propTypes={allowedRoles:B.arrayOf(B.string).isRequired};const Tq=t=>({"super-admin":[{text:"Dashboard",icon:xp,path:"/super-admin/dashboard"},{text:"Institutions",icon:ui,path:"/super-admin/institutions"},{text:"Statistics",icon:Ug,path:"/super-admin/statistics"}],"hei-admin":[{text:"Dashboard",icon:xp,path:"/hei-admin/dashboard"},{text:"Institutions",icon:ui,path:"/hei-admin/institutions"}],"hei-staff":[{text:"Dashboard",icon:xp,path:"/hei-staff/dashboard"},{text:"Institutions",icon:ui,path:"/hei-staff/institutions"}]})[t]||[],Aq=t=>({"super-admin":[{text:"User Management",icon:Jr,path:"/super-admin/user-management"}],"hei-admin":[{text:"Staff Management",icon:Jr,path:"/hei-admin/staff-management"}],"hei-staff":[]})[t]||[],bN=({isSidebarOpen:t,setIsSidebarOpen:s,isNonMobile:e=!0,isMinimized:a,onNavigate:n=l=>console.log("Navigate to:",l),onLogout:i=()=>console.log("Logout clicked"),onFetchUser:c=()=>Promise.resolve({id:1,name:"John Doe",email:"john@example.com",role:"super-admin",profile_image:null})})=>{var E,O,F;const[l,u]=ne.useState(""),[o,d]=ne.useState(!1),[g,p]=ne.useState(null),h=Tq(g==null?void 0:g.role),f=Aq(g==null?void 0:g.role),x=z=>{n(z),u(z),e||s(!1)},b=async()=>{try{const z=await c();p(z)}catch(z){console.error("Failed to fetch user:",z)}};ne.useEffect(()=>{b()},[]);const v=async()=>{try{await i()}catch(z){console.error("Logout failed:",z)}},_=({text:z,icon:P,path:U})=>{const W=l===U;return r.jsx("li",{className:"mb-1",children:r.jsxs("button",{onClick:()=>x(U),className:`
                        w-full flex items-center px-4 py-3 rounded-lg transition-all duration-200
                        ${W?"bg-blue-500 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"}
                        ${a?"justify-center px-2":"justify-start"}
                    `,children:[r.jsx("div",{className:`flex items-center justify-center ${a?"":"mr-3"}`,children:r.jsx(P,{size:20})}),!a&&r.jsx("span",{className:"font-medium",children:z})]})},z)},N=()=>r.jsx("div",{className:`
                fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden
                ${t?"block":"hidden"}
            `,onClick:()=>s(!1)});return r.jsxs(r.Fragment,{children:[r.jsx(N,{}),r.jsxs("div",{className:`
                    fixed left-0 top-0 h-full bg-white shadow-xl z-50 flex flex-col
                    transition-all duration-300 ease-in-out
                    ${a?"w-16":"w-60"}
                    ${t?"translate-x-0":"-translate-x-full"}
                    md:${e?"relative":"fixed"}
                `,children:[r.jsx("div",{className:`p-${a?"3":"6"} border-b border-gray-200`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:`
                                rounded-full bg-blue-500 flex items-center justify-center text-white font-bold
                                ${a?"w-8 h-8 text-sm":"w-12 h-12 text-lg"}
                            `,children:"C"}),!a&&r.jsx("h1",{className:"text-lg font-semibold text-gray-800 leading-tight",children:"Information Management"})]}),!e&&r.jsx("button",{onClick:()=>s(!1),className:"p-1 rounded-md hover:bg-gray-100",children:r.jsx(yC,{size:20,className:"text-gray-600"})})]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto py-4",children:[r.jsx("div",{className:"px-3",children:r.jsx("ul",{className:"space-y-1",children:h.map(_)})}),f.length>0&&r.jsx("div",{className:"mt-6 px-3",children:r.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[r.jsxs("button",{onClick:()=>d(!o),className:`
                                        w-full flex items-center px-4 py-3 rounded-lg transition-all duration-200
                                        text-gray-700 hover:bg-gray-50
                                        ${a?"justify-center px-2":"justify-between"}
                                    `,children:[r.jsxs("div",{className:`flex items-center ${a?"":"space-x-3"}`,children:[r.jsx(Gl,{size:20}),!a&&r.jsx("span",{className:"font-medium",children:"Admin"})]}),!a&&r.jsx("div",{className:"ml-auto",children:o?r.jsx(_C,{size:16}):r.jsx(Vf,{size:16})})]}),r.jsx("div",{className:`
                                    overflow-hidden transition-all duration-300 ease-in-out
                                    ${o?"max-h-96 opacity-100":"max-h-0 opacity-0"}
                                `,children:r.jsx("ul",{className:`mt-2 space-y-1 ${a?"":"ml-4"}`,children:f.map(_)})})]})})]}),r.jsxs("div",{className:`p-${a?"2":"4"} border-t border-gray-200`,children:[r.jsx("div",{className:"mb-4",children:r.jsxs("div",{className:`
                            flex items-center space-x-3
                            ${a?"justify-center":"justify-start"}
                        `,children:[r.jsx("div",{className:"relative",children:g!=null&&g.profile_image?r.jsx("img",{src:g.profile_image,alt:"Profile",className:"w-10 h-10 rounded-full object-cover border-2 border-gray-200"}):r.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 text-white flex items-center justify-center font-medium text-sm border-2 border-gray-200",children:((O=(E=g==null?void 0:g.email)==null?void 0:E.charAt(0))==null?void 0:O.toUpperCase())||"U"})}),!a&&g&&r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:g.name}),r.jsx("p",{className:"text-xs text-gray-500 truncate capitalize",children:(F=g.role)==null?void 0:F.replace("-"," ")})]})]})}),r.jsxs("button",{onClick:v,className:`
                            flex items-center justify-center w-full bg-red-500 hover:bg-red-600
                            text-white font-medium rounded-lg transition-colors duration-200
                            ${a?"p-2":"px-4 py-2 space-x-2"}
                        `,title:"Log Out",children:[r.jsx(r3,{size:18}),!a&&r.jsx("span",{children:"Logout"})]})]})]})]})};bN.propTypes={drawerWidth:B.string,isSidebarOpen:B.bool.isRequired,setIsSidebarOpen:B.func.isRequired,isNonMobile:B.bool,isMinimized:B.bool.isRequired,onNavigate:B.func,onLogout:B.func,onFetchUser:B.func};const Cg="/assets/Profile-g8XIt7bn.png",yN=({open:t,onClose:s,user:e,fetchUserProfile:a})=>{var h;const[n,i]=ne.useState(!1),[c,l]=ne.useState({name:"",email:"",profile_image:"",password:"",confirmPassword:""}),[u,o]=ne.useState(!1),d=ne.useRef(null);ne.useEffect(()=>{e&&l({name:e.name||"",email:e.email||"",profile_image:e.profile_image||"",password:"",confirmPassword:""})},[e]);const g=async()=>{try{if(c.password.trim()!==""&&c.password!==c.confirmPassword){alert("Passwords do not match.");return}o(!0);const f=localStorage.getItem("token"),x={name:c.name,email:c.email,profile_image:c.profile_image,...c.password.trim()!==""?{password:c.password}:{}};await bt.patch(`${Ct.API_URL}/users/${e.id}`,x,{headers:{Authorization:`Bearer ${f}`}}),await a(),i(!1)}catch(f){console.error("Failed to update profile:",f),alert("Failed to update profile.")}finally{o(!1)}},p=f=>{const x=f.target.files[0];if(x){const b=new FileReader;b.onload=()=>{l(v=>({...v,profile_image:b.result}))},b.readAsDataURL(x)}};return t?r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 animate-fadeIn",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden w-full max-w-md mx-4 animate-scaleIn",children:[r.jsxs("div",{className:"bg-[#0038A8] text-white px-6 py-4 flex justify-between items-center",children:[r.jsx("h2",{className:"text-xl font-medium",children:n?"Edit Profile":"User Profile"}),r.jsx("button",{onClick:()=>{s(),i(!1)},className:"text-white hover:bg-white/10 p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-white/30","aria-label":"Close",children:r.jsx(vs,{size:20})})]}),r.jsx("div",{className:"w-full",children:e?n?r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex flex-col items-center mb-6",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-[#0038A8] overflow-hidden",children:r.jsx("img",{src:c.profile_image||Cg,alt:"Profile",className:"w-full h-full object-cover"})}),r.jsx("button",{className:"absolute bottom-0 right-0 p-1 rounded-full bg-[#0038A8] text-white hover:bg-[#002d85] focus:outline-none focus:ring-2 focus:ring-[#0038A8] focus:ring-offset-2",onClick:()=>d.current.click(),"aria-label":"Change profile picture",children:r.jsx(dC,{size:16})}),r.jsx("input",{type:"file",accept:"image/*",ref:d,className:"hidden",onChange:p})]}),r.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Click the camera icon to change your profile picture"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Full Name"}),r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex items-center justify-center min-w-[40px] bg-gray-100 border border-r-0 border-gray-300 rounded-l-md text-gray-500",children:r.jsx(ir,{size:16})}),r.jsx("input",{type:"text",value:c.name,onChange:f=>l({...c,name:f.target.value}),className:"flex-1 py-2 px-3 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2 focus:ring-[#0038A8] focus:border-[#0038A8]",placeholder:"Your name"})]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email Address"}),r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex items-center justify-center min-w-[40px] bg-gray-100 border border-r-0 border-gray-300 rounded-l-md text-gray-500",children:r.jsx(Dn,{size:16})}),r.jsx("input",{type:"email",value:c.email,onChange:f=>l({...c,email:f.target.value}),className:"flex-1 py-2 px-3 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2 focus:ring-[#0038A8] focus:border-[#0038A8]",placeholder:"your.email@example.com"})]})]}),r.jsxs("div",{className:"mt-6 mb-4",children:[r.jsx("h4",{className:"text-sm font-medium text-[#0038A8]",children:"Change Password (Optional)"}),r.jsx("div",{className:"h-0.5 w-12 bg-[#FCD116] rounded-full mt-1"}),r.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Leave blank to keep current password"})]}),r.jsxs("div",{className:" gap-6",children:[r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"New Password"}),r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex items-center justify-center min-w-[40px] bg-gray-100 border border-r-0 border-gray-300 rounded-l-md text-gray-500",children:r.jsx(t0,{size:16})}),r.jsx("input",{type:"password",value:c.password,onChange:f=>l({...c,password:f.target.value}),className:"flex-1 py-2 px-3 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2 focus:ring-[#0038A8] focus:border-[#0038A8]",placeholder:"New password"})]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Confirm Password"}),r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex items-center justify-center min-w-[40px] bg-gray-100 border border-r-0 border-gray-300 rounded-l-md text-gray-500",children:r.jsx(t0,{size:16})}),r.jsx("input",{type:"password",value:c.confirmPassword,onChange:f=>l({...c,confirmPassword:f.target.value}),className:`flex-1 py-2 px-3 border rounded-r-md focus:outline-none focus:ring-2 focus:ring-[#0038A8] focus:border-[#0038A8] ${c.confirmPassword!==""&&c.password!==c.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"Confirm password"})]}),c.confirmPassword!==""&&c.password!==c.confirmPassword&&r.jsx("p",{className:"mt-2 text-xs text-red-600",children:"Passwords do not match"})]})]})]})]}):r.jsxs("div",{children:[r.jsxs("div",{className:"bg-[#0038A8]/10 py-6 px-4 flex flex-col items-center",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-[#FCD116] overflow-hidden",children:r.jsx("img",{src:e.profile_image||Cg,alt:e.name,className:"w-full h-full object-cover"})}),r.jsx("div",{className:"absolute -inset-2 -z-10 bg-[#FCD116]/20 rounded-full blur-md"})]}),r.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:e.name}),r.jsx("span",{className:`mt-1 px-2 py-0.5 text-xs rounded-full ${((h=e.status)==null?void 0:h.toLowerCase())==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.status||"N/A"})]}),r.jsx("div",{className:"p-6",children:r.jsxs("ul",{className:"space-y-4",children:[r.jsxs("li",{className:"flex items-start pb-4 border-b border-gray-200",children:[r.jsx(Dn,{size:18,className:"mt-0.5 mr-3 text-gray-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Email"}),r.jsx("p",{className:"text-gray-800 font-medium",children:e.email})]})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx(Hf,{size:18,className:"mt-0.5 mr-3 text-gray-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Role"}),r.jsx("p",{className:"text-gray-800 font-medium",children:e.role||"N/A"})]})]}),r.jsx("div",{className:"h-1 bg-[#CD0000] w-16 rounded-full mt-4"})]})})]}):r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-[#0038A8]"})})}),r.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end",children:n?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{i(!1),l({name:e.name||"",email:e.email||"",profile_image:e.profile_image||"",password:"",confirmPassword:""})},className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-500 mr-3",children:"Cancel"}),r.jsx("button",{onClick:g,disabled:u,className:"inline-flex items-center px-4 py-2 text-white bg-[#0038A8] rounded-md hover:bg-[#002d85] focus:outline-none focus:ring-2 focus:ring-[#0038A8] focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{size:16,className:"mr-2"}),"Save Changes"]})})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-500 mr-3",children:"Close"}),r.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 text-white bg-[#0038A8] rounded-md hover:bg-[#002d85] focus:outline-none focus:ring-2 focus:ring-[#0038A8] focus:ring-offset-2",children:[r.jsx(Dr,{size:16,className:"mr-2"}),"Edit Profile"]})]})})]}),r.jsx("style",{children:`
                @keyframes fadeIn {
                    from {
                        opacity: 0;
                    }
                    to {
                        opacity: 1;
                    }
                }
                @keyframes scaleIn {
                    from {
                        transform: scale(0.95);
                        opacity: 0;
                    }
                    to {
                        transform: scale(1);
                        opacity: 1;
                    }
                }
                .animate-fadeIn {
                    animation: fadeIn 0.2s ease-out;
                }
                .animate-scaleIn {
                    animation: scaleIn 0.3s ease-out;
                }
            `})]}):null};yN.propTypes={open:B.bool.isRequired,onClose:B.func.isRequired,user:B.shape({id:B.string,name:B.string,email:B.string,profile_image:B.string,status:B.string,role:B.string}),setUser:B.func,fetchUserProfile:B.func.isRequired};const Oq=()=>{const t=Aa(),s=qs(),[e,a]=ne.useState(null),[n,i]=ne.useState(null),[c,l]=ne.useState(0),[u,o]=ne.useState(!1),[d,g]=ne.useState(!1),[p,h]=ne.useState(!1),f=ne.useMemo(()=>{const O=n==null?void 0:n.role;return{"super-admin":[{text:"Dashboard",path:"/super-admin/dashboard",icon:bp},{text:"Institutions",icon:Ya,dropdown:[{text:"SUC",path:"/super-admin/institutions/suc"},{text:"LUC",path:"/super-admin/institutions/luc"},{text:"PRIVATE",path:"/super-admin/institutions/private"}]},{text:"Admin",icon:vf,dropdown:[{text:"User Management",path:"/super-admin/user-management",icon:Jr},{text:"System Management",path:"/super-admin/system-management",icon:vf},{text:"HEI List",path:"/super-admin/hei-management",icon:t2}]}],"hei-admin":[{text:"Dashboard",path:"/hei-admin/dashboard",icon:bp},{text:"Institutions",icon:Ya,dropdown:[{text:"SUC",path:"/hei-admin/institutions/suc"},{text:"LUC",path:"/hei-admin/institutions/luc"},{text:"PRIVATE",path:"/hei-admin/institutions/private"}]},{text:"Admin",icon:vf,dropdown:[{text:"Staff Management",path:"/hei-admin/staff-management",icon:Jr},{text:"System Management",path:"/hei-admin/system-management",icon:vf},{text:"HEI List",path:"/hei-admin/hei-list",icon:t2}]}],"hei-staff":[{text:"Dashboard",path:"/hei-staff/dashboard",icon:bp},{text:"Institutions",icon:Ya,dropdown:[{text:"SUC",path:"/hei-staff/institutions/suc"},{text:"LUC",path:"/hei-staff/institutions/luc"},{text:"PRIVATE",path:"/hei-staff/institutions/private"}]}]}[O]||[]},[n]),x=ne.useCallback(async()=>{try{g(!0);const O=localStorage.getItem("token"),F=JSON.parse(localStorage.getItem("user"));if(!O)throw new Error("Authentication token missing");if(!(F!=null&&F.id))throw new Error("User data not found");const z=await bt.get(`${Ct.API_URL}/me`,{headers:{Authorization:`Bearer ${O}`}});i(z.data)}catch(O){console.error("Fetch user error:",O)}finally{g(!1)}},[]),b=ne.useCallback(O=>{d||(a(null),h(!1),t(O))},[d,t]),v=ne.useCallback(O=>{d||a(F=>F===O?null:O)},[d]),_=ne.useCallback(async()=>{g(!0);try{const O=localStorage.getItem("token");if(!O)throw new Error("Authentication token missing");await bt.post(`${Ct.API_URL}/auth/logout`,{},{headers:{Authorization:`Bearer ${O}`},timeout:5e3}),localStorage.clear(),i(null),t("/",{replace:!0}),window.location.reload()}catch(O){console.error("Logout error:",O),localStorage.clear(),i(null),t("/",{replace:!0}),window.location.reload()}finally{g(!1)}},[t]);ne.useEffect(()=>{const O=s.pathname,F=f.findIndex(z=>z.path?z.path===O||O.startsWith(z.path+"/"):z.dropdown?z.dropdown.some(P=>P.path===O||O.startsWith(P.path+"/")):!1);l(F>=0?F:0)},[s.pathname,f]),ne.useEffect(()=>{x()},[x]),ne.useEffect(()=>{const O=F=>{e&&!F.target.closest("[data-dropdown]")&&a(null)};return document.addEventListener("mousedown",O),()=>{document.removeEventListener("mousedown",O)}},[e]);const N=ne.useCallback(()=>({"super-admin":"/super-admin/dashboard","hei-admin":"/hei-admin/dashboard","hei-staff":"/hei-staff/dashboard"})[n==null?void 0:n.role]||"/",[n]),E=ne.useCallback(O=>{const F=s.pathname;return O.some(z=>z.path===F||F.startsWith(z.path+"/"))},[s.pathname]);return r.jsxs(r.Fragment,{children:[r.jsxs("nav",{className:"sticky top-0 z-50 bg-[#0038A8] shadow-lg",children:[r.jsxs("div",{className:"max-w-[100vw] mx-auto flex justify-between items-center px-4 md:px-6",children:[r.jsxs("div",{className:"flex items-center gap-3 py-3 cursor-pointer group transition-transform duration-200 hover:scale-[1.01]",onClick:()=>b(N()),children:[r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:z0,alt:"CHEDRO IX Logo",className:"h-12 w-12 object-contain"}),r.jsx("div",{className:"absolute inset-0 bg-[#FCD116]/30 rounded-full filter blur-md opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h1",{className:"text-xl font-bold text-white tracking-wide",children:"CHEDRO IX"}),r.jsx("p",{className:"text-[0.65rem] text-white/80 tracking-wider hidden sm:block",children:"HIGHER EDUCATION MANAGEMENT INFORMATION SYSTEM"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"hidden md:flex items-center space-x-1",children:f.map((O,F)=>{const{text:z,path:P,icon:U,dropdown:W}=O,Y=W&&W.length>0,q=P?c===F:c===F||E(W);return r.jsxs("div",{className:"relative","data-dropdown":!0,children:[r.jsxs("button",{onClick:()=>{P?b(P):Y&&v(`nav-${F}`)},className:`flex items-center gap-1.5 px-3 py-2 rounded-md text-sm font-medium transition-all
                                                ${q?"text-white bg-white/15":"text-white/85 hover:text-white hover:bg-white/10"}
                                                ${d?"cursor-not-allowed opacity-60":"hover:translate-y-[-1px]"}
                                            `,disabled:d,children:[U&&r.jsx(U,{size:16,className:"shrink-0"}),r.jsx("span",{children:z}),Y&&r.jsx(Vf,{size:14,className:`transition-transform duration-200 ${e===`nav-${F}`?"rotate-180":""}`})]}),Y&&e===`nav-${F}`&&r.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 p-1 z-50 animate-fadeIn",children:W.map(M=>r.jsxs("button",{onClick:()=>b(M.path),className:"flex items-center w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md transition-colors",children:[M.icon&&r.jsx(M.icon,{size:16,className:"mr-2 text-[#0038A8]"}),M.text]},M.text))})]},z)})}),r.jsxs("div",{className:"flex items-center gap-2",children:[d?r.jsx("div",{className:"h-8 w-8 rounded-full bg-white/20 animate-pulse"}):n?r.jsxs("div",{className:"relative","data-dropdown":!0,children:[r.jsxs("button",{onClick:()=>v("user"),className:"flex items-center space-x-1 group","aria-expanded":e==="user","aria-haspopup":"true",children:[r.jsx("div",{className:"relative w-9 h-9 overflow-hidden rounded-full border-2 border-[#FCD116] group-hover:border-white transition-colors",children:r.jsx("img",{src:n.profile_image||Cg,alt:"User",className:"w-full h-full object-cover"})}),r.jsx(Vf,{size:16,className:`text-white transition-transform duration-200 ${e==="user"?"rotate-180":""}`})]}),e==="user"&&r.jsxs("div",{className:"absolute right-0 mt-1 w-52 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 p-1 z-50 animate-fadeIn",children:[r.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:n.name}),r.jsx("p",{className:"text-xs text-gray-500 truncate",children:n.email})]}),r.jsxs("button",{onClick:()=>{a(null),o(!0)},className:"flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md",children:[r.jsx(ir,{size:16,className:"mr-2 text-[#0038A8]"}),"My Profile"]}),r.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:r.jsxs("button",{onClick:()=>{a(null),_()},className:"flex items-center w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",disabled:d,children:[r.jsx(r3,{size:16,className:"mr-2"}),d?"Logging out...":"Logout"]})})]})]}):null,r.jsx("button",{className:"md:hidden p-2 rounded-md text-white hover:bg-white/10 focus:outline-none",onClick:()=>h(!p),children:p?r.jsx(vs,{size:20,"aria-hidden":"true"}):r.jsx(sE,{size:20,"aria-hidden":"true"})})]})]})]}),p&&r.jsx("div",{className:"md:hidden bg-[#0038A8] border-t border-white/10",children:r.jsx("div",{className:"px-4 py-2 space-y-1",children:f.map((O,F)=>{const{text:z,path:P,icon:U,dropdown:W}=O,Y=W&&W.length>0,q=P?c===F:c===F||E(W);return r.jsxs("div",{"data-dropdown":!0,children:[r.jsxs("button",{onClick:()=>{P?b(P):Y&&v(`mobile-nav-${F}`)},className:`flex items-center justify-between w-full px-3 py-2 rounded-md text-sm font-medium transition-colors
                                                ${q?"text-white bg-white/15":"text-white/85 hover:text-white hover:bg-white/10"}
                                            `,children:[r.jsxs("div",{className:"flex items-center gap-2",children:[U&&r.jsx(U,{size:16}),r.jsx("span",{children:z})]}),Y&&r.jsx(Vf,{size:14,className:`transition-transform duration-200 ${e===`mobile-nav-${F}`?"rotate-180":""}`})]}),Y&&e===`mobile-nav-${F}`&&r.jsx("div",{className:"ml-4 mt-1 space-y-1",children:W.map(M=>r.jsxs("button",{onClick:()=>b(M.path),className:"flex items-center w-full text-left px-3 py-2 text-sm text-white/80 hover:text-white hover:bg-white/10 rounded-md transition-colors",children:[M.icon&&r.jsx(M.icon,{size:14,className:"mr-2"}),M.text]},M.text))})]},z)})})})]}),r.jsx("div",{className:"h-1 bg-[#CD0000] w-full shadow-sm"}),r.jsx("style",{children:`
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(-10px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                .animate-fadeIn {
                    animation: fadeIn 0.2s ease-out forwards;
                }
            `}),r.jsx(yN,{open:u,onClose:()=>o(!1),user:n,setUser:i,fetchUserProfile:x})]})},vN=({className:t=""})=>r.jsx("svg",{className:`w-6 h-6 ${t}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})});vN.propTypes={className:B.string};const _N=({userRole:t})=>{const[s,e]=ne.useState(!1),[a,n]=ne.useState(!1),[i,c]=ne.useState(!1);return r.jsxs("div",{className:"flex flex-col w-full h-full",children:[r.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-blue-600 shadow-md sm:hidden",children:r.jsxs("div",{className:"flex items-center px-4 py-3",children:[r.jsx("button",{onClick:()=>c(!i),className:"text-white hover:bg-blue-700 p-2 rounded-md transition-colors duration-200 mr-2","aria-label":"Toggle mobile menu",children:r.jsx(vN,{})}),r.jsx("h1",{className:"flex-1 text-center text-white text-xl font-bold",children:"CHEDRO IX"})]})}),i&&r.jsx("div",{className:"sm:hidden",children:r.jsx(bN,{userRole:t,isNonMobile:!1,drawerWidth:"300px",isSidebarOpen:i,setIsSidebarOpen:c,isMinimized:a,setIsMinimized:n})}),r.jsxs("div",{className:"flex-1 mt-16 sm:mt-0",children:[r.jsx("div",{className:"hidden sm:block",children:r.jsx(Oq,{isNonMobile:!0,isSidebarOpen:s,setIsSidebarOpen:e,isMinimized:a,setIsMinimized:n})}),r.jsx(_w,{})]})]})};_N.propTypes={userRole:B.string};const Rq=()=>{const[t,s]=ne.useState(10),[e,a]=ne.useState(!1),[n,i]=ne.useState(!1);ne.useEffect(()=>{const u=JSON.parse(localStorage.getItem("user"));i(!!u)},[]);const c=Aa(),l=()=>{a(!0);const u=JSON.parse(localStorage.getItem("user"));if(u){const o=u.role==="super-admin"?"/super-admin/dashboard":u.role==="hei-admin"?"/hei-admin/dashboard":"/hei-staff/dashboard";c(o)}else c("/")};return ne.useEffect(()=>{if(!e&&t>0){const u=setTimeout(()=>s(t-1),1e3);return()=>clearTimeout(u)}t===0&&l()},[t,e]),r.jsxs("div",{className:"fixed inset-0 flex flex-col items-center justify-center bg-gradient-to-b from-blue-900 via-blue-800 to-blue-900 text-white overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 z-0 opacity-10 animate-spin-slow",children:[...Array(18)].map((u,o)=>r.jsx("div",{className:"absolute origin-center left-1/2 top-1/2 bg-yellow-400 -translate-x-1/2 -translate-y-1/2",style:{height:"150vh",width:"12px",transform:`translate(-50%, -50%) rotate(${o*20}deg)`}},o))}),r.jsxs("div",{className:"relative z-10 mb-8",children:[r.jsx("div",{className:"flex items-center justify-center",children:r.jsx("div",{className:"w-32 h-32 flex items-center justify-center mb-4",children:r.jsx("img",{src:z0,alt:"CHED Logo",className:"w-full h-full object-contain filter drop-shadow-lg"})})}),r.jsx("p",{className:"text-xs font-semibold text-white text-center mt-2",children:"COMMISSION ON HIGHER EDUCATION"})]}),r.jsxs("div",{className:"relative z-10 max-w-md text-center px-6",children:[r.jsxs("div",{className:"relative mb-4",children:[r.jsx("h1",{className:"text-9xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-red-500 filter drop-shadow-lg",children:"404"}),r.jsx("div",{className:"absolute -inset-0.5 text-9xl font-extrabold text-blue-300 opacity-20 animate-pulse",children:"404"})]}),r.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Page not found"}),r.jsx("p",{className:"text-gray-200 mb-8",children:"The page you are looking for might have been removed, had its name changed, or is temporarily unavailable."}),r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"w-full bg-blue-200 bg-opacity-30 rounded-full h-2.5",children:r.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full transition-all duration-1000 ease-linear",style:{width:`${t*10}%`}})}),r.jsxs("p",{className:"text-sm text-gray-200",children:["Redirecting ",n?"to dashboard":"to home"," in ",r.jsx("span",{className:"font-bold text-yellow-400",children:t})," seconds"]}),r.jsx("button",{onClick:l,className:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-red-500 text-white font-medium rounded-lg shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-opacity-50",children:e?r.jsxs("span",{className:"flex items-center justify-center",children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Redirecting..."]}):n?"Back to Dashboard":"Back to Home"})]})]}),r.jsxs("div",{className:"absolute bottom-4 text-center text-xs text-gray-300 opacity-70",children:[" ",new Date().getFullYear()," Commission on Higher Education"]}),r.jsx("style",{children:`
                @keyframes float {
                    0% { transform: translateY(0) rotate(0deg); }
                    50% { transform: translateY(-20px) rotate(180deg); }
                    100% { transform: translateY(0) rotate(360deg); }
                }
            `})]})},wN=({isOpen:t,onClose:s,userData:e})=>{var c,l;if(!t||!e)return null;const a=u=>{switch(u==null?void 0:u.toLowerCase()){case"super-admin":return"bg-gradient-to-r from-red-100 to-red-200 text-red-800 border border-red-300";case"hei-admin":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border border-purple-300";case"hei-staff":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border border-blue-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border border-gray-300"}},n=u=>{switch(u==null?void 0:u.toLowerCase()){case"super-admin":case"hei-admin":case"admin":return r.jsx(Gl,{className:"w-3 h-3"});case"hei-staff":case"moderator":return r.jsx(eo,{className:"w-3 h-3"});case"user":return r.jsx(ir,{className:"w-3 h-3"});default:return r.jsx(ir,{className:"w-3 h-3"})}},i=u=>u?u.split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "):"N/A";return r.jsx(mr,{isOpen:t,onClose:s,title:"User Details",subtitle:"View comprehensive user information and account status",icon:ir,variant:"default",size:"lg",children:r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto p-4",children:[r.jsx("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-blue-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center shadow-lg",children:e.profile_image?r.jsx("img",{src:e.profile_image,alt:e.name,className:"w-16 h-16 rounded-full object-cover border-3 border-white shadow-sm"}):r.jsx(ir,{className:"w-8 h-8 text-white"})}),e.status==="active"&&r.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-2 border-white flex items-center justify-center",children:r.jsx(e0,{className:"w-3 h-3 text-white"})})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"text-xl font-semibold text-gray-900 mb-1",children:e.name||"N/A"}),r.jsxs("div",{className:"flex items-center text-gray-600 mb-2",children:[r.jsx(Dn,{className:"w-4 h-4 mr-2"}),r.jsx("span",{className:"text-sm",children:e.email||"N/A"})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 text-xs font-semibold rounded-full ${a(e.role)}`,children:[n(e.role),r.jsx("span",{className:"ml-1",children:i(e.role)})]}),r.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 text-xs font-semibold rounded-full ${e.status==="active"?"bg-gradient-to-r from-green-100 to-green-200 text-green-800 border border-green-300":"bg-gradient-to-r from-red-100 to-red-200 text-red-800 border border-red-300"}`,children:[e.status==="active"?r.jsx(eo,{className:"w-3 h-3"}):r.jsx(Zp,{className:"w-3 h-3"}),r.jsx("span",{className:"ml-1 capitalize",children:e.status||"N/A"})]})]})]})]})}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(Gl,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Account Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Role"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-purple-200/40",children:r.jsx("p",{className:"text-sm font-medium text-gray-900",children:i(e.role)})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Status"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-purple-200/40",children:r.jsx("p",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"N/A"})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Verification"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-purple-200/40",children:r.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${e.email_verified_at?"bg-gradient-to-r from-green-100 to-green-200 text-green-800":"bg-gradient-to-r from-yellow-100 to-yellow-200 text-yellow-800"}`,children:[e.email_verified_at?r.jsx(e0,{className:"w-3 h-3 mr-1"}):r.jsx(Zp,{className:"w-3 h-3 mr-1"}),e.email_verified_at?"Verified":"Pending"]})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User ID"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-purple-200/40",children:r.jsx("p",{className:"text-sm font-mono text-gray-700",children:e.id||"N/A"})})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Ya,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Institution Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institution Name"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-amber-200/40",children:r.jsx("p",{className:"text-sm font-medium text-gray-900",children:((c=e.hei)==null?void 0:c.name)||"No institution assigned"})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institution ID"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-amber-200/40",children:r.jsx("p",{className:"text-sm font-mono text-gray-700",children:e.hei_uiid||"N/A"})})]}),((l=e.hei)==null?void 0:l.type)&&r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institution Type"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-amber-200/40",children:r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.hei.type})})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(Lr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Timeline Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Created"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-emerald-200/40",children:r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.created_at?new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Updated"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-emerald-200/40",children:r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.updated_at?new Date(e.updated_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})})]}),e.email_verified_at&&r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Verified On"}),r.jsx("div",{className:"p-3 bg-white/60 backdrop-blur-sm rounded-lg border border-emerald-200/40",children:r.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(e.email_verified_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})})]})]})]}),r.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:r.jsx("button",{onClick:s,className:"px-6 py-2.5 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 shadow-sm hover:shadow-md transition-all duration-200 font-medium",children:"Close"})})]})})};wN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,userData:B.shape({id:B.oneOfType([B.string,B.number]),name:B.string,email:B.string,role:B.string,status:B.oneOf(["active","inactive"]),profile_image:B.string,created_at:B.string,updated_at:B.string,email_verified_at:B.string,hei_uiid:B.string,hei:B.shape({name:B.string,type:B.string})})};const NN=({isOpen:t,onClose:s,onSave:e,loading:a})=>{const[n,i]=ne.useState({name:"",email:"",password:"",password_confirmation:"",role:"hei-staff",status:"active",hei_uiid:""}),[c,l]=ne.useState({}),[u,o]=ne.useState([]),[d,g]=ne.useState(""),[p,h]=ne.useState(!1),f=ne.useRef(null);ne.useEffect(()=>{t&&x()},[t]),ne.useEffect(()=>{const P=U=>{f.current&&!f.current.contains(U.target)&&h(!1)};return document.addEventListener("mousedown",P),()=>{document.removeEventListener("mousedown",P)}},[]);const x=async()=>{var P;try{const U=await bt.get(`${Ct.API_URL}/heis`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}}),W=((P=U.data)==null?void 0:P.data)||U.data||[];o(Array.isArray(W)?W:[])}catch(U){console.error("Error fetching HEI options:",U),o([])}},b=P=>{const U=P.target.value;g(U),h(!0)},v=P=>{i(U=>({...U,hei_uiid:P.uiid})),g(P.name),h(!1)},_=()=>{i(P=>({...P,hei_uiid:""})),g("")},N=P=>{const{name:U,value:W}=P.target;i(Y=>({...Y,[U]:W})),c[U]&&l(Y=>({...Y,[U]:""}))},E=()=>{const P={};return n.name.trim()||(P.name="Name is required"),n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(P.email="Email format is invalid"):P.email="Email is required",n.password?n.password.length<8&&(P.password="Password must be at least 8 characters"):P.password="Password is required",n.password!==n.password_confirmation&&(P.password_confirmation="Passwords do not match"),l(P),Object.keys(P).length===0},O=async P=>{P.preventDefault(),E()&&(await e(n),i({name:"",email:"",password:"",password_confirmation:"",role:"hei-staff",status:"active",hei_uiid:""}),l({}))},F=()=>{i({name:"",email:"",password:"",password_confirmation:"",role:"hei-staff",status:"active",hei_uiid:""}),l({}),s()},z=()=>{const P=u.filter(U=>{var W;return U.name.toLowerCase().includes(d.toLowerCase())||((W=U.type)==null?void 0:W.toLowerCase().includes(d.toLowerCase()))});return r.jsxs("div",{className:"relative",ref:f,children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Associated Institution (Optional)"}),r.jsxs("div",{className:"relative",children:[r.jsxs("div",{className:"relative",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-3 h-3"}),r.jsx("input",{type:"text",value:d,onChange:b,onFocus:()=>h(!0),placeholder:"Search for an institution...",className:"w-full pl-9 pr-9 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors duration-200"}),n.hei_uiid&&r.jsx("button",{type:"button",onClick:_,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r.jsx(vs,{className:"w-3 h-3"})})]}),p&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>h(!1)}),r.jsx("div",{className:"absolute z-50 w-full bg-white border border-gray-200 rounded-lg shadow-xl",style:{top:"100%",marginTop:"4px",maxHeight:"200px",overflowY:"auto"},children:P.length>0?r.jsx("div",{className:"py-1",children:P.map(U=>r.jsxs("button",{type:"button",onClick:()=>v(U),className:"w-full px-4 py-2 text-left hover:bg-amber-50 focus:bg-amber-50 focus:outline-none transition-colors duration-150 border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-sm text-gray-900 truncate",children:U.name}),U.type&&r.jsx("div",{className:"text-xs text-gray-500 truncate",children:U.type})]},U.uiid))}):r.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:d?"No institutions found":"Start typing to search..."})})]})]}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Leave blank if the user is not associated with any specific institution"})]})};return r.jsx(mr,{isOpen:t,onClose:F,title:"Add New User",subtitle:"Create a new user account with appropriate permissions",icon:Er,variant:"default",size:"lg",children:r.jsxs("form",{onSubmit:O,className:"space-y-3 max-h-[600px] overflow-y-auto p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-3 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Personal Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Full Name"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",name:"name",value:n.name,onChange:N,placeholder:"Enter full name",className:`w-full px-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${c.name?"border-red-300 bg-red-50":"border-gray-300"}`}),c.name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[r.jsx(Dn,{className:"w-3 h-3 inline mr-1"}),"Email Address"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"email",name:"email",value:n.email,onChange:N,placeholder:"Enter email address",className:`w-full px-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${c.email?"border-red-300 bg-red-50":"border-gray-300"}`}),c.email&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.email})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-3 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(t0,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Security Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Password ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"password",name:"password",value:n.password,onChange:N,placeholder:"Enter password (min. 8 characters)",className:`w-full px-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${c.password?"border-red-300 bg-red-50":"border-gray-300"}`}),c.password&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.password})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Confirm Password"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"password",name:"password_confirmation",value:n.password_confirmation,onChange:N,placeholder:"Confirm password",className:`w-full px-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${c.password_confirmation?"border-red-300 bg-red-50":"border-gray-300"}`}),c.password_confirmation&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.password_confirmation})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(Gl,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Account Settings"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),r.jsxs("select",{name:"role",value:n.role,onChange:N,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200",children:[r.jsx("option",{value:"super-admin",children:"Super Admin"}),r.jsx("option",{value:"hei-admin",children:"HEI Admin"}),r.jsx("option",{value:"hei-staff",children:"HEI Staff"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(eo,{className:"w-4 h-4 inline mr-1"}),"Status"]}),r.jsxs("select",{name:"status",value:n.status,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200",children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-3 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("div",{className:"p-1.5 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(Ya,{className:"w-4 h-4 text-white"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Institution"})]}),z()]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:F,disabled:a,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:a,className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center",children:a?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ma,{className:"w-4 h-4 mr-2"}),"Create User"]})})]})]})})};NN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,loading:B.bool};const jN=({isOpen:t,onClose:s,onSave:e,userData:a,loading:n})=>{const[i,c]=ne.useState({name:"",email:"",role:"user",status:"active",hei_uiid:""}),[l,u]=ne.useState({}),[o,d]=ne.useState([]);ne.useEffect(()=>{t&&a&&(c({name:a.name||"",email:a.email||"",role:a.role||"user",status:a.status||"active",hei_uiid:a.hei_uiid||""}),g())},[t,a]);const g=async()=>{try{const x=await bt.get(`${Ct.API_URL}/hei-options`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}});d(x.data.data||x.data||[])}catch(x){console.error("Error fetching HEI options:",x)}},p=x=>{const{name:b,value:v}=x.target;c(_=>({..._,[b]:v})),l[b]&&u(_=>({..._,[b]:""}))},h=()=>{const x={};return i.name.trim()||(x.name="Name is required"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(x.email="Email format is invalid"):x.email="Email is required",u(x),Object.keys(x).length===0},f=async x=>{x.preventDefault(),h()&&await e({...i,id:a.id})};return r.jsx(mr,{isOpen:t,onClose:s,title:"Edit User",variant:"default",size:"default",children:r.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),r.jsx("input",{type:"text",name:"name",value:i.name,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${l.name?"border-red-300":"border-gray-300"}`,placeholder:"Enter full name"}),l.name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),r.jsx("input",{type:"email",name:"email",value:i.email,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${l.email?"border-red-300":"border-gray-300"}`,placeholder:"Enter email address"}),l.email&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.email})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),r.jsxs("select",{name:"role",value:i.role,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"user",children:"User"}),r.jsx("option",{value:"moderator",children:"Moderator"}),r.jsx("option",{value:"admin",children:"Admin"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:i.status,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institution"}),r.jsxs("select",{name:"hei_uiid",value:i.hei_uiid,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Select Institution"}),o.map(x=>r.jsx("option",{value:x.uiid,children:x.name},x.uiid))]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Updating...":"Update User"})]})]})})};jN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,userData:B.shape({id:B.oneOfType([B.string,B.number]).isRequired,name:B.string,email:B.string,role:B.oneOf(["admin","moderator","user"]),status:B.oneOf(["active","inactive"]),hei_uiid:B.string}).isRequired,loading:B.bool};function Mq(){const[t,s]=ne.useState([]),[e,a]=ne.useState([]),[n,i]=ne.useState(!0),[c,l]=ne.useState(""),[u,o]=ne.useState(null),[d,g]=ne.useState(!1),[p,h]=ne.useState(!1),[f,x]=ne.useState(!1),[b,v]=ne.useState(!1),[_,N]=ne.useState(!1),[E,O]=ne.useState(""),[F,z]=ne.useState("ALL"),[P,U]=ne.useState("ALL");ne.useEffect(()=>{W()},[]),ne.useEffect(()=>{let I=t;E&&(I=I.filter(Z=>{var K,re,G,ae;return((K=Z.name)==null?void 0:K.toLowerCase().includes(E.toLowerCase()))||((re=Z.email)==null?void 0:re.toLowerCase().includes(E.toLowerCase()))||((ae=(G=Z.hei)==null?void 0:G.name)==null?void 0:ae.toLowerCase().includes(E.toLowerCase()))})),F!=="ALL"&&(I=I.filter(Z=>Z.role===F)),P!=="ALL"&&(I=I.filter(Z=>Z.status===P)),a(I)},[t,E,F,P]);const W=async()=>{i(!0),l("");try{const I=await bt.get(`${Ct.API_URL}/admin/users`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}}),Z=Array.isArray(I.data)?I.data:I.data.data||[];s(Z),a(Z),console.log("Fetched users:",Z)}catch(I){console.error("Error fetching users:",I),l("Failed to load users. Please try again.")}finally{i(!1)}},Y=I=>{o(I),g(!0)},q=I=>{o(I),x(!0)},M=async I=>{N(!0);try{const Z=await bt.put(`${Ct.API_URL}/admin/users/${I.id}`,I,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(Z.status===200){const K=Z.data;s(re=>re.map(G=>G.id===K.id?K:G)),a(re=>re.map(G=>G.id===K.id?K:G)),x(!1),o(null),console.log("User updated successfully:",K)}}catch(Z){console.error("Error updating user:",Z),l("Failed to update user. Please try again.")}finally{N(!1)}},D=async I=>{if(window.confirm("Are you sure you want to delete this user?"))try{if((await bt.delete(`${Ct.API_URL}/admin/users/${I}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}})).status===200)s(t.filter(K=>K.id!==I)),a(e.filter(K=>K.id!==I)),console.log("User deleted successfully:",I);else throw new Error("Failed to delete user")}catch(Z){console.error("Error deleting user:",Z),l("Failed to delete user. Please try again.")}},T=()=>{h(!0)},C=async I=>{v(!0);try{const Z=await bt.post(`${Ct.API_URL}/auth/register`,I,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(Z.status===201){const K=Z.data;s(re=>[...re,K]),a(re=>[...re,K]),h(!1),console.log("User created successfully:",K),W()}}catch(Z){console.error("Error creating user:",Z),l("Failed to create user. Please try again.")}finally{v(!1)}},S=()=>{g(!1),o(null)},w=()=>{h(!1)},j=()=>{x(!1),o(null)},A=I=>{switch(I){case"super-admin":return"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800 border border-purple-300";case"hei-admin":return"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border border-blue-300";case"hei-staff":return"bg-gradient-to-r from-green-100 to-green-200 text-green-800 border border-green-300";default:return"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border border-gray-300"}},L=I=>{switch(I){case"super-admin":return r.jsx(Gl,{className:"w-3 h-3"});case"hei-admin":return r.jsx(eo,{className:"w-3 h-3"});case"hei-staff":return r.jsx(ir,{className:"w-3 h-3"});default:return r.jsx(ir,{className:"w-3 h-3"})}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"User Management"}),r.jsxs("p",{className:"text-gray-600 flex items-center",children:[r.jsx(Jr,{className:"w-4 h-4 mr-2"}),"Manage system users and their permissions"]})]})}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm mb-6",children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1 w-full xl:w-auto",children:[r.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search users...",value:E,onChange:I=>O(I.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-60 lg:w-80 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm transition-all duration-200"})]}),r.jsxs("div",{className:"relative w-full sm:w-auto",children:[r.jsx(zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsxs("select",{value:F,onChange:I=>z(I.target.value),className:"pl-10 pr-8 py-2 w-full sm:w-auto border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm appearance-none cursor-pointer transition-all duration-200",children:[r.jsx("option",{value:"ALL",children:"All Roles"}),r.jsx("option",{value:"super-admin",children:"Super Admin"}),r.jsx("option",{value:"hei-admin",children:"HEI Admin"}),r.jsx("option",{value:"hei-staff",children:"HEI Staff"})]})]}),r.jsxs("div",{className:"relative w-full sm:w-auto",children:[r.jsx(zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsxs("select",{value:P,onChange:I=>U(I.target.value),className:"pl-10 pr-8 py-2 w-full sm:w-auto border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm appearance-none cursor-pointer transition-all duration-200",children:[r.jsx("option",{value:"ALL",children:"All Status"}),r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row gap-2 w-full xl:w-auto",children:r.jsxs("button",{onClick:T,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add User"]})})]}),r.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(Qo,{className:"w-4 h-4 mr-1"}),"Showing ",e.length," of ",t.length," ","users"]})]})})]}),c&&r.jsx("div",{className:"mb-6 p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(vs,{className:"w-5 h-5 mr-2"}),c]})}),n?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-8 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),r.jsx("span",{className:"text-gray-600 font-medium",children:"Loading users..."})]})})}):r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl shadow-sm border border-white/20 overflow-hidden",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsx("table",{className:"min-w-full table-fixed",children:r.jsx("thead",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50 border-b border-gray-200/50 sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"w-[300px] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"User Information"}),r.jsx("th",{className:"w-[200px] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Role & Status"}),r.jsx("th",{className:"w-[250px] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Institution"}),r.jsx("th",{className:"w-[200px] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Contact"}),r.jsx("th",{className:"w-[120px] px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})})})}),r.jsx("div",{className:"max-h-[400px] overflow-y-auto overflow-x-hidden",style:{scrollBehavior:"smooth",scrollbarWidth:"thin",scrollbarColor:"#CBD5E1 #F1F5F9"},children:r.jsx("table",{className:"min-w-full table-fixed",children:r.jsx("tbody",{className:"divide-y divide-gray-200/30",children:e.map((I,Z)=>{var K;return r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${Z%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"w-[300px] px-4 py-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:I.profile_image?r.jsx("img",{className:"h-10 w-10 rounded-full object-cover border-2 border-gray-200",src:I.profile_image,alt:I.name}):r.jsx("div",{className:"h-10 w-10 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center",children:r.jsx(ir,{className:"w-5 h-5 text-blue-600"})})}),r.jsxs("div",{className:"ml-3 min-w-0 flex-1",children:[r.jsx("div",{className:"text-sm font-semibold text-gray-900 leading-tight break-words",children:I.name}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["ID: ",I.id]})]})]})}),r.jsx("td",{className:"w-[200px] px-4 py-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full shadow-sm ${A(I.role)}`,children:[L(I.role),r.jsx("span",{className:"ml-1 capitalize",children:I.role})]}),r.jsx("div",{children:r.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full shadow-sm ${I.status==="active"?"bg-gradient-to-r from-green-100 to-green-200 text-green-800 border border-green-300":"bg-gradient-to-r from-red-100 to-red-200 text-red-800 border border-red-300"}`,children:[I.status==="active"?r.jsx(eo,{className:"w-3 h-3"}):r.jsx(Zp,{className:"w-3 h-3"}),r.jsx("span",{className:"ml-1 capitalize",children:I.status})]})})]})}),r.jsx("td",{className:"w-[250px] px-4 py-4",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-xs font-medium text-gray-900 flex items-start",children:[r.jsx($s,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0 mt-0.5"}),r.jsx("span",{className:"break-words leading-tight",children:((K=I.hei)==null?void 0:K.name)||"No institution assigned"})]}),r.jsxs("div",{className:"text-xs text-gray-600 break-words leading-tight ml-4",children:["HEI ID:"," ",I.hei_uiid||"N/A"]})]})}),r.jsx("td",{className:"w-[200px] px-4 py-4",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-xs font-medium text-gray-900 flex items-start",children:[r.jsx(Dn,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0 mt-0.5"}),r.jsx("span",{className:"break-words leading-tight",children:I.email})]}),r.jsxs("div",{className:"text-xs text-gray-600 break-words leading-tight ml-4",children:["Joined:"," ",I.created_at?new Date(I.created_at).toLocaleDateString():"N/A"]})]})}),r.jsx("td",{className:"w-[120px] px-4 py-4 text-center",children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg right-0 top-full mt-1",children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>Y(I),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"View Details"]}),r.jsxs("button",{onClick:()=>q(I),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150 group",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500 group-hover:text-green-600"}),"Edit User"]}),r.jsxs("button",{onClick:()=>D(I.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-700 group-hover:text-red-600"}),"Delete User"]})]})})})]},`user-${I.id}-${Z}`)})})})})]}),r.jsx(wN,{isOpen:d,onClose:S,userData:u}),r.jsx(NN,{isOpen:p,onClose:w,onSave:C,loading:b}),r.jsx(jN,{isOpen:f,onClose:j,onSave:M,userData:u,loading:_})]})})}function SN({isOpen:t,onClose:s,graduateData:e}){const a=(i,c="N/A")=>i?typeof i=="object"?i.year?i.year:JSON.stringify(i):i:c,n=i=>i?new Date(i).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"}):"N/A";return r.jsxs(mr,{isOpen:t,onClose:s,title:"Graduate Details",subtitle:"View detailed information about the graduate",icon:ir,variant:"default",size:"xl",children:[r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Student Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),r.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:`${a(e==null?void 0:e.last_name)}, ${a(e==null?void 0:e.first_name)} ${a(e==null?void 0:e.middle_name,"")}`})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Student ID"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e==null?void 0:e.student_id)})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Date of Birth"]}),r.jsx("p",{className:"text-sm text-gray-900",children:n(e==null?void 0:e.date_of_birth)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Sex"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e==null?void 0:e.sex)})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Program Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Program Name"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e==null?void 0:e.program_name)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Program Major"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e==null?void 0:e.program_major)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Authority Number"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e==null?void 0:e.authority_number)})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(Zr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduation Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Date Graduated"]}),r.jsx("p",{className:"text-sm text-gray-900",children:n(e==null?void 0:e.date_graduated)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Year Granted"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e==null?void 0:e.year_granted)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Report Year"}),r.jsx("p",{className:"text-sm text-gray-900",children:a(e==null?void 0:e.report_year)})]})]})]})]}),r.jsx("div",{className:"flex justify-end p-4 border-t",children:r.jsx("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"})})]})}SN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,graduateData:B.shape({id:B.oneOfType([B.string,B.number]),student_id:B.string,last_name:B.string,first_name:B.string,middle_name:B.string,date_of_birth:B.string,sex:B.string,date_graduated:B.string,program_name:B.string,program_major:B.string,authority_number:B.string,year_granted:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number])})};function kN({isOpen:t,onClose:s,onSave:e,institutionId:a,loading:n=!1}){const[i,c]=ne.useState({student_id:"",last_name:"",first_name:"",middle_name:"",date_of_birth:"",sex:"",date_graduated:"",program_name:"",program_major:"",authority_number:"",year_granted:"",report_year:new Date().getFullYear()}),[l,u]=ne.useState({}),o=(h,f)=>{c(x=>({...x,[h]:f})),l[h]&&u(x=>({...x,[h]:""}))},d=()=>{const h={};return i.student_id.trim()||(h.student_id="Student ID is required"),i.last_name.trim()||(h.last_name="Last name is required"),i.first_name.trim()||(h.first_name="First name is required"),i.program_name.trim()||(h.program_name="Program name is required"),i.program_major.trim()||(h.program_major="Program major is required"),i.report_year||(h.report_year="Report year is required"),u(h),Object.keys(h).length===0},g=()=>{if(d()){const h={...i,suc_details_id:parseInt(a),report_year:parseInt(i.report_year),year_granted:i.year_granted?parseInt(i.year_granted):null};e(h)}},p=()=>{c({student_id:"",last_name:"",first_name:"",middle_name:"",date_of_birth:"",sex:"",date_graduated:"",program_name:"",program_major:"",authority_number:"",year_granted:"",report_year:new Date().getFullYear()}),u({}),s()};return r.jsxs(mr,{isOpen:t,onClose:p,title:"Add New Graduate",subtitle:"Create a new graduate record for the institution",icon:Er,variant:"default",size:"xl",children:[r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Student Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student ID ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.student_id,onChange:h=>o("student_id",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.student_id?"border-red-300 bg-red-50":"border-gray-300"}`}),l.student_id&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.student_id})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.last_name,onChange:h=>o("last_name",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.last_name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.last_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.last_name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.first_name,onChange:h=>o("first_name",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.first_name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.first_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.first_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Middle Name"}),r.jsx("input",{type:"text",value:i.middle_name,onChange:h=>o("middle_name",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Birth ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",value:i.date_of_birth,onChange:h=>o("date_of_birth",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.date_of_birth?"border-red-300 bg-red-50":"border-gray-300"}`}),l.date_of_birth&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.date_of_birth})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Sex ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:i.sex,onChange:h=>o("sex",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.sex?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Sex"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"})]}),l.sex&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.sex})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Program Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Program Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.program_name,onChange:h=>o("program_name",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.program_name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Program Major ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.program_major,onChange:h=>o("program_major",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.program_major?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_major&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_major})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Authority Number"}),r.jsx("input",{type:"text",value:i.authority_number,onChange:h=>o("authority_number",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(Zr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduation Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Graduated"}),r.jsx("input",{type:"date",value:i.date_graduated,onChange:h=>o("date_graduated",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Granted"}),r.jsx("input",{type:"number",value:i.year_granted,onChange:h=>o("year_granted",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200",min:"1900",max:new Date().getFullYear()})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Report Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:i.report_year,onChange:h=>o("report_year",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.report_year?"border-red-300 bg-red-50":"border-gray-300"}`,min:"1900",max:new Date().getFullYear()}),l.report_year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.report_year})]})]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 p-4 border-t",children:[r.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),r.jsx("button",{onClick:g,disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Saving...":"Save Graduate"})]})]})}kN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,institutionId:B.string.isRequired,loading:B.bool};function CN({isOpen:t,onClose:s,onSave:e,graduateData:a,loading:n=!1}){const[i,c]=ne.useState({student_id:"",last_name:"",first_name:"",middle_name:"",date_of_birth:"",sex:"",date_graduated:"",program_name:"",program_major:"",authority_number:"",year_granted:"",report_year:new Date().getFullYear()}),[l,u]=ne.useState({});ne.useEffect(()=>{if(a){const h=x=>x?new Date(x).toISOString().split("T")[0]:"",f=x=>x?typeof x=="object"&&x.year?x.year:x:"";c({student_id:a.student_id||"",last_name:a.last_name||"",first_name:a.first_name||"",middle_name:a.middle_name||"",date_of_birth:h(a.date_of_birth),sex:a.sex||"",date_graduated:h(a.date_graduated),program_name:a.program_name||"",program_major:a.program_major||"",authority_number:a.authority_number||"",year_granted:f(a.year_granted),report_year:a.report_year||new Date().getFullYear()})}},[a]);const o=(h,f)=>{c(x=>({...x,[h]:f})),l[h]&&u(x=>({...x,[h]:""}))},d=()=>{const h={};return i.student_id.trim()||(h.student_id="Student ID is required"),i.last_name.trim()||(h.last_name="Last name is required"),i.first_name.trim()||(h.first_name="First name is required"),i.program_name.trim()||(h.program_name="Program name is required"),i.program_major.trim()||(h.program_major="Program major is required"),i.report_year||(h.report_year="Report year is required"),i.date_of_birth&&new Date(i.date_of_birth)>new Date&&(h.date_of_birth="Date of birth cannot be in the future"),i.date_graduated&&new Date(i.date_graduated)>new Date&&(h.date_graduated="Graduation date cannot be in the future"),i.year_granted&&(isNaN(i.year_granted)||i.year_granted<1900||i.year_granted>new Date().getFullYear())&&(h.year_granted="Invalid year granted"),u(h),Object.keys(h).length===0},g=()=>{if(d()){const h={...i,report_year:parseInt(i.report_year),year_granted:i.year_granted?parseInt(i.year_granted):null};e(h)}},p=()=>{c({student_id:"",last_name:"",first_name:"",middle_name:"",date_of_birth:"",sex:"",date_graduated:"",program_name:"",program_major:"",authority_number:"",year_granted:"",report_year:new Date().getFullYear()}),u({}),s()};return r.jsxs(mr,{isOpen:t,onClose:p,title:"Edit Graduate",subtitle:"Update graduate information",icon:Dr,variant:"default",size:"xl",children:[r.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto p-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Student Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student ID ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.student_id,onChange:h=>o("student_id",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.student_id?"border-red-300 bg-red-50":"border-gray-300"}`}),l.student_id&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.student_id})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.last_name,onChange:h=>o("last_name",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.last_name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.last_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.last_name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.first_name,onChange:h=>o("first_name",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.first_name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.first_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.first_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Middle Name"}),r.jsx("input",{type:"text",value:i.middle_name,onChange:h=>o("middle_name",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Birth ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",value:i.date_of_birth,onChange:h=>o("date_of_birth",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.date_of_birth?"border-red-300 bg-red-50":"border-gray-300"}`}),l.date_of_birth&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.date_of_birth})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Sex ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:i.sex,onChange:h=>o("sex",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${l.sex?"border-red-300 bg-red-50":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Sex"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"})]}),l.sex&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.sex})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 via-green-50 to-teal-100 rounded-xl p-4 border border-emerald-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:r.jsx(qr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Program Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Program Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.program_name,onChange:h=>o("program_name",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.program_name?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Program Major ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.program_major,onChange:h=>o("program_major",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200 ${l.program_major?"border-red-300 bg-red-50":"border-gray-300"}`}),l.program_major&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.program_major})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Authority Number"}),r.jsx("input",{type:"text",value:i.authority_number,onChange:h=>o("authority_number",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors duration-200"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-violet-50 to-indigo-100 rounded-xl p-4 border border-purple-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:r.jsx(Zr,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Graduation Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Graduated"}),r.jsx("input",{type:"date",value:i.date_graduated,onChange:h=>o("date_graduated",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Granted"}),r.jsx("input",{type:"number",value:i.year_granted,onChange:h=>o("year_granted",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200",min:"1900",max:new Date().getFullYear()})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Report Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:i.report_year,onChange:h=>o("report_year",h.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors duration-200 ${l.report_year?"border-red-300 bg-red-50":"border-gray-300"}`,min:"1900",max:new Date().getFullYear()}),l.report_year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.report_year})]})]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 p-4 border-t",children:[r.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),r.jsx("button",{onClick:g,disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Saving...":"Update Graduate"})]})]})}CN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onSave:B.func.isRequired,graduateData:B.shape({id:B.oneOfType([B.string,B.number]),student_id:B.string,last_name:B.string,first_name:B.string,middle_name:B.string,date_of_birth:B.string,sex:B.string,date_graduated:B.string,program_name:B.string,program_major:B.string,authority_number:B.string,year_granted:B.oneOfType([B.string,B.number]),report_year:B.oneOfType([B.string,B.number])}),loading:B.bool};function EN({isOpen:t,onClose:s,institutionId:e,onUploadSuccess:a}){const[n,i]=ne.useState(null),[c,l]=ne.useState(""),[u,o]=ne.useState(!1),[d,g]=ne.useState({}),[p,h]=ne.useState(new Date().getFullYear()),f=(E,O)=>{d[E]&&g(F=>({...F,[E]:""})),h(O)},x=()=>{const E={};return e||(E.institution="Institution ID is required"),p||(E.year="Please select a report year"),g(E),Object.keys(E).length===0},b=()=>{i(null),l("")},v=E=>new Promise((O,F)=>{const z=new FileReader;z.onload=P=>{try{const U=new Uint8Array(P.target.result),W=so(U,{type:"array"}),Y=W.Sheets[W.SheetNames[0]],q=Wo.sheet_to_json(Y,{header:1});console.log("Total rows in Excel:",q.length);const M=q.findIndex(I=>I&&I.some(Z=>Z&&Z.toString().toLowerCase().includes("student id")));if(M===-1)throw new Error('Could not find header row with "Student ID" in Excel file');console.log("Header row found at index:",M);const D=q[M];console.log("Headers:",D);const T=q.slice(M+1).filter(I=>{if(!I||I.length===0||!I[0]||I[0].toString().includes("(mm/dd/yyyy)")||I[0].toString().includes("HEMIS DATA COLLECTION"))return!1;const Z=I[0].toString().trim();return Z.length>0&&/[A-Za-z0-9]/.test(Z)});console.log("Filtered data rows:",T.length);const C=I=>{for(const Z of I){const K=D.findIndex(re=>re&&re.toString().toLowerCase().includes(Z.toLowerCase()));if(K!==-1)return K}return-1},S={studentId:C(["Student ID","student id"]),dob:C(["Date of Birth","date of birth","birth date"]),lastName:C(["Last Name","last name","surname"]),firstName:C(["First Name","first name","given name"]),middleName:C(["Middle Name","middle name"]),sex:C(["Sex","gender"]),dateGraduated:C(["Date Graduated","date graduated","graduation date"])};console.log("Column indices:",S);const j=["studentId","dob","lastName","firstName","sex","dateGraduated"].filter(I=>S[I]===-1);if(j.length>0)throw new Error(`Missing required columns: ${j.join(", ")}`);const A=I=>{if(!I)return null;try{let Z;if(typeof I=="number")Z=new Date((I-25569)*86400*1e3);else if(typeof I=="string")Z=new Date(I);else return null;if(isNaN(Z.getTime()))return console.warn("Invalid date value:",I),null;const K=Z.getFullYear(),re=String(Z.getMonth()+1).padStart(2,"0"),G=String(Z.getDate()).padStart(2,"0");return`${K}-${re}-${G}`}catch(Z){return console.warn("Error converting date:",I,Z),null}};console.log("Raw Excel Data (first 5 rows):",T.slice(0,5).map(I=>({student_id:I[S.studentId],last_name:I[S.lastName],first_name:I[S.firstName],middle_name:I[S.middleName],sex:I[S.sex],date_of_birth:I[S.dob],date_graduated:I[S.dateGraduated],program_name:I[7],program_major:I[8],authority_number:I[9],year_granted:I[10]})));const L=T.map((I,Z)=>{try{const re=I[7]?I[7].toString().trim():"",G=8,ae=I[G]?I[G].toString().trim():"",V=9,H=I[V]?I[V].toString().trim():"",Q=10;let oe=null;if(I[Q]){const Ne=I[Q];if(typeof Ne=="number")oe=Math.floor(Ne);else if(typeof Ne=="string"){const we=Ne.match(/\d{4}/);if(we)oe=parseInt(we[0],10);else{const ue=parseInt(Ne,10);isNaN(ue)||(oe=ue)}}}const se={student_id:I[S.studentId]?I[S.studentId].toString().trim():"",last_name:I[S.lastName]?I[S.lastName].toString().trim():"",first_name:I[S.firstName]?I[S.firstName].toString().trim():"",middle_name:I[S.middleName]?I[S.middleName].toString().trim():"",date_of_birth:A(I[S.dob]),sex:I[S.sex]?I[S.sex].toString().trim().toUpperCase():"",program_name:re,program_major:ae||"Not Specified",authority_number:H,date_graduated:A(I[S.dateGraduated]),year_granted:oe,suc_details_id:e,report_year:p};console.log(`Processed graduate ${Z+1}:`,se);const he=["student_id","last_name","first_name","date_of_birth","sex","date_graduated","program_name","program_major"].filter(Ne=>!se[Ne]);return he.length>0?(console.warn(`Row ${Z+M+2}: Missing required fields: ${he.join(", ")}`,se),null):(["M","F","MALE","FEMALE"].includes(se.sex.toUpperCase())||(console.warn(`Row ${Z+M+2}: Invalid sex value: ${se.sex}`),se.sex=se.sex.charAt(0).toUpperCase()),se.sex.toUpperCase().startsWith("M")?se.sex="M":se.sex.toUpperCase().startsWith("F")&&(se.sex="F"),se)}catch(K){return console.error(`Error processing row ${Z+M+2}:`,K,I),null}}).filter(I=>I!==null);if(console.log(`Successfully processed ${L.length} graduates out of ${T.length} data rows`),L.length===0)throw new Error("No valid graduate records found in the Excel file");console.log("Sample processed graduates:",L.slice(0,3)),O(L)}catch(U){console.error("Error parsing Excel file:",U),F(U)}},z.onerror=P=>{console.error("Error reading file:",P),F(new Error("Failed to read the Excel file"))},z.readAsArrayBuffer(E)}),_=async E=>{var z,P;const O=E.target.files[0];if(!O)return;if(!x()){Ft.showAlert("Please ensure institution and year are properly set before uploading.","error");return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(O.type)&&!O.name.match(/\.(xlsx|xls|csv)$/i)){Ft.showAlert("Please upload a valid Excel file (.xlsx, .xls) or CSV file.","error");return}o(!0),i("loading"),l("Processing file...");try{const U=await v(O);l(`Parsed ${U.length} graduates. Uploading to server...`);const W={graduates:U};(await bt.post(`${Ct.API_URL}/suc-pcr-graduate-list/bulk`,W,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).status===201&&(i("success"),l(`Successfully uploaded ${U.length} graduates.`),a(),s())}catch(U){console.error("Error uploading file:",U),i("error");let W="Failed to upload file. Please try again.";U.message?W=U.message:(P=(z=U.response)==null?void 0:z.data)!=null&&P.message&&(W=U.response.data.message),l(W)}finally{o(!1),E.target.value=""}},N=()=>{g({}),i(null),l(""),s()};return t?r.jsx(mr,{isOpen:t,onClose:N,title:"Upload Graduates",subtitle:"Import graduate data from Excel files",icon:Qr,variant:"default",size:"xl",children:r.jsxs("div",{className:"space-y-4",children:[n&&r.jsx("div",{className:`p-4 rounded-xl border shadow-sm ${n==="success"?"bg-green-50/80 border-green-200 text-green-800":n==="error"?"bg-red-50/80 border-red-200 text-red-800":"bg-blue-50/80 border-blue-200 text-blue-800"}`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[n==="success"&&r.jsx(e0,{className:"w-5 h-5 mr-2"}),n==="error"&&r.jsx(Ht,{className:"w-5 h-5 mr-2"}),n==="loading"&&r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-800 mr-2"}),r.jsx("span",{className:"font-medium",children:c})]}),n!=="loading"&&r.jsx("button",{onClick:b,className:"text-gray-500 hover:text-gray-700 transition-colors duration-200",children:r.jsx(vs,{className:"w-4 h-4"})})]})}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:r.jsx(ir,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Upload Configuration"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Institution ID"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:e||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600",placeholder:"Institution ID will be auto-filled"}),d.institution&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.institution})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Lr,{className:"w-4 h-4 inline mr-1"}),"Report Year"," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{value:p,onChange:E=>f("year",parseInt(E.target.value)),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${d.year?"border-red-300 bg-red-50":"border-gray-300"}`,children:Array.from({length:10},(E,O)=>{const F=new Date().getFullYear()-O;return r.jsx("option",{value:F,children:F},F)})}),d.year&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.year})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-100 rounded-xl p-4 border border-amber-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:r.jsx(pi,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Excel Format Guidelines"})]}),r.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ys,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"Required Columns (must be exact matches):"}),r.jsxs("ul",{className:"space-y-1 ml-2",children:[r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Student ID (Required)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Date of Birth (Required - Excel date format)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Last Name (Required)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"First Name (Required)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Middle Name (Optional)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Sex (Required - M/F)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Date Graduated (Required - Excel date format)"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),"Program Name (Usually in column H)"]})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ui,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"The system will automatically validate and process the graduate data. Dates should be in Excel date format (numbers)."})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(qr,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{children:"Supported formats: .xlsx, .xls, and .csv files. Rows with missing required data will be skipped."})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-slate-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:r.jsx($o,{className:"w-5 h-5 text-white"})}),r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"File Upload"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"file",id:"excel-upload",accept:".xlsx,.xls,.csv",onChange:_,disabled:u||!e,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),r.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200 ${!e||u?"border-gray-200 bg-gray-50/50":"border-slate-300 hover:border-slate-400 hover:bg-slate-50/50 bg-white"}`,children:[r.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${!e||u?"bg-gray-100":"bg-gradient-to-br from-slate-100 to-slate-200"}`,children:u?r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}):r.jsx(Qr,{className:`w-8 h-8 ${e?"text-slate-600":"text-gray-300"}`})}),r.jsx("p",{className:`text-lg font-semibold mb-2 ${!e||u?"text-gray-400":"text-gray-900"}`,children:u?"Processing File...":"Choose Excel File to Upload"}),r.jsx("p",{className:`text-sm mb-2 ${!e||u?"text-gray-400":"text-gray-600"}`,children:"Drag and drop or click to browse"}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-2",children:[r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:".xlsx"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:".xls"}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:".csv"})]}),!e&&r.jsxs("div",{className:"flex items-center justify-center mt-3",children:[r.jsx(Ht,{className:"w-4 h-4 text-red-500 mr-1"}),r.jsx("span",{className:"text-sm text-red-500 font-medium",children:"Institution ID is required"})]}),n==="loading"&&r.jsxs("div",{className:"mt-4",children:[r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-2 rounded-full animate-pulse",style:{width:"60%"}})}),r.jsx("p",{className:"text-sm text-gray-600 mt-2",children:c})]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:N,disabled:u,className:"w-full sm:w-auto px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:u?"Processing...":"Close"}),n==="success"&&r.jsxs("button",{onClick:()=>{i(null),l("")},className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm hover:shadow-md transition-all duration-200 font-medium flex items-center justify-center",children:[r.jsx(Qr,{className:"w-4 h-4 mr-2"}),"Upload Another File"]})]})]})}):null}EN.propTypes={isOpen:B.bool.isRequired,onClose:B.func.isRequired,onUploadSuccess:B.func.isRequired,institutionId:B.oneOfType([B.string,B.number]).isRequired};function Fq(){var oe;const{SucDetailId:t}=Ko(),s=Aa(),a=((oe=qs().state)==null?void 0:oe.heiName)||"Unknown Institution",[n,i]=ne.useState([]),[c,l]=ne.useState([]),[u,o]=ne.useState(!0),[d,g]=ne.useState(""),[p,h]=ne.useState(null),[f,x]=ne.useState(!1),[b,v]=ne.useState(!1),[_,N]=ne.useState(!1),[E,O]=ne.useState(!1),[F,z]=ne.useState(!1),[P,U]=ne.useState(!1),[W,Y]=ne.useState(!1),[q,M]=ne.useState(""),[D,T]=ne.useState("ALL");ne.useEffect(()=>{C()},[]),ne.useEffect(()=>{let se=Array.isArray(n)?[...n]:[];q&&(se=se.filter(le=>{var he,Ne,we,ue;return((he=le.last_name)==null?void 0:he.toLowerCase().includes(q.toLowerCase()))||((Ne=le.first_name)==null?void 0:Ne.toLowerCase().includes(q.toLowerCase()))||((we=le.student_id)==null?void 0:we.toString().includes(q.toLowerCase()))||((ue=le.program_name)==null?void 0:ue.toLowerCase().includes(q.toLowerCase()))})),D!=="ALL"&&(se=se.filter(le=>le.report_year===parseInt(D))),l(se)},[n,q,D]);const C=async()=>{if(!t){console.error("SucDetailId is undefined. Cannot fetch graduates."),g("Invalid institution ID. Please check the URL or try again."),o(!1);return}o(!0),g("");try{const le=(await bt.get(`${Ct.API_URL}/suc-pcr-graduate-list`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"},params:{suc_details_id:t}})).data.data||[];i(le),l(le),console.log("Fetched graduates:",le)}catch(se){console.error("Error fetching graduates:",se),g("Failed to load graduates. Please try again.")}finally{o(!1)}},S=ne.useCallback(async()=>{try{Y(!0),jr.fire({title:"Confirm Export",text:`Do you want to export Graduates List for ${a}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Export",cancelButtonText:"Cancel",customClass:{popup:"swal2-popup",title:"text-lg font-semibold text-gray-900",content:"text-gray-600"}}).then(async se=>{if(se.isConfirmed)try{jr.fire({title:"Success!",text:"Graduates list exported successfully.",icon:"success",timer:4e3,showConfirmButton:!1})}catch(le){console.error("Error exporting graduates:",le),jr.fire({title:"Error!",text:"Failed to export graduates list. Please try again.",icon:"error",confirmButtonText:"OK"})}Y(!1)})}catch(se){console.error("Error in export function:",se),Y(!1)}},[n,a]),w=()=>{O(!0)},j=se=>{h(se),x(!0)},A=se=>{h(se),N(!0)},L=()=>{v(!0)},I=async se=>{z(!0);try{const le=await bt.post(`${Ct.API_URL}/suc-pcr-graduate-list`,{...se,suc_details_id:t},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(le.status===201){const he=le.data.data;i(Ne=>[...Ne,he]),v(!1),console.log("Graduate created successfully:",he)}}catch(le){console.error("Error creating graduate:",le),g("Failed to create graduate. Please try again.")}finally{z(!1)}},Z=async se=>{U(!0);try{const le=await bt.put(`${Ct.API_URL}/suc-pcr-graduate-list/${se.id}`,se,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json","Content-Type":"application/json"}});if(le.status===200){const he=le.data.data;i(Ne=>Ne.map(we=>we.id===he.id?he:we)),N(!1),h(null),console.log("Graduate updated successfully:",he)}}catch(le){console.error("Error updating graduate:",le),g("Failed to update graduate. Please try again.")}finally{U(!1)}},K=async se=>{try{(await jr.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed&&(await bt.delete(`${Ct.API_URL}/suc-pcr-graduate-list/${se}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}})).status===200&&(i(Ne=>Ne.filter(we=>we.id!==se)),jr.fire("Deleted!","Graduate has been deleted.","success"))}catch(le){console.error("Error deleting graduate:",le),jr.fire("Error!","Failed to delete graduate.","error")}},re=()=>{s("/super-admin/institutions/suc")},G=()=>{x(!1),h(null)},ae=()=>{v(!1)},V=()=>{N(!1),h(null)},H=()=>{O(!1)},Q=se=>{if(!se)return"N/A";const le=new Date(se);if(isNaN(le.getTime()))return"N/A";const he=le.getFullYear(),Ne=String(le.getMonth()+1).padStart(2,"0"),we=String(le.getDate()).padStart(2,"0");return`${he}-${Ne}-${we}`};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30",children:r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:re,className:"mr-4 p-2 text-gray-600 hover:text-gray-900 hover:bg-white/50 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Back to SUC List",children:r.jsx(Zo,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Graduates Management"}),r.jsxs("p",{className:"text-gray-600 flex items-center",children:[r.jsx(gr,{className:"w-4 h-4 mr-2"}),a]})]})]}),r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-white/20 shadow-sm mb-6",children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1 w-full xl:w-auto",children:[r.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[r.jsx(pa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search graduates...",value:q,onChange:se=>M(se.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-60 lg:w-80 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm transition-all duration-200"})]}),r.jsxs("div",{className:"relative w-full sm:w-auto",children:[r.jsx(zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsxs("select",{value:D,onChange:se=>{T(se.target.value)},className:"pl-10 pr-8 py-2 w-full sm:w-auto border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/50 backdrop-blur-sm appearance-none cursor-pointer transition-all duration-200",children:[r.jsx("option",{value:"ALL",children:"All Years"}),Array.from({length:5},(se,le)=>new Date().getFullYear()-le).map(se=>r.jsx("option",{value:se,children:se},se))]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full xl:w-auto",children:[r.jsxs("button",{onClick:S,disabled:W||n.length===0,className:"inline-flex items-center justify-center px-4 py-2 bg-white/50 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-white hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(oc,{className:"w-4 h-4 mr-2"}),W?"Exporting...":"Export Excel"]}),r.jsxs("button",{onClick:w,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg text-sm font-medium hover:from-green-700 hover:to-green-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500",children:[r.jsx(Qr,{className:"w-4 h-4 mr-2"}),"Upload Excel"]}),r.jsxs("button",{onClick:L,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Graduate"]})]})]}),r.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Qo,{className:"w-4 h-4 mr-1"}),"Showing"," ",c.length>0?"1 to "+c.length:"No graduates available"]})})]})})]}),d&&r.jsx("div",{className:"mb-6 p-4 bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-800 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(vs,{className:"w-5 h-5 mr-2"}),d]})}),u?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-8 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),r.jsx("span",{className:"text-gray-600 font-medium",children:"Loading graduates..."})]})})}):r.jsx(r.Fragment,{children:r.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl shadow-sm border border-white/20 overflow-hidden mb-6",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-full",children:[r.jsx("div",{className:"bg-gradient-to-r from-gray-50/80 to-blue-50/50 border-b border-gray-200/50 sticky top-0 z-10",children:r.jsx("table",{className:"min-w-full table-fixed",children:r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Student Information"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Program Details"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Graduation Details"}),r.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})})})}),r.jsx("div",{className:"max-h-[400px] overflow-y-auto overflow-x-hidden relative",style:{scrollBehavior:"smooth",scrollbarWidth:"thin",scrollbarColor:"#CBD5E1 #F1F5F9"},children:r.jsx("table",{className:"min-w-full table-fixed",children:r.jsx("tbody",{className:"divide-y divide-gray-200/30",children:u?r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),r.jsx("span",{className:"text-gray-600 font-medium",children:"Loading..."})]})})}):d?r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center text-red-500",children:d})}):c.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-4",children:r.jsx(gr,{className:"w-10 h-10 text-gray-400"})}),r.jsxs("div",{className:"mb-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:q||D!=="ALL"?"No graduates found":"No graduates available"}),r.jsx("p",{className:"text-gray-600",children:q||D!=="ALL"?"Try adjusting your search or filter criteria":"Get started by adding your first graduate"})]}),!q&&D==="ALL"&&r.jsxs("div",{className:"space-y-3",children:[r.jsxs("button",{onClick:L,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg text-sm font-medium hover:from-blue-700 hover:to-blue-800 shadow-sm hover:shadow-md transition-all duration-200 mr-3",children:[r.jsx(Er,{className:"w-4 h-4 mr-2"}),"Add Graduate"]}),r.jsxs("button",{onClick:w,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg text-sm font-medium hover:from-green-700 hover:to-green-800 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsx(Qr,{className:"w-4 h-4 mr-2"}),"Upload Excel"]})]})]})})}):c.map((se,le)=>{var he;return r.jsxs("tr",{className:`hover:bg-blue-50/30 transition-all duration-200 ${le%2===0?"bg-white/30":"bg-gray-50/30"}`,children:[r.jsx("td",{className:"px-4 py-4",style:{width:"320px"},children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-purple-100 to-purple-200 text-purple-700",children:r.jsx(ir,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[r.jsx("div",{className:"text-sm font-semibold text-gray-900",children:`${se.last_name}, ${se.first_name} ${se.middle_name||""}`}),r.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",se.student_id]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["DOB: ",Q(se.date_of_birth)]})]})]})}),r.jsx("td",{className:"px-4 py-4",style:{width:"256px"},children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:se.program_name||"N/A"}),se.program_major&&r.jsxs("div",{className:"text-xs text-blue-600",children:["Major: ",se.program_major]}),r.jsxs("div",{className:"text-xs text-gray-600",children:["Authority Number: ",se.authority_number||"N/A"]})]})}),r.jsx("td",{className:"px-4 py-4",style:{width:"224px"},children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[r.jsx(Lr,{className:"w-3 h-3 mr-1 text-gray-400 flex-shrink-0"}),r.jsx("span",{children:Q(se.date_graduated)})]}),r.jsxs("div",{className:"text-xs text-gray-600",children:["Year Granted: ",se.year_granted||"N/A"]}),r.jsxs("div",{className:"text-xs text-gray-600",children:["Report Year: ",((he=se.report_year)==null?void 0:he.year)||"N/A"]})]})}),r.jsx("td",{className:"px-4 py-4 text-center",style:{width:"128px"},children:r.jsx(ra,{trigger:r.jsx("button",{className:"text-gray-600 hover:text-gray-900 hover:bg-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-lg p-2 transition-all duration-200",title:"More Actions",children:r.jsx(ha,{className:"w-4 h-4"})}),placement:"bottom-end",className:"w-40 bg-white/90 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg",offset:[0,4],usePortal:!0,children:r.jsxs("div",{className:"py-2",children:[r.jsxs("button",{onClick:()=>j(se),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 focus:outline-none focus:bg-blue-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Gs,{className:"w-4 h-4 mr-3 text-blue-500 group-hover:text-blue-600"}),"View Details"]}),r.jsxs("button",{onClick:()=>A(se),className:"flex items-center w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 focus:outline-none focus:bg-green-50 transition-colors duration-150 group",role:"menuitem",children:[r.jsx(Dr,{className:"w-4 h-4 mr-3 text-green-500 group-hover:text-green-600"}),"Edit Graduate"]}),r.jsxs("button",{onClick:()=>K(se.id),className:"flex items-center w-full px-4 py-2 text-left text-sm text-red-700 hover:bg-red-50 focus:outline-none focus:bg-red-50 transition-colors duration-150",role:"menuitem",children:[r.jsx(ga,{className:"w-4 h-4 mr-3 text-red-700 group-hover:text-green-600"}),"Delete Graduate"]})]})})})]},se.id)})})})})]})})})}),r.jsx(SN,{isOpen:f,onClose:G,graduateData:p}),r.jsx(kN,{isOpen:b,onClose:ae,onSave:I,institutionId:t,loading:F}),r.jsx(CN,{isOpen:_,onClose:V,onSave:Z,graduateData:p,loading:P}),r.jsx(EN,{isOpen:E,onClose:H,institutionId:t,onUploadSuccess:C})]})})}function TN({to:t}){return window.location.href=t,null}TN.propTypes={to:B.string.isRequired};function AN(){return r.jsx(ok,{children:r.jsxs(PS,{children:[r.jsx(Mr,{path:"/",element:r.jsx(Hp,{to:"/login",replace:!0})}),r.jsx(Mr,{path:"/egg",element:r.jsx(TN,{to:"https://www.youtube.com/watch?v=dQw4w9WgXcQ"})}),r.jsx(Mr,{path:"/login",element:r.jsx(PE,{})}),r.jsxs(Mr,{element:r.jsx(_N,{}),children:[r.jsxs(Mr,{element:r.jsx(Kf,{allowedRoles:["super-admin"]}),children:[r.jsx(Mr,{path:"super-admin/dashboard",element:r.jsx(DE,{})}),r.jsx(Mr,{path:"/super-admin/institutions/suc",element:r.jsx(AV,{})}),r.jsx(Mr,{path:"/super-admin/institutions/luc",element:r.jsx(lw,{})}),r.jsx(Mr,{path:"/super-admin/institutions/private",element:r.jsx(ow,{})}),r.jsx(Mr,{path:"/super-admin/institutions/suc/campuses/:SucDetailId",element:r.jsx(MV,{})}),r.jsx(Mr,{path:"/super-admin/institutions/suc/programs/:SucDetailId",element:r.jsx(PU,{})}),r.jsx(Mr,{path:"/super-admin/institutions/suc/graduates/:SucDetailId",element:r.jsx(Fq,{})}),r.jsx(Mr,{path:"/super-admin/institutions/suc/form-e1/:SucDetailId",element:r.jsx(aN,{})}),r.jsx(Mr,{path:"/super-admin/institutions/suc/form-e2/:SucDetailId",element:r.jsx(vq,{})}),r.jsx(Mr,{path:"/super-admin/institutions/suc/form-gh/:SucDetailId",element:r.jsx(kq,{})}),r.jsx(Mr,{path:"/super-admin/institutions/suc/research/:heiId",element:r.jsx(Eq,{})}),r.jsx(Mr,{path:"/super-admin/institutions/luc/campuses/:lucDetailId",element:r.jsx(lw,{})}),r.jsx(Mr,{path:"/super-admin/institutions/private/campuses/:privateDetailId",element:r.jsx(ow,{})}),r.jsx(Mr,{path:"/super-admin/user-management",element:r.jsx(Mq,{})}),r.jsx(Mr,{path:"/super-admin/hei-management",element:r.jsx(Cq,{})})]}),r.jsx(Mr,{element:r.jsx(Kf,{allowedRoles:["hei-admin"]})}),r.jsx(Mr,{element:r.jsx(Kf,{allowedRoles:["hei-staff"]})}),r.jsx(Mr,{path:"*",element:r.jsx(Rq,{})})]})]})})}AN.propTypes={};window.Buffer=P8.Buffer;q8.createRoot(document.getElementById("root")).render(r.jsx(ne.StrictMode,{children:r.jsx(Y4,{children:r.jsx(AN,{})})}));
